sMixDepthW0N0 = IF (InclStratN0 EQ FALSE) THEN 0.0 ELSEIF (InitMixDepthN0 EQ FALSE) THEN cMixDepthW0N0 ELSEIF (ReadMixDepthN0 EQ TRUE) THEN mMixDepthN0 ELSE cMixDepthN0 ENDIF;
aInclStrat0N0 =IF ( InclStratN0 EQ FALSE) THEN 0.0 ELSEIF (sMixDepthW0N0 GT cDepthWInit0N0 - cMinDepthHypEpiN0 ) THEN 0.0 ELSE 1.0 ENDIF;
sDepthW0N0 = IF (InitDepthN0 EQ TRUE) THEN cDepthWInit0N0 ELSE  cDepthW0N0 ENDIF ;
MassHyp0N0 = IF ( CalcMassN0 EQ TRUE  AND aInclStrat0N0 EQ TRUE ) THEN sDepthW0N0 - sMixDepthW0N0 ELSE cMinDepthHypEpiN0 ENDIF ;
sNH4WHyp0N0 = cNH4WHyp0N0 *MassHyp0N0;
sNO3WHyp0N0 = cNO3WHyp0N0 *MassHyp0N0;
sPO4WHyp0N0 = cPO4WHyp0N0 *MassHyp0N0;
sPAIMWHyp0N0 = cPAIMWHyp0N0 *MassHyp0N0;
sSiO2WHyp0N0 = cSiO2WHyp0N0 *MassHyp0N0;
sO2WHyp0N0 = cO2WHyp0N0 *MassHyp0N0;
sDDetWHyp0N0 = cDDetWHyp0N0 *MassHyp0N0;
sNDetWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDet0N0 * sDDetWHyp0N0 ELSE cNDetWHyp0N0 *MassHyp0N0 ENDIF;
sPDetWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDet0N0 * sDDetWHyp0N0 ELSE cPDetWHyp0N0 *MassHyp0N0 ENDIF;
sSiDetWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cSiDDet0N0 * sDDetWHyp0N0 ELSE cSiDetWHyp0N0 *MassHyp0N0 ENDIF;
sDIMWHyp0N0 = cDIMWHyp0N0 *MassHyp0N0;
sDDiatWHyp0N0 = cDDiatWHyp0N0 *MassHyp0N0;
sNDiatWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDiat0N0 * sDDiatWHyp0N0 ELSE cNDiatWHyp0N0 *MassHyp0N0 ENDIF;
sPDiatWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDiat0N0 * sDDiatWHyp0N0 ELSE cPDiatWHyp0N0 *MassHyp0N0 ENDIF;
sDGrenWHyp0N0 = cDGrenWHyp0N0 *MassHyp0N0;
sNGrenWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDGren0N0 * sDGrenWHyp0N0 ELSE cNGrenWHyp0N0 *MassHyp0N0 ENDIF;
sPGrenWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDGren0N0 * sDGrenWHyp0N0 ELSE cPGrenWHyp0N0 *MassHyp0N0 ENDIF;
sDBlueWHyp0N0 = cDBlueWHyp0N0 *MassHyp0N0;
sNBlueWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDBlue0N0 * sDBlueWHyp0N0 ELSE cNBlueWHyp0N0*MassHyp0N0 ENDIF;
sPBlueWHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDBlue0N0 * sDBlueWHyp0N0 ELSE cPBlueWHyp0N0 *MassHyp0N0 ENDIF;
sDZooHyp0N0 = cDZooHyp0N0 *MassHyp0N0;
sNZooHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDZooRefN0 * sDZooHyp0N0 ELSE cNZooHyp0N0 *MassHyp0N0 ENDIF;
sPZooHyp0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDZooRefN0 * sDZooHyp0N0 ELSE cPZooHyp0N0 *MassHyp0N0 ENDIF;
sDFiAd0N0 = cDFiAd0N0;
sDFiJv0N0 = cDFiJv0N0;
sNFiAd0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDFishRefN0 * sDFiAd0N0 ELSE cNFiAd0N0 ENDIF;
sNFiJv0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDFishRefN0 * sDFiJv0N0 ELSE cNFiJv0N0 ENDIF;
sPFiAd0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDFishRefN0 * sDFiAd0N0 ELSE cPFiAd0N0 ENDIF;
sPFiJv0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDFishRefN0 * sDFiJv0N0 ELSE cPFiJv0N0 ENDIF;
sDPisc0N0 = cDPisc0N0;
MassEpi0N0 = IF (CalcMassN0 EQ FALSE) THEN 1.0 ELSEIF (aInclStrat0N0 EQ FALSE) THEN sDepthW0N0 ELSEIF (sDepthW0N0  LT sMixDepthW0N0) THEN sDepthW0N0 ELSE sMixDepthW0N0 ENDIF;
sNH4WEpi0N0 = cNH4WEpi0N0 * MassEpi0N0;
sNO3WEpi0N0 = cNO3WEpi0N0 *MassEpi0N0;
sPO4WEpi0N0 = cPO4WEpi0N0 *MassEpi0N0;
sPAIMWEpi0N0 = cPAIMWEpi0N0 *MassEpi0N0;
sSiO2WEpi0N0 = cSiO2WEpi0N0 * MassEpi0N0;
sO2WEpi0N0 = cO2WEpi0N0 *MassEpi0N0;
sDDetWEpi0N0 = cDDetWEpi0N0 *MassEpi0N0;
sNDetWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDet0N0 * sDDetWEpi0N0 ELSE cNDetWEpi0N0 *MassEpi0N0 ENDIF ;
sPDetWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDet0N0 * sDDetWEpi0N0 ELSE cPDetWEpi0N0 *MassEpi0N0 ENDIF;
sSiDetWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cSiDDet0N0 * sDDetWEpi0N0 ELSE cSiDetWEpi0N0 *MassEpi0N0 ENDIF;
sDIMWEpi0N0 = cDIMWEpi0N0 *MassEpi0N0;
sDDiatWEpi0N0 = cDDiatWEpi0N0 *MassEpi0N0;
sNDiatWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDiat0N0 * sDDiatWEpi0N0 ELSE cNDiatWEpi0N0 *MassEpi0N0 ENDIF;
sPDiatWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDiat0N0 * sDDiatWEpi0N0 ELSE cPDiatWEpi0N0 *MassEpi0N0 ENDIF;
sDGrenWEpi0N0 = cDGrenWEpi0N0 *MassEpi0N0;
sNGrenWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDGren0N0 * sDGrenWEpi0N0 ELSE cNGrenWEpi0N0 *MassEpi0N0 ENDIF;
sPGrenWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDGren0N0 * sDGrenWEpi0N0 ELSE cPGrenWEpi0N0 *MassEpi0N0 ENDIF;
sDBlueWEpi0N0 = cDBlueWEpi0N0 *MassEpi0N0;
sNBlueWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDBlue0N0 * sDBlueWEpi0N0 ELSE cNBlueWEpi0N0 *MassEpi0N0 ENDIF;
sPBlueWEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDBlue0N0 * sDBlueWEpi0N0 ELSE cPBlueWEpi0N0 *MassEpi0N0 ENDIF;
sDZooEpi0N0 = cDZooEpi0N0 *MassEpi0N0;
sNZooEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDZooRefN0 * sDZooEpi0N0 ELSE cNZooEpi0N0 *MassEpi0N0 ENDIF;
sPZooEpi0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDZooRefN0 * sDZooEpi0N0 ELSE cPZooEpi0N0 *MassEpi0N0 ENDIF;
sDBlueSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN cDBlueSurf0N0 ELSE 0.0 ENDIF;
sNBlueSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN cNBlueSurf0N0 ELSE 0.0 ENDIF;
sPBlueSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN cPBlueSurf0N0 ELSE 0.0 ENDIF;
sNH4S0N0 = cNH4S0N0;
sNO3S0N0 = cNO3S0N0;
bRhoSolidS0N0 = fDOrgS0N0 * cRhoOMN0 + (1.0 - fDOrgS0N0) * cRhoIMN0;
bPorS0N0 = (1.0 - fDTotS0N0) * bRhoSolidS0N0 / cRhoWatN0 / ( fDTotS0N0 + (1.0 - fDTotS0N0) * bRhoSolidS0N0 / cRhoWatN0 );
bRhoTotS0N0 = bRhoSolidS0N0 * (1.0 - bPorS0N0);
bDTotS0N0 = bRhoTotS0N0 * cDepthSN0;
sPO4S0N0 = IF (InitCalcN0 EQ TRUE) THEN (1.0 - fPAdsS0N0) * fPInorgS0N0 * bDTotS0N0 ELSE cPO4S0N0 ENDIF;
sPAIMS0N0 = IF (InitCalcN0 EQ TRUE) THEN fPAdsS0N0 * fPInorgS0N0 * bDTotS0N0 ELSE cPAIMS0N0 ENDIF;
sDDetS0N0 = IF (InitCalcN0 EQ TRUE) THEN fDDetS0N0 * fDOrgS0N0 * bDTotS0N0 ELSE cDDetS0N0 ENDIF;
sNDetS0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDet0N0 * sDDetS0N0 ELSE cNDetS0N0 ENDIF;
sPDetS0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDet0N0 * sDDetS0N0 ELSE cPDetS0N0 ENDIF;
sSiDetS0N0 = IF (InitCalcN0 EQ TRUE) THEN cSiDDet0N0 * sDDetS0N0 ELSE cSiDetS0N0 ENDIF;
sDHumS0N0 = IF (InitCalcN0 EQ TRUE) THEN (1.0 - fDDetS0N0) * fDOrgS0N0 * bDTotS0N0 ELSE cDHumS0N0 ENDIF;
sNHumS0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDHum0N0 * sDHumS0N0 ELSE cNHumS0N0 ENDIF;
sPHumS0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDHum0N0 * sDHumS0N0 ELSE cPHumS0N0 ENDIF;
sDIMS0N0 = IF (InitCalcN0 EQ TRUE) THEN bDTotS0N0 - sDHumS0N0 - sDDetS0N0 ELSE cDIMS0N0 ENDIF;
sDDiatS0N0 = IF (InitCalcN0 EQ TRUE) THEN fSedPhyt0N0 * sDDiatWHyp0N0 ELSE cDDiatS0N0 ENDIF;
sNDiatS0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDiat0N0 * sDDiatS0N0 ELSE cNDiatS0N0 ENDIF;
sPDiatS0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDiat0N0 * sDDiatS0N0 ELSE cPDiatS0N0 ENDIF;
sDGrenS0N0 = IF (InitCalcN0 EQ TRUE) THEN fSedPhyt0N0 * sDGrenWHyp0N0 ELSE cDGrenS0N0 ENDIF;
sNGrenS0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDGren0N0 * sDGrenS0N0 ELSE cNGrenS0N0 ENDIF;
sPGrenS0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDGren0N0 * sDGrenS0N0 ELSE cPGrenS0N0 ENDIF;
sDBlueS0N0 = IF (InitCalcN0 EQ TRUE) THEN fSedPhyt0N0 * sDBlueWHyp0N0 ELSE cDBlueS0N0 ENDIF;
sNBlueS0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDBlue0N0 * sDBlueS0N0 ELSE cNBlueS0N0 ENDIF;
sPBlueS0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDBlue0N0 * sDBlueS0N0 ELSE cPBlueS0N0 ENDIF;
sDVeg0N0 = cDVeg0N0;
sNVeg0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDVeg0N0 * sDVeg0N0 ELSE cNVeg0N0 ENDIF;
sPVeg0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDVeg0N0 * sDVeg0N0 ELSE cPVeg0N0 ENDIF;
sVegHeight0N0 = MIN (cVegHeightN0, sDepthW0N0 );
sDBent0N0 = cDBent0N0;
sNBent0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDBentRefN0 * sDBent0N0 ELSE cNBent0N0 ENDIF;
sPBent0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDBentRefN0 * sDBent0N0 ELSE cPBent0N0 ENDIF;
sDepthWM0N0 = cDepthWM0N0;
MassWM0N0 = IF CalcMassN0 EQ TRUE THEN sDepthWM0N0 ELSE 1.0 ENDIF;
sNH4WM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNH4WEpi0N0 ELSE cNH4WM0N0 * MassWM0N0 ENDIF;
sNO3WM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNO3WEpi0N0 ELSE cNO3WM0N0 * MassWM0N0 ENDIF;
sPO4WM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPO4WEpi0N0 ELSE cPO4WM0N0 * MassWM0N0 ENDIF;
sPAIMWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPAIMWEpi0N0 ELSE cPAIMWM0N0 * MassWM0N0 ENDIF;
sSiO2WM0N0 = IF (InitCalcN0 EQ TRUE) THEN sSiO2WEpi0N0 ELSE cSiO2WM0N0 * MassWM0N0 ENDIF;
sO2WM0N0 = IF (InitCalcN0 EQ TRUE) THEN sO2WEpi0N0 ELSE cO2WM0N0 * MassWM0N0 ENDIF;
sDDetWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDDetWEpi0N0 ELSE cDDetWM0N0 * MassWM0N0 ENDIF;
sNDetWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNDetWEpi0N0 ELSE cNDetWM0N0 * MassWM0N0 ENDIF;
sPDetWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPDetWEpi0N0 ELSE cPDetWM0N0 * MassWM0N0 ENDIF;
sSiDetWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sSiDetWEpi0N0 ELSE cSiDetWM0N0 * MassWM0N0 ENDIF;
sDIMWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDIMWEpi0N0 ELSE cDIMWM0N0 * MassWM0N0 ENDIF;
sDDiatWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDDiatWEpi0N0 ELSE cDDiatWM0N0 * MassWM0N0 ENDIF;
sNDiatWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNDiatWEpi0N0 ELSE cNDiatWM0N0 * MassWM0N0 ENDIF;
sPDiatWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPDiatWEpi0N0 ELSE cPDiatWM0N0 * MassWM0N0 ENDIF;
sDGrenWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDGrenWEpi0N0 ELSE cDGrenWM0N0 * MassWM0N0 ENDIF;
sNGrenWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNGrenWEpi0N0 ELSE cNGrenWM0N0 * MassWM0N0 ENDIF;
sPGrenWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPGrenWEpi0N0 ELSE cPGrenWM0N0 * MassWM0N0 ENDIF;
sDBlueWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDBlueWEpi0N0 ELSE cDBlueWM0N0 * MassWM0N0 ENDIF;
sNBlueWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNBlueWEpi0N0 ELSE cNBlueWM0N0 * MassWM0N0 ENDIF;
sPBlueWM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPBlueWEpi0N0 ELSE cPBlueWM0N0 * MassWM0N0 ENDIF;
sDZooM0N0 = IF (InitCalcN0 EQ TRUE) THEN sDZooEpi0N0 ELSE cDZooM0N0 * MassWM0N0 ENDIF;
sNZooM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNZooEpi0N0 ELSE cNZooM0N0 * MassWM0N0 ENDIF;
sPZooM0N0 = IF (InitCalcN0 EQ TRUE) THEN sPZooEpi0N0 ELSE cPZooM0N0 * MassWM0N0 ENDIF;
sNH4SM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNH4S0N0 ELSE cNH4SM0N0 ENDIF;
sNO3SM0N0 = IF (InitCalcN0 EQ TRUE) THEN sNO3S0N0 ELSE cNO3SM0N0 ENDIF;
bRhoSolidSM0N0 = IF (InitCalcN0 EQ TRUE) THEN fDOrgSM0N0 * cRhoOMN0 +(1.0 - fDOrgSM0N0) * cRhoIMN0 ELSE fDOrgSM0N0 * cRhoOMN0 +(1.0 - fDOrgSM0N0) * cRhoIMN0 ENDIF;
bPorSM0N0 = IF (InitCalcN0 EQ TRUE) THEN (1.0 - fDTotSM0N0) * bRhoSolidSM0N0 / cRhoWatN0 /(fDTotSM0N0 + (1.0 - fDTotSM0N0) * bRhoSolidSM0N0 / cRhoWatN0) ELSE (1.0 - fDTotSM0N0) * bRhoSolidSM0N0 / cRhoWatN0 /(fDTotSM0N0 + (1.0 - fDTotSM0N0) * bRhoSolidSM0N0 / cRhoWatN0) ENDIF;
bRhoTotSM0N0 = IF (InitCalcN0 EQ TRUE) THEN bRhoSolidSM0N0 * (1.0 - bPorSM0N0) ELSE 0.0 ENDIF;
bDTotSM0N0 = IF (InitCalcN0 EQ TRUE) THEN bRhoTotSM0N0 * cDepthSMN0 ELSE 0.0 ENDIF;
fPAdsSM0N0 = IF (InitCalcN0 EQ TRUE) THEN fPAdsS0N0 ELSE 0.0 ENDIF;
sPO4SM0N0 = IF (InitCalcN0 EQ TRUE) THEN (1.0 - fPAdsSM0N0) * fPInorgSM0N0 * bDTotSM0N0 ELSE cPO4SM0N0 ENDIF;
sPAIMSM0N0 = IF (InitCalcN0 EQ TRUE) THEN fPAdsSM0N0 * fPInorgSM0N0 * bDTotSM0N0 ELSE cPAIMSM0N0 ENDIF;
sDDetSM0N0 = IF (InitCalcN0 EQ TRUE) THEN fDDetSM0N0 * fDOrgSM0N0 * bDTotSM0N0 ELSE cDDetSM0N0 ENDIF;
sNDetSM0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDDet0N0 * sDDetSM0N0 ELSE cNDetSM0N0 ENDIF;
sPDetSM0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDDet0N0 * sDDetSM0N0 ELSE cPDetSM0N0 ENDIF;
sSiDetSM0N0 = IF (InitCalcN0 EQ TRUE) THEN cSiDDet0N0 * sDDetSM0N0 ELSE cSiDetSM0N0 ENDIF;
sDHumSM0N0 = IF (InitCalcN0 EQ TRUE) THEN (1.0 - fDDetSM0N0) * fDOrgSM0N0 * bDTotSM0N0 ELSE cDHumSM0N0 ENDIF;
sNHumSM0N0 = IF (InitCalcN0 EQ TRUE) THEN cNDHum0N0 * sDHumSM0N0 ELSE cNHumSM0N0 ENDIF;
sPHumSM0N0 = IF (InitCalcN0 EQ TRUE) THEN cPDHum0N0 * sDHumSM0N0 ELSE cPHumSM0N0 ENDIF;
sDIMSM0N0 = IF (InitCalcN0 EQ TRUE) THEN bDTotSM0N0 - sDHumSM0N0 - sDDetSM0N0 ELSE cDIMSM0N0 ENDIF;
sDRootPhra0N0 = cDRootPhra0N0;
sDShootPhra0N0 = cDShootPhra0N0;
sNRootPhra0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN cNRootPhra0N0 ELSE cNDPhra0N0 * sDRootPhra0N0 ENDIF;
sNShootPhra0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN cNShootPhra0N0 ELSE cNDPhra0N0 * sDShootPhra0N0 ENDIF;
sPRootPhra0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN cPRootPhra0N0 ELSE cPDPhra0N0 * sDRootPhra0N0 ENDIF;
sPShootPhra0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN cPShootPhra0N0 ELSE cPDPhra0N0 * sDShootPhra0N0 ENDIF;
uDPhytWHyp0N0 = sDDiatWHyp0N0 + sDGrenWHyp0N0 + sDBlueWHyp0N0;
uDPhytWEpi0N0 = sDDiatWEpi0N0 + sDGrenWEpi0N0 + sDBlueWEpi0N0;
uPPhytWHyp0N0 = sPDiatWHyp0N0 + sPGrenWHyp0N0 + sPBlueWHyp0N0;
uPPhytWEpi0N0 = sPDiatWEpi0N0 + sPGrenWEpi0N0 + sPBlueWEpi0N0;
uNPhytWHyp0N0 = sNDiatWHyp0N0 + sNGrenWHyp0N0 + sNBlueWHyp0N0;
uNPhytWEpi0N0 = sNDiatWEpi0N0 + sNGrenWEpi0N0 + sNBlueWEpi0N0;
uDPhytS0N0 = sDDiatS0N0 + sDGrenS0N0 + sDBlueS0N0;
uPPhytS0N0 = sPDiatS0N0 + sPGrenS0N0 + sPBlueS0N0;
uNPhytS0N0 = sNDiatS0N0 + sNGrenS0N0 + sNBlueS0N0;
uDPhytWM0N0 = IF (InitCalcN0 EQ TRUE) THEN uDPhytWEpi0N0 ELSE sDGrenWM0N0 + sDDiatWM0N0 + sDBlueWM0N0 ENDIF;
uPPhytWM0N0 = IF (InitCalcN0 EQ TRUE) THEN uPPhytWEpi0N0 ELSE sPGrenWM0N0 + sPDiatWM0N0 + sPBlueWM0N0 ENDIF;
uNPhytWM0N0 = IF (InitCalcN0 EQ TRUE) THEN uNPhytWEpi0N0 ELSE sNGrenWM0N0 + sNDiatWM0N0 + sNBlueWM0N0 ENDIF;
uSiDiatWM0N0 = IF (InitCalcN0 EQ TRUE) THEN cSiDDiatN0 * sDDiatWEpi0N0 ELSE cSiDDiatN0 * sDDiatWM0N0 ENDIF;
uDVeg0N0 = sDVeg0N0;
uPVeg0N0 = sPVeg0N0;
uNVeg0N0 = sNVeg0N0;
uDFish0N0 = sDFiJv0N0 + sDFiAd0N0;
uPFish0N0 = sPFiJv0N0 + sPFiAd0N0;
uNFish0N0 = sNFiJv0N0 + sNFiAd0N0;
uPPisc0N0 = cPDPiscN0 * sDPisc0N0;
uNPisc0N0 = cNDPiscN0 * sDPisc0N0;
uO2TotTHyp0N0 = IF (aInclStrat0N0 EQ TRUE) THEN (sO2WHyp0N0 ) * (sDepthW0N0 - sMixDepthW0N0) / MassHyp0N0 ELSE 0.0 ENDIF;
uDTotTHyp0N0 = IF (aInclStrat0N0 EQ TRUE) THEN (sDIMWHyp0N0 + sDDetWHyp0N0 + uDPhytWHyp0N0 + sDZooHyp0N0) * (sDepthW0N0 - sMixDepthW0N0) / MassHyp0N0 ELSE 0.0 ENDIF;
uPTotTHyp0N0 = IF (aInclStrat0N0 EQ TRUE) THEN (sPO4WHyp0N0 + sPDetWHyp0N0 + sPAIMWHyp0N0 + uPPhytWHyp0N0 + sPZooHyp0N0) * (sDepthW0N0 - sMixDepthW0N0) / MassHyp0N0 ELSE 0.0 ENDIF;
uNTotTHyp0N0 = IF (aInclStrat0N0 EQ TRUE) THEN (sNH4WHyp0N0 + sNO3WHyp0N0 + sNDetWHyp0N0 + uNPhytWHyp0N0 + sNZooHyp0N0) * (sDepthW0N0 - sMixDepthW0N0) / MassHyp0N0 ELSE 0.0 ENDIF ;
uSiTotTHyp0N0 = IF (aInclStrat0N0 EQ TRUE) THEN (sSiO2WHyp0N0 + sSiDetWHyp0N0 + cSiDDiatN0 * sDDiatWHyp0N0) * (sDepthW0N0 - sMixDepthW0N0) / MassHyp0N0 ELSE 0.0 ENDIF;
uDTotTSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN sDBlueSurf0N0 ELSE 0.0 ENDIF;
uPTotTSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN sPBlueSurf0N0 ELSE 0.0 ENDIF;
uNTotTSurf0N0 = IF (InclSurfN0 EQ TRUE) THEN sNBlueSurf0N0 ELSE 0.0 ENDIF;
uDTotM0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSE ((sDIMWM0N0 + sDDetWM0N0 + uDPhytWM0N0 + sDZooM0N0) * sDepthWM0N0 / MassWM0N0 + sDIMSM0N0 + sDHumSM0N0 + sDDetSM0N0 + sDShootPhra0N0 + sDRootPhra0N0) * fMarshN0 ENDIF;
uPTotM0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSE ((sPO4WM0N0 + sPDetWM0N0 + sPAIMWM0N0 + uPPhytWM0N0 + sPZooM0N0) * sDepthWM0N0 / MassWM0N0 + sPO4SM0N0 + sPDetSM0N0 + sPHumSM0N0 + sPAIMSM0N0 + sPShootPhra0N0 + sPRootPhra0N0) * fMarshN0 ENDIF;
uNTotM0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSE ((sNH4WM0N0 + sNO3WM0N0 + sNDetWM0N0 + uNPhytWM0N0 + sNZooM0N0) * sDepthWM0N0 / MassWM0N0 + sNH4SM0N0 + sNO3SM0N0 + sNHumSM0N0 + sNDetSM0N0 + sNShootPhra0N0 + sNRootPhra0N0) * fMarshN0 ENDIF;
uSiTotM0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSE ((sSiO2WM0N0 + sSiDetWM0N0 + uSiDiatWM0N0) * sDepthWM0N0 / MassWM0N0 + sSiDetSM0N0) * fMarshN0 ENDIF;
uO2TotM0N0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSE ((sO2WM0N0) * sDepthWM0N0 / MassWM0N0 ) * fMarshN0 ENDIF;
uO2TotT0N0 = IF ((aInclStrat0N0 EQ TRUE) AND (sDepthW0N0 GE sMixDepthW0N0)) THEN uO2TotTHyp0N0 + ( sO2WEpi0N0) * sMixDepthW0N0 / MassEpi0N0 + uO2TotM0N0  ELSE ( sO2WEpi0N0) *sDepthW0N0 / MassEpi0N0 + uO2TotM0N0  ENDIF ;
uDTotT0N0 = IF ((aInclStrat0N0 EQ TRUE) AND (sDepthW0N0 GE sMixDepthW0N0)) THEN uDTotTHyp0N0 + (sDIMWEpi0N0 + sDDetWEpi0N0 + uDPhytWEpi0N0 + sDZooEpi0N0) * sMixDepthW0N0 / MassEpi0N0 + uDVeg0N0 + sDIMS0N0 + sDHumS0N0 + sDDetS0N0 + uDPhytS0N0 + uDFish0N0 + sDPisc0N0 + sDBent0N0 + uDTotM0N0 + uDTotTSurf0N0 ELSE (sDIMWEpi0N0 + sDDetWEpi0N0 + uDPhytWEpi0N0 + sDZooEpi0N0) * sDepthW0N0 / MassEpi0N0 + uDVeg0N0 + sDIMS0N0 + sDHumS0N0 + sDDetS0N0 + uDPhytS0N0 + uDFish0N0 + sDPisc0N0 + sDBent0N0 + uDTotM0N0 + uDTotTSurf0N0 ENDIF ;
uPTotT0N0 = IF ((aInclStrat0N0 EQ TRUE) AND (sDepthW0N0 GE sMixDepthW0N0)) THEN uPTotTHyp0N0 + (sPO4WEpi0N0 + sPDetWEpi0N0 + sPAIMWEpi0N0 + uPPhytWEpi0N0 + sPZooEpi0N0) * sMixDepthW0N0 / MassEpi0N0+ uPVeg0N0 + sPO4S0N0 + sPDetS0N0 + sPAIMS0N0 + sPHumS0N0 + uPPhytS0N0 + uPFish0N0 + uPPisc0N0 + sPBent0N0 + uPTotM0N0  + uPTotTSurf0N0 ELSE + (sPO4WEpi0N0 + sPDetWEpi0N0 + sPAIMWEpi0N0 + uPPhytWEpi0N0 + sPZooEpi0N0) * sDepthW0N0 / MassEpi0N0+ uPVeg0N0 + sPO4S0N0 + sPDetS0N0 + sPAIMS0N0 + sPHumS0N0 + uPPhytS0N0 + uPFish0N0 + uPPisc0N0 + sPBent0N0 + uPTotM0N0  + uPTotTSurf0N0 ENDIF  ;
uNTotT0N0 =  IF ((aInclStrat0N0 EQ TRUE) AND (sDepthW0N0 GE sMixDepthW0N0)) THEN  uNTotTHyp0N0 + (sNH4WEpi0N0 + sNO3WEpi0N0 + sNDetWEpi0N0 + uNPhytWEpi0N0 + sNZooEpi0N0) * sMixDepthW0N0 / MassEpi0N0 + uNVeg0N0 + sNH4S0N0 + sNO3S0N0 + sNDetS0N0 + uNPhytS0N0 + sNHumS0N0 + uNFish0N0 + uNPisc0N0 + sNBent0N0 + uNTotM0N0  + uNTotTSurf0N0 ELSE   (sNH4WEpi0N0 + sNO3WEpi0N0 + sNDetWEpi0N0 + uNPhytWEpi0N0 + sNZooEpi0N0) * sDepthW0N0 / MassEpi0N0 + uNVeg0N0 + sNH4S0N0 + sNO3S0N0 + sNDetS0N0 + uNPhytS0N0 + sNHumS0N0 + uNFish0N0 + uNPisc0N0 + sNBent0N0 + uNTotM0N0  + uNTotTSurf0N0 ENDIF;
uSiTotT0N0 = IF ((aInclStrat0N0 EQ TRUE) AND (sDepthW0N0 GE sMixDepthW0N0)) THEN uSiTotTHyp0N0+ (sSiO2WEpi0N0 + sSiDetWEpi0N0 + cSiDDiatN0 * sDDiatWEpi0N0) * sMixDepthW0N0 / MassEpi0N0 + sSiDetS0N0 + cSiDDiatN0*sDDiatS0N0 + uSiTotM0N0  ELSE (sSiO2WEpi0N0 + sSiDetWEpi0N0 + cSiDDiatN0 * sDDiatWEpi0N0) * sDepthW0N0 / MassEpi0N0 + sSiDetS0N0 + cSiDDiatN0*sDDiatS0N0 + uSiTotM0N0  ENDIF ;
sDExtTotT0N0 = uDTotT0N0;
sNExtTotT0N0 = uNTotT0N0;
sPExtTotT0N0 = uPTotT0N0;
sSiExtTotT0N0 = uSiTotT0N0;
sO2ExtTotT0N0 = uO2TotT0N0;
sDepthExtTotT0N0 = sDepthW0N0;
sMixDepthW0N1 = IF (InclStratN1 EQ FALSE) THEN 0.0 ELSEIF (InitMixDepthN1 EQ FALSE) THEN cMixDepthW0N1 ELSEIF (ReadMixDepthN1 EQ TRUE) THEN mMixDepthN1 ELSE cMixDepthN1 ENDIF;
aInclStrat0N1 =IF ( InclStratN1 EQ FALSE) THEN 0.0 ELSEIF (sMixDepthW0N1 GT cDepthWInit0N1 - cMinDepthHypEpiN1 ) THEN 0.0 ELSE 1.0 ENDIF;
sDepthW0N1 = IF (InitDepthN1 EQ TRUE) THEN cDepthWInit0N1 ELSE  cDepthW0N1 ENDIF ;
MassHyp0N1 = IF ( CalcMassN1 EQ TRUE  AND aInclStrat0N1 EQ TRUE ) THEN sDepthW0N1 - sMixDepthW0N1 ELSE cMinDepthHypEpiN1 ENDIF ;
sNH4WHyp0N1 = cNH4WHyp0N1 *MassHyp0N1;
sNO3WHyp0N1 = cNO3WHyp0N1 *MassHyp0N1;
sPO4WHyp0N1 = cPO4WHyp0N1 *MassHyp0N1;
sPAIMWHyp0N1 = cPAIMWHyp0N1 *MassHyp0N1;
sSiO2WHyp0N1 = cSiO2WHyp0N1 *MassHyp0N1;
sO2WHyp0N1 = cO2WHyp0N1 *MassHyp0N1;
sDDetWHyp0N1 = cDDetWHyp0N1 *MassHyp0N1;
sNDetWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDet0N1 * sDDetWHyp0N1 ELSE cNDetWHyp0N1 *MassHyp0N1 ENDIF;
sPDetWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDet0N1 * sDDetWHyp0N1 ELSE cPDetWHyp0N1 *MassHyp0N1 ENDIF;
sSiDetWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cSiDDet0N1 * sDDetWHyp0N1 ELSE cSiDetWHyp0N1 *MassHyp0N1 ENDIF;
sDIMWHyp0N1 = cDIMWHyp0N1 *MassHyp0N1;
sDDiatWHyp0N1 = cDDiatWHyp0N1 *MassHyp0N1;
sNDiatWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDiat0N1 * sDDiatWHyp0N1 ELSE cNDiatWHyp0N1 *MassHyp0N1 ENDIF;
sPDiatWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDiat0N1 * sDDiatWHyp0N1 ELSE cPDiatWHyp0N1 *MassHyp0N1 ENDIF;
sDGrenWHyp0N1 = cDGrenWHyp0N1 *MassHyp0N1;
sNGrenWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDGren0N1 * sDGrenWHyp0N1 ELSE cNGrenWHyp0N1 *MassHyp0N1 ENDIF;
sPGrenWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDGren0N1 * sDGrenWHyp0N1 ELSE cPGrenWHyp0N1 *MassHyp0N1 ENDIF;
sDBlueWHyp0N1 = cDBlueWHyp0N1 *MassHyp0N1;
sNBlueWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDBlue0N1 * sDBlueWHyp0N1 ELSE cNBlueWHyp0N1*MassHyp0N1 ENDIF;
sPBlueWHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDBlue0N1 * sDBlueWHyp0N1 ELSE cPBlueWHyp0N1 *MassHyp0N1 ENDIF;
sDZooHyp0N1 = cDZooHyp0N1 *MassHyp0N1;
sNZooHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDZooRefN1 * sDZooHyp0N1 ELSE cNZooHyp0N1 *MassHyp0N1 ENDIF;
sPZooHyp0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDZooRefN1 * sDZooHyp0N1 ELSE cPZooHyp0N1 *MassHyp0N1 ENDIF;
sDFiAd0N1 = cDFiAd0N1;
sDFiJv0N1 = cDFiJv0N1;
sNFiAd0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDFishRefN1 * sDFiAd0N1 ELSE cNFiAd0N1 ENDIF;
sNFiJv0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDFishRefN1 * sDFiJv0N1 ELSE cNFiJv0N1 ENDIF;
sPFiAd0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDFishRefN1 * sDFiAd0N1 ELSE cPFiAd0N1 ENDIF;
sPFiJv0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDFishRefN1 * sDFiJv0N1 ELSE cPFiJv0N1 ENDIF;
sDPisc0N1 = cDPisc0N1;
MassEpi0N1 = IF (CalcMassN1 EQ FALSE) THEN 1.0 ELSEIF (aInclStrat0N1 EQ FALSE) THEN sDepthW0N1 ELSEIF (sDepthW0N1  LT sMixDepthW0N1) THEN sDepthW0N1 ELSE sMixDepthW0N1 ENDIF;
sNH4WEpi0N1 = cNH4WEpi0N1 * MassEpi0N1;
sNO3WEpi0N1 = cNO3WEpi0N1 *MassEpi0N1;
sPO4WEpi0N1 = cPO4WEpi0N1 *MassEpi0N1;
sPAIMWEpi0N1 = cPAIMWEpi0N1 *MassEpi0N1;
sSiO2WEpi0N1 = cSiO2WEpi0N1 * MassEpi0N1;
sO2WEpi0N1 = cO2WEpi0N1 *MassEpi0N1;
sDDetWEpi0N1 = cDDetWEpi0N1 *MassEpi0N1;
sNDetWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDet0N1 * sDDetWEpi0N1 ELSE cNDetWEpi0N1 *MassEpi0N1 ENDIF ;
sPDetWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDet0N1 * sDDetWEpi0N1 ELSE cPDetWEpi0N1 *MassEpi0N1 ENDIF;
sSiDetWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cSiDDet0N1 * sDDetWEpi0N1 ELSE cSiDetWEpi0N1 *MassEpi0N1 ENDIF;
sDIMWEpi0N1 = cDIMWEpi0N1 *MassEpi0N1;
sDDiatWEpi0N1 = cDDiatWEpi0N1 *MassEpi0N1;
sNDiatWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDiat0N1 * sDDiatWEpi0N1 ELSE cNDiatWEpi0N1 *MassEpi0N1 ENDIF;
sPDiatWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDiat0N1 * sDDiatWEpi0N1 ELSE cPDiatWEpi0N1 *MassEpi0N1 ENDIF;
sDGrenWEpi0N1 = cDGrenWEpi0N1 *MassEpi0N1;
sNGrenWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDGren0N1 * sDGrenWEpi0N1 ELSE cNGrenWEpi0N1 *MassEpi0N1 ENDIF;
sPGrenWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDGren0N1 * sDGrenWEpi0N1 ELSE cPGrenWEpi0N1 *MassEpi0N1 ENDIF;
sDBlueWEpi0N1 = cDBlueWEpi0N1 *MassEpi0N1;
sNBlueWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDBlue0N1 * sDBlueWEpi0N1 ELSE cNBlueWEpi0N1 *MassEpi0N1 ENDIF;
sPBlueWEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDBlue0N1 * sDBlueWEpi0N1 ELSE cPBlueWEpi0N1 *MassEpi0N1 ENDIF;
sDZooEpi0N1 = cDZooEpi0N1 *MassEpi0N1;
sNZooEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDZooRefN1 * sDZooEpi0N1 ELSE cNZooEpi0N1 *MassEpi0N1 ENDIF;
sPZooEpi0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDZooRefN1 * sDZooEpi0N1 ELSE cPZooEpi0N1 *MassEpi0N1 ENDIF;
sDBlueSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN cDBlueSurf0N1 ELSE 0.0 ENDIF;
sNBlueSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN cNBlueSurf0N1 ELSE 0.0 ENDIF;
sPBlueSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN cPBlueSurf0N1 ELSE 0.0 ENDIF;
sNH4S0N1 = cNH4S0N1;
sNO3S0N1 = cNO3S0N1;
bRhoSolidS0N1 = fDOrgS0N1 * cRhoOMN1 + (1.0 - fDOrgS0N1) * cRhoIMN1;
bPorS0N1 = (1.0 - fDTotS0N1) * bRhoSolidS0N1 / cRhoWatN1 / ( fDTotS0N1 + (1.0 - fDTotS0N1) * bRhoSolidS0N1 / cRhoWatN1 );
bRhoTotS0N1 = bRhoSolidS0N1 * (1.0 - bPorS0N1);
bDTotS0N1 = bRhoTotS0N1 * cDepthSN1;
sPO4S0N1 = IF (InitCalcN1 EQ TRUE) THEN (1.0 - fPAdsS0N1) * fPInorgS0N1 * bDTotS0N1 ELSE cPO4S0N1 ENDIF;
sPAIMS0N1 = IF (InitCalcN1 EQ TRUE) THEN fPAdsS0N1 * fPInorgS0N1 * bDTotS0N1 ELSE cPAIMS0N1 ENDIF;
sDDetS0N1 = IF (InitCalcN1 EQ TRUE) THEN fDDetS0N1 * fDOrgS0N1 * bDTotS0N1 ELSE cDDetS0N1 ENDIF;
sNDetS0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDet0N1 * sDDetS0N1 ELSE cNDetS0N1 ENDIF;
sPDetS0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDet0N1 * sDDetS0N1 ELSE cPDetS0N1 ENDIF;
sSiDetS0N1 = IF (InitCalcN1 EQ TRUE) THEN cSiDDet0N1 * sDDetS0N1 ELSE cSiDetS0N1 ENDIF;
sDHumS0N1 = IF (InitCalcN1 EQ TRUE) THEN (1.0 - fDDetS0N1) * fDOrgS0N1 * bDTotS0N1 ELSE cDHumS0N1 ENDIF;
sNHumS0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDHum0N1 * sDHumS0N1 ELSE cNHumS0N1 ENDIF;
sPHumS0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDHum0N1 * sDHumS0N1 ELSE cPHumS0N1 ENDIF;
sDIMS0N1 = IF (InitCalcN1 EQ TRUE) THEN bDTotS0N1 - sDHumS0N1 - sDDetS0N1 ELSE cDIMS0N1 ENDIF;
sDDiatS0N1 = IF (InitCalcN1 EQ TRUE) THEN fSedPhyt0N1 * sDDiatWHyp0N1 ELSE cDDiatS0N1 ENDIF;
sNDiatS0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDiat0N1 * sDDiatS0N1 ELSE cNDiatS0N1 ENDIF;
sPDiatS0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDiat0N1 * sDDiatS0N1 ELSE cPDiatS0N1 ENDIF;
sDGrenS0N1 = IF (InitCalcN1 EQ TRUE) THEN fSedPhyt0N1 * sDGrenWHyp0N1 ELSE cDGrenS0N1 ENDIF;
sNGrenS0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDGren0N1 * sDGrenS0N1 ELSE cNGrenS0N1 ENDIF;
sPGrenS0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDGren0N1 * sDGrenS0N1 ELSE cPGrenS0N1 ENDIF;
sDBlueS0N1 = IF (InitCalcN1 EQ TRUE) THEN fSedPhyt0N1 * sDBlueWHyp0N1 ELSE cDBlueS0N1 ENDIF;
sNBlueS0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDBlue0N1 * sDBlueS0N1 ELSE cNBlueS0N1 ENDIF;
sPBlueS0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDBlue0N1 * sDBlueS0N1 ELSE cPBlueS0N1 ENDIF;
sDVeg0N1 = cDVeg0N1;
sNVeg0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDVeg0N1 * sDVeg0N1 ELSE cNVeg0N1 ENDIF;
sPVeg0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDVeg0N1 * sDVeg0N1 ELSE cPVeg0N1 ENDIF;
sVegHeight0N1 = MIN (cVegHeightN1, sDepthW0N1 );
sDBent0N1 = cDBent0N1;
sNBent0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDBentRefN1 * sDBent0N1 ELSE cNBent0N1 ENDIF;
sPBent0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDBentRefN1 * sDBent0N1 ELSE cPBent0N1 ENDIF;
sDepthWM0N1 = cDepthWM0N1;
MassWM0N1 = IF CalcMassN1 EQ TRUE THEN sDepthWM0N1 ELSE 1.0 ENDIF;
sNH4WM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNH4WEpi0N1 ELSE cNH4WM0N1 * MassWM0N1 ENDIF;
sNO3WM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNO3WEpi0N1 ELSE cNO3WM0N1 * MassWM0N1 ENDIF;
sPO4WM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPO4WEpi0N1 ELSE cPO4WM0N1 * MassWM0N1 ENDIF;
sPAIMWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPAIMWEpi0N1 ELSE cPAIMWM0N1 * MassWM0N1 ENDIF;
sSiO2WM0N1 = IF (InitCalcN1 EQ TRUE) THEN sSiO2WEpi0N1 ELSE cSiO2WM0N1 * MassWM0N1 ENDIF;
sO2WM0N1 = IF (InitCalcN1 EQ TRUE) THEN sO2WEpi0N1 ELSE cO2WM0N1 * MassWM0N1 ENDIF;
sDDetWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDDetWEpi0N1 ELSE cDDetWM0N1 * MassWM0N1 ENDIF;
sNDetWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNDetWEpi0N1 ELSE cNDetWM0N1 * MassWM0N1 ENDIF;
sPDetWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPDetWEpi0N1 ELSE cPDetWM0N1 * MassWM0N1 ENDIF;
sSiDetWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sSiDetWEpi0N1 ELSE cSiDetWM0N1 * MassWM0N1 ENDIF;
sDIMWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDIMWEpi0N1 ELSE cDIMWM0N1 * MassWM0N1 ENDIF;
sDDiatWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDDiatWEpi0N1 ELSE cDDiatWM0N1 * MassWM0N1 ENDIF;
sNDiatWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNDiatWEpi0N1 ELSE cNDiatWM0N1 * MassWM0N1 ENDIF;
sPDiatWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPDiatWEpi0N1 ELSE cPDiatWM0N1 * MassWM0N1 ENDIF;
sDGrenWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDGrenWEpi0N1 ELSE cDGrenWM0N1 * MassWM0N1 ENDIF;
sNGrenWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNGrenWEpi0N1 ELSE cNGrenWM0N1 * MassWM0N1 ENDIF;
sPGrenWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPGrenWEpi0N1 ELSE cPGrenWM0N1 * MassWM0N1 ENDIF;
sDBlueWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDBlueWEpi0N1 ELSE cDBlueWM0N1 * MassWM0N1 ENDIF;
sNBlueWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNBlueWEpi0N1 ELSE cNBlueWM0N1 * MassWM0N1 ENDIF;
sPBlueWM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPBlueWEpi0N1 ELSE cPBlueWM0N1 * MassWM0N1 ENDIF;
sDZooM0N1 = IF (InitCalcN1 EQ TRUE) THEN sDZooEpi0N1 ELSE cDZooM0N1 * MassWM0N1 ENDIF;
sNZooM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNZooEpi0N1 ELSE cNZooM0N1 * MassWM0N1 ENDIF;
sPZooM0N1 = IF (InitCalcN1 EQ TRUE) THEN sPZooEpi0N1 ELSE cPZooM0N1 * MassWM0N1 ENDIF;
sNH4SM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNH4S0N1 ELSE cNH4SM0N1 ENDIF;
sNO3SM0N1 = IF (InitCalcN1 EQ TRUE) THEN sNO3S0N1 ELSE cNO3SM0N1 ENDIF;
bRhoSolidSM0N1 = IF (InitCalcN1 EQ TRUE) THEN fDOrgSM0N1 * cRhoOMN1 +(1.0 - fDOrgSM0N1) * cRhoIMN1 ELSE fDOrgSM0N1 * cRhoOMN1 +(1.0 - fDOrgSM0N1) * cRhoIMN1 ENDIF;
bPorSM0N1 = IF (InitCalcN1 EQ TRUE) THEN (1.0 - fDTotSM0N1) * bRhoSolidSM0N1 / cRhoWatN1 /(fDTotSM0N1 + (1.0 - fDTotSM0N1) * bRhoSolidSM0N1 / cRhoWatN1) ELSE (1.0 - fDTotSM0N1) * bRhoSolidSM0N1 / cRhoWatN1 /(fDTotSM0N1 + (1.0 - fDTotSM0N1) * bRhoSolidSM0N1 / cRhoWatN1) ENDIF;
bRhoTotSM0N1 = IF (InitCalcN1 EQ TRUE) THEN bRhoSolidSM0N1 * (1.0 - bPorSM0N1) ELSE 0.0 ENDIF;
bDTotSM0N1 = IF (InitCalcN1 EQ TRUE) THEN bRhoTotSM0N1 * cDepthSMN1 ELSE 0.0 ENDIF;
fPAdsSM0N1 = IF (InitCalcN1 EQ TRUE) THEN fPAdsS0N1 ELSE 0.0 ENDIF;
sPO4SM0N1 = IF (InitCalcN1 EQ TRUE) THEN (1.0 - fPAdsSM0N1) * fPInorgSM0N1 * bDTotSM0N1 ELSE cPO4SM0N1 ENDIF;
sPAIMSM0N1 = IF (InitCalcN1 EQ TRUE) THEN fPAdsSM0N1 * fPInorgSM0N1 * bDTotSM0N1 ELSE cPAIMSM0N1 ENDIF;
sDDetSM0N1 = IF (InitCalcN1 EQ TRUE) THEN fDDetSM0N1 * fDOrgSM0N1 * bDTotSM0N1 ELSE cDDetSM0N1 ENDIF;
sNDetSM0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDDet0N1 * sDDetSM0N1 ELSE cNDetSM0N1 ENDIF;
sPDetSM0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDDet0N1 * sDDetSM0N1 ELSE cPDetSM0N1 ENDIF;
sSiDetSM0N1 = IF (InitCalcN1 EQ TRUE) THEN cSiDDet0N1 * sDDetSM0N1 ELSE cSiDetSM0N1 ENDIF;
sDHumSM0N1 = IF (InitCalcN1 EQ TRUE) THEN (1.0 - fDDetSM0N1) * fDOrgSM0N1 * bDTotSM0N1 ELSE cDHumSM0N1 ENDIF;
sNHumSM0N1 = IF (InitCalcN1 EQ TRUE) THEN cNDHum0N1 * sDHumSM0N1 ELSE cNHumSM0N1 ENDIF;
sPHumSM0N1 = IF (InitCalcN1 EQ TRUE) THEN cPDHum0N1 * sDHumSM0N1 ELSE cPHumSM0N1 ENDIF;
sDIMSM0N1 = IF (InitCalcN1 EQ TRUE) THEN bDTotSM0N1 - sDHumSM0N1 - sDDetSM0N1 ELSE cDIMSM0N1 ENDIF;
sDRootPhra0N1 = cDRootPhra0N1;
sDShootPhra0N1 = cDShootPhra0N1;
sNRootPhra0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN cNRootPhra0N1 ELSE cNDPhra0N1 * sDRootPhra0N1 ENDIF;
sNShootPhra0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN cNShootPhra0N1 ELSE cNDPhra0N1 * sDShootPhra0N1 ENDIF;
sPRootPhra0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN cPRootPhra0N1 ELSE cPDPhra0N1 * sDRootPhra0N1 ENDIF;
sPShootPhra0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN cPShootPhra0N1 ELSE cPDPhra0N1 * sDShootPhra0N1 ENDIF;
uDPhytWHyp0N1 = sDDiatWHyp0N1 + sDGrenWHyp0N1 + sDBlueWHyp0N1;
uDPhytWEpi0N1 = sDDiatWEpi0N1 + sDGrenWEpi0N1 + sDBlueWEpi0N1;
uPPhytWHyp0N1 = sPDiatWHyp0N1 + sPGrenWHyp0N1 + sPBlueWHyp0N1;
uPPhytWEpi0N1 = sPDiatWEpi0N1 + sPGrenWEpi0N1 + sPBlueWEpi0N1;
uNPhytWHyp0N1 = sNDiatWHyp0N1 + sNGrenWHyp0N1 + sNBlueWHyp0N1;
uNPhytWEpi0N1 = sNDiatWEpi0N1 + sNGrenWEpi0N1 + sNBlueWEpi0N1;
uDPhytS0N1 = sDDiatS0N1 + sDGrenS0N1 + sDBlueS0N1;
uPPhytS0N1 = sPDiatS0N1 + sPGrenS0N1 + sPBlueS0N1;
uNPhytS0N1 = sNDiatS0N1 + sNGrenS0N1 + sNBlueS0N1;
uDPhytWM0N1 = IF (InitCalcN1 EQ TRUE) THEN uDPhytWEpi0N1 ELSE sDGrenWM0N1 + sDDiatWM0N1 + sDBlueWM0N1 ENDIF;
uPPhytWM0N1 = IF (InitCalcN1 EQ TRUE) THEN uPPhytWEpi0N1 ELSE sPGrenWM0N1 + sPDiatWM0N1 + sPBlueWM0N1 ENDIF;
uNPhytWM0N1 = IF (InitCalcN1 EQ TRUE) THEN uNPhytWEpi0N1 ELSE sNGrenWM0N1 + sNDiatWM0N1 + sNBlueWM0N1 ENDIF;
uSiDiatWM0N1 = IF (InitCalcN1 EQ TRUE) THEN cSiDDiatN1 * sDDiatWEpi0N1 ELSE cSiDDiatN1 * sDDiatWM0N1 ENDIF;
uDVeg0N1 = sDVeg0N1;
uPVeg0N1 = sPVeg0N1;
uNVeg0N1 = sNVeg0N1;
uDFish0N1 = sDFiJv0N1 + sDFiAd0N1;
uPFish0N1 = sPFiJv0N1 + sPFiAd0N1;
uNFish0N1 = sNFiJv0N1 + sNFiAd0N1;
uPPisc0N1 = cPDPiscN1 * sDPisc0N1;
uNPisc0N1 = cNDPiscN1 * sDPisc0N1;
uO2TotTHyp0N1 = IF (aInclStrat0N1 EQ TRUE) THEN (sO2WHyp0N1 ) * (sDepthW0N1 - sMixDepthW0N1) / MassHyp0N1 ELSE 0.0 ENDIF;
uDTotTHyp0N1 = IF (aInclStrat0N1 EQ TRUE) THEN (sDIMWHyp0N1 + sDDetWHyp0N1 + uDPhytWHyp0N1 + sDZooHyp0N1) * (sDepthW0N1 - sMixDepthW0N1) / MassHyp0N1 ELSE 0.0 ENDIF;
uPTotTHyp0N1 = IF (aInclStrat0N1 EQ TRUE) THEN (sPO4WHyp0N1 + sPDetWHyp0N1 + sPAIMWHyp0N1 + uPPhytWHyp0N1 + sPZooHyp0N1) * (sDepthW0N1 - sMixDepthW0N1) / MassHyp0N1 ELSE 0.0 ENDIF;
uNTotTHyp0N1 = IF (aInclStrat0N1 EQ TRUE) THEN (sNH4WHyp0N1 + sNO3WHyp0N1 + sNDetWHyp0N1 + uNPhytWHyp0N1 + sNZooHyp0N1) * (sDepthW0N1 - sMixDepthW0N1) / MassHyp0N1 ELSE 0.0 ENDIF ;
uSiTotTHyp0N1 = IF (aInclStrat0N1 EQ TRUE) THEN (sSiO2WHyp0N1 + sSiDetWHyp0N1 + cSiDDiatN1 * sDDiatWHyp0N1) * (sDepthW0N1 - sMixDepthW0N1) / MassHyp0N1 ELSE 0.0 ENDIF;
uDTotTSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN sDBlueSurf0N1 ELSE 0.0 ENDIF;
uPTotTSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN sPBlueSurf0N1 ELSE 0.0 ENDIF;
uNTotTSurf0N1 = IF (InclSurfN1 EQ TRUE) THEN sNBlueSurf0N1 ELSE 0.0 ENDIF;
uDTotM0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSE ((sDIMWM0N1 + sDDetWM0N1 + uDPhytWM0N1 + sDZooM0N1) * sDepthWM0N1 / MassWM0N1 + sDIMSM0N1 + sDHumSM0N1 + sDDetSM0N1 + sDShootPhra0N1 + sDRootPhra0N1) * fMarshN1 ENDIF;
uPTotM0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSE ((sPO4WM0N1 + sPDetWM0N1 + sPAIMWM0N1 + uPPhytWM0N1 + sPZooM0N1) * sDepthWM0N1 / MassWM0N1 + sPO4SM0N1 + sPDetSM0N1 + sPHumSM0N1 + sPAIMSM0N1 + sPShootPhra0N1 + sPRootPhra0N1) * fMarshN1 ENDIF;
uNTotM0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSE ((sNH4WM0N1 + sNO3WM0N1 + sNDetWM0N1 + uNPhytWM0N1 + sNZooM0N1) * sDepthWM0N1 / MassWM0N1 + sNH4SM0N1 + sNO3SM0N1 + sNHumSM0N1 + sNDetSM0N1 + sNShootPhra0N1 + sNRootPhra0N1) * fMarshN1 ENDIF;
uSiTotM0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSE ((sSiO2WM0N1 + sSiDetWM0N1 + uSiDiatWM0N1) * sDepthWM0N1 / MassWM0N1 + sSiDetSM0N1) * fMarshN1 ENDIF;
uO2TotM0N1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSE ((sO2WM0N1) * sDepthWM0N1 / MassWM0N1 ) * fMarshN1 ENDIF;
uO2TotT0N1 = IF ((aInclStrat0N1 EQ TRUE) AND (sDepthW0N1 GE sMixDepthW0N1)) THEN uO2TotTHyp0N1 + ( sO2WEpi0N1) * sMixDepthW0N1 / MassEpi0N1 + uO2TotM0N1  ELSE ( sO2WEpi0N1) *sDepthW0N1 / MassEpi0N1 + uO2TotM0N1  ENDIF ;
uDTotT0N1 = IF ((aInclStrat0N1 EQ TRUE) AND (sDepthW0N1 GE sMixDepthW0N1)) THEN uDTotTHyp0N1 + (sDIMWEpi0N1 + sDDetWEpi0N1 + uDPhytWEpi0N1 + sDZooEpi0N1) * sMixDepthW0N1 / MassEpi0N1 + uDVeg0N1 + sDIMS0N1 + sDHumS0N1 + sDDetS0N1 + uDPhytS0N1 + uDFish0N1 + sDPisc0N1 + sDBent0N1 + uDTotM0N1 + uDTotTSurf0N1 ELSE (sDIMWEpi0N1 + sDDetWEpi0N1 + uDPhytWEpi0N1 + sDZooEpi0N1) * sDepthW0N1 / MassEpi0N1 + uDVeg0N1 + sDIMS0N1 + sDHumS0N1 + sDDetS0N1 + uDPhytS0N1 + uDFish0N1 + sDPisc0N1 + sDBent0N1 + uDTotM0N1 + uDTotTSurf0N1 ENDIF ;
uPTotT0N1 = IF ((aInclStrat0N1 EQ TRUE) AND (sDepthW0N1 GE sMixDepthW0N1)) THEN uPTotTHyp0N1 + (sPO4WEpi0N1 + sPDetWEpi0N1 + sPAIMWEpi0N1 + uPPhytWEpi0N1 + sPZooEpi0N1) * sMixDepthW0N1 / MassEpi0N1+ uPVeg0N1 + sPO4S0N1 + sPDetS0N1 + sPAIMS0N1 + sPHumS0N1 + uPPhytS0N1 + uPFish0N1 + uPPisc0N1 + sPBent0N1 + uPTotM0N1  + uPTotTSurf0N1 ELSE + (sPO4WEpi0N1 + sPDetWEpi0N1 + sPAIMWEpi0N1 + uPPhytWEpi0N1 + sPZooEpi0N1) * sDepthW0N1 / MassEpi0N1+ uPVeg0N1 + sPO4S0N1 + sPDetS0N1 + sPAIMS0N1 + sPHumS0N1 + uPPhytS0N1 + uPFish0N1 + uPPisc0N1 + sPBent0N1 + uPTotM0N1  + uPTotTSurf0N1 ENDIF  ;
uNTotT0N1 =  IF ((aInclStrat0N1 EQ TRUE) AND (sDepthW0N1 GE sMixDepthW0N1)) THEN  uNTotTHyp0N1 + (sNH4WEpi0N1 + sNO3WEpi0N1 + sNDetWEpi0N1 + uNPhytWEpi0N1 + sNZooEpi0N1) * sMixDepthW0N1 / MassEpi0N1 + uNVeg0N1 + sNH4S0N1 + sNO3S0N1 + sNDetS0N1 + uNPhytS0N1 + sNHumS0N1 + uNFish0N1 + uNPisc0N1 + sNBent0N1 + uNTotM0N1  + uNTotTSurf0N1 ELSE   (sNH4WEpi0N1 + sNO3WEpi0N1 + sNDetWEpi0N1 + uNPhytWEpi0N1 + sNZooEpi0N1) * sDepthW0N1 / MassEpi0N1 + uNVeg0N1 + sNH4S0N1 + sNO3S0N1 + sNDetS0N1 + uNPhytS0N1 + sNHumS0N1 + uNFish0N1 + uNPisc0N1 + sNBent0N1 + uNTotM0N1  + uNTotTSurf0N1 ENDIF;
uSiTotT0N1 = IF ((aInclStrat0N1 EQ TRUE) AND (sDepthW0N1 GE sMixDepthW0N1)) THEN uSiTotTHyp0N1+ (sSiO2WEpi0N1 + sSiDetWEpi0N1 + cSiDDiatN1 * sDDiatWEpi0N1) * sMixDepthW0N1 / MassEpi0N1 + sSiDetS0N1 + cSiDDiatN1*sDDiatS0N1 + uSiTotM0N1  ELSE (sSiO2WEpi0N1 + sSiDetWEpi0N1 + cSiDDiatN1 * sDDiatWEpi0N1) * sDepthW0N1 / MassEpi0N1 + sSiDetS0N1 + cSiDDiatN1*sDDiatS0N1 + uSiTotM0N1  ENDIF ;
sDExtTotT0N1 = uDTotT0N1;
sNExtTotT0N1 = uNTotT0N1;
sPExtTotT0N1 = uPTotT0N1;
sSiExtTotT0N1 = uSiTotT0N1;
sO2ExtTotT0N1 = uO2TotT0N1;
sDepthExtTotT0N1 = sDepthW0N1;
sMixDepthW0N2 = IF (InclStratN2 EQ FALSE) THEN 0.0 ELSEIF (InitMixDepthN2 EQ FALSE) THEN cMixDepthW0N2 ELSEIF (ReadMixDepthN2 EQ TRUE) THEN mMixDepthN2 ELSE cMixDepthN2 ENDIF;
aInclStrat0N2 =IF ( InclStratN2 EQ FALSE) THEN 0.0 ELSEIF (sMixDepthW0N2 GT cDepthWInit0N2 - cMinDepthHypEpiN2 ) THEN 0.0 ELSE 1.0 ENDIF;
sDepthW0N2 = IF (InitDepthN2 EQ TRUE) THEN cDepthWInit0N2 ELSE  cDepthW0N2 ENDIF ;
MassHyp0N2 = IF ( CalcMassN2 EQ TRUE  AND aInclStrat0N2 EQ TRUE ) THEN sDepthW0N2 - sMixDepthW0N2 ELSE cMinDepthHypEpiN2 ENDIF ;
sNH4WHyp0N2 = cNH4WHyp0N2 *MassHyp0N2;
sNO3WHyp0N2 = cNO3WHyp0N2 *MassHyp0N2;
sPO4WHyp0N2 = cPO4WHyp0N2 *MassHyp0N2;
sPAIMWHyp0N2 = cPAIMWHyp0N2 *MassHyp0N2;
sSiO2WHyp0N2 = cSiO2WHyp0N2 *MassHyp0N2;
sO2WHyp0N2 = cO2WHyp0N2 *MassHyp0N2;
sDDetWHyp0N2 = cDDetWHyp0N2 *MassHyp0N2;
sNDetWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDet0N2 * sDDetWHyp0N2 ELSE cNDetWHyp0N2 *MassHyp0N2 ENDIF;
sPDetWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDet0N2 * sDDetWHyp0N2 ELSE cPDetWHyp0N2 *MassHyp0N2 ENDIF;
sSiDetWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cSiDDet0N2 * sDDetWHyp0N2 ELSE cSiDetWHyp0N2 *MassHyp0N2 ENDIF;
sDIMWHyp0N2 = cDIMWHyp0N2 *MassHyp0N2;
sDDiatWHyp0N2 = cDDiatWHyp0N2 *MassHyp0N2;
sNDiatWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDiat0N2 * sDDiatWHyp0N2 ELSE cNDiatWHyp0N2 *MassHyp0N2 ENDIF;
sPDiatWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDiat0N2 * sDDiatWHyp0N2 ELSE cPDiatWHyp0N2 *MassHyp0N2 ENDIF;
sDGrenWHyp0N2 = cDGrenWHyp0N2 *MassHyp0N2;
sNGrenWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDGren0N2 * sDGrenWHyp0N2 ELSE cNGrenWHyp0N2 *MassHyp0N2 ENDIF;
sPGrenWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDGren0N2 * sDGrenWHyp0N2 ELSE cPGrenWHyp0N2 *MassHyp0N2 ENDIF;
sDBlueWHyp0N2 = cDBlueWHyp0N2 *MassHyp0N2;
sNBlueWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDBlue0N2 * sDBlueWHyp0N2 ELSE cNBlueWHyp0N2*MassHyp0N2 ENDIF;
sPBlueWHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDBlue0N2 * sDBlueWHyp0N2 ELSE cPBlueWHyp0N2 *MassHyp0N2 ENDIF;
sDZooHyp0N2 = cDZooHyp0N2 *MassHyp0N2;
sNZooHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDZooRefN2 * sDZooHyp0N2 ELSE cNZooHyp0N2 *MassHyp0N2 ENDIF;
sPZooHyp0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDZooRefN2 * sDZooHyp0N2 ELSE cPZooHyp0N2 *MassHyp0N2 ENDIF;
sDFiAd0N2 = cDFiAd0N2;
sDFiJv0N2 = cDFiJv0N2;
sNFiAd0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDFishRefN2 * sDFiAd0N2 ELSE cNFiAd0N2 ENDIF;
sNFiJv0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDFishRefN2 * sDFiJv0N2 ELSE cNFiJv0N2 ENDIF;
sPFiAd0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDFishRefN2 * sDFiAd0N2 ELSE cPFiAd0N2 ENDIF;
sPFiJv0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDFishRefN2 * sDFiJv0N2 ELSE cPFiJv0N2 ENDIF;
sDPisc0N2 = cDPisc0N2;
MassEpi0N2 = IF (CalcMassN2 EQ FALSE) THEN 1.0 ELSEIF (aInclStrat0N2 EQ FALSE) THEN sDepthW0N2 ELSEIF (sDepthW0N2  LT sMixDepthW0N2) THEN sDepthW0N2 ELSE sMixDepthW0N2 ENDIF;
sNH4WEpi0N2 = cNH4WEpi0N2 * MassEpi0N2;
sNO3WEpi0N2 = cNO3WEpi0N2 *MassEpi0N2;
sPO4WEpi0N2 = cPO4WEpi0N2 *MassEpi0N2;
sPAIMWEpi0N2 = cPAIMWEpi0N2 *MassEpi0N2;
sSiO2WEpi0N2 = cSiO2WEpi0N2 * MassEpi0N2;
sO2WEpi0N2 = cO2WEpi0N2 *MassEpi0N2;
sDDetWEpi0N2 = cDDetWEpi0N2 *MassEpi0N2;
sNDetWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDet0N2 * sDDetWEpi0N2 ELSE cNDetWEpi0N2 *MassEpi0N2 ENDIF ;
sPDetWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDet0N2 * sDDetWEpi0N2 ELSE cPDetWEpi0N2 *MassEpi0N2 ENDIF;
sSiDetWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cSiDDet0N2 * sDDetWEpi0N2 ELSE cSiDetWEpi0N2 *MassEpi0N2 ENDIF;
sDIMWEpi0N2 = cDIMWEpi0N2 *MassEpi0N2;
sDDiatWEpi0N2 = cDDiatWEpi0N2 *MassEpi0N2;
sNDiatWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDiat0N2 * sDDiatWEpi0N2 ELSE cNDiatWEpi0N2 *MassEpi0N2 ENDIF;
sPDiatWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDiat0N2 * sDDiatWEpi0N2 ELSE cPDiatWEpi0N2 *MassEpi0N2 ENDIF;
sDGrenWEpi0N2 = cDGrenWEpi0N2 *MassEpi0N2;
sNGrenWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDGren0N2 * sDGrenWEpi0N2 ELSE cNGrenWEpi0N2 *MassEpi0N2 ENDIF;
sPGrenWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDGren0N2 * sDGrenWEpi0N2 ELSE cPGrenWEpi0N2 *MassEpi0N2 ENDIF;
sDBlueWEpi0N2 = cDBlueWEpi0N2 *MassEpi0N2;
sNBlueWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDBlue0N2 * sDBlueWEpi0N2 ELSE cNBlueWEpi0N2 *MassEpi0N2 ENDIF;
sPBlueWEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDBlue0N2 * sDBlueWEpi0N2 ELSE cPBlueWEpi0N2 *MassEpi0N2 ENDIF;
sDZooEpi0N2 = cDZooEpi0N2 *MassEpi0N2;
sNZooEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDZooRefN2 * sDZooEpi0N2 ELSE cNZooEpi0N2 *MassEpi0N2 ENDIF;
sPZooEpi0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDZooRefN2 * sDZooEpi0N2 ELSE cPZooEpi0N2 *MassEpi0N2 ENDIF;
sDBlueSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN cDBlueSurf0N2 ELSE 0.0 ENDIF;
sNBlueSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN cNBlueSurf0N2 ELSE 0.0 ENDIF;
sPBlueSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN cPBlueSurf0N2 ELSE 0.0 ENDIF;
sNH4S0N2 = cNH4S0N2;
sNO3S0N2 = cNO3S0N2;
bRhoSolidS0N2 = fDOrgS0N2 * cRhoOMN2 + (1.0 - fDOrgS0N2) * cRhoIMN2;
bPorS0N2 = (1.0 - fDTotS0N2) * bRhoSolidS0N2 / cRhoWatN2 / ( fDTotS0N2 + (1.0 - fDTotS0N2) * bRhoSolidS0N2 / cRhoWatN2 );
bRhoTotS0N2 = bRhoSolidS0N2 * (1.0 - bPorS0N2);
bDTotS0N2 = bRhoTotS0N2 * cDepthSN2;
sPO4S0N2 = IF (InitCalcN2 EQ TRUE) THEN (1.0 - fPAdsS0N2) * fPInorgS0N2 * bDTotS0N2 ELSE cPO4S0N2 ENDIF;
sPAIMS0N2 = IF (InitCalcN2 EQ TRUE) THEN fPAdsS0N2 * fPInorgS0N2 * bDTotS0N2 ELSE cPAIMS0N2 ENDIF;
sDDetS0N2 = IF (InitCalcN2 EQ TRUE) THEN fDDetS0N2 * fDOrgS0N2 * bDTotS0N2 ELSE cDDetS0N2 ENDIF;
sNDetS0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDet0N2 * sDDetS0N2 ELSE cNDetS0N2 ENDIF;
sPDetS0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDet0N2 * sDDetS0N2 ELSE cPDetS0N2 ENDIF;
sSiDetS0N2 = IF (InitCalcN2 EQ TRUE) THEN cSiDDet0N2 * sDDetS0N2 ELSE cSiDetS0N2 ENDIF;
sDHumS0N2 = IF (InitCalcN2 EQ TRUE) THEN (1.0 - fDDetS0N2) * fDOrgS0N2 * bDTotS0N2 ELSE cDHumS0N2 ENDIF;
sNHumS0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDHum0N2 * sDHumS0N2 ELSE cNHumS0N2 ENDIF;
sPHumS0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDHum0N2 * sDHumS0N2 ELSE cPHumS0N2 ENDIF;
sDIMS0N2 = IF (InitCalcN2 EQ TRUE) THEN bDTotS0N2 - sDHumS0N2 - sDDetS0N2 ELSE cDIMS0N2 ENDIF;
sDDiatS0N2 = IF (InitCalcN2 EQ TRUE) THEN fSedPhyt0N2 * sDDiatWHyp0N2 ELSE cDDiatS0N2 ENDIF;
sNDiatS0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDiat0N2 * sDDiatS0N2 ELSE cNDiatS0N2 ENDIF;
sPDiatS0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDiat0N2 * sDDiatS0N2 ELSE cPDiatS0N2 ENDIF;
sDGrenS0N2 = IF (InitCalcN2 EQ TRUE) THEN fSedPhyt0N2 * sDGrenWHyp0N2 ELSE cDGrenS0N2 ENDIF;
sNGrenS0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDGren0N2 * sDGrenS0N2 ELSE cNGrenS0N2 ENDIF;
sPGrenS0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDGren0N2 * sDGrenS0N2 ELSE cPGrenS0N2 ENDIF;
sDBlueS0N2 = IF (InitCalcN2 EQ TRUE) THEN fSedPhyt0N2 * sDBlueWHyp0N2 ELSE cDBlueS0N2 ENDIF;
sNBlueS0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDBlue0N2 * sDBlueS0N2 ELSE cNBlueS0N2 ENDIF;
sPBlueS0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDBlue0N2 * sDBlueS0N2 ELSE cPBlueS0N2 ENDIF;
sDVeg0N2 = cDVeg0N2;
sNVeg0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDVeg0N2 * sDVeg0N2 ELSE cNVeg0N2 ENDIF;
sPVeg0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDVeg0N2 * sDVeg0N2 ELSE cPVeg0N2 ENDIF;
sVegHeight0N2 = MIN (cVegHeightN2, sDepthW0N2 );
sDBent0N2 = cDBent0N2;
sNBent0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDBentRefN2 * sDBent0N2 ELSE cNBent0N2 ENDIF;
sPBent0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDBentRefN2 * sDBent0N2 ELSE cPBent0N2 ENDIF;
sDepthWM0N2 = cDepthWM0N2;
MassWM0N2 = IF CalcMassN2 EQ TRUE THEN sDepthWM0N2 ELSE 1.0 ENDIF;
sNH4WM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNH4WEpi0N2 ELSE cNH4WM0N2 * MassWM0N2 ENDIF;
sNO3WM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNO3WEpi0N2 ELSE cNO3WM0N2 * MassWM0N2 ENDIF;
sPO4WM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPO4WEpi0N2 ELSE cPO4WM0N2 * MassWM0N2 ENDIF;
sPAIMWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPAIMWEpi0N2 ELSE cPAIMWM0N2 * MassWM0N2 ENDIF;
sSiO2WM0N2 = IF (InitCalcN2 EQ TRUE) THEN sSiO2WEpi0N2 ELSE cSiO2WM0N2 * MassWM0N2 ENDIF;
sO2WM0N2 = IF (InitCalcN2 EQ TRUE) THEN sO2WEpi0N2 ELSE cO2WM0N2 * MassWM0N2 ENDIF;
sDDetWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDDetWEpi0N2 ELSE cDDetWM0N2 * MassWM0N2 ENDIF;
sNDetWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNDetWEpi0N2 ELSE cNDetWM0N2 * MassWM0N2 ENDIF;
sPDetWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPDetWEpi0N2 ELSE cPDetWM0N2 * MassWM0N2 ENDIF;
sSiDetWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sSiDetWEpi0N2 ELSE cSiDetWM0N2 * MassWM0N2 ENDIF;
sDIMWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDIMWEpi0N2 ELSE cDIMWM0N2 * MassWM0N2 ENDIF;
sDDiatWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDDiatWEpi0N2 ELSE cDDiatWM0N2 * MassWM0N2 ENDIF;
sNDiatWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNDiatWEpi0N2 ELSE cNDiatWM0N2 * MassWM0N2 ENDIF;
sPDiatWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPDiatWEpi0N2 ELSE cPDiatWM0N2 * MassWM0N2 ENDIF;
sDGrenWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDGrenWEpi0N2 ELSE cDGrenWM0N2 * MassWM0N2 ENDIF;
sNGrenWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNGrenWEpi0N2 ELSE cNGrenWM0N2 * MassWM0N2 ENDIF;
sPGrenWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPGrenWEpi0N2 ELSE cPGrenWM0N2 * MassWM0N2 ENDIF;
sDBlueWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDBlueWEpi0N2 ELSE cDBlueWM0N2 * MassWM0N2 ENDIF;
sNBlueWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNBlueWEpi0N2 ELSE cNBlueWM0N2 * MassWM0N2 ENDIF;
sPBlueWM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPBlueWEpi0N2 ELSE cPBlueWM0N2 * MassWM0N2 ENDIF;
sDZooM0N2 = IF (InitCalcN2 EQ TRUE) THEN sDZooEpi0N2 ELSE cDZooM0N2 * MassWM0N2 ENDIF;
sNZooM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNZooEpi0N2 ELSE cNZooM0N2 * MassWM0N2 ENDIF;
sPZooM0N2 = IF (InitCalcN2 EQ TRUE) THEN sPZooEpi0N2 ELSE cPZooM0N2 * MassWM0N2 ENDIF;
sNH4SM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNH4S0N2 ELSE cNH4SM0N2 ENDIF;
sNO3SM0N2 = IF (InitCalcN2 EQ TRUE) THEN sNO3S0N2 ELSE cNO3SM0N2 ENDIF;
bRhoSolidSM0N2 = IF (InitCalcN2 EQ TRUE) THEN fDOrgSM0N2 * cRhoOMN2 +(1.0 - fDOrgSM0N2) * cRhoIMN2 ELSE fDOrgSM0N2 * cRhoOMN2 +(1.0 - fDOrgSM0N2) * cRhoIMN2 ENDIF;
bPorSM0N2 = IF (InitCalcN2 EQ TRUE) THEN (1.0 - fDTotSM0N2) * bRhoSolidSM0N2 / cRhoWatN2 /(fDTotSM0N2 + (1.0 - fDTotSM0N2) * bRhoSolidSM0N2 / cRhoWatN2) ELSE (1.0 - fDTotSM0N2) * bRhoSolidSM0N2 / cRhoWatN2 /(fDTotSM0N2 + (1.0 - fDTotSM0N2) * bRhoSolidSM0N2 / cRhoWatN2) ENDIF;
bRhoTotSM0N2 = IF (InitCalcN2 EQ TRUE) THEN bRhoSolidSM0N2 * (1.0 - bPorSM0N2) ELSE 0.0 ENDIF;
bDTotSM0N2 = IF (InitCalcN2 EQ TRUE) THEN bRhoTotSM0N2 * cDepthSMN2 ELSE 0.0 ENDIF;
fPAdsSM0N2 = IF (InitCalcN2 EQ TRUE) THEN fPAdsS0N2 ELSE 0.0 ENDIF;
sPO4SM0N2 = IF (InitCalcN2 EQ TRUE) THEN (1.0 - fPAdsSM0N2) * fPInorgSM0N2 * bDTotSM0N2 ELSE cPO4SM0N2 ENDIF;
sPAIMSM0N2 = IF (InitCalcN2 EQ TRUE) THEN fPAdsSM0N2 * fPInorgSM0N2 * bDTotSM0N2 ELSE cPAIMSM0N2 ENDIF;
sDDetSM0N2 = IF (InitCalcN2 EQ TRUE) THEN fDDetSM0N2 * fDOrgSM0N2 * bDTotSM0N2 ELSE cDDetSM0N2 ENDIF;
sNDetSM0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDDet0N2 * sDDetSM0N2 ELSE cNDetSM0N2 ENDIF;
sPDetSM0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDDet0N2 * sDDetSM0N2 ELSE cPDetSM0N2 ENDIF;
sSiDetSM0N2 = IF (InitCalcN2 EQ TRUE) THEN cSiDDet0N2 * sDDetSM0N2 ELSE cSiDetSM0N2 ENDIF;
sDHumSM0N2 = IF (InitCalcN2 EQ TRUE) THEN (1.0 - fDDetSM0N2) * fDOrgSM0N2 * bDTotSM0N2 ELSE cDHumSM0N2 ENDIF;
sNHumSM0N2 = IF (InitCalcN2 EQ TRUE) THEN cNDHum0N2 * sDHumSM0N2 ELSE cNHumSM0N2 ENDIF;
sPHumSM0N2 = IF (InitCalcN2 EQ TRUE) THEN cPDHum0N2 * sDHumSM0N2 ELSE cPHumSM0N2 ENDIF;
sDIMSM0N2 = IF (InitCalcN2 EQ TRUE) THEN bDTotSM0N2 - sDHumSM0N2 - sDDetSM0N2 ELSE cDIMSM0N2 ENDIF;
sDRootPhra0N2 = cDRootPhra0N2;
sDShootPhra0N2 = cDShootPhra0N2;
sNRootPhra0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN cNRootPhra0N2 ELSE cNDPhra0N2 * sDRootPhra0N2 ENDIF;
sNShootPhra0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN cNShootPhra0N2 ELSE cNDPhra0N2 * sDShootPhra0N2 ENDIF;
sPRootPhra0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN cPRootPhra0N2 ELSE cPDPhra0N2 * sDRootPhra0N2 ENDIF;
sPShootPhra0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN cPShootPhra0N2 ELSE cPDPhra0N2 * sDShootPhra0N2 ENDIF;
uDPhytWHyp0N2 = sDDiatWHyp0N2 + sDGrenWHyp0N2 + sDBlueWHyp0N2;
uDPhytWEpi0N2 = sDDiatWEpi0N2 + sDGrenWEpi0N2 + sDBlueWEpi0N2;
uPPhytWHyp0N2 = sPDiatWHyp0N2 + sPGrenWHyp0N2 + sPBlueWHyp0N2;
uPPhytWEpi0N2 = sPDiatWEpi0N2 + sPGrenWEpi0N2 + sPBlueWEpi0N2;
uNPhytWHyp0N2 = sNDiatWHyp0N2 + sNGrenWHyp0N2 + sNBlueWHyp0N2;
uNPhytWEpi0N2 = sNDiatWEpi0N2 + sNGrenWEpi0N2 + sNBlueWEpi0N2;
uDPhytS0N2 = sDDiatS0N2 + sDGrenS0N2 + sDBlueS0N2;
uPPhytS0N2 = sPDiatS0N2 + sPGrenS0N2 + sPBlueS0N2;
uNPhytS0N2 = sNDiatS0N2 + sNGrenS0N2 + sNBlueS0N2;
uDPhytWM0N2 = IF (InitCalcN2 EQ TRUE) THEN uDPhytWEpi0N2 ELSE sDGrenWM0N2 + sDDiatWM0N2 + sDBlueWM0N2 ENDIF;
uPPhytWM0N2 = IF (InitCalcN2 EQ TRUE) THEN uPPhytWEpi0N2 ELSE sPGrenWM0N2 + sPDiatWM0N2 + sPBlueWM0N2 ENDIF;
uNPhytWM0N2 = IF (InitCalcN2 EQ TRUE) THEN uNPhytWEpi0N2 ELSE sNGrenWM0N2 + sNDiatWM0N2 + sNBlueWM0N2 ENDIF;
uSiDiatWM0N2 = IF (InitCalcN2 EQ TRUE) THEN cSiDDiatN2 * sDDiatWEpi0N2 ELSE cSiDDiatN2 * sDDiatWM0N2 ENDIF;
uDVeg0N2 = sDVeg0N2;
uPVeg0N2 = sPVeg0N2;
uNVeg0N2 = sNVeg0N2;
uDFish0N2 = sDFiJv0N2 + sDFiAd0N2;
uPFish0N2 = sPFiJv0N2 + sPFiAd0N2;
uNFish0N2 = sNFiJv0N2 + sNFiAd0N2;
uPPisc0N2 = cPDPiscN2 * sDPisc0N2;
uNPisc0N2 = cNDPiscN2 * sDPisc0N2;
uO2TotTHyp0N2 = IF (aInclStrat0N2 EQ TRUE) THEN (sO2WHyp0N2 ) * (sDepthW0N2 - sMixDepthW0N2) / MassHyp0N2 ELSE 0.0 ENDIF;
uDTotTHyp0N2 = IF (aInclStrat0N2 EQ TRUE) THEN (sDIMWHyp0N2 + sDDetWHyp0N2 + uDPhytWHyp0N2 + sDZooHyp0N2) * (sDepthW0N2 - sMixDepthW0N2) / MassHyp0N2 ELSE 0.0 ENDIF;
uPTotTHyp0N2 = IF (aInclStrat0N2 EQ TRUE) THEN (sPO4WHyp0N2 + sPDetWHyp0N2 + sPAIMWHyp0N2 + uPPhytWHyp0N2 + sPZooHyp0N2) * (sDepthW0N2 - sMixDepthW0N2) / MassHyp0N2 ELSE 0.0 ENDIF;
uNTotTHyp0N2 = IF (aInclStrat0N2 EQ TRUE) THEN (sNH4WHyp0N2 + sNO3WHyp0N2 + sNDetWHyp0N2 + uNPhytWHyp0N2 + sNZooHyp0N2) * (sDepthW0N2 - sMixDepthW0N2) / MassHyp0N2 ELSE 0.0 ENDIF ;
uSiTotTHyp0N2 = IF (aInclStrat0N2 EQ TRUE) THEN (sSiO2WHyp0N2 + sSiDetWHyp0N2 + cSiDDiatN2 * sDDiatWHyp0N2) * (sDepthW0N2 - sMixDepthW0N2) / MassHyp0N2 ELSE 0.0 ENDIF;
uDTotTSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN sDBlueSurf0N2 ELSE 0.0 ENDIF;
uPTotTSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN sPBlueSurf0N2 ELSE 0.0 ENDIF;
uNTotTSurf0N2 = IF (InclSurfN2 EQ TRUE) THEN sNBlueSurf0N2 ELSE 0.0 ENDIF;
uDTotM0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSE ((sDIMWM0N2 + sDDetWM0N2 + uDPhytWM0N2 + sDZooM0N2) * sDepthWM0N2 / MassWM0N2 + sDIMSM0N2 + sDHumSM0N2 + sDDetSM0N2 + sDShootPhra0N2 + sDRootPhra0N2) * fMarshN2 ENDIF;
uPTotM0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSE ((sPO4WM0N2 + sPDetWM0N2 + sPAIMWM0N2 + uPPhytWM0N2 + sPZooM0N2) * sDepthWM0N2 / MassWM0N2 + sPO4SM0N2 + sPDetSM0N2 + sPHumSM0N2 + sPAIMSM0N2 + sPShootPhra0N2 + sPRootPhra0N2) * fMarshN2 ENDIF;
uNTotM0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSE ((sNH4WM0N2 + sNO3WM0N2 + sNDetWM0N2 + uNPhytWM0N2 + sNZooM0N2) * sDepthWM0N2 / MassWM0N2 + sNH4SM0N2 + sNO3SM0N2 + sNHumSM0N2 + sNDetSM0N2 + sNShootPhra0N2 + sNRootPhra0N2) * fMarshN2 ENDIF;
uSiTotM0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSE ((sSiO2WM0N2 + sSiDetWM0N2 + uSiDiatWM0N2) * sDepthWM0N2 / MassWM0N2 + sSiDetSM0N2) * fMarshN2 ENDIF;
uO2TotM0N2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSE ((sO2WM0N2) * sDepthWM0N2 / MassWM0N2 ) * fMarshN2 ENDIF;
uO2TotT0N2 = IF ((aInclStrat0N2 EQ TRUE) AND (sDepthW0N2 GE sMixDepthW0N2)) THEN uO2TotTHyp0N2 + ( sO2WEpi0N2) * sMixDepthW0N2 / MassEpi0N2 + uO2TotM0N2  ELSE ( sO2WEpi0N2) *sDepthW0N2 / MassEpi0N2 + uO2TotM0N2  ENDIF ;
uDTotT0N2 = IF ((aInclStrat0N2 EQ TRUE) AND (sDepthW0N2 GE sMixDepthW0N2)) THEN uDTotTHyp0N2 + (sDIMWEpi0N2 + sDDetWEpi0N2 + uDPhytWEpi0N2 + sDZooEpi0N2) * sMixDepthW0N2 / MassEpi0N2 + uDVeg0N2 + sDIMS0N2 + sDHumS0N2 + sDDetS0N2 + uDPhytS0N2 + uDFish0N2 + sDPisc0N2 + sDBent0N2 + uDTotM0N2 + uDTotTSurf0N2 ELSE (sDIMWEpi0N2 + sDDetWEpi0N2 + uDPhytWEpi0N2 + sDZooEpi0N2) * sDepthW0N2 / MassEpi0N2 + uDVeg0N2 + sDIMS0N2 + sDHumS0N2 + sDDetS0N2 + uDPhytS0N2 + uDFish0N2 + sDPisc0N2 + sDBent0N2 + uDTotM0N2 + uDTotTSurf0N2 ENDIF ;
uPTotT0N2 = IF ((aInclStrat0N2 EQ TRUE) AND (sDepthW0N2 GE sMixDepthW0N2)) THEN uPTotTHyp0N2 + (sPO4WEpi0N2 + sPDetWEpi0N2 + sPAIMWEpi0N2 + uPPhytWEpi0N2 + sPZooEpi0N2) * sMixDepthW0N2 / MassEpi0N2+ uPVeg0N2 + sPO4S0N2 + sPDetS0N2 + sPAIMS0N2 + sPHumS0N2 + uPPhytS0N2 + uPFish0N2 + uPPisc0N2 + sPBent0N2 + uPTotM0N2  + uPTotTSurf0N2 ELSE + (sPO4WEpi0N2 + sPDetWEpi0N2 + sPAIMWEpi0N2 + uPPhytWEpi0N2 + sPZooEpi0N2) * sDepthW0N2 / MassEpi0N2+ uPVeg0N2 + sPO4S0N2 + sPDetS0N2 + sPAIMS0N2 + sPHumS0N2 + uPPhytS0N2 + uPFish0N2 + uPPisc0N2 + sPBent0N2 + uPTotM0N2  + uPTotTSurf0N2 ENDIF  ;
uNTotT0N2 =  IF ((aInclStrat0N2 EQ TRUE) AND (sDepthW0N2 GE sMixDepthW0N2)) THEN  uNTotTHyp0N2 + (sNH4WEpi0N2 + sNO3WEpi0N2 + sNDetWEpi0N2 + uNPhytWEpi0N2 + sNZooEpi0N2) * sMixDepthW0N2 / MassEpi0N2 + uNVeg0N2 + sNH4S0N2 + sNO3S0N2 + sNDetS0N2 + uNPhytS0N2 + sNHumS0N2 + uNFish0N2 + uNPisc0N2 + sNBent0N2 + uNTotM0N2  + uNTotTSurf0N2 ELSE   (sNH4WEpi0N2 + sNO3WEpi0N2 + sNDetWEpi0N2 + uNPhytWEpi0N2 + sNZooEpi0N2) * sDepthW0N2 / MassEpi0N2 + uNVeg0N2 + sNH4S0N2 + sNO3S0N2 + sNDetS0N2 + uNPhytS0N2 + sNHumS0N2 + uNFish0N2 + uNPisc0N2 + sNBent0N2 + uNTotM0N2  + uNTotTSurf0N2 ENDIF;
uSiTotT0N2 = IF ((aInclStrat0N2 EQ TRUE) AND (sDepthW0N2 GE sMixDepthW0N2)) THEN uSiTotTHyp0N2+ (sSiO2WEpi0N2 + sSiDetWEpi0N2 + cSiDDiatN2 * sDDiatWEpi0N2) * sMixDepthW0N2 / MassEpi0N2 + sSiDetS0N2 + cSiDDiatN2*sDDiatS0N2 + uSiTotM0N2  ELSE (sSiO2WEpi0N2 + sSiDetWEpi0N2 + cSiDDiatN2 * sDDiatWEpi0N2) * sDepthW0N2 / MassEpi0N2 + sSiDetS0N2 + cSiDDiatN2*sDDiatS0N2 + uSiTotM0N2  ENDIF ;
sDExtTotT0N2 = uDTotT0N2;
sNExtTotT0N2 = uNTotT0N2;
sPExtTotT0N2 = uPTotT0N2;
sSiExtTotT0N2 = uSiTotT0N2;
sO2ExtTotT0N2 = uO2TotT0N2;
sDepthExtTotT0N2 = sDepthW0N2;
sMixDepthW0N3 = IF (InclStratN3 EQ FALSE) THEN 0.0 ELSEIF (InitMixDepthN3 EQ FALSE) THEN cMixDepthW0N3 ELSEIF (ReadMixDepthN3 EQ TRUE) THEN mMixDepthN3 ELSE cMixDepthN3 ENDIF;
aInclStrat0N3 =IF ( InclStratN3 EQ FALSE) THEN 0.0 ELSEIF (sMixDepthW0N3 GT cDepthWInit0N3 - cMinDepthHypEpiN3 ) THEN 0.0 ELSE 1.0 ENDIF;
sDepthW0N3 = IF (InitDepthN3 EQ TRUE) THEN cDepthWInit0N3 ELSE  cDepthW0N3 ENDIF ;
MassHyp0N3 = IF ( CalcMassN3 EQ TRUE  AND aInclStrat0N3 EQ TRUE ) THEN sDepthW0N3 - sMixDepthW0N3 ELSE cMinDepthHypEpiN3 ENDIF ;
sNH4WHyp0N3 = cNH4WHyp0N3 *MassHyp0N3;
sNO3WHyp0N3 = cNO3WHyp0N3 *MassHyp0N3;
sPO4WHyp0N3 = cPO4WHyp0N3 *MassHyp0N3;
sPAIMWHyp0N3 = cPAIMWHyp0N3 *MassHyp0N3;
sSiO2WHyp0N3 = cSiO2WHyp0N3 *MassHyp0N3;
sO2WHyp0N3 = cO2WHyp0N3 *MassHyp0N3;
sDDetWHyp0N3 = cDDetWHyp0N3 *MassHyp0N3;
sNDetWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDet0N3 * sDDetWHyp0N3 ELSE cNDetWHyp0N3 *MassHyp0N3 ENDIF;
sPDetWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDet0N3 * sDDetWHyp0N3 ELSE cPDetWHyp0N3 *MassHyp0N3 ENDIF;
sSiDetWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cSiDDet0N3 * sDDetWHyp0N3 ELSE cSiDetWHyp0N3 *MassHyp0N3 ENDIF;
sDIMWHyp0N3 = cDIMWHyp0N3 *MassHyp0N3;
sDDiatWHyp0N3 = cDDiatWHyp0N3 *MassHyp0N3;
sNDiatWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDiat0N3 * sDDiatWHyp0N3 ELSE cNDiatWHyp0N3 *MassHyp0N3 ENDIF;
sPDiatWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDiat0N3 * sDDiatWHyp0N3 ELSE cPDiatWHyp0N3 *MassHyp0N3 ENDIF;
sDGrenWHyp0N3 = cDGrenWHyp0N3 *MassHyp0N3;
sNGrenWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDGren0N3 * sDGrenWHyp0N3 ELSE cNGrenWHyp0N3 *MassHyp0N3 ENDIF;
sPGrenWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDGren0N3 * sDGrenWHyp0N3 ELSE cPGrenWHyp0N3 *MassHyp0N3 ENDIF;
sDBlueWHyp0N3 = cDBlueWHyp0N3 *MassHyp0N3;
sNBlueWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDBlue0N3 * sDBlueWHyp0N3 ELSE cNBlueWHyp0N3*MassHyp0N3 ENDIF;
sPBlueWHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDBlue0N3 * sDBlueWHyp0N3 ELSE cPBlueWHyp0N3 *MassHyp0N3 ENDIF;
sDZooHyp0N3 = cDZooHyp0N3 *MassHyp0N3;
sNZooHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDZooRefN3 * sDZooHyp0N3 ELSE cNZooHyp0N3 *MassHyp0N3 ENDIF;
sPZooHyp0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDZooRefN3 * sDZooHyp0N3 ELSE cPZooHyp0N3 *MassHyp0N3 ENDIF;
sDFiAd0N3 = cDFiAd0N3;
sDFiJv0N3 = cDFiJv0N3;
sNFiAd0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDFishRefN3 * sDFiAd0N3 ELSE cNFiAd0N3 ENDIF;
sNFiJv0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDFishRefN3 * sDFiJv0N3 ELSE cNFiJv0N3 ENDIF;
sPFiAd0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDFishRefN3 * sDFiAd0N3 ELSE cPFiAd0N3 ENDIF;
sPFiJv0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDFishRefN3 * sDFiJv0N3 ELSE cPFiJv0N3 ENDIF;
sDPisc0N3 = cDPisc0N3;
MassEpi0N3 = IF (CalcMassN3 EQ FALSE) THEN 1.0 ELSEIF (aInclStrat0N3 EQ FALSE) THEN sDepthW0N3 ELSEIF (sDepthW0N3  LT sMixDepthW0N3) THEN sDepthW0N3 ELSE sMixDepthW0N3 ENDIF;
sNH4WEpi0N3 = cNH4WEpi0N3 * MassEpi0N3;
sNO3WEpi0N3 = cNO3WEpi0N3 *MassEpi0N3;
sPO4WEpi0N3 = cPO4WEpi0N3 *MassEpi0N3;
sPAIMWEpi0N3 = cPAIMWEpi0N3 *MassEpi0N3;
sSiO2WEpi0N3 = cSiO2WEpi0N3 * MassEpi0N3;
sO2WEpi0N3 = cO2WEpi0N3 *MassEpi0N3;
sDDetWEpi0N3 = cDDetWEpi0N3 *MassEpi0N3;
sNDetWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDet0N3 * sDDetWEpi0N3 ELSE cNDetWEpi0N3 *MassEpi0N3 ENDIF ;
sPDetWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDet0N3 * sDDetWEpi0N3 ELSE cPDetWEpi0N3 *MassEpi0N3 ENDIF;
sSiDetWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cSiDDet0N3 * sDDetWEpi0N3 ELSE cSiDetWEpi0N3 *MassEpi0N3 ENDIF;
sDIMWEpi0N3 = cDIMWEpi0N3 *MassEpi0N3;
sDDiatWEpi0N3 = cDDiatWEpi0N3 *MassEpi0N3;
sNDiatWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDiat0N3 * sDDiatWEpi0N3 ELSE cNDiatWEpi0N3 *MassEpi0N3 ENDIF;
sPDiatWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDiat0N3 * sDDiatWEpi0N3 ELSE cPDiatWEpi0N3 *MassEpi0N3 ENDIF;
sDGrenWEpi0N3 = cDGrenWEpi0N3 *MassEpi0N3;
sNGrenWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDGren0N3 * sDGrenWEpi0N3 ELSE cNGrenWEpi0N3 *MassEpi0N3 ENDIF;
sPGrenWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDGren0N3 * sDGrenWEpi0N3 ELSE cPGrenWEpi0N3 *MassEpi0N3 ENDIF;
sDBlueWEpi0N3 = cDBlueWEpi0N3 *MassEpi0N3;
sNBlueWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDBlue0N3 * sDBlueWEpi0N3 ELSE cNBlueWEpi0N3 *MassEpi0N3 ENDIF;
sPBlueWEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDBlue0N3 * sDBlueWEpi0N3 ELSE cPBlueWEpi0N3 *MassEpi0N3 ENDIF;
sDZooEpi0N3 = cDZooEpi0N3 *MassEpi0N3;
sNZooEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDZooRefN3 * sDZooEpi0N3 ELSE cNZooEpi0N3 *MassEpi0N3 ENDIF;
sPZooEpi0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDZooRefN3 * sDZooEpi0N3 ELSE cPZooEpi0N3 *MassEpi0N3 ENDIF;
sDBlueSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN cDBlueSurf0N3 ELSE 0.0 ENDIF;
sNBlueSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN cNBlueSurf0N3 ELSE 0.0 ENDIF;
sPBlueSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN cPBlueSurf0N3 ELSE 0.0 ENDIF;
sNH4S0N3 = cNH4S0N3;
sNO3S0N3 = cNO3S0N3;
bRhoSolidS0N3 = fDOrgS0N3 * cRhoOMN3 + (1.0 - fDOrgS0N3) * cRhoIMN3;
bPorS0N3 = (1.0 - fDTotS0N3) * bRhoSolidS0N3 / cRhoWatN3 / ( fDTotS0N3 + (1.0 - fDTotS0N3) * bRhoSolidS0N3 / cRhoWatN3 );
bRhoTotS0N3 = bRhoSolidS0N3 * (1.0 - bPorS0N3);
bDTotS0N3 = bRhoTotS0N3 * cDepthSN3;
sPO4S0N3 = IF (InitCalcN3 EQ TRUE) THEN (1.0 - fPAdsS0N3) * fPInorgS0N3 * bDTotS0N3 ELSE cPO4S0N3 ENDIF;
sPAIMS0N3 = IF (InitCalcN3 EQ TRUE) THEN fPAdsS0N3 * fPInorgS0N3 * bDTotS0N3 ELSE cPAIMS0N3 ENDIF;
sDDetS0N3 = IF (InitCalcN3 EQ TRUE) THEN fDDetS0N3 * fDOrgS0N3 * bDTotS0N3 ELSE cDDetS0N3 ENDIF;
sNDetS0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDet0N3 * sDDetS0N3 ELSE cNDetS0N3 ENDIF;
sPDetS0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDet0N3 * sDDetS0N3 ELSE cPDetS0N3 ENDIF;
sSiDetS0N3 = IF (InitCalcN3 EQ TRUE) THEN cSiDDet0N3 * sDDetS0N3 ELSE cSiDetS0N3 ENDIF;
sDHumS0N3 = IF (InitCalcN3 EQ TRUE) THEN (1.0 - fDDetS0N3) * fDOrgS0N3 * bDTotS0N3 ELSE cDHumS0N3 ENDIF;
sNHumS0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDHum0N3 * sDHumS0N3 ELSE cNHumS0N3 ENDIF;
sPHumS0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDHum0N3 * sDHumS0N3 ELSE cPHumS0N3 ENDIF;
sDIMS0N3 = IF (InitCalcN3 EQ TRUE) THEN bDTotS0N3 - sDHumS0N3 - sDDetS0N3 ELSE cDIMS0N3 ENDIF;
sDDiatS0N3 = IF (InitCalcN3 EQ TRUE) THEN fSedPhyt0N3 * sDDiatWHyp0N3 ELSE cDDiatS0N3 ENDIF;
sNDiatS0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDiat0N3 * sDDiatS0N3 ELSE cNDiatS0N3 ENDIF;
sPDiatS0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDiat0N3 * sDDiatS0N3 ELSE cPDiatS0N3 ENDIF;
sDGrenS0N3 = IF (InitCalcN3 EQ TRUE) THEN fSedPhyt0N3 * sDGrenWHyp0N3 ELSE cDGrenS0N3 ENDIF;
sNGrenS0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDGren0N3 * sDGrenS0N3 ELSE cNGrenS0N3 ENDIF;
sPGrenS0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDGren0N3 * sDGrenS0N3 ELSE cPGrenS0N3 ENDIF;
sDBlueS0N3 = IF (InitCalcN3 EQ TRUE) THEN fSedPhyt0N3 * sDBlueWHyp0N3 ELSE cDBlueS0N3 ENDIF;
sNBlueS0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDBlue0N3 * sDBlueS0N3 ELSE cNBlueS0N3 ENDIF;
sPBlueS0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDBlue0N3 * sDBlueS0N3 ELSE cPBlueS0N3 ENDIF;
sDVeg0N3 = cDVeg0N3;
sNVeg0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDVeg0N3 * sDVeg0N3 ELSE cNVeg0N3 ENDIF;
sPVeg0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDVeg0N3 * sDVeg0N3 ELSE cPVeg0N3 ENDIF;
sVegHeight0N3 = MIN (cVegHeightN3, sDepthW0N3 );
sDBent0N3 = cDBent0N3;
sNBent0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDBentRefN3 * sDBent0N3 ELSE cNBent0N3 ENDIF;
sPBent0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDBentRefN3 * sDBent0N3 ELSE cPBent0N3 ENDIF;
sDepthWM0N3 = cDepthWM0N3;
MassWM0N3 = IF CalcMassN3 EQ TRUE THEN sDepthWM0N3 ELSE 1.0 ENDIF;
sNH4WM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNH4WEpi0N3 ELSE cNH4WM0N3 * MassWM0N3 ENDIF;
sNO3WM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNO3WEpi0N3 ELSE cNO3WM0N3 * MassWM0N3 ENDIF;
sPO4WM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPO4WEpi0N3 ELSE cPO4WM0N3 * MassWM0N3 ENDIF;
sPAIMWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPAIMWEpi0N3 ELSE cPAIMWM0N3 * MassWM0N3 ENDIF;
sSiO2WM0N3 = IF (InitCalcN3 EQ TRUE) THEN sSiO2WEpi0N3 ELSE cSiO2WM0N3 * MassWM0N3 ENDIF;
sO2WM0N3 = IF (InitCalcN3 EQ TRUE) THEN sO2WEpi0N3 ELSE cO2WM0N3 * MassWM0N3 ENDIF;
sDDetWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDDetWEpi0N3 ELSE cDDetWM0N3 * MassWM0N3 ENDIF;
sNDetWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNDetWEpi0N3 ELSE cNDetWM0N3 * MassWM0N3 ENDIF;
sPDetWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPDetWEpi0N3 ELSE cPDetWM0N3 * MassWM0N3 ENDIF;
sSiDetWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sSiDetWEpi0N3 ELSE cSiDetWM0N3 * MassWM0N3 ENDIF;
sDIMWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDIMWEpi0N3 ELSE cDIMWM0N3 * MassWM0N3 ENDIF;
sDDiatWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDDiatWEpi0N3 ELSE cDDiatWM0N3 * MassWM0N3 ENDIF;
sNDiatWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNDiatWEpi0N3 ELSE cNDiatWM0N3 * MassWM0N3 ENDIF;
sPDiatWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPDiatWEpi0N3 ELSE cPDiatWM0N3 * MassWM0N3 ENDIF;
sDGrenWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDGrenWEpi0N3 ELSE cDGrenWM0N3 * MassWM0N3 ENDIF;
sNGrenWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNGrenWEpi0N3 ELSE cNGrenWM0N3 * MassWM0N3 ENDIF;
sPGrenWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPGrenWEpi0N3 ELSE cPGrenWM0N3 * MassWM0N3 ENDIF;
sDBlueWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDBlueWEpi0N3 ELSE cDBlueWM0N3 * MassWM0N3 ENDIF;
sNBlueWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNBlueWEpi0N3 ELSE cNBlueWM0N3 * MassWM0N3 ENDIF;
sPBlueWM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPBlueWEpi0N3 ELSE cPBlueWM0N3 * MassWM0N3 ENDIF;
sDZooM0N3 = IF (InitCalcN3 EQ TRUE) THEN sDZooEpi0N3 ELSE cDZooM0N3 * MassWM0N3 ENDIF;
sNZooM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNZooEpi0N3 ELSE cNZooM0N3 * MassWM0N3 ENDIF;
sPZooM0N3 = IF (InitCalcN3 EQ TRUE) THEN sPZooEpi0N3 ELSE cPZooM0N3 * MassWM0N3 ENDIF;
sNH4SM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNH4S0N3 ELSE cNH4SM0N3 ENDIF;
sNO3SM0N3 = IF (InitCalcN3 EQ TRUE) THEN sNO3S0N3 ELSE cNO3SM0N3 ENDIF;
bRhoSolidSM0N3 = IF (InitCalcN3 EQ TRUE) THEN fDOrgSM0N3 * cRhoOMN3 +(1.0 - fDOrgSM0N3) * cRhoIMN3 ELSE fDOrgSM0N3 * cRhoOMN3 +(1.0 - fDOrgSM0N3) * cRhoIMN3 ENDIF;
bPorSM0N3 = IF (InitCalcN3 EQ TRUE) THEN (1.0 - fDTotSM0N3) * bRhoSolidSM0N3 / cRhoWatN3 /(fDTotSM0N3 + (1.0 - fDTotSM0N3) * bRhoSolidSM0N3 / cRhoWatN3) ELSE (1.0 - fDTotSM0N3) * bRhoSolidSM0N3 / cRhoWatN3 /(fDTotSM0N3 + (1.0 - fDTotSM0N3) * bRhoSolidSM0N3 / cRhoWatN3) ENDIF;
bRhoTotSM0N3 = IF (InitCalcN3 EQ TRUE) THEN bRhoSolidSM0N3 * (1.0 - bPorSM0N3) ELSE 0.0 ENDIF;
bDTotSM0N3 = IF (InitCalcN3 EQ TRUE) THEN bRhoTotSM0N3 * cDepthSMN3 ELSE 0.0 ENDIF;
fPAdsSM0N3 = IF (InitCalcN3 EQ TRUE) THEN fPAdsS0N3 ELSE 0.0 ENDIF;
sPO4SM0N3 = IF (InitCalcN3 EQ TRUE) THEN (1.0 - fPAdsSM0N3) * fPInorgSM0N3 * bDTotSM0N3 ELSE cPO4SM0N3 ENDIF;
sPAIMSM0N3 = IF (InitCalcN3 EQ TRUE) THEN fPAdsSM0N3 * fPInorgSM0N3 * bDTotSM0N3 ELSE cPAIMSM0N3 ENDIF;
sDDetSM0N3 = IF (InitCalcN3 EQ TRUE) THEN fDDetSM0N3 * fDOrgSM0N3 * bDTotSM0N3 ELSE cDDetSM0N3 ENDIF;
sNDetSM0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDDet0N3 * sDDetSM0N3 ELSE cNDetSM0N3 ENDIF;
sPDetSM0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDDet0N3 * sDDetSM0N3 ELSE cPDetSM0N3 ENDIF;
sSiDetSM0N3 = IF (InitCalcN3 EQ TRUE) THEN cSiDDet0N3 * sDDetSM0N3 ELSE cSiDetSM0N3 ENDIF;
sDHumSM0N3 = IF (InitCalcN3 EQ TRUE) THEN (1.0 - fDDetSM0N3) * fDOrgSM0N3 * bDTotSM0N3 ELSE cDHumSM0N3 ENDIF;
sNHumSM0N3 = IF (InitCalcN3 EQ TRUE) THEN cNDHum0N3 * sDHumSM0N3 ELSE cNHumSM0N3 ENDIF;
sPHumSM0N3 = IF (InitCalcN3 EQ TRUE) THEN cPDHum0N3 * sDHumSM0N3 ELSE cPHumSM0N3 ENDIF;
sDIMSM0N3 = IF (InitCalcN3 EQ TRUE) THEN bDTotSM0N3 - sDHumSM0N3 - sDDetSM0N3 ELSE cDIMSM0N3 ENDIF;
sDRootPhra0N3 = cDRootPhra0N3;
sDShootPhra0N3 = cDShootPhra0N3;
sNRootPhra0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN cNRootPhra0N3 ELSE cNDPhra0N3 * sDRootPhra0N3 ENDIF;
sNShootPhra0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN cNShootPhra0N3 ELSE cNDPhra0N3 * sDShootPhra0N3 ENDIF;
sPRootPhra0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN cPRootPhra0N3 ELSE cPDPhra0N3 * sDRootPhra0N3 ENDIF;
sPShootPhra0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN cPShootPhra0N3 ELSE cPDPhra0N3 * sDShootPhra0N3 ENDIF;
uDPhytWHyp0N3 = sDDiatWHyp0N3 + sDGrenWHyp0N3 + sDBlueWHyp0N3;
uDPhytWEpi0N3 = sDDiatWEpi0N3 + sDGrenWEpi0N3 + sDBlueWEpi0N3;
uPPhytWHyp0N3 = sPDiatWHyp0N3 + sPGrenWHyp0N3 + sPBlueWHyp0N3;
uPPhytWEpi0N3 = sPDiatWEpi0N3 + sPGrenWEpi0N3 + sPBlueWEpi0N3;
uNPhytWHyp0N3 = sNDiatWHyp0N3 + sNGrenWHyp0N3 + sNBlueWHyp0N3;
uNPhytWEpi0N3 = sNDiatWEpi0N3 + sNGrenWEpi0N3 + sNBlueWEpi0N3;
uDPhytS0N3 = sDDiatS0N3 + sDGrenS0N3 + sDBlueS0N3;
uPPhytS0N3 = sPDiatS0N3 + sPGrenS0N3 + sPBlueS0N3;
uNPhytS0N3 = sNDiatS0N3 + sNGrenS0N3 + sNBlueS0N3;
uDPhytWM0N3 = IF (InitCalcN3 EQ TRUE) THEN uDPhytWEpi0N3 ELSE sDGrenWM0N3 + sDDiatWM0N3 + sDBlueWM0N3 ENDIF;
uPPhytWM0N3 = IF (InitCalcN3 EQ TRUE) THEN uPPhytWEpi0N3 ELSE sPGrenWM0N3 + sPDiatWM0N3 + sPBlueWM0N3 ENDIF;
uNPhytWM0N3 = IF (InitCalcN3 EQ TRUE) THEN uNPhytWEpi0N3 ELSE sNGrenWM0N3 + sNDiatWM0N3 + sNBlueWM0N3 ENDIF;
uSiDiatWM0N3 = IF (InitCalcN3 EQ TRUE) THEN cSiDDiatN3 * sDDiatWEpi0N3 ELSE cSiDDiatN3 * sDDiatWM0N3 ENDIF;
uDVeg0N3 = sDVeg0N3;
uPVeg0N3 = sPVeg0N3;
uNVeg0N3 = sNVeg0N3;
uDFish0N3 = sDFiJv0N3 + sDFiAd0N3;
uPFish0N3 = sPFiJv0N3 + sPFiAd0N3;
uNFish0N3 = sNFiJv0N3 + sNFiAd0N3;
uPPisc0N3 = cPDPiscN3 * sDPisc0N3;
uNPisc0N3 = cNDPiscN3 * sDPisc0N3;
uO2TotTHyp0N3 = IF (aInclStrat0N3 EQ TRUE) THEN (sO2WHyp0N3 ) * (sDepthW0N3 - sMixDepthW0N3) / MassHyp0N3 ELSE 0.0 ENDIF;
uDTotTHyp0N3 = IF (aInclStrat0N3 EQ TRUE) THEN (sDIMWHyp0N3 + sDDetWHyp0N3 + uDPhytWHyp0N3 + sDZooHyp0N3) * (sDepthW0N3 - sMixDepthW0N3) / MassHyp0N3 ELSE 0.0 ENDIF;
uPTotTHyp0N3 = IF (aInclStrat0N3 EQ TRUE) THEN (sPO4WHyp0N3 + sPDetWHyp0N3 + sPAIMWHyp0N3 + uPPhytWHyp0N3 + sPZooHyp0N3) * (sDepthW0N3 - sMixDepthW0N3) / MassHyp0N3 ELSE 0.0 ENDIF;
uNTotTHyp0N3 = IF (aInclStrat0N3 EQ TRUE) THEN (sNH4WHyp0N3 + sNO3WHyp0N3 + sNDetWHyp0N3 + uNPhytWHyp0N3 + sNZooHyp0N3) * (sDepthW0N3 - sMixDepthW0N3) / MassHyp0N3 ELSE 0.0 ENDIF ;
uSiTotTHyp0N3 = IF (aInclStrat0N3 EQ TRUE) THEN (sSiO2WHyp0N3 + sSiDetWHyp0N3 + cSiDDiatN3 * sDDiatWHyp0N3) * (sDepthW0N3 - sMixDepthW0N3) / MassHyp0N3 ELSE 0.0 ENDIF;
uDTotTSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN sDBlueSurf0N3 ELSE 0.0 ENDIF;
uPTotTSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN sPBlueSurf0N3 ELSE 0.0 ENDIF;
uNTotTSurf0N3 = IF (InclSurfN3 EQ TRUE) THEN sNBlueSurf0N3 ELSE 0.0 ENDIF;
uDTotM0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSE ((sDIMWM0N3 + sDDetWM0N3 + uDPhytWM0N3 + sDZooM0N3) * sDepthWM0N3 / MassWM0N3 + sDIMSM0N3 + sDHumSM0N3 + sDDetSM0N3 + sDShootPhra0N3 + sDRootPhra0N3) * fMarshN3 ENDIF;
uPTotM0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSE ((sPO4WM0N3 + sPDetWM0N3 + sPAIMWM0N3 + uPPhytWM0N3 + sPZooM0N3) * sDepthWM0N3 / MassWM0N3 + sPO4SM0N3 + sPDetSM0N3 + sPHumSM0N3 + sPAIMSM0N3 + sPShootPhra0N3 + sPRootPhra0N3) * fMarshN3 ENDIF;
uNTotM0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSE ((sNH4WM0N3 + sNO3WM0N3 + sNDetWM0N3 + uNPhytWM0N3 + sNZooM0N3) * sDepthWM0N3 / MassWM0N3 + sNH4SM0N3 + sNO3SM0N3 + sNHumSM0N3 + sNDetSM0N3 + sNShootPhra0N3 + sNRootPhra0N3) * fMarshN3 ENDIF;
uSiTotM0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSE ((sSiO2WM0N3 + sSiDetWM0N3 + uSiDiatWM0N3) * sDepthWM0N3 / MassWM0N3 + sSiDetSM0N3) * fMarshN3 ENDIF;
uO2TotM0N3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSE ((sO2WM0N3) * sDepthWM0N3 / MassWM0N3 ) * fMarshN3 ENDIF;
uO2TotT0N3 = IF ((aInclStrat0N3 EQ TRUE) AND (sDepthW0N3 GE sMixDepthW0N3)) THEN uO2TotTHyp0N3 + ( sO2WEpi0N3) * sMixDepthW0N3 / MassEpi0N3 + uO2TotM0N3  ELSE ( sO2WEpi0N3) *sDepthW0N3 / MassEpi0N3 + uO2TotM0N3  ENDIF ;
uDTotT0N3 = IF ((aInclStrat0N3 EQ TRUE) AND (sDepthW0N3 GE sMixDepthW0N3)) THEN uDTotTHyp0N3 + (sDIMWEpi0N3 + sDDetWEpi0N3 + uDPhytWEpi0N3 + sDZooEpi0N3) * sMixDepthW0N3 / MassEpi0N3 + uDVeg0N3 + sDIMS0N3 + sDHumS0N3 + sDDetS0N3 + uDPhytS0N3 + uDFish0N3 + sDPisc0N3 + sDBent0N3 + uDTotM0N3 + uDTotTSurf0N3 ELSE (sDIMWEpi0N3 + sDDetWEpi0N3 + uDPhytWEpi0N3 + sDZooEpi0N3) * sDepthW0N3 / MassEpi0N3 + uDVeg0N3 + sDIMS0N3 + sDHumS0N3 + sDDetS0N3 + uDPhytS0N3 + uDFish0N3 + sDPisc0N3 + sDBent0N3 + uDTotM0N3 + uDTotTSurf0N3 ENDIF ;
uPTotT0N3 = IF ((aInclStrat0N3 EQ TRUE) AND (sDepthW0N3 GE sMixDepthW0N3)) THEN uPTotTHyp0N3 + (sPO4WEpi0N3 + sPDetWEpi0N3 + sPAIMWEpi0N3 + uPPhytWEpi0N3 + sPZooEpi0N3) * sMixDepthW0N3 / MassEpi0N3+ uPVeg0N3 + sPO4S0N3 + sPDetS0N3 + sPAIMS0N3 + sPHumS0N3 + uPPhytS0N3 + uPFish0N3 + uPPisc0N3 + sPBent0N3 + uPTotM0N3  + uPTotTSurf0N3 ELSE + (sPO4WEpi0N3 + sPDetWEpi0N3 + sPAIMWEpi0N3 + uPPhytWEpi0N3 + sPZooEpi0N3) * sDepthW0N3 / MassEpi0N3+ uPVeg0N3 + sPO4S0N3 + sPDetS0N3 + sPAIMS0N3 + sPHumS0N3 + uPPhytS0N3 + uPFish0N3 + uPPisc0N3 + sPBent0N3 + uPTotM0N3  + uPTotTSurf0N3 ENDIF  ;
uNTotT0N3 =  IF ((aInclStrat0N3 EQ TRUE) AND (sDepthW0N3 GE sMixDepthW0N3)) THEN  uNTotTHyp0N3 + (sNH4WEpi0N3 + sNO3WEpi0N3 + sNDetWEpi0N3 + uNPhytWEpi0N3 + sNZooEpi0N3) * sMixDepthW0N3 / MassEpi0N3 + uNVeg0N3 + sNH4S0N3 + sNO3S0N3 + sNDetS0N3 + uNPhytS0N3 + sNHumS0N3 + uNFish0N3 + uNPisc0N3 + sNBent0N3 + uNTotM0N3  + uNTotTSurf0N3 ELSE   (sNH4WEpi0N3 + sNO3WEpi0N3 + sNDetWEpi0N3 + uNPhytWEpi0N3 + sNZooEpi0N3) * sDepthW0N3 / MassEpi0N3 + uNVeg0N3 + sNH4S0N3 + sNO3S0N3 + sNDetS0N3 + uNPhytS0N3 + sNHumS0N3 + uNFish0N3 + uNPisc0N3 + sNBent0N3 + uNTotM0N3  + uNTotTSurf0N3 ENDIF;
uSiTotT0N3 = IF ((aInclStrat0N3 EQ TRUE) AND (sDepthW0N3 GE sMixDepthW0N3)) THEN uSiTotTHyp0N3+ (sSiO2WEpi0N3 + sSiDetWEpi0N3 + cSiDDiatN3 * sDDiatWEpi0N3) * sMixDepthW0N3 / MassEpi0N3 + sSiDetS0N3 + cSiDDiatN3*sDDiatS0N3 + uSiTotM0N3  ELSE (sSiO2WEpi0N3 + sSiDetWEpi0N3 + cSiDDiatN3 * sDDiatWEpi0N3) * sDepthW0N3 / MassEpi0N3 + sSiDetS0N3 + cSiDDiatN3*sDDiatS0N3 + uSiTotM0N3  ENDIF ;
sDExtTotT0N3 = uDTotT0N3;
sNExtTotT0N3 = uNTotT0N3;
sPExtTotT0N3 = uPTotT0N3;
sSiExtTotT0N3 = uSiTotT0N3;
sO2ExtTotT0N3 = uO2TotT0N3;
sDepthExtTotT0N3 = sDepthW0N3;
sMixDepthW0N4 = IF (InclStratN4 EQ FALSE) THEN 0.0 ELSEIF (InitMixDepthN4 EQ FALSE) THEN cMixDepthW0N4 ELSEIF (ReadMixDepthN4 EQ TRUE) THEN mMixDepthN4 ELSE cMixDepthN4 ENDIF;
aInclStrat0N4 =IF ( InclStratN4 EQ FALSE) THEN 0.0 ELSEIF (sMixDepthW0N4 GT cDepthWInit0N4 - cMinDepthHypEpiN4 ) THEN 0.0 ELSE 1.0 ENDIF;
sDepthW0N4 = IF (InitDepthN4 EQ TRUE) THEN cDepthWInit0N4 ELSE  cDepthW0N4 ENDIF ;
MassHyp0N4 = IF ( CalcMassN4 EQ TRUE  AND aInclStrat0N4 EQ TRUE ) THEN sDepthW0N4 - sMixDepthW0N4 ELSE cMinDepthHypEpiN4 ENDIF ;
sNH4WHyp0N4 = cNH4WHyp0N4 *MassHyp0N4;
sNO3WHyp0N4 = cNO3WHyp0N4 *MassHyp0N4;
sPO4WHyp0N4 = cPO4WHyp0N4 *MassHyp0N4;
sPAIMWHyp0N4 = cPAIMWHyp0N4 *MassHyp0N4;
sSiO2WHyp0N4 = cSiO2WHyp0N4 *MassHyp0N4;
sO2WHyp0N4 = cO2WHyp0N4 *MassHyp0N4;
sDDetWHyp0N4 = cDDetWHyp0N4 *MassHyp0N4;
sNDetWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDet0N4 * sDDetWHyp0N4 ELSE cNDetWHyp0N4 *MassHyp0N4 ENDIF;
sPDetWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDet0N4 * sDDetWHyp0N4 ELSE cPDetWHyp0N4 *MassHyp0N4 ENDIF;
sSiDetWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cSiDDet0N4 * sDDetWHyp0N4 ELSE cSiDetWHyp0N4 *MassHyp0N4 ENDIF;
sDIMWHyp0N4 = cDIMWHyp0N4 *MassHyp0N4;
sDDiatWHyp0N4 = cDDiatWHyp0N4 *MassHyp0N4;
sNDiatWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDiat0N4 * sDDiatWHyp0N4 ELSE cNDiatWHyp0N4 *MassHyp0N4 ENDIF;
sPDiatWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDiat0N4 * sDDiatWHyp0N4 ELSE cPDiatWHyp0N4 *MassHyp0N4 ENDIF;
sDGrenWHyp0N4 = cDGrenWHyp0N4 *MassHyp0N4;
sNGrenWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDGren0N4 * sDGrenWHyp0N4 ELSE cNGrenWHyp0N4 *MassHyp0N4 ENDIF;
sPGrenWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDGren0N4 * sDGrenWHyp0N4 ELSE cPGrenWHyp0N4 *MassHyp0N4 ENDIF;
sDBlueWHyp0N4 = cDBlueWHyp0N4 *MassHyp0N4;
sNBlueWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDBlue0N4 * sDBlueWHyp0N4 ELSE cNBlueWHyp0N4*MassHyp0N4 ENDIF;
sPBlueWHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDBlue0N4 * sDBlueWHyp0N4 ELSE cPBlueWHyp0N4 *MassHyp0N4 ENDIF;
sDZooHyp0N4 = cDZooHyp0N4 *MassHyp0N4;
sNZooHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDZooRefN4 * sDZooHyp0N4 ELSE cNZooHyp0N4 *MassHyp0N4 ENDIF;
sPZooHyp0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDZooRefN4 * sDZooHyp0N4 ELSE cPZooHyp0N4 *MassHyp0N4 ENDIF;
sDFiAd0N4 = cDFiAd0N4;
sDFiJv0N4 = cDFiJv0N4;
sNFiAd0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDFishRefN4 * sDFiAd0N4 ELSE cNFiAd0N4 ENDIF;
sNFiJv0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDFishRefN4 * sDFiJv0N4 ELSE cNFiJv0N4 ENDIF;
sPFiAd0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDFishRefN4 * sDFiAd0N4 ELSE cPFiAd0N4 ENDIF;
sPFiJv0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDFishRefN4 * sDFiJv0N4 ELSE cPFiJv0N4 ENDIF;
sDPisc0N4 = cDPisc0N4;
MassEpi0N4 = IF (CalcMassN4 EQ FALSE) THEN 1.0 ELSEIF (aInclStrat0N4 EQ FALSE) THEN sDepthW0N4 ELSEIF (sDepthW0N4  LT sMixDepthW0N4) THEN sDepthW0N4 ELSE sMixDepthW0N4 ENDIF;
sNH4WEpi0N4 = cNH4WEpi0N4 * MassEpi0N4;
sNO3WEpi0N4 = cNO3WEpi0N4 *MassEpi0N4;
sPO4WEpi0N4 = cPO4WEpi0N4 *MassEpi0N4;
sPAIMWEpi0N4 = cPAIMWEpi0N4 *MassEpi0N4;
sSiO2WEpi0N4 = cSiO2WEpi0N4 * MassEpi0N4;
sO2WEpi0N4 = cO2WEpi0N4 *MassEpi0N4;
sDDetWEpi0N4 = cDDetWEpi0N4 *MassEpi0N4;
sNDetWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDet0N4 * sDDetWEpi0N4 ELSE cNDetWEpi0N4 *MassEpi0N4 ENDIF ;
sPDetWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDet0N4 * sDDetWEpi0N4 ELSE cPDetWEpi0N4 *MassEpi0N4 ENDIF;
sSiDetWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cSiDDet0N4 * sDDetWEpi0N4 ELSE cSiDetWEpi0N4 *MassEpi0N4 ENDIF;
sDIMWEpi0N4 = cDIMWEpi0N4 *MassEpi0N4;
sDDiatWEpi0N4 = cDDiatWEpi0N4 *MassEpi0N4;
sNDiatWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDiat0N4 * sDDiatWEpi0N4 ELSE cNDiatWEpi0N4 *MassEpi0N4 ENDIF;
sPDiatWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDiat0N4 * sDDiatWEpi0N4 ELSE cPDiatWEpi0N4 *MassEpi0N4 ENDIF;
sDGrenWEpi0N4 = cDGrenWEpi0N4 *MassEpi0N4;
sNGrenWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDGren0N4 * sDGrenWEpi0N4 ELSE cNGrenWEpi0N4 *MassEpi0N4 ENDIF;
sPGrenWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDGren0N4 * sDGrenWEpi0N4 ELSE cPGrenWEpi0N4 *MassEpi0N4 ENDIF;
sDBlueWEpi0N4 = cDBlueWEpi0N4 *MassEpi0N4;
sNBlueWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDBlue0N4 * sDBlueWEpi0N4 ELSE cNBlueWEpi0N4 *MassEpi0N4 ENDIF;
sPBlueWEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDBlue0N4 * sDBlueWEpi0N4 ELSE cPBlueWEpi0N4 *MassEpi0N4 ENDIF;
sDZooEpi0N4 = cDZooEpi0N4 *MassEpi0N4;
sNZooEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDZooRefN4 * sDZooEpi0N4 ELSE cNZooEpi0N4 *MassEpi0N4 ENDIF;
sPZooEpi0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDZooRefN4 * sDZooEpi0N4 ELSE cPZooEpi0N4 *MassEpi0N4 ENDIF;
sDBlueSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN cDBlueSurf0N4 ELSE 0.0 ENDIF;
sNBlueSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN cNBlueSurf0N4 ELSE 0.0 ENDIF;
sPBlueSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN cPBlueSurf0N4 ELSE 0.0 ENDIF;
sNH4S0N4 = cNH4S0N4;
sNO3S0N4 = cNO3S0N4;
bRhoSolidS0N4 = fDOrgS0N4 * cRhoOMN4 + (1.0 - fDOrgS0N4) * cRhoIMN4;
bPorS0N4 = (1.0 - fDTotS0N4) * bRhoSolidS0N4 / cRhoWatN4 / ( fDTotS0N4 + (1.0 - fDTotS0N4) * bRhoSolidS0N4 / cRhoWatN4 );
bRhoTotS0N4 = bRhoSolidS0N4 * (1.0 - bPorS0N4);
bDTotS0N4 = bRhoTotS0N4 * cDepthSN4;
sPO4S0N4 = IF (InitCalcN4 EQ TRUE) THEN (1.0 - fPAdsS0N4) * fPInorgS0N4 * bDTotS0N4 ELSE cPO4S0N4 ENDIF;
sPAIMS0N4 = IF (InitCalcN4 EQ TRUE) THEN fPAdsS0N4 * fPInorgS0N4 * bDTotS0N4 ELSE cPAIMS0N4 ENDIF;
sDDetS0N4 = IF (InitCalcN4 EQ TRUE) THEN fDDetS0N4 * fDOrgS0N4 * bDTotS0N4 ELSE cDDetS0N4 ENDIF;
sNDetS0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDet0N4 * sDDetS0N4 ELSE cNDetS0N4 ENDIF;
sPDetS0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDet0N4 * sDDetS0N4 ELSE cPDetS0N4 ENDIF;
sSiDetS0N4 = IF (InitCalcN4 EQ TRUE) THEN cSiDDet0N4 * sDDetS0N4 ELSE cSiDetS0N4 ENDIF;
sDHumS0N4 = IF (InitCalcN4 EQ TRUE) THEN (1.0 - fDDetS0N4) * fDOrgS0N4 * bDTotS0N4 ELSE cDHumS0N4 ENDIF;
sNHumS0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDHum0N4 * sDHumS0N4 ELSE cNHumS0N4 ENDIF;
sPHumS0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDHum0N4 * sDHumS0N4 ELSE cPHumS0N4 ENDIF;
sDIMS0N4 = IF (InitCalcN4 EQ TRUE) THEN bDTotS0N4 - sDHumS0N4 - sDDetS0N4 ELSE cDIMS0N4 ENDIF;
sDDiatS0N4 = IF (InitCalcN4 EQ TRUE) THEN fSedPhyt0N4 * sDDiatWHyp0N4 ELSE cDDiatS0N4 ENDIF;
sNDiatS0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDiat0N4 * sDDiatS0N4 ELSE cNDiatS0N4 ENDIF;
sPDiatS0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDiat0N4 * sDDiatS0N4 ELSE cPDiatS0N4 ENDIF;
sDGrenS0N4 = IF (InitCalcN4 EQ TRUE) THEN fSedPhyt0N4 * sDGrenWHyp0N4 ELSE cDGrenS0N4 ENDIF;
sNGrenS0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDGren0N4 * sDGrenS0N4 ELSE cNGrenS0N4 ENDIF;
sPGrenS0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDGren0N4 * sDGrenS0N4 ELSE cPGrenS0N4 ENDIF;
sDBlueS0N4 = IF (InitCalcN4 EQ TRUE) THEN fSedPhyt0N4 * sDBlueWHyp0N4 ELSE cDBlueS0N4 ENDIF;
sNBlueS0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDBlue0N4 * sDBlueS0N4 ELSE cNBlueS0N4 ENDIF;
sPBlueS0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDBlue0N4 * sDBlueS0N4 ELSE cPBlueS0N4 ENDIF;
sDVeg0N4 = cDVeg0N4;
sNVeg0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDVeg0N4 * sDVeg0N4 ELSE cNVeg0N4 ENDIF;
sPVeg0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDVeg0N4 * sDVeg0N4 ELSE cPVeg0N4 ENDIF;
sVegHeight0N4 = MIN (cVegHeightN4, sDepthW0N4 );
sDBent0N4 = cDBent0N4;
sNBent0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDBentRefN4 * sDBent0N4 ELSE cNBent0N4 ENDIF;
sPBent0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDBentRefN4 * sDBent0N4 ELSE cPBent0N4 ENDIF;
sDepthWM0N4 = cDepthWM0N4;
MassWM0N4 = IF CalcMassN4 EQ TRUE THEN sDepthWM0N4 ELSE 1.0 ENDIF;
sNH4WM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNH4WEpi0N4 ELSE cNH4WM0N4 * MassWM0N4 ENDIF;
sNO3WM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNO3WEpi0N4 ELSE cNO3WM0N4 * MassWM0N4 ENDIF;
sPO4WM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPO4WEpi0N4 ELSE cPO4WM0N4 * MassWM0N4 ENDIF;
sPAIMWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPAIMWEpi0N4 ELSE cPAIMWM0N4 * MassWM0N4 ENDIF;
sSiO2WM0N4 = IF (InitCalcN4 EQ TRUE) THEN sSiO2WEpi0N4 ELSE cSiO2WM0N4 * MassWM0N4 ENDIF;
sO2WM0N4 = IF (InitCalcN4 EQ TRUE) THEN sO2WEpi0N4 ELSE cO2WM0N4 * MassWM0N4 ENDIF;
sDDetWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDDetWEpi0N4 ELSE cDDetWM0N4 * MassWM0N4 ENDIF;
sNDetWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNDetWEpi0N4 ELSE cNDetWM0N4 * MassWM0N4 ENDIF;
sPDetWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPDetWEpi0N4 ELSE cPDetWM0N4 * MassWM0N4 ENDIF;
sSiDetWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sSiDetWEpi0N4 ELSE cSiDetWM0N4 * MassWM0N4 ENDIF;
sDIMWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDIMWEpi0N4 ELSE cDIMWM0N4 * MassWM0N4 ENDIF;
sDDiatWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDDiatWEpi0N4 ELSE cDDiatWM0N4 * MassWM0N4 ENDIF;
sNDiatWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNDiatWEpi0N4 ELSE cNDiatWM0N4 * MassWM0N4 ENDIF;
sPDiatWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPDiatWEpi0N4 ELSE cPDiatWM0N4 * MassWM0N4 ENDIF;
sDGrenWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDGrenWEpi0N4 ELSE cDGrenWM0N4 * MassWM0N4 ENDIF;
sNGrenWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNGrenWEpi0N4 ELSE cNGrenWM0N4 * MassWM0N4 ENDIF;
sPGrenWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPGrenWEpi0N4 ELSE cPGrenWM0N4 * MassWM0N4 ENDIF;
sDBlueWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDBlueWEpi0N4 ELSE cDBlueWM0N4 * MassWM0N4 ENDIF;
sNBlueWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNBlueWEpi0N4 ELSE cNBlueWM0N4 * MassWM0N4 ENDIF;
sPBlueWM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPBlueWEpi0N4 ELSE cPBlueWM0N4 * MassWM0N4 ENDIF;
sDZooM0N4 = IF (InitCalcN4 EQ TRUE) THEN sDZooEpi0N4 ELSE cDZooM0N4 * MassWM0N4 ENDIF;
sNZooM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNZooEpi0N4 ELSE cNZooM0N4 * MassWM0N4 ENDIF;
sPZooM0N4 = IF (InitCalcN4 EQ TRUE) THEN sPZooEpi0N4 ELSE cPZooM0N4 * MassWM0N4 ENDIF;
sNH4SM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNH4S0N4 ELSE cNH4SM0N4 ENDIF;
sNO3SM0N4 = IF (InitCalcN4 EQ TRUE) THEN sNO3S0N4 ELSE cNO3SM0N4 ENDIF;
bRhoSolidSM0N4 = IF (InitCalcN4 EQ TRUE) THEN fDOrgSM0N4 * cRhoOMN4 +(1.0 - fDOrgSM0N4) * cRhoIMN4 ELSE fDOrgSM0N4 * cRhoOMN4 +(1.0 - fDOrgSM0N4) * cRhoIMN4 ENDIF;
bPorSM0N4 = IF (InitCalcN4 EQ TRUE) THEN (1.0 - fDTotSM0N4) * bRhoSolidSM0N4 / cRhoWatN4 /(fDTotSM0N4 + (1.0 - fDTotSM0N4) * bRhoSolidSM0N4 / cRhoWatN4) ELSE (1.0 - fDTotSM0N4) * bRhoSolidSM0N4 / cRhoWatN4 /(fDTotSM0N4 + (1.0 - fDTotSM0N4) * bRhoSolidSM0N4 / cRhoWatN4) ENDIF;
bRhoTotSM0N4 = IF (InitCalcN4 EQ TRUE) THEN bRhoSolidSM0N4 * (1.0 - bPorSM0N4) ELSE 0.0 ENDIF;
bDTotSM0N4 = IF (InitCalcN4 EQ TRUE) THEN bRhoTotSM0N4 * cDepthSMN4 ELSE 0.0 ENDIF;
fPAdsSM0N4 = IF (InitCalcN4 EQ TRUE) THEN fPAdsS0N4 ELSE 0.0 ENDIF;
sPO4SM0N4 = IF (InitCalcN4 EQ TRUE) THEN (1.0 - fPAdsSM0N4) * fPInorgSM0N4 * bDTotSM0N4 ELSE cPO4SM0N4 ENDIF;
sPAIMSM0N4 = IF (InitCalcN4 EQ TRUE) THEN fPAdsSM0N4 * fPInorgSM0N4 * bDTotSM0N4 ELSE cPAIMSM0N4 ENDIF;
sDDetSM0N4 = IF (InitCalcN4 EQ TRUE) THEN fDDetSM0N4 * fDOrgSM0N4 * bDTotSM0N4 ELSE cDDetSM0N4 ENDIF;
sNDetSM0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDDet0N4 * sDDetSM0N4 ELSE cNDetSM0N4 ENDIF;
sPDetSM0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDDet0N4 * sDDetSM0N4 ELSE cPDetSM0N4 ENDIF;
sSiDetSM0N4 = IF (InitCalcN4 EQ TRUE) THEN cSiDDet0N4 * sDDetSM0N4 ELSE cSiDetSM0N4 ENDIF;
sDHumSM0N4 = IF (InitCalcN4 EQ TRUE) THEN (1.0 - fDDetSM0N4) * fDOrgSM0N4 * bDTotSM0N4 ELSE cDHumSM0N4 ENDIF;
sNHumSM0N4 = IF (InitCalcN4 EQ TRUE) THEN cNDHum0N4 * sDHumSM0N4 ELSE cNHumSM0N4 ENDIF;
sPHumSM0N4 = IF (InitCalcN4 EQ TRUE) THEN cPDHum0N4 * sDHumSM0N4 ELSE cPHumSM0N4 ENDIF;
sDIMSM0N4 = IF (InitCalcN4 EQ TRUE) THEN bDTotSM0N4 - sDHumSM0N4 - sDDetSM0N4 ELSE cDIMSM0N4 ENDIF;
sDRootPhra0N4 = cDRootPhra0N4;
sDShootPhra0N4 = cDShootPhra0N4;
sNRootPhra0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN cNRootPhra0N4 ELSE cNDPhra0N4 * sDRootPhra0N4 ENDIF;
sNShootPhra0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN cNShootPhra0N4 ELSE cNDPhra0N4 * sDShootPhra0N4 ENDIF;
sPRootPhra0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN cPRootPhra0N4 ELSE cPDPhra0N4 * sDRootPhra0N4 ENDIF;
sPShootPhra0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN cPShootPhra0N4 ELSE cPDPhra0N4 * sDShootPhra0N4 ENDIF;
uDPhytWHyp0N4 = sDDiatWHyp0N4 + sDGrenWHyp0N4 + sDBlueWHyp0N4;
uDPhytWEpi0N4 = sDDiatWEpi0N4 + sDGrenWEpi0N4 + sDBlueWEpi0N4;
uPPhytWHyp0N4 = sPDiatWHyp0N4 + sPGrenWHyp0N4 + sPBlueWHyp0N4;
uPPhytWEpi0N4 = sPDiatWEpi0N4 + sPGrenWEpi0N4 + sPBlueWEpi0N4;
uNPhytWHyp0N4 = sNDiatWHyp0N4 + sNGrenWHyp0N4 + sNBlueWHyp0N4;
uNPhytWEpi0N4 = sNDiatWEpi0N4 + sNGrenWEpi0N4 + sNBlueWEpi0N4;
uDPhytS0N4 = sDDiatS0N4 + sDGrenS0N4 + sDBlueS0N4;
uPPhytS0N4 = sPDiatS0N4 + sPGrenS0N4 + sPBlueS0N4;
uNPhytS0N4 = sNDiatS0N4 + sNGrenS0N4 + sNBlueS0N4;
uDPhytWM0N4 = IF (InitCalcN4 EQ TRUE) THEN uDPhytWEpi0N4 ELSE sDGrenWM0N4 + sDDiatWM0N4 + sDBlueWM0N4 ENDIF;
uPPhytWM0N4 = IF (InitCalcN4 EQ TRUE) THEN uPPhytWEpi0N4 ELSE sPGrenWM0N4 + sPDiatWM0N4 + sPBlueWM0N4 ENDIF;
uNPhytWM0N4 = IF (InitCalcN4 EQ TRUE) THEN uNPhytWEpi0N4 ELSE sNGrenWM0N4 + sNDiatWM0N4 + sNBlueWM0N4 ENDIF;
uSiDiatWM0N4 = IF (InitCalcN4 EQ TRUE) THEN cSiDDiatN4 * sDDiatWEpi0N4 ELSE cSiDDiatN4 * sDDiatWM0N4 ENDIF;
uDVeg0N4 = sDVeg0N4;
uPVeg0N4 = sPVeg0N4;
uNVeg0N4 = sNVeg0N4;
uDFish0N4 = sDFiJv0N4 + sDFiAd0N4;
uPFish0N4 = sPFiJv0N4 + sPFiAd0N4;
uNFish0N4 = sNFiJv0N4 + sNFiAd0N4;
uPPisc0N4 = cPDPiscN4 * sDPisc0N4;
uNPisc0N4 = cNDPiscN4 * sDPisc0N4;
uO2TotTHyp0N4 = IF (aInclStrat0N4 EQ TRUE) THEN (sO2WHyp0N4 ) * (sDepthW0N4 - sMixDepthW0N4) / MassHyp0N4 ELSE 0.0 ENDIF;
uDTotTHyp0N4 = IF (aInclStrat0N4 EQ TRUE) THEN (sDIMWHyp0N4 + sDDetWHyp0N4 + uDPhytWHyp0N4 + sDZooHyp0N4) * (sDepthW0N4 - sMixDepthW0N4) / MassHyp0N4 ELSE 0.0 ENDIF;
uPTotTHyp0N4 = IF (aInclStrat0N4 EQ TRUE) THEN (sPO4WHyp0N4 + sPDetWHyp0N4 + sPAIMWHyp0N4 + uPPhytWHyp0N4 + sPZooHyp0N4) * (sDepthW0N4 - sMixDepthW0N4) / MassHyp0N4 ELSE 0.0 ENDIF;
uNTotTHyp0N4 = IF (aInclStrat0N4 EQ TRUE) THEN (sNH4WHyp0N4 + sNO3WHyp0N4 + sNDetWHyp0N4 + uNPhytWHyp0N4 + sNZooHyp0N4) * (sDepthW0N4 - sMixDepthW0N4) / MassHyp0N4 ELSE 0.0 ENDIF ;
uSiTotTHyp0N4 = IF (aInclStrat0N4 EQ TRUE) THEN (sSiO2WHyp0N4 + sSiDetWHyp0N4 + cSiDDiatN4 * sDDiatWHyp0N4) * (sDepthW0N4 - sMixDepthW0N4) / MassHyp0N4 ELSE 0.0 ENDIF;
uDTotTSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN sDBlueSurf0N4 ELSE 0.0 ENDIF;
uPTotTSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN sPBlueSurf0N4 ELSE 0.0 ENDIF;
uNTotTSurf0N4 = IF (InclSurfN4 EQ TRUE) THEN sNBlueSurf0N4 ELSE 0.0 ENDIF;
uDTotM0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSE ((sDIMWM0N4 + sDDetWM0N4 + uDPhytWM0N4 + sDZooM0N4) * sDepthWM0N4 / MassWM0N4 + sDIMSM0N4 + sDHumSM0N4 + sDDetSM0N4 + sDShootPhra0N4 + sDRootPhra0N4) * fMarshN4 ENDIF;
uPTotM0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSE ((sPO4WM0N4 + sPDetWM0N4 + sPAIMWM0N4 + uPPhytWM0N4 + sPZooM0N4) * sDepthWM0N4 / MassWM0N4 + sPO4SM0N4 + sPDetSM0N4 + sPHumSM0N4 + sPAIMSM0N4 + sPShootPhra0N4 + sPRootPhra0N4) * fMarshN4 ENDIF;
uNTotM0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSE ((sNH4WM0N4 + sNO3WM0N4 + sNDetWM0N4 + uNPhytWM0N4 + sNZooM0N4) * sDepthWM0N4 / MassWM0N4 + sNH4SM0N4 + sNO3SM0N4 + sNHumSM0N4 + sNDetSM0N4 + sNShootPhra0N4 + sNRootPhra0N4) * fMarshN4 ENDIF;
uSiTotM0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSE ((sSiO2WM0N4 + sSiDetWM0N4 + uSiDiatWM0N4) * sDepthWM0N4 / MassWM0N4 + sSiDetSM0N4) * fMarshN4 ENDIF;
uO2TotM0N4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSE ((sO2WM0N4) * sDepthWM0N4 / MassWM0N4 ) * fMarshN4 ENDIF;
uO2TotT0N4 = IF ((aInclStrat0N4 EQ TRUE) AND (sDepthW0N4 GE sMixDepthW0N4)) THEN uO2TotTHyp0N4 + ( sO2WEpi0N4) * sMixDepthW0N4 / MassEpi0N4 + uO2TotM0N4  ELSE ( sO2WEpi0N4) *sDepthW0N4 / MassEpi0N4 + uO2TotM0N4  ENDIF ;
uDTotT0N4 = IF ((aInclStrat0N4 EQ TRUE) AND (sDepthW0N4 GE sMixDepthW0N4)) THEN uDTotTHyp0N4 + (sDIMWEpi0N4 + sDDetWEpi0N4 + uDPhytWEpi0N4 + sDZooEpi0N4) * sMixDepthW0N4 / MassEpi0N4 + uDVeg0N4 + sDIMS0N4 + sDHumS0N4 + sDDetS0N4 + uDPhytS0N4 + uDFish0N4 + sDPisc0N4 + sDBent0N4 + uDTotM0N4 + uDTotTSurf0N4 ELSE (sDIMWEpi0N4 + sDDetWEpi0N4 + uDPhytWEpi0N4 + sDZooEpi0N4) * sDepthW0N4 / MassEpi0N4 + uDVeg0N4 + sDIMS0N4 + sDHumS0N4 + sDDetS0N4 + uDPhytS0N4 + uDFish0N4 + sDPisc0N4 + sDBent0N4 + uDTotM0N4 + uDTotTSurf0N4 ENDIF ;
uPTotT0N4 = IF ((aInclStrat0N4 EQ TRUE) AND (sDepthW0N4 GE sMixDepthW0N4)) THEN uPTotTHyp0N4 + (sPO4WEpi0N4 + sPDetWEpi0N4 + sPAIMWEpi0N4 + uPPhytWEpi0N4 + sPZooEpi0N4) * sMixDepthW0N4 / MassEpi0N4+ uPVeg0N4 + sPO4S0N4 + sPDetS0N4 + sPAIMS0N4 + sPHumS0N4 + uPPhytS0N4 + uPFish0N4 + uPPisc0N4 + sPBent0N4 + uPTotM0N4  + uPTotTSurf0N4 ELSE + (sPO4WEpi0N4 + sPDetWEpi0N4 + sPAIMWEpi0N4 + uPPhytWEpi0N4 + sPZooEpi0N4) * sDepthW0N4 / MassEpi0N4+ uPVeg0N4 + sPO4S0N4 + sPDetS0N4 + sPAIMS0N4 + sPHumS0N4 + uPPhytS0N4 + uPFish0N4 + uPPisc0N4 + sPBent0N4 + uPTotM0N4  + uPTotTSurf0N4 ENDIF  ;
uNTotT0N4 =  IF ((aInclStrat0N4 EQ TRUE) AND (sDepthW0N4 GE sMixDepthW0N4)) THEN  uNTotTHyp0N4 + (sNH4WEpi0N4 + sNO3WEpi0N4 + sNDetWEpi0N4 + uNPhytWEpi0N4 + sNZooEpi0N4) * sMixDepthW0N4 / MassEpi0N4 + uNVeg0N4 + sNH4S0N4 + sNO3S0N4 + sNDetS0N4 + uNPhytS0N4 + sNHumS0N4 + uNFish0N4 + uNPisc0N4 + sNBent0N4 + uNTotM0N4  + uNTotTSurf0N4 ELSE   (sNH4WEpi0N4 + sNO3WEpi0N4 + sNDetWEpi0N4 + uNPhytWEpi0N4 + sNZooEpi0N4) * sDepthW0N4 / MassEpi0N4 + uNVeg0N4 + sNH4S0N4 + sNO3S0N4 + sNDetS0N4 + uNPhytS0N4 + sNHumS0N4 + uNFish0N4 + uNPisc0N4 + sNBent0N4 + uNTotM0N4  + uNTotTSurf0N4 ENDIF;
uSiTotT0N4 = IF ((aInclStrat0N4 EQ TRUE) AND (sDepthW0N4 GE sMixDepthW0N4)) THEN uSiTotTHyp0N4+ (sSiO2WEpi0N4 + sSiDetWEpi0N4 + cSiDDiatN4 * sDDiatWEpi0N4) * sMixDepthW0N4 / MassEpi0N4 + sSiDetS0N4 + cSiDDiatN4*sDDiatS0N4 + uSiTotM0N4  ELSE (sSiO2WEpi0N4 + sSiDetWEpi0N4 + cSiDDiatN4 * sDDiatWEpi0N4) * sDepthW0N4 / MassEpi0N4 + sSiDetS0N4 + cSiDDiatN4*sDDiatS0N4 + uSiTotM0N4  ENDIF ;
sDExtTotT0N4 = uDTotT0N4;
sNExtTotT0N4 = uNTotT0N4;
sPExtTotT0N4 = uPTotT0N4;
sSiExtTotT0N4 = uSiTotT0N4;
sO2ExtTotT0N4 = uO2TotT0N4;
sDepthExtTotT0N4 = sDepthW0N4;
