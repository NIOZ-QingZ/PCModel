sTimeN0 = time + DayStartN0;
DaysInYearN0 = DaysPerYearN0* 1;
aInclStratN0 =IF ( InclStratN0 EQ FALSE ) THEN 0.0 ELSE 1.0 ENDIF;
uDepthMixMeasN0 =IF ( calcMixDepthN0 EQ TRUE ) THEN cAMixN0 * POW ( cFetchN0 , (cBMixN0) ) ELSEIF (ReadMixDepthN0 EQ TRUE) THEN mMixDepthN0 ELSE cMixDepthN0 ENDIF;
uDepthWN0= IF sDepthWN0 GT (cMinDepthHypEpiN0 + cMinDepthHypEpiN0) THEN sDepthWN0 ELSE (cMinDepthHypEpiN0 + cMinDepthHypEpiN0) ENDIF;
uDepthWHypN0 =IF ( ( aInclStratN0 EQ TRUE ) AND ((uDepthWN0 - sMixDepthWN0 ) GE cMinDepthHypEpiN0 ) ) THEN uDepthWN0 - sMixDepthWN0  ELSE cMinDepthHypEpiN0 ENDIF;
uDepthWEpiN0 =IF( ( aInclStratN0 EQ TRUE ) AND ( sMixDepthWN0 GE cMinDepthHypEpiN0 ) AND ( uDepthWN0 GE sMixDepthWN0 ) ) THEN sMixDepthWN0 ELSEIF ( ( aInclStratN0 EQ TRUE ) AND ( (sMixDepthWN0 LE cMinDepthHypEpiN0 ) OR (uDepthWN0 LE cMinDepthHypEpiN0 ) ) ) THEN cMinDepthHypEpiN0 ELSEIF ( aInclStratN0 EQ FALSE) THEN uDepthWN0 ELSE uDepthWN0 - uDepthWHypN0 ENDIF;
MassHypN0 = IF CalcMassN0 EQ TRUE THEN uDepthWHypN0 ELSE 1.0 ENDIF;
MassEpiN0 = IF CalcMassN0 EQ TRUE THEN uDepthWEpiN0 ELSE 1.0 ENDIF;
MassWMN0 = IF CalcMassN0 EQ TRUE THEN sDepthWMN0 ELSE 1.0 ENDIF;
oNH4WHypN0= IF sNH4WHypN0 GT NearZeroN0 THEN sNH4WHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNO3WHypN0= IF sNO3WHypN0 GT NearZeroN0 THEN sNO3WHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPO4WHypN0= IF sPO4WHypN0 GT NearZeroN0 THEN sPO4WHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPAIMWHypN0= IF sPAIMWHypN0 GT NearZeroN0 THEN sPAIMWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oSiO2WHypN0= IF sSiO2WHypN0 GT NearZeroN0 THEN sSiO2WHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oO2WHypN0= IF sO2WHypN0 GT NearZeroN0 THEN sO2WHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDDetWHypN0= IF sDDetWHypN0 GT NearZeroN0 THEN sDDetWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNDetWHypN0= IF sNDetWHypN0 GT NearZeroN0 THEN sNDetWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPDetWHypN0= IF sPDetWHypN0 GT NearZeroN0 THEN sPDetWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oSiDetWHypN0= IF sSiDetWHypN0 GT NearZeroN0 THEN sSiDetWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDIMWHypN0= IF sDIMWHypN0 GT NearZeroN0 THEN sDIMWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDDiatWHypN0= IF sDDiatWHypN0 GT NearZeroN0 THEN sDDiatWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNDiatWHypN0= IF sNDiatWHypN0 GT NearZeroN0 THEN sNDiatWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPDiatWHypN0= IF sPDiatWHypN0 GT NearZeroN0 THEN sPDiatWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDGrenWHypN0= IF sDGrenWHypN0 GT NearZeroN0 THEN sDGrenWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNGrenWHypN0= IF sNGrenWHypN0 GT NearZeroN0 THEN sNGrenWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPGrenWHypN0= IF sPGrenWHypN0 GT NearZeroN0 THEN sPGrenWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDBlueWHypN0= IF sDBlueWHypN0 GT NearZeroN0 THEN sDBlueWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNBlueWHypN0= IF sNBlueWHypN0 GT NearZeroN0 THEN sNBlueWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPBlueWHypN0= IF sPBlueWHypN0 GT NearZeroN0 THEN sPBlueWHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oDZooHypN0= IF sDZooHypN0 GT NearZeroN0 THEN sDZooHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oNZooHypN0= IF sNZooHypN0 GT NearZeroN0 THEN sNZooHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
oPZooHypN0= IF sPZooHypN0 GT NearZeroN0 THEN sPZooHypN0 / MassHypN0 ELSE NearZeroN0 ENDIF;
aDFiAdN0= IF sDFiAdN0 GT NearZeroN0 THEN sDFiAdN0 ELSE NearZeroN0 ENDIF;
aDFiJvN0= IF sDFiJvN0 GT NearZeroN0 THEN sDFiJvN0 ELSE NearZeroN0 ENDIF;
aNFiAdN0= IF sNFiAdN0 GT NearZeroN0 THEN sNFiAdN0 ELSE NearZeroN0 ENDIF;
aNFiJvN0= IF sNFiJvN0 GT NearZeroN0 THEN sNFiJvN0 ELSE NearZeroN0 ENDIF;
aPFiAdN0= IF sPFiAdN0 GT NearZeroN0 THEN sPFiAdN0 ELSE NearZeroN0 ENDIF;
aPFiJvN0= IF sPFiJvN0 GT NearZeroN0 THEN sPFiJvN0 ELSE NearZeroN0 ENDIF;
aDPiscN0= IF sDPiscN0 GT NearZeroN0 THEN sDPiscN0 ELSE NearZeroN0 ENDIF;
aNH4SN0= IF sNH4SN0 GT NearZeroN0 THEN sNH4SN0 ELSE NearZeroN0 ENDIF;
aNO3SN0= IF sNO3SN0 GT NearZeroN0 THEN sNO3SN0 ELSE NearZeroN0 ENDIF;
aPO4SN0= IF sPO4SN0 GT NearZeroN0 THEN sPO4SN0 ELSE NearZeroN0 ENDIF;
aPAIMSN0= IF sPAIMSN0 GT NearZeroN0 THEN sPAIMSN0 ELSE NearZeroN0 ENDIF;
aDDetSN0= IF sDDetSN0 GT NearZeroN0 THEN sDDetSN0 ELSE NearZeroN0 ENDIF;
aNDetSN0= IF sNDetSN0 GT NearZeroN0 THEN sNDetSN0 ELSE NearZeroN0 ENDIF;
aPDetSN0= IF sPDetSN0 GT NearZeroN0 THEN sPDetSN0 ELSE NearZeroN0 ENDIF;
aSiDetSN0= IF sSiDetSN0 GT NearZeroN0 THEN sSiDetSN0 ELSE NearZeroN0 ENDIF;
aDHumSN0= IF sDHumSN0 GT NearZeroN0 THEN sDHumSN0 ELSE NearZeroN0 ENDIF;
aNHumSN0= IF sNHumSN0 GT NearZeroN0 THEN sNHumSN0 ELSE NearZeroN0 ENDIF;
aPHumSN0= IF sPHumSN0 GT NearZeroN0 THEN sPHumSN0 ELSE NearZeroN0 ENDIF;
aDIMSN0= IF sDIMSN0 GT NearZeroN0 THEN sDIMSN0 ELSE NearZeroN0 ENDIF;
aDDiatSN0= IF sDDiatSN0 GT NearZeroN0 THEN sDDiatSN0 ELSE NearZeroN0 ENDIF;
aNDiatSN0= IF sNDiatSN0 GT NearZeroN0 THEN sNDiatSN0 ELSE NearZeroN0 ENDIF;
aPDiatSN0= IF sPDiatSN0 GT NearZeroN0 THEN sPDiatSN0 ELSE NearZeroN0 ENDIF;
aDGrenSN0= IF sDGrenSN0 GT NearZeroN0 THEN sDGrenSN0 ELSE NearZeroN0 ENDIF;
aNGrenSN0= IF sNGrenSN0 GT NearZeroN0 THEN sNGrenSN0 ELSE NearZeroN0 ENDIF;
aPGrenSN0= IF sPGrenSN0 GT NearZeroN0 THEN sPGrenSN0 ELSE NearZeroN0 ENDIF;
aDBlueSN0= IF sDBlueSN0 GT NearZeroN0 THEN sDBlueSN0 ELSE NearZeroN0 ENDIF;
aNBlueSN0= IF sNBlueSN0 GT NearZeroN0 THEN sNBlueSN0 ELSE NearZeroN0 ENDIF;
aPBlueSN0= IF sPBlueSN0 GT NearZeroN0 THEN sPBlueSN0 ELSE NearZeroN0 ENDIF;
aDVegN0= IF sDVegN0 GT NearZeroN0 THEN sDVegN0 ELSE NearZeroN0 ENDIF;
aNVegN0= IF sNVegN0 GT NearZeroN0 THEN sNVegN0 ELSE NearZeroN0 ENDIF;
aPVegN0= IF sPVegN0 GT NearZeroN0 THEN sPVegN0 ELSE NearZeroN0 ENDIF;
aVegHeightN0= IF sVegHeightN0 GT NearZeroN0 THEN sVegHeightN0 ELSE NearZeroN0 ENDIF;
aDBentN0= IF sDBentN0 GT NearZeroN0 THEN sDBentN0 ELSE NearZeroN0 ENDIF;
aNBentN0= IF sNBentN0 GT NearZeroN0 THEN sNBentN0 ELSE NearZeroN0 ENDIF;
aPBentN0= IF sPBentN0 GT NearZeroN0 THEN sPBentN0 ELSE NearZeroN0 ENDIF;
uDepthWMN0= IF sDepthWMN0 GT NearZeroN0 THEN sDepthWMN0 ELSE NearZeroN0 ENDIF;
oNH4WMN0= IF sNH4WMN0 GT NearZeroN0 THEN sNH4WMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNO3WMN0= IF sNO3WMN0 GT NearZeroN0 THEN sNO3WMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPO4WMN0= IF sPO4WMN0 GT NearZeroN0 THEN sPO4WMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPAIMWMN0= IF sPAIMWMN0 GT NearZeroN0 THEN sPAIMWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oSiO2WMN0= IF sSiO2WMN0 GT NearZeroN0 THEN sSiO2WMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oO2WMN0= IF sO2WMN0 GT NearZeroN0 THEN sO2WMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDDetWMN0= IF sDDetWMN0 GT NearZeroN0 THEN sDDetWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNDetWMN0= IF sNDetWMN0 GT NearZeroN0 THEN sNDetWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPDetWMN0= IF sPDetWMN0 GT NearZeroN0 THEN sPDetWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oSiDetWMN0= IF sSiDetWMN0 GT NearZeroN0 THEN sSiDetWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDIMWMN0= IF sDIMWMN0 GT NearZeroN0 THEN sDIMWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDDiatWMN0= IF sDDiatWMN0 GT NearZeroN0 THEN sDDiatWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNDiatWMN0= IF sNDiatWMN0 GT NearZeroN0 THEN sNDiatWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPDiatWMN0= IF sPDiatWMN0 GT NearZeroN0 THEN sPDiatWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDGrenWMN0= IF sDGrenWMN0 GT NearZeroN0 THEN sDGrenWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNGrenWMN0= IF sNGrenWMN0 GT NearZeroN0 THEN sNGrenWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPGrenWMN0= IF sPGrenWMN0 GT NearZeroN0 THEN sPGrenWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDBlueWMN0= IF sDBlueWMN0 GT NearZeroN0 THEN sDBlueWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNBlueWMN0= IF sNBlueWMN0 GT NearZeroN0 THEN sNBlueWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPBlueWMN0= IF sPBlueWMN0 GT NearZeroN0 THEN sPBlueWMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oDZooMN0= IF sDZooMN0 GT NearZeroN0 THEN sDZooMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oNZooMN0= IF sNZooMN0 GT NearZeroN0 THEN sNZooMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
oPZooMN0= IF sPZooMN0 GT NearZeroN0 THEN sPZooMN0 / MassWMN0 ELSE NearZeroN0 ENDIF;
aNH4SMN0= IF sNH4SMN0 GT NearZeroN0 THEN sNH4SMN0 ELSE NearZeroN0 ENDIF;
aNO3SMN0= IF sNO3SMN0 GT NearZeroN0 THEN sNO3SMN0 ELSE NearZeroN0 ENDIF;
aPO4SMN0= IF sPO4SMN0 GT NearZeroN0 THEN sPO4SMN0 ELSE NearZeroN0 ENDIF;
aPAIMSMN0= IF sPAIMSMN0 GT NearZeroN0 THEN sPAIMSMN0 ELSE NearZeroN0 ENDIF;
aDDetSMN0= IF sDDetSMN0 GT NearZeroN0 THEN sDDetSMN0 ELSE NearZeroN0 ENDIF;
aNDetSMN0= IF sNDetSMN0 GT NearZeroN0 THEN sNDetSMN0 ELSE NearZeroN0 ENDIF;
aPDetSMN0= IF sPDetSMN0 GT NearZeroN0 THEN sPDetSMN0 ELSE NearZeroN0 ENDIF;
aSiDetSMN0= IF sSiDetSMN0 GT NearZeroN0 THEN sSiDetSMN0 ELSE NearZeroN0 ENDIF;
aDHumSMN0= IF sDHumSMN0 GT NearZeroN0 THEN sDHumSMN0 ELSE NearZeroN0 ENDIF;
aNHumSMN0= IF sNHumSMN0 GT NearZeroN0 THEN sNHumSMN0 ELSE NearZeroN0 ENDIF;
aPHumSMN0= IF sPHumSMN0 GT NearZeroN0 THEN sPHumSMN0 ELSE NearZeroN0 ENDIF;
aDIMSMN0= IF sDIMSMN0 GT NearZeroN0 THEN sDIMSMN0 ELSE NearZeroN0 ENDIF;
aDRootPhraN0= IF sDRootPhraN0 GT NearZeroN0 THEN sDRootPhraN0 ELSE NearZeroN0 ENDIF;
aDShootPhraN0= IF sDShootPhraN0 GT NearZeroN0 THEN sDShootPhraN0 ELSE NearZeroN0 ENDIF;
aNRootPhraN0= IF sNRootPhraN0 GT NearZeroN0 THEN sNRootPhraN0 ELSE NearZeroN0 ENDIF;
aNShootPhraN0= IF sNShootPhraN0 GT NearZeroN0 THEN sNShootPhraN0 ELSE NearZeroN0 ENDIF;
aPRootPhraN0= IF sPRootPhraN0 GT NearZeroN0 THEN sPRootPhraN0 ELSE NearZeroN0 ENDIF;
aPShootPhraN0= IF sPShootPhraN0 GT NearZeroN0 THEN sPShootPhraN0 ELSE NearZeroN0 ENDIF;
oNH4WEpiN0= IF sNH4WEpiN0 GT NearZeroN0 THEN sNH4WEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNO3WEpiN0= IF sNO3WEpiN0 GT NearZeroN0 THEN sNO3WEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPO4WEpiN0= IF sPO4WEpiN0 GT NearZeroN0 THEN sPO4WEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPAIMWEpiN0= IF sPAIMWEpiN0 GT NearZeroN0 THEN sPAIMWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oSiO2WEpiN0= IF sSiO2WEpiN0 GT NearZeroN0 THEN sSiO2WEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oO2WEpiN0= IF sO2WEpiN0 GT NearZeroN0 THEN sO2WEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDDetWEpiN0= IF sDDetWEpiN0 GT NearZeroN0 THEN sDDetWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNDetWEpiN0= IF sNDetWEpiN0 GT NearZeroN0 THEN sNDetWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPDetWEpiN0= IF sPDetWEpiN0 GT NearZeroN0 THEN sPDetWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oSiDetWEpiN0= IF sSiDetWEpiN0 GT NearZeroN0 THEN sSiDetWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDIMWEpiN0= IF sDIMWEpiN0 GT NearZeroN0 THEN sDIMWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDDiatWEpiN0= IF sDDiatWEpiN0 GT NearZeroN0 THEN sDDiatWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNDiatWEpiN0= IF sNDiatWEpiN0 GT NearZeroN0 THEN sNDiatWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPDiatWEpiN0= IF sPDiatWEpiN0 GT NearZeroN0 THEN sPDiatWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDGrenWEpiN0= IF sDGrenWEpiN0 GT NearZeroN0 THEN sDGrenWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNGrenWEpiN0= IF sNGrenWEpiN0 GT NearZeroN0 THEN sNGrenWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPGrenWEpiN0= IF sPGrenWEpiN0 GT NearZeroN0 THEN sPGrenWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDBlueWEpiN0= IF sDBlueWEpiN0 GT NearZeroN0 THEN sDBlueWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNBlueWEpiN0= IF sNBlueWEpiN0 GT NearZeroN0 THEN sNBlueWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPBlueWEpiN0= IF sPBlueWEpiN0 GT NearZeroN0 THEN sPBlueWEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oDZooEpiN0= IF sDZooEpiN0 GT NearZeroN0 THEN sDZooEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oNZooEpiN0= IF sNZooEpiN0 GT NearZeroN0 THEN sNZooEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
oPZooEpiN0= IF sPZooEpiN0 GT NearZeroN0 THEN sPZooEpiN0 / MassEpiN0 ELSE NearZeroN0 ENDIF;
aDBlueSurfN0= IF sDBlueSurfN0 GT NearZeroN0 THEN sDBlueSurfN0 ELSE NearZeroN0 ENDIF;
aNBlueSurfN0= IF sNBlueSurfN0 GT NearZeroN0 THEN sNBlueSurfN0  ELSE NearZeroN0 ENDIF;
aPBlueSurfN0= IF sPBlueSurfN0 GT NearZeroN0 THEN sPBlueSurfN0  ELSE NearZeroN0 ENDIF;
aDExtTotTN0= sDExtTotTN0;
aNExtTotTN0= sNExtTotTN0 ;
aPExtTotTN0=  sPExtTotTN0 ;
aSiExtTotTN0= sSiExtTotTN0;
aO2ExtTotTN0=sO2ExtTotTN0 ;
aDepthExtTotTN0=sDepthExtTotTN0 ;
aDDetWEpiN0= IF sDDetWEpiN0 GT NearZeroN0 THEN sDDetWEpiN0 ELSE NearZeroN0 ENDIF;
aNDetWEpiN0= IF sNDetWEpiN0 GT NearZeroN0 THEN sNDetWEpiN0  ELSE NearZeroN0 ENDIF;
aPDetWEpiN0= IF sPDetWEpiN0 GT NearZeroN0 THEN sPDetWEpiN0  ELSE NearZeroN0 ENDIF;
aSiDetWEpiN0= IF sSiDetWEpiN0 GT NearZeroN0 THEN sSiDetWEpiN0 ELSE NearZeroN0 ENDIF;
aDIMWEpiN0= IF sDIMWEpiN0 GT NearZeroN0 THEN aDIMWEpiN0  ELSE NearZeroN0 ENDIF;
aDDiatWEpiN0= IF sDDiatWEpiN0 GT NearZeroN0 THEN sDDiatWEpiN0 ELSE NearZeroN0 ENDIF;
aNDiatWEpiN0= IF sNDiatWEpiN0 GT NearZeroN0 THEN sNDiatWEpiN0  ELSE NearZeroN0 ENDIF;
aPDiatWEpiN0= IF sPDiatWEpiN0 GT NearZeroN0 THEN sPDiatWEpiN0  ELSE NearZeroN0 ENDIF;
aDGrenWEpiN0= IF sDGrenWEpiN0 GT NearZeroN0 THEN sDGrenWEpiN0 ELSE NearZeroN0 ENDIF;
aNGrenWEpiN0= IF sNGrenWEpiN0 GT NearZeroN0 THEN sNGrenWEpiN0 ELSE NearZeroN0 ENDIF;
aPGrenWEpiN0= IF sPGrenWEpiN0 GT NearZeroN0 THEN sPGrenWEpiN0 ELSE NearZeroN0 ENDIF;
aDBlueWEpiN0= IF sDBlueWEpiN0 GT NearZeroN0 THEN sDBlueWEpiN0 ELSE NearZeroN0 ENDIF;
aNBlueWEpiN0= IF sNBlueWEpiN0 GT NearZeroN0 THEN sNBlueWEpiN0  ELSE NearZeroN0 ENDIF;
aPBlueWEpiN0= IF sPBlueWEpiN0 GT NearZeroN0 THEN sPBlueWEpiN0 ELSE NearZeroN0 ENDIF;
aDBlueWHypN0= IF sDBlueWEpiN0 GT NearZeroN0 THEN sDBlueWEpiN0 ELSE NearZeroN0 ENDIF;
TimeYearsN0 = sTimeN0 / DaysPerYearN0;
DayN0 = sTimeN0 - FLOOR(TimeYearsN0) * DaysPerYearN0;
YearsN0 = YearZeroN0 + TimeYearsN0;
aVegEHeightN0 =   POW ( cVegHPar1N0*aDVegN0 , cVegHPar2N0 ) ;
uVegHeightN0 =  IF ( UseVegHeightN0 EQ FALSE AND  aVegHeightN0 LT uDepthWN0 ) THEN aVegHeightN0 ELSEIF ( UseVegHeightN0 EQ FALSE ) THEN ( uDepthWN0 ) ELSE MIN ( aVegHeightN0 , uDepthWN0 , aVegEHeightN0 ) ENDIF;
uVegHeightHypN0 = IF ( aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uVegHeightN0 GT uDepthWHypN0 ) THEN uDepthWHypN0 ELSE uVegHeightN0 ENDIF;
uVegHeightEpiN0 = IF ( aInclStratN0 EQ FALSE AND uVegHeightN0 LT uDepthWEpiN0 ) THEN uVegHeightN0 ELSEIF ( aInclStratN0 EQ FALSE AND uVegHeightN0 GE uDepthWEpiN0 ) THEN uDepthWEpiN0 ELSEIF (uVegHeightN0 GT uDepthWHypN0 ) THEN uVegHeightN0 -uDepthWHypN0 ELSE 0.0 ENDIF;
aDepth2VegHypN0 = IF ( aInclStratN0 EQ TRUE AND fDepth2VegN0 GE 1 ) THEN uDepthWHypN0  ELSEIF ( aInclStratN0 EQ TRUE AND fDepth2VegN0 LT 1 ) THEN MAX (0.0, uVegHeightN0 - uDepthWEpiN0 ) ELSE 0.0 ENDIF;
aDepth1VegHypN0 = IF ( aInclStratN0 EQ TRUE AND fDepth2VegN0 GE 1 ) THEN uDepthWHypN0 - uVegHeightHypN0  ELSE 0.0 ENDIF;
aDepth2VegEpiN0 = IF (fDepth2VegN0 GE 1 ) THEN uDepthWEpiN0 ELSE uDepthWEpiN0 - uVegHeightEpiN0 ENDIF;
aDepth1VegEpiN0 = IF (fDepth2VegN0 GE 1 ) THEN uDepthWEpiN0 - uVegHeightEpiN0  ELSE 0.0 ENDIF;
uVegHeightLightN0 = cVegLN0 *LN( 1.0 + uVegHeightN0 );
uVegHeightLightSumN0 = cVegLN0 *LN( 1.0 + MAX (uVegHeightN0, MIN (uDepthWN0, cVegHeightN0) ) );
uVegHeightLightEpiN0 = IF (  uVegHeightLightN0 GT uVegHeightEpiN0 ) THEN uVegHeightEpiN0 ELSE uVegHeightLightN0 ENDIF;
uVegHeightLightHypN0 =  uVegHeightLightN0 - uVegHeightLightEpiN0  ;
uDVegHypN0 = uVegHeightHypN0 / uVegHeightN0 * aDVegN0;
uDVegEpiN0 = uVegHeightEpiN0 / uVegHeightN0 * aDVegN0;
uVegShadeN0 = IF ( ReadVegShadeN0  EQ  TRUE) THEN mVegShadeN0 ELSE fVegShadeN0 ENDIF;
aExtPhytHypN0 = cExtSpDiatN0 * oDDiatWHypN0 + cExtSpGrenN0 * oDGrenWHypN0 + cExtSpBlueN0 * oDBlueWHypN0;
aExtDetHypN0 = cExtSpDetN0 * oDDetWHypN0;
aExtIMHypN0 = cExtSpIMN0 * oDIMWHypN0;
aExtCoefOpenHypN0 = cExtWatN0 + aExtIMHypN0 + aExtDetHypN0 + aExtPhytHypN0;
aExtPhytEpiN0 = cExtSpDiatN0 * oDDiatWEpiN0 + cExtSpGrenN0 * oDGrenWEpiN0 + cExtSpBlueN0 * oDBlueWEpiN0;
aExtDetEpiN0 = cExtSpDetN0 * oDDetWEpiN0;
aExtIMEpiN0 = cExtSpIMN0 * oDIMWEpiN0;
aExtCoefOpenEpiN0 = cExtWatN0 + aExtIMEpiN0 + aExtDetEpiN0 + aExtPhytEpiN0;
aExtSurfN0 = cExtSpBlueN0 * aDBlueSurfN0;
aTmEpiN0 =  cTmAveEpiN0 - cTmVarEpiN0 * COS(2.0*PiN0*(sTimeN0 + TenDaysN0 - cTimeLagN0) / DaysInYearN0) ;
aTmHypN0 =  cTmAveHypN0 - cTmVarHypN0 * COS(2.0*PiN0*(sTimeN0 + TenDaysN0 - cTimeLagN0) / DaysInYearN0) ;
uTmEpiN0 = IF (FALSE EQ InclSeasonN0) THEN cTmAveEpiN0 ELSEIF (ReadTempN0 EQ TRUE) THEN mTempEpiN0 ELSEIF ( aTmEpiN0 GT 0.0  ) THEN aTmEpiN0 ELSE  0.0 ENDIF;
uTmHypN0 = IF (FALSE EQ InclSeasonN0) THEN cTmAveHypN0 ELSEIF (ReadTempN0 EQ TRUE) THEN mTempHypN0 ELSEIF ( aTmHypN0 GT 0.0  ) THEN aTmHypN0 ELSE  0.0 ENDIF;
uTmBotN0 = IF (aInclStratN0 EQ TRUE ) THEN uTmHypN0 ELSE uTmEpiN0 ENDIF;
uTmSurfN0 = uTmEpiN0;
uLATN0= cLATN0*2*PiN0/360;
uSolDecAngN0= IF(InclLatN0 EQ TRUE) THEN cPhiRN0*COS(2*PiN0*(DayN0-cDayRN0)/DaysInYearN0) ELSE 0.0 ENDIF;
uSunRiseN0 = HoursInDayN0/(2*PiN0)*ACOS((SIN(uLATN0)* SIN(uSolDecAngN0))/(COS(uLATN0)*COS(uSolDecAngN0))) ;
uSunSetN0=HoursInDayN0-uSunRiseN0;
uSunHoursN0=uSunSetN0-uSunRiseN0;
uSunPathN0= IF(InclLatN0 EQ TRUE) THEN SIN(uLATN0)*SIN( uSolDecAngN0 )*( uSunSetN0-uSunRiseN0)- COS(uLATN0) * COS (uSolDecAngN0) * HoursInDayN0 / (2*PiN0) * ( SIN (2*PiN0*uSunSetN0/HoursInDayN0 ) -SIN(2*PiN0*uSunRiseN0 /HoursInDayN0 )) ELSE 0.0 ENDIF;
uTransN0=IF((InclLatN0 EQ TRUE) AND (ConstTransN0 EQ FALSE)) THEN (0.6-0.2*(uSunPathN0/(uSunSetN0 - uSunRiseN0)))*(1-0.4*fCloudHN0) *(1-0.7* fCloudMN0) *(1-0.4*fCloudLN0)ELSEIF ((InclLatN0 EQ TRUE) AND (ConstTransN0 EQ TRUE)) THEN cTransN0 ELSE 0.0 ENDIF;
ufDayN0 = IF (FALSE EQ InclSeasonN0) THEN cfDayAveN0 ELSEIF (InclLatN0 EQ TRUE) THEN (uSunSetN0 -uSunRiseN0 )/ HoursInDayN0 ELSE cfDayAveN0 - cfDayVarN0 * COS( 2.0 *PiN0*(sTimeN0+TenDaysN0) / DaysInYearN0) ENDIF;
uLDayN0 = IF (FALSE EQ InclSeasonN0) THEN cLDayAveN0 ELSEIF (ReadLOutN0 EQ TRUE) THEN 0.0 ELSEIF (InclLatN0 EQ TRUE) THEN cSolarN0*uTransN0*uSunPathN0 * SecsPerDayN0 /HoursInDayN0 ELSE cLDayAveN0 - cLDayVarN0 * COS(2.0*PiN0*(sTimeN0+TenDaysN0) / DaysInYearN0) ENDIF;
uLOutN0 = IF (FALSE EQ InclSeasonN0) THEN uLDayN0 / SecsPerDayN0 / ufDayN0 ELSEIF (ReadLOutN0 EQ TRUE) THEN mLOutN0 / ufDayN0 ELSE uLDayN0 / SecsPerDayN0 / ufDayN0 ENDIF;
uLPARSurfN0 = fPARN0 * (1.0 - fReflN0) * uLOutN0;
aLPARBotSurfN0 = IF (InclSurfN0 EQ TRUE) THEN uLPARSurfN0 * EXP(- aExtSurfN0) ELSE uLPARSurfN0 ENDIF;
aLPARBotEpiOpenN0 = aLPARBotSurfN0 * EXP(- aExtCoefOpenEpiN0 * uDepthWEpiN0);
aLPARBotHypOpenN0 = aLPARBotEpiOpenN0 * EXP(- aExtCoefOpenHypN0 * uDepthWHypN0);
aLPAR1VegEpiN0 = aLPARBotSurfN0 * EXP(- aExtCoefOpenEpiN0 * aDepth1VegEpiN0) * ( 1 - uVegShadeN0 );
aLPAR1VegHypN0 = aLPAR1VegEpiN0 * EXP(- aExtCoefOpenHypN0 * aDepth1VegHypN0);
aLPARVegLightN0 =  IF  ( aInclStratN0 EQ TRUE AND  uVegHeightN0 LE uDepthWHypN0 ) THEN aLPAR1VegHypN0 *   EXP(- aExtCoefOpenHypN0 * uVegHeightLightEpiN0) ELSE aLPAR1VegEpiN0 *  EXP(- aExtCoefOpenEpiN0 * uVegHeightLightEpiN0)  *  EXP(- aExtCoefOpenHypN0 * uVegHeightLightEpiN0) ENDIF;
uTmVegAveN0 = ( uVegHeightHypN0 * uTmHypN0 + uVegHeightEpiN0 * uTmEpiN0 ) / uVegHeightN0;
uFunTmVegN0 = EXP(-0.5/(cSigTmVegN0*cSigTmVegN0) *((uTmVegAveN0-cTmOptVegN0)*(uTmVegAveN0-cTmOptVegN0) - (cTmRefN0-cTmOptVegN0)*(cTmRefN0-cTmOptVegN0)));
uFunTmProdVegN0 = IF ( UseExpVegN0 EQ TRUE ) THEN uFunTmVegN0 ELSE POW ( cQ10ProdVegN0 , (0.1 * (uTmVegAveN0 - cTmRefN0))) ENDIF;
uhLVegN0 = hLRefVegN0 * uFunTmProdVegN0;
aLPIVegN0 = IF ( aInclStratN0 EQ TRUE AND  uVegHeightN0 GT uDepthWHypN0 ) THEN cPMaxN0*(aLPAR1VegEpiN0- aLPARVegLightN0 + uhLVegN0*LN((1.0 +aLPARVegLightN0/ uhLVegN0)  /(1.0 +aLPAR1VegEpiN0  / uhLVegN0) + NearZeroN0  ) )ELSEIF  ( aInclStratN0 EQ TRUE AND  uVegHeightN0 LE uDepthWHypN0 ) THEN cPMaxN0*( aLPAR1VegHypN0- aLPARVegLightN0 + uhLVegN0* LN((1.0 +aLPARVegLightN0/ uhLVegN0)  / (1.0 +aLPAR1VegHypN0  / uhLVegN0) ) ) ELSE cPMaxN0 * (aLPAR1VegEpiN0- aLPARVegLightN0 + uhLVegN0*LN((1.0 +aLPARVegLightN0/ uhLVegN0)  /(1.0 +aLPAR1VegEpiN0  / uhLVegN0) + NearZeroN0  ) )ENDIF;
aSpringN0 =  IF ( cLATN0 LT 0 AND DayN0 GE 265 AND DayN0 LE 356 ) THEN 1 ELSEIF ( cLATN0 GT 0 AND DayN0 GE 80 AND DayN0 LE 173) THEN 1 ELSEIF ( cLATN0 EQ 0) THEN 1 ELSE 0 ENDIF;
aTimeWinVegN0 =  IF ( sTimeN0 LT StartTimeN0 + 1.0 ) THEN -999 ELSEIF ( UsePhotVegN0 EQ FALSE  AND  ( uTmBotN0 GE cTmInitVegN0 )  AND aSpringN0 EQ 1 ) THEN sTimeN0  ELSEIF (UsePhotVegN0 EQ TRUE  AND  uSunHoursN0 GE cPhotInitVegN0   AND aSpringN0 EQ 1 ) THEN sTimeN0 ELSEIF (( aLPIVegN0 / uVegHeightLightN0 )LE cLAlloVegN0 ) THEN aTimeWinVegN0 ELSEIF (FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeWinVegN0 + 0.3) GT 1 AND FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeWinVegN0 + 0.3) LT cVegWinLenN0 ) THEN aTimeWinVegN0 ELSE sTimeN0 ENDIF ;
aTimeInitVegN0 =  IF ( sTimeN0 LT StartTimeN0 + 1.0 ) THEN -999 ELSEIF ( FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeWinVegN0 + 0.3) GT 1 ) THEN sTimeN0 ELSEIF ( UsePhotVegN0 EQ FALSE  AND  uTmBotN0 GE cTmInitVegN0 ) THEN aTimeInitVegN0 ELSEIF ( UsePhotVegN0 EQ TRUE  AND    uSunHoursN0 GE cPhotInitVegN0  ) THEN aTimeInitVegN0 ELSEIF (UsePhotVegN0 EQ FALSE  AND  uTmBotN0 LT cTmInitVegN0 AND ( ( aLPIVegN0 / uVegHeightLightN0 ) GE cLAlloVegN0 ) AND FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeInitVegN0 + 0.3) GT 1) THEN aTimeInitVegN0 ELSEIF (UsePhotVegN0 EQ TRUE  AND   uSunHoursN0 LT cPhotInitVegN0 AND ( ( aLPIVegN0 / uVegHeightLightN0 ) GE cLAlloVegN0 ) AND FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeInitVegN0 + 0.3) GT 1) THEN aTimeInitVegN0 ELSEIF (FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeInitVegN0 + 0.3) GT 1 AND FLOOR ( sTimeN0+ 0.3 ) - FLOOR (aTimeInitVegN0 + 0.3) LT cVegInitLenN0 ) THEN aTimeInitVegN0 ELSE sTimeN0 ENDIF ;
aTimeWinVegCorN0 = IF ( UseLWinVegN0 LE NearZeroN0 ) THEN FLOOR (TimeYearsN0 - 1) + cDayWinVegN0  ELSE aTimeWinVegN0 ENDIF;
aDayInitVegN0 = IF (DayN0 LT 1.0 OR sTimeN0 LT StartTimeN0 + 1.0) THEN 367 ELSEIF (uTmBotN0 GE cTmInitVegN0 AND aDayInitVegN0 GT 366) THEN DayN0 ELSE aDayInitVegN0 ENDIF;
aTimeInitVegCorN0 = IF (UsePhotVegN0 LE NearZeroN0 AND UseLWinVegN0 LE NearZeroN0 ) THEN  (TimeYearsN0 - 1)  + aDayInitVegN0  ELSE aTimeInitVegN0 ENDIF;
aVegSumN0 =  IF ( FLOOR ( aTimeInitVegCorN0 + 0.3) LT FLOOR (  sTimeN0 + 0.3 ) AND FLOOR ( aTimeWinVegCorN0 + 0.3 ) EQ FLOOR (  sTimeN0  + 0.3 ) ) THEN 1 ELSE 0 ENDIF;
aVegWinN0 =  1 - aVegSumN0;
aDaysVegSumN0 = ( FLOOR ( sTimeN0+ 0.3) - FLOOR (aTimeInitVegCorN0 + 0.3) ) * aVegSumN0;
aDaysVegWinN0 = ( FLOOR ( sTimeN0 + 0.3) - FLOOR ( aTimeWinVegCorN0  + 0.3 )  ) * aVegWinN0;
bfRootVegN0 = IF (FALSE EQ InclSeasonN0) THEN fRootVegSumN0 ELSEIF (aVegWinN0 EQ TRUE AND aDaysVegWinN0 GT cLengAlloN0) THEN fRootVegWinN0 ELSEIF (aVegSumN0 EQ TRUE AND aDaysVegSumN0 LE cLengAlloN0) THEN 0.5*(fRootVegWinN0 + fRootVegSumN0) + 0.5*(fRootVegWinN0 - fRootVegSumN0) * COS ( PiN0 /cLengAlloN0 * ( sTimeN0 - aTimeInitVegCorN0 )) ELSEIF ( aVegWinN0 EQ TRUE AND aDaysVegWinN0 EQ 0) THEN fRootVegWinN0 ELSEIF ( aVegWinN0 EQ TRUE) THEN 0.5*( fRootVegWinN0 + fRootVegSumN0) - 0.5*( fRootVegWinN0 - fRootVegSumN0) * COS ( PiN0 / cLengAlloN0 * ( sTimeN0 - aTimeWinVegCorN0 )) ELSE fRootVegSumN0 ENDIF;
bfShootVegN0 = 1.0 - bfRootVegN0;
aDShootVegN0 = bfShootVegN0 * aDVegN0;
aDEmergVegN0 = fEmergVegN0 * aDShootVegN0;
aDFloatVegN0 = IF  ( aDepth1VegEpiN0 LT 0.005 ) THEN fFloatVegN0 * aDShootVegN0 ELSE 0 ENDIF;
bfSubVegN0 = 1.0 - fFloatVegN0 - fEmergVegN0;
aDSubVegN0 = bfSubVegN0 * aDShootVegN0;
aExtVegHypN0 = cExtSpVegN0 * aDSubVegN0 / uDepthWHypN0 * (uVegHeightHypN0 /uDepthWN0 );
aExtCoefHypN0 = aExtCoefOpenHypN0 + aExtVegHypN0;
aExtVegEpiN0 = cExtSpVegN0 * aDSubVegN0 / uDepthWEpiN0 * (uVegHeightEpiN0 /uDepthWN0 ) ;
aExtCoefEpiN0 = aExtCoefOpenEpiN0 + aExtVegEpiN0;
aLPARBotEpiN0 = aLPARBotSurfN0 * EXP(- aExtCoefEpiN0 * uDepthWEpiN0);
uLPARSurfHypN0 = IF ( aInclStratN0 EQ TRUE ) THEN aLPARBotEpiN0 ELSE 0.0 ENDIF;
aLPAR2VegEpiN0 = aLPAR1VegEpiN0 * EXP(- aExtCoefEpiN0 * (aDepth2VegEpiN0 - aDepth1VegEpiN0));
aLPAR2VegHypN0 = aLPAR1VegHypN0 * EXP(- aExtCoefHypN0 * (aDepth2VegHypN0 - aDepth1VegHypN0));
uVWindN0 = IF (ReadVWindN0 EQ TRUE)THEN mVWindN0 ELSE cVWindN0 ENDIF;
aStratN0 = IF (ReadStratN0 EQ TRUE) THEN mStratN0 ELSEIF ((uTmEpiN0 -uTmHypN0) GT  cStratTmN0 OR (uTmHypN0 -uTmEpiN0) GT  cStratTmN0) THEN 1.0  ELSE 0.0 ENDIF;
uQInSeasonN0 = IF (FALSE EQ UseSeasonLoadN0) THEN 0.0 ELSEIF (DayN0 LT cDayApril1N0 - 0.5*cLengChangeN0) THEN cQInWinN0 ELSEIF (DayN0 LT cDayApril1N0 + 0.5*cLengChangeN0) THEN 0.5*(cQInWinN0 + cQInSumN0) + 0.5*(cQInWinN0 - cQInSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayApril1N0)) ELSEIF (DayN0 LT cDayOct1N0 - 0.5*cLengChangeN0) THEN cQInSumN0 ELSEIF (DayN0 LT cDayOct1N0 + 0.5*cLengChangeN0) THEN 0.5*(cQInWinN0 + cQInSumN0) - 0.5*(cQInWinN0 - cQInSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayOct1N0)) ELSE cQInWinN0 ENDIF;
uQEvSinusN0 = cQEvAveN0 - cQEvVarN0 * COS(2.0*PiN0 * (sTimeN0 + TenDaysN0 - cTimeLagN0) / DaysInYearN0);
aQEvN0 = IF (10 *uTmEpiN0 /cHeatN0) LE NearZeroN0 THEN 16 * 2*ufDayN0 * 1 / 30 * POW ( NearZeroN0 , (cAlphaN0) ) ELSE 16 * 2*ufDayN0 * 1 / 30 * POW ( 10 *uTmEpiN0 /cHeatN0 , (cAlphaN0) ) ENDIF;
uQEvN0 = IF (FALSE EQ InclSeasonN0) THEN cQEvAveN0 ELSEIF (ReadQEvN0 EQ TRUE) THEN mQEvN0 ELSEIF (calcQEvN0 EQ TRUE ) THEN aQEvN0 ELSE uQEvSinusN0 ENDIF;
uDepthDifMeasN0 = IF ( ReadDepthWN0 EQ TRUE ) THEN mDepthWN0 - uDepthWN0 ELSE 0.0 ENDIF;
uQInCorN0 = IF (uDepthDifMeasN0 GE 0) THEN uDepthDifMeasN0 * cMaxWOutN0 * mmPermN0 ELSE 0.0 ENDIF;
uQOutCorN0 = IF (uDepthDifMeasN0 LT 0) THEN -1 * uDepthDifMeasN0 * cMaxWOutN0 * mmPermN0 ELSE 0.0 ENDIF;
uQInEpiN0 = IF ((ReadQInN0 EQ TRUE) OR (ReadTranFracN0 EQ TRUE)) THEN mQInEpiN0 + uQInCorN0 ELSEIF (UseSeasonLoadN0 EQ TRUE) THEN uQInSeasonN0 + uQInCorN0 ELSE cQInEpiN0 + uQInCorN0 ENDIF;
uQInHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF ((ReadQInN0 EQ TRUE) OR (ReadTranFracN0 EQ TRUE)) THEN mQInHypN0 ELSE 0.0 ENDIF;
aQInTotN0 = uQInEpiN0 + uQInHypN0;
uQPrecN0 = IF (ReadQPrecN0 EQ TRUE) THEN mQPrecN0 ELSE 0 ENDIF;
uQInSeepN0 = IF (ReadQGroundN0 EQ TRUE) THEN mQInSeepN0 ELSE cQInSeepN0 ENDIF;
uQOutInfN0 = IF (ReadQGroundN0 EQ TRUE) THEN mQOutInfN0 ELSE cQOutInfN0 ENDIF;
uQOutPotN0 = uQPrecN0 + uQInEpiN0 - uQInCorN0 + uQInHypN0 + uQInSeepN0 - uQEvN0 - uQOutCorN0 - uQOutInfN0;
aMaxQOutEpiN0 = IF ( uDepthWEpiN0 LE cMinDepthHypEpiN0 ) THEN 0.0 ELSE uDepthWEpiN0 * mmPermN0 * cMaxWOutN0 ENDIF;
aMaxQOutHypN0 = IF (aInclStratN0 EQ TRUE) AND ( uDepthWHypN0 GT cMinDepthHypEpiN0 ) THEN (uDepthWHypN0 - cMinDepthHypEpiN0) * mmPermN0 * cMaxWOutN0 ELSE 0.0 ENDIF;
uQOutEpiN0 = IF (ReadQOutN0 EQ TRUE) THEN MIN(mQOutEpiN0, aMaxQOutEpiN0) ELSE MIN(aMaxQOutEpiN0, MAX(0.0, uQOutPotN0)) ENDIF;
uQOutHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadQOutN0 EQ TRUE) THEN MIN(mQOutHypN0, aMaxQOutHypN0) ELSE MIN(aMaxQOutHypN0, MAX(0.0, (uQOutPotN0 - uQOutEpiN0))) ENDIF;
ukOutEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uQOutEpiN0 / mmPermN0 / uDepthWEpiN0 ENDIF;
ukOutHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uQOutHypN0 / mmPermN0 / uDepthWHypN0 ENDIF;
uTauWatEpiN0 = IF (aInclStratN0 EQ FALSE) THEN 1.0 / ((uQInEpiN0 + uQPrecN0 + uQInSeepN0) / mmPermN0 / uDepthWEpiN0 +NearZeroN0) ELSE 1.0 / (( uQInEpiN0 + uQPrecN0 ) / mmPermN0 / uDepthWEpiN0 +NearZeroN0) ENDIF;
uTauWatHypN0 = IF (aInclStratN0 EQ FALSE )THEN -9999 ELSE 1.0 / ((uQInHypN0 + uQInSeepN0 ) / mmPermN0 / uDepthWHypN0 +NearZeroN0) ENDIF;
uTauWatN0 = 1.0 / ((uQPrecN0 + uQInEpiN0 + uQInHypN0 + uQInSeepN0 ) / mmPermN0 / uDepthWN0 +NearZeroN0);
uTauSubstHypN0 = 1.0 / (ukOutHypN0+NearZeroN0);
uFiJvMortHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiJvMortHypN0 ELSE 0.0 ENDIF;
uFiJvEgesHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiJvEgesHypN0 ELSE 0.0 ENDIF;
uFiJvExcrHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiJvExcrHypN0 ELSE 0.0 ENDIF;
uFiAdMortHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiAdMortHypN0 ELSE 0.0 ENDIF;
uFiAdEgesHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiAdEgesHypN0 ELSE 0.0 ENDIF;
uFiAdExcrHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fFiAdExcrHypN0 ELSE 0.0 ENDIF;
uPiscMortHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fPiscMortHypN0 ELSE 0.0 ENDIF;
uPiscEgesHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fPiscEgesHypN0 ELSE 0.0 ENDIF;
uPiscExcrHypN0 = IF (aInclStratN0 EQ TRUE ) THEN fPiscExcrHypN0 ELSE 0.0 ENDIF;
vTranDepthWN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN (uQInEpiN0 + uQInHypN0 + uQPrecN0 + uQInSeepN0 - uQEvN0 - uQOutInfN0 - uQOutHypN0 - uQOutEpiN0 - uQOutCorN0) / mmPermN0 ELSE ((uQInEpiN0 + uQInHypN0 + uQPrecN0 + uQInSeepN0 - uQEvN0 - uQOutInfN0 - uQOutHypN0 - uQOutEpiN0 - uQOutCorN0) / mmPermN0) / (1.0 + fMarshN0) ENDIF;
vTranHypEpiWN0 = IF (InclStratN0 EQ FALSE) THEN 0.0 ELSEIF ( uDepthWN0 -uDepthMixMeasN0 LT cMinDepthHypEpiN0 ) THEN ( uDepthWN0 - cMinDepthHypEpiN0 -uDepthWEpiN0 ) * kExchWN0 ELSEIF ( uDepthMixMeasN0 LT cMinDepthHypEpiN0 ) THEN ( cMinDepthHypEpiN0 -uDepthWEpiN0 ) * kExchWN0 ELSE ( uDepthMixMeasN0 -uDepthWEpiN0 ) * kExchWN0 ENDIF;
vDeltaWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0 ) THEN (uQInHypN0 + uQInSeepN0 - uQOutInfN0 - uQOutHypN0) / mmPermN0 ELSE (uQInHypN0 + uQInSeepN0 - uQOutInfN0 - uQOutHypN0) / mmPermN0 / (1.0 + fMarshN0 ) ENDIF;
vDeltaWEpiN0 = IF (aInclStratN0 EQ FALSE) AND (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0 ) THEN (uQInEpiN0 + uQPrecN0 + uQInSeepN0 - uQEvN0 - uQOutEpiN0 - uQOutInfN0 - uQOutCorN0) / mmPermN0 ELSEIF (aInclStratN0 EQ TRUE) AND (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0 ) THEN (uQInEpiN0 + uQPrecN0 - uQEvN0 - uQOutEpiN0 - uQOutCorN0) / mmPermN0 ELSEIF (aInclStratN0 EQ FALSE) AND (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0 ) THEN (uQInEpiN0 + uQPrecN0 + uQInSeepN0 - uQEvN0 - uQOutEpiN0 - uQOutInfN0 - uQOutCorN0) / mmPermN0 / (1.0 + fMarshN0 ) ELSE (uQInEpiN0 + uQPrecN0 - uQEvN0 - uQOutEpiN0 - uQOutCorN0) / mmPermN0 / (1.0 + fMarshN0 ) ENDIF;
afVolHypEpiN0= IF (aInclStratN0 EQ TRUE AND uDepthWHypN0 GT NearZeroN0) THEN  uDepthWHypN0 / uDepthWEpiN0 ELSE 0.0 ENDIF;
wDAdvIMWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDIMWHypN0 ELSE vTranHypEpiWN0 * oDIMWEpiN0 ENDIF;
wPAdvPO4WN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPO4WHypN0 ELSE vTranHypEpiWN0 * oPO4WEpiN0 ENDIF;
wPAdvAIMWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPAIMWHypN0 ELSE vTranHypEpiWN0 * oPAIMWEpiN0 ENDIF;
wNAdvNH4WN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNH4WHypN0 ELSE vTranHypEpiWN0 * oNH4WEpiN0 ENDIF;
wNAdvNO3WN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNO3WHypN0 ELSE vTranHypEpiWN0 * oNO3WEpiN0 ENDIF;
wSiAdvSiO2WN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oSiO2WHypN0 ELSE vTranHypEpiWN0 * oSiO2WEpiN0 ENDIF;
wO2AdvWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oO2WHypN0 ELSE vTranHypEpiWN0 * oO2WEpiN0 ENDIF;
wDAdvDetWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDDetWHypN0 ELSE vTranHypEpiWN0 * oDDetWEpiN0 ENDIF;
wPAdvDetWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPDetWHypN0 ELSE vTranHypEpiWN0 * oPDetWEpiN0 ENDIF;
wNAdvDetWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNDetWHypN0 ELSE vTranHypEpiWN0 * oNDetWEpiN0 ENDIF;
wSiAdvDetWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oSiDetWHypN0 ELSE vTranHypEpiWN0 * oSiDetWEpiN0 ENDIF;
wDAdvDiatWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDDiatWHypN0 ELSE vTranHypEpiWN0 * oDDiatWEpiN0 ENDIF;
wPAdvDiatWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPDiatWHypN0 ELSE vTranHypEpiWN0 * oPDiatWEpiN0 ENDIF;
wNAdvDiatWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNDiatWHypN0 ELSE vTranHypEpiWN0 * oNDiatWEpiN0 ENDIF;
wSiAdvDiatWN0 = vTranHypEpiWN0 * cSiDDiatN0;
wDAdvGrenWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDGrenWHypN0 ELSE vTranHypEpiWN0 * oDGrenWEpiN0 ENDIF;
wPAdvGrenWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPGrenWHypN0 ELSE vTranHypEpiWN0 * oPGrenWEpiN0 ENDIF;
wNAdvGrenWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNGrenWHypN0 ELSE vTranHypEpiWN0 * oNGrenWEpiN0 ENDIF;
wDAdvBlueWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDBlueWHypN0 ELSE vTranHypEpiWN0 * oDBlueWEpiN0 ENDIF;
wPAdvBlueWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPBlueWHypN0 ELSE vTranHypEpiWN0 * oPBlueWEpiN0 ENDIF;
wNAdvBlueWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNBlueWHypN0 ELSE vTranHypEpiWN0 * oNBlueWEpiN0 ENDIF;
wDAdvZooWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oDZooHypN0 ELSE vTranHypEpiWN0 * oDZooEpiN0 ENDIF;
wPAdvZooWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oPZooHypN0 ELSE vTranHypEpiWN0 * oPZooEpiN0 ENDIF;
wNAdvZooWN0 = IF ( vTranHypEpiWN0 GT 0.0) THEN vTranHypEpiWN0 * oNZooHypN0 ELSE vTranHypEpiWN0 * oNZooEpiN0 ENDIF;
wDAdvIMWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDIMWEpiN0 ELSE vTranDepthWN0 *  oDIMWMN0 ENDIF;
wPAdvPO4WMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPO4WEpiN0 ELSE vTranDepthWN0 *  oPO4WMN0 ENDIF;
wPAdvAIMWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPAIMWEpiN0 ELSE vTranDepthWN0 *  oPAIMWMN0 ENDIF;
wNAdvNH4WMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNH4WEpiN0 ELSE vTranDepthWN0 *  oNH4WMN0 ENDIF;
wNAdvNO3WMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNO3WEpiN0 ELSE vTranDepthWN0 *  oNO3WMN0 ENDIF;
wSiAdvSiO2WMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oSiO2WEpiN0 ELSE vTranDepthWN0 *  oSiO2WMN0 ENDIF;
wO2AdvWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oO2WEpiN0 ELSE vTranDepthWN0 *  oO2WMN0 ENDIF;
wDAdvDetWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDDetWEpiN0 ELSE vTranDepthWN0 *  oDDetWMN0 ENDIF;
wPAdvDetWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPDetWEpiN0 ELSE vTranDepthWN0 *  oPDetWMN0 ENDIF;
wNAdvDetWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNDetWEpiN0 ELSE vTranDepthWN0 *  oNDetWMN0 ENDIF;
wSiAdvDetWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oSiDetWEpiN0 ELSE vTranDepthWN0 *  oSiDetWMN0 ENDIF;
wDAdvDiatWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDDiatWEpiN0 ELSE vTranDepthWN0 *  oDDiatWMN0 ENDIF;
wPAdvDiatWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPDiatWEpiN0 ELSE vTranDepthWN0 *  oPDiatWMN0 ENDIF;
wNAdvDiatWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNDiatWEpiN0 ELSE vTranDepthWN0 *  oNDiatWMN0 ENDIF;
wDAdvGrenWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDGrenWEpiN0 ELSE vTranDepthWN0 *  oDGrenWMN0 ENDIF;
wPAdvGrenWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPGrenWEpiN0 ELSE vTranDepthWN0 *  oPGrenWMN0 ENDIF;
wNAdvGrenWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNGrenWEpiN0 ELSE vTranDepthWN0 *  oNGrenWMN0 ENDIF;
wDAdvBlueWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDBlueWEpiN0 ELSE vTranDepthWN0 *  oDBlueWMN0 ENDIF;
wPAdvBlueWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPBlueWEpiN0 ELSE vTranDepthWN0 *  oPBlueWMN0 ENDIF;
wNAdvBlueWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNBlueWEpiN0 ELSE vTranDepthWN0 *  oNBlueWMN0 ENDIF;
wDAdvZooWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oDZooEpiN0 ELSE vTranDepthWN0 *  oDZooMN0 ENDIF;
wPAdvZooWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oPZooEpiN0 ELSE vTranDepthWN0 *  oPZooMN0 ENDIF;
wNAdvZooWMN0= IF (InclMarshN0 EQ FALSE OR fMarshN0 LT NearZeroN0) THEN 0.0 ELSEIF ( vTranDepthWN0 GT 0.0) THEN vTranDepthWN0 * oNZooEpiN0 ELSE vTranDepthWN0 *  oNZooMN0 ENDIF;
uExchMaxWN0 =   IF ( aInclStratN0 EQ TRUE) THEN kExchMaxWN0 /( aStratN0* fMetaN0 * uDepthWN0 + cDepthMetaMinN0 ) ELSE 0.0 ENDIF;
akExchWHypN0= IF (aInclStratN0 EQ TRUE AND uDepthWHypN0 GT NearZeroN0) THEN  ( uExchMaxWN0 ) / uDepthWHypN0 ELSE 0.0 ENDIF;
akExchWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 * afVolHypEpiN0 ELSE 0.0 ENDIF;
wDExchIMWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDIMWHypN0 - oDIMWEpiN0) ELSE 0.0 ENDIF;
wPExchPO4WHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPO4WHypN0 - oPO4WEpiN0) ELSE 0.0 ENDIF;
wPExchAIMWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPAIMWHypN0 - oPAIMWEpiN0) ELSE 0.0 ENDIF;
wNExchNH4WHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNH4WHypN0 - oNH4WEpiN0) ELSE 0.0 ENDIF;
wNExchNO3WHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNO3WHypN0 - oNO3WEpiN0) ELSE 0.0 ENDIF;
wSiExchSiO2WHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oSiO2WHypN0 - oSiO2WEpiN0) ELSE 0.0 ENDIF;
wO2ExchWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oO2WHypN0 - oO2WEpiN0) ELSE 0.0 ENDIF;
wDExchDetWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDDetWHypN0 - oDDetWEpiN0) ELSE 0.0 ENDIF;
wPExchDetWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPDetWHypN0 - oPDetWEpiN0) ELSE 0.0 ENDIF;
wNExchDetWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNDetWHypN0 - oNDetWEpiN0) ELSE 0.0 ENDIF;
wSiExchDetWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oSiDetWHypN0 - oSiDetWEpiN0) ELSE 0.0 ENDIF;
wDExchDiatWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDDiatWHypN0 - oDDiatWEpiN0) ELSE 0.0 ENDIF;
wPExchDiatWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPDiatWHypN0 - oPDiatWEpiN0) ELSE 0.0 ENDIF;
wNExchDiatWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNDiatWHypN0 - oNDiatWEpiN0) ELSE 0.0 ENDIF;
wSiExchDiatWHypN0= IF (aInclStratN0 EQ TRUE ) THEN cSiDDiatN0 * wDExchDiatWHypN0 ELSE 0.0 ENDIF;
wDExchGrenWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDGrenWHypN0 - oDGrenWEpiN0) ELSE 0.0 ENDIF;
wPExchGrenWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPGrenWHypN0 - oPGrenWEpiN0) ELSE 0.0 ENDIF;
wNExchGrenWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNGrenWHypN0 - oNGrenWEpiN0) ELSE 0.0 ENDIF;
wDExchBlueWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDBlueWHypN0 - oDBlueWEpiN0) ELSE 0.0 ENDIF;
wPExchBlueWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPBlueWHypN0 - oPBlueWEpiN0) ELSE 0.0 ENDIF;
wNExchBlueWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNBlueWHypN0 - oNBlueWEpiN0) ELSE 0.0 ENDIF;
wDExchZooWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oDZooHypN0 - oDZooEpiN0) ELSE 0.0 ENDIF;
wPExchZooWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oPZooHypN0 - oPZooEpiN0) ELSE 0.0 ENDIF;
wNExchZooWHypN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWHypN0 *(oNZooHypN0 - oNZooEpiN0) ELSE 0.0 ENDIF;
wDExchIMWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDIMWHypN0 - oDIMWEpiN0) ELSE 0.0 ENDIF;
wPExchPO4WEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPO4WHypN0 - oPO4WEpiN0) ELSE 0.0 ENDIF;
wPExchAIMWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPAIMWHypN0 - oPAIMWEpiN0) ELSE 0.0 ENDIF;
wNExchNH4WEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNH4WHypN0 - oNH4WEpiN0) ELSE 0.0 ENDIF;
wNExchNO3WEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNO3WHypN0 - oNO3WEpiN0) ELSE 0.0 ENDIF;
wSiExchSiO2WEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oSiO2WHypN0 - oSiO2WEpiN0) ELSE 0.0 ENDIF;
wO2ExchWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oO2WHypN0 - oO2WEpiN0) ELSE 0.0 ENDIF;
wDExchDetWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDDetWHypN0 - oDDetWEpiN0) ELSE 0.0 ENDIF;
wPExchDetWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPDetWHypN0 - oPDetWEpiN0) ELSE 0.0 ENDIF;
wNExchDetWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNDetWHypN0 - oNDetWEpiN0) ELSE 0.0 ENDIF;
wSiExchDetWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oSiDetWHypN0 - oSiDetWEpiN0) ELSE 0.0 ENDIF;
wDExchDiatWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDDiatWHypN0 - oDDiatWEpiN0) ELSE 0.0 ENDIF;
wPExchDiatWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPDiatWHypN0 - oPDiatWEpiN0) ELSE 0.0 ENDIF;
wNExchDiatWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNDiatWHypN0 - oNDiatWEpiN0) ELSE 0.0 ENDIF;
wSiExchDiatWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN cSiDDiatN0 * wDExchDiatWEpiN0 ELSE 0.0 ENDIF;
wDExchGrenWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDGrenWHypN0 - oDGrenWEpiN0) ELSE 0.0 ENDIF;
wPExchGrenWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPGrenWHypN0 - oPGrenWEpiN0) ELSE 0.0 ENDIF;
wNExchGrenWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNGrenWHypN0 - oNGrenWEpiN0) ELSE 0.0 ENDIF;
wDExchBlueWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDBlueWHypN0 - oDBlueWEpiN0) ELSE 0.0 ENDIF;
wPExchBlueWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPBlueWHypN0 - oPBlueWEpiN0) ELSE 0.0 ENDIF;
wNExchBlueWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNBlueWHypN0 - oNBlueWEpiN0) ELSE 0.0 ENDIF;
wDExchZooWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oDZooHypN0 - oDZooEpiN0) ELSE 0.0 ENDIF;
wPExchZooWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oPZooHypN0 - oPZooEpiN0) ELSE 0.0 ENDIF;
wNExchZooWEpiN0= IF (aInclStratN0 EQ TRUE ) THEN akExchWEpiN0 *(oNZooHypN0 - oNZooEpiN0) ELSE 0.0 ENDIF;
akExchMHypN0 = 0.0;
akExchLHypN0 = 0.0;
oDPhytWHypN0 = oDDiatWHypN0 + oDGrenWHypN0 + oDBlueWHypN0;
oPPhytWHypN0 = oPDiatWHypN0 + oPGrenWHypN0 + oPBlueWHypN0;
oNPhytWHypN0 = oNDiatWHypN0 + oNGrenWHypN0 + oNBlueWHypN0;
aDPhytSN0 = aDDiatSN0 + aDGrenSN0 + aDBlueSN0 ;
aPPhytSN0 = aPDiatSN0 + aPGrenSN0 + aPBlueSN0 ;
aNPhytSN0 = aNDiatSN0 + aNGrenSN0 + aNBlueSN0;
oDPhytWEpiN0 = oDDiatWEpiN0 + oDGrenWEpiN0 + oDBlueWEpiN0;
oDOMWEpiN0 = oDDetWEpiN0 + oDPhytWEpiN0;
oDOMWHypN0 = oDDetWHypN0 + oDPhytWHypN0;
oTDOMWN0 = oDOMWEpiN0 + oDOMWHypN0;
oDSestWHypN0 = oDOMWHypN0 + oDIMWHypN0;
oPOMWHypN0 = oPPhytWHypN0 + oPDetWHypN0;
oPSestWHypN0 = oPPhytWHypN0 + oPDetWHypN0 + oPAIMWHypN0;
oPInorgWHypN0 = oPO4WHypN0 + oPAIMWHypN0;
oPTotWHypN0 = oPSestWHypN0 + oPO4WHypN0;
oNDissWEpiN0 = oNO3WEpiN0 + oNH4WEpiN0;
oNDissWHypN0 = oNO3WHypN0 + oNH4WHypN0;
oNOMWHypN0 = oNPhytWHypN0 + oNDetWHypN0;
oNSestWHypN0 = oNOMWHypN0;
oNkjWHypN0 = oNSestWHypN0 + oNH4WHypN0;
oNTotWHypN0 = oNkjWHypN0 + oNO3WHypN0;
bPorSN0 = (1.0 - fDTotS0N0) * (fDOrgS0N0 * cRhoOMN0 + (1 - fDOrgS0N0) * cRhoIMN0) / cRhoWatN0 / ( fDTotS0N0 + (1.0 - fDTotS0N0) * (fDOrgS0N0 * cRhoOMN0 + (1 - fDOrgS0N0) * cRhoIMN0) / cRhoWatN0 );
bPorCorSN0 = IF POW(bPorSN0 , (bPorSN0 + 1.0)) LE NearZeroN0 THEN 1 ELSE POW(bPorSN0 , (bPorSN0 + 1.0)) ENDIF;
aDTotSN0 = aDIMSN0 + aDHumSN0 + aDDetSN0;
aRhoTotSN0 = aDTotSN0 / cDepthSN0;
aRhoSolidSN0 = (aDIMSN0 * cRhoIMN0 + (aDHumSN0 + aDDetSN0) * cRhoOMN0) / aDTotSN0;
afDTotSN0 = 1.0 / (1.0 + bPorSN0/(1.0-bPorSN0) * cRhoWatN0 / aRhoSolidSN0);
afDOrgSN0 = (aDHumSN0 + aDDetSN0) / aDTotSN0;
afDetSN0 = aDDetSN0 / (aDHumSN0 + aDDetSN0);
afDetTotSN0 = aDDetSN0 / (aDIMSN0 + aDHumSN0 + aDDetSN0);
aPInorgSN0 = aPO4SN0 + aPAIMSN0;
aPTotAvailSN0 = aPDetSN0 + aPInorgSN0 + aPPhytSN0;
aPTotSN0 = aPTotAvailSN0 + aPHumSN0;
afPInorgSN0 = aPInorgSN0 / aDTotSN0;
afPTotSN0 = aPTotSN0 / aDTotSN0;
afPO4SN0 = aPO4SN0 / (aPTotAvailSN0 + NearZeroN0);
oPO4SN0 = aPO4SN0 / cDepthSN0 / bPorSN0;
aNDissSN0 = aNH4SN0 + aNO3SN0;
aNkjAvailSN0 = aNDetSN0 + aNPhytSN0 + aNH4SN0;
aNkjSN0 = aNkjAvailSN0 + aNHumSN0;
aNTotAvailSN0 = aNkjAvailSN0 + aNO3SN0;
aNTotSN0 = aNkjSN0 + aNO3SN0;
afNInorgSN0 = aNDissSN0 / aDTotSN0;
afNTotSN0 = aNTotSN0 / aDTotSN0;
oNO3SN0 = aNO3SN0 / cDepthSN0 / bPorSN0;
oNH4SN0 = aNH4SN0 / cDepthSN0 / bPorSN0;
oNDissSN0 = aNDissSN0 / cDepthSN0 / bPorSN0;
rPDIMWHypN0 = oPAIMWHypN0 / oDIMWHypN0;
rPDIMSN0 = aPAIMSN0 / aDIMSN0;
rPDDetWHypN0 = oPDetWHypN0 / (oDDetWHypN0+NearZeroN0);
rNDDetWHypN0 = oNDetWHypN0 / (oDDetWHypN0+NearZeroN0);
rSiDDetWHypN0 = oSiDetWHypN0 / (oDDetWHypN0+NearZeroN0);
rPDHumSN0 = aPHumSN0 / (aDHumSN0+NearZeroN0);
rNDHumSN0 = aNHumSN0 / (aDHumSN0+NearZeroN0);
rPDDetSN0 = aPDetSN0 / (aDDetSN0+NearZeroN0);
rNDDetSN0 = aNDetSN0 / (aDDetSN0+NearZeroN0);
rSiDDetSN0 = aSiDetSN0 / (aDDetSN0+NearZeroN0);
oDPhytWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oDDiatWMN0 + oDGrenWMN0 + oDBlueWMN0 ELSE 0.0 ENDIF;
oPPhytWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPDiatWMN0 + oPGrenWMN0 + oPBlueWMN0 ELSE 0.0 ENDIF;
oNPhytWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNDiatWMN0 + oNGrenWMN0 + oNBlueWMN0 ELSE 0.0 ENDIF;
oSiDiatWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cSiDDiatN0 * oDDiatWMN0 ELSE 0.0 ENDIF;
oDOMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oDDetWMN0 + oDPhytWMN0 ELSE 0.0 ENDIF;
oDSestWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oDOMWMN0 + oDIMWMN0 ELSE 0.0 ENDIF;
oPOMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPPhytWMN0 + oPDetWMN0 ELSE 0.0 ENDIF;
oPSestWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPPhytWMN0 + oPDetWMN0 + oPAIMWMN0 ELSE 0.0 ENDIF;
oPInorgWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPO4WMN0 + oPAIMWMN0 ELSE 0.0 ENDIF;
oPTotWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPSestWMN0 + oPO4WMN0 ELSE 0.0 ENDIF;
oNDissWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNO3WMN0 + oNH4WMN0 ELSE 0.0 ENDIF;
oNOMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNPhytWMN0 + oNDetWMN0 ELSE 0.0 ENDIF;
oNSestWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNOMWMN0 ELSE 0.0 ENDIF;
oNkjWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNSestWMN0 + oNH4WMN0 ELSE 0.0 ENDIF;
oNTotWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNkjWMN0 + oNO3WMN0 ELSE 0.0 ENDIF;
bPorSMN0 = (1.0 - fDTotSM0N0) * (fDOrgSM0N0 * cRhoOMN0 +(1 - fDOrgSM0N0) * cRhoIMN0) / cRhoWatN0 /(fDTotSM0N0 + (1.0 - fDTotSM0N0) * (fDOrgSM0N0 * cRhoOMN0 +(1 - fDOrgSM0N0) * cRhoIMN0) / cRhoWatN0);
bPorCorSMN0 = IF POW ( bPorSMN0 , (bPorSMN0 + 1.0)) LE NearZeroN0 THEN 1 ELSE POW ( bPorSMN0 , (bPorSMN0 + 1.0)) ENDIF;
aDTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDIMSMN0 + aDHumSMN0 + aDDetSMN0 ELSE 0.0 ENDIF;
aRhoTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDTotSMN0 / cDepthSMN0 ELSE 0.0 ENDIF;
aRhoSolidSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (aDIMSMN0 * cRhoIMN0 +(aDHumSMN0 + aDDetSMN0) * cRhoOMN0) / aDTotSMN0 ELSE 0.0 ENDIF;
afDTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN 1.0 /(1.0 + bPorSMN0/(1.0-bPorSMN0) * cRhoWatN0 / aRhoSolidSMN0) ELSE 0.0 ENDIF;
afDOrgSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (aDHumSMN0 + aDDetSMN0) / aDTotSMN0 ELSE 0.0 ENDIF;
afDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDDetSMN0 /(aDHumSMN0 + aDDetSMN0) ELSE 0.0 ENDIF;
afDetTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDDetSMN0 /(aDIMSMN0 + aDHumSMN0 + aDDetSMN0) ELSE 0.0 ENDIF;
aPInorgSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPO4SMN0 + aPAIMSMN0 ELSE 0.0 ENDIF;
aPTotAvailSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPDetSMN0 + aPInorgSMN0 ELSE 0.0 ENDIF;
aPTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPTotAvailSMN0 + aPHumSMN0 ELSE 0.0 ENDIF;
afPInorgSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPInorgSMN0 / aDTotSMN0 ELSE 0.0 ENDIF;
afPTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPTotSMN0 / aDTotSMN0 ELSE 0.0 ENDIF;
afPO4SMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPO4SMN0 /(aPTotAvailSMN0 + NearZeroN0) ELSE 0.0 ENDIF;
oPO4SMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPO4SMN0 / cDepthSMN0 / bPorSMN0 ELSE 0.0 ENDIF;
aNDissSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNH4SMN0 + aNO3SMN0 ELSE 0.0 ENDIF;
aNkjAvailSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNDetSMN0 + aNH4SMN0 ELSE 0.0 ENDIF;
aNkjSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNkjAvailSMN0 + aNHumSMN0 ELSE 0.0 ENDIF;
aNTotAvailSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNkjAvailSMN0 + aNO3SMN0 ELSE 0.0 ENDIF;
aNTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNkjSMN0 + aNO3SMN0 ELSE 0.0 ENDIF;
afNInorgSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNDissSMN0 / aDTotSMN0 ELSE 0.0 ENDIF;
afNTotSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNTotSMN0 / aDTotSMN0 ELSE 0.0 ENDIF;
oNO3SMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNO3SMN0 / cDepthSMN0 / bPorSMN0 ELSE 0.0 ENDIF;
oNH4SMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNH4SMN0 / cDepthSMN0 / bPorSMN0 ELSE 0.0 ENDIF;
oNDissSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNDissSMN0 / cDepthSMN0 / bPorSMN0 ELSE 0.0 ENDIF;
rPDIMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPAIMWMN0 / oDIMWMN0 ELSE 0.0 ENDIF;
rPDIMSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPAIMSMN0 / aDIMSMN0 ELSE 0.0 ENDIF;
rPDDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oPDetWMN0 /(oDDetWMN0+NearZeroN0) ELSE 0.0 ENDIF;
rNDDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNDetWMN0 /(oDDetWMN0+NearZeroN0) ELSE 0.0 ENDIF;
rSiDDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oSiDetWMN0 /(oDDetWMN0+NearZeroN0) ELSE 0.0 ENDIF;
rPDHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPHumSMN0 /(aDHumSMN0+NearZeroN0) ELSE 0.0 ENDIF;
rNDHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNHumSMN0 /(aDHumSMN0+NearZeroN0) ELSE 0.0 ENDIF;
rPDDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPDetSMN0 /(aDDetSMN0+NearZeroN0) ELSE 0.0 ENDIF;
rNDDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNDetSMN0 /(aDDetSMN0+NearZeroN0) ELSE 0.0 ENDIF;
rSiDDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aSiDetSMN0 /(aDDetSMN0+NearZeroN0) ELSE 0.0 ENDIF;
aDTotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ((oDIMWMN0 + oDDetWMN0 + oDPhytWMN0 + oDZooMN0) * uDepthWMN0 + aDIMSMN0 + aDHumSMN0 + aDDetSMN0 + aDShootPhraN0 + aDRootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
aPTotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ((oPO4WMN0 + oPDetWMN0 + oPAIMWMN0 + oPPhytWMN0 + oPZooMN0) * uDepthWMN0 + aPO4SMN0 + aPHumSMN0 + aPDetSMN0 + aPAIMSMN0 + aPShootPhraN0 + aPRootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
aNTotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ((oNH4WMN0 + oNO3WMN0 + oNDetWMN0 + oNPhytWMN0 + oNZooMN0) * uDepthWMN0 + aNH4SMN0 + aNO3SMN0 + aNHumSMN0 + aNDetSMN0 + aNShootPhraN0 + aNRootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
aSiTotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ((oSiO2WMN0 + oSiDetWMN0 + oSiDiatWMN0) * uDepthWMN0 + aSiDetSMN0) * fMarshN0 ELSE 0.0 ENDIF;
aO2TotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ((oO2WMN0) * uDepthWMN0 ) * fMarshN0 ELSE 0.0 ENDIF;
uPLoadSeasonEpiN0 = IF (FALSE EQ UseSeasonLoadN0) THEN 0.0 ELSEIF (DayN0 LT cDayApril1N0 - 0.5*cLengChangeN0) THEN cPLoadWinN0 ELSEIF (DayN0 LT cDayApril1N0 + 0.5*cLengChangeN0) THEN 0.5*(cPLoadWinN0 + cPLoadSumN0) + 0.5*(cPLoadWinN0 - cPLoadSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayApril1N0)) ELSEIF (DayN0 LT cDayOct1N0 - 0.5*cLengChangeN0) THEN cPLoadSumN0 ELSEIF (DayN0 LT cDayOct1N0 + 0.5*cLengChangeN0) THEN 0.5*(cPLoadWinN0 + cPLoadSumN0) - 0.5*(cPLoadWinN0 - cPLoadSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayOct1N0)) ELSE cPLoadWinN0 ENDIF;
uPLoadEpiN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mPLoadPO4EpiN0 + mPLoadAIMEpiN0 + mPLoadDiatEpiN0 + mPLoadGrenEpiN0 + mPLoadBlueEpiN0 + mPLoadDetEpiN0) ELSEIF (ReadPLoadN0 EQ TRUE AND ReadNutFracN0 EQ TRUE) THEN mPLoadPO4EpiN0 + mPLoadOrgEpiN0 ELSEIF (ReadPLoadN0 EQ TRUE AND FALSE EQ ReadNutFracN0) THEN mPLoadEpiN0 * mPLoadEpiMultN0 ELSEIF (UsePulseLoadN0 EQ TRUE) THEN 0.0 ELSEIF (UseSeasonLoadN0 EQ TRUE) THEN uPLoadSeasonEpiN0 ELSE cPLoadN0 ENDIF;
uPLoadPO4EpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadPO4EpiN0 ELSEIF (ReadPLoadN0 EQ FALSE) THEN fPO4InN0 * uPLoadEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN mPLoadPO4EpiN0 ELSE fPO4InN0 * uPLoadEpiN0 ENDIF;
uPLoadOrgEpiN0 = IF (FALSE EQ ReadPLoadN0) THEN (1.0 - fPO4InN0) * uPLoadEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN mPLoadOrgEpiN0 ELSE (1.0 - fPO4InN0) * uPLoadEpiN0 ENDIF;
uPLoadPhytTotEpiN0 = IF (FALSE EQ InclSeasonN0) THEN (((fPhytInSumN0 + fPhytInWinN0)/2)*uPLoadOrgEpiN0) ELSEIF (ReadPLoadPhytN0 EQ TRUE) THEN mPLoadPhytTotEpiN0 ELSE ((fPhytInSumN0+fPhytInWinN0)/2.0 - (fPhytInSumN0-fPhytInWinN0)/2.0 * COS(2.0*PiN0 * (sTimeN0 + TenDaysN0 - cTimeLagN0) / DaysInYearN0)) * uPLoadOrgEpiN0 ENDIF;
uPLoadDetEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadDetEpiN0 ELSE uPLoadOrgEpiN0 - uPLoadPhytTotEpiN0 ENDIF;
uPLoadAIMEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadAIMEpiN0 ELSE 0.0 ENDIF;
uPBackLoadHypN0 = IF (FALSE EQ aInclStratN0) THEN 0.0 ELSE cPBackLoadN0 ENDIF;
uPTotInEpiN0 = uPLoadEpiN0 / (uQInEpiN0 / mmPermN0 + NearZeroN0);
uNLoadSeasonEpiN0 = IF (FALSE EQ UseSeasonLoadN0) THEN 0.0 ELSEIF (DayN0 LT cDayApril1N0 - 0.5*cLengChangeN0) THEN cNLoadWinN0 ELSEIF (DayN0 LT cDayApril1N0 + 0.5*cLengChangeN0) THEN 0.5*(cNLoadWinN0 + cNLoadSumN0) + 0.5*(cNLoadWinN0 - cNLoadSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayApril1N0)) ELSEIF (DayN0 LT cDayOct1N0 - 0.5*cLengChangeN0) THEN cNLoadSumN0 ELSEIF (DayN0 LT cDayOct1N0 + 0.5*cLengChangeN0) THEN 0.5*(cNLoadWinN0 + cNLoadSumN0) - 0.5*(cNLoadWinN0 - cNLoadSumN0) * COS(PiN0/cLengChangeN0 * (DayN0 - cDayOct1N0)) ELSE cNLoadWinN0 ENDIF;
uNLoadPhytTotEpiN0 = IF (ReadNutFracN0 EQ FALSE) THEN (cNPPhytInN0 * uPLoadPhytTotEpiN0) ELSE  mNLoadPhytTotEpiN0 ENDIF ;
uNLoadEpiN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mNLoadNH4EpiN0 + mNLoadNO3EpiN0 + mNLoadGrenEpiN0 + mNLoadDiatEpiN0 + mNLoadBlueEpiN0 + mNLoadDetEpiN0) ELSEIF (ReadNLoadN0 EQ TRUE AND ReadNutFracN0 EQ TRUE) THEN mNLoadNH4EpiN0 + mNLoadNO3EpiN0 + mNLoadOrgEpiN0 ELSEIF (ReadNLoadN0 EQ TRUE AND ReadNutFracN0 EQ FALSE) THEN mNLoadEpiN0 ELSEIF (UsePulseLoadN0 EQ TRUE) THEN 0.0 ELSEIF (ReadPLoadN0 EQ TRUE) THEN cNPLoadMeasN0 * uPLoadEpiN0 ELSEIF (UseSeasonLoadN0 EQ TRUE) THEN uNLoadSeasonEpiN0 ELSE cNLoadN0 ENDIF;
uNLoadDetEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadDetEpiN0 ELSEIF (ReadNLoadN0 EQ FALSE ) THEN MIN(cNPDetInN0 * uPLoadDetEpiN0, uNLoadEpiN0 - uNLoadPhytTotEpiN0) ELSEIF (ReadNutFracN0 EQ TRUE) THEN mNLoadOrgEpiN0 - mNLoadPhytTotEpiN0 ELSE MIN(cNPDetInN0 * uPLoadDetEpiN0, uNLoadEpiN0 - uNLoadPhytTotEpiN0) ENDIF;
uNLoadOrgEpiN0 = IF (FALSE EQ ReadNLoadN0) THEN uNLoadPhytTotEpiN0 + uNLoadDetEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN mNLoadOrgEpiN0 ELSE uNLoadPhytTotEpiN0 + uNLoadDetEpiN0 ENDIF;
uNLoadDissEpiN0 = IF (FALSE EQ ReadNLoadN0) THEN uNLoadEpiN0 - uNLoadOrgEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN 0.0 ELSE uNLoadEpiN0 - uNLoadOrgEpiN0 ENDIF;
uNLoadNH4EpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadNH4EpiN0 ELSEIF (ReadNLoadN0 EQ FALSE) THEN fNH4DissInN0 * uNLoadDissEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN mNLoadNH4EpiN0 ELSE fNH4DissInN0 * uNLoadDissEpiN0 ENDIF;
uNLoadNO3EpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadNO3EpiN0 ELSEIF (ReadNLoadN0 EQ FALSE) THEN (1.0 - fNH4DissInN0) * uNLoadDissEpiN0 ELSEIF (ReadNutFracN0 EQ TRUE) THEN mNLoadNO3EpiN0 ELSE (1.0 - fNH4DissInN0) * uNLoadDissEpiN0 ENDIF;
uNBackLoadHypN0 = IF (FALSE EQ aInclStratN0) THEN 0.0 ELSE cNBackLoadN0 ENDIF;
uNTotInEpiN0 = uNLoadEpiN0 / (uQInEpiN0 / mmPermN0 + NearZeroN0);
uDLoadDetEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mDLoadDetEpiN0 ELSEIF (ReadDLoadDetN0 EQ TRUE) THEN mDLoadDetEpiN0 ELSE uNLoadDetEpiN0 / cNDDetInN0 ENDIF;
uDLoadPhytTotEpiN0 = uNLoadPhytTotEpiN0 / cNDPhytInN0;
uDLoadIMEpiN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadIMEpiN0 ELSEIF (ReadDLoadIMN0 EQ TRUE) THEN mDLoadIMEpiN0 ELSE cDIMInN0 * uQInEpiN0 / mmPermN0 ENDIF;
uDLoadEpiN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mDLoadIMEpiN0 + mDLoadDetEpiN0 + mDLoadDiatEpiN0 + mDLoadGrenEpiN0 + mDLoadBlueEpiN0) ELSE uDLoadIMEpiN0 + uDLoadDetEpiN0 + uDLoadPhytTotEpiN0 ENDIF;
uDLoadDiatEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mDLoadDiatEpiN0 ELSE fDiatPhytInN0 * uDLoadPhytTotEpiN0 ENDIF;
uPLoadDiatEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadDiatEpiN0 ELSE fDiatPhytInN0 * uPLoadPhytTotEpiN0 ENDIF;
uNLoadDiatEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadDiatEpiN0 ELSE fDiatPhytInN0 * uNLoadPhytTotEpiN0 ENDIF;
uDLoadGrenEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mDLoadGrenEpiN0 ELSE fGrenPhytInN0 * uDLoadPhytTotEpiN0 ENDIF;
uPLoadGrenEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadGrenEpiN0 ELSE fGrenPhytInN0 * uPLoadPhytTotEpiN0 ENDIF;
uNLoadGrenEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadGrenEpiN0 ELSE fGrenPhytInN0 * uNLoadPhytTotEpiN0 ENDIF;
uDLoadBlueEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mDLoadBlueEpiN0 ELSE fBluePhytInN0 * uDLoadPhytTotEpiN0 ENDIF;
uPLoadBlueEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadBlueEpiN0 ELSE fBluePhytInN0 * uPLoadPhytTotEpiN0 ENDIF;
uNLoadBlueEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadBlueEpiN0 ELSE fBluePhytInN0 * uNLoadPhytTotEpiN0 ENDIF;
uDLoadZooEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mDLoadZooEpiN0 ELSE cDZooInN0 * uQInEpiN0 / mmPermN0 ENDIF;
uPLoadZooEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mPLoadZooEpiN0 ELSE cDZooInN0 * cPDZooRefN0 * uQInEpiN0 / mmPermN0 ENDIF;
uNLoadZooEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mNLoadZooEpiN0 ELSE cDZooInN0 * cNDZooRefN0 * uQInEpiN0 / mmPermN0 ENDIF;
uSiLoadSiO2EpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mSiLoadSiO2EpiN0 ELSE cSiO2InN0 * uQInEpiN0 / mmPermN0 ENDIF;
uSiLoadDetEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mSiLoadDetEpiN0 ELSE cSiDDetInN0 * uDLoadDetEpiN0 ENDIF;
uSiLoadDiatEpiN0 = cSiDDiatN0 * uDLoadDiatEpiN0;
uSiLoadEpiN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2EpiN0 + uSiLoadDetEpiN0 + uSiLoadDiatEpiN0 ENDIF;
uDLoadBlueSurfN0= IF (ReadTranFracN0 EQ TRUE) THEN mDLoadBlueSurfN0 ELSE 0.0 ENDIF;
uPLoadBlueSurfN0= IF (ReadTranFracN0 EQ TRUE) THEN mPLoadBlueSurfN0 ELSE 0.0 ENDIF;
uNLoadBlueSurfN0= IF (ReadTranFracN0 EQ TRUE) THEN mNLoadBlueSurfN0 ELSE 0.0 ENDIF;
uNLoadNH4HypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadNH4HypN0 ELSE 0 ENDIF;
uNLoadNO3HypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadNO3HypN0 ELSE 0 ENDIF;
uPLoadPO4HypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadPO4HypN0 ELSE 0 ENDIF;
uPLoadAIMHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadAIMHypN0 ELSE 0 ENDIF;
uSiLoadSiO2HypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mSiLoadSiO2HypN0 ELSE 0 ENDIF;
uO2LoadHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mO2LoadHypN0 ELSE cO2InN0 * uQInHypN0 / mmPermN0 ENDIF;
uDLoadDetHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadDetHypN0 ELSE 0 ENDIF;
uNLoadDetHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadDetHypN0 ELSE 0 ENDIF;
uPLoadDetHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadDetHypN0 ELSE 0 ENDIF;
uSiLoadDetHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mSiLoadDetHypN0 ELSE 0 ENDIF;
uDLoadIMHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadIMHypN0 ELSE 0 ENDIF;
uDLoadDiatHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadDiatHypN0 ELSE 0 ENDIF;
uNLoadDiatHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadDiatHypN0 ELSE 0 ENDIF;
uPLoadDiatHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadDiatHypN0 ELSE 0 ENDIF;
uSiLoadDiatHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN cSiDDiatN0 * uDLoadDiatHypN0 ELSE 0 ENDIF;
uDLoadGrenHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadGrenHypN0 ELSE 0 ENDIF;
uNLoadGrenHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadGrenHypN0 ELSE 0 ENDIF;
uPLoadGrenHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadGrenHypN0 ELSE 0 ENDIF;
uDLoadBlueHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadBlueHypN0 ELSE 0 ENDIF;
uNLoadBlueHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadBlueHypN0 ELSE 0 ENDIF;
uPLoadBlueHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadBlueHypN0 ELSE 0 ENDIF;
uDLoadZooHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mDLoadZooHypN0 ELSE 0 ENDIF;
uNLoadZooHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mNLoadZooHypN0 ELSE 0 ENDIF;
uPLoadZooHypN0= IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN mPLoadZooHypN0 ELSE 0 ENDIF;
uDLoadHypN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mDLoadIMHypN0 + mDLoadDetHypN0 + mDLoadDiatHypN0 + mDLoadGrenHypN0 + mDLoadBlueHypN0) ELSE 0.0 ENDIF;
uNLoadHypN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mNLoadNH4HypN0 + mNLoadNO3HypN0 + mNLoadGrenHypN0 + mNLoadDiatHypN0 + mNLoadBlueHypN0 + mNLoadDetHypN0) ELSE 0.0 ENDIF;
uPLoadHypN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN0 EQ TRUE) THEN (mPLoadPO4HypN0 + mPLoadAIMHypN0 + mPLoadDiatHypN0 + mPLoadGrenHypN0 + mPLoadBlueHypN0 + mPLoadDetHypN0) ELSE 0.0 ENDIF;
uSiLoadHypN0 = IF (InclTranN0 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2HypN0 + uSiLoadDetHypN0 + uSiLoadDiatHypN0 ENDIF;
wDDilIMHypN0 = ukOutHypN0 * oDIMWHypN0;
wDDilDetHypN0 = ukOutHypN0 * oDDetWHypN0;
wDDilGrenHypN0 = ukOutHypN0 * oDGrenWHypN0;
wDDilBlueHypN0 = ukOutHypN0 * oDBlueWHypN0;
wDDilDiatHypN0 = ukOutHypN0 * oDDiatWHypN0;
wDDilZooHypN0 = ukOutHypN0 * oDZooHypN0;
wPDilZooHypN0 = ukOutHypN0 * oPZooHypN0;
wNDilZooHypN0 = ukOutHypN0 * oNZooHypN0;
wPDilPO4HypN0 = ukOutHypN0 * oPO4WHypN0;
wPDilDetHypN0 = ukOutHypN0*oPDetWHypN0;
wPDilAIMHypN0 = ukOutHypN0 * oPAIMWHypN0;
wNDilNH4HypN0 = ukOutHypN0 * oNH4WHypN0;
wNDilNO3HypN0 = ukOutHypN0 * oNO3WHypN0;
wNDilDetHypN0 = ukOutHypN0 * oNDetWHypN0;
wO2OutflHypN0 = ukOutHypN0 * oO2WHypN0;
wPDilDiatHypN0 = ukOutHypN0 * oPDiatWHypN0;
wNDilDiatHypN0 = ukOutHypN0 * oNDiatWHypN0;
wPDilGrenHypN0 = ukOutHypN0 * oPGrenWHypN0;
wNDilGrenHypN0 = ukOutHypN0 * oNGrenWHypN0;
wPDilBlueHypN0 = ukOutHypN0 * oPBlueWHypN0;
wNDilBlueHypN0 = ukOutHypN0 * oNBlueWHypN0;
wSiDilSiO2HypN0 = ukOutHypN0 * oSiO2WHypN0;
wSiDilDetHypN0 = ukOutHypN0 * oSiDetWHypN0;
wSiDilDiatHypN0 = cSiDDiatN0 * wDDilDiatHypN0;
wDDilPhytHypN0 = wDDilDiatHypN0 + wDDilGrenHypN0 + wDDilBlueHypN0;
wPDilPhytHypN0 = wPDilDiatHypN0 + wPDilGrenHypN0 + wPDilBlueHypN0;
wNDilPhytHypN0 = wNDilDiatHypN0 + wNDilGrenHypN0 + wNDilBlueHypN0;
wSiDilTotHypN0 = wSiDilDetHypN0 + wSiDilSiO2HypN0 + wSiDilDiatHypN0;
wDOutflTotHypN0 = ukOutHypN0 * oDSestWHypN0;
wPOutflTotHypN0 = ukOutHypN0 * oPTotWHypN0;
wNOutflTotHypN0 = ukOutHypN0 * oNTotWHypN0;
wSiOutflTotHypN0 = ukOutHypN0 * (oSiO2WHypN0 + oSiDetWHypN0 + cSiDDiatN0 * oDDiatWHypN0);
tSiTranTotTHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadHypN0 - wSiDilTotHypN0 * uDepthWHypN0 ENDIF;
wDDilTotHypN0 = wDDilIMHypN0 + wDDilDetHypN0 + wDDilPhytHypN0;
wPDilTotHypN0 = wPDilDetHypN0 + wPDilPO4HypN0 + wPDilAIMHypN0 + wPDilPhytHypN0;
wNDilTotHypN0 = wNDilDetHypN0 + wNDilNO3HypN0 + wNDilNH4HypN0 + wNDilPhytHypN0;
tDTranTotTHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadHypN0 - wDDilTotHypN0 * uDepthWHypN0 ENDIF;
tPTranTotTHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadHypN0 - wPDilTotHypN0 * uDepthWHypN0 ENDIF;
tNTranTotTHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadHypN0 - wNDilTotHypN0 * uDepthWHypN0 ENDIF;
uDLoadTotTWN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadEpiN0 + uDLoadHypN0 ENDIF;
uPLoadTotTWN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadEpiN0 + uPLoadHypN0 ENDIF;
uNLoadTotTWN0 =  IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadEpiN0 + uNLoadHypN0 ENDIF;
uSiLoadTotTWN0 =  IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadEpiN0 + uSiLoadHypN0 ENDIF;
wDExchIMMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDIMWHypN0 - oDIMWMN0) ELSE 0.0 ENDIF;
wPExchPO4MHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPO4WHypN0 - oPO4WMN0) ELSE 0.0 ENDIF;
wPExchAIMMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPAIMWHypN0 - oPAIMWMN0) ELSE 0.0 ENDIF;
wNExchNH4MHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNH4WHypN0 - oNH4WMN0) ELSE 0.0 ENDIF;
wNExchNO3MHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNO3WHypN0 - oNO3WMN0) ELSE 0.0 ENDIF;
wSiExchSiO2MHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oSiO2WHypN0 - oSiO2WMN0) ELSE 0.0 ENDIF;
wO2ExchMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oO2WHypN0 - oO2WMN0) ELSE 0.0 ENDIF;
wDExchDetMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDDetWHypN0 - oDDetWMN0) ELSE 0.0 ENDIF;
wPExchDetMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPDetWHypN0 - oPDetWMN0) ELSE 0.0 ENDIF;
wNExchDetMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNDetWHypN0 - oNDetWMN0) ELSE 0.0 ENDIF;
wSiExchDetMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oSiDetWHypN0 - oSiDetWMN0) ELSE 0.0 ENDIF;
wDExchDiatMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDDiatWHypN0 - oDDiatWMN0) ELSE 0.0 ENDIF;
wPExchDiatMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPDiatWHypN0 - oPDiatWMN0) ELSE 0.0 ENDIF;
wNExchDiatMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNDiatWHypN0 - oNDiatWMN0) ELSE 0.0 ENDIF;
wSiExchDiatMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cSiDDiatN0 * wDExchDiatMHypN0 ELSE 0.0 ENDIF;
wDExchGrenMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDGrenWHypN0 - oDGrenWMN0) ELSE 0.0 ENDIF;
wPExchGrenMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPGrenWHypN0 - oPGrenWMN0) ELSE 0.0 ENDIF;
wNExchGrenMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNGrenWHypN0 - oNGrenWMN0) ELSE 0.0 ENDIF;
wDExchBlueMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDBlueWHypN0 - oDBlueWMN0) ELSE 0.0 ENDIF;
wPExchBlueMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPBlueWHypN0 - oPBlueWMN0) ELSE 0.0 ENDIF;
wNExchBlueMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNBlueWHypN0 - oNBlueWMN0) ELSE 0.0 ENDIF;
wDExchZooMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oDZooHypN0 - oDZooMN0) ELSE 0.0 ENDIF;
wPExchZooMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oPZooHypN0 - oPZooMN0) ELSE 0.0 ENDIF;
wNExchZooMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMHypN0 *(oNZooHypN0 - oNZooMN0) ELSE 0.0 ENDIF;
wDExchIMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDIMWHypN0 - oDIMWMN0) ELSE 0.0 ENDIF;
wPExchPO4HypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPO4WHypN0 - oPO4WMN0) ELSE 0.0 ENDIF;
wPExchAIMHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPAIMWHypN0 - oPAIMWMN0) ELSE 0.0 ENDIF;
wNExchNH4HypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNH4WHypN0 - oNH4WMN0) ELSE 0.0 ENDIF;
wNExchNO3HypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNO3WHypN0 - oNO3WMN0) ELSE 0.0 ENDIF;
wSiExchSiO2HypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oSiO2WHypN0 - oSiO2WMN0) ELSE 0.0 ENDIF;
wO2ExchHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oO2WHypN0 - oO2WMN0) ELSE 0.0 ENDIF;
wDExchDetHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDDetWHypN0 - oDDetWMN0) ELSE 0.0 ENDIF;
wPExchDetHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPDetWHypN0 - oPDetWMN0) ELSE 0.0 ENDIF;
wNExchDetHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNDetWHypN0 - oNDetWMN0) ELSE 0.0 ENDIF;
wSiExchDetHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oSiDetWHypN0 - oSiDetWMN0) ELSE 0.0 ENDIF;
wDExchDiatHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDDiatWHypN0 - oDDiatWMN0) ELSE 0.0 ENDIF;
wPExchDiatHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPDiatWHypN0 - oPDiatWMN0) ELSE 0.0 ENDIF;
wNExchDiatHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNDiatWHypN0 - oNDiatWMN0) ELSE 0.0 ENDIF;
wSiExchDiatHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cSiDDiatN0 * wDExchDiatHypN0 ELSE 0.0 ENDIF;
wDExchGrenHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDGrenWHypN0 - oDGrenWMN0) ELSE 0.0 ENDIF;
wPExchGrenHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPGrenWHypN0 - oPGrenWMN0) ELSE 0.0 ENDIF;
wNExchGrenHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNGrenWHypN0 - oNGrenWMN0) ELSE 0.0 ENDIF;
wDExchBlueHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDBlueWHypN0 - oDBlueWMN0) ELSE 0.0 ENDIF;
wPExchBlueHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPBlueWHypN0 - oPBlueWMN0) ELSE 0.0 ENDIF;
wNExchBlueHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNBlueWHypN0 - oNBlueWMN0) ELSE 0.0 ENDIF;
wDExchZooHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oDZooHypN0 - oDZooMN0) ELSE 0.0 ENDIF;
wPExchZooHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oPZooHypN0 - oPZooMN0) ELSE 0.0 ENDIF;
wNExchZooHypN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLHypN0 *(oNZooHypN0 - oNZooMN0) ELSE 0.0 ENDIF;
tInfSiO2WHypN0 =  IF (InclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oSiO2WHypN0 ELSE 0.0 ENDIF;
tInfO2WHypN0 =  IF (InclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oO2WHypN0 ELSE 0.0 ENDIF;
tPInfPO4WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oPO4WHypN0 ELSE 0.0 ENDIF;
tNInfNH4WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNH4WHypN0 ELSE 0.0 ENDIF;
tNInfNO3WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNO3WHypN0 ELSE 0.0 ENDIF;
tPInfPO4SN0 = IF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oPO4SN0 ELSE 0.0 ENDIF;
tNInfNH4SN0 = IF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNH4SN0 ELSE 0.0 ENDIF;
tNInfNO3SN0 = IF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNO3SN0 ELSE 0.0 ENDIF;
tSeepSiO2WHypN0 =  IF (InclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WHypN0 =  IF (InclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oPO4SN0 ELSE 0.0 ENDIF;
tNSeepNH4WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNH4SN0 ELSE 0.0 ENDIF;
tNSeepNO3WHypN0 = IF (aInclStratN0 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNO3SN0 ELSE 0.0 ENDIF;
tPSeepPO4SN0 = IF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cPO4GroundN0 ELSE 0.0 ENDIF;
tNSeepNH4SN0 = IF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cNH4GroundN0 ELSE 0.0 ENDIF;
tNSeepNO3SN0 = IF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cNO3GroundN0 ELSE 0.0 ENDIF;
tNH4LoadSN0 = fNH4LoadSN0 * cNLoadSN0;
tNO3LoadSN0 = cNLoadSN0 - tNH4LoadSN0;
uDErosIMN0 = (1.0 - fDOrgSoilN0) * cDErosTotN0;
uDErosIMSN0 = fSedErosIMN0 * uDErosIMN0;
uDErosIMWN0 = uDErosIMN0 - uDErosIMSN0;
uDErosOMN0 = fDOrgSoilN0 * cDErosTotN0;
uPErosOMN0 = cPDSoilOMN0 * uDErosOMN0;
uNErosOMN0 = cNDSoilOMN0 * uDErosOMN0;
uO2SatEpiN0 = 14.652 - 0.41022 * uTmEpiN0 + 0.007991 * uTmEpiN0*uTmEpiN0 - 0.000077774 * uTmEpiN0*uTmEpiN0*uTmEpiN0;
uO2SatHypN0 = 14.652 - 0.41022 * uTmHypN0 + 0.007991 * uTmHypN0*uTmHypN0- 0.000077774 *uTmHypN0*uTmHypN0*uTmHypN0;
kAerN0 = IF POW ( uVWindN0 , (0.5))  LE NearZeroN0 THEN 1 ELSE cAerRootN0 * POW ( uVWindN0 , (0.5)) + cAerLinN0 * uVWindN0 + cAerSquareN0 * uVWindN0*uVWindN0 ENDIF;
uFunTmAerEpiN0 = IF  POW ( cThetaAerN0 , (uTmEpiN0-cTmRefN0)) LE NearZeroN0 THEN 1 ELSE POW ( cThetaAerN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
uFunTmAerHypN0 = IF POW ( cThetaAerN0 , (uTmHypN0-cTmRefN0)) LE NearZeroN0 THEN 1 ELSE POW ( cThetaAerN0 , (uTmHypN0-cTmRefN0)) ENDIF;
aFunFloatAerN0 =  MAX( 0.0, 1.0 -  ( kFloatAerN0 * aDFloatVegN0 ) );
aFunBlueSurfAerN0 = MAX(0.0, 1.0 - (kBlueSurfAerN0 * aDBlueSurfN0));
tO2BubHypN0 = IF (uO2SatHypN0 LT oO2WHypN0 ) THEN kBubN0 * uFunTmAerHypN0 * (uO2SatHypN0 - oO2WHypN0) ELSE 0 ENDIF;
uFunTmFishN0 = IF (InclWebN0 EQ TRUE) THEN EXP( -0.5/(cSigTmFishN0*cSigTmFishN0) * (( MAX (uTmEpiN0, uTmHypN0 * aInclStratN0) - cTmOptFishN0)*( MAX (uTmEpiN0, uTmHypN0 * aInclStratN0) - cTmOptFishN0) - (cTmRefN0 - cTmOptFishN0)*(cTmRefN0 - cTmOptFishN0))) ELSE 0.0 ENDIF;
tDTurbFishN0 = IF (InclWebN0 EQ TRUE) THEN (kTurbFishN0 * uFunTmFishN0 * aDFiAdN0) ELSE 0.0 ENDIF;
aFunVegResusN0 = MAX(1.0 - kVegResusN0 * aDVegN0, NearZeroN0);
aFunDimSuspN0 = IF (uTmEpiN0 GE 0.1) OR  POW(((cFetchN0 +NearZeroN0)/ cFetchRefN0) , (0.5)) LE NearZeroN0 THEN cSuspRefN0 * ((cSuspMinN0 + cSuspMaxN0 / (1.0 + EXP(cSuspSlopeN0 * (uDepthWN0 - hDepthSuspN0)))) * POW(((cFetchN0 +NearZeroN0)/ cFetchRefN0) , (0.5))) ELSE 0.0 ENDIF;
tDResusTauDeadN0 = IF POW(aFunDimSuspN0 +NearZeroN0 , (0.5)) LE NearZeroN0 THEN MIN(aFunDimSuspN0, POW( 1  , (0.5))) * POW(fLutumN0 / fLutumRefN0 , (0.5)) * bPorSN0 ELSE MIN(aFunDimSuspN0, POW(aFunDimSuspN0 +NearZeroN0 , (0.5))) * POW(fLutumN0 / fLutumRefN0 , (0.5)) * bPorSN0 ENDIF;
tDResusBareDeadN0 = tDResusTauDeadN0 + tDTurbFishN0;
tDResusDeadN0 = tDResusBareDeadN0 * aFunVegResusN0;
tDResusIMN0 = fLutumN0 * aDIMSN0 / (fLutumN0 * aDIMSN0 + aDDetSN0) * tDResusDeadN0;
tDResusDetN0 = aDDetSN0 / (fLutumN0 * aDIMSN0 + aDDetSN0) * tDResusDeadN0;
akResusPhytRefN0 = kResusPhytMaxN0 * (1.0 - EXP(cResusPhytExpN0 * tDResusDeadN0));
tDResusPhytTotN0 = akResusPhytRefN0 * aDPhytSN0;
tPResusDetN0 = rPDDetSN0 * tDResusDetN0;
tPResusPO4N0 = aPO4SN0 / aDDetSN0 * tDResusDetN0;
tPResusAIMN0 = aPAIMSN0 / aDIMSN0 * tDResusIMN0;
tNResusNO3N0 = aNO3SN0 / aDDetSN0 * tDResusDetN0;
tNResusNH4N0 = aNH4SN0 / aDDetSN0 * tDResusDetN0;
tNResusDetN0 = rNDDetSN0 * tDResusDetN0;
tSiResusDetN0 = rSiDDetSN0 * tDResusDetN0;
aFunTauSetOMHypN0 = IF POW(aFunDimSuspN0 +NearZeroN0 , (0.5)) LT NearZeroN0 THEN 1 ELSE MIN(1.0 / POW(aFunDimSuspN0 +NearZeroN0 , (0.5)), 1.0) ENDIF;
aFunTauSetIMHypN0 = aFunTauSetOMHypN0;
uFunTmSetEpiN0 = IF POW ( cThetaSetN0 , (uTmEpiN0-cTmRefN0)) LT NearZeroN0 THEN 1 ELSE POW ( cThetaSetN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
uFunTmSetHypN0 = IF POW(cThetaSetN0 , (uTmHypN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE POW(cThetaSetN0 , (uTmHypN0-cTmRefN0)) ENDIF;
uCorVSetIMHypN0 = IF POW((fLutumRefN0/fLutumN0) , (0.5))  LT NearZeroN0 THEN 1 ELSE aFunTauSetIMHypN0 * POW((fLutumRefN0/fLutumN0) , (0.5)) * uFunTmSetHypN0 * (cVSetIMN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) ENDIF;
tDSetIMHypN0 = uCorVSetIMHypN0 * oDIMWHypN0;
tPSetAIMHypN0 = oPAIMWHypN0 / oDIMWHypN0 * tDSetIMHypN0;
uCorVSetDetHypN0 = (cVSetDetN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMHypN0 * uFunTmSetHypN0;
tDSetDetHypN0 = uCorVSetDetHypN0 * oDDetWHypN0;
tPSetDetHypN0 = uCorVSetDetHypN0 * oPDetWHypN0;
tNSetDetHypN0 = uCorVSetDetHypN0 * oNDetWHypN0;
tSiSetDetHypN0 = uCorVSetDetHypN0 * oSiDetWHypN0;
kPMinDetWN0 = kDMinDetWN0;
kNMinDetWN0 = kDMinDetWN0;
kSiMinDetWN0 = kDMinDetWN0;
uFunTmMinWEpiN0 =  IF POW(cThetaMinWN0 , (uTmEpiN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE POW(cThetaMinWN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
uFunTmMinWHypN0 = IF POW(cThetaMinWN0 , (uTmEpiN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE  POW(cThetaMinWN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
wDMinDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kDMinDetWN0 * uFunTmMinWHypN0 * oDDetWHypN0 ENDIF;
wPMinDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kPMinDetWN0 * uFunTmMinWHypN0 * oPDetWHypN0 ENDIF;
wNMinDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kNMinDetWN0 * uFunTmMinWHypN0 * oNDetWHypN0 ENDIF;
wSiMinDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kSiMinDetWN0 * uFunTmMinWHypN0 * oSiDetWHypN0 ENDIF;
aCorO2BODHypN0 = oO2WHypN0 / (hO2BODN0 + oO2WHypN0);
wO2MinDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE molO2molCN0 * cCPerDWN0 * aCorO2BODHypN0 * wDMinDetWHypN0 ENDIF;
wDDenitWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE oNO3WHypN0*oNO3WHypN0 / (hNO3DenitN0*hNO3DenitN0 + oNO3WHypN0*oNO3WHypN0) * (1.0 - aCorO2BODHypN0) * wDMinDetWHypN0 ENDIF;
wNDenitWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE NO3PerCN0 * molNmolCN0 * cCPerDWN0 * wDDenitWHypN0 ENDIF;
uFunTmNitrHypN0 = IF   POW(cThetaNitrN0 , (uTmHypN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE POW(cThetaNitrN0 , (uTmHypN0-cTmRefN0)) ENDIF;
uFunTmNitrEpiN0 =  IF POW(cThetaNitrN0 , (uTmEpiN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE POW(cThetaNitrN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
uFunTmNitrSN0 = IF POW(cThetaNitrN0 , (uTmEpiN0-cTmRefN0))  LT NearZeroN0 THEN 1 ELSE POW(cThetaNitrN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
aCorO2NitrWHypN0 = oO2WHypN0*oO2WHypN0 / (hO2NitrN0*hO2NitrN0 + oO2WHypN0*oO2WHypN0);
wNNitrWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kNitrWN0 * uFunTmNitrHypN0 * aCorO2NitrWHypN0 * oNH4WHypN0 ENDIF;
wO2NitrWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE O2PerNH4N0 * molO2molNN0 * wNNitrWHypN0 ENDIF;
kPMinDetSN0 = kDMinDetSN0;
kNMinDetSN0 = kDMinDetSN0;
kSiMinDetSN0 = kDMinDetSN0;
uFunTmMinSN0 = IF POW(cThetaMinSN0 , (uTmBotN0-cTmRefN0)) LT NearZeroN0 THEN 1 ELSE  POW(cThetaMinSN0 , (uTmBotN0-cTmRefN0)) ENDIF;
tDMinDetSN0 = kDMinDetSN0 * uFunTmMinSN0 * aDDetSN0;
tPMinDetSN0 = kPMinDetSN0 * uFunTmMinSN0 * aPDetSN0;
tNMinDetSN0 = kNMinDetSN0 * uFunTmMinSN0 * aNDetSN0;
tSiMinDetSN0 = kSiMinDetSN0 * uFunTmMinSN0 * aSiDetSN0;
uFunTmDifN0 = IF POW(cThetaDifN0 , (uTmEpiN0-cTmRefN0)) LT NearZeroN0 THEN 1 ELSE POW(cThetaDifN0 , (uTmEpiN0-cTmRefN0)) ENDIF;
akO2DifCorN0 = kO2DifN0 * uFunTmDifN0 * cTurbDifO2N0 * bPorCorSN0;
tSODN0 = (molO2molCN0 * cCPerDWN0 * (1.0 - fRefrDetSN0) * tDMinDetSN0 + O2PerNH4N0 * molO2molNN0 * kNitrSN0 * uFunTmNitrSN0 * aNH4SN0) / cDepthSN0;
aDepthDifN0 = fDepthDifSN0 * cDepthSN0;
tPDifPO4HypN0 = IF ( aInclStratN0 EQ TRUE ) THEN kPDifPO4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oPO4SN0 - oPO4WHypN0 ) / aDepthDifN0 ELSE 0.0 ENDIF ;
tNDifNO3HypN0 = IF ( aInclStratN0 EQ TRUE ) THEN kNDifNO3N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oNO3SN0 - oNO3WHypN0 ) / aDepthDifN0 ELSE 0.0 ENDIF ;
tNDifNH4HypN0 = IF ( aInclStratN0 EQ TRUE ) THEN kNDifNH4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oNH4SN0 - oNH4WHypN0 ) / aDepthDifN0 ELSE 0.0 ENDIF ;
tO2DifHypN0 = IF ( aInclStratN0 EQ TRUE ) THEN kO2DifN0 / aDepthDifN0 * uFunTmDifN0 * cTurbDifO2N0 * bPorCorSN0 * oO2WHypN0 ELSE 0.0 ENDIF ;
tPDifGroundPO4N0 = 0.0;
tNDifGroundNO3N0 = 0.0;
tNDifGroundNH4N0 = 0.0;
aPAdsMaxWHypN0 = cRelPAdsDN0 + aCorO2BODHypN0 * cRelPAdsFeN0 * fFeDIMN0 + cRelPAdsAlN0 * fAlDIMN0;
aKPAdsWHypN0 = (1.0 - fRedMaxN0 * (1.0-aCorO2BODHypN0)) * cKPAdsOxN0;
aPIsoAdsWHypN0 = aPAdsMaxWHypN0 * aKPAdsWHypN0 * oPO4WHypN0 / (1.0 + aKPAdsWHypN0 * oPO4WHypN0);
aPEqIMWHypN0 = aPIsoAdsWHypN0 * oDIMWHypN0;
wPSorpIMWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kPSorpN0 * (aPEqIMWHypN0 - oPAIMWHypN0) ENDIF;
tPChemPO4N0 = MAX( 0.0, kPChemPO4N0 * (oPO4SN0 - coPO4MaxN0) );
uQEvPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN uQEvN0 ELSE 0.0 ENDIF;
tPEvPO4WMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN uQEvPhraN0 / mmPermN0 * oPO4WMN0 ELSE 0.0 ENDIF;
tNEvNH4WMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN uQEvPhraN0 / mmPermN0 * oNH4WMN0 ELSE 0.0 ENDIF;
tNEvNO3WMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN uQEvPhraN0 / mmPermN0 * oNO3WMN0 ELSE 0.0 ENDIF;
tInfSiO2WMN0 = IF ((InclMarshN0 EQ FALSE) OR (fMarshN0 LE NearZeroN0)) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oSiO2WMN0 ELSE 0.0 ENDIF;
tInfO2WMN0 = IF ((InclMarshN0 EQ FALSE) OR (fMarshN0 LE NearZeroN0)) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oO2WMN0 ELSE 0.0 ENDIF;
tPInfPO4WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oPO4WMN0 ELSE 0.0 ENDIF;
tNInfNH4WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNH4WMN0 ELSE 0.0 ENDIF;
tNInfNO3WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNO3WMN0 ELSE 0.0 ENDIF;
tPInfPO4SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oPO4SMN0 ELSE 0.0 ENDIF;
tNInfNH4SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNH4SMN0 ELSE 0.0 ENDIF;
tNInfNO3SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNO3SMN0 ELSE 0.0 ENDIF;
tSeepSiO2WMN0 = IF ((InclMarshN0 EQ FALSE) OR (fMarshN0 LT NearZeroN0)) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WMN0 = IF ((InclMarshN0 EQ FALSE) OR (fMarshN0 LT NearZeroN0)) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oPO4SMN0 ELSE 0.0 ENDIF;
tNSeepNH4WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNH4SMN0 ELSE 0.0 ENDIF;
tNSeepNO3WMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNO3SMN0 ELSE 0.0 ENDIF;
tPSeepPO4SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cPO4GroundN0 ELSE 0.0 ENDIF;
tNSeepNH4SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cNH4GroundN0 ELSE 0.0 ENDIF;
tNSeepNO3SMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * cNO3GroundN0 ELSE 0.0 ENDIF;
tO2AerMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kAerN0 * uFunTmAerEpiN0 *(uO2SatEpiN0 - oO2WMN0) ELSE 0.0 ENDIF;
tDSetIMMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetIMN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oDIMWMN0 ELSE 0.0 ENDIF;
tPSetAIMMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetIMN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oPAIMWMN0 ELSE 0.0 ENDIF;
tDSetDetMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDetN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oDDetWMN0 ELSE 0.0 ENDIF;
tPSetDetMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDetN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oPDetWMN0 ELSE 0.0 ENDIF;
tNSetDetMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDetN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oNDetWMN0 ELSE 0.0 ENDIF;
tSiSetDetMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDetN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oSiDetWMN0 ELSE 0.0 ENDIF;
tDSetDiatMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ( cVSetDiatN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oDDiatWMN0 ELSE 0.0 ENDIF;
tPSetDiatMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDiatN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oPDiatWMN0 ELSE 0.0 ENDIF;
tNSetDiatMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ( cVSetDiatN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oNDiatWMN0 ELSE 0.0 ENDIF;
tSiSetDiatMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetDiatN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oSiDiatWMN0 ELSE 0.0 ENDIF;
tDSetGrenMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetGrenN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oDGrenWMN0 ELSE 0.0 ENDIF;
tPSetGrenMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetGrenN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oPGrenWMN0 ELSE 0.0 ENDIF;
tNSetGrenMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetGrenN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oNGrenWMN0 ELSE 0.0 ENDIF;
tDSetBlueMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0 * oDBlueWMN0 ELSE 0.0 ENDIF;
tPSetBlueMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0)* uFunTmSetEpiN0* oPBlueWMN0 ELSE 0.0 ENDIF;
tNSetBlueMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * uFunTmSetEpiN0* oNBlueWMN0 ELSE 0.0 ENDIF;
tDSetPhytMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDSetDiatMN0 + tDSetGrenMN0 + tDSetBlueMN0 ELSE 0.0 ENDIF;
tPSetPhytMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tPSetDiatMN0 + tPSetGrenMN0 + tPSetBlueMN0 ELSE 0.0 ENDIF;
tNSetPhytMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tNSetDiatMN0 + tNSetGrenMN0 + tNSetBlueMN0 ELSE 0.0 ENDIF;
tDSetTotMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDSetIMMN0 + tDSetDetMN0 + tDSetPhytMN0 ELSE 0.0 ENDIF;
wDMinDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMinDetWN0 * uFunTmMinWEpiN0 * oDDetWMN0 ELSE 0.0 ENDIF;
wPMinDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kPMinDetWN0 * uFunTmMinWEpiN0 * oPDetWMN0 ELSE 0.0 ENDIF;
wNMinDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kNMinDetWN0 * uFunTmMinWEpiN0 * oNDetWMN0 ELSE 0.0 ENDIF;
wSiMinDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kSiMinDetWN0 * uFunTmMinWEpiN0 * oSiDetWMN0 ELSE 0.0 ENDIF;
aCorO2BODMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oO2WMN0 /(hO2BODN0 + oO2WMN0) ELSE 0.0 ENDIF;
wO2MinDetWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN molO2molCN0 * cCPerDWN0 * aCorO2BODMN0 * wDMinDetWMN0 ELSE 0.0 ENDIF;
wDDenitWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNO3WMN0*oNO3WMN0 /(hNO3DenitN0*hNO3DenitN0 + oNO3WMN0*oNO3WMN0) *(1.0 - aCorO2BODMN0) * wDMinDetWMN0 ELSE 0.0 ENDIF;
wNDenitWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN NO3PerCN0 * molNmolCN0 * cCPerDWN0 * wDDenitWMN0 ELSE 0.0 ENDIF;
aCorO2NitrWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oO2WMN0 * oO2WMN0 /(hO2NitrN0 * hO2NitrN0 + oO2WMN0 * oO2WMN0) ELSE 0.0 ENDIF;
wNNitrWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kNitrWN0 * uFunTmNitrEpiN0 * aCorO2NitrWMN0 * oNH4WMN0 ELSE 0.0 ENDIF;
wO2NitrWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN O2PerNH4N0 * molO2molNN0 * wNNitrWMN0 ELSE 0.0 ENDIF;
tDMinDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMinDetSN0 * uFunTmMinSN0 * aDDetSMN0 ELSE 0.0 ENDIF;
tPMinDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kPMinDetSN0 * uFunTmMinSN0 * aPDetSMN0 ELSE 0.0 ENDIF;
tNMinDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kNMinDetSN0 * uFunTmMinSN0 * aNDetSMN0 ELSE 0.0 ENDIF;
tSiMinDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kSiMinDetSN0 * uFunTmMinSN0 * aSiDetSMN0 ELSE 0.0 ENDIF;
akO2DifCorMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kO2DifN0 * uFunTmDifN0 * cTurbDifO2N0 * bPorCorSMN0 ELSE 0.0 ENDIF;
tSODMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN(molO2molCN0 * cCPerDWN0 *(1.0 - fRefrDetSN0) * tDMinDetSMN0 + O2PerNH4N0 * molO2molNN0 * kNitrSN0 * uFunTmNitrEpiN0 * aNH4SMN0) / cDepthSMN0 ELSE 0.0 ENDIF;
aDepthOxySedMN0 = IF (InclMarshN0 EQ FALSE OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF POW((2.0 * oO2WMN0 * akO2DifCorMN0 / tSODMN0) , (0.5)) LE NearZeroN0 THEN 1 ELSE POW((2.0 * oO2WMN0 * akO2DifCorMN0 / tSODMN0) , (0.5)) ENDIF ;
afOxySedMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDepthOxySedMN0 / cDepthSMN0 ELSE 0.0 ENDIF;
tDMinOxyDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN afOxySedMN0 *(1.0 - fRefrDetSN0) * tDMinDetSMN0 ELSE 0.0 ENDIF;
tO2MinDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN molO2molCN0 * cCPerDWN0 * tDMinOxyDetSMN0 ELSE 0.0 ENDIF;
tDDenitSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN oNO3SMN0*oNO3SMN0 /(hNO3DenitN0*hNO3DenitN0 + oNO3SMN0*oNO3SMN0) *(1.0 - afOxySedMN0) *(1.0 - fRefrDetSN0) * tDMinDetSMN0 ELSE 0.0 ENDIF;
tNDenitSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN NO3PerCN0 * molNmolCN0 * cCPerDWN0 * tDDenitSMN0 ELSE 0.0 ENDIF;
tNNitrSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN afOxySedMN0 * kNitrSN0 * uFunTmNitrEpiN0 * aNH4SMN0 ELSE 0.0 ENDIF;
tO2NitrSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN O2PerNH4N0 * molO2molNN0 * tNNitrSMN0 ELSE 0.0 ENDIF;
tDMinHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMinHumN0 * uFunTmMinSN0 * afOxySedMN0 * aDHumSMN0 ELSE 0.0 ENDIF;
tPMinHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMinHumN0 * uFunTmMinSN0 * afOxySedMN0 * aPHumSMN0 ELSE 0.0 ENDIF;
tNMinHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMinHumN0 * uFunTmMinSN0 * afOxySedMN0 * aNHumSMN0 ELSE 0.0 ENDIF;
aDepthDifMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN fDepthDifSN0 * cDepthSMN0 ELSE 0.0 ENDIF;
tPDifPO4MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kPDifPO4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSMN0 * (oPO4SMN0 - oPO4WMN0) / aDepthDifMN0 ELSE 0.0 ENDIF;
tNDifNO3MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kNDifNO3N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSMN0 * (oNO3SMN0 - oNO3WMN0) / aDepthDifMN0 ELSE 0.0 ENDIF;
tNDifNH4MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kNDifNH4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSMN0 * (oNH4SMN0 - oNH4WMN0) / aDepthDifMN0 ELSE 0.0 ENDIF;
tO2DifMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kO2DifN0 / aDepthDifMN0 * uFunTmDifN0 * cTurbDifO2N0 * bPorCorSMN0 * oO2WMN0 ELSE 0.0 ENDIF;
tPDifGroundPO4MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNO3MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNH4MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN 0.0 ELSE 0.0 ENDIF;
aPAdsMaxWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cRelPAdsDN0 + aCorO2BODMN0 * cRelPAdsFeN0 * fFeDIMN0 + cRelPAdsAlN0 * fAlDIMN0 ELSE 0.0 ENDIF;
aKPAdsWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN(1.0 - fRedMaxN0 *(1.0-aCorO2BODMN0)) * cKPAdsOxN0 ELSE 0.0 ENDIF;
aPIsoAdsWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPAdsMaxWMN0 * aKPAdsWMN0 * oPO4WMN0 /(1.0 + aKPAdsWMN0 * oPO4WMN0) ELSE 0.0 ENDIF;
aPEqIMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPIsoAdsWMN0 * oDIMWMN0 ELSE 0.0 ENDIF;
wPSorpIMWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kPSorpN0 *(aPEqIMWMN0 - oPAIMWMN0) ELSE 0.0 ENDIF;
aPAdsMaxSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cRelPAdsDN0 + afOxySedMN0 * cRelPAdsFeN0 * fFeDIMN0 + cRelPAdsAlN0 * fAlDIMN0 ELSE 0.0 ENDIF;
aKPAdsSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN(1.0 - fRedMaxN0 *(1.0-afOxySedMN0)) * cKPAdsOxN0 ELSE 0.0 ENDIF;
aPIsoAdsSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPAdsMaxSMN0 * aKPAdsSMN0 * oPO4SMN0 /(1.0 + aKPAdsSMN0 * oPO4SMN0) ELSE 0.0 ENDIF;
aPEqIMSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPIsoAdsSMN0 * aDIMSMN0 ELSE 0.0 ENDIF;
tPSorpIMSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kPSorpN0 *(aPEqIMSMN0 - aPAIMSMN0) ELSE 0.0 ENDIF;
tPChemPO4MN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN MAX(0.0,kPChemPO4N0 *(oPO4SMN0 - coPO4MaxN0)) ELSE 0.0 ENDIF;
aDRootVegN0 = bfRootVegN0 * aDVegN0;
bfSubVegEpiN0 = bfSubVegN0 * ( uVegHeightEpiN0 / uDepthWN0 );
bfSubVegHypN0 = bfSubVegN0 * ( uVegHeightHypN0 / uDepthWN0 );
afCovSurfVegN0 = MIN(1.0, MAX(aDFloatVegN0 / (cDLayerVegN0 + NearZeroN0), aDEmergVegN0 / (fEmergVegN0 * cDCarrVegN0 + NearZeroN0) ) ) ;
afCovEmergVegN0 = MIN(1.0, PerCentN0 * cCovSpVegN0 * aDEmergVegN0);
aCovVegN0 = MIN(100.0, cCovSpVegN0 * aDShootVegN0);
aLPARBotHypN0 = uLPARSurfHypN0 * EXP(- aExtCoefHypN0 * uDepthWHypN0);
rPDVegN0 = aPVegN0 / (aDVegN0+NearZeroN0);
rNDVegN0 = aNVegN0 / (aDVegN0+NearZeroN0);
tDMigrVegN0 = kMigrVegN0 * (cDVegInN0 - aDVegN0);
tPMigrVegN0 = kMigrVegN0 * (cPDVeg0N0* cDVegInN0 - aPVegN0);
tNMigrVegN0 = kMigrVegN0 * (cNDVeg0N0* cDVegInN0 - aNVegN0);
uFunTmRespVegN0 = IF ( UseExpVegN0 GT NearZeroN0 ) THEN uFunTmVegN0 ELSE POW(cQ10RespVegN0 , (0.1 * (uTmVegAveN0 - cTmRefN0))) ENDIF;
afPUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN 0.0 ELSEIF (bfRootVegN0 LE NearZeroN0) THEN 0.0 ELSEIF (fFloatVegN0 + bfSubVegN0 LE NearZeroN0) THEN 1.0 ELSEIF (aInclStratN0 EQ TRUE AND ((oPO4SN0+NearZeroN0) / (oPO4WHypN0+NearZeroN0)) GT NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(((oPO4SN0+NearZeroN0) / (oPO4WHypN0+NearZeroN0)) , fSedUptVegExpN0)) ELSEIF (aInclStratN0 EQ TRUE AND ((oPO4SN0+NearZeroN0) / (oPO4WHypN0+NearZeroN0)) LE NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW( NearZeroN0 , fSedUptVegExpN0)) ELSEIF (((oPO4SN0+NearZeroN0) / (oPO4WEpiN0+NearZeroN0)) LE NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW (NearZeroN0 , fSedUptVegExpN0)) ELSE fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(((oPO4SN0+NearZeroN0) / (oPO4WEpiN0+NearZeroN0)) , fSedUptVegExpN0)) ENDIF;
afNUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN 0.0 ELSEIF (bfRootVegN0 LE NearZeroN0) THEN 0.0 ELSEIF (fFloatVegN0 + bfSubVegN0 LE NearZeroN0) THEN 1.0 ELSEIF ( aInclStratN0 EQ TRUE AND ((oNDissSN0+NearZeroN0) / (oNDissWHypN0+NearZeroN0)) GT NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(((oNDissSN0+NearZeroN0) / (oNDissWHypN0+NearZeroN0)) , fSedUptVegExpN0)) ELSEIF ( aInclStratN0 EQ TRUE AND ((oNDissSN0+NearZeroN0) / (oNDissWHypN0+NearZeroN0)) LE NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(NearZeroN0 , fSedUptVegExpN0)) ELSEIF ( ((oNDissSN0+NearZeroN0) / (oNDissWEpiN0+NearZeroN0)) LE NearZeroN0 ) THEN fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(NearZeroN0 , fSedUptVegExpN0)) ELSE fSedUptVegMaxN0 / (1.0 + fSedUptVegCoefN0 * POW(((oNDissSN0+NearZeroN0) / (oNDissWEpiN0+NearZeroN0)) , fSedUptVegExpN0)) ENDIF;
aVPUptMaxCrVegN0 = IF (FALSE EQ UseEmpUptN0) THEN MAX( 0.0, cVPUptMaxVegN0 * uFunTmProdVegN0 * (cPDVegMaxN0-rPDVegN0) / (cPDVegMaxN0-cPDVegMinN0) ) ELSE MAX( 0.0, cVPUptMaxVegN0 * uFunTmProdVegN0 * (cPDVegMaxN0-rPDVegN0) / (cPDVegMaxN0-cPDVegMinN0) ) ENDIF;
aVPUptVegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN oPO4WHypN0 * aVPUptMaxCrVegN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4WHypN0) ELSE 0.0 ENDIF;
aVPUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN oPO4SN0 * aVPUptMaxCrVegN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4SN0) ELSE 0.0 ENDIF;
aVPUptVegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN oPO4WEpiN0 * aVPUptMaxCrVegN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4WEpiN0) ELSE 0.0 ENDIF;
tPUptVegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN aVPUptVegWEpiN0 * (aDSubVegN0 + aDFloatVegN0) ELSE (1.0 - afPUptVegSN0) * aVPUptMaxCrVegN0 * oPO4WEpiN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4WEpiN0) * uDVegEpiN0 ENDIF;
tPUptVegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN aVPUptVegWHypN0 * (aDSubVegN0 + aDFloatVegN0) ELSE (1.0 - afPUptVegSN0) * aVPUptMaxCrVegN0 * oPO4WHypN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4WHypN0) * uDVegHypN0 ENDIF;
tPUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN aVPUptVegSN0 * aDRootVegN0 ELSE afPUptVegSN0 * aVPUptMaxCrVegN0 * oPO4SN0 / (aVPUptMaxCrVegN0 / cAffPUptVegN0 + oPO4SN0) * aDVegN0 ENDIF;
tPUptVegEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN tPUptVegWEpiN0 + tPUptVegSN0 * uDVegEpiN0 / aDVegN0 ELSEIF (aInclStratN0 EQ FALSE AND FALSE EQ UseEmpUptN0) THEN tPUptVegWEpiN0 + tPUptVegSN0 ELSE tPUptVegWEpiN0 + tPUptVegSN0 ENDIF;
tPUptVegHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN0) THEN tPUptVegWHypN0 + tPUptVegSN0 * uDVegHypN0 / aDVegN0 ELSE tPUptVegWHypN0 + tPUptVegSN0 * uDVegHypN0 / aDVegN0 ENDIF ;
aVNUptMaxCrVegN0 = IF (FALSE EQ UseEmpUptN0) THEN MAX( 0.0, cVNUptMaxVegN0 * uFunTmProdVegN0 * (cNDVegMaxN0 - rNDVegN0) / (cNDVegMaxN0 - cNDVegMinN0)) ELSE MAX( 0.0, cVNUptMaxVegN0 * uFunTmProdVegN0 * (cNDVegMaxN0 - rNDVegN0) / (cNDVegMaxN0 - cNDVegMinN0)) ENDIF;
ahNUptVegN0 = IF (FALSE EQ UseEmpUptN0) THEN aVNUptMaxCrVegN0 / cAffNUptVegN0 ELSE aVNUptMaxCrVegN0 / cAffNUptVegN0 ENDIF;
aVNUptVegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN oNDissWEpiN0 * aVNUptMaxCrVegN0 / (ahNUptVegN0 + oNDissWEpiN0) ELSE 0.0 ENDIF;
aVNUptVegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN oNDissWHypN0 * aVNUptMaxCrVegN0 / (ahNUptVegN0 + oNDissWHypN0) ELSE 0.0 ENDIF;
afNH4UptVegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN oNH4WEpiN0 * oNO3WEpiN0 / ((ahNUptVegN0 + oNH4WEpiN0) * (ahNUptVegN0 + oNO3WEpiN0 + NearZeroN0)) + oNH4WEpiN0 * ahNUptVegN0 / ((oNH4WEpiN0 + oNO3WEpiN0 + NearZeroN0) * (ahNUptVegN0 + oNO3WEpiN0 + NearZeroN0)) ELSE oNH4WEpiN0 * oNO3WEpiN0 / ((ahNUptVegN0 + oNH4WEpiN0) * (ahNUptVegN0 + oNO3WEpiN0 + NearZeroN0)) + oNH4WEpiN0 * ahNUptVegN0 / ((oNH4WEpiN0 + oNO3WEpiN0 + NearZeroN0) * (ahNUptVegN0 + oNO3WEpiN0 + NearZeroN0)) ENDIF;
afNH4UptVegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN oNH4WHypN0 * oNO3WHypN0 / ((ahNUptVegN0 + oNH4WHypN0) * (ahNUptVegN0 + oNO3WHypN0 + NearZeroN0)) + oNH4WHypN0 * ahNUptVegN0 / ((oNH4WHypN0 + oNO3WHypN0 + NearZeroN0) * (ahNUptVegN0 + oNO3WHypN0 + NearZeroN0)) ELSE oNH4WHypN0 * oNO3WHypN0 / ((ahNUptVegN0 + oNH4WHypN0) * (ahNUptVegN0 + oNO3WHypN0 + NearZeroN0)) + oNH4WHypN0 * ahNUptVegN0 / ((oNH4WHypN0 + oNO3WHypN0 + NearZeroN0) * (ahNUptVegN0 + oNO3WHypN0 + NearZeroN0)) ENDIF;
tNUptVegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN aVNUptVegWEpiN0 * (aDSubVegN0 + aDFloatVegN0) ELSE (1.0 - afNUptVegSN0) * aVNUptMaxCrVegN0 * oNDissWEpiN0 / (aVNUptMaxCrVegN0 / cAffNUptVegN0 + oNDissWEpiN0) * uDVegEpiN0 ENDIF;
tNUptVegWHypN0 = IF (FALSE EQ aInclStratN0) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN0) THEN aVNUptVegWHypN0 * (aDSubVegN0 + aDFloatVegN0) ELSE (1.0 - afNUptVegSN0) * aVNUptMaxCrVegN0 * oNDissWHypN0 / (aVNUptMaxCrVegN0 / cAffNUptVegN0 + oNDissWHypN0) * uDVegHypN0 ENDIF;
tNUptNH4VegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN afNH4UptVegWEpiN0 * tNUptVegWEpiN0 ELSE afNH4UptVegWEpiN0 * tNUptVegWEpiN0 ENDIF;
tNUptNO3VegWEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN tNUptVegWEpiN0 - tNUptNH4VegWEpiN0 ELSE tNUptVegWEpiN0 - tNUptNH4VegWEpiN0 ENDIF;
tNUptNH4VegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN afNH4UptVegWHypN0 * tNUptVegWHypN0 ELSE afNH4UptVegWHypN0 * tNUptVegWHypN0 ENDIF;
tNUptNO3VegWHypN0 = IF (FALSE EQ UseEmpUptN0) THEN tNUptVegWHypN0 - tNUptNH4VegWHypN0 ELSE tNUptVegWHypN0 - tNUptNH4VegWHypN0 ENDIF;
aVNUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN oNDissSN0 * aVNUptMaxCrVegN0 / (ahNUptVegN0 + oNDissSN0) ELSE 0.0 ENDIF;
tNUptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN aVNUptVegSN0 * aDRootVegN0 ELSE afNUptVegSN0 * aVNUptMaxCrVegN0 * oNDissSN0 / (aVNUptMaxCrVegN0 / cAffNUptVegN0 + oNDissSN0) * aDVegN0 ENDIF;
afNH4UptVegSN0 = IF (FALSE EQ UseEmpUptN0) THEN oNH4SN0 * oNO3SN0 / ((ahNUptVegN0 + oNH4SN0 +NearZeroN0) * (ahNUptVegN0 + oNO3SN0 +NearZeroN0)) + oNH4SN0 * ahNUptVegN0 / ((oNH4SN0 + oNO3SN0+NearZeroN0) * (ahNUptVegN0 + oNO3SN0+NearZeroN0)) ELSE oNH4SN0 * oNO3SN0 / ((ahNUptVegN0 + oNH4SN0 +NearZeroN0) * (ahNUptVegN0 + oNO3SN0 +NearZeroN0)) + oNH4SN0 * ahNUptVegN0 / ((oNH4SN0 + oNO3SN0+NearZeroN0) * (ahNUptVegN0 + oNO3SN0+NearZeroN0)) ENDIF;
tNUptNH4VegSN0 = IF (FALSE EQ UseEmpUptN0) THEN afNH4UptVegSN0 * tNUptVegSN0 ELSE afNH4UptVegSN0 * tNUptVegSN0 ENDIF;
tNUptVegSEpiN0 = IF (FALSE EQ UseEmpUptN0) THEN aVNUptVegSN0 * aDRootVegN0 ELSE afNUptVegSN0 * aVNUptMaxCrVegN0 * oNDissSN0 / (aVNUptMaxCrVegN0 / cAffNUptVegN0 + oNDissSN0) * aDVegN0 ENDIF;
tNUptNO3VegSN0 = IF (FALSE EQ UseEmpUptN0) THEN tNUptVegSN0 - tNUptNH4VegSN0 ELSE tNUptVegSN0 - tNUptNH4VegSN0 ENDIF;
tNUptVegN0 =tNUptVegWEpiN0 + tNUptVegWHypN0 + tNUptVegSN0;
aLLimShootVegEpiN0 = fEmergVegN0 + fFloatVegN0 * (1.0 - afCovEmergVegN0) + bfSubVegEpiN0 * (1.0 - afCovSurfVegN0) * 1.0 / (aExtCoefEpiN0 * uDepthWEpiN0) * LN( (1.0 + aLPAR1VegEpiN0 / uhLVegN0) / (1.0 + aLPAR2VegEpiN0 / uhLVegN0));
aLLimShootVegHypN0 = fEmergVegN0 + fFloatVegN0 * (1.0 - afCovEmergVegN0) + bfSubVegHypN0 * (1.0 - afCovSurfVegN0) * 1.0 / (aExtCoefHypN0 * uDepthWHypN0) * LN( (1.0 + aLPAR1VegHypN0 / uhLVegN0) / (1.0 + aLPAR2VegHypN0 / uhLVegN0));
aMuTmLVegHypN0 = ufDayN0 * bfShootVegN0 * aLLimShootVegHypN0 * uFunTmProdVegN0 * cMuMaxVegN0;
aPLimVegN0 = MAX(0.0, (1.0 - cPDVegMinN0 / rPDVegN0) * cPDVegMaxN0 / (cPDVegMaxN0 - cPDVegMinN0) );
aNLimVegN0 = MAX(0.0, (1.0 - cNDVegMinN0 / rNDVegN0) * cNDVegMaxN0 / (cNDVegMaxN0 - cNDVegMinN0) );
aNutLimVegN0 = MIN( aPLimVegN0, aNLimVegN0);
aMuVegHypN0 = aMuTmLVegHypN0 * aNutLimVegN0;
bkMortVegN0 = IF (FALSE EQ InclSeasonN0) THEN kMortVegSumN0 ELSEIF (aVegWinN0 EQ TRUE AND aDaysVegWinN0 LE cLengMortN0 AND aDaysVegWinN0 GT 0) THEN - LN(fWinVegN0) / cLengMortN0 ELSE kMortVegSumN0 ENDIF;
akDIncrVegHypN0 = aMuTmLVegHypN0 - kDRespVegN0 * uFunTmRespVegN0 - bkMortVegN0;
tDEnvVegHypN0 = MAX(0.0, akDIncrVegHypN0 / (cDCarrVegN0+NearZeroN0) * aDVegN0*aDVegN0);
tDEnvProdVegHypN0 = aMuVegHypN0 / cMuMaxVegN0 * tDEnvVegHypN0;
tDProdVegHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE MAX(0.0, aMuVegHypN0 * uDVegHypN0 - tDEnvProdVegHypN0) ENDIF;
tDProdSubVegHypN0 = bfSubVegHypN0 * tDProdVegHypN0;
tDRespVegN0 = kDRespVegN0 * uFunTmRespVegN0 * aDVegN0;
tDEnvMortVegHypN0 = tDEnvVegHypN0 - tDEnvProdVegHypN0;
tDMortVegHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE bkMortVegN0 * uDVegHypN0 + tDEnvMortVegHypN0 ENDIF;
tDMortVegWHypN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tDMortVegHypN0;
tDGrazVegBirdN0 = IF ( (sTimeN0 GE cYearStartBirdsN0 * DaysPerYearN0) AND (DayN0 GE cDayStartBirdsN0) AND (DayN0 LE cDayEndBirdsN0) ) THEN cPrefVegBirdN0 * aDVegN0 / (hDVegBirdN0 + aDVegN0) * cBirdsPerhaN0 / m2PerhaN0 * cDGrazPerBirdN0 ELSE 0.0 ENDIF;
bkManVegN0 = IF ((DayN0 GE cDayManVeg1N0 AND DayN0 LT cDayManVeg1N0 + cLengManN0) OR (DayN0 GE cDayManVeg2N0 AND DayN0 LT cDayManVeg2N0 + cLengManN0)) THEN -LN(1.0 - fManVegN0) / cLengManN0 ELSE 0.0 ENDIF;
tDManVegN0 = bkManVegN0 * aDVegN0;
tPManVegN0 = rPDVegN0 * tDManVegN0;
tNManVegN0 = rNDVegN0 * tDManVegN0;
tO2ProdVegHypN0 = molO2molCN0 * cCPerDWN0 * tDProdVegHypN0;
tO2RespVegWHypN0 = molO2molCN0 * cCPerDWN0 * bfSubVegHypN0 * tDRespVegN0 * aCorO2BODHypN0;
aDepthOxySedN0 = IF(aInclStratN0 EQ TRUE AND (2.0 * oO2WHypN0 * akO2DifCorN0 / tSODN0) GT NearZeroN0 ) THEN POW((2.0 * oO2WHypN0 * akO2DifCorN0 / tSODN0) , (0.5)) ELSEIF ( aInclStratN0 EQ TRUE AND (2.0 * oO2WHypN0 * akO2DifCorN0 / tSODN0) LE NearZeroN0 ) THEN POW ( NearZeroN0 , (0.5)) ELSEIF ( aInclStratN0 EQ TRUE AND ( 2.0 * oO2WEpiN0 * akO2DifCorN0 / tSODN0 ) LE NearZeroN0 ) THEN POW ( NearZeroN0 , (0.5)) ELSE POW ( ( 2.0 * oO2WEpiN0 * akO2DifCorN0 / tSODN0 ) , (0.5)) ENDIF;
afOxySedN0 = aDepthOxySedN0 / cDepthSN0;
tO2RespVegSN0 = molO2molCN0 * cCPerDWN0 * bfRootVegN0 * tDRespVegN0 * afOxySedN0;
tO2ProdVegSHypN0 = MIN (tO2RespVegSN0, tO2ProdVegHypN0);
tO2ProdVegWHypN0 = MIN( tO2ProdVegHypN0 - tO2ProdVegSHypN0, bfSubVegN0 * tO2ProdVegHypN0);
tO2UptNO3VegWHypN0 = O2PerNO3N0 * molO2molNN0 * bfSubVegN0 * tNUptNO3VegWHypN0;
tO2UptNO3VegSN0 = O2PerNO3N0 * molO2molNN0 * tNUptNO3VegSN0;
tPExcrVegN0 = (rPDVegN0 *2.0)/ (cPDVegMaxN0 + rPDVegN0) * rPDVegN0 * tDRespVegN0;
tPExcrVegSN0 = bfRootVegN0 * tPExcrVegN0;
tPExcrVegWN0 = tPExcrVegN0 - tPExcrVegSN0;
tPMortVegHypN0 = rPDVegN0 * tDMortVegHypN0;
tPMortVegPO4HypN0 = fDissMortVegN0 * tPMortVegHypN0;
tPMortVegPO4SHypN0 = bfRootVegN0 * tPMortVegPO4HypN0;
tPMortVegPO4WHypN0 = tPMortVegPO4HypN0 - tPMortVegPO4SHypN0;
tPMortVegDetHypN0 = tPMortVegHypN0 - tPMortVegPO4HypN0;
tPMortVegDetWHypN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tPMortVegDetHypN0;
tPMortVegDetSHypN0 = tPMortVegDetHypN0 - tPMortVegDetWHypN0;
tPGrazVegBirdN0 = rPDVegN0 * tDGrazVegBirdN0;
tNExcrVegN0 = (2.0 * rNDVegN0) / (cNDVegMaxN0 + rNDVegN0) * rNDVegN0 * tDRespVegN0;
tNExcrVegSN0 = bfRootVegN0 * tNExcrVegN0;
tNExcrVegWN0 = tNExcrVegN0 - tNExcrVegSN0;
tNMortVegHypN0 = rNDVegN0 * tDMortVegHypN0;
tNMortVegNH4HypN0 = fDissMortVegN0 * tNMortVegHypN0;
tNMortVegNH4SHypN0 = IF (aInclStratN0 EQ TRUE ) THEN bfRootVegN0 * tNMortVegNH4HypN0 ELSE 0.0 ENDIF;
tNMortVegNH4WHypN0 = tNMortVegNH4HypN0 - tNMortVegNH4SHypN0;
tNMortVegDetHypN0 = tNMortVegHypN0 - tNMortVegNH4HypN0;
tNMortVegDetWHypN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tNMortVegDetHypN0;
tNMortVegDetSHypN0 = tNMortVegDetHypN0 - tNMortVegDetWHypN0;
tNGrazVegBirdN0 = rNDVegN0 * tDGrazVegBirdN0;
tDAssVegBirdN0 = fDAssBirdN0 * tDGrazVegBirdN0;
tDEgesBirdN0 = tDGrazVegBirdN0 - tDAssVegBirdN0;
tPAssVegBirdN0 = fDAssBirdN0 * tPGrazVegBirdN0;
tPEgesBirdN0 = tPGrazVegBirdN0 - tPAssVegBirdN0;
tPEgesBirdPO4N0 = fDissEgesBirdN0 * tPEgesBirdN0;
tPEgesBirdDetN0 = tPEgesBirdN0 - tPEgesBirdPO4N0;
tNAssVegBirdN0 = fDAssBirdN0 * tNGrazVegBirdN0;
tNEgesBirdN0 = tNGrazVegBirdN0 - tNAssVegBirdN0;
tNEgesBirdNH4N0 = fDissEgesBirdN0 * tNEgesBirdN0;
tNEgesBirdDetN0 = tNEgesBirdN0 - tNEgesBirdNH4N0;
wDBedDetWHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE) THEN (tDMortVegWHypN0) / uDepthWHypN0 ELSE 0.0 ENDIF;
aMuTmLVegEpiN0 = ufDayN0 * bfShootVegN0 * aLLimShootVegEpiN0 * uFunTmProdVegN0 * cMuMaxVegN0;
akDIncrVegEpiN0 = aMuTmLVegEpiN0 - kDRespVegN0 * uFunTmRespVegN0 - bkMortVegN0;
tDEnvVegEpiN0 = MAX(0.0, akDIncrVegEpiN0 / (cDCarrVegN0+NearZeroN0) * aDVegN0*aDVegN0);
aMuVegEpiN0 = aMuTmLVegEpiN0 * aNutLimVegN0;
tDEnvProdVegEpiN0 = aMuVegEpiN0 / cMuMaxVegN0 * tDEnvVegEpiN0;
tDProdVegEpiN0 = MAX(0.0, aMuVegEpiN0 * uDVegEpiN0 - tDEnvProdVegEpiN0);
tDEnvMortVegEpiN0 = tDEnvVegEpiN0 - tDEnvProdVegEpiN0;
tDMortVegEpiN0 = bkMortVegN0 * uDVegEpiN0 + tDEnvMortVegEpiN0;
tNMortVegEpiN0 = rNDVegN0 * tDMortVegEpiN0;
tNMortVegNH4EpiN0 = fDissMortVegN0 * tNMortVegEpiN0;
tNMortVegNH4SEpiN0 = bfRootVegN0 * tNMortVegNH4EpiN0;
wPBedPO4WHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE ) THEN (- tPUptVegWHypN0 + tPExcrVegWN0 * uVegHeightHypN0 / uVegHeightN0 + tPMortVegPO4WHypN0 ) /uDepthWHypN0 ELSE 0.0 ENDIF;
wPBedDetWHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE) THEN (tPMortVegDetWHypN0 ) / uDepthWHypN0 ELSE 0.0 ENDIF;
wNBedNH4WHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE ) THEN (- tNUptNH4VegWHypN0 + tNExcrVegWN0 * (uVegHeightHypN0 /uVegHeightN0 ) + tNMortVegNH4WHypN0 ) / uDepthWHypN0 ELSE 0.0 ENDIF;
wNBedNO3WHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE) THEN - tNUptNO3VegWHypN0 / uDepthWHypN0 ELSE 0.0 ENDIF;
wNBedDetWHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE) THEN (tNMortVegDetWHypN0 ) / uDepthWHypN0 ELSE 0.0 ENDIF;
tDMortVegSHypN0 = tDMortVegHypN0 - tDMortVegWHypN0;
tDBedDetSHypN0 = IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE ) THEN tDMortVegSHypN0 ELSE 0.0 ENDIF;
tO2BedWHypN0 =IF (aInclStratN0 EQ TRUE AND InclVegN0 EQ TRUE ) THEN tO2ProdVegWHypN0 - tO2RespVegWHypN0 + tO2UptNO3VegWHypN0 ELSE 0.0 ENDIF;
UseLossN0 = IF (InclWebN0 EQ TRUE) THEN 0.0 ELSE 1.0 ENDIF;
uFunTmLossHypN0 = EXP(-0.5/(cSigTmLossN0*cSigTmLossN0) *((uTmHypN0-cTmOptLossN0)*(uTmHypN0-cTmOptLossN0) -(cTmRefN0-cTmOptLossN0)*(cTmRefN0-cTmOptLossN0)));
uFunTmLossEpiN0 = EXP(-0.5/(cSigTmLossN0*cSigTmLossN0) *((uTmEpiN0-cTmOptLossN0)*(uTmEpiN0-cTmOptLossN0) -(cTmRefN0-cTmOptLossN0)*(cTmRefN0-cTmOptLossN0)));
rPDBlueWHypN0 = oPBlueWHypN0 /(oDBlueWHypN0+NearZeroN0);
rNDBlueWHypN0 = oNBlueWHypN0 /(oDBlueWHypN0+NearZeroN0);
rPDBlueSN0 = aPBlueSN0 /(aDBlueSN0+NearZeroN0);
rNDBlueSN0 = aNBlueSN0 /(aDBlueSN0+NearZeroN0);
uFunTmBlueHypN0 = EXP(-0.5/(cSigTmBlueN0*cSigTmBlueN0) *((uTmHypN0-cTmOptBlueN0)*(uTmHypN0-cTmOptBlueN0) - (cTmRefN0-cTmOptBlueN0)*(cTmRefN0-cTmOptBlueN0)));
uFunTmProdBlueHypN0 = uFunTmBlueHypN0;
uFunTmRespBlueHypN0 = uFunTmBlueHypN0;
uFunTmBlueEpiN0 = EXP(-0.5/(cSigTmBlueN0*cSigTmBlueN0) *((uTmEpiN0-cTmOptBlueN0)*(uTmEpiN0-cTmOptBlueN0) - (cTmRefN0-cTmOptBlueN0)*(cTmRefN0-cTmOptBlueN0)));
uFunTmProdBlueEpiN0 = uFunTmBlueEpiN0;
uFunTmRespBlueEpiN0 = uFunTmBlueEpiN0;
uFunTmBlueSN0 = EXP(-0.5/(cSigTmBlueN0*cSigTmBlueN0) *((uTmBotN0-cTmOptBlueN0)*(uTmBotN0-cTmOptBlueN0) - (cTmRefN0-cTmOptBlueN0)*(cTmRefN0-cTmOptBlueN0)));
uFunTmRespBlueSN0 = uFunTmBlueSN0;
uFunTmBlueSurfN0 = EXP(-0.5/(cSigTmBlueN0*cSigTmBlueN0) *((uTmSurfN0-cTmOptBlueN0)*(uTmSurfN0-cTmOptBlueN0) - (cTmRefN0-cTmOptBlueN0)*(cTmRefN0-cTmOptBlueN0)));
uFunTmProdBlueSurfN0 = uFunTmBlueSurfN0;
uFunTmRespBlueSurfN0 = uFunTmBlueSurfN0;
aLPARAveSurfN0 = MAX(0.0,(uLPARSurfN0 - aLPARBotSurfN0)/aExtSurfN0);
aLPARAveEpiN0 = (aLPARBotSurfN0 - aLPARBotEpiN0)/ (aExtCoefOpenEpiN0 * uDepthWEpiN0);
aLPARAveHypN0 = (aLPARBotEpiOpenN0 -aLPARBotHypN0)/ (aExtCoefOpenHypN0 * uDepthWEpiN0);
aAuxNfixLSurfN0 = cAlphNfixN0 * aLPARAveSurfN0 ;
aAuxNfixLEpiN0 = cAlphNfixN0 * aLPARAveEpiN0;
aAuxNfixLHypN0 = cAlphNfixN0 * aLPARAveHypN0;
rNfixBlueSurfN0 = cNfixMaxBlueN0 - cNfixMaxBlueN0 * EXP(- aAuxNfixLSurfN0) + cNfixDarkBlueN0;
rNfixBlueEpiN0 = cNfixMaxBlueN0 - cNfixMaxBlueN0 * EXP(- aAuxNfixLEpiN0) + cNfixDarkBlueN0;
rNfixBlueHypN0 = cNfixMaxBlueN0 - cNfixMaxBlueN0 * EXP(- aAuxNfixLHypN0) + cNfixDarkBlueN0;
aVPUptMaxCrBlueHypN0 = MAX(0.0,cVPUptMaxBlueN0 * uFunTmProdBlueHypN0 *(cPDBlueMaxN0 - rPDBlueWHypN0) /(cPDBlueMaxN0 - cPDBlueMinN0));
aVPUptBlueHypN0 = oPO4WHypN0 * aVPUptMaxCrBlueHypN0 /(aVPUptMaxCrBlueHypN0 / cAffPUptBlueN0 + oPO4WHypN0);
wPUptBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVPUptBlueHypN0 * oDBlueWHypN0 ENDIF;
aVNUptMaxCrBlueHypN0 = MAX(0.0,cVNUptMaxBlueN0 * uFunTmProdBlueHypN0 * (cNDBlueMaxN0 - rNDBlueWHypN0) /(cNDBlueMaxN0 - cNDBlueMinN0));
ahNUptBlueHypN0 = aVNUptMaxCrBlueHypN0 / cAffNUptBlueN0;
aVNUptBlueHypN0 = oNDissWHypN0 * aVNUptMaxCrBlueHypN0 /(ahNUptBlueHypN0 + oNDissWHypN0);
wNUptBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVNUptBlueHypN0 * oDBlueWHypN0 ENDIF;
tNUptBlueHypN0 = wNUptBlueHypN0 * uDepthWHypN0;
afNH4UptBlueHypN0 = oNH4WHypN0 * oNO3WHypN0 /((ahNUptBlueHypN0 + oNH4WHypN0) *(ahNUptBlueHypN0 + oNO3WHypN0)) + oNH4WHypN0 * ahNUptBlueHypN0 /((oNH4WHypN0 + oNO3WHypN0) *(ahNUptBlueHypN0 + oNO3WHypN0));
uMuMaxTmBlueHypN0 = cMuMaxBlueN0 * uFunTmProdBlueHypN0;
uMuMaxTmBlueEpiN0 = cMuMaxBlueN0 * uFunTmProdBlueEpiN0;
aPLimBlueHypN0 = MAX(0.0,(1.0 - cPDBlueMinN0 / rPDBlueWHypN0) * cPDBlueMaxN0 /(cPDBlueMaxN0 - cPDBlueMinN0));
aNLimBlueHypN0 = MAX(0.0,(1.0 - cNDBlueMinN0 / rNDBlueWHypN0) * cNDBlueMaxN0 /(cNDBlueMaxN0 - cNDBlueMinN0));
aSiLimBlueHypN0 = oSiO2WHypN0 /(hSiAssBlueN0 + oSiO2WHypN0);
aLLimBlueHypN0 = UseSteeleBlueN0 *(EXP(1.0) /(aExtCoefHypN0 * uDepthWHypN0) *(EXP(- aLPARBotHypN0 /(cLOptRefBlueN0 * uFunTmProdBlueHypN0)) - EXP(- uLPARSurfHypN0 /(cLOptRefBlueN0 * uFunTmProdBlueHypN0)))) +(1.0 - UseSteeleBlueN0) *(1.0 /(aExtCoefHypN0 * uDepthWHypN0) * LN((1.0 + uLPARSurfHypN0 / (hLRefBlueN0 * uFunTmProdBlueHypN0)) / (1.0 + aLPARBotHypN0 /(hLRefBlueN0 * uFunTmProdBlueHypN0))));
aMuTmLBlueHypN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimBlueHypN0 * uMuMaxTmBlueHypN0;
aNutLimBlueHypN0 = MIN(aPLimBlueHypN0,(MIN(aNLimBlueHypN0,aSiLimBlueHypN0)));
aMuBlueHypN0 = aNutLimBlueHypN0 * aMuTmLBlueHypN0;
wDAssBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aMuBlueHypN0*oDBlueWHypN0 ENDIF;
rChDBlueHypN0 = cChDBlueMaxN0 -(cChDBlueMaxN0 - cChDBlueMinN0) * aLLimBlueHypN0;
oChlaBlueHypN0 = mgPergN0 * rChDBlueHypN0 * oDBlueWHypN0;
aChlaBlueHypN0 = mgPergN0 * rChDBlueHypN0 * aDBlueWHypN0;
aExtChBlueHypN0 = cExtSpBlueN0 / rChDBlueHypN0;
aNfixBlueHypN0  = rNfixBlueHypN0 *aChlaBlueHypN0 /ugPergN0;
tNUptBlueAirHypN0 = IF (InclNfixN0 EQ FALSE) THEN 0.0 ELSE aNfixBlueHypN0 ENDIF;
tNUptBlueWHypN0 = IF (InclNfixN0 EQ FALSE) THEN tNUptBlueHypN0 ELSE tNUptBlueHypN0 - tNUptBlueAirHypN0 ENDIF;
wNUptBlueWHypN0 = tNUptBlueWHypN0 / uDepthWHypN0;
ukDRespTmBlueHypN0 = kDRespBlueN0 * uFunTmRespBlueHypN0;
wNUptNH4BlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE afNH4UptBlueHypN0 * wNUptBlueWHypN0 ENDIF;
wNUptNO3BlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptBlueWHypN0 - wNUptNH4BlueHypN0 ENDIF;
ukDRespTmBlueEpiN0 = kDRespBlueN0 * uFunTmRespBlueEpiN0;
ukDRespTmBlueSN0 = kDRespBlueN0 * uFunTmRespBlueSN0;
wDRespBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukDRespTmBlueHypN0 * oDBlueWHypN0 ENDIF;
ukDRespTmBlueSurfN0 = kDRespBlueN0 * uFunTmRespBlueSurfN0;
ukLossTmBlueHypN0 = UseLossN0 * kLossBlueN0 * uFunTmLossHypN0;
ukLossTmBlueEpiN0 = UseLossN0 * kLossBlueN0 * uFunTmLossEpiN0;
wDLossBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukLossTmBlueHypN0 * oDBlueWHypN0 ENDIF;
wDMortBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortBlueWN0 * oDBlueWHypN0 ENDIF;
uCorVSetBlueHypN0 = (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMHypN0 * uFunTmSetHypN0;
tDResusBlueN0 = aDBlueSN0 /(aDPhytSN0+NearZeroN0) * tDResusPhytTotN0;
tDRespBlueSN0 = ukDRespTmBlueSN0 * aDBlueSN0;
tDMortBlueSN0 = kMortBlueSN0 * aDBlueSN0;
ukDDecBlueHypN0 = ukDRespTmBlueHypN0 + ukLossTmBlueHypN0 + kMortBlueWN0 +(uCorVSetBlueHypN0 * uFunTmSetHypN0) / uDepthWHypN0;
wPExcrBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (rPDBlueWHypN0 * 2.0 )/(cPDBlueMaxN0 + rPDBlueWHypN0) * rPDBlueWHypN0 * wDRespBlueWHypN0 ENDIF;
wPLossBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN0 * wDLossBlueHypN0 ENDIF;
wPMortBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortBlueWN0 * oPBlueWHypN0 ENDIF;
tPResusBlueN0 = rPDBlueSN0 * tDResusBlueN0;
tPExcrBlueSN0 = (rPDBlueSN0 *2.0)/(cPDBlueMaxN0 + rPDBlueSN0) * rPDBlueSN0 * tDRespBlueSN0;
tPMortBlueSN0 = kMortBlueSN0 * aPBlueSN0;
wNExcrBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (rNDBlueWHypN0 *2.0)/(cNDBlueMaxN0 + rNDBlueWHypN0) * rNDBlueWHypN0 * wDRespBlueWHypN0 ENDIF;
wNLossBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN0 * wDLossBlueHypN0 ENDIF;
wNMortBlueWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortBlueWN0 * oNBlueWHypN0 ENDIF;
tNResusBlueN0 = rNDBlueSN0 * tDResusBlueN0;
tNExcrBlueSN0 = (2.0 * rNDBlueSN0) /(cNDBlueMaxN0 + rNDBlueSN0) * rNDBlueSN0 * tDRespBlueSN0;
tNMortBlueSN0 = kMortBlueSN0 * aNBlueSN0;
aFunTauSetOMEpiN0 = MIN(1.0 / POW(aFunDimSuspN0 +NearZeroN0 , (0.5)), 1.0);
aFunTauSetIMEpiN0 = aFunTauSetOMEpiN0;
uCorVSetBlueEpiN0 = (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMEpiN0 * uFunTmSetEpiN0;
rNDGrenWHypN0 = oNGrenWHypN0 /(oDGrenWHypN0+NearZeroN0);
rPDGrenSN0 = aPGrenSN0 /(aDGrenSN0+NearZeroN0);
rNDGrenSN0 = aNGrenSN0 /(aDGrenSN0+NearZeroN0);
uFunTmGrenHypN0 = EXP(-0.5/(cSigTmGrenN0*cSigTmGrenN0) *((uTmHypN0-cTmOptGrenN0)*(uTmHypN0-cTmOptGrenN0) - (cTmRefN0-cTmOptGrenN0)*(cTmRefN0-cTmOptGrenN0)));
uFunTmGrenEpiN0 = EXP(-0.5/(cSigTmGrenN0*cSigTmGrenN0) *((uTmEpiN0-cTmOptGrenN0)*(uTmEpiN0-cTmOptGrenN0) - (cTmRefN0-cTmOptGrenN0)*(cTmRefN0-cTmOptGrenN0)));
uFunTmGrenSN0 = EXP(-0.5/(cSigTmGrenN0*cSigTmGrenN0) *((uTmBotN0-cTmOptGrenN0)*(uTmBotN0-cTmOptGrenN0) - (cTmRefN0-cTmOptGrenN0)*(cTmRefN0-cTmOptGrenN0)));
uFunTmProdGrenHypN0 = uFunTmGrenHypN0;
uFunTmRespGrenHypN0 = uFunTmGrenHypN0;
uFunTmProdGrenEpiN0 = uFunTmGrenEpiN0;
uFunTmRespGrenEpiN0 = uFunTmGrenEpiN0;
uFunTmRespGrenSN0 = uFunTmGrenSN0;
aVNUptMaxCrGrenHypN0 = MAX(0.0,cVNUptMaxGrenN0 * uFunTmProdGrenHypN0 * (cNDGrenMaxN0 - rNDGrenWHypN0) /(cNDGrenMaxN0 - cNDGrenMinN0));
ahNUptGrenHypN0 = aVNUptMaxCrGrenHypN0 / cAffNUptGrenN0;
aVNUptGrenHypN0 = oNDissWHypN0 * aVNUptMaxCrGrenHypN0 /(ahNUptGrenHypN0 + oNDissWHypN0);
wNUptGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVNUptGrenHypN0 * oDGrenWHypN0 ENDIF;
afNH4UptGrenHypN0 = oNH4WHypN0 * oNO3WHypN0 /((ahNUptGrenHypN0 + oNH4WHypN0) *(ahNUptGrenHypN0 + oNO3WHypN0)) + oNH4WHypN0 * ahNUptGrenHypN0 /((oNH4WHypN0 + oNO3WHypN0) *(ahNUptGrenHypN0 + oNO3WHypN0));
wNUptNH4GrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE afNH4UptGrenHypN0 * wNUptGrenHypN0 ENDIF;
wNUptNO3GrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN0 - wNUptNH4GrenHypN0 ENDIF;
uMuMaxTmGrenHypN0 = cMuMaxGrenN0 * uFunTmProdGrenHypN0;
uMuMaxTmGrenEpiN0 = cMuMaxGrenN0 * uFunTmProdGrenEpiN0;
aNLimGrenHypN0 = MAX(0.0,(1.0 - cNDGrenMinN0 / rNDGrenWHypN0) * cNDGrenMaxN0 /(cNDGrenMaxN0 - cNDGrenMinN0));
aSiLimGrenHypN0 = oSiO2WHypN0 /(hSiAssGrenN0 + oSiO2WHypN0);
aLLimGrenHypN0 = UseSteeleGrenN0 *(EXP(1.0) /(aExtCoefHypN0 * uDepthWHypN0) *(EXP(- aLPARBotHypN0 /(cLOptRefGrenN0 * uFunTmProdGrenHypN0)) - EXP(- uLPARSurfHypN0 /(cLOptRefGrenN0 * uFunTmProdGrenHypN0)))) +(1.0 - UseSteeleGrenN0) *(1.0 /(aExtCoefHypN0 * uDepthWHypN0) * LN((1.0 + uLPARSurfHypN0 / (hLRefGrenN0 * uFunTmProdGrenHypN0)) / (1.0 + aLPARBotHypN0 /(hLRefGrenN0 * uFunTmProdGrenHypN0))));
aMuTmLGrenHypN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimGrenHypN0 * uMuMaxTmGrenHypN0;
rChDGrenHypN0 = cChDGrenMaxN0 -(cChDGrenMaxN0 - cChDGrenMinN0) * aLLimGrenHypN0;
oChlaGrenHypN0 = mgPergN0 * rChDGrenHypN0 * oDGrenWHypN0;
aExtChGrenHypN0 = cExtSpGrenN0 / rChDGrenHypN0;
ukDRespTmGrenHypN0 = kDRespGrenN0 * uFunTmRespGrenHypN0;
ukDRespTmGrenEpiN0 = kDRespGrenN0 * uFunTmRespGrenEpiN0;
ukDRespTmGrenSN0 = kDRespGrenN0 * uFunTmRespGrenSN0;
wDRespGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukDRespTmGrenHypN0 * oDGrenWHypN0 ENDIF;
ukLossTmGrenHypN0 = UseLossN0 * kLossGrenN0 * uFunTmLossHypN0;
ukLossTmGrenEpiN0 = UseLossN0 * kLossGrenN0 * uFunTmLossEpiN0;
wDLossGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukLossTmGrenHypN0 * oDGrenWHypN0 ENDIF;
wDMortGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortGrenWN0 * oDGrenWHypN0 ENDIF;
uCorVSetGrenHypN0 = (cVSetGrenN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMHypN0 * uFunTmSetHypN0;
tDSetGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE uCorVSetGrenHypN0 * oDGrenWHypN0 ENDIF;
tDResusGrenN0 = aDGrenSN0 /(aDPhytSN0+NearZeroN0) * tDResusPhytTotN0;
tDRespGrenSN0 = ukDRespTmGrenSN0 * aDGrenSN0;
tDMortGrenSN0 = kMortGrenSN0 * aDGrenSN0;
ukDDecGrenHypN0 = ukDRespTmGrenHypN0 + ukLossTmGrenHypN0 + kMortGrenWN0 +(uCorVSetGrenHypN0 * uFunTmSetHypN0) / uDepthWHypN0;
wPMortGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortGrenWN0 * oPGrenWHypN0 ENDIF;
tPResusGrenN0 = rPDGrenSN0 * tDResusGrenN0;
tPExcrGrenSN0 = (2.0 * rPDGrenSN0) /(cPDGrenMaxN0 + rPDGrenSN0) * rPDGrenSN0 * tDRespGrenSN0;
tPMortGrenSN0 = kMortGrenSN0 * aPGrenSN0;
wNExcrGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDGrenWHypN0) /(cNDGrenMaxN0 + rNDGrenWHypN0) * rNDGrenWHypN0 * wDRespGrenWHypN0 ENDIF;
wNLossGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN0 * wDLossGrenHypN0 ENDIF;
wNMortGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortGrenWN0 * oNGrenWHypN0 ENDIF;
tNSetGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN0 * tDSetGrenHypN0 ENDIF;
tNResusGrenN0 = rNDGrenSN0 * tDResusGrenN0;
tNExcrGrenSN0 = (2.0 * rNDGrenSN0) /(cNDGrenMaxN0 + rNDGrenSN0) * rNDGrenSN0 * tDRespGrenSN0;
tNMortGrenSN0 = kMortGrenSN0 * aNGrenSN0;
uCorVSetGrenEpiN0 = (cVSetGrenN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMEpiN0 * uFunTmSetEpiN0;
tDSetGrenEpiN0 = uCorVSetGrenEpiN0 * oDGrenWEpiN0;
rNDGrenWEpiN0 = oNGrenWEpiN0 /(oDGrenWEpiN0+NearZeroN0);
tNSetGrenEpiN0 = rNDGrenWEpiN0 * tDSetGrenEpiN0;
rPDGrenWEpiN0 = oPGrenWEpiN0 /(oDGrenWEpiN0+NearZeroN0);
tPSetGrenEpiN0 = rPDGrenWEpiN0 * tDSetGrenEpiN0;
wNPrimGrenWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN0 - wNExcrGrenWHypN0 - wNLossGrenHypN0 - wNMortGrenWHypN0 -(tNSetGrenHypN0 -tNSetGrenEpiN0 - tNResusGrenN0) / uDepthWHypN0 ENDIF;
rPDDiatWHypN0 = oPDiatWHypN0 /(oDDiatWHypN0+NearZeroN0);
rNDDiatWHypN0 = oNDiatWHypN0 /(oDDiatWHypN0+NearZeroN0);
rPDDiatSN0 = aPDiatSN0 /(aDDiatSN0+NearZeroN0);
uFunTmDiatHypN0 = EXP(-0.5/(cSigTmDiatN0*cSigTmDiatN0) *((uTmHypN0-cTmOptDiatN0)*(uTmHypN0-cTmOptDiatN0) - (cTmRefN0-cTmOptDiatN0)*(cTmRefN0-cTmOptDiatN0)));
rNDDiatSN0 = aNDiatSN0 /(aDDiatSN0+NearZeroN0);
uFunTmDiatEpiN0 = EXP(-0.5/(cSigTmDiatN0*cSigTmDiatN0) *((uTmEpiN0-cTmOptDiatN0)*(uTmEpiN0-cTmOptDiatN0) - (cTmRefN0-cTmOptDiatN0)*(cTmRefN0-cTmOptDiatN0)));
uFunTmDiatSN0 = EXP(-0.5/(cSigTmDiatN0*cSigTmDiatN0) *((uTmBotN0-cTmOptDiatN0)*(uTmBotN0-cTmOptDiatN0) - (cTmRefN0-cTmOptDiatN0)*(cTmRefN0-cTmOptDiatN0)));
uFunTmProdDiatHypN0 = uFunTmDiatHypN0;
uFunTmRespDiatHypN0 = uFunTmDiatHypN0;
uFunTmProdDiatEpiN0 = uFunTmDiatEpiN0;
uFunTmRespDiatEpiN0 = uFunTmDiatEpiN0;
uFunTmRespDiatSN0 = uFunTmDiatSN0;
aVPUptMaxCrDiatHypN0 = MAX(0.0,cVPUptMaxDiatN0 * uFunTmProdDiatHypN0 *(cPDDiatMaxN0 - rPDDiatWHypN0) /(cPDDiatMaxN0 - cPDDiatMinN0));
aVPUptDiatHypN0 = oPO4WHypN0 * aVPUptMaxCrDiatHypN0 /(aVPUptMaxCrDiatHypN0 / cAffPUptDiatN0 + oPO4WHypN0);
wPUptDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVPUptDiatHypN0 * oDDiatWHypN0 ENDIF;
aVNUptMaxCrDiatHypN0 = MAX(0.0,cVNUptMaxDiatN0 * uFunTmProdDiatHypN0 * (cNDDiatMaxN0 - rNDDiatWHypN0) /(cNDDiatMaxN0 - cNDDiatMinN0));
ahNUptDiatHypN0 = aVNUptMaxCrDiatHypN0 / cAffNUptDiatN0;
aVNUptDiatHypN0 = oNDissWHypN0 * aVNUptMaxCrDiatHypN0 /(ahNUptDiatHypN0 + oNDissWHypN0);
wNUptDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVNUptDiatHypN0 * oDDiatWHypN0 ENDIF;
afNH4UptDiatHypN0 = oNH4WHypN0 * oNO3WHypN0 /((ahNUptDiatHypN0 + oNH4WHypN0) *(ahNUptDiatHypN0 + oNO3WHypN0)) + oNH4WHypN0 * ahNUptDiatHypN0 /((oNH4WHypN0 + oNO3WHypN0) *(ahNUptDiatHypN0 + oNO3WHypN0));
wNUptNH4DiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE afNH4UptDiatHypN0 * wNUptDiatHypN0 ENDIF;
wNUptNO3DiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN0 - wNUptNH4DiatHypN0 ENDIF;
uMuMaxTmDiatHypN0 = cMuMaxDiatN0 * uFunTmProdDiatHypN0;
uMuMaxTmDiatEpiN0 = cMuMaxDiatN0 * uFunTmProdDiatEpiN0;
aPLimDiatHypN0 = MAX(0.0,(1.0 - cPDDiatMinN0 / rPDDiatWHypN0) * cPDDiatMaxN0 /(cPDDiatMaxN0 - cPDDiatMinN0));
aNLimDiatHypN0 = MAX(0.0,(1.0 - cNDDiatMinN0 / rNDDiatWHypN0) * cNDDiatMaxN0 /(cNDDiatMaxN0 - cNDDiatMinN0));
aSiLimDiatHypN0 = oSiO2WHypN0 /(hSiAssDiatN0 + oSiO2WHypN0);
aLLimDiatHypN0 = UseSteeleDiatN0 *(EXP(1.0) /(aExtCoefHypN0 * uDepthWHypN0) *(EXP(- aLPARBotHypN0 /(cLOptRefDiatN0 * uFunTmProdDiatHypN0)) - EXP(- uLPARSurfHypN0 /(cLOptRefDiatN0 * uFunTmProdDiatHypN0)))) +(1.0 - UseSteeleDiatN0) *(1.0 /(aExtCoefHypN0 * uDepthWHypN0) * LN((1.0 + uLPARSurfHypN0 / (hLRefDiatN0 * uFunTmProdDiatHypN0)) / (1.0 + aLPARBotHypN0 /(hLRefDiatN0 * uFunTmProdDiatHypN0))));
aMuTmLDiatHypN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimDiatHypN0 * uMuMaxTmDiatHypN0;
aNutLimDiatHypN0 = MIN(aPLimDiatHypN0,(MIN(aNLimDiatHypN0,aSiLimDiatHypN0)));
aMuDiatHypN0 = aNutLimDiatHypN0 * aMuTmLDiatHypN0;
wDAssDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aMuDiatHypN0*oDDiatWHypN0 ENDIF;
rChDDiatHypN0 = cChDDiatMaxN0 -(cChDDiatMaxN0 - cChDDiatMinN0) * aLLimDiatHypN0;
oChlaDiatHypN0 = mgPergN0 * rChDDiatHypN0 * oDDiatWHypN0;
aExtChDiatHypN0 = cExtSpDiatN0 / rChDDiatHypN0;
ukDRespTmDiatHypN0 = kDRespDiatN0 * uFunTmRespDiatHypN0;
ukDRespTmDiatEpiN0 = kDRespDiatN0 * uFunTmRespDiatEpiN0;
ukDRespTmDiatSN0 = kDRespDiatN0 * uFunTmRespDiatSN0;
wDRespDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukDRespTmDiatHypN0 * oDDiatWHypN0 ENDIF;
ukLossTmDiatHypN0 = UseLossN0 * kLossDiatN0 * uFunTmLossHypN0;
ukLossTmDiatEpiN0 = UseLossN0 * kLossDiatN0 * uFunTmLossEpiN0;
wDLossDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE ukLossTmDiatHypN0 * oDDiatWHypN0 ENDIF;
wDMortDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortDiatWN0 * oDDiatWHypN0 ENDIF;
uCorVSetDiatHypN0 = (cVSetDiatN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMHypN0 * uFunTmSetHypN0;
tDSetDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE uCorVSetDiatHypN0 * oDDiatWHypN0 ENDIF;
tDResusDiatN0 = aDDiatSN0 /(aDPhytSN0+NearZeroN0) * tDResusPhytTotN0;
tDRespDiatSN0 = ukDRespTmDiatSN0 * aDDiatSN0;
tDMortDiatSN0 = kMortDiatSN0 * aDDiatSN0;
ukDDecDiatHypN0 = ukDRespTmDiatHypN0 + ukLossTmDiatHypN0 + kMortDiatWN0 +(uCorVSetDiatHypN0 * uFunTmSetHypN0) / uDepthWHypN0;
wPExcrDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (2.0 * rPDDiatWHypN0) /(cPDDiatMaxN0 + rPDDiatWHypN0) * rPDDiatWHypN0 * wDRespDiatWHypN0 ENDIF;
wPLossDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN0 * wDLossDiatHypN0 ENDIF;
wPMortDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortDiatWN0 * oPDiatWHypN0 ENDIF;
tPSetDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN0 * tDSetDiatHypN0 ENDIF;
tPResusDiatN0 = rPDDiatSN0 * tDResusDiatN0;
tPExcrDiatSN0 = (2.0 * rPDDiatSN0) /(cPDDiatMaxN0 + rPDDiatSN0) * rPDDiatSN0 * tDRespDiatSN0;
tPMortDiatSN0 = kMortDiatSN0 * aPDiatSN0;
wNExcrDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDDiatWHypN0) /(cNDDiatMaxN0 + rNDDiatWHypN0) * rNDDiatWHypN0 * wDRespDiatWHypN0 ENDIF;
wNLossDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN0 * wDLossDiatHypN0 ENDIF;
wNMortDiatWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortDiatWN0 * oNDiatWHypN0 ENDIF;
tNSetDiatHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN0 * tDSetDiatHypN0 ENDIF;
tNResusDiatN0 = rNDDiatSN0 * tDResusDiatN0;
tNExcrDiatSN0 = (2.0 * rNDDiatSN0) /(cNDDiatMaxN0 + rNDDiatSN0) * rNDDiatSN0 * tDRespDiatSN0;
tNMortDiatSN0 = kMortDiatSN0 * aNDiatSN0;
uCorVSetDiatEpiN0 = (cVSetDiatN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0)  * aFunTauSetOMEpiN0 * uFunTmSetEpiN0;
tDSetDiatEpiN0 = uCorVSetDiatEpiN0 * oDDiatWEpiN0;
rPDDiatWEpiN0 = oPDiatWEpiN0 /(oDDiatWEpiN0+NearZeroN0);
tPSetDiatEpiN0 = rPDDiatWEpiN0 * tDSetDiatEpiN0;
rNDDiatWEpiN0 = oNDiatWEpiN0 /(oDDiatWEpiN0+NearZeroN0);
tNSetDiatEpiN0 = rNDDiatWEpiN0 * tDSetDiatEpiN0;
wDPrimDiatWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wDAssDiatHypN0 - wDRespDiatWHypN0 - wDLossDiatHypN0 - wDMortDiatWHypN0 -(tDSetDiatHypN0 - tDSetDiatEpiN0 - tDResusDiatN0) / uDepthWHypN0 ENDIF;
wPPrimDiatWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wPUptDiatHypN0 - wPExcrDiatWHypN0 - wPLossDiatHypN0 - wPMortDiatWHypN0 -(tPSetDiatHypN0 -tPSetDiatEpiN0 - tPResusDiatN0) / uDepthWHypN0 ENDIF;
wNPrimDiatWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN0 - wNExcrDiatWHypN0 - wNLossDiatHypN0 - wNMortDiatWHypN0 -(tNSetDiatHypN0 - tNSetDiatEpiN0 - tNResusDiatN0) / uDepthWHypN0 ENDIF;
oChlaHypN0 = oChlaDiatHypN0 + oChlaGrenHypN0 + oChlaBlueHypN0;
wDRespPhytWHypN0 = wDRespDiatWHypN0 + wDRespGrenWHypN0 + wDRespBlueWHypN0;
wDMortPhytWHypN0 = wDMortDiatWHypN0 + wDMortGrenWHypN0 + wDMortBlueWHypN0;
wDLossPhytHypN0 = wDLossDiatHypN0 + wDLossGrenHypN0 + wDLossBlueHypN0;
wPMortPhytWHypN0 = wPMortDiatWHypN0 + wPMortGrenWHypN0 + wPMortBlueWHypN0;
tPResusPhytN0 = tPResusDiatN0 + tPResusGrenN0 + tPResusBlueN0;
wNUptPhytHypN0 = wNUptDiatHypN0 + wNUptGrenHypN0 + wNUptBlueHypN0;
wNUptNH4PhytHypN0 = wNUptNH4DiatHypN0 + wNUptNH4GrenHypN0 + wNUptNH4BlueHypN0;
wNUptNO3PhytHypN0 = wNUptNO3DiatHypN0 + wNUptNO3GrenHypN0 + wNUptNO3BlueHypN0;
wNExcrPhytWHypN0 = wNExcrDiatWHypN0 + wNExcrGrenWHypN0 + wNExcrBlueWHypN0;
wNMortPhytWHypN0 = wNMortDiatWHypN0 + wNMortGrenWHypN0 + wNMortBlueWHypN0;
tNResusPhytN0 = tNResusDiatN0 + tNResusGrenN0 + tNResusBlueN0;
wNLossPhytHypN0 = wNLossDiatHypN0 + wNLossGrenHypN0 + wNLossBlueHypN0;
tDRespPhytSN0 = tDRespDiatSN0 + tDRespGrenSN0 + tDRespBlueSN0;
tDMortPhytSN0 = tDMortDiatSN0 + tDMortGrenSN0 + tDMortBlueSN0;
tPExcrPhytSN0 = tPExcrDiatSN0 + tPExcrGrenSN0 + tPExcrBlueSN0;
tPMortPhytSN0 = tPMortDiatSN0 + tPMortGrenSN0 + tPMortBlueSN0;
tNExcrPhytSN0 = tNExcrDiatSN0 + tNExcrGrenSN0 + tNExcrBlueSN0;
tNMortPhytSN0 = tNMortDiatSN0 + tNMortGrenSN0 + tNMortBlueSN0;
wSiUptDiatHypN0 = cSiDDiatN0 * wDAssDiatHypN0;
wSiExcrDiatWHypN0 = cSiDDiatN0 * wDRespDiatWHypN0 ;
wSiLossDiatHypN0 = cSiDDiatN0 * wDLossDiatHypN0;
wSiMortDiatWHypN0 = cSiDDiatN0 * wDMortDiatWHypN0;
tSiSetDiatHypN0 = cSiDDiatN0 * tDSetDiatHypN0;
tSiResusDiatN0 = cSiDDiatN0 * tDResusDiatN0 ;
rCyDBlueHypN0 = cCyDBlueMaxN0 -(cCyDBlueMaxN0 - cCyDBlueMinN0) * aLLimBlueHypN0;
oCyanHypN0 = rCyDBlueHypN0 * oDBlueWHypN0 * mgPergN0;
fDDiatHypN0 = oDDiatWHypN0 /(oDDiatWHypN0 + oDGrenWHypN0 + oDBlueWHypN0 + NearZeroN0);
wDPrimDetWHypN0 = wDMortPhytWHypN0 + wDLossPhytHypN0;
wO2RespPhytWHypN0 = molO2molCN0 * cCPerDWN0 * wDRespPhytWHypN0 * aCorO2BODHypN0;
wO2UptNO3PhytHypN0 = O2PerNO3N0 * molO2molNN0 * wNUptNO3PhytHypN0;
wPMortPhytPO4WHypN0 = fDissMortPhytN0 * wPMortPhytWHypN0;
wPMortPhytDetWHypN0 = wPMortPhytWHypN0 - wPMortPhytPO4WHypN0;
tPMortPhytPO4SN0 = fDissMortPhytN0 * tPMortPhytSN0;
tPMortPhytDetSN0 = tPMortPhytSN0 - tPMortPhytPO4SN0;
tPPrimPO4SN0 = tPExcrPhytSN0 + tPMortPhytPO4SN0;
tPPrimTotTN0 = 0.0;
wNMortPhytNH4WHypN0 = fDissMortPhytN0 * wNMortPhytWHypN0;
wNMortPhytDetWHypN0 = wNMortPhytWHypN0 - wNMortPhytNH4WHypN0;
wNLossPhytNH4HypN0 = fDissLossN0 * wNLossPhytHypN0;
wNLossPhytDetHypN0 = wNLossPhytHypN0 - wNLossPhytNH4HypN0;
wNPrimNH4WHypN0 = - wNUptNH4PhytHypN0 + wNExcrPhytWHypN0 + wNLossPhytNH4HypN0 + wNMortPhytNH4WHypN0;
wNPrimNO3WHypN0 = - wNUptNO3PhytHypN0;
wNPrimDetWHypN0 = wNLossPhytDetHypN0 + wNMortPhytDetWHypN0;
tNMortPhytNH4SN0 = fDissMortPhytN0 * tNMortPhytSN0;
tNMortPhytDetSN0 = tNMortPhytSN0 - tNMortPhytNH4SN0;
tNPrimNH4SN0 = tNExcrPhytSN0 + tNMortPhytNH4SN0;
tNPrimNO3SN0 = 0.0;
tNPrimTotTN0 = 0.0;
tSiExcrDiatSN0 = cSiDDiatN0 * tDRespDiatSN0 ;
tSiMortDiatSN0 = cSiDDiatN0 * tDMortDiatSN0;
wSiPrimSiO2WHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wSiExcrDiatWHypN0 - wSiUptDiatHypN0 + tSiExcrDiatSN0 / uDepthWHypN0 ENDIF;
wSiPrimDetWHypN0 = wSiMortDiatWHypN0 + wSiLossDiatHypN0;
tSiPrimTotTN0 = 0.0;
aPACoefEpiN0 = cPACoefMinN0 +(cPACoefMaxN0 - cPACoefMinN0) * hPACoefN0 / (hPACoefN0 + oDOMWEpiN0);
aPACoefHypN0 = cPACoefMinN0 +(cPACoefMaxN0 - cPACoefMinN0) * hPACoefN0 / (hPACoefN0 + oDOMWHypN0);
bSecchiMaxEpiN0 = uDepthWEpiN0;
aSecchiEpiN0 = MIN(bSecchiMaxEpiN0,aPACoefEpiN0 / aExtCoefOpenEpiN0);
aTransparencyEpiN0 = aSecchiEpiN0 / uDepthWEpiN0;
bSecchiMaxHypN0 = uDepthWHypN0 + cSecchiPlusN0;
aSecchiHypN0 = IF ( aInclStratN0 EQ TRUE AND uDepthWEpiN0 LE aPACoefEpiN0 / aExtCoefOpenEpiN0 ) THEN MIN(bSecchiMaxHypN0,aPACoefHypN0 / aExtCoefOpenHypN0 - aSecchiEpiN0) ELSEIF ( aInclStratN0 EQ TRUE AND uDepthWEpiN0 GT aPACoefEpiN0 / aExtCoefOpenEpiN0) THEN 0.0 ELSE MIN(bSecchiMaxHypN0,aPACoefHypN0 / aExtCoefOpenHypN0) ENDIF;
aSecchiTN0 = IF ( aInclStratN0 EQ TRUE ) THEN aSecchiEpiN0 +aSecchiHypN0 ELSE aSecchiEpiN0 ENDIF;
aTransparencyHypN0 = aSecchiHypN0 / uDepthWHypN0;
aTransparencyTN0 = IF ( aInclStratN0 EQ TRUE ) THEN aSecchiTN0 / uDepthWN0 ELSE aSecchiTN0 / uDepthWHypN0 ENDIF;
aDepthEuphHypN0 = cEuphN0 * aSecchiHypN0;
aRelDepthEuphHypN0 = aDepthEuphHypN0 / uDepthWHypN0;
aChlaHHypN0 = oChlaHypN0 * uDepthWHypN0;
aCovPhytWHypN0 = cCovSpPhytN0 *(oDPhytWHypN0 * uDepthWHypN0);
rExtChPhytHypN0 = aExtPhytHypN0 /(oChlaHypN0 / mgPergN0 + NearZeroN0);
uFunTmZooHypN0 = EXP(-0.5/(cSigTmZooN0*cSigTmZooN0) *((uTmHypN0-cTmOptZooN0)*(uTmHypN0-cTmOptZooN0) -(cTmRefN0-cTmOptZooN0)*(cTmRefN0-cTmOptZooN0)));
uFunTmZooEpiN0 = EXP(-0.5/(cSigTmZooN0*cSigTmZooN0) *((uTmEpiN0-cTmOptZooN0)*(uTmEpiN0-cTmOptZooN0) -(cTmRefN0-cTmOptZooN0)*(cTmRefN0-cTmOptZooN0)));
rPDZooHypN0 = oPZooHypN0 /(oDZooHypN0+NearZeroN0);
rNDZooHypN0 = oNZooHypN0/(oDZooHypN0+NearZeroN0);
oDFoodZooHypN0 = cPrefDiatN0 * oDDiatWHypN0 + cPrefGrenN0 * oDGrenWHypN0 + cPrefBlueN0 * oDBlueWHypN0 + cPrefDetN0 * oDDetWHypN0;
aFiltHypN0 = cFiltMaxN0 * uFunTmZooHypN0 * hFiltN0 /(hFiltN0 + oDOMWHypN0);
ukDAssTmZooHypN0 = fDAssZooN0 * cFiltMaxN0 * uFunTmZooHypN0 * hFiltN0;
ukDAssTmZooEpiN0 = fDAssZooN0 * cFiltMaxN0 * uFunTmZooEpiN0 * hFiltN0;
aDSatZooHypN0 = oDFoodZooHypN0 /(hFiltN0 + oDOMWHypN0);
ukDRespTmZooHypN0 = kDRespZooN0 * uFunTmZooHypN0;
ukDRespTmZooEpiN0 = kDRespZooN0 * uFunTmZooEpiN0;
ukDIncrZooHypN0 = ukDAssTmZooHypN0 - ukDRespTmZooHypN0 - kMortZooN0;
ukDIncrZooEpiN0 = ukDAssTmZooEpiN0 - ukDRespTmZooEpiN0 - kMortZooN0;
wDEnvZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE MAX(0.0,ukDIncrZooHypN0 / cDCarrZooN0 * oDZooHypN0*oDZooHypN0) ENDIF;
wDAssZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aDSatZooHypN0 *(ukDAssTmZooHypN0 * oDZooHypN0 - wDEnvZooHypN0) ENDIF;
wDConsZooHypN0 = wDAssZooHypN0 / fDAssZooN0;
wDConsDetZooHypN0 = cPrefDetN0*oDDetWHypN0 / oDFoodZooHypN0 * wDConsZooHypN0;
wDConsDiatZooHypN0 = cPrefDiatN0*oDDiatWHypN0 / oDFoodZooHypN0 * wDConsZooHypN0;
wDConsGrenZooHypN0 = cPrefGrenN0*oDGrenWHypN0 / oDFoodZooHypN0 * wDConsZooHypN0;
wDConsBlueZooHypN0 = cPrefBlueN0*oDBlueWHypN0 / oDFoodZooHypN0 * wDConsZooHypN0;
wDConsPhytZooHypN0 = wDConsDiatZooHypN0 + wDConsGrenZooHypN0 + wDConsBlueZooHypN0;
wDEgesZooHypN0 = wDConsZooHypN0 - wDAssZooHypN0;
aCorDRespZooHypN0 = MAX(cPDZooRefN0 / rPDZooHypN0,cNDZooRefN0 / rNDZooHypN0);
wDRespZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aCorDRespZooHypN0 * ukDRespTmZooHypN0 * oDZooHypN0 ENDIF;
wDMortZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kMortZooN0 * oDZooHypN0 +(1.0 - aDSatZooHypN0) * wDEnvZooHypN0 ENDIF;
oPFoodZooHypN0 = cPrefDiatN0*oPDiatWHypN0 + cPrefGrenN0*oPGrenWHypN0 + cPrefBlueN0*oPBlueWHypN0 + cPrefDetN0 * oPDetWHypN0;
rPDFoodZooHypN0 = oPFoodZooHypN0 /(oDFoodZooHypN0+NearZeroN0);
wPConsDiatZooHypN0 = rPDDiatWHypN0 * wDConsDiatZooHypN0;
wPConsBlueZooHypN0 = rPDBlueWHypN0 * wDConsBlueZooHypN0;
wPConsDetZooHypN0 = rPDDetWHypN0 * wDConsDetZooHypN0;
afPAssZooHypN0 = MIN(1.0,cPDZooRefN0 / rPDFoodZooHypN0 * fDAssZooN0);
akPExcrZooHypN0 = rPDZooHypN0 / cPDZooRefN0 * kDRespZooN0 * uFunTmZooHypN0;
wPExcrZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE akPExcrZooHypN0*oPZooHypN0 ENDIF;
wPMortZooHypN0 = rPDZooHypN0 * wDMortZooHypN0;
wPMortZooPO4HypN0 = fDissMortZooN0 * wPMortZooHypN0;
wPMortZooDetHypN0 = wPMortZooHypN0 - wPMortZooPO4HypN0;
oNFoodZooHypN0 = cPrefDiatN0*oNDiatWHypN0 + cPrefGrenN0*oNGrenWHypN0 + cPrefBlueN0*oNBlueWHypN0 + cPrefDetN0*oNDetWHypN0;
rNDFoodZooHypN0 = oNFoodZooHypN0 /(oDFoodZooHypN0+NearZeroN0);
wNConsDiatZooHypN0 = rNDDiatWHypN0*wDConsDiatZooHypN0;
wNConsGrenZooHypN0 = rNDGrenWHypN0*wDConsGrenZooHypN0;
wNConsBlueZooHypN0 = rNDBlueWHypN0*wDConsBlueZooHypN0;
wNConsPhytZooHypN0 = wNConsDiatZooHypN0 + wNConsGrenZooHypN0 + wNConsBlueZooHypN0;
wNConsDetZooHypN0 = rNDDetWHypN0*wDConsDetZooHypN0;
wNConsZooHypN0 = wNConsPhytZooHypN0 + wNConsDetZooHypN0;
afNAssZooHypN0 = MIN(1.0,cNDZooRefN0 / rNDFoodZooHypN0 * fDAssZooN0);
wNAssZooHypN0 = afNAssZooHypN0*wNConsZooHypN0;
wNEgesZooHypN0 = wNConsZooHypN0 - wNAssZooHypN0;
wNEgesZooNH4HypN0 = fDissEgesZooN0*wNEgesZooHypN0;
wNEgesZooDetHypN0 = wNEgesZooHypN0 - wNEgesZooNH4HypN0;
kNExcrZooHypN0 = rNDZooHypN0 / cNDZooRefN0 * kDRespZooN0 * uFunTmZooHypN0;
wNExcrZooHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE kNExcrZooHypN0*oNZooHypN0 ENDIF;
wNMortZooHypN0 = rNDZooHypN0*wDMortZooHypN0;
wNMortZooNH4HypN0 = fDissMortZooN0*wNMortZooHypN0;
wNMortZooDetHypN0 = wNMortZooHypN0 - wNMortZooNH4HypN0;
wSiConsDiatZooHypN0 = cSiDDiatN0 * wDConsDiatZooHypN0;
uFunTmBentN0 = EXP(-0.5/(cSigTmBentN0*cSigTmBentN0) *((uTmBotN0-cTmOptBentN0)*(uTmBotN0-cTmOptBentN0) - (cTmRefN0-cTmOptBentN0)*(cTmRefN0-cTmOptBentN0)));
aDFoodBentN0 = aDDetSN0 + aDPhytSN0;
rPDBentN0 = aPBentN0 /(aDBentN0+NearZeroN0);
rNDBentN0 = aNBentN0 /(aDBentN0+NearZeroN0);
tDMigrBentN0 = kMigrBentN0 *(cDBentInN0 - aDBentN0);
aDSatBentN0 = aDFoodBentN0 /(hDFoodBentN0 + aDFoodBentN0);
ukDIncrBentN0 = (kDAssBentN0 - kDRespBentN0) * uFunTmBentN0 - kMortBentN0;
tDEnvBentN0 = MAX(0.0,ukDIncrBentN0 / cDCarrBentN0 * aDBentN0*aDBentN0);
tDAssBentN0 = aDSatBentN0 *(kDAssBentN0 * uFunTmBentN0 * aDBentN0 - tDEnvBentN0);
aDAssBentSpN0 = tDAssBentN0 / aDBentN0;
tDConsBentN0 = tDAssBentN0 / fDAssBentN0;
tDConsDetBentN0 = aDDetSN0 / aDFoodBentN0 * tDConsBentN0;
tDConsDiatBentN0 = aDDiatSN0 / aDFoodBentN0 * tDConsBentN0;
tDConsGrenBentN0 = aDGrenSN0 / aDFoodBentN0 * tDConsBentN0;
tDConsBlueBentN0 = aDBlueSN0 / aDFoodBentN0 * tDConsBentN0;
tDConsPhytBentN0 = tDConsDiatBentN0 + tDConsGrenBentN0 + tDConsBlueBentN0;
tDEgesBentN0 = tDConsBentN0 - tDAssBentN0;
tDRespBentN0 = (cPDBentRefN0 / rPDBentN0) * kDRespBentN0 * uFunTmBentN0 * aDBentN0;
tDMortBentN0 = kMortBentN0*aDBentN0 +(1.0 - aDSatBentN0) * tDEnvBentN0;
aPFoodBentN0 = aPDetSN0 + aPPhytSN0;
rPDFoodBentN0 = aPFoodBentN0 /(aDFoodBentN0+NearZeroN0);
tPConsDetBentN0 = rPDDetSN0 * tDConsDetBentN0;
tPConsDiatBentN0 = rPDDiatSN0 * tDConsDiatBentN0;
tPConsGrenBentN0 = rPDGrenSN0 * tDConsGrenBentN0;
tPConsBlueBentN0 = rPDBlueSN0 * tDConsBlueBentN0;
tPConsPhytBentN0 = tPConsDiatBentN0 + tPConsGrenBentN0 + tPConsBlueBentN0;
tPConsBentN0 = tPConsDetBentN0 + tPConsPhytBentN0;
afPAssBentN0 = MIN(1.0,cPDBentRefN0 / rPDFoodBentN0 * fDAssBentN0);
tPAssBentN0 = afPAssBentN0 * tPConsBentN0;
tPEgesBentN0 = tPConsBentN0 - tPAssBentN0;
tPEgesBentPO4N0 = fDissEgesBentN0 * tPEgesBentN0;
tPEgesBentDetN0 = (1.0 - fDissEgesBentN0) * tPEgesBentN0;
tPExcrBentN0 = (rPDBentN0 / cPDBentRefN0) * kDRespBentN0 * uFunTmBentN0 * aPBentN0;
tPMortBentN0 = rPDBentN0 * tDMortBentN0;
tPMortBentPO4N0 = fDissMortBentN0 * tPMortBentN0;
tPMortBentDetN0 = (1.0-fDissMortBentN0)*tPMortBentN0;
tPMigrBentN0 = kMigrBentN0 *(cPDBentRefN0*cDBentInN0 - aPBentN0);
aNFoodBentN0 = aNDetSN0 + aNPhytSN0;
rNDFoodBentN0 = aNFoodBentN0 /(aDFoodBentN0+NearZeroN0);
tNMigrBentN0 = kMigrBentN0 *(cNDBentRefN0*cDBentInN0 - aNBentN0);
tNConsDetBentN0 = rNDDetSN0 * tDConsDetBentN0;
tNConsDiatBentN0 = rNDDiatSN0 * tDConsDiatBentN0;
tNConsGrenBentN0 = rNDGrenSN0 * tDConsGrenBentN0;
tNConsBlueBentN0 = rNDBlueSN0 * tDConsBlueBentN0;
tNConsPhytBentN0 = tNConsDiatBentN0 + tNConsGrenBentN0 + tNConsBlueBentN0;
tNConsBentN0 = tNConsDetBentN0 + tNConsPhytBentN0;
afNAssBentN0 = MIN(1.0,cNDBentRefN0 / rNDFoodBentN0 * fDAssBentN0);
tNAssBentN0 = afNAssBentN0 * tNConsBentN0;
tNEgesBentN0 = tNConsBentN0 - tNAssBentN0;
tNEgesBentNH4N0 = fDissEgesBentN0 * tNEgesBentN0;
tNEgesBentDetN0 = (1.0 - fDissEgesBentN0) * tNEgesBentN0;
tNExcrBentN0 = (rNDBentN0 / cNDBentRefN0) * kDRespBentN0 * uFunTmBentN0 * aNBentN0;
tNMortBentN0 = rNDBentN0 * tDMortBentN0;
tNMortBentNH4N0 = fDissMortBentN0*tNMortBentN0;
tNMortBentDetN0 = (1.0-fDissMortBentN0)*tNMortBentN0;
tSiConsDiatBentN0 = cSiDDiatN0 * tDConsDiatBentN0;
aFunVegFishN0 = MAX(0.0,1.0 - cRelVegFishN0 * aCovVegN0);
ukDIncrFiJvN0 = (kDAssFiJvN0 - kDRespFiJvN0) * uFunTmFishN0 - kMortFiJvN0;
aDSatFiAdN0 = (aFunVegFishN0 * aDBentN0) *(aFunVegFishN0 * aDBentN0) /(hDBentFiAdN0 * hDBentFiAdN0 + (aFunVegFishN0 * aDBentN0) *(aFunVegFishN0 * aDBentN0));
ukDIncrFiAdN0 = (kDAssFiAdN0 - kDRespFiAdN0) * uFunTmFishN0 - kMortFiAdN0;
ukHarvFishN0 = IF (COS(2.0 * PiN0 * sTimeN0 / DaysInYearN0) GT 0.1) THEN kHarvFishWinN0 ELSE kHarvFishSumN0 ENDIF;
afPAssFiAdN0 = MIN(1.0,cPDFishRefN0 / rPDBentN0 * fDAssFiAdN0);
afNAssFiAdN0 = MIN(1.0,cNDFishRefN0 / rNDBentN0 * fDAssFiAdN0);
uFunTmPiscN0 = EXP(-0.5 /(cSigTmPiscN0*cSigTmPiscN0) *((uTmEpiN0 - cTmOptPiscN0)*(uTmEpiN0 - cTmOptPiscN0) - (cTmRefN0 - cTmOptPiscN0)*(cTmRefN0 - cTmOptPiscN0)));
aDCarrPiscN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN MAX(cDCarrPiscMinN0,MIN(cDCarrPiscMaxN0,cDCarrPiscBareN0)) ELSEIF (aDShootPhraN0 LT cDPhraMinPiscN0) THEN cDCarrPiscMinN0 ELSEIF (aCovVegN0 LT cCovVegMinN0) THEN MAX(cDCarrPiscMinN0,MIN(cDCarrPiscMaxN0,fMarshN0 *(1.0/PerCentN0) * cRelPhraPiscN0)) ELSE MAX(cDCarrPiscMinN0,MIN(cDCarrPiscMaxN0,fMarshN0 *(1.0/PerCentN0) *(cRelPhraPiscN0 + cRelVegPiscN0))) ENDIF;
aFunVegPiscN0 = aDSubVegN0 /(hDVegPiscN0 + aDSubVegN0 + NearZeroN0);
akDIncrPiscN0 = (kDAssPiscN0 * aFunVegPiscN0 - kDRespPiscN0) * uFunTmPiscN0 - kMortPiscN0;
ukHarvPiscN0 = IF (COS(2.0*PiN0 * sTimeN0 / DaysInYearN0) GT 0.1) THEN kHarvPiscWinN0 ELSE kHarvPiscSumN0 ENDIF;
tDWebDetSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tDConsDetBentN0 + tDEgesBentN0 + tDMortBentN0 ENDIF;
tDWebDiatSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tDConsDiatBentN0 ENDIF;
tDWebGrenSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tDConsGrenBentN0 ENDIF;
tDWebBlueSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tDConsBlueBentN0 ENDIF;
tDWebPhytSN0 = tDWebDiatSN0 + tDWebGrenSN0 + tDWebBlueSN0;
tPWebPO4SN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tPExcrBentN0 + tPEgesBentPO4N0 + tPMortBentPO4N0 ENDIF;
tPWebDetSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tPConsDetBentN0 + tPEgesBentDetN0 + tPMortBentDetN0 ENDIF;
tPWebDiatSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tPConsDiatBentN0 ENDIF;
tPWebGrenSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tPConsGrenBentN0 ENDIF;
tPWebBlueSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tPConsBlueBentN0 ENDIF;
tPWebPhytSN0 = tPWebDiatSN0 + tPWebGrenSN0 + tPWebBlueSN0;
tNWebNH4SN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tNExcrBentN0 + tNEgesBentNH4N0 + tNMortBentNH4N0 ENDIF;
tNWebNO3SN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE 0.0 ENDIF;
tNWebDetSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tNConsDetBentN0 + tNEgesBentDetN0 + tNMortBentDetN0 ENDIF;
tNWebDiatSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tNConsDiatBentN0 ENDIF;
tNWebGrenSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tNConsGrenBentN0 ENDIF;
tNWebBlueSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - tNConsBlueBentN0 ENDIF;
tNWebPhytSN0 = tNWebDiatSN0 + tNWebGrenSN0 + tNWebBlueSN0;
wSiWebSiO2WN0 = 0.0;
wSiWebDetWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wSiConsDiatZooHypN0 ENDIF;
tSiWebDetSN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tSiConsDiatBentN0 ENDIF;
tSiWebTotTN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE 0.0 ENDIF;
aPrefAveHypN0 = (cPrefDiatN0 * oDDiatWHypN0 + cPrefGrenN0 * oDGrenWHypN0 + cPrefBlueN0 * oDBlueWHypN0 + cPrefDetN0 * oDDetWHypN0) / oDOMWHypN0;
wDConsZoo2HypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aFiltHypN0 * aPrefAveHypN0 * oDOMWHypN0 * oDZooHypN0 ENDIF;
aDConsZooSpHypN0 = wDConsZooHypN0 / oDZooHypN0;
aDAssZooSpHypN0 = wDAssZooHypN0 / oDZooHypN0;
aDGrazSpHypN0 = wDConsZooHypN0 / oDOMWHypN0;
aNConsZooSpHypN0 = wNConsZooHypN0 / oNZooHypN0;
aNGrazSpHypN0 = wNConsZooHypN0 / oNOMWHypN0;
afDShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDShootPhraN0 /(aDRootPhraN0 + aDShootPhraN0) ELSE 0.0 ENDIF;
rDSRPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDShootPhraN0/aDRootPhraN0 ELSE 0.0 ENDIF;
rPDShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPShootPhraN0/aDShootPhraN0 ELSE 0.0 ENDIF;
rNDShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNShootPhraN0/aDShootPhraN0 ELSE 0.0 ENDIF;
rPDRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aPRootPhraN0/aDRootPhraN0 ELSE 0.0 ENDIF;
rNDRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNRootPhraN0/aDRootPhraN0 ELSE 0.0 ENDIF;
aLengShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aDShootPhraN0 / cDStemPhraN0 / cDensStemPhraN0 ELSE 0.0 ENDIF;
bDayInitPhraN0 = IF (DayN0 LT 1.0 OR sTimeN0 LT StartTimeN0 + 1.0) THEN 367 ELSEIF (uTmEpiN0 GE cTmInitPhraN0 AND bDayInitPhraN0 GT 366) THEN DayN0 ELSE bDayInitPhraN0 ENDIF;
aDAllPhraN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (DayN0 LT bDayInitPhraN0) THEN 0.0 ELSEIF (DayN0 LE bDayInitPhraN0 + 1.0 / kDAllPhraN0) THEN fDAllPhraN0 * aDRootPhraN0 ELSE 0.0 ENDIF;
tDAllPhraN0 = IF (FALSE EQ InclSeasonN0) THEN 0.0 ELSEIF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (DayN0 LT bDayInitPhraN0) THEN 0.0 ELSEIF (DayN0 LE bDayInitPhraN0 + 1.0 / kDAllPhraN0) THEN kDAllPhraN0 * aDAllPhraN0 ELSE 0.0 ENDIF;
tNTransPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rNDRootPhraN0 * tDAllPhraN0 ELSE 0.0 ENDIF;
tPTransPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rPDRootPhraN0 * tDAllPhraN0 ELSE 0.0 ENDIF;
aVNUptPhraMaxCrN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN MAX(0.0,cVNUptPhraMaxN0 * POW(cQ10ProdPhraN0 , (0.1 *(uTmEpiN0 - cTmRefN0))) *(cNDPhraMaxN0 - rNDRootPhraN0) /(cNDPhraMaxN0 - cNDPhraMinN0)) ELSE 0.0 ENDIF;
ahNUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVNUptPhraMaxCrN0 / cAffNUptPhraN0 ELSE 0.0 ENDIF;
aVNUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVNUptPhraMaxCrN0 * oNDissSMN0 /(ahNUptPhraSN0 + oNDissSMN0) ELSE 0.0 ENDIF;
tNUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVNUptPhraSN0 * aDRootPhraN0 ELSE 0.0 ENDIF;
tNUptNH4PhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aNH4SMN0 / aNDissSMN0 * tNUptPhraSN0 ELSE 0.0 ENDIF;
tNUptNO3PhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tNUptPhraSN0 - tNUptNH4PhraSN0 ELSE 0.0 ENDIF;
tNUptShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN afDShootPhraN0 * tNUptPhraSN0 ELSE 0.0 ENDIF;
tNUptRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tNUptPhraSN0 - tNUptShootPhraN0 ELSE 0.0 ENDIF;
aVPUptPhraMaxCrN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN MAX(0.0,cVPUptPhraMaxN0 * POW(cQ10ProdPhraN0 , (0.1 *(uTmEpiN0 - cTmRefN0))) *(cPDPhraMaxN0 - rPDRootPhraN0) /(cPDPhraMaxN0 - cPDPhraMinN0)) ELSE 0.0 ENDIF;
ahPUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVPUptPhraMaxCrN0 / cAffPUptPhraN0 ELSE 0.0 ENDIF;
aVPUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVPUptPhraMaxCrN0 * oPO4SMN0 /(ahPUptPhraSN0 + oPO4SMN0) ELSE 0.0 ENDIF;
tPUptPhraSN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aVPUptPhraSN0 * aDRootPhraN0 ELSE 0.0 ENDIF;
tPUptShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN afDShootPhraN0 * tPUptPhraSN0 ELSE 0.0 ENDIF;
tPUptRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tPUptPhraSN0 - tPUptShootPhraN0 ELSE 0.0 ENDIF;
uFunTmProdPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN POW(cQ10ProdPhraN0 , (0.1 *(uTmEpiN0 - cTmRefN0))) ELSE 0.0 ENDIF;
ukDRespTmPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDRespPhraN0 * POW(cQ10RespPhraN0 , (0.1 *(uTmEpiN0 - cTmRefN0))) ELSE 0.0 ENDIF;
aMuPhotPhraN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (aLengShootPhraN0 GE uDepthWMN0) THEN cMuPhraMaxN0 * uFunTmProdPhraN0 * ufDayN0 ELSE 0.0 ENDIF;
aNLimProdPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (1.0 - cNDPhraMinN0 / rNDRootPhraN0) * cNDPhraMaxN0 /(cNDPhraMaxN0 - cNDPhraMinN0) ELSE 0.0 ENDIF;
aPLimProdPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (1.0 - cPDPhraMinN0 / rPDRootPhraN0) * cPDPhraMaxN0 /(cPDPhraMaxN0 - cPDPhraMinN0) ELSE 0.0 ENDIF;
aNutLimPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN MIN(aNLimProdPhraN0,aPLimProdPhraN0) ELSE 0.0 ENDIF;
aMuPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aMuPhotPhraN0 * aNutLimPhraN0 ELSE 0.0 ENDIF;
akDIncrPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aMuPhotPhraN0 - ukDRespTmPhraN0 - kDMortShootPhraN0 ELSE 0.0 ENDIF;
tDDensPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN MAX(0.0,akDIncrPhraN0 / cDShootPhraMaxN0 * aDShootPhraN0 * aDShootPhraN0) ELSE 0.0 ENDIF;
tDDensProdPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aMuPhraN0 / cMuPhraMaxN0 * tDDensPhraN0 ELSE 0.0 ENDIF;
tDProdPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN aMuPhraN0 * aDShootPhraN0 - tDDensProdPhraN0 ELSE 0.0 ENDIF;
tDProdShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN afDShootPhraN0 * tDProdPhraN0 ELSE 0.0 ENDIF;
tDProdRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDProdPhraN0 - tDProdShootPhraN0 ELSE 0.0 ENDIF;
tDRespShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ukDRespTmPhraN0 * aDShootPhraN0 ELSE 0.0 ENDIF;
tDRespRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN ukDRespTmPhraN0 * aDRootPhraN0 ELSE 0.0 ENDIF;
tO2RespRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN molO2molCN0 * cCPerDWN0 * tDRespRootPhraN0 * afOxySedMN0 ELSE 0.0 ENDIF;
tO2FlowPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tO2RespRootPhraN0 ELSE 0.0 ENDIF;
bDayRealPhraN0 = IF (DayN0 LT 180.0) THEN 367 ELSEIF (ufDayN0 LE fDayWinN0 AND bDayRealPhraN0 GT 366) THEN DayN0 ELSE bDayRealPhraN0 ENDIF;
aDRealPhraN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (DayN0 LT bDayRealPhraN0) THEN 0.0 ELSEIF (DayN0 LE bDayRealPhraN0 + 1.0 / kDRealPhraN0) THEN fDRealPhraN0 * aDShootPhraN0 ELSE 0.0 ENDIF;
tDRealPhraN0 = IF (FALSE EQ InclSeasonN0) THEN 0.0 ELSEIF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (DayN0 LT bDayRealPhraN0) THEN 0.0 ELSEIF (DayN0 LE bDayRealPhraN0 + 1.0 / kDRealPhraN0) THEN kDRealPhraN0 * aDRealPhraN0 ELSE 0.0 ENDIF;
tNRetrPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rNDShootPhraN0 * tDRealPhraN0 ELSE 0.0 ENDIF;
tPRetrPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rPDShootPhraN0 * tDRealPhraN0 ELSE 0.0 ENDIF;
tDMortShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMortShootPhraN0 * aDShootPhraN0 ELSE 0.0 ENDIF;
tNMortShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rNDShootPhraN0 * tDMortShootPhraN0 ELSE 0.0 ENDIF;
tPMortShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rPDShootPhraN0 * tDMortShootPhraN0 ELSE 0.0 ENDIF;
tDMortRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kDMortRootPhraN0 * aDRootPhraN0 ELSE 0.0 ENDIF;
tNMortRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rNDRootPhraN0 * tDMortRootPhraN0 ELSE 0.0 ENDIF;
tPMortRootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN rPDRootPhraN0 * tDMortRootPhraN0 ELSE 0.0 ENDIF;
tDManShootPhraN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 GT NearZeroN0) THEN 0.0 ELSEIF ((DayN0 GE cDayManPhraN0) AND (DayN0 LT cDayManPhraN0 + 1.0)) THEN fManPhraN0 * aDShootPhraN0 ELSE 0.0 ENDIF;
tNManShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDManShootPhraN0 * rNDShootPhraN0 ELSE 0.0 ENDIF;
tPManShootPhraN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDManShootPhraN0 * rPDShootPhraN0 ELSE 0.0 ENDIF;
tDIMSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDSetIMMN0 ELSE 0.0 ENDIF;
tDHumSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN fRefrDetSN0 * tDMinDetSMN0 - tDMinHumSMN0 ELSE 0.0 ENDIF;
tDDetSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN tDSetDetMN0 - tDMinDetSMN0 + tDSetPhytMN0 + tDMortRootPhraN0 ELSE 0.0 ENDIF;
vDeltaSMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (tDIMSMN0 / cRhoIMN0 +(tDHumSMN0 + tDDetSMN0) / cRhoOMN0)/(1.0 - bPorSN0) ELSE 0.0 ENDIF;
tDBurIMMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN ((tDHumSMN0 + tDDetSMN0) +(cRhoOMN0 / cRhoIMN0) * tDIMSMN0) / ((aDHumSMN0 + aDDetSMN0) / aDIMSMN0 + cRhoOMN0 / cRhoIMN0) ELSE ((tDHumSMN0 + tDDetSMN0) +(cRhoOMN0 / cRhoIMN0) * tDIMSMN0) / (fDOrgSoilN0 /(1.0 - fDOrgSoilN0) + cRhoOMN0 / cRhoIMN0) ENDIF;
tDBurOMMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN (aDHumSMN0 + aDDetSMN0) / aDIMSMN0 * tDBurIMMN0 ELSE fDOrgSoilN0 /(1.0 - fDOrgSoilN0) * tDBurIMMN0 ENDIF;
tDBurDetMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN aDDetSMN0 /(aDHumSMN0 + aDDetSMN0) * tDBurOMMN0 ELSE 0.0 ENDIF;
tDBurHumMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN tDBurOMMN0 - tDBurDetMN0 ELSE tDBurOMMN0 ENDIF;
tDBurTotMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN tDBurIMMN0 + tDBurOMMN0 ELSE tDBurIMMN0 + tDBurOMMN0 ENDIF;
tPBurHumMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN rPDHumSMN0 * tDBurHumMN0 ELSE cPDSoilOMN0 * tDBurHumMN0 ENDIF;
tPBurDetMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN rPDDetSMN0 * tDBurDetMN0 ELSE 0.0 ENDIF;
tPBurAIMMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN aPAIMSMN0 / aDIMSMN0 * tDBurIMMN0 ELSE 0.0 ENDIF;
tPBurPO4MN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN aPO4SMN0 *(vDeltaSMN0 / cDepthSMN0) ELSE cPO4GroundN0 *(bPorSMN0 * vDeltaSMN0) ENDIF;
tPBurTotMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN tPBurDetMN0 + tPBurHumMN0 + tPBurAIMMN0 + tPBurPO4MN0 ELSE tPBurHumMN0 + tPBurAIMMN0 + tPBurPO4MN0 ENDIF;
tNBurHumMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN rNDHumSMN0 * tDBurHumMN0 ELSE cNDSoilOMN0 * tDBurHumMN0 ENDIF;
tNBurDetMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN rNDDetSMN0 * tDBurDetMN0 ELSE 0.0 ENDIF;
tNBurNH4MN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN aNH4SMN0 *(vDeltaSMN0 / cDepthSMN0) ELSE cNH4GroundN0 *(bPorSMN0 * vDeltaSMN0) ENDIF;
tNBurNO3MN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN aNO3SMN0 *(vDeltaSMN0 / cDepthSMN0) ELSE cNO3GroundN0 *(bPorSMN0 * vDeltaSMN0) ENDIF;
tNBurTotMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN tNBurDetMN0 + tNBurHumMN0 + tNBurNH4MN0 + tNBurNO3MN0 ELSE tNBurHumMN0 + tNBurNH4MN0 + tNBurNO3MN0 ENDIF;
tSiBurDetMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN rSiDDetSMN0 * tDBurDetMN0 ELSE 0.0 ENDIF;
tSiBurTotMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (vDeltaSMN0 GE 0.0) THEN tSiBurDetMN0 ELSE 0.0 ENDIF;
vDeltaWMN0 = IF (FALSE EQ InclMarshN0 OR fMarshN0 LE NearZeroN0) THEN 0.0 ELSEIF (ConstDepthN0 EQ TRUE) THEN 0.0 ELSE - vDeltaSMN0 ENDIF;
aRelDeltaWMN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN vDeltaWMN0 / uDepthWMN0 ELSE 0.0 ENDIF;
bTimeDredN0 = IF (sTimeN0 GE cDredStartN0 * DaysPerYearN0) THEN (FLOOR(TimeYearsN0/cDredIntervalN0) * cDredIntervalN0) * DaysPerYearN0 ELSE -9999.999 ENDIF;
bRhoSolidSoilN0 = fDOrgSoilN0 * cRhoOMN0 +(1.0 - fDOrgSoilN0) * cRhoIMN0;
tDMarsTotTN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (- tDBurTotMN0 - wDMinDetWMN0 * uDepthWMN0 -(1.0 - fRefrDetSN0) * tDMinDetSMN0 - tDMinHumSMN0 + tDProdPhraN0 - tDRespShootPhraN0 - tDRespRootPhraN0 - tDManShootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
tPMarsTotTN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (- tPInfPO4SMN0 + tPSeepPO4SMN0 - tPDifGroundPO4MN0 - tPBurTotMN0 - tPChemPO4MN0 - tPManShootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
tNMarsTotTN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN (- tNInfNH4SMN0 + tNSeepNH4SMN0 - tNInfNO3SMN0 + tNSeepNO3SMN0 - tNDifGroundNO3MN0 - tNDifGroundNH4MN0 - tNBurTotMN0 - wNDenitWMN0 * uDepthWMN0 - tNDenitSMN0 - tNManShootPhraN0) * fMarshN0 ELSE 0.0 ENDIF;
tSiMarsTotTN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN - tSiBurDetMN0 * fMarshN0 - tInfSiO2WMN0 + tSeepSiO2WMN0 ELSE 0.0 ENDIF;
uTauSubstEpiN0 = 1.0 / (ukOutEpiN0+NearZeroN0);
akExchMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN kExchMaxMN0 * hfMarshN0 /(hfMarshN0 + fMarshN0)  ELSE 0.0 ENDIF;
afVolMarshEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN fMarshN0 * uDepthWMN0 / uDepthWEpiN0 ELSE 0.0 ENDIF;
akExchLEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 * afVolMarshEpiN0 ELSE 0.0 ENDIF;
oPPhytWEpiN0 = oPDiatWEpiN0 + oPGrenWEpiN0 + oPBlueWEpiN0;
oNPhytWEpiN0 = oNDiatWEpiN0 + oNGrenWEpiN0 + oNBlueWEpiN0;
oDSestWEpiN0 = oDOMWEpiN0 + oDIMWEpiN0;
oPOMWEpiN0 = oPPhytWEpiN0 + oPDetWEpiN0;
oPSestWEpiN0 = oPPhytWEpiN0 + oPDetWEpiN0 + oPAIMWEpiN0;
oPInorgWEpiN0 = oPO4WEpiN0 + oPAIMWEpiN0;
oPTotWEpiN0 = oPSestWEpiN0 + oPO4WEpiN0;
oNOMWEpiN0 = oNPhytWEpiN0 + oNDetWEpiN0;
oNSestWEpiN0 = oNOMWEpiN0;
oNkjWEpiN0 = oNSestWEpiN0 + oNH4WEpiN0;
oNTotWEpiN0 = oNkjWEpiN0 + oNO3WEpiN0;
rPDIMWEpiN0 = oPAIMWEpiN0 / oDIMWEpiN0;
rPDDetWEpiN0 = oPDetWEpiN0 / (oDDetWEpiN0+NearZeroN0);
rNDDetWEpiN0 = oNDetWEpiN0 / (oDDetWEpiN0+NearZeroN0);
rSiDDetWEpiN0 = oSiDetWEpiN0 / (oDDetWEpiN0+NearZeroN0);
wDDilIMEpiN0 = ukOutEpiN0 * oDIMWEpiN0;
wDDilDetEpiN0 = ukOutEpiN0 * oDDetWEpiN0;
wDDilDiatEpiN0 = ukOutEpiN0 * oDDiatWEpiN0;
wDDilGrenEpiN0 = ukOutEpiN0 * oDGrenWEpiN0;
wDDilBlueEpiN0 = ukOutEpiN0 * oDBlueWEpiN0;
wDDilPhytEpiN0 = wDDilDiatEpiN0 + wDDilGrenEpiN0 + wDDilBlueEpiN0;
wDDilZooEpiN0 = ukOutEpiN0 * oDZooEpiN0;
wPDilZooEpiN0 = ukOutEpiN0 * oPZooEpiN0;
wNDilZooEpiN0 = ukOutEpiN0 * oNZooEpiN0;
wPDilPO4EpiN0 = ukOutEpiN0 * oPO4WEpiN0;
wPDilDetEpiN0 = ukOutEpiN0*oPDetWEpiN0;
wPDilAIMEpiN0 = ukOutEpiN0 * oPAIMWEpiN0;
wNDilNH4EpiN0 = ukOutEpiN0 * oNH4WEpiN0;
wNDilNO3EpiN0 = ukOutEpiN0 * oNO3WEpiN0;
wNDilDetEpiN0 = ukOutEpiN0 * oNDetWEpiN0;
uO2LoadEpiN0 = IF (ReadTranFracN0 EQ TRUE) THEN mO2LoadEpiN0 ELSE cO2InN0 * uQInEpiN0 / mmPermN0 ENDIF;
wO2OutflEpiN0 = ukOutEpiN0 * oO2WEpiN0;
wPDilDiatEpiN0 = ukOutEpiN0 * oPDiatWEpiN0;
wNDilDiatEpiN0 = ukOutEpiN0 * oNDiatWEpiN0;
wPDilGrenEpiN0 = ukOutEpiN0 * oPGrenWEpiN0;
wNDilGrenEpiN0 = ukOutEpiN0 * oNGrenWEpiN0;
wPDilBlueEpiN0 = ukOutEpiN0 * oPBlueWEpiN0;
wNDilBlueEpiN0 = ukOutEpiN0 * oNBlueWEpiN0;
wPDilPhytEpiN0 = wPDilDiatEpiN0 + wPDilGrenEpiN0 + wPDilBlueEpiN0;
wNDilPhytEpiN0 = wNDilDiatEpiN0 + wNDilGrenEpiN0 + wNDilBlueEpiN0;
wDOutflTotEpiN0 = ukOutEpiN0 * oDSestWEpiN0;
wPOutflTotEpiN0 = ukOutEpiN0 * oPTotWEpiN0;
wNOutflTotEpiN0 = ukOutEpiN0 * oNTotWEpiN0;
wSiDilSiO2EpiN0 = ukOutEpiN0 * oSiO2WEpiN0;
wSiDilDetEpiN0 = ukOutEpiN0 * oSiDetWEpiN0;
wSiDilDiatEpiN0 = cSiDDiatN0 * wDDilDiatEpiN0;
wSiOutflTotEpiN0 = ukOutEpiN0 * (oSiO2WEpiN0 + oSiDetWEpiN0 + cSiDDiatN0 * oDDiatWEpiN0);
wDDilTotEpiN0 = wDDilIMEpiN0 + wDDilDetEpiN0 + wDDilPhytEpiN0;
wPDilTotEpiN0 = wPDilDetEpiN0 + wPDilPO4EpiN0 + wPDilAIMEpiN0 + wPDilPhytEpiN0;
wNDilTotEpiN0 = wNDilDetEpiN0 + wNDilNO3EpiN0 + wNDilNH4EpiN0 + wNDilPhytEpiN0;
wSiDilTotEpiN0 = wSiDilDetEpiN0 + wSiDilSiO2EpiN0 + wSiDilDiatEpiN0;
tSiTranTotTEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadEpiN0 - wSiDilTotEpiN0 * uDepthWEpiN0 ENDIF;
tDTranTotTEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadEpiN0 - wDDilTotEpiN0 * uDepthWEpiN0 ENDIF;
tPTranTotTEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadEpiN0 - wPDilTotEpiN0 * uDepthWEpiN0 ENDIF;
tNTranTotTEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadEpiN0 - wNDilTotEpiN0 * uDepthWEpiN0 ENDIF;
wDExchIMMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDIMWEpiN0 - oDIMWMN0) ELSE 0.0 ENDIF;
wPExchPO4MEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPO4WEpiN0 - oPO4WMN0) ELSE 0.0 ENDIF;
wPExchAIMMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPAIMWEpiN0 - oPAIMWMN0) ELSE 0.0 ENDIF;
wNExchNH4MEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNH4WEpiN0 - oNH4WMN0) ELSE 0.0 ENDIF;
wNExchNO3MEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNO3WEpiN0 - oNO3WMN0) ELSE 0.0 ENDIF;
wSiExchSiO2MEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oSiO2WEpiN0 - oSiO2WMN0) ELSE 0.0 ENDIF;
wO2ExchMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oO2WEpiN0 - oO2WMN0) ELSE 0.0 ENDIF;
wDExchDetMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDDetWEpiN0 - oDDetWMN0) ELSE 0.0 ENDIF;
wPExchDetMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPDetWEpiN0 - oPDetWMN0) ELSE 0.0 ENDIF;
wNExchDetMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNDetWEpiN0 - oNDetWMN0) ELSE 0.0 ENDIF;
wSiExchDetMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oSiDetWEpiN0 - oSiDetWMN0) ELSE 0.0 ENDIF;
wDExchDiatMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDDiatWEpiN0 - oDDiatWMN0) ELSE 0.0 ENDIF;
wPExchDiatMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPDiatWEpiN0 - oPDiatWMN0) ELSE 0.0 ENDIF;
wNExchDiatMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNDiatWEpiN0 - oNDiatWMN0) ELSE 0.0 ENDIF;
wSiExchDiatMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cSiDDiatN0 * wDExchDiatMEpiN0 ELSE 0.0 ENDIF;
wDExchGrenMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDGrenWEpiN0 - oDGrenWMN0) ELSE 0.0 ENDIF;
wPExchGrenMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPGrenWEpiN0 - oPGrenWMN0) ELSE 0.0 ENDIF;
wNExchGrenMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNGrenWEpiN0 - oNGrenWMN0) ELSE 0.0 ENDIF;
wDExchBlueMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDBlueWEpiN0 - oDBlueWMN0) ELSE 0.0 ENDIF;
wPExchBlueMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPBlueWEpiN0 - oPBlueWMN0) ELSE 0.0 ENDIF;
wNExchBlueMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNBlueWEpiN0 - oNBlueWMN0) ELSE 0.0 ENDIF;
wDExchZooMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oDZooEpiN0 - oDZooMN0) ELSE 0.0 ENDIF;
wPExchZooMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oPZooEpiN0 - oPZooMN0) ELSE 0.0 ENDIF;
wNExchZooMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchMEpiN0 *(oNZooEpiN0 - oNZooMN0) ELSE 0.0 ENDIF;
wDExchIMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDIMWEpiN0 - oDIMWMN0) ELSE 0.0 ENDIF;
wPExchPO4EpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPO4WEpiN0 - oPO4WMN0) ELSE 0.0 ENDIF;
wPExchAIMEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPAIMWEpiN0 - oPAIMWMN0) ELSE 0.0 ENDIF;
wNExchNH4EpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNH4WEpiN0 - oNH4WMN0) ELSE 0.0 ENDIF;
wNExchNO3EpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNO3WEpiN0 - oNO3WMN0) ELSE 0.0 ENDIF;
wSiExchSiO2EpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oSiO2WEpiN0 - oSiO2WMN0) ELSE 0.0 ENDIF;
wO2ExchEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oO2WEpiN0 - oO2WMN0) ELSE 0.0 ENDIF;
wDExchDetEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDDetWEpiN0 - oDDetWMN0) ELSE 0.0 ENDIF;
wPExchDetEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPDetWEpiN0 - oPDetWMN0) ELSE 0.0 ENDIF;
wNExchDetEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNDetWEpiN0 - oNDetWMN0) ELSE 0.0 ENDIF;
wSiExchDetEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oSiDetWEpiN0 - oSiDetWMN0) ELSE 0.0 ENDIF;
wDExchDiatEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDDiatWEpiN0 - oDDiatWMN0) ELSE 0.0 ENDIF;
wPExchDiatEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPDiatWEpiN0 - oPDiatWMN0) ELSE 0.0 ENDIF;
wNExchDiatEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNDiatWEpiN0 - oNDiatWMN0) ELSE 0.0 ENDIF;
wSiExchDiatEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN cSiDDiatN0 * wDExchDiatEpiN0 ELSE 0.0 ENDIF;
wDExchGrenEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDGrenWEpiN0 - oDGrenWMN0) ELSE 0.0 ENDIF;
wPExchGrenEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPGrenWEpiN0 - oPGrenWMN0) ELSE 0.0 ENDIF;
wNExchGrenEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNGrenWEpiN0 - oNGrenWMN0) ELSE 0.0 ENDIF;
wDExchBlueEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDBlueWEpiN0 - oDBlueWMN0) ELSE 0.0 ENDIF;
wPExchBlueEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPBlueWEpiN0 - oPBlueWMN0) ELSE 0.0 ENDIF;
wNExchBlueEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNBlueWEpiN0 - oNBlueWMN0) ELSE 0.0 ENDIF;
wDExchZooEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oDZooEpiN0 - oDZooMN0) ELSE 0.0 ENDIF;
wPExchZooEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oPZooEpiN0 - oPZooMN0) ELSE 0.0 ENDIF;
wNExchZooEpiN0 = IF (InclMarshN0 EQ TRUE AND fMarshN0 GT NearZeroN0) THEN akExchLEpiN0 *(oNZooEpiN0 - oNZooMN0) ELSE 0.0 ENDIF;
tInfSiO2WEpiN0 =IF (InclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oSiO2WEpiN0 ELSE 0.0 ENDIF;
tInfO2WEpiN0 =IF (InclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oO2WEpiN0 ELSE 0.0 ENDIF;
tPInfPO4WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oPO4WEpiN0 ELSE 0.0 ENDIF;
tNInfNH4WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNH4WEpiN0 ELSE 0.0 ENDIF;
tNInfNO3WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN0 GE 0.0) THEN uQOutInfN0 / mmPermN0 * oNO3WEpiN0 ELSE 0.0 ENDIF;
tSeepSiO2WEpiN0 =IF (InclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WEpiN0 =IF (InclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oPO4SN0 ELSE 0.0 ENDIF;
tNSeepNH4WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNH4SN0 ELSE 0.0 ENDIF;
tNSeepNO3WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN0 GE 0.0) THEN uQInSeepN0 / mmPermN0 * oNO3SN0 ELSE 0.0 ENDIF;
tSiAbioTotTN0 = - fRefrDetSN0 * tSiMinDetSN0 - tInfSiO2WHypN0 - tInfSiO2WEpiN0 + tSeepSiO2WHypN0 + tSeepSiO2WEpiN0;
tO2AerEpiN0 = kAerN0 * uFunTmAerEpiN0 * (uO2SatEpiN0 - oO2WEpiN0) * aFunFloatAerN0 * aFunBlueSurfAerN0;
tDTurbFishIMN0 = fLutumN0 * aDIMSN0 / (fLutumN0 * aDIMSN0 + aDDetSN0) * tDTurbFishN0;
uCorVSetIMEpiN0 = (aFunTauSetIMEpiN0+ uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * POW((fLutumRefN0/fLutumN0) , (0.5)) * uFunTmSetEpiN0 * cVSetIMN0;
tDSetIMEpiN0 = uCorVSetIMEpiN0 * oDIMWEpiN0;
tPSetAIMEpiN0 = oPAIMWEpiN0 / oDIMWEpiN0 * tDSetIMEpiN0;
uCorVSetDetEpiN0 = (cVSetDetN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMEpiN0 * uFunTmSetEpiN0;
tDSetDetEpiN0 = uCorVSetDetEpiN0 * oDDetWEpiN0;
tPSetDetEpiN0 = uCorVSetDetEpiN0 * oPDetWEpiN0;
tNSetDetEpiN0 = uCorVSetDetEpiN0 * oNDetWEpiN0;
tSiSetDetEpiN0 = uCorVSetDetEpiN0 * oSiDetWEpiN0;
wDMinDetWEpiN0 = kDMinDetWN0 * uFunTmMinWEpiN0 * oDDetWEpiN0;
wPMinDetWEpiN0 = kPMinDetWN0 * uFunTmMinWEpiN0 * oPDetWEpiN0;
wNMinDetWEpiN0 = kNMinDetWN0 * uFunTmMinWEpiN0 * oNDetWEpiN0;
wSiMinDetWEpiN0 = kSiMinDetWN0 * uFunTmMinWEpiN0 * oSiDetWEpiN0;
aCorO2BODEpiN0 = oO2WEpiN0 / (hO2BODN0 + oO2WEpiN0);
wO2MinDetWEpiN0 = molO2molCN0 * cCPerDWN0 * aCorO2BODEpiN0 * wDMinDetWEpiN0;
wDDenitWEpiN0 = oNO3WEpiN0*oNO3WEpiN0 / (hNO3DenitN0*hNO3DenitN0 + oNO3WEpiN0*oNO3WEpiN0) * (1.0 - aCorO2BODEpiN0) * wDMinDetWEpiN0;
wNDenitWEpiN0 = NO3PerCN0 * molNmolCN0 * cCPerDWN0 * wDDenitWEpiN0;
aCorO2NitrWEpiN0 = oO2WEpiN0*oO2WEpiN0 / (hO2NitrN0*hO2NitrN0 + oO2WEpiN0*oO2WEpiN0);
wNNitrWEpiN0 = kNitrWN0 * uFunTmNitrEpiN0 * aCorO2NitrWEpiN0 * oNH4WEpiN0;
wO2NitrWEpiN0 = O2PerNH4N0 * molO2molNN0 * wNNitrWEpiN0;
tDMinOxyDetSN0 = afOxySedN0 * (1.0 - fRefrDetSN0) * tDMinDetSN0;
tO2MinDetSN0 = molO2molCN0 * cCPerDWN0 * tDMinOxyDetSN0;
tDDenitSN0 = oNO3SN0*oNO3SN0 / (hNO3DenitN0*hNO3DenitN0 + oNO3SN0*oNO3SN0) * (1.0 - afOxySedN0) * (1.0 - fRefrDetSN0) * tDMinDetSN0;
tNDenitSN0 = NO3PerCN0 * molNmolCN0 * cCPerDWN0 * tDDenitSN0;
tNNitrSN0 = afOxySedN0 * kNitrSN0 * uFunTmNitrSN0 * aNH4SN0;
tO2NitrSN0 = O2PerNH4N0 * molO2molNN0 * tNNitrSN0;
tDMinHumSN0 = kDMinHumN0 * uFunTmMinSN0 * afOxySedN0 * aDHumSN0;
tPMinHumSN0 = kDMinHumN0 * uFunTmMinSN0 * afOxySedN0 * aPHumSN0;
tNMinHumSN0 = kDMinHumN0 * uFunTmMinSN0 * afOxySedN0 * aNHumSN0;
tPDifPO4EpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN 0.0 ELSE kPDifPO4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oPO4SN0 - oPO4WEpiN0 ) / aDepthDifN0 ENDIF;
tNDifNO3EpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN 0.0 ELSE kNDifNO3N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oNO3SN0 - oNO3WEpiN0 ) / aDepthDifN0 ENDIF;
tNDifNH4EpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN 0.0 ELSE kNDifNH4N0 * uFunTmDifN0 * cTurbDifNutN0 * bPorCorSN0 * (oNH4SN0 - oNH4WEpiN0 ) / aDepthDifN0 ENDIF;
tO2DifEpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN 0.0 ELSE kO2DifN0 / aDepthDifN0 * uFunTmDifN0 * cTurbDifO2N0 * bPorCorSN0 * oO2WEpiN0 ENDIF;
aPAdsMaxWEpiN0 = cRelPAdsDN0 + aCorO2BODEpiN0 * cRelPAdsFeN0 * fFeDIMN0 + cRelPAdsAlN0 * fAlDIMN0;
aKPAdsWEpiN0 = (1.0 - fRedMaxN0 * (1.0-aCorO2BODEpiN0)) * cKPAdsOxN0;
aPIsoAdsWEpiN0 = aPAdsMaxWEpiN0 * aKPAdsWEpiN0 * oPO4WEpiN0 / (1.0 + aKPAdsWEpiN0 * oPO4WEpiN0);
aPEqIMWEpiN0 = aPIsoAdsWEpiN0 * oDIMWEpiN0;
wPSorpIMWEpiN0 = kPSorpN0 * (aPEqIMWEpiN0 - oPAIMWEpiN0);
aPAdsMaxSN0 = cRelPAdsDN0 + afOxySedN0 * cRelPAdsFeN0 * fFeDIMN0 + cRelPAdsAlN0 * fAlDIMN0;
aKPAdsSN0 = (1.0 - fRedMaxN0 * (1.0-afOxySedN0)) * cKPAdsOxN0;
aPIsoAdsSN0 = aPAdsMaxSN0 * aKPAdsSN0 * oPO4SN0 / (1.0 + aKPAdsSN0 * oPO4SN0);
aPEqIMSN0 = aPIsoAdsSN0 * aDIMSN0;
tPSorpIMSN0 = kPSorpN0 * (aPEqIMSN0 - aPAIMSN0);
wO2AbioWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE tO2BubHypN0 / uDepthWHypN0 - wO2MinDetWHypN0 - wO2NitrWHypN0 - (tO2MinDetSN0 + tO2NitrSN0) / uDepthWHypN0 - (tInfO2WHypN0 / uDepthWHypN0) + (tSeepO2WHypN0 / uDepthWHypN0) ENDIF;
wPAbioDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE - wPMinDetWHypN0 - (tPSetDetHypN0 - tPSetDetEpiN0 - tPResusDetN0) / uDepthWHypN0 ENDIF;
wPAbioPO4WHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wPMinDetWHypN0 - wPSorpIMWHypN0 - (tPInfPO4WHypN0 / uDepthWHypN0) + ((tPSeepPO4WHypN0 + tPDifPO4HypN0 + tPResusPO4N0) / uDepthWHypN0) ENDIF;
wPAbioAIMWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (- tPSetAIMHypN0 +tPSetAIMEpiN0 + tPResusAIMN0) / uDepthWHypN0 + wPSorpIMWHypN0 ENDIF;
tPAbioTotTN0 = uPErosOMN0 - tPChemPO4N0 - tPInfPO4SN0 + tPSeepPO4SN0 - tPDifGroundPO4N0;
wNAbioNH4WHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNMinDetWHypN0 - wNNitrWHypN0 - (tNInfNH4WHypN0 / uDepthWHypN0) + ((tNSeepNH4WHypN0 + tNDifNH4HypN0 + tNResusNH4N0) / uDepthWHypN0) ENDIF;
wNAbioNO3WHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNNitrWHypN0 - wNDenitWHypN0 + ((tNDifNO3HypN0 + tNResusNO3N0 - tNInfNO3WHypN0 + tNSeepNO3WHypN0) / uDepthWHypN0) ENDIF;
wNAbioDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE - wNMinDetWHypN0 - (tNSetDetHypN0 -tNSetDetEpiN0 - tNResusDetN0 ) / uDepthWHypN0 ENDIF;
wSiAbioSiO2WHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wSiMinDetWHypN0 + (1.0 - fRefrDetSN0) * tSiMinDetSN0 / uDepthWHypN0 - tInfSiO2WHypN0 / uDepthWHypN0 + tSeepSiO2WHypN0 / uDepthWHypN0 ENDIF;
wSiAbioDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE - wSiMinDetWHypN0 - (tSiSetDetHypN0 -tSiSetDetEpiN0 - tSiResusDetN0) / uDepthWHypN0 ENDIF;
wDAbioDetWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (- tDSetDetHypN0 + tDSetDetEpiN0 + tDResusDetN0 ) / uDepthWHypN0 - wDMinDetWHypN0 ENDIF;
wDAbioIMWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (uDErosIMWN0 * fHypErosIMN0 - tDSetIMHypN0+ tDSetIMEpiN0 + tDResusIMN0) / uDepthWHypN0 ENDIF;
wDAbioIMWEpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN (uDErosIMWN0 * (1- fHypErosIMN0) - tDSetIMEpiN0 ) / uDepthWEpiN0 ELSE (uDErosIMWN0 * (1- fHypErosIMN0) - tDSetIMEpiN0 + tDResusIMN0) / uDepthWEpiN0 ENDIF;
wDAbioDetWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN (- tDSetDetEpiN0 ) / uDepthWEpiN0 - wDMinDetWEpiN0 ELSE (- tDSetDetEpiN0 + tDResusDetN0 ) / uDepthWEpiN0 - wDMinDetWEpiN0 ENDIF;
tDAbioIMSN0 = IF ( aInclStratN0 EQ TRUE ) THEN uDErosIMSN0 + tDSetIMHypN0 - tDResusIMN0 ELSE uDErosIMSN0 + tDSetIMEpiN0 - tDResusIMN0 ENDIF ;
tDAbioDetSN0 = IF ( aInclStratN0 EQ TRUE ) THEN tDSetDetHypN0 - tDResusDetN0 - tDMinDetSN0 ELSE tDSetDetEpiN0 - tDResusDetN0 - tDMinDetSN0 ENDIF ;
tDAbioHumSN0 = uDErosOMN0 + fRefrDetSN0 * tDMinDetSN0 - tDMinHumSN0;
tDAbioTotTN0 = cDErosTotN0 - wDMinDetWEpiN0 * uDepthWEpiN0 - wDMinDetWHypN0 * uDepthWHypN0 - (1.0 - fRefrDetSN0) * tDMinDetSN0 - tDMinHumSN0;
wO2AbioWEpiN0 = IF (aInclStratN0 EQ FALSE) THEN tO2AerEpiN0 / uDepthWEpiN0 - wO2MinDetWEpiN0 - wO2NitrWEpiN0 - (tO2MinDetSN0 + tO2NitrSN0) / uDepthWEpiN0 - tInfO2WEpiN0/uDepthWEpiN0 + tSeepO2WEpiN0/uDepthWEpiN0 ELSE tO2AerEpiN0 / uDepthWEpiN0 - wO2MinDetWEpiN0 - wO2NitrWEpiN0 ENDIF;
wO2AbioMN0 = tO2AerMN0 / uDepthWMN0 - wO2MinDetWMN0 - wO2NitrWMN0 - (tO2MinDetSMN0 + tO2NitrSMN0) / uDepthWMN0  - tInfO2WMN0 /uDepthWMN0  + tSeepO2WMN0 /uDepthWMN0 ;
wPAbioDetWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN - wPMinDetWEpiN0 - (tPSetDetEpiN0 ) / uDepthWEpiN0 ELSE - wPMinDetWEpiN0 - (tPSetDetEpiN0 - tPResusDetN0) / uDepthWEpiN0 ENDIF;
wPAbioPO4WEpiN0 =IF (aInclStratN0 EQ TRUE ) THEN wPMinDetWEpiN0 - wPSorpIMWEpiN0 + (tPDifPO4EpiN0 / uDepthWEpiN0) ELSE wPMinDetWEpiN0 - wPSorpIMWEpiN0 + ((tPSeepPO4WEpiN0 - tPInfPO4WEpiN0 + tPDifPO4EpiN0 + tPResusPO4N0) / uDepthWEpiN0) ENDIF;
wPAbioAIMWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN (- tPSetAIMEpiN0 ) / uDepthWEpiN0 + wPSorpIMWEpiN0 ELSE (- tPSetAIMEpiN0 + tPResusAIMN0 ) / uDepthWEpiN0 + wPSorpIMWEpiN0 ENDIF;
tPAbioDetSN0 = IF ( aInclStratN0 EQ TRUE ) THEN - tPMinDetSN0 + tPSetDetHypN0 - tPResusDetN0 ELSE - tPMinDetSN0 + tPSetDetEpiN0 - tPResusDetN0 ENDIF ;
tPAbioHumSN0 = uPErosOMN0 + fRefrDetSN0 * tPMinDetSN0 - tPMinHumSN0;
tPAbioPO4SN0 = IF ( aInclStratN0 EQ TRUE ) THEN tPInfPO4WHypN0 - tPSeepPO4WHypN0 - tPInfPO4SN0 + tPSeepPO4SN0 + (1.0-fRefrDetSN0) * tPMinDetSN0 + tPMinHumSN0 - tPSorpIMSN0 - tPResusPO4N0 - tPDifPO4HypN0 - tPDifGroundPO4N0 - tPChemPO4N0 ELSE tPInfPO4WEpiN0 - tPSeepPO4WEpiN0 - tPInfPO4SN0 + tPSeepPO4SN0 + (1.0-fRefrDetSN0) * tPMinDetSN0 + tPMinHumSN0 - tPSorpIMSN0 - tPResusPO4N0 - tPDifPO4EpiN0 - tPDifGroundPO4N0 - tPChemPO4N0 ENDIF;
tPAbioAIMSN0 = IF ( aInclStratN0 EQ TRUE ) THEN tPSetAIMHypN0 - tPResusAIMN0 + tPSorpIMSN0 ELSE tPSetAIMEpiN0 - tPResusAIMN0 + tPSorpIMSN0 ENDIF;
wNAbioNH4WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wNMinDetWEpiN0 - wNNitrWEpiN0 + (tNDifNH4EpiN0 / uDepthWEpiN0) ELSE wNMinDetWEpiN0 - wNNitrWEpiN0 + ((tNSeepNH4WEpiN0 - tNInfNH4WEpiN0 + tNDifNH4EpiN0 + tNResusNH4N0) / uDepthWEpiN0) ENDIF;
wNAbioNO3WEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wNNitrWEpiN0 - wNDenitWEpiN0 + (tNDifNO3EpiN0 / uDepthWEpiN0) ELSE wNNitrWEpiN0 - wNDenitWEpiN0 + ((tNDifNO3EpiN0 + tNResusNO3N0 - tNInfNO3WEpiN0 + tNSeepNO3WEpiN0) / uDepthWEpiN0) ENDIF;
wNAbioDetWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN - wNMinDetWEpiN0 - (tNSetDetEpiN0) / uDepthWEpiN0 ELSE - wNMinDetWEpiN0 - (tNSetDetEpiN0 - tNResusDetN0 ) / uDepthWEpiN0 ENDIF;
tNAbioNH4SN0 = IF ( aInclStratN0 EQ TRUE ) THEN tNInfNH4WHypN0 - tNSeepNH4WHypN0 - tNInfNH4SN0 + tNSeepNH4SN0 + (1.0-fRefrDetSN0) * tNMinDetSN0 + tNMinHumSN0 - tNResusNH4N0 - tNDifNH4HypN0 - tNDifGroundNH4N0 - tNNitrSN0 ELSE tNInfNH4WEpiN0 - tNSeepNH4WEpiN0 - tNInfNH4SN0 + tNSeepNH4SN0 + (1.0-fRefrDetSN0) * tNMinDetSN0 + tNMinHumSN0 - tNResusNH4N0 - tNDifNH4EpiN0 - tNDifGroundNH4N0 - tNNitrSN0 ENDIF;
tNAbioNO3SN0 = IF ( aInclStratN0 EQ TRUE ) THEN tNInfNO3WHypN0 - tNSeepNO3WHypN0 - tNInfNO3SN0 + tNSeepNO3SN0 + tNNitrSN0 - tNDenitSN0 - tNResusNO3N0 - tNDifNO3HypN0 - tNDifGroundNO3N0 ELSE tNInfNO3WEpiN0 - tNSeepNO3WEpiN0 - tNInfNO3SN0 + tNSeepNO3SN0 + tNNitrSN0 - tNDenitSN0 - tNResusNO3N0 - tNDifNO3EpiN0 - tNDifGroundNO3N0 ENDIF;
tNAbioDetSN0 = IF ( aInclStratN0 EQ TRUE ) THEN - tNMinDetSN0 + tNSetDetHypN0 - tNResusDetN0 ELSE - tNMinDetSN0 + tNSetDetEpiN0 - tNResusDetN0 ENDIF ;
tNAbioHumSN0 = uNErosOMN0 + fRefrDetSN0 * tNMinDetSN0 - tNMinHumSN0;
tNAbioTotTN0 = uNErosOMN0 - tNDenitSN0 - wNDenitWEpiN0 * uDepthWEpiN0 - wNDenitWHypN0 * uDepthWHypN0 - tNInfNH4SN0 - tNInfNO3SN0 + tNSeepNH4SN0 + tNSeepNO3SN0 - tNDifGroundNO3N0 - tNDifGroundNH4N0;
wSiAbioSiO2WEpiN0 = IF (aInclStratN0 EQ FALSE ) THEN wSiMinDetWEpiN0 + (1.0 - fRefrDetSN0) * tSiMinDetSN0 / uDepthWEpiN0 - tInfSiO2WEpiN0 / uDepthWEpiN0 + tSeepSiO2WEpiN0 / uDepthWEpiN0 ELSE wSiMinDetWEpiN0 ENDIF;
wSiAbioDetWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN - wSiMinDetWEpiN0 - (tSiSetDetEpiN0 ) / uDepthWEpiN0 ELSE - wSiMinDetWEpiN0 - (tSiSetDetEpiN0 - tSiResusDetN0) / uDepthWEpiN0 ENDIF;
tSiAbioDetSN0 = IF ( aInclStratN0 EQ TRUE ) THEN - tSiMinDetSN0 + tSiSetDetHypN0 - tSiResusDetN0 ELSE - tSiMinDetSN0 + tSiSetDetEpiN0 - tSiResusDetN0 ENDIF;
tDProdSubVegEpiN0 = bfSubVegEpiN0 * tDProdVegEpiN0;
tDMortVegWEpiN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tDMortVegEpiN0;
tDMortVegSEpiN0 = tDMortVegEpiN0 - tDMortVegWEpiN0;
tDBedVegN0 = IF InclVegN0 EQ TRUE THEN tDMigrVegN0 + tDProdVegEpiN0 + tDProdVegHypN0- tDRespVegN0 - tDMortVegEpiN0 - tDMortVegHypN0 - tDGrazVegBirdN0 - tDManVegN0 ELSE 0.0 ENDIF;
tO2ProdVegEpiN0 = molO2molCN0 * cCPerDWN0 * tDProdVegEpiN0;
tO2RespVegWEpiN0 = molO2molCN0 * cCPerDWN0 * bfSubVegEpiN0 * tDRespVegN0 * aCorO2BODEpiN0;
tO2ProdVegSEpiN0 = MIN (tO2RespVegSN0, tO2ProdVegEpiN0);
tO2ProdVegWEpiN0 = MIN ( tO2ProdVegEpiN0 - tO2ProdVegSEpiN0, bfSubVegN0 * tO2ProdVegEpiN0) ;
tO2BedSN0 = tO2ProdVegSHypN0 + tO2ProdVegSEpiN0 - tO2RespVegSN0 + tO2UptNO3VegSN0;
tO2UptNO3VegWEpiN0 = O2PerNO3N0 * molO2molNN0 * bfSubVegN0 * tNUptNO3VegWEpiN0;
tPMortVegEpiN0 = rPDVegN0 * tDMortVegEpiN0;
tPMortVegPO4EpiN0 = fDissMortVegN0 * tPMortVegEpiN0;
tPMortVegPO4SEpiN0 = bfRootVegN0 * tPMortVegPO4EpiN0;
tPMortVegPO4WEpiN0 = tPMortVegPO4EpiN0 - tPMortVegPO4SEpiN0;
tPMortVegDetEpiN0 = tPMortVegEpiN0 - tPMortVegPO4EpiN0;
tPMortVegDetWEpiN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tPMortVegDetEpiN0;
tPMortVegDetSEpiN0 = tPMortVegDetEpiN0 - tPMortVegDetWEpiN0;
tPBedVegN0 = IF InclVegN0 EQ TRUE THEN tPMigrVegN0 + tPUptVegEpiN0 + tPUptVegHypN0 - tPExcrVegN0 - tPMortVegEpiN0 - tPMortVegHypN0 - tPGrazVegBirdN0 - tPManVegN0 ELSE 0.0 ENDIF;
tNMortVegNH4WEpiN0 = tNMortVegNH4EpiN0 - tNMortVegNH4SEpiN0;
tNMortVegDetEpiN0 = tNMortVegEpiN0 - tNMortVegNH4EpiN0;
tNMortVegDetWEpiN0 = fDetWMortVegN0 * (1.0 - bfRootVegN0) * tNMortVegDetEpiN0;
tNMortVegDetSEpiN0 = tNMortVegDetEpiN0 - tNMortVegDetWEpiN0;
tNBedVegN0 = IF InclVegN0 EQ TRUE THEN tNMigrVegN0 + tNUptVegN0 - tNExcrVegN0 - tNMortVegEpiN0 - tNMortVegHypN0 - tNGrazVegBirdN0 - tNManVegN0 ELSE 0.0 ENDIF;
wDBedDetWEpiN0 = IF (InclVegN0 EQ TRUE) THEN (tDMortVegWEpiN0 + tDEgesBirdN0) / uDepthWEpiN0 ELSE 0.0 ENDIF;
tDBedDetSEpiN0 = IF ( InclVegN0 EQ TRUE) THEN tDMortVegSEpiN0 ELSE 0.0 ENDIF;
wPBedPO4WEpiN0 = IF (InclVegN0 EQ FALSE) THEN 0.0 ELSE (- tPUptVegWEpiN0 + tPExcrVegWN0 * uVegHeightEpiN0 / uVegHeightN0 + tPMortVegPO4WEpiN0 + tPEgesBirdPO4N0) /uDepthWEpiN0 ENDIF;
wPBedDetWEpiN0 = IF (InclVegN0 EQ TRUE) THEN (tPMortVegDetWEpiN0 + tPEgesBirdDetN0) / uDepthWEpiN0 ELSE 0.0 ENDIF;
tPBedPO4SN0 = IF ( InclVegN0 EQ TRUE) THEN - tPUptVegSN0 + tPExcrVegSN0 + tPMortVegPO4SEpiN0 + tPMortVegPO4SHypN0 ELSE 0.0 ENDIF;
tPBedDetSN0 = IF (InclVegN0 EQ TRUE) THEN tPMortVegDetSEpiN0 + tPMortVegDetSHypN0 ELSE 0.0 ENDIF;
wNBedNH4WEpiN0 = IF ( InclVegN0 EQ TRUE ) THEN (- tNUptNH4VegWEpiN0 + tNExcrVegWN0 * (uVegHeightEpiN0 /uVegHeightN0 ) + tNMortVegNH4WEpiN0 + tNEgesBirdNH4N0) / uDepthWEpiN0 ELSE 0.0 ENDIF;
wNBedNO3WEpiN0 = IF ( InclVegN0 EQ TRUE) THEN - tNUptNO3VegWEpiN0 / uDepthWEpiN0 ELSE 0.0 ENDIF;
wNBedDetWEpiN0 = IF (InclVegN0 EQ TRUE) THEN (tNMortVegDetWEpiN0 + tNEgesBirdDetN0) / uDepthWEpiN0 ELSE 0.0 ENDIF;
tNBedNH4SN0 = IF ( InclVegN0 EQ TRUE) THEN - tNUptNH4VegSN0 + tNExcrVegSN0 + tNMortVegNH4SEpiN0 + tNMortVegNH4SHypN0 ELSE 0.0 ENDIF;
tNBedNO3SN0 = IF ( InclVegN0 EQ TRUE ) THEN - tNUptNO3VegSN0 ELSE 0.0 ENDIF;
tNBedDetSN0 = IF ( InclVegN0 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN0 EQ TRUE) THEN tNMortVegDetSEpiN0 + tNMortVegDetSHypN0 ELSE tNMortVegDetSEpiN0 ENDIF;
tO2BedWEpiN0 = IF ( InclVegN0 EQ TRUE ) THEN tO2ProdVegWEpiN0 - tO2RespVegWEpiN0 + tO2UptNO3VegWEpiN0 ELSE 0.0 ENDIF;
rPDBlueWEpiN0 = oPBlueWEpiN0 /(oDBlueWEpiN0+NearZeroN0);
aVPUptMaxCrBlueEpiN0 = MAX(0.0,cVPUptMaxBlueN0 * uFunTmProdBlueEpiN0 *(cPDBlueMaxN0 - rPDBlueWEpiN0) /(cPDBlueMaxN0 - cPDBlueMinN0));
aVPUptBlueEpiN0 = oPO4WEpiN0 * aVPUptMaxCrBlueEpiN0 /(aVPUptMaxCrBlueEpiN0 / cAffPUptBlueN0 + oPO4WEpiN0);
wPUptBlueEpiN0 = aVPUptBlueEpiN0 * oDBlueWEpiN0;
rNDBlueWEpiN0 = oNBlueWEpiN0 /(oDBlueWEpiN0+NearZeroN0);
aVNUptMaxCrBlueEpiN0 = MAX(0.0,cVNUptMaxBlueN0 * uFunTmProdBlueEpiN0 * (cNDBlueMaxN0 - rNDBlueWEpiN0) /(cNDBlueMaxN0 - cNDBlueMinN0));
ahNUptBlueEpiN0 = aVNUptMaxCrBlueEpiN0 / cAffNUptBlueN0;
aVNUptBlueEpiN0 = oNDissWEpiN0 * aVNUptMaxCrBlueEpiN0 /(ahNUptBlueEpiN0 + oNDissWEpiN0);
wNUptBlueEpiN0 = aVNUptBlueEpiN0 * oDBlueWEpiN0;
tNUptBlueEpiN0 = wNUptBlueEpiN0 * uDepthWEpiN0;
aLLimBlueEpiN0 = UseSteeleBlueN0 *(EXP(1.0) /(aExtCoefEpiN0 * uDepthWEpiN0) *(EXP(- aLPARBotEpiN0 /(cLOptRefBlueN0 * uFunTmProdBlueEpiN0)) - EXP(- aLPARBotSurfN0 /(cLOptRefBlueN0 * uFunTmProdBlueEpiN0)))) +(1.0 - UseSteeleBlueN0) *(1.0 /(aExtCoefEpiN0 * uDepthWEpiN0) * LN((1.0 + aLPARBotSurfN0 / (hLRefBlueN0 * uFunTmProdBlueEpiN0)) / (1.0 + aLPARBotEpiN0 /(hLRefBlueN0 * uFunTmProdBlueEpiN0))));
rChDBlueEpiN0 = cChDBlueMaxN0 -(cChDBlueMaxN0 - cChDBlueMinN0) * aLLimBlueEpiN0;
aChlaBlueEpiN0 = mgPergN0 * rChDBlueEpiN0 * aDBlueWEpiN0;
aNfixBlueEpiN0 = rNfixBlueEpiN0 *aChlaBlueEpiN0 /ugPergN0;
afNH4UptBlueEpiN0 = oNH4WEpiN0 * oNO3WEpiN0 /((ahNUptBlueEpiN0 + oNH4WEpiN0) *(ahNUptBlueEpiN0 + oNO3WEpiN0)) + oNH4WEpiN0 * ahNUptBlueEpiN0 /((oNH4WEpiN0 + oNO3WEpiN0) *(ahNUptBlueEpiN0 + oNO3WEpiN0));
tNUptBlueAirEpiN0 = IF (InclNfixN0 EQ FALSE) THEN 0.0 ELSE aNfixBlueEpiN0 ENDIF;
tNUptBlueWEpiN0 = IF (InclNfixN0 EQ FALSE) THEN tNUptBlueEpiN0 ELSE tNUptBlueEpiN0 - tNUptBlueAirEpiN0 ENDIF;
wNUptBlueWEpiN0 = tNUptBlueWEpiN0 / uDepthWEpiN0;
wNUptNH4BlueEpiN0 = afNH4UptBlueEpiN0 * wNUptBlueWEpiN0;
wNUptNO3BlueEpiN0 = wNUptBlueWEpiN0 - wNUptNH4BlueEpiN0;
aPLimBlueEpiN0 = MAX(0.0,(1.0 - cPDBlueMinN0 / rPDBlueWEpiN0) * cPDBlueMaxN0 /(cPDBlueMaxN0 - cPDBlueMinN0));
aNLimBlueEpiN0 = MAX(0.0,(1.0 - cNDBlueMinN0 / rNDBlueWEpiN0) * cNDBlueMaxN0 /(cNDBlueMaxN0 - cNDBlueMinN0));
aSiLimBlueEpiN0 = oSiO2WEpiN0 /(hSiAssBlueN0 + oSiO2WEpiN0);
aMuTmLBlueEpiN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimBlueEpiN0 * uMuMaxTmBlueEpiN0;
aNutLimBlueEpiN0 = MIN(aPLimBlueEpiN0 , (MIN(aNLimBlueEpiN0,aSiLimBlueEpiN0)));
aMuBlueEpiN0 = aNutLimBlueEpiN0 * aMuTmLBlueEpiN0;
wDAssBlueEpiN0 = aMuBlueEpiN0*oDBlueWEpiN0;
oChlaBlueEpiN0 = mgPergN0 * rChDBlueEpiN0 * oDBlueWEpiN0;
aLLimBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN -9999 ELSE MAX(0.0,UseSteeleBlueN0 *(EXP(1.0) /(aExtSurfN0) *(EXP(- aLPARBotSurfN0/(cLOptRefBlueN0 *  uFunTmProdBlueSurfN0)) - EXP(- uLPARSurfN0 /(cLOptRefBlueN0 *  uFunTmProdBlueSurfN0)))) +(1.0 - UseSteeleBlueN0) *(1.0 /(aExtSurfN0) * LN((1.0 + uLPARSurfN0 / (hLRefBlueN0 * uFunTmProdBlueSurfN0)) / (1.0 + aLPARBotSurfN0 /(hLRefBlueN0 * uFunTmProdBlueSurfN0))))) ENDIF;
aRepLLimBlueN0 = (aLLimBlueSurfN0* aDBlueSurfN0 + aLLimBlueEpiN0* aDBlueWEpiN0) / (aDBlueSurfN0 + aDBlueWEpiN0);
rChDBlueSurfN0 = cChDBlueMaxN0 -(cChDBlueMaxN0 - cChDBlueMinN0) * aLLimBlueSurfN0;
aChlaBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE mgPergN0 * rChDBlueSurfN0 * aDBlueSurfN0 ENDIF;
oChlaBlueWN0 = IF ( aInclStratN0 EQ TRUE ) THEN (oChlaBlueEpiN0 * uDepthWEpiN0 + oChlaBlueHypN0 * uDepthWHypN0) / uDepthWN0 ELSE (oChlaBlueEpiN0 * uDepthWEpiN0) / uDepthWN0 ENDIF;
oChlaBlueN0 = IF ( aInclStratN0 EQ TRUE ) THEN (oChlaBlueEpiN0 * uDepthWEpiN0 + oChlaBlueHypN0 * uDepthWHypN0 + aChlaBlueSurfN0) / uDepthWN0 ELSE (oChlaBlueEpiN0 * uDepthWEpiN0 + aChlaBlueSurfN0 ) / uDepthWN0 ENDIF;
aChlaLimFloBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE (1.0 - (POW ((aChlaBlueSurfN0 / cDepthSurfN0) , (-cStepPowN0))) / ((POW (cChlaThrBlueN0 , (-cStepPowN0))) + (POW ((aChlaBlueSurfN0 / cDepthSurfN0) , (-cStepPowN0))))) ENDIF;
aChlaLimFloBlueEpiN0 = IF (InclSurfN0 EQ FALSE  OR aDBlueWEpiN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE (1.0 - (POW (oChlaBlueEpiN0 , (-cStepPowN0))) / ((POW (cChlaThrBlueN0 , (-cStepPowN0))) + (POW (oChlaBlueEpiN0 , (-cStepPowN0))))) ENDIF;
aChlaLimFloBlueHypN0 = IF (aInclStratN0 EQ FALSE OR aDBlueWHypN0 LT cDBlueSurfMinN0) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (oChlaBlueHypN0 , (-cStepPowN0))) / ((POW (cChlaThrBlueN0 , (-cStepPowN0))) + (POW (oChlaBlueHypN0 , (-cStepPowN0))))) ENDIF;
aVWLimFloBlueN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uVWindN0 , cStepPowN0)) / ((POW (cVWindThrBlueN0 , cStepPowN0)) + (POW (uVWindN0 , cStepPowN0)))) ENDIF;
aTmLimFloBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE (1.0 - (POW (uTmSurfN0 , (-cStepPowN0))) / ((POW (cTmThrBlueN0 , (-cStepPowN0))) + (POW (uTmSurfN0 , (-cStepPowN0))))) ENDIF;
aTmLimFloBlueEpiN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE (1.0 - (POW (uTmEpiN0 , (-cStepPowN0))) / ((POW (cTmThrBlueN0 , (-cStepPowN0))) + (POW (uTmEpiN0 , (-cStepPowN0))))) ENDIF;
aTmLimFloBlueHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uTmHypN0 , (-cStepPowN0))) / ((POW (cTmThrBlueN0 , (-cStepPowN0))) + (POW (uTmHypN0 , (-cStepPowN0))))) ENDIF;
aTrigFloBlueSurfN0 =  aVWLimFloBlueN0 * aTmLimFloBlueSurfN0 * aChlaLimFloBlueSurfN0;
aTrigFloBlueEpiN0 =  aVWLimFloBlueN0 * aTmLimFloBlueEpiN0 * aChlaLimFloBlueEpiN0;
aTrigFloBlueHypN0 =   aTmLimFloBlueHypN0 * aChlaLimFloBlueHypN0;
uVFloBlueSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE aTrigFloBlueSurfN0 * cVFloMaxBlueWN0 ENDIF;
uVFloBlueEpiN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueEpiN0 * cVFloMaxBlueWN0 ENDIF;
uVFloBlueHypN0 =  IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueHypN0 * cVFloMaxBlueWN0 ENDIF;
uVBlueHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE) THEN  - uCorVSetBlueHypN0 ELSE  uVFloBlueHypN0 - uCorVSetBlueHypN0  ENDIF;
tDSetBlueHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN0 LT 0.0) THEN - uVBlueHypN0 * oDBlueWHypN0 ELSE 0.0 ENDIF;
tPSetBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN0 * tDSetBlueHypN0 ENDIF;
tNSetBlueHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN0 * tDSetBlueHypN0 ENDIF;
tDFloBlueHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN0 GE 0.0) THEN uVBlueHypN0 * oDBlueWHypN0 ELSE 0.0 ENDIF;
tPFloBlueHypN0 =  tDFloBlueHypN0  * rPDBlueWHypN0;
tNFloBlueHypN0 =  tDFloBlueHypN0  * rNDBlueWHypN0;
uVBlueEpiN0 = IF (InclSurfN0 EQ TRUE) THEN uVFloBlueEpiN0 - uCorVSetBlueEpiN0 ELSE - uCorVSetBlueEpiN0 ENDIF;
tDSetBlueEpiN0 = IF (uVBlueEpiN0 LT 0.0) THEN - uVBlueEpiN0 * oDBlueWEpiN0 ELSE 0.0 ENDIF;
tDFloBlueEpiN0 = IF (uVBlueEpiN0 GE 0.0) THEN uVBlueEpiN0 * oDBlueWEpiN0 ELSE 0.0 ENDIF;
tNSetBlueEpiN0 = rNDBlueWEpiN0 * tDSetBlueEpiN0;
tNFloBlueEpiN0 =  tDFloBlueEpiN0  * rNDBlueWEpiN0;
tPSetBlueEpiN0 = rPDBlueWEpiN0 * tDSetBlueEpiN0;
tPFloBlueEpiN0 =  tDFloBlueEpiN0  * rPDBlueWEpiN0;
aFunTauSetOMSurfN0 =MIN(1.0 / POW(aFunDimSuspN0 +NearZeroN0 , (0.5)), 1.0);
uFunTmSetSurfN0 = POW(cThetaSetN0 , (uTmSurfN0-cTmRefN0));
uCorVSetBlueSurfN0 = (cVSetBlueN0 + uQOutInfN0 /mmPermN0 - uQInSeepN0 / mmPermN0) * aFunTauSetOMSurfN0 * uFunTmSetSurfN0;
uVBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN - uCorVSetBlueSurfN0 ELSE uVFloBlueSurfN0 - uCorVSetBlueSurfN0 ENDIF;
tDSetBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSEIF (uVBlueSurfN0 LT 0.0) THEN aDBlueSurfN0  / cDepthSurfN0 * (- uVBlueSurfN0) ELSE 0.0 ENDIF;
rNDBlueSurfN0 = aNBlueSurfN0 / (aDBlueSurfN0 + NearZeroN0);
tNSetBlueSurfN0 = rNDBlueSurfN0 * tDSetBlueSurfN0;
rPDBlueSurfN0 = aPBlueSurfN0 / (aDBlueSurfN0 + NearZeroN0);
tPSetBlueSurfN0 = rPDBlueSurfN0 * tDSetBlueSurfN0;
rPDGrenWHypN0 = oPGrenWHypN0 /(oDGrenWHypN0+NearZeroN0);
aVPUptMaxCrGrenHypN0 = MAX(0.0,cVPUptMaxGrenN0 * uFunTmProdGrenHypN0 *(cPDGrenMaxN0 - rPDGrenWHypN0) /(cPDGrenMaxN0 - cPDGrenMinN0));
aVPUptGrenHypN0 = oPO4WHypN0 * aVPUptMaxCrGrenHypN0 /(aVPUptMaxCrGrenHypN0 / cAffPUptGrenN0 + oPO4WHypN0);
wPUptGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aVPUptGrenHypN0 * oDGrenWHypN0 ENDIF;
wPUptPhytHypN0 = wPUptDiatHypN0 + wPUptGrenHypN0 + wPUptBlueHypN0;
wPExcrGrenWHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE (2.0 *rPDGrenWHypN0) /(cPDGrenMaxN0 + rPDGrenWHypN0) * rPDGrenWHypN0 * wDRespGrenWHypN0 ENDIF;
wPExcrPhytWHypN0 = wPExcrDiatWHypN0 + wPExcrGrenWHypN0 + wPExcrBlueWHypN0;
aPLimGrenHypN0 = MAX(0.0,(1.0 - cPDGrenMinN0 / rPDGrenWHypN0) * cPDGrenMaxN0 /(cPDGrenMaxN0 - cPDGrenMinN0));
aNutLimGrenHypN0 = MIN(aPLimGrenHypN0,(MIN(aNLimGrenHypN0,aSiLimGrenHypN0)));
aMuGrenHypN0 = aNutLimGrenHypN0 * aMuTmLGrenHypN0;
wDAssGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE aMuGrenHypN0*oDGrenWHypN0 ENDIF;
wDPrimGrenWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wDAssGrenHypN0 - wDRespGrenWHypN0 - wDLossGrenHypN0 - wDMortGrenWHypN0 -(tDSetGrenHypN0 -tDSetGrenEpiN0 - tDResusGrenN0) / uDepthWHypN0 ENDIF;
wDAssPhytHypN0 = wDAssDiatHypN0 + wDAssGrenHypN0 + wDAssBlueHypN0;
wO2ProdPhytHypN0 = molO2molCN0 * cCPerDWN0 * wDAssPhytHypN0;
wO2PrimWHypN0 = wO2ProdPhytHypN0 - wO2RespPhytWHypN0 + wO2UptNO3PhytHypN0;
wPLossGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN0 * wDLossGrenHypN0 ENDIF;
wPLossPhytHypN0 = wPLossDiatHypN0 + wPLossGrenHypN0 + wPLossBlueHypN0;
wPLossPhytPO4HypN0 = fDissLossN0 * wPLossPhytHypN0;
wPLossPhytDetHypN0 = wPLossPhytHypN0 - wPLossPhytPO4HypN0;
wPPrimDetWHypN0 = wPLossPhytDetHypN0 + wPMortPhytDetWHypN0;
wPPrimPO4WHypN0 = - wPUptPhytHypN0 + wPExcrPhytWHypN0 + wPLossPhytPO4HypN0 + wPMortPhytPO4WHypN0;
tPSetGrenHypN0 =IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN0 * tDSetGrenHypN0 ENDIF;
wPPrimGrenWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wPUptGrenHypN0 - wPExcrGrenWHypN0 - wPLossGrenHypN0 - wPMortGrenWHypN0 -(tPSetGrenHypN0 -tPSetGrenEpiN0 - tPResusGrenN0) / uDepthWHypN0 ENDIF;
wPConsGrenZooHypN0 = rPDGrenWHypN0 * wDConsGrenZooHypN0;
wPConsPhytZooHypN0 = wPConsDiatZooHypN0 + wPConsGrenZooHypN0 + wPConsBlueZooHypN0;
wPConsZooHypN0 = wPConsPhytZooHypN0 + wPConsDetZooHypN0;
wPAssZooHypN0 = afPAssZooHypN0 * wPConsZooHypN0;
wPEgesZooHypN0 = wPConsZooHypN0 - wPAssZooHypN0;
wPEgesZooPO4HypN0 = fDissEgesZooN0*wPEgesZooHypN0;
wPEgesZooDetHypN0 = wPEgesZooHypN0 - wPEgesZooPO4HypN0;
aPConsZooSpHypN0 = wPConsZooHypN0 / oPZooHypN0;
aPGrazSpHypN0 = wPConsZooHypN0 / oPOMWHypN0;
wDPrimBlueWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wDAssBlueHypN0 - wDRespBlueWHypN0 - wDLossBlueHypN0 - wDMortBlueWHypN0 + (tDResusBlueN0 + tDSetBlueEpiN0 - tDSetBlueHypN0 - tDFloBlueHypN0) / uDepthWHypN0 ENDIF;
wPPrimBlueWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wPUptBlueHypN0 - wPExcrBlueWHypN0 - wPLossBlueHypN0 - wPMortBlueWHypN0+ (tPResusBlueN0 + tPSetBlueEpiN0 - tPSetBlueHypN0 - tPFloBlueHypN0) / uDepthWHypN0 ENDIF;
wNPrimBlueWHypN0 = IF (aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNUptBlueHypN0 - wNExcrBlueWHypN0 - wNLossBlueHypN0 - wNMortBlueWHypN0+ (tNResusBlueN0 + tNSetBlueEpiN0 - tNSetBlueHypN0 - tNFloBlueHypN0) / uDepthWHypN0 ENDIF;
tDSetPhytHypN0 = tDSetDiatHypN0 + tDSetGrenHypN0 + tDSetBlueHypN0;
wDPrimPhytWHypN0 = wDPrimDiatWHypN0 + wDPrimGrenWHypN0 + wDPrimBlueWHypN0;
tPSetPhytHypN0 = tPSetDiatHypN0 + tPSetGrenHypN0 + tPSetBlueHypN0;
wPPrimPhytWHypN0 = wPPrimDiatWHypN0 + wPPrimGrenWHypN0 + wPPrimBlueWHypN0;
tNSetPhytHypN0 = tNSetDiatHypN0 + tNSetGrenHypN0 + tNSetBlueHypN0;
wNPrimPhytWHypN0 = wNPrimDiatWHypN0 + wNPrimGrenWHypN0 + wNPrimBlueWHypN0;
tDSetTotHypN0 = tDSetIMHypN0 + tDSetDetHypN0 + tDSetPhytHypN0;
tPSetTotHypN0 = tPSetAIMHypN0 + tPSetDetHypN0 + tPSetPhytHypN0;
tNSetTotHypN0 = tNSetDetHypN0 + tNSetPhytHypN0;
aLLimGrenEpiN0 = UseSteeleGrenN0 *(EXP(1.0) /(aExtCoefEpiN0 * uDepthWEpiN0) *(EXP(- aLPARBotEpiN0 /(cLOptRefGrenN0 * uFunTmProdGrenEpiN0)) - EXP(- aLPARBotSurfN0 /(cLOptRefGrenN0 * uFunTmProdGrenEpiN0)))) +(1.0 - UseSteeleGrenN0) *(1.0 /(aExtCoefEpiN0 * uDepthWEpiN0) * LN((1.0 + aLPARBotSurfN0 / (hLRefGrenN0 * uFunTmProdGrenEpiN0)) / (1.0 + aLPARBotEpiN0 /(hLRefGrenN0 * uFunTmProdGrenEpiN0))));
rChDGrenEpiN0 = cChDGrenMaxN0 -(cChDGrenMaxN0 - cChDGrenMinN0) * aLLimGrenEpiN0;
oChlaGrenEpiN0 = mgPergN0 * rChDGrenEpiN0 * oDGrenWEpiN0;
aLLimDiatEpiN0 = UseSteeleDiatN0 *(EXP(1.0) /(aExtCoefEpiN0 * uDepthWEpiN0) *(EXP(- aLPARBotEpiN0 /(cLOptRefDiatN0 * uFunTmProdDiatEpiN0)) - EXP(- aLPARBotSurfN0 /(cLOptRefDiatN0 * uFunTmProdDiatEpiN0)))) +(1.0 - UseSteeleDiatN0) *(1.0 /(aExtCoefEpiN0 * uDepthWEpiN0) * LN((1.0 + aLPARBotSurfN0 / (hLRefDiatN0 * uFunTmProdDiatEpiN0)) / (1.0 + aLPARBotEpiN0 /(hLRefDiatN0 * uFunTmProdDiatEpiN0))));
rChDDiatEpiN0 = cChDDiatMaxN0 -(cChDDiatMaxN0 - cChDDiatMinN0) * aLLimDiatEpiN0;
oChlaDiatEpiN0 = mgPergN0 * rChDDiatEpiN0 * oDDiatWEpiN0;
oChlaEpiN0 = oChlaDiatEpiN0 + oChlaGrenEpiN0 + oChlaBlueEpiN0;
wDRespBlueWEpiN0 = ukDRespTmBlueEpiN0 * oDBlueWEpiN0;
wDLossBlueEpiN0 = ukLossTmBlueEpiN0 * oDBlueWEpiN0;
wDMortBlueWEpiN0 = kMortBlueWN0 * oDBlueWEpiN0;
ukDDecBlueEpiN0 = ukDRespTmBlueEpiN0 + ukLossTmBlueEpiN0 + kMortBlueWN0 +(uCorVSetBlueEpiN0 * uFunTmSetEpiN0) / uDepthWEpiN0;
wPExcrBlueWEpiN0 = (rPDBlueWEpiN0 * 2.0 )/(cPDBlueMaxN0 + rPDBlueWEpiN0) * rPDBlueWEpiN0 * wDRespBlueWEpiN0 ;
wPLossBlueEpiN0 = rPDBlueWEpiN0 * wDLossBlueEpiN0;
wPMortBlueWEpiN0 = kMortBlueWN0 * oPBlueWEpiN0;
wNExcrBlueWEpiN0 = (rNDBlueWEpiN0 *2.0)/(cNDBlueMaxN0 + rNDBlueWEpiN0) * rNDBlueWEpiN0 * wDRespBlueWEpiN0 ;
wNLossBlueEpiN0 = rNDBlueWEpiN0 * wDLossBlueEpiN0;
wNMortBlueWEpiN0 = kMortBlueWN0 * oNBlueWEpiN0;
wDPrimBlueWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wDAssBlueEpiN0 - wDRespBlueWEpiN0 - wDLossBlueEpiN0 - wDMortBlueWEpiN0 + (tDSetBlueSurfN0-tDFloBlueEpiN0 + tDFloBlueHypN0- tDSetBlueEpiN0 ) / uDepthWEpiN0 ELSE wDAssBlueEpiN0 - wDRespBlueWEpiN0 - wDLossBlueEpiN0 - wDMortBlueWEpiN0 + (tDResusBlueN0 + tDSetBlueSurfN0 - tDSetBlueEpiN0 -  tDFloBlueEpiN0) / uDepthWEpiN0 ENDIF;
wPPrimBlueWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wPUptBlueEpiN0 - wPExcrBlueWEpiN0 - wPLossBlueEpiN0 - wPMortBlueWEpiN0+ (tPSetBlueSurfN0-tPFloBlueEpiN0 + tPFloBlueHypN0- tPSetBlueEpiN0 ) / uDepthWEpiN0 ELSE wPUptBlueEpiN0 - wPExcrBlueWEpiN0 - wPLossBlueEpiN0 - wPMortBlueWEpiN0+ (tPResusBlueN0 + tPSetBlueSurfN0 - tPSetBlueEpiN0 -  tPFloBlueEpiN0) / uDepthWEpiN0 ENDIF;
wNPrimBlueWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wNUptBlueEpiN0 - wNExcrBlueWEpiN0 - wNLossBlueEpiN0 - wNMortBlueWEpiN0 + (tNSetBlueSurfN0-tNFloBlueEpiN0 + tNFloBlueHypN0- tNSetBlueEpiN0 ) / uDepthWEpiN0 ELSE wNUptBlueEpiN0 - wNExcrBlueWEpiN0 - wNLossBlueEpiN0 - wNMortBlueWEpiN0+ (tNResusBlueN0 + tNSetBlueSurfN0 - tNSetBlueEpiN0 -  tNFloBlueEpiN0) / uDepthWEpiN0 ENDIF;
ukDilSurfN0 = ukOutEpiN0;
tDDilBlueSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE ukDilSurfN0 * aDBlueSurfN0 ENDIF;
tNDilBlueSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE ukDilSurfN0 * aNBlueSurfN0 ENDIF;
tPDilBlueSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE ukDilSurfN0 * aPBlueSurfN0 ENDIF;
tDTranBlueSurfN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE uDLoadBlueSurfN0 - tDDilBlueSurfN0 ENDIF;
tPTranBlueSurfN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE uPLoadBlueSurfN0 - tPDilBlueSurfN0 ENDIF;
tNTranBlueSurfN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSEIF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE uNLoadBlueSurfN0 - tNDilBlueSurfN0 ENDIF;
uMuMaxTmBlueSurfN0 = cMuMaxBlueN0 * uFunTmProdBlueSurfN0;
aMuTmLBlueSurfN0 = ufDayN0 * aLLimBlueSurfN0 * uMuMaxTmBlueSurfN0;
aPLimBlueSurfN0 = MAX(0.0,(1.0 - cPDBlueMinN0 / rPDBlueSurfN0) * cPDBlueMaxN0 /(cPDBlueMaxN0 - cPDBlueMinN0));
aNLimBlueSurfN0 = MAX(0.0,(1.0 - cNDBlueMinN0 / rNDBlueSurfN0) * cNDBlueMaxN0 /(cNDBlueMaxN0 - cNDBlueMinN0));
aSiLimBlueSurfN0 = oSiO2WEpiN0 /(hSiAssBlueN0 + oSiO2WEpiN0);
aNutLimBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN -9999 ELSE MIN(aPLimBlueSurfN0,MIN(aNLimBlueSurfN0,aSiLimBlueSurfN0)) ENDIF;
aRepPLimBlueN0 = (aPLimBlueSurfN0* aDBlueSurfN0 + aPLimBlueEpiN0* aDBlueWEpiN0) / (aDBlueSurfN0 + aDBlueWEpiN0);
aRepNLimBlueN0 = (aNLimBlueSurfN0* aDBlueSurfN0 + aNLimBlueEpiN0* aDBlueWEpiN0) / (aDBlueSurfN0 + aDBlueWEpiN0);
aRepNutLimBlueN0 = (aNutLimBlueSurfN0* aDBlueSurfN0 + aNutLimBlueEpiN0* aDBlueWEpiN0) / (aDBlueSurfN0 + aDBlueWEpiN0);
aMuBlueSurfN0 = aNutLimBlueSurfN0 * aMuTmLBlueSurfN0;
tDAssBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE aMuBlueSurfN0 * aDBlueSurfN0 ENDIF;
aVNUptMaxCrBlueSurfN0 = MAX(0.0,cVNUptMaxBlueN0 * uFunTmProdBlueSurfN0 * (cNDBlueMaxN0 - rNDBlueSurfN0) /(cNDBlueMaxN0 - cNDBlueMinN0));
aVPUptMaxCrBlueSurfN0 = MAX(0.0,cVPUptMaxBlueN0 * uFunTmProdBlueSurfN0 *(cPDBlueMaxN0 - rPDBlueSurfN0) /(cPDBlueMaxN0 - cPDBlueMinN0));
ahNUptBlueSurfN0 = aVNUptMaxCrBlueSurfN0 / cAffNUptBlueN0;
aVNUptBlueSurfN0 = oNDissWEpiN0 * aVNUptMaxCrBlueSurfN0 /(ahNUptBlueSurfN0 + oNDissWEpiN0);
aVPUptBlueSurfN0 = oPO4WEpiN0 * aVPUptMaxCrBlueSurfN0 /(aVPUptMaxCrBlueSurfN0 / cAffPUptBlueN0 + oPO4WEpiN0);
tNUptBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE aVNUptBlueSurfN0 * aDBlueSurfN0 ENDIF;
aNfixBlueSurfN0 = rNfixBlueSurfN0 *aChlaBlueSurfN0 /ugPergN0;
tNUptBlueAirSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSEIF (InclNfixN0 EQ FALSE) THEN 0.0 ELSE aNfixBlueSurfN0 ENDIF;
tNUptBlueWSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSEIF (InclNfixN0 EQ FALSE) THEN tNUptBlueSurfN0 ELSE tNUptBlueSurfN0 - tNUptBlueAirSurfN0 ENDIF;
afNH4UptBlueSurfN0 = oNH4WEpiN0 * oNO3WEpiN0 /((ahNUptBlueSurfN0 + oNH4WEpiN0) *(ahNUptBlueSurfN0 + oNO3WEpiN0)) + oNH4WEpiN0 * ahNUptBlueSurfN0 /((oNH4WEpiN0 + oNO3WEpiN0) *(ahNUptBlueSurfN0 + oNO3WEpiN0));
tNUptNH4BlueSurfN0 = afNH4UptBlueSurfN0 * tNUptBlueWSurfN0;
tNUptNO3BlueSurfN0 = tNUptBlueWSurfN0 - tNUptNH4BlueSurfN0;
tPUptBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE aVPUptBlueSurfN0 * aDBlueSurfN0 ENDIF;
tDRespBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE ukDRespTmBlueSurfN0 *aDBlueSurfN0 ENDIF;
tNExcrBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE (rNDBlueSurfN0 * 2.0 )/(cNDBlueMaxN0 + rNDBlueSurfN0) * rNDBlueSurfN0 * tDRespBlueSurfN0 ENDIF;
tPExcrBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE (rPDBlueSurfN0 * 2.0 )/(cPDBlueMaxN0 + rPDBlueSurfN0) * rPDBlueSurfN0 * tDRespBlueSurfN0 ENDIF;
tDMortBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE kMortBlueWN0 * aDBlueSurfN0 ENDIF;
tNMortBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE kMortBlueWN0 * aNBlueSurfN0 ENDIF;
wNMortBlueNH4WSurfN0 = fDissMortPhytN0 * tNMortBlueSurfN0 / uDepthWEpiN0;
wNMortBlueDetSurfN0 = ( 1 -fDissMortPhytN0) * tNMortBlueSurfN0 / uDepthWEpiN0;
tPMortBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE kMortBlueWN0 * aPBlueSurfN0 ENDIF;
uFunTmLossSurfN0 = EXP(-0.5/(cSigTmLossN0*cSigTmLossN0) *((uTmSurfN0-cTmOptLossN0)*(uTmSurfN0-cTmOptLossN0) -(cTmRefN0-cTmOptLossN0)*(cTmRefN0-cTmOptLossN0)));
ukLossTmBlueSurfN0 = UseLossN0 * kLossBlueN0 * uFunTmLossSurfN0;
tDLossBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE ukLossTmBlueSurfN0 * aDBlueSurfN0 ENDIF;
tPLossBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE rPDBlueSurfN0 * tDLossBlueSurfN0 ENDIF;
tNLossBlueSurfN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE rNDBlueSurfN0 * tDLossBlueSurfN0 ENDIF;
tDPrimBlueSurfN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE tDAssBlueSurfN0 - tDRespBlueSurfN0 + tDFloBlueEpiN0 - tDSetBlueSurfN0- tDMortBlueSurfN0 ENDIF;
tNPrimBlueSurfN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE tNUptBlueSurfN0 - tNExcrBlueSurfN0  + tNFloBlueEpiN0 - tNSetBlueSurfN0 - tNMortBlueSurfN0 ENDIF;
tPPrimBlueSurfN0 = IF (InclSurfN0 EQ FALSE) THEN 0.0 ELSE tPUptBlueSurfN0 - tPExcrBlueSurfN0 + tPFloBlueEpiN0 - tPSetBlueSurfN0- tPMortBlueSurfN0 ENDIF;
tDPrimBlueSN0 = IF ( aInclStratN0 EQ FALSE) THEN tDSetBlueEpiN0 - tDResusBlueN0 - tDMortBlueSN0 - tDRespBlueSN0 ELSE tDSetBlueHypN0 - tDResusBlueN0 - tDMortBlueSN0 - tDRespBlueSN0 ENDIF;
tPPrimBlueSN0 = IF ( aInclStratN0 EQ FALSE) THEN tPSetBlueEpiN0 - tPResusBlueN0 - tPMortBlueSN0 - tPExcrBlueSN0 ELSE tPSetBlueHypN0 - tPResusBlueN0 - tPMortBlueSN0 - tPExcrBlueSN0 ENDIF;
tNPrimBlueSN0 = IF (aInclStratN0 EQ FALSE) THEN tNSetBlueEpiN0 - tNResusBlueN0 - tNMortBlueSN0 - tNExcrBlueSN0 ELSE tNSetBlueHypN0 - tNResusBlueN0 - tNMortBlueSN0 - tNExcrBlueSN0 ENDIF;
aVPUptMaxCrGrenEpiN0 = MAX(0.0,cVPUptMaxGrenN0 * uFunTmProdGrenEpiN0 *(cPDGrenMaxN0 - rPDGrenWEpiN0) /(cPDGrenMaxN0 - cPDGrenMinN0));
aVPUptGrenEpiN0 = oPO4WEpiN0 * aVPUptMaxCrGrenEpiN0 /(aVPUptMaxCrGrenEpiN0 / cAffPUptGrenN0 + oPO4WEpiN0);
wPUptGrenEpiN0 = aVPUptGrenEpiN0 * oDGrenWEpiN0;
aVNUptMaxCrGrenEpiN0 = MAX(0.0,cVNUptMaxGrenN0 * uFunTmProdGrenEpiN0 * (cNDGrenMaxN0 - rNDGrenWEpiN0) /(cNDGrenMaxN0 - cNDGrenMinN0));
ahNUptGrenEpiN0 = aVNUptMaxCrGrenEpiN0 / cAffNUptGrenN0;
aVNUptGrenEpiN0 = oNDissWEpiN0 * aVNUptMaxCrGrenEpiN0 /(ahNUptGrenEpiN0 + oNDissWEpiN0);
wNUptGrenEpiN0 = aVNUptGrenEpiN0 * oDGrenWEpiN0;
afNH4UptGrenEpiN0 = oNH4WEpiN0 * oNO3WEpiN0 /((ahNUptGrenEpiN0 + oNH4WEpiN0) *(ahNUptGrenEpiN0 + oNO3WEpiN0)) + oNH4WEpiN0 * ahNUptGrenEpiN0 /((oNH4WEpiN0 + oNO3WEpiN0) *(ahNUptGrenEpiN0 + oNO3WEpiN0));
wNUptNH4GrenEpiN0 = afNH4UptGrenEpiN0 * wNUptGrenEpiN0;
wNUptNO3GrenEpiN0 = wNUptGrenEpiN0 - wNUptNH4GrenEpiN0;
aPLimGrenEpiN0 = MAX(0.0,(1.0 - cPDGrenMinN0 / rPDGrenWEpiN0) * cPDGrenMaxN0 /(cPDGrenMaxN0 - cPDGrenMinN0));
aNLimGrenEpiN0 = MAX(0.0,(1.0 - cNDGrenMinN0 / rNDGrenWEpiN0) * cNDGrenMaxN0 /(cNDGrenMaxN0 - cNDGrenMinN0));
aSiLimGrenEpiN0 = oSiO2WEpiN0 /(hSiAssGrenN0 + oSiO2WEpiN0);
aMuTmLGrenEpiN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimGrenEpiN0 * uMuMaxTmGrenEpiN0;
aNutLimGrenEpiN0 = MIN(aPLimGrenEpiN0 , (MIN(aNLimGrenEpiN0,aSiLimGrenEpiN0)));
aMuGrenEpiN0 = aNutLimGrenEpiN0 * aMuTmLGrenEpiN0;
wDAssGrenEpiN0 = aMuGrenEpiN0*oDGrenWEpiN0;
aExtChGrenEpiN0 = cExtSpGrenN0 / rChDGrenEpiN0;
wDRespGrenWEpiN0 = ukDRespTmGrenEpiN0 * oDGrenWEpiN0;
wDLossGrenEpiN0 = ukLossTmGrenEpiN0 * oDGrenWEpiN0;
wDMortGrenWEpiN0 = kMortGrenWN0 * oDGrenWEpiN0;
ukDDecGrenEpiN0 = ukDRespTmGrenEpiN0 + ukLossTmGrenEpiN0 + kMortGrenWN0 +(uCorVSetGrenEpiN0 * uFunTmSetEpiN0) / uDepthWEpiN0;
wPExcrGrenWEpiN0 = (2.0 *rPDGrenWEpiN0) /(cPDGrenMaxN0 + rPDGrenWEpiN0) * rPDGrenWEpiN0 * wDRespGrenWEpiN0 ;
wPLossGrenEpiN0 = rPDGrenWEpiN0 * wDLossGrenEpiN0;
wPMortGrenWEpiN0 = kMortGrenWN0 * oPGrenWEpiN0;
wNExcrGrenWEpiN0 = (2.0 * rNDGrenWEpiN0) /(cNDGrenMaxN0 + rNDGrenWEpiN0) * rNDGrenWEpiN0 * wDRespGrenWEpiN0;
wNLossGrenEpiN0 = rNDGrenWEpiN0 * wDLossGrenEpiN0;
wNMortGrenWEpiN0 = kMortGrenWN0 * oNGrenWEpiN0;
wDPrimGrenWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wDAssGrenEpiN0 - wDRespGrenWEpiN0 - wDLossGrenEpiN0 - wDMortGrenWEpiN0 -(tDSetGrenEpiN0 ) / uDepthWEpiN0 ELSE wDAssGrenEpiN0 - wDRespGrenWEpiN0 - wDLossGrenEpiN0 - wDMortGrenWEpiN0 -(tDSetGrenEpiN0 - tDResusGrenN0) / uDepthWEpiN0 ENDIF;
wPPrimGrenWEpiN0 =IF (aInclStratN0 EQ TRUE ) THEN wPUptGrenEpiN0 - wPExcrGrenWEpiN0 - wPLossGrenEpiN0 - wPMortGrenWEpiN0 -(tPSetGrenEpiN0 ) / uDepthWEpiN0 ELSE wPUptGrenEpiN0 - wPExcrGrenWEpiN0 - wPLossGrenEpiN0 - wPMortGrenWEpiN0 -(tPSetGrenEpiN0 - tPResusGrenN0) / uDepthWEpiN0 ENDIF;
wNPrimGrenWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wNUptGrenEpiN0 - wNExcrGrenWEpiN0 - wNLossGrenEpiN0 - wNMortGrenWEpiN0 -(tNSetGrenEpiN0 ) / uDepthWEpiN0 ELSE wNUptGrenEpiN0 - wNExcrGrenWEpiN0 - wNLossGrenEpiN0 - wNMortGrenWEpiN0 -(tNSetGrenEpiN0 - tNResusGrenN0) / uDepthWEpiN0 ENDIF;
tDPrimGrenSN0 = IF ( aInclStratN0 EQ FALSE) THEN tDSetGrenEpiN0 - tDResusGrenN0 - tDMortGrenSN0 - tDRespGrenSN0 ELSE tDSetGrenHypN0 - tDResusGrenN0 - tDMortGrenSN0 - tDRespGrenSN0 ENDIF;
tPPrimGrenSN0 = IF ( aInclStratN0 EQ FALSE) THEN tPSetGrenEpiN0 - tPResusGrenN0 - tPMortGrenSN0 - tPExcrGrenSN0 ELSE tPSetGrenHypN0 - tPResusGrenN0 - tPMortGrenSN0 - tPExcrGrenSN0 ENDIF;
tNPrimGrenSN0 = IF ( aInclStratN0 EQ FALSE) THEN tNSetGrenEpiN0 - tNResusGrenN0 - tNMortGrenSN0 - tNExcrGrenSN0 ELSE tNSetGrenHypN0 - tNResusGrenN0 - tNMortGrenSN0 - tNExcrGrenSN0 ENDIF;
aVPUptMaxCrDiatEpiN0 = MAX(0.0,cVPUptMaxDiatN0 * uFunTmProdDiatEpiN0 *(cPDDiatMaxN0 - rPDDiatWEpiN0) /(cPDDiatMaxN0 - cPDDiatMinN0));
aVPUptDiatEpiN0 = oPO4WEpiN0 * aVPUptMaxCrDiatEpiN0 /(aVPUptMaxCrDiatEpiN0 / cAffPUptDiatN0 + oPO4WEpiN0);
wPUptDiatEpiN0 = aVPUptDiatEpiN0 * oDDiatWEpiN0;
aVNUptMaxCrDiatEpiN0 = MAX(0.0,cVNUptMaxDiatN0 * uFunTmProdDiatEpiN0 * (cNDDiatMaxN0 - rNDDiatWEpiN0) /(cNDDiatMaxN0 - cNDDiatMinN0));
ahNUptDiatEpiN0 = aVNUptMaxCrDiatEpiN0 / cAffNUptDiatN0;
aVNUptDiatEpiN0 = oNDissWEpiN0 * aVNUptMaxCrDiatEpiN0 /(ahNUptDiatEpiN0 + oNDissWEpiN0);
wNUptDiatEpiN0 = aVNUptDiatEpiN0 * oDDiatWEpiN0;
afNH4UptDiatEpiN0 = oNH4WEpiN0 * oNO3WEpiN0 /((ahNUptDiatEpiN0 + oNH4WEpiN0) *(ahNUptDiatEpiN0 + oNO3WEpiN0)) + oNH4WEpiN0 * ahNUptDiatEpiN0 /((oNH4WEpiN0 + oNO3WEpiN0) *(ahNUptDiatEpiN0 + oNO3WEpiN0));
wNUptNH4DiatEpiN0 = afNH4UptDiatEpiN0 * wNUptDiatEpiN0;
wNUptNO3DiatEpiN0 = wNUptDiatEpiN0 - wNUptNH4DiatEpiN0;
aPLimDiatEpiN0 = MAX(0.0,(1.0 - cPDDiatMinN0 / rPDDiatWEpiN0) * cPDDiatMaxN0 /(cPDDiatMaxN0 - cPDDiatMinN0));
aNLimDiatEpiN0 = MAX(0.0,(1.0 - cNDDiatMinN0 / rNDDiatWEpiN0) * cNDDiatMaxN0 /(cNDDiatMaxN0 - cNDDiatMinN0));
aSiLimDiatEpiN0 = oSiO2WEpiN0 /(hSiAssDiatN0 + oSiO2WEpiN0);
aMuTmLDiatEpiN0 = ufDayN0 *(1.0 - afCovSurfVegN0) * aLLimDiatEpiN0 * uMuMaxTmDiatEpiN0;
aNutLimDiatEpiN0 = MIN(aPLimDiatEpiN0 , (MIN(aNLimDiatEpiN0,aSiLimDiatEpiN0)));
aMuDiatEpiN0 = aNutLimDiatEpiN0 * aMuTmLDiatEpiN0;
wDAssDiatEpiN0 = aMuDiatEpiN0*oDDiatWEpiN0;
aExtChDiatEpiN0 = cExtSpDiatN0 / rChDDiatEpiN0;
wDRespDiatWEpiN0 = ukDRespTmDiatEpiN0 * oDDiatWEpiN0;
wDLossDiatEpiN0 = ukLossTmDiatEpiN0 * oDDiatWEpiN0;
wDMortDiatWEpiN0 = kMortDiatWN0 * oDDiatWEpiN0;
ukDDecDiatEpiN0 = ukDRespTmDiatEpiN0 + ukLossTmDiatEpiN0 + kMortDiatWN0 +(uCorVSetDiatEpiN0 * uFunTmSetEpiN0) / uDepthWEpiN0;
wPExcrDiatWEpiN0 = (2.0 * rPDDiatWEpiN0) /(cPDDiatMaxN0 + rPDDiatWEpiN0) * rPDDiatWEpiN0 * wDRespDiatWEpiN0 ;
wPLossDiatEpiN0 = rPDDiatWEpiN0 * wDLossDiatEpiN0;
wPMortDiatWEpiN0 = kMortDiatWN0 * oPDiatWEpiN0;
wNExcrDiatWEpiN0 = (2.0 * rNDDiatWEpiN0) /(cNDDiatMaxN0 + rNDDiatWEpiN0) * rNDDiatWEpiN0 * wDRespDiatWEpiN0 ;
wNLossDiatEpiN0 = rNDDiatWEpiN0 * wDLossDiatEpiN0;
wNMortDiatWEpiN0 = kMortDiatWN0 * oNDiatWEpiN0;
wDPrimDiatWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wDAssDiatEpiN0 - wDRespDiatWEpiN0 - wDLossDiatEpiN0 - wDMortDiatWEpiN0 -(tDSetDiatEpiN0 ) / uDepthWEpiN0 ELSE wDAssDiatEpiN0 - wDRespDiatWEpiN0 - wDLossDiatEpiN0 - wDMortDiatWEpiN0 -(tDSetDiatEpiN0 - tDResusDiatN0) / uDepthWEpiN0 ENDIF;
wPPrimDiatWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wPUptDiatEpiN0 - wPExcrDiatWEpiN0 - wPLossDiatEpiN0 - wPMortDiatWEpiN0 -(tPSetDiatEpiN0 ) / uDepthWEpiN0 ELSE wPUptDiatEpiN0 - wPExcrDiatWEpiN0 - wPLossDiatEpiN0 - wPMortDiatWEpiN0 -(tPSetDiatEpiN0 - tPResusDiatN0) / uDepthWEpiN0 ENDIF;
wNPrimDiatWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wNUptDiatEpiN0 - wNExcrDiatWEpiN0 - wNLossDiatEpiN0 - wNMortDiatWEpiN0 -(tNSetDiatEpiN0 ) / uDepthWEpiN0 ELSE wNUptDiatEpiN0 - wNExcrDiatWEpiN0 - wNLossDiatEpiN0 - wNMortDiatWEpiN0 -(tNSetDiatEpiN0 - tNResusDiatN0) / uDepthWEpiN0 ENDIF;
tDPrimDiatSN0 = IF ( aInclStratN0 EQ FALSE) THEN tDSetDiatEpiN0 - tDResusDiatN0 - tDMortDiatSN0 - tDRespDiatSN0 ELSE tDSetDiatHypN0 - tDResusDiatN0 - tDMortDiatSN0 - tDRespDiatSN0 ENDIF;
tPPrimDiatSN0 = IF ( aInclStratN0 EQ FALSE) THEN tPSetDiatEpiN0 - tPResusDiatN0 - tPMortDiatSN0 - tPExcrDiatSN0 ELSE tPSetDiatHypN0 - tPResusDiatN0 - tPMortDiatSN0 - tPExcrDiatSN0 ENDIF;
tNPrimDiatSN0 = IF ( aInclStratN0 EQ FALSE) THEN tNSetDiatEpiN0 - tNResusDiatN0 - tNMortDiatSN0 - tNExcrDiatSN0 ELSE tNSetDiatHypN0 - tNResusDiatN0 - tNMortDiatSN0 - tNExcrDiatSN0 ENDIF;
oChlaN0 = IF ( aInclStratN0 EQ TRUE ) THEN (oChlaEpiN0 * uDepthWEpiN0 + oChlaHypN0 * uDepthWHypN0 + aChlaBlueSurfN0) / uDepthWN0 ELSE (oChlaEpiN0 * uDepthWEpiN0+ aChlaBlueSurfN0 ) / uDepthWN0 ENDIF;
oChlaWN0 = IF ( aInclStratN0 EQ TRUE ) THEN (oChlaEpiN0 * uDepthWEpiN0 + oChlaHypN0 * uDepthWHypN0) / uDepthWN0 ELSE (oChlaEpiN0 * uDepthWEpiN0) / uDepthWN0 ENDIF;
aChlaHN0 = oChlaN0 * uDepthWN0;
aLPIEpiN0 =  (aLPARBotSurfN0- aLPARBotEpiOpenN0 + uhLVegN0* LN((1.0 +aLPARBotEpiOpenN0/ uhLVegN0)  /(1.0 + aLPARBotSurfN0  / uhLVegN0) + NearZeroN0  ) ) / uDepthWEpiN0;
aLPIHypN0 =  (aLPARBotEpiN0- aLPARBotHypOpenN0 + uhLVegN0* LN((1.0 +aLPARBotHypOpenN0/ uhLVegN0)  /(1.0 + aLPARBotEpiN0  / uhLVegN0) + NearZeroN0  ) ) / uDepthWHypN0;
aLPIMeasEpiN0 =  (aLPARBotSurfN0- aLPARBotEpiN0 ) /aExtCoefEpiN0;
aLPIMeasHypN0 =  (aLPARBotEpiN0- aLPARBotHypN0) / aExtCoefHypN0;
aLMeasEpiN0 = aLPARBotSurfN0 * EXP(- aExtCoefOpenEpiN0 *cDepthMeasoChlN0);
aLMeasHypN0 = aLPARBotEpiN0 * EXP(- aExtCoefOpenHypN0 * (cDepthMeasoChlN0 -  uDepthWEpiN0));
aLPAREuphoN0 = PerCentN0 * uLPARSurfN0;
aDepthEuphWN0 = IF (aLPAREuphoN0 GT aLPARBotSurfN0) THEN  0.0 ELSEIF (aLPAREuphoN0 GE aLPARBotEpiOpenN0) THEN - LN(aLPAREuphoN0/aLPARBotSurfN0) / aExtCoefEpiN0 ELSE uDepthWEpiN0 - LN(aLPAREuphoN0/aLPARBotEpiOpenN0) / aExtCoefOpenHypN0 ENDIF;
oChlaMeasEpiN0 = IF (cDepthMeasoChlN0 LT aDepthEuphWN0) THEN aLMeasEpiN0/ aLPIMeasEpiN0 *oChlaEpiN0 * uDepthWEpiN0 ELSE oChlaEpiN0 ENDIF;
oChlaMeasHypN0 = IF (cDepthMeasoChlN0 LT aDepthEuphWN0) THEN  aLMeasHypN0/ aLPIMeasHypN0 *oChlaHypN0* uDepthWHypN0  ELSE oChlaHypN0 ENDIF;
oChlaMeasWN0 = IF (cDepthMeasoChlN0 LT uDepthWEpiN0) THEN oChlaMeasEpiN0 ELSE oChlaMeasHypN0 ENDIF;
wDAssPhytEpiN0 = wDAssDiatEpiN0 + wDAssGrenEpiN0 + wDAssBlueEpiN0;
wDRespPhytWEpiN0 = wDRespDiatWEpiN0 + wDRespGrenWEpiN0 + wDRespBlueWEpiN0;
wDMortPhytWEpiN0 = wDMortDiatWEpiN0 + wDMortGrenWEpiN0 + wDMortBlueWEpiN0;
tDSetPhytEpiN0 = tDSetDiatEpiN0 + tDSetGrenEpiN0 + tDSetBlueEpiN0;
wDLossPhytEpiN0 = wDLossDiatEpiN0 + wDLossGrenEpiN0 + wDLossBlueEpiN0 + tDLossBlueSurfN0 / uDepthWEpiN0;
wDPrimPhytWEpiN0 = wDPrimDiatWEpiN0 + wDPrimGrenWEpiN0 + wDPrimBlueWEpiN0;
wPUptPhytEpiN0 = wPUptDiatEpiN0 + wPUptGrenEpiN0 + wPUptBlueEpiN0;
wPExcrPhytWEpiN0 = wPExcrDiatWEpiN0 + wPExcrGrenWEpiN0 + wPExcrBlueWEpiN0;
wPMortPhytWEpiN0 = wPMortDiatWEpiN0 + wPMortGrenWEpiN0 + wPMortBlueWEpiN0;
tPSetPhytEpiN0 = tPSetDiatEpiN0 + tPSetGrenEpiN0 + tPSetBlueEpiN0;
wPLossPhytEpiN0 = wPLossDiatEpiN0 + wPLossGrenEpiN0 + wPLossBlueEpiN0 + tPLossBlueSurfN0 / uDepthWEpiN0;
wPPrimPhytWEpiN0 = wPPrimDiatWEpiN0 + wPPrimGrenWEpiN0 + wPPrimBlueWEpiN0;
wNUptPhytEpiN0 = wNUptDiatEpiN0 + wNUptGrenEpiN0 + wNUptBlueEpiN0;
wNUptNH4PhytEpiN0 = wNUptNH4DiatEpiN0 + wNUptNH4GrenEpiN0 + wNUptNH4BlueEpiN0;
wNUptNO3PhytEpiN0 = wNUptNO3DiatEpiN0 + wNUptNO3GrenEpiN0 + wNUptNO3BlueEpiN0;
wNExcrPhytWEpiN0 = wNExcrDiatWEpiN0 + wNExcrGrenWEpiN0 + wNExcrBlueWEpiN0;
wNMortPhytWEpiN0 = wNMortDiatWEpiN0 + wNMortGrenWEpiN0 + wNMortBlueWEpiN0;
tNSetPhytEpiN0 = tNSetDiatEpiN0 + tNSetGrenEpiN0 + tNSetBlueEpiN0;
wNLossPhytEpiN0 = wNLossDiatEpiN0 + wNLossGrenEpiN0 + wNLossBlueEpiN0 + tNLossBlueSurfN0 / uDepthWEpiN0;
wNPrimPhytWEpiN0 = wNPrimDiatWEpiN0 + wNPrimGrenWEpiN0 + wNPrimBlueWEpiN0;
tDPrimPhytSN0 = tDPrimDiatSN0 + tDPrimGrenSN0 + tDPrimBlueSN0;
tPPrimPhytSN0 = tPPrimDiatSN0 + tPPrimGrenSN0 + tPPrimBlueSN0;
tNPrimPhytSN0 = tNPrimDiatSN0 + tNPrimGrenSN0 + tNPrimBlueSN0;
wSiUptDiatEpiN0 = cSiDDiatN0 * wDAssDiatEpiN0;
wSiExcrDiatWEpiN0 = cSiDDiatN0 * wDRespDiatWEpiN0 ;
wSiLossDiatEpiN0 = cSiDDiatN0 * wDLossDiatEpiN0;
wSiMortDiatWEpiN0 = cSiDDiatN0 * wDMortDiatWEpiN0;
tSiSetDiatEpiN0 = cSiDDiatN0 * tDSetDiatEpiN0;
wSiPrimDiatWHypN0 = IF (aInclStratN0 EQ TRUE ) THEN wSiUptDiatHypN0 - tSiSetDiatHypN0 / uDepthWHypN0 - wSiExcrDiatWHypN0 - wSiMortDiatWHypN0 - wSiLossDiatHypN0 ELSE 0.0 ENDIF;
wSiPrimDiatWEpiN0 = IF (aInclStratN0 EQ TRUE ) THEN wSiUptDiatEpiN0 - tSiSetDiatEpiN0 / uDepthWEpiN0 - wSiExcrDiatWEpiN0 - wSiMortDiatWEpiN0 - wSiLossDiatEpiN0 ELSE wSiUptDiatEpiN0 - tSiSetDiatEpiN0 / uDepthWEpiN0 - wSiExcrDiatWEpiN0 - wSiMortDiatWEpiN0 - wSiLossDiatEpiN0 + tSiResusDiatN0 / uDepthWEpiN0 ENDIF;
rCyDBlueEpiN0 = cCyDBlueMaxN0 -(cCyDBlueMaxN0 - cCyDBlueMinN0) * aLLimBlueEpiN0;
oCyanEpiN0 = rCyDBlueEpiN0 * oDBlueWEpiN0 * mgPergN0;
fDDiatEpiN0 = oDDiatWEpiN0 /(oDDiatWEpiN0 + oDGrenWEpiN0 + oDBlueWEpiN0 + NearZeroN0);
wDPrimDetWEpiN0 = IF (InclSurfN0 EQ TRUE) THEN wDMortPhytWEpiN0 + wDLossPhytEpiN0 + tDMortBlueSurfN0 / uDepthWEpiN0 ELSE wDMortPhytWEpiN0 + wDLossPhytEpiN0 ENDIF;
tDPrimDetSN0 = tDMortPhytSN0;
tDPrimTotSurfN0 = IF (InclSurfN0 EQ TRUE) THEN tDAssBlueSurfN0 - tDRespBlueSurfN0 ELSE 0.0 ENDIF;
tDPrimTotTN0 = IF (aInclStratN0 EQ FALSE ) THEN(wDAssPhytEpiN0 - wDRespPhytWEpiN0) * uDepthWEpiN0 - tDRespPhytSN0 + tDPrimTotSurfN0 ELSE (wDAssPhytEpiN0 - wDRespPhytWEpiN0) * uDepthWEpiN0 + (wDAssPhytHypN0 - wDRespPhytWHypN0) * uDepthWHypN0 - tDRespPhytSN0 + tDPrimTotSurfN0 ENDIF;
wO2ProdPhytEpiN0 = molO2molCN0 * cCPerDWN0 * wDAssPhytEpiN0;
wO2RespPhytWEpiN0 = molO2molCN0 * cCPerDWN0 * wDRespPhytWEpiN0 * aCorO2BODEpiN0;
wO2UptNO3PhytEpiN0 = O2PerNO3N0 * molO2molNN0 * wNUptNO3PhytEpiN0;
wO2PrimWEpiN0 = wO2ProdPhytEpiN0 - wO2RespPhytWEpiN0 + wO2UptNO3PhytEpiN0;
tO2RespPhytSN0 = molO2molCN0 * cCPerDWN0 * tDRespPhytSN0 * afOxySedN0;
tO2PrimSN0 = tO2RespPhytSN0;
tO2PrimSHypN0 = IF aInclStratN0 EQ TRUE THEN tO2PrimSN0 / uDepthWHypN0 ELSE 0.0 ENDIF;
tO2PrimSEpiN0 = IF aInclStratN0 EQ FALSE THEN tO2PrimSN0 / uDepthWEpiN0 ELSE 0.0 ENDIF;
wPMortBluePO4WSurfN0 = fDissMortPhytN0 * tPMortBlueSurfN0 / uDepthWEpiN0;
wPMortBlueDetSurfN0 = ( 1 -fDissMortPhytN0) * tPMortBlueSurfN0 / uDepthWEpiN0;
wPMortPhytPO4WEpiN0 = fDissMortPhytN0 * wPMortPhytWEpiN0;
wPMortPhytDetWEpiN0 = wPMortPhytWEpiN0 - wPMortPhytPO4WEpiN0 + wPMortBlueDetSurfN0;
wPLossPhytPO4EpiN0 = fDissLossN0 * wPLossPhytEpiN0;
wPLossPhytDetEpiN0 = wPLossPhytEpiN0 - wPLossPhytPO4EpiN0;
wPPrimPO4WEpiN0 = - wPUptPhytEpiN0 + wPExcrPhytWEpiN0 + wPLossPhytPO4EpiN0 + wPMortPhytPO4WEpiN0 - tPUptBlueSurfN0 / uDepthWEpiN0 + tPExcrBlueSurfN0 / uDepthWEpiN0 + wPMortBluePO4WSurfN0;
wPPrimDetWEpiN0 = wPLossPhytDetEpiN0 + wPMortPhytDetWEpiN0;
tPPrimDetSN0 = tPMortPhytDetSN0 ;
wNMortPhytNH4WEpiN0 = fDissMortPhytN0 * wNMortPhytWEpiN0;
wNMortPhytDetWEpiN0 = wNMortPhytWEpiN0 - wNMortPhytNH4WEpiN0+ wNMortBlueDetSurfN0;
wNLossPhytNH4EpiN0 = fDissLossN0 * wNLossPhytEpiN0;
wNLossPhytDetEpiN0 = wNLossPhytEpiN0 - wNLossPhytNH4EpiN0;
wNPrimNH4WEpiN0 = - wNUptNH4PhytEpiN0 + wNExcrPhytWEpiN0 + wNLossPhytNH4EpiN0 + wNMortPhytNH4WEpiN0- tNUptNH4BlueSurfN0 / uDepthWEpiN0 + tNExcrBlueSurfN0 / uDepthWEpiN0 + wNMortBlueNH4WSurfN0;
wNPrimNO3WEpiN0 = - wNUptNO3PhytEpiN0 - tNUptNO3BlueSurfN0 / uDepthWEpiN0;
wNPrimDetWEpiN0 = wNLossPhytDetEpiN0 + wNMortPhytDetWEpiN0;
tNPrimDetSN0 = tNMortPhytDetSN0 ;
wSiPrimSiO2WEpiN0 = IF (aInclStratN0 EQ FALSE) THEN wSiExcrDiatWEpiN0 - wSiUptDiatEpiN0 + tSiExcrDiatSN0 / uDepthWEpiN0 ELSE wSiExcrDiatWEpiN0 - wSiUptDiatEpiN0 ENDIF;
wSiPrimDetWEpiN0 = wSiMortDiatWEpiN0 + wSiLossDiatEpiN0;
tSiPrimDiatSN0 = IF (aInclStratN0 EQ FALSE) THEN tSiSetDiatEpiN0 - tSiResusDiatN0 - tSiExcrDiatSN0 - tSiMortDiatSN0 ELSE tSiSetDiatHypN0 - tSiResusDiatN0 - tSiExcrDiatSN0 - tSiMortDiatSN0 ENDIF;
tSiPrimDetSN0 = tSiMortDiatSN0 ;
aDepthEuphEpiN0 = cEuphN0 * aSecchiEpiN0;
aRelDepthEuphEpiN0 = aDepthEuphEpiN0 / uDepthWEpiN0;
aChlaHEpiN0 = oChlaEpiN0 * uDepthWEpiN0;
aCovPhytWEpiN0 = cCovSpPhytN0 *(oDPhytWEpiN0 * uDepthWEpiN0);
rExtChPhytEpiN0 = aExtPhytEpiN0 /(oChlaEpiN0 / mgPergN0 + NearZeroN0);
rPDZooEpiN0 = oPZooEpiN0 /(oDZooEpiN0+NearZeroN0);
rNDZooEpiN0 = oNZooEpiN0/(oDZooEpiN0+NearZeroN0);
aDFoodZooEpiN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN cPrefDiatN0 * aDDiatWEpiN0 + cPrefGrenN0 * aDGrenWEpiN0 + cPrefBlueN0 * aDBlueWEpiN0 + cPrefDetN0 * aDDetWEpiN0 ELSE cPrefDiatN0 * aDDiatWEpiN0 + cPrefGrenN0 * aDGrenWEpiN0 + cPrefBlueN0 * aDBlueWEpiN0 + cPrefBlueSurfN0 * aDBlueSurfN0 + cPrefDetN0 * aDDetWEpiN0 ENDIF;
oDFoodZooEpiN0 = aDFoodZooEpiN0 / uDepthWEpiN0;
aFiltEpiN0 = cFiltMaxN0 * uFunTmZooEpiN0 * hFiltN0 /(hFiltN0 + oDOMWEpiN0);
aDSatZooEpiN0 = oDFoodZooEpiN0 /(hFiltN0 + oDOMWEpiN0);
wDEnvZooEpiN0 = MAX(0.0,ukDIncrZooEpiN0 / cDCarrZooN0 * oDZooEpiN0*oDZooEpiN0);
wDAssZooEpiN0 = aDSatZooEpiN0 *(ukDAssTmZooEpiN0 * oDZooEpiN0 - wDEnvZooEpiN0);
wDConsZooEpiN0 = wDAssZooEpiN0 / fDAssZooN0;
wDConsDetZooEpiN0 = cPrefDetN0*oDDetWEpiN0 / oDFoodZooEpiN0 * wDConsZooEpiN0;
wDConsDiatZooEpiN0 = cPrefDiatN0*oDDiatWEpiN0 / oDFoodZooEpiN0 * wDConsZooEpiN0;
wDConsGrenZooEpiN0 = cPrefGrenN0*oDGrenWEpiN0 / oDFoodZooEpiN0 * wDConsZooEpiN0;
wDConsBlueZooEpiN0 = cPrefBlueN0*oDBlueWEpiN0 / oDFoodZooEpiN0 * wDConsZooEpiN0;
wDConsBlueZooSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE cPrefBlueSurfN0 *aDBlueSurfN0 / aDFoodZooEpiN0 * wDConsZooEpiN0 ENDIF;
tDConsBlueZooSurfN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE wDConsBlueZooSurfN0 *uDepthWEpiN0 ENDIF;
wDConsPhytZooEpiN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN wDConsDiatZooEpiN0 + wDConsGrenZooEpiN0 + wDConsBlueZooEpiN0 ELSE wDConsDiatZooEpiN0 + wDConsGrenZooEpiN0 + wDConsBlueZooEpiN0 + wDConsBlueZooSurfN0 ENDIF;
wDEgesZooEpiN0 = wDConsZooEpiN0 - wDAssZooEpiN0;
aCorDRespZooEpiN0 = MAX(cPDZooRefN0 / rPDZooEpiN0,cNDZooRefN0 / rNDZooEpiN0);
wDRespZooEpiN0 = aCorDRespZooEpiN0 * ukDRespTmZooEpiN0 * oDZooEpiN0;
wDMortZooEpiN0 = kMortZooN0 * oDZooEpiN0 +(1.0 - aDSatZooEpiN0) * wDEnvZooEpiN0;
aPFoodZooEpiN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN cPrefDiatN0*aPDiatWEpiN0 + cPrefGrenN0*aPGrenWEpiN0 + cPrefBlueN0 * aPBlueWEpiN0  + cPrefDetN0 * aPDetWEpiN0 ELSE cPrefDiatN0*aPDiatWEpiN0 + cPrefGrenN0*aPGrenWEpiN0 + cPrefBlueN0*aPBlueWEpiN0 + cPrefBlueSurfN0 *aPBlueSurfN0 + cPrefDetN0 * aPDetWEpiN0 ENDIF;
oPFoodZooEpiN0 = aPFoodZooEpiN0 / MassEpiN0;
rPDFoodZooEpiN0 = oPFoodZooEpiN0 /(oDFoodZooEpiN0+NearZeroN0);
wPConsDiatZooEpiN0 = rPDDiatWEpiN0 * wDConsDiatZooEpiN0;
wPConsGrenZooEpiN0 = rPDGrenWEpiN0 * wDConsGrenZooEpiN0;
wPConsBlueZooEpiN0 = rPDBlueWEpiN0 * wDConsBlueZooEpiN0;
wPConsBlueZooSurfN0 = rPDBlueSurfN0 * wDConsBlueZooSurfN0;
tPConsBlueZooSurfN0 = wPConsBlueZooSurfN0 *uDepthWEpiN0;
wPConsPhytZooEpiN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN wPConsDiatZooEpiN0 + wPConsGrenZooEpiN0 + wPConsBlueZooEpiN0 ELSE wPConsDiatZooEpiN0 + wPConsGrenZooEpiN0 + wPConsBlueZooEpiN0 + wPConsBlueZooSurfN0 ENDIF;
wPConsDetZooEpiN0 = rPDDetWEpiN0 * wDConsDetZooEpiN0;
wPConsZooEpiN0 = wPConsPhytZooEpiN0 + wPConsDetZooEpiN0;
afPAssZooEpiN0 = MIN(1.0,cPDZooRefN0 / rPDFoodZooEpiN0 * fDAssZooN0);
wPAssZooEpiN0 = afPAssZooEpiN0 * wPConsZooEpiN0;
wPEgesZooEpiN0 = wPConsZooEpiN0 - wPAssZooEpiN0;
wPEgesZooPO4EpiN0 = fDissEgesZooN0*wPEgesZooEpiN0;
wPEgesZooDetEpiN0 = wPEgesZooEpiN0 - wPEgesZooPO4EpiN0;
akPExcrZooEpiN0 = rPDZooEpiN0 / cPDZooRefN0 * kDRespZooN0 * uFunTmZooEpiN0;
wPExcrZooEpiN0 = akPExcrZooEpiN0*oPZooEpiN0 ;
wPMortZooEpiN0 = rPDZooEpiN0 * wDMortZooEpiN0;
wPMortZooPO4EpiN0 = fDissMortZooN0 * wPMortZooEpiN0;
wPMortZooDetEpiN0 = wPMortZooEpiN0 - wPMortZooPO4EpiN0;
aNFoodZooEpiN0 =  IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN cPrefDiatN0*aNDiatWEpiN0 + cPrefGrenN0*aNGrenWEpiN0 + cPrefBlueN0*aNBlueWEpiN0 + cPrefDetN0 * aNDetWEpiN0 ELSE cPrefDiatN0*aNDiatWEpiN0 + cPrefGrenN0*aNGrenWEpiN0 + cPrefBlueN0*aNBlueWEpiN0 + cPrefBlueSurfN0*aNBlueSurfN0 + cPrefDetN0 * aNDetWEpiN0 ENDIF;
oNFoodZooEpiN0 = aNFoodZooEpiN0 / MassEpiN0;
rNDFoodZooEpiN0 = oNFoodZooEpiN0 /(oDFoodZooEpiN0+NearZeroN0);
wNConsDiatZooEpiN0 = rNDDiatWEpiN0*wDConsDiatZooEpiN0;
wNConsGrenZooEpiN0 = rNDGrenWEpiN0*wDConsGrenZooEpiN0;
wNConsBlueZooEpiN0 = rNDBlueWEpiN0*wDConsBlueZooEpiN0;
wNConsBlueZooSurfN0 = rNDBlueSurfN0 * wDConsBlueZooSurfN0;
tNConsBlueZooSurfN0 = wNConsBlueZooSurfN0 *uDepthWEpiN0;
wNConsPhytZooEpiN0 = IF (InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN  wNConsDiatZooEpiN0 + wNConsGrenZooEpiN0 + wNConsBlueZooEpiN0 ELSE wNConsDiatZooEpiN0 + wNConsGrenZooEpiN0 + wNConsBlueZooEpiN0 + wNConsBlueZooSurfN0 ENDIF;
wNConsDetZooEpiN0 = rNDDetWEpiN0*wDConsDetZooEpiN0;
wNConsZooEpiN0 = wNConsPhytZooEpiN0 + wNConsDetZooEpiN0;
afNAssZooEpiN0 = MIN(1.0,cNDZooRefN0 / rNDFoodZooEpiN0 * fDAssZooN0);
wNAssZooEpiN0 = afNAssZooEpiN0*wNConsZooEpiN0;
wNEgesZooEpiN0 = wNConsZooEpiN0 - wNAssZooEpiN0;
wNEgesZooNH4EpiN0 = fDissEgesZooN0*wNEgesZooEpiN0;
wNEgesZooDetEpiN0 = wNEgesZooEpiN0 - wNEgesZooNH4EpiN0;
kNExcrZooEpiN0 = rNDZooEpiN0 / cNDZooRefN0 * kDRespZooN0 * uFunTmZooEpiN0;
wNExcrZooEpiN0 = kNExcrZooEpiN0*oNZooEpiN0 ;
wNMortZooEpiN0 = rNDZooEpiN0*wDMortZooEpiN0;
wNMortZooNH4EpiN0 = fDissMortZooN0*wNMortZooEpiN0;
wNMortZooDetEpiN0 = wNMortZooEpiN0 - wNMortZooNH4EpiN0;
wSiConsDiatZooEpiN0 = cSiDDiatN0 * wDConsDiatZooEpiN0;
rPDFiJvN0 = aPFiJvN0 /(aDFiJvN0+NearZeroN0);
rPDFiAdN0 = aPFiAdN0 /(aDFiAdN0+NearZeroN0);
rNDFiJvN0 = aNFiJvN0 /(aDFiJvN0+NearZeroN0);
rNDFiAdN0 = aNFiAdN0 /(aDFiAdN0+NearZeroN0);
tDReprFishN0 = IF (FALSE EQ InclSeasonN0) THEN ((1/DaysInYearN0)*fReprFishN0) * aDFiAdN0 ELSEIF (DayN0 GE cDayReprFishN0 AND DayN0 LT cDayReprFishN0 + 1.0) THEN fReprFishN0 * aDFiAdN0 * PerDayN0 ELSE 0.0 ENDIF;
tDAgeFishN0 = IF (FALSE EQ InclSeasonN0) THEN ((1/DaysInYearN0)*fAgeFishN0) * aDFiJvN0 ELSEIF (DayN0 GE 364.0) THEN fAgeFishN0 * aDFiJvN0 *PerDayN0 ELSE 0.0 ENDIF;
aDTotZooN0 = IF (aInclStratN0 EQ FALSE) THEN oDZooEpiN0 * uDepthWEpiN0 ELSE oDZooEpiN0 * uDepthWEpiN0 + oDZooHypN0 * uDepthWHypN0 ENDIF;
aPTotZooN0 = IF (aInclStratN0 EQ FALSE) THEN oPZooEpiN0 * uDepthWEpiN0 ELSE oPZooEpiN0 * uDepthWEpiN0 + oPZooHypN0 * uDepthWHypN0 ENDIF;
aNTotZooN0 = IF (aInclStratN0 EQ FALSE) THEN oNZooEpiN0 * uDepthWEpiN0 ELSE oNZooEpiN0 * uDepthWEpiN0 + oNZooHypN0 * uDepthWHypN0 ENDIF;
aDSatFiJvN0 = aDTotZooN0 * aDTotZooN0 /(hDZooFiJvN0 * hDZooFiJvN0 + aDTotZooN0 * aDTotZooN0);
tDEnvFiJvN0 = MAX(0.0,ukDIncrFiJvN0 /(cDCarrFishN0 - aDFiAdN0) * aDFiJvN0*aDFiJvN0);
tDAssFiJvN0 = aDSatFiJvN0 *(kDAssFiJvN0 * uFunTmFishN0 * aDFiJvN0 - tDEnvFiJvN0);
tDConsFiJvN0 = tDAssFiJvN0 / fDAssFiJvN0;
tDEgesFiJvN0 = tDConsFiJvN0 - tDAssFiJvN0;
tDRespFiJvN0 = (cPDFishRefN0 / rPDFiJvN0) * kDRespFiJvN0 * uFunTmFishN0 * aDFiJvN0;
tDMortFiJvN0 = kMortFiJvN0 * aDFiJvN0 +(1.0 - aDSatFiJvN0) * tDEnvFiJvN0;
tDMigrFiJvN0 = kMigrFishN0 *(cDFiJvInN0 - aDFiJvN0);
tDEnvFiAdN0 = MAX(0.0,ukDIncrFiAdN0 /(cDCarrFishN0 - aDFiJvN0) * aDFiAdN0*aDFiAdN0);
tDAssFiAdN0 = aDSatFiAdN0 *(kDAssFiAdN0 * uFunTmFishN0 * aDFiAdN0 - tDEnvFiAdN0);
tDConsFiAdN0 = tDAssFiAdN0 / fDAssFiAdN0;
tDEgesFiAdN0 = tDConsFiAdN0 - tDAssFiAdN0;
tDRespFiAdN0 = (cPDFishRefN0 / rPDFiAdN0) * kDRespFiAdN0 * uFunTmFishN0 * aDFiAdN0;
tDMortFiAdN0 = kMortFiAdN0 * aDFiAdN0 +(1.0 - aDSatFiAdN0) * tDEnvFiAdN0;
tDHarvFishN0 = ukHarvFishN0 * aDFiAdN0;
tDMigrFiAdN0 = kMigrFishN0 *(cDFiAdInN0 - aDFiAdN0);
tDMortFiJvBotN0 = fDBoneN0 * tDMortFiJvN0;
tDMortFiJvDetN0 = tDMortFiJvN0 - tDMortFiJvBotN0;
tDMortFiAdBotN0 = fDBoneN0 * tDMortFiAdN0;
tDMortFiAdDetN0 = tDMortFiAdN0 - tDMortFiAdBotN0;
tPReprFishN0 = rPDFiAdN0 * tDReprFishN0;
tPAgeFishN0 = rPDFiJvN0 * tDAgeFishN0;
tPMigrFiJvN0 = kMigrFishN0 *(cPDFishRefN0 * cDFiJvInN0 - aPFiJvN0);
tPConsFiJvN0 = rPDZooEpiN0 * tDConsFiJvN0;
afPAssFiJvN0 = MIN(1.0,cPDFishRefN0 / rPDZooEpiN0 * fDAssFiJvN0);
tPAssFiJvN0 = afPAssFiJvN0 * tPConsFiJvN0;
tPEgesFiJvN0 = tPConsFiJvN0 - tPAssFiJvN0;
tPExcrFiJvN0 = (rPDFiJvN0 / cPDFishRefN0) * kDRespFiJvN0 * uFunTmFishN0 * aPFiJvN0;
tPMortFiJvN0 = rPDFiJvN0 * tDMortFiJvN0;
tPMigrFiAdN0 = kMigrFishN0 *(cPDFishRefN0 * cDFiAdInN0 - aPFiAdN0);
tPConsFiAdN0 = rPDBentN0 * tDConsFiAdN0;
tPAssFiAdN0 = afPAssFiAdN0 * tPConsFiAdN0;
tPEgesFiAdN0 = tPConsFiAdN0 - tPAssFiAdN0;
tPExcrFiAdN0 = (rPDFiAdN0 / cPDFishRefN0) * kDRespFiAdN0 * uFunTmFishN0 * aPFiAdN0;
tPMortFiAdN0 = rPDFiAdN0 * tDMortFiAdN0;
tPHarvFishN0 = rPDFiAdN0 * tDHarvFishN0;
tPMortFiJvBotN0 = fPBoneN0 * tPMortFiJvN0;
tPMortFiJvPO4N0 = fDissMortFishN0 *(tPMortFiJvN0 - tPMortFiJvBotN0);
tPMortFiJvDetN0 = tPMortFiJvN0 - tPMortFiJvBotN0 - tPMortFiJvPO4N0;
tPMortFiAdBotN0 = fPBoneN0 * tPMortFiAdN0;
tPMortFiAdPO4N0 = fDissMortFishN0 *(tPMortFiAdN0 - tPMortFiAdBotN0);
tPMortFiAdDetN0 = tPMortFiAdN0 - tPMortFiAdBotN0 - tPMortFiAdPO4N0;
tPEgesFiJvPO4N0 = fDissEgesFishN0 * tPEgesFiJvN0;
tPEgesFiJvDetN0 = tPEgesFiJvN0 - tPEgesFiJvPO4N0;
tPEgesFiAdPO4N0 = fDissEgesFishN0 * tPEgesFiAdN0;
tPEgesFiAdDetN0 = tPEgesFiAdN0 - tPEgesFiAdPO4N0;
tNReprFishN0 = rNDFiAdN0 * tDReprFishN0;
tNAgeFishN0 = rNDFiJvN0 * tDAgeFishN0;
tNMigrFiJvN0 = kMigrFishN0 *(cNDFishRefN0 * cDFiJvInN0 - aNFiJvN0);
tNConsFiJvN0 = rNDZooEpiN0 * tDConsFiJvN0;
afNAssFiJvN0 = MIN(1.0,cNDFishRefN0 / rNDZooEpiN0 * fDAssFiJvN0);
tNAssFiJvN0 = afNAssFiJvN0 * tNConsFiJvN0;
tNEgesFiJvN0 = tNConsFiJvN0 - tNAssFiJvN0;
tNExcrFiJvN0 = (rNDFiJvN0 / cNDFishRefN0) * kDRespFiJvN0 * uFunTmFishN0 * aNFiJvN0;
tNMortFiJvN0 = rNDFiJvN0 * tDMortFiJvN0;
tNMigrFiAdN0 = kMigrFishN0 *(cNDFishRefN0 * cDFiAdInN0 - aNFiAdN0);
tNConsFiAdN0 = rNDBentN0 * tDConsFiAdN0;
tNAssFiAdN0 = afNAssFiAdN0 * tNConsFiAdN0;
tNEgesFiAdN0 = tNConsFiAdN0 - tNAssFiAdN0;
tNExcrFiAdN0 = (rNDFiAdN0 / cNDFishRefN0) * kDRespFiAdN0 * uFunTmFishN0 * aNFiAdN0;
tNMortFiAdN0 = rNDFiAdN0 * tDMortFiAdN0;
tNHarvFishN0 = rNDFiAdN0 * tDHarvFishN0;
tNMortFiAdBotN0 = fDBoneN0 * tNMortFiAdN0;
tNMortFiAdNH4N0 = fDissMortFishN0 *(tNMortFiAdN0 - tNMortFiAdBotN0);
tNMortFiAdDetN0 = tNMortFiAdN0 - tNMortFiAdBotN0 - tNMortFiAdNH4N0;
tNMortFiJvBotN0 = fDBoneN0 * tNMortFiJvN0;
tNMortFiJvNH4N0 = fDissMortFishN0 *(tNMortFiJvN0 - tNMortFiJvBotN0);
tNMortFiJvDetN0 = tNMortFiJvN0 - tNMortFiJvBotN0 - tNMortFiJvNH4N0;
tNEgesFiJvNH4N0 = fDissEgesFishN0 * tNEgesFiJvN0;
tNEgesFiJvDetN0 = tNEgesFiJvN0 - tNEgesFiJvNH4N0;
tDMigrPiscN0 = kMigrPiscN0 *(cDPiscInN0 - aDPiscN0);
aDFishN0 = aDFiJvN0 + aDFiAdN0;
aDSatPiscN0 = aDFishN0*aDFishN0 /(hDFishPiscN0*hDFishPiscN0 + aDFishN0*aDFishN0);
tDEnvPiscN0 = MAX(0.0,akDIncrPiscN0 / aDCarrPiscN0 * aDPiscN0*aDPiscN0);
tDAssPiscN0 = aDSatPiscN0 *(kDAssPiscN0 * aFunVegPiscN0 * uFunTmPiscN0 * aDPiscN0 - tDEnvPiscN0);
tDConsPiscN0 = tDAssPiscN0 / fDAssPiscN0;
tDEgesPiscN0 = tDConsPiscN0 - tDAssPiscN0;
tDConsFiJvPiscN0 = aDFiJvN0 / aDFishN0 * tDConsPiscN0;
tDConsFiAdPiscN0 = tDConsPiscN0 - tDConsFiJvPiscN0;
tDMortPiscN0 = kMortPiscN0 * aDPiscN0 +(1.0 - aDSatPiscN0) * tDEnvPiscN0;
tDMortPiscBotN0 = fDBoneN0 * tDMortPiscN0;
tDMortPiscDetN0 = tDMortPiscN0 - tDMortPiscBotN0;
tDHarvPiscN0 = ukHarvPiscN0 * aDPiscN0;
aPPiscN0 = cPDPiscN0 * aDPiscN0;
tPConsFiJvPiscN0 = rPDFiJvN0 * tDConsFiJvPiscN0;
tPConsFiAdPiscN0 = rPDFiAdN0 * tDConsFiAdPiscN0;
tPConsPiscN0 = tPConsFiJvPiscN0 + tPConsFiAdPiscN0;
rPDFoodPiscN0 = tPConsPiscN0 / tDConsPiscN0;
aNPiscN0 = cNDPiscN0 * aDPiscN0;
tNConsFiJvPiscN0 = rNDFiJvN0 * tDConsFiJvPiscN0;
tNConsFiAdPiscN0 = rNDFiAdN0 * tDConsFiAdPiscN0;
tNConsPiscN0 = tNConsFiJvPiscN0 + tNConsFiAdPiscN0;
rNDFoodPiscN0 = tNConsPiscN0 / tDConsPiscN0;
tDConsPiscNutN0 = (tDAssPiscN0 / fDAssPiscN0) * MAX (1.0, cNDPiscN0 / rNDFoodPiscN0 * fDAssPiscN0, cPDPiscN0 / rPDFoodPiscN0 * fDAssPiscN0);
tDEgesPiscNutN0 = tDConsPiscNutN0 - tDAssPiscN0;
tDConsFiJvPiscNutN0 = aDFiJvN0 / aDFishN0 * tDConsPiscNutN0;
tDConsFiAdPiscNutN0 = tDConsPiscNutN0 - tDConsFiJvPiscNutN0;
tPConsFiJvPiscNutN0 = rPDFiJvN0 * tDConsFiJvPiscNutN0;
tPConsFiAdPiscNutN0 = rPDFiAdN0 * tDConsFiAdPiscNutN0;
tPConsPiscNutN0 = tPConsFiJvPiscNutN0 + tPConsFiAdPiscNutN0;
tNConsFiJvPiscNutN0 = rNDFiJvN0 * tDConsFiJvPiscNutN0;
tNConsFiAdPiscNutN0 = rNDFiAdN0 * tDConsFiAdPiscNutN0;
tNConsPiscNutN0 = tNConsFiJvPiscNutN0 + tNConsFiAdPiscNutN0;
afPAssPiscN0 = MIN(1.0, ((cPDPiscN0 / rPDFoodPiscN0 * fDAssPiscN0) / (tDConsPiscNutN0 / tDConsPiscN0 )) );
tPAssPiscN0 = afPAssPiscN0 * tPConsPiscNutN0;
tPEgesPiscN0 = tPConsPiscNutN0 - tPAssPiscN0;
tPEgesPiscPO4N0 = fDissEgesPiscN0 * tPEgesPiscN0;
tPEgesPiscDetN0 = tPEgesPiscN0 - tPEgesPiscPO4N0;
tDRespPiscN0 = kDRespPiscN0 * uFunTmPiscN0 * aDPiscN0;
tPExcrPiscN0 = cPDPiscN0 * tDRespPiscN0;
tPMortPiscN0 = cPDPiscN0 * tDMortPiscN0;
tPMortPiscBotN0 = fPBoneN0 * tPMortPiscN0;
tPMortPiscPO4N0 = fDissMortPiscN0 *(tPMortPiscN0 - tPMortPiscBotN0);
tPMortPiscDetN0 = tPMortPiscN0 - tPMortPiscBotN0 - tPMortPiscPO4N0;
tPMigrPiscN0 = kMigrPiscN0 *(cPDPiscN0 * cDPiscInN0 - aPPiscN0);
tPHarvPiscN0 = cPDPiscN0 * tDHarvPiscN0;
afNAssPiscN0 = MIN(1.0, ((cNDPiscN0 / rNDFoodPiscN0 * fDAssPiscN0) / (tDConsPiscNutN0 / tDConsPiscN0 )) );
tNAssPiscN0 = afNAssPiscN0 * tNConsPiscNutN0;
tNEgesPiscN0 = tNConsPiscNutN0 - tNAssPiscN0;
tNEgesPiscNH4N0 = fDissEgesPiscN0 * tNEgesPiscN0;
tNEgesPiscDetN0 = tNEgesPiscN0 - tNEgesPiscNH4N0;
tNExcrPiscN0 = cNDPiscN0 * tDRespPiscN0;
tNMortPiscN0 = cNDPiscN0 * tDMortPiscN0;
tNMortPiscBotN0 = fDBoneN0 * tNMortPiscN0;
tNMortPiscNH4N0 = fDissMortPiscN0 *(tNMortPiscN0 - tNMortPiscBotN0);
tNMortPiscDetN0 = tNMortPiscN0 - tNMortPiscBotN0 - tNMortPiscNH4N0;
tNMigrPiscN0 = kMigrPiscN0 *(cNDPiscN0 * cDPiscInN0 - aNPiscN0);
tNHarvPiscN0 = cNDPiscN0 * tDHarvPiscN0;
tDWebBentN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tDMigrBentN0 + tDAssBentN0 - tDConsFiAdN0 - tDRespBentN0 - tDMortBentN0 ENDIF;
tPWebBentN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tPMigrBentN0 + tPAssBentN0 - tPConsFiAdN0 - tPExcrBentN0 - tPMortBentN0 ENDIF;
tNWebBentN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tNMigrBentN0 + tNAssBentN0 - tNConsFiAdN0 - tNExcrBentN0 - tNMortBentN0 ENDIF;
tDWebFiJvN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tDMigrFiJvN0 + tDReprFishN0 - tDAgeFishN0 + tDAssFiJvN0 - tDRespFiJvN0 - tDMortFiJvN0 - tDConsFiJvPiscNutN0 ENDIF;
tPWebFiJvN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tPMigrFiJvN0 + tPReprFishN0 - tPAgeFishN0 + tPAssFiJvN0 - tPExcrFiJvN0 - tPMortFiJvN0 - tPConsFiJvPiscNutN0 ENDIF;
tNWebFiJvN0 =IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tNMigrFiJvN0 + tNReprFishN0 - tNAgeFishN0 + tNAssFiJvN0 - tNExcrFiJvN0 - tNMortFiJvN0 - tNConsFiJvPiscNutN0 ENDIF;
tDWebFiAdN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tDMigrFiAdN0 + tDAssFiAdN0 - tDRespFiAdN0 - tDMortFiAdN0 - tDReprFishN0 + tDAgeFishN0 - tDConsFiAdPiscNutN0 - tDHarvFishN0 ENDIF;
tPWebFiAdN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tPMigrFiAdN0 + tPAssFiAdN0 - tPExcrFiAdN0 - tPMortFiAdN0 - tPReprFishN0 + tPAgeFishN0 - tPConsFiAdPiscNutN0 - tPHarvFishN0 ENDIF;
tNWebFiAdN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tNMigrFiAdN0 + tNAssFiAdN0 - tNExcrFiAdN0 - tNMortFiAdN0 - tNReprFishN0 + tNAgeFishN0 - tNConsFiAdPiscNutN0 - tNHarvFishN0 ENDIF;
tDWebPiscN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tDMigrPiscN0 + tDAssPiscN0 - tDRespPiscN0 - tDMortPiscN0 - tDHarvPiscN0 ENDIF;
wDWebZooHypN0 = IF (FALSE EQ InclWebN0 OR aInclStratN0 EQ FALSE) THEN 0.0 ELSE wDAssZooHypN0 - wDRespZooHypN0 - wDMortZooHypN0 - tDConsFiJvN0 * (( aDTotZooN0 - oDZooEpiN0 * uDepthWEpiN0) / (aDTotZooN0 + NearZeroN0)) / uDepthWHypN0 ENDIF;
wDWebDetWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsDetZooHypN0 + wDEgesZooHypN0 + wDMortZooHypN0 +(tDEgesFiJvN0 * uFiJvEgesHypN0 + tDEgesFiAdN0 * uFiAdEgesHypN0 + tDMortFiJvDetN0 * uFiJvMortHypN0 + tDMortFiAdDetN0 * uFiAdMortHypN0 + tDEgesPiscNutN0 * uPiscEgesHypN0 + tDMortPiscDetN0 * uPiscMortHypN0) / uDepthWHypN0 ENDIF;
wDWebDiatWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsDiatZooHypN0 ENDIF;
wDWebGrenWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsGrenZooHypN0 ENDIF;
wDWebBlueWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsBlueZooHypN0 ENDIF;
wDWebZooEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wDAssZooEpiN0 - wDRespZooEpiN0 - wDMortZooEpiN0 - tDConsFiJvN0 * (oDZooEpiN0 * uDepthWEpiN0 / (aDTotZooN0 + NearZeroN0) ) / uDepthWEpiN0 ENDIF;
wDWebDetWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsDetZooEpiN0 + wDEgesZooEpiN0 + wDMortZooEpiN0 +(tDEgesFiJvN0 * ( 1.0 - uFiJvEgesHypN0 ) + tDEgesFiAdN0 * ( 1.0 - uFiAdEgesHypN0 ) + tDMortFiJvDetN0 * ( 1.0 - uFiJvMortHypN0 ) + tDMortFiAdDetN0 * ( 1.0 - uFiAdMortHypN0 ) + tDEgesPiscNutN0 * ( 1.0 - uPiscEgesHypN0 ) + tDMortPiscDetN0 * ( 1.0 - uPiscMortHypN0)) / uDepthWEpiN0 ENDIF;
wDWebDiatWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsDiatZooEpiN0 ENDIF;
wDWebGrenWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsGrenZooEpiN0 ENDIF;
wDWebBlueWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDConsBlueZooEpiN0 ENDIF;
tDWebBlueSurfN0 = IF (InclWebN0 EQ FALSE OR InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE - tDConsBlueZooSurfN0 ENDIF;
tDWebTotTN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wDRespZooEpiN0 * uDepthWEpiN0 - wDRespZooHypN0 * uDepthWHypN0 + tDMigrFiJvN0 + tDMigrFiAdN0 + tDMigrPiscN0 + tDMigrBentN0 - tDRespFiJvN0 - tDRespFiAdN0 - tDRespPiscN0 - tDRespBentN0 - tDMortFiJvBotN0 - tDMortFiAdBotN0- tDMortPiscBotN0 - tDHarvFishN0 - tDHarvPiscN0 ENDIF;
wPWebZooHypN0 = IF (FALSE EQ InclWebN0 OR aInclStratN0 EQ FALSE) THEN 0.0 ELSE wPAssZooHypN0 - wPExcrZooHypN0 - wPMortZooHypN0 - tPConsFiJvN0 * (( aPTotZooN0 - oPZooEpiN0 * uDepthWEpiN0 ) / (aPTotZooN0 + NearZeroN0) ) / uDepthWHypN0 ENDIF;
wPWebPO4WHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wPExcrZooHypN0 + wPEgesZooPO4HypN0 + wPMortZooPO4HypN0 +(tPExcrFiJvN0 *uFiJvExcrHypN0 + tPExcrFiAdN0 * uFiAdExcrHypN0 + tPEgesFiJvPO4N0 * uFiJvEgesHypN0 + tPEgesFiAdPO4N0 * uFiAdEgesHypN0 + tPMortFiJvPO4N0 * uFiJvMortHypN0 + tPMortFiAdPO4N0 * uFiAdMortHypN0+ tPExcrPiscN0 * uPiscExcrHypN0 + tPEgesPiscPO4N0 * uPiscEgesHypN0 + tPMortPiscPO4N0 * uPiscMortHypN0 ) / uDepthWHypN0 ENDIF;
wPWebDetWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsDetZooHypN0 + wPEgesZooDetHypN0 + wPMortZooDetHypN0 +(tPEgesFiJvDetN0 * uFiJvEgesHypN0 + tPEgesFiAdDetN0 * uFiAdEgesHypN0+ tPMortFiJvDetN0 * uFiJvMortHypN0 + tPMortFiAdDetN0 * uFiAdMortHypN0+ tPEgesPiscDetN0 * uPiscEgesHypN0+ tPMortPiscDetN0 * uPiscMortHypN0) / uDepthWHypN0 ENDIF;
wPWebDiatWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsDiatZooHypN0 ENDIF;
wPWebGrenWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsGrenZooHypN0 ENDIF;
wPWebBlueWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsBlueZooHypN0 ENDIF;
wPWebZooEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wPAssZooEpiN0 - wPExcrZooEpiN0 - wPMortZooEpiN0 - tPConsFiJvN0 * (oPZooEpiN0 * uDepthWEpiN0 / (aPTotZooN0 + NearZeroN0)) / uDepthWEpiN0 ENDIF;
wPWebPO4WEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wPExcrZooEpiN0 + wPEgesZooPO4EpiN0 + wPMortZooPO4EpiN0 +(tPExcrFiJvN0 * ( 1.0 -uFiJvExcrHypN0 ) + tPExcrFiAdN0 * ( 1.0 - uFiAdExcrHypN0 )+ tPEgesFiJvPO4N0 * ( 1.0 - uFiJvEgesHypN0 ) + tPEgesFiAdPO4N0 * ( 1.0 - uFiAdEgesHypN0 ) + tPMortFiJvPO4N0 * ( 1.0 - uFiJvMortHypN0 ) + tPMortFiAdPO4N0 * ( 1.0 - uFiAdMortHypN0 )+ tPExcrPiscN0 * ( 1.0 - uPiscExcrHypN0 ) + tPEgesPiscPO4N0 * ( 1.0 - uPiscEgesHypN0 ) + tPMortPiscPO4N0 * ( 1.0 - uPiscMortHypN0)) / uDepthWEpiN0 ENDIF;
wPWebDetWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsDetZooEpiN0 + wPEgesZooDetEpiN0 + wPMortZooDetEpiN0 +(tPEgesFiJvDetN0 * ( 1.0 - uFiJvEgesHypN0 ) + tPEgesFiAdDetN0 * ( 1.0 - uFiAdEgesHypN0 )+ tPMortFiJvDetN0 * ( 1.0 - uFiJvMortHypN0 ) + tPMortFiAdDetN0 * ( 1.0 - uFiAdMortHypN0 )+ tPEgesPiscDetN0 * ( 1.0 - uPiscEgesHypN0 )+ tPMortPiscDetN0 * ( 1.0 - uPiscMortHypN0 )) / uDepthWEpiN0 ENDIF;
wPWebDiatWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsDiatZooEpiN0 ENDIF;
wPWebGrenWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsGrenZooEpiN0 ENDIF;
wPWebBlueWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wPConsBlueZooEpiN0 ENDIF;
tPWebBlueSurfN0 = IF (InclWebN0 EQ FALSE OR InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE - tPConsBlueZooSurfN0 ENDIF;
tPWebTotTN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tPMigrFiJvN0 + tPMigrFiAdN0 + tPMigrPiscN0 + tPMigrBentN0 - tPMortFiJvBotN0 - tPMortFiAdBotN0- tPMortPiscBotN0 - tPHarvFishN0 - tPHarvPiscN0 ENDIF;
tNEgesFiAdNH4N0 = fDissEgesFishN0 * tNEgesFiAdN0;
tNEgesFiAdDetN0 = tNEgesFiAdN0 - tNEgesFiAdNH4N0;
wNWebNO3WHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE 0.0 ENDIF;
wNWebNO3WEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE 0.0 ENDIF;
wNWebZooHypN0 = IF (FALSE EQ InclWebN0 OR aInclStratN0 EQ FALSE) THEN 0.0 ELSE wNAssZooHypN0 - wNExcrZooHypN0 - wNMortZooHypN0 - tNConsFiJvN0 * (( aNTotZooN0 -oNZooEpiN0 * uDepthWEpiN0 ) / (aNTotZooN0 + NearZeroN0) ) / uDepthWHypN0 ENDIF;
wNWebNH4WHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wNExcrZooHypN0 + wNEgesZooNH4HypN0 + wNMortZooNH4HypN0 +(tNExcrFiJvN0 * uFiJvExcrHypN0 + tNExcrFiAdN0 * uFiAdExcrHypN0 + tNEgesFiJvNH4N0 * uFiJvEgesHypN0+ tNEgesFiAdNH4N0 * uFiAdEgesHypN0 + tNMortFiAdNH4N0 *uFiAdMortHypN0+ tNMortFiJvNH4N0*uFiJvMortHypN0 + tNExcrPiscN0 *uPiscExcrHypN0 + tNEgesPiscNH4N0 *uPiscEgesHypN0 + tNMortPiscNH4N0 *uPiscMortHypN0) / uDepthWHypN0 ENDIF;
wNWebDetWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsDetZooHypN0 + wNEgesZooDetHypN0 + wNMortZooDetHypN0 +(tNEgesFiJvDetN0 * uFiJvEgesHypN0 +tNEgesFiAdDetN0 * uFiAdEgesHypN0+ tNMortFiJvDetN0 * uFiJvMortHypN0 + tNMortFiAdDetN0 * uFiAdMortHypN0 + tNEgesPiscDetN0 * uPiscEgesHypN0 + tNMortPiscDetN0 * uPiscMortHypN0) / uDepthWHypN0 ENDIF;
wNWebDiatWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsDiatZooHypN0 ENDIF;
wNWebGrenWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsGrenZooHypN0 ENDIF;
wNWebBlueWHypN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsBlueZooHypN0 ENDIF;
wNWebZooEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wNAssZooEpiN0 - wNExcrZooEpiN0 - wNMortZooEpiN0 - tNConsFiJvN0 * (oNZooEpiN0 * uDepthWEpiN0 / (aNTotZooN0 + NearZeroN0) ) / uDepthWEpiN0 ENDIF;
wNWebNH4WEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wNExcrZooEpiN0 + wNEgesZooNH4EpiN0 + wNMortZooNH4EpiN0 +(tNExcrFiJvN0 * ( 1.0 - uFiJvExcrHypN0) + tNExcrFiAdN0 * ( 1.0 - uFiAdExcrHypN0) + tNEgesFiJvNH4N0 * ( 1.0 - uFiJvEgesHypN0 ) + tNEgesFiAdNH4N0 * ( 1.0 - uFiAdEgesHypN0 ) + tNMortFiAdNH4N0 * ( 1.0 -uFiAdMortHypN0 ) + tNMortFiJvNH4N0* ( 1.0 -uFiJvMortHypN0) + tNExcrPiscN0 * ( 1.0 -uPiscExcrHypN0 ) + tNEgesPiscNH4N0 * ( 1.0 -uPiscEgesHypN0 ) + tNMortPiscNH4N0 * ( 1.0 -uPiscMortHypN0)) / uDepthWEpiN0 ENDIF;
wNWebDetWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsDetZooEpiN0 + wNEgesZooDetEpiN0 + wNMortZooDetEpiN0 +(tNEgesFiJvDetN0 * ( 1.0 - uFiJvEgesHypN0 ) +tNEgesFiAdDetN0 * ( 1.0 - uFiAdEgesHypN0 ) + tNMortFiJvDetN0 * ( 1.0 - uFiJvMortHypN0 ) + tNMortFiAdDetN0 * ( 1.0 - uFiAdMortHypN0 ) + tNEgesPiscDetN0 * ( 1.0 - uPiscEgesHypN0 ) + tNMortPiscDetN0 * ( 1.0 - uPiscMortHypN0 )) / uDepthWEpiN0 ENDIF;
wNWebDiatWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsDiatZooEpiN0 ENDIF;
wNWebGrenWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsGrenZooEpiN0 ENDIF;
wNWebBlueWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE - wNConsBlueZooEpiN0 ENDIF;
tNWebBlueSurfN0 = IF (InclWebN0 EQ FALSE OR InclSurfN0 EQ FALSE OR aDBlueSurfN0 LT cDBlueSurfMinN0) THEN 0.0 ELSE - tNConsBlueZooSurfN0 ENDIF;
tNWebTotTN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE tNMigrFiJvN0 + tNMigrFiAdN0 + tNMigrPiscN0 + tNMigrBentN0 - tNMortFiJvBotN0- tNMortFiAdBotN0 - tNMortPiscBotN0 - tNHarvFishN0 - tNHarvPiscN0 ENDIF;
wSiWebDetWEpiN0 = IF (FALSE EQ InclWebN0) THEN 0.0 ELSE wSiConsDiatZooEpiN0 ENDIF;
aPrefAveEpiN0 = (cPrefDiatN0 * oDDiatWEpiN0 + cPrefGrenN0 * oDGrenWEpiN0 + cPrefBlueN0 * oDBlueWEpiN0 + cPrefDetN0 * oDDetWEpiN0) / oDOMWEpiN0;
wDConsZoo2EpiN0 = aFiltEpiN0 * aPrefAveEpiN0 * oDOMWEpiN0 * oDZooEpiN0;
aDConsZooSpEpiN0 = wDConsZooEpiN0 / oDZooEpiN0;
aDAssZooSpEpiN0 = wDAssZooEpiN0 / oDZooEpiN0;
aDGrazSpEpiN0 = wDConsZooEpiN0 / oDOMWEpiN0;
aPConsZooSpEpiN0 = wPConsZooEpiN0 / oPZooEpiN0;
aPGrazSpEpiN0 = wPConsZooEpiN0 / oPOMWEpiN0;
aNConsZooSpEpiN0 = wNConsZooEpiN0 / oNZooEpiN0;
aNGrazSpEpiN0 = wNConsZooEpiN0 / oNOMWEpiN0;
tDSetTotEpiN0 = tDSetIMEpiN0 + tDSetDetEpiN0 + tDSetPhytEpiN0;
tPSetTotEpiN0 = tPSetAIMEpiN0 + tPSetDetEpiN0 + tPSetPhytEpiN0;
tNSetTotEpiN0 = tNSetDetEpiN0 + tNSetPhytEpiN0;
tDResusTotN0 = tDResusDeadN0 + tDResusPhytTotN0;
tPResusTotN0 = tPResusDetN0 + tPResusAIMN0 + tPResusPhytN0 + tPResusPO4N0;
tNResusTotN0 = tNResusDetN0 + tNResusNH4N0 + tNResusNO3N0 + tNResusPhytN0;
aDepthStartN0 = IF (sTimeN0 EQ bTimeDredN0) THEN uDepthWN0 ELSE aDepthStartN0 ENDIF;
akDredDepthN0 = IF ((sTimeN0 GE bTimeDredN0) AND (sTimeN0 LT bTimeDredN0 + cLengDredN0) AND (aDepthStartN0 LE cDepthRefN0 - cDepthSN0)) THEN (LN(cDepthRefN0 / aDepthStartN0)) / cLengDredN0 ELSE 0.0 ENDIF;
akDredN0 = IF ((sTimeN0 GE bTimeDredN0) AND (sTimeN0 LT bTimeDredN0 + cLengDredN0) AND (aDepthStartN0 LE cDepthRefN0 - cDepthSN0)) THEN (- LN(1.0 - fEffDredN0)) / cLengDredN0 ELSE 0.0 ENDIF;
akDredBentN0 = IF ((sTimeN0 GE bTimeDredN0) AND (sTimeN0 LT bTimeDredN0 + cLengDredN0) AND (aDepthStartN0 LE cDepthRefN0 - cDepthSN0)) THEN (- LN(1.0 - fEffDredBentN0)) / cLengDredN0 ELSE 0.0 ENDIF;
vDredDepthWN0 =IF (aInclStratN0 EQ TRUE) THEN 0.0 ELSE akDredDepthN0 * uDepthWN0 ENDIF;
tDDredDetSN0 = akDredN0 * aDDetSN0;
tPDredDetSN0 = akDredN0 * aPDetSN0;
tNDredDetSN0 = akDredN0 * aNDetSN0;
tSiDredDetSN0 = akDredN0 * aSiDetSN0;
tPDredAIMSN0 = akDredN0 * aPAIMSN0;
tDDredNetSoilN0 = -(tDDredDetSN0 / cRhoOMN0) * bRhoSolidSoilN0;
tDDredNetIMSN0 = (1.0 - fDOrgSoilN0) * tDDredNetSoilN0;
tDDredNetHumSN0 = fDOrgSoilN0 * tDDredNetSoilN0;
tPDredNetHumSN0 = cPDSoilOMN0 * tDDredNetHumSN0;
tNDredNetHumSN0 = cNDSoilOMN0 * tDDredNetHumSN0;
tDDredDiatSN0 = akDredN0 * aDDiatSN0;
tPDredDiatSN0 = akDredN0 * aPDiatSN0;
tNDredDiatSN0 = akDredN0 * aNDiatSN0;
tDDredGrenSN0 = akDredN0 * aDGrenSN0;
tPDredGrenSN0 = akDredN0 * aPGrenSN0;
tNDredGrenSN0 = akDredN0 * aNGrenSN0;
tDDredBlueSN0 = akDredN0 * aDBlueSN0;
tPDredBlueSN0 = akDredN0 * aPBlueSN0;
tNDredBlueSN0 = akDredN0 * aNBlueSN0;
tDDredPhytSN0 = tDDredDiatSN0+tDDredGrenSN0+tDDredBlueSN0;
tPDredPhytSN0 = tPDredDiatSN0+tPDredGrenSN0+tPDredBlueSN0;
tNDredPhytSN0 = tNDredDiatSN0+tNDredGrenSN0+tNDredBlueSN0;
tDDredBentN0 = IF (InclWebN0 EQ TRUE) THEN akDredBentN0 * aDBentN0 ELSE 0.0 ENDIF;
tPDredBentN0 = IF (InclWebN0 EQ TRUE) THEN akDredBentN0 * aPBentN0 ELSE 0.0 ENDIF;
tNDredBentN0 = IF (InclWebN0 EQ TRUE) THEN akDredBentN0 * aNBentN0 ELSE 0.0 ENDIF;
tDDredVegN0 = akDredN0 * aDVegN0;
tPDredVegN0 = akDredN0 * aPVegN0;
tNDredVegN0 = akDredN0 * aNVegN0;
tDDredNetTotN0 = tDDredDetSN0 - tDDredNetSoilN0 + tDDredPhytSN0 + tDDredBentN0 + tDDredVegN0;
tPDredNetTotN0 = tPDredDetSN0 - tPDredNetHumSN0 + tPDredAIMSN0 + tPDredPhytSN0 + tPDredBentN0 + tPDredVegN0;
tNDredNetTotN0 = tNDredDetSN0 - tNDredNetHumSN0 + tNDredPhytSN0 + tNDredBentN0 + tNDredVegN0;
tSiDredTotN0 = tSiDredDetSN0 + cSiDDiatN0 * tDDredDiatSN0;
tDIMSN0 = tDAbioIMSN0;
tDHumSN0 = tDAbioHumSN0;
tDDetSN0 = tDAbioDetSN0 + tDPrimDetSN0 + tDWebDetSN0 + tDBedDetSEpiN0 + tDBedDetSHypN0;
vDeltaSN0 = (tDIMSN0 / cRhoIMN0 +(tDHumSN0 + tDDetSN0) / cRhoOMN0)/(1.0 - bPorSN0);
vDeltaWN0 = IF (ConstDepthN0 EQ TRUE ) THEN 0.0 ELSE - vDeltaSN0 ENDIF;
tDBurIMN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN ((tDHumSN0 + tDDetSN0) +(cRhoOMN0 / cRhoIMN0) * tDIMSN0) / ((aDHumSN0 + aDDetSN0) / aDIMSN0 + cRhoOMN0 / cRhoIMN0) ELSE ((tDHumSN0 + tDDetSN0) +(cRhoOMN0 / cRhoIMN0) * tDIMSN0) / (fDOrgSoilN0 /(1.0 - fDOrgSoilN0) + cRhoOMN0 / cRhoIMN0) ENDIF;
tDBurOMN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN (aDHumSN0 + aDDetSN0) / aDIMSN0 * tDBurIMN0 ELSE fDOrgSoilN0 /(1.0 - fDOrgSoilN0) * tDBurIMN0 ENDIF;
tDBurDetN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN aDDetSN0 /(aDHumSN0 + aDDetSN0) * tDBurOMN0 ELSE 0.0 ENDIF;
tDBurHumN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN tDBurOMN0 - tDBurDetN0 ELSE tDBurOMN0 ENDIF;
tDBurTotN0 =IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN0 GE 0.0) THEN tDBurIMN0 + tDBurOMN0 ELSE tDBurIMN0 + tDBurOMN0 ENDIF;
tPBurHumN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN rPDHumSN0 * tDBurHumN0 ELSE cPDSoilOMN0 * tDBurHumN0 ENDIF;
tPBurDetN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN0 GE 0.0) THEN rPDDetSN0 * tDBurDetN0 ELSE 0.0 ENDIF;
tPBurAIMN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN aPAIMSN0 / aDIMSN0 * tDBurIMN0 ELSE 0.0 ENDIF;
tPBurPO4N0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN aPO4SN0 *(vDeltaSN0 / cDepthSN0) ELSE cPO4GroundN0 *(bPorSN0 * vDeltaSN0) ENDIF;
tPBurTotN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN tPBurDetN0 + tPBurHumN0 + tPBurAIMN0 + tPBurPO4N0 ELSE tPBurHumN0 + tPBurAIMN0 + tPBurPO4N0 ENDIF;
tNBurHumN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN rNDHumSN0 * tDBurHumN0 ELSE cNDSoilOMN0 * tDBurHumN0 ENDIF;
tNBurDetN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN rNDDetSN0 * tDBurDetN0 ELSE 0.0 ENDIF;
tNBurNH4N0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN aNH4SN0 *(vDeltaSN0 / cDepthSN0) ELSE cNH4GroundN0 *(bPorSN0 * vDeltaSN0) ENDIF;
tNBurNO3N0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN aNO3SN0 *(vDeltaSN0 / cDepthSN0) ELSE cNO3GroundN0 *(bPorSN0 * vDeltaSN0) ENDIF;
tNBurTotN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN tNBurDetN0 + tNBurHumN0 + tNBurNH4N0 + tNBurNO3N0 ELSE tNBurHumN0 + tNBurNH4N0 + tNBurNO3N0 ENDIF;
tSiBurDetN0 = IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN rSiDDetSN0 * tDBurDetN0 ELSE 0.0 ENDIF;
tSiBurTotN0 =IF (InclBurN0 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN0 GE 0.0) THEN tSiBurDetN0 ELSE 0.0 ENDIF;
aRelDeltaWEpiN0 = IF ( aInclStratN0 EQ TRUE ) THEN (vDeltaWN0 ) / uDepthWEpiN0 ELSE (vDeltaWN0 + vDredDepthWN0) / uDepthWEpiN0 ENDIF;
aRelDeltaWHypN0 = IF ( aInclStratN0 EQ FALSE ) THEN 0.0 ELSE (vDeltaWN0 + vDredDepthWN0) / uDepthWHypN0 ENDIF ;
aPFishN0 = aPFiJvN0 + aPFiAdN0;
aNFishN0 = aNFiJvN0 + aNFiAdN0;
aDRelTotTN0 = uDepthWHypN0 * aRelDeltaWHypN0 * ( oDDetWHypN0 + oDIMWHypN0 + oDDiatWHypN0 + oDGrenWHypN0 + oDBlueWHypN0 + oDZooHypN0 ) + fMarshN0 * uDepthWMN0 * aRelDeltaWMN0 * ( oDDetWMN0 + oDIMWMN0 + oDDiatWMN0 + oDGrenWMN0 + oDBlueWMN0 + oDZooMN0) + uDepthWEpiN0 * aRelDeltaWEpiN0 * (oDDetWEpiN0 + oDIMWEpiN0 + oDDiatWEpiN0 + oDGrenWEpiN0 + oDBlueWEpiN0 + oDZooEpiN0 );
aNRelTotTN0 = uDepthWHypN0 * aRelDeltaWHypN0 * ( oNH4WHypN0 + oNO3WHypN0 + oNDetWHypN0 + oNDiatWHypN0 + oNGrenWHypN0 + oNBlueWHypN0 + oNZooHypN0 ) + fMarshN0 * uDepthWMN0 * aRelDeltaWMN0 * ( oNH4WMN0 + oNO3WMN0 + oNDetWMN0 + oNDiatWMN0 + oNGrenWMN0 + oNBlueWMN0 + oNZooMN0 ) + uDepthWEpiN0 * aRelDeltaWEpiN0 * ( oNH4WEpiN0 + oNO3WEpiN0 + oNDetWEpiN0 + oNDiatWEpiN0 + oNGrenWEpiN0 + oNBlueWEpiN0 + oNZooEpiN0 );
aPRelTotTN0 = uDepthWHypN0 * aRelDeltaWHypN0 * ( oPO4WHypN0 + oPAIMWHypN0 + oPDetWHypN0 + oPDiatWHypN0 + oPGrenWHypN0 + oPBlueWHypN0 + oPZooHypN0 ) + fMarshN0 * uDepthWMN0 * aRelDeltaWMN0 * (oPO4WMN0 + oPAIMWMN0 + oPDetWMN0 + oPDiatWMN0 + oPGrenWMN0 + oPBlueWMN0 + oPZooMN0 ) + uDepthWEpiN0 * aRelDeltaWEpiN0 * (oPO4WEpiN0 + oPAIMWEpiN0 + oPDetWEpiN0 + oPDiatWEpiN0 + oPGrenWEpiN0 + oPBlueWEpiN0 + oPZooEpiN0 );
aSiRelTotTN0 = uDepthWHypN0 * aRelDeltaWHypN0 * ( oSiO2WHypN0 + oSiDetWHypN0 + cSiDDiatN0*oDDiatWHypN0) + fMarshN0 * uDepthWMN0 * aRelDeltaWMN0 * ( oSiO2WMN0 + oSiDetWMN0 + cSiDDiatN0*oDDiatWMN0) + uDepthWEpiN0 * aRelDeltaWEpiN0 * ( oSiO2WEpiN0 + oSiDetWEpiN0 + cSiDDiatN0*oDDiatWEpiN0);
aO2RelTotTN0 = uDepthWHypN0 * aRelDeltaWHypN0* oO2WHypN0 + fMarshN0 * uDepthWMN0 * aRelDeltaWMN0 * oO2WMN0 + uDepthWEpiN0 * aRelDeltaWEpiN0 * oO2WEpiN0 ;
aDTotTHypN0 = IF (aInclStratN0 EQ TRUE) THEN (oDIMWHypN0+oDDetWHypN0+oDDiatWHypN0+oDGrenWHypN0+oDBlueWHypN0+oDZooHypN0) * uDepthWHypN0 ELSE 0.0 ENDIF;
aNTotTHypN0 = IF (aInclStratN0 EQ TRUE) THEN (oNH4WHypN0+oNO3WHypN0+oNDetWHypN0+oNDiatWHypN0+oNGrenWHypN0+oNBlueWHypN0 +oNZooHypN0)*uDepthWHypN0 ELSE 0.0 ENDIF;
aPTotTHypN0 = IF (aInclStratN0 EQ TRUE) THEN (oPO4WHypN0+oPDetWHypN0+oPDiatWHypN0+oPGrenWHypN0+oPBlueWHypN0 +oPZooHypN0+oPAIMWHypN0) * uDepthWHypN0 ELSE 0.0 ENDIF;
aSiTotTHypN0 = IF (aInclStratN0 EQ TRUE) THEN (oSiO2WHypN0 + oSiDetWHypN0 + cSiDDiatN0*oDDiatWHypN0) *uDepthWHypN0 ELSE 0.0 ENDIF;
aO2TotTHypN0 = IF (aInclStratN0 EQ TRUE) THEN (oO2WHypN0 ) *uDepthWHypN0 ELSE 0.0 ENDIF;
aDTotTN0 = aDTotTHypN0 + (oDIMWEpiN0+oDDetWEpiN0+oDDiatWEpiN0+oDGrenWEpiN0+oDBlueWEpiN0+oDZooEpiN0) * uDepthWEpiN0 +aDFishN0+aDPiscN0+aDVegN0 +aDIMSN0+aDHumSN0+aDDetSN0+aDDiatSN0+aDGrenSN0+aDBlueSN0+aDBentN0 + aDTotMN0 + aDBlueSurfN0;
aNTotTN0 = aNTotTHypN0+ (oNH4WEpiN0+oNO3WEpiN0+oNDetWEpiN0+oNDiatWEpiN0+oNGrenWEpiN0+oNBlueWEpiN0 +oNZooEpiN0)*uDepthWEpiN0 +aNFishN0+aNPiscN0+aNVegN0 +aNH4SN0+aNO3SN0+aNDetSN0+aNHumSN0+aNDiatSN0+aNGrenSN0+aNBlueSN0 +aNBentN0 + aNTotMN0 + aNBlueSurfN0;
aPTotTN0 = aPTotTHypN0 + (oPO4WEpiN0+oPDetWEpiN0+oPDiatWEpiN0+oPGrenWEpiN0+oPBlueWEpiN0 +oPZooEpiN0+oPAIMWEpiN0) * uDepthWEpiN0 +aPFishN0+aPPiscN0+aPVegN0 +aPO4SN0+aPDetSN0+aPHumSN0+aPDiatSN0+aPGrenSN0+aPBlueSN0 +aPAIMSN0+aPBentN0 + aPTotMN0 +aPBlueSurfN0;
aSiTotTN0 = aSiTotTHypN0 + (oSiO2WEpiN0 + oSiDetWEpiN0 + cSiDDiatN0*oDDiatWEpiN0) *uDepthWEpiN0 + aSiDetSN0 + cSiDDiatN0*aDDiatSN0 + aSiTotMN0;
aO2TotTN0 = aO2TotTHypN0 + ( oO2WEpiN0) *uDepthWEpiN0 + aO2TotMN0;
tDBedTotTN0 = IF InclVegN0 EQ TRUE THEN tDMigrVegN0 + tDProdVegHypN0+ tDProdVegEpiN0 - tDRespVegN0 - tDManVegN0 - tDAssVegBirdN0 ELSE 0.0 ENDIF;
tPBedTotTN0 = IF InclVegN0 EQ TRUE THEN tPMigrVegN0 - tPManVegN0 - tPAssVegBirdN0 ELSE 0.0 ENDIF;
tNBedTotTN0 = IF InclVegN0 EQ TRUE THEN tNMigrVegN0 - tNManVegN0 - tNAssVegBirdN0 ELSE 0.0 ENDIF ;
aDErrorN0 = aDTotTN0 - aDExtTotTN0;
aNErrorN0 = aNTotTN0 - aNExtTotTN0;
aPErrorN0 = aPTotTN0 - aPExtTotTN0;
aSiErrorN0 = aSiTotTN0 - aSiExtTotTN0;
aO2ErrorN0 = aO2TotTN0 - aO2ExtTotTN0;
aDepthErrorN0 = sDepthWN0 - aDepthExtTotTN0;
cCheckVegHeightN0 = IF ( aVegWinN0 EQ 1 AND  uVegHeightN0 LT MIN (cVegHeightWinN0, uDepthWN0) ) THEN 1.0 ELSEIF ( aVegWinN0 EQ 1 AND  uVegHeightN0 GT MIN (cVegHeightWinN0, uDepthWN0) ) THEN 2.0 ELSEIF ( aVegWinN0 EQ 0 AND  uVegHeightN0 LT MIN (cVegHeightN0, uDepthWN0) ) THEN  3.0 ELSEIF ( aVegWinN0 EQ 0 AND  uVegHeightN0 GT MIN (cVegHeightN0, uDepthWN0) ) THEN 4.0 ELSE 0.0 ENDIF;
sTimeN1 = time + DayStartN1;
DaysInYearN1 = DaysPerYearN1* 1;
aInclStratN1 =IF ( InclStratN1 EQ FALSE ) THEN 0.0 ELSE 1.0 ENDIF;
uDepthMixMeasN1 =IF ( calcMixDepthN1 EQ TRUE ) THEN cAMixN1 * POW ( cFetchN1 , (cBMixN1) ) ELSEIF (ReadMixDepthN1 EQ TRUE) THEN mMixDepthN1 ELSE cMixDepthN1 ENDIF;
uDepthWN1= IF sDepthWN1 GT (cMinDepthHypEpiN1 + cMinDepthHypEpiN1) THEN sDepthWN1 ELSE (cMinDepthHypEpiN1 + cMinDepthHypEpiN1) ENDIF;
uDepthWHypN1 =IF ( ( aInclStratN1 EQ TRUE ) AND ((uDepthWN1 - sMixDepthWN1 ) GE cMinDepthHypEpiN1 ) ) THEN uDepthWN1 - sMixDepthWN1  ELSE cMinDepthHypEpiN1 ENDIF;
uDepthWEpiN1 =IF( ( aInclStratN1 EQ TRUE ) AND ( sMixDepthWN1 GE cMinDepthHypEpiN1 ) AND ( uDepthWN1 GE sMixDepthWN1 ) ) THEN sMixDepthWN1 ELSEIF ( ( aInclStratN1 EQ TRUE ) AND ( (sMixDepthWN1 LE cMinDepthHypEpiN1 ) OR (uDepthWN1 LE cMinDepthHypEpiN1 ) ) ) THEN cMinDepthHypEpiN1 ELSEIF ( aInclStratN1 EQ FALSE) THEN uDepthWN1 ELSE uDepthWN1 - uDepthWHypN1 ENDIF;
MassHypN1 = IF CalcMassN1 EQ TRUE THEN uDepthWHypN1 ELSE 1.0 ENDIF;
MassEpiN1 = IF CalcMassN1 EQ TRUE THEN uDepthWEpiN1 ELSE 1.0 ENDIF;
MassWMN1 = IF CalcMassN1 EQ TRUE THEN sDepthWMN1 ELSE 1.0 ENDIF;
oNH4WHypN1= IF sNH4WHypN1 GT NearZeroN1 THEN sNH4WHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNO3WHypN1= IF sNO3WHypN1 GT NearZeroN1 THEN sNO3WHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPO4WHypN1= IF sPO4WHypN1 GT NearZeroN1 THEN sPO4WHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPAIMWHypN1= IF sPAIMWHypN1 GT NearZeroN1 THEN sPAIMWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oSiO2WHypN1= IF sSiO2WHypN1 GT NearZeroN1 THEN sSiO2WHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oO2WHypN1= IF sO2WHypN1 GT NearZeroN1 THEN sO2WHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDDetWHypN1= IF sDDetWHypN1 GT NearZeroN1 THEN sDDetWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNDetWHypN1= IF sNDetWHypN1 GT NearZeroN1 THEN sNDetWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPDetWHypN1= IF sPDetWHypN1 GT NearZeroN1 THEN sPDetWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oSiDetWHypN1= IF sSiDetWHypN1 GT NearZeroN1 THEN sSiDetWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDIMWHypN1= IF sDIMWHypN1 GT NearZeroN1 THEN sDIMWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDDiatWHypN1= IF sDDiatWHypN1 GT NearZeroN1 THEN sDDiatWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNDiatWHypN1= IF sNDiatWHypN1 GT NearZeroN1 THEN sNDiatWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPDiatWHypN1= IF sPDiatWHypN1 GT NearZeroN1 THEN sPDiatWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDGrenWHypN1= IF sDGrenWHypN1 GT NearZeroN1 THEN sDGrenWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNGrenWHypN1= IF sNGrenWHypN1 GT NearZeroN1 THEN sNGrenWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPGrenWHypN1= IF sPGrenWHypN1 GT NearZeroN1 THEN sPGrenWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDBlueWHypN1= IF sDBlueWHypN1 GT NearZeroN1 THEN sDBlueWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNBlueWHypN1= IF sNBlueWHypN1 GT NearZeroN1 THEN sNBlueWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPBlueWHypN1= IF sPBlueWHypN1 GT NearZeroN1 THEN sPBlueWHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oDZooHypN1= IF sDZooHypN1 GT NearZeroN1 THEN sDZooHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oNZooHypN1= IF sNZooHypN1 GT NearZeroN1 THEN sNZooHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
oPZooHypN1= IF sPZooHypN1 GT NearZeroN1 THEN sPZooHypN1 / MassHypN1 ELSE NearZeroN1 ENDIF;
aDFiAdN1= IF sDFiAdN1 GT NearZeroN1 THEN sDFiAdN1 ELSE NearZeroN1 ENDIF;
aDFiJvN1= IF sDFiJvN1 GT NearZeroN1 THEN sDFiJvN1 ELSE NearZeroN1 ENDIF;
aNFiAdN1= IF sNFiAdN1 GT NearZeroN1 THEN sNFiAdN1 ELSE NearZeroN1 ENDIF;
aNFiJvN1= IF sNFiJvN1 GT NearZeroN1 THEN sNFiJvN1 ELSE NearZeroN1 ENDIF;
aPFiAdN1= IF sPFiAdN1 GT NearZeroN1 THEN sPFiAdN1 ELSE NearZeroN1 ENDIF;
aPFiJvN1= IF sPFiJvN1 GT NearZeroN1 THEN sPFiJvN1 ELSE NearZeroN1 ENDIF;
aDPiscN1= IF sDPiscN1 GT NearZeroN1 THEN sDPiscN1 ELSE NearZeroN1 ENDIF;
aNH4SN1= IF sNH4SN1 GT NearZeroN1 THEN sNH4SN1 ELSE NearZeroN1 ENDIF;
aNO3SN1= IF sNO3SN1 GT NearZeroN1 THEN sNO3SN1 ELSE NearZeroN1 ENDIF;
aPO4SN1= IF sPO4SN1 GT NearZeroN1 THEN sPO4SN1 ELSE NearZeroN1 ENDIF;
aPAIMSN1= IF sPAIMSN1 GT NearZeroN1 THEN sPAIMSN1 ELSE NearZeroN1 ENDIF;
aDDetSN1= IF sDDetSN1 GT NearZeroN1 THEN sDDetSN1 ELSE NearZeroN1 ENDIF;
aNDetSN1= IF sNDetSN1 GT NearZeroN1 THEN sNDetSN1 ELSE NearZeroN1 ENDIF;
aPDetSN1= IF sPDetSN1 GT NearZeroN1 THEN sPDetSN1 ELSE NearZeroN1 ENDIF;
aSiDetSN1= IF sSiDetSN1 GT NearZeroN1 THEN sSiDetSN1 ELSE NearZeroN1 ENDIF;
aDHumSN1= IF sDHumSN1 GT NearZeroN1 THEN sDHumSN1 ELSE NearZeroN1 ENDIF;
aNHumSN1= IF sNHumSN1 GT NearZeroN1 THEN sNHumSN1 ELSE NearZeroN1 ENDIF;
aPHumSN1= IF sPHumSN1 GT NearZeroN1 THEN sPHumSN1 ELSE NearZeroN1 ENDIF;
aDIMSN1= IF sDIMSN1 GT NearZeroN1 THEN sDIMSN1 ELSE NearZeroN1 ENDIF;
aDDiatSN1= IF sDDiatSN1 GT NearZeroN1 THEN sDDiatSN1 ELSE NearZeroN1 ENDIF;
aNDiatSN1= IF sNDiatSN1 GT NearZeroN1 THEN sNDiatSN1 ELSE NearZeroN1 ENDIF;
aPDiatSN1= IF sPDiatSN1 GT NearZeroN1 THEN sPDiatSN1 ELSE NearZeroN1 ENDIF;
aDGrenSN1= IF sDGrenSN1 GT NearZeroN1 THEN sDGrenSN1 ELSE NearZeroN1 ENDIF;
aNGrenSN1= IF sNGrenSN1 GT NearZeroN1 THEN sNGrenSN1 ELSE NearZeroN1 ENDIF;
aPGrenSN1= IF sPGrenSN1 GT NearZeroN1 THEN sPGrenSN1 ELSE NearZeroN1 ENDIF;
aDBlueSN1= IF sDBlueSN1 GT NearZeroN1 THEN sDBlueSN1 ELSE NearZeroN1 ENDIF;
aNBlueSN1= IF sNBlueSN1 GT NearZeroN1 THEN sNBlueSN1 ELSE NearZeroN1 ENDIF;
aPBlueSN1= IF sPBlueSN1 GT NearZeroN1 THEN sPBlueSN1 ELSE NearZeroN1 ENDIF;
aDVegN1= IF sDVegN1 GT NearZeroN1 THEN sDVegN1 ELSE NearZeroN1 ENDIF;
aNVegN1= IF sNVegN1 GT NearZeroN1 THEN sNVegN1 ELSE NearZeroN1 ENDIF;
aPVegN1= IF sPVegN1 GT NearZeroN1 THEN sPVegN1 ELSE NearZeroN1 ENDIF;
aVegHeightN1= IF sVegHeightN1 GT NearZeroN1 THEN sVegHeightN1 ELSE NearZeroN1 ENDIF;
aDBentN1= IF sDBentN1 GT NearZeroN1 THEN sDBentN1 ELSE NearZeroN1 ENDIF;
aNBentN1= IF sNBentN1 GT NearZeroN1 THEN sNBentN1 ELSE NearZeroN1 ENDIF;
aPBentN1= IF sPBentN1 GT NearZeroN1 THEN sPBentN1 ELSE NearZeroN1 ENDIF;
uDepthWMN1= IF sDepthWMN1 GT NearZeroN1 THEN sDepthWMN1 ELSE NearZeroN1 ENDIF;
oNH4WMN1= IF sNH4WMN1 GT NearZeroN1 THEN sNH4WMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNO3WMN1= IF sNO3WMN1 GT NearZeroN1 THEN sNO3WMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPO4WMN1= IF sPO4WMN1 GT NearZeroN1 THEN sPO4WMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPAIMWMN1= IF sPAIMWMN1 GT NearZeroN1 THEN sPAIMWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oSiO2WMN1= IF sSiO2WMN1 GT NearZeroN1 THEN sSiO2WMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oO2WMN1= IF sO2WMN1 GT NearZeroN1 THEN sO2WMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDDetWMN1= IF sDDetWMN1 GT NearZeroN1 THEN sDDetWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNDetWMN1= IF sNDetWMN1 GT NearZeroN1 THEN sNDetWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPDetWMN1= IF sPDetWMN1 GT NearZeroN1 THEN sPDetWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oSiDetWMN1= IF sSiDetWMN1 GT NearZeroN1 THEN sSiDetWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDIMWMN1= IF sDIMWMN1 GT NearZeroN1 THEN sDIMWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDDiatWMN1= IF sDDiatWMN1 GT NearZeroN1 THEN sDDiatWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNDiatWMN1= IF sNDiatWMN1 GT NearZeroN1 THEN sNDiatWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPDiatWMN1= IF sPDiatWMN1 GT NearZeroN1 THEN sPDiatWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDGrenWMN1= IF sDGrenWMN1 GT NearZeroN1 THEN sDGrenWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNGrenWMN1= IF sNGrenWMN1 GT NearZeroN1 THEN sNGrenWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPGrenWMN1= IF sPGrenWMN1 GT NearZeroN1 THEN sPGrenWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDBlueWMN1= IF sDBlueWMN1 GT NearZeroN1 THEN sDBlueWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNBlueWMN1= IF sNBlueWMN1 GT NearZeroN1 THEN sNBlueWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPBlueWMN1= IF sPBlueWMN1 GT NearZeroN1 THEN sPBlueWMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oDZooMN1= IF sDZooMN1 GT NearZeroN1 THEN sDZooMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oNZooMN1= IF sNZooMN1 GT NearZeroN1 THEN sNZooMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
oPZooMN1= IF sPZooMN1 GT NearZeroN1 THEN sPZooMN1 / MassWMN1 ELSE NearZeroN1 ENDIF;
aNH4SMN1= IF sNH4SMN1 GT NearZeroN1 THEN sNH4SMN1 ELSE NearZeroN1 ENDIF;
aNO3SMN1= IF sNO3SMN1 GT NearZeroN1 THEN sNO3SMN1 ELSE NearZeroN1 ENDIF;
aPO4SMN1= IF sPO4SMN1 GT NearZeroN1 THEN sPO4SMN1 ELSE NearZeroN1 ENDIF;
aPAIMSMN1= IF sPAIMSMN1 GT NearZeroN1 THEN sPAIMSMN1 ELSE NearZeroN1 ENDIF;
aDDetSMN1= IF sDDetSMN1 GT NearZeroN1 THEN sDDetSMN1 ELSE NearZeroN1 ENDIF;
aNDetSMN1= IF sNDetSMN1 GT NearZeroN1 THEN sNDetSMN1 ELSE NearZeroN1 ENDIF;
aPDetSMN1= IF sPDetSMN1 GT NearZeroN1 THEN sPDetSMN1 ELSE NearZeroN1 ENDIF;
aSiDetSMN1= IF sSiDetSMN1 GT NearZeroN1 THEN sSiDetSMN1 ELSE NearZeroN1 ENDIF;
aDHumSMN1= IF sDHumSMN1 GT NearZeroN1 THEN sDHumSMN1 ELSE NearZeroN1 ENDIF;
aNHumSMN1= IF sNHumSMN1 GT NearZeroN1 THEN sNHumSMN1 ELSE NearZeroN1 ENDIF;
aPHumSMN1= IF sPHumSMN1 GT NearZeroN1 THEN sPHumSMN1 ELSE NearZeroN1 ENDIF;
aDIMSMN1= IF sDIMSMN1 GT NearZeroN1 THEN sDIMSMN1 ELSE NearZeroN1 ENDIF;
aDRootPhraN1= IF sDRootPhraN1 GT NearZeroN1 THEN sDRootPhraN1 ELSE NearZeroN1 ENDIF;
aDShootPhraN1= IF sDShootPhraN1 GT NearZeroN1 THEN sDShootPhraN1 ELSE NearZeroN1 ENDIF;
aNRootPhraN1= IF sNRootPhraN1 GT NearZeroN1 THEN sNRootPhraN1 ELSE NearZeroN1 ENDIF;
aNShootPhraN1= IF sNShootPhraN1 GT NearZeroN1 THEN sNShootPhraN1 ELSE NearZeroN1 ENDIF;
aPRootPhraN1= IF sPRootPhraN1 GT NearZeroN1 THEN sPRootPhraN1 ELSE NearZeroN1 ENDIF;
aPShootPhraN1= IF sPShootPhraN1 GT NearZeroN1 THEN sPShootPhraN1 ELSE NearZeroN1 ENDIF;
oNH4WEpiN1= IF sNH4WEpiN1 GT NearZeroN1 THEN sNH4WEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNO3WEpiN1= IF sNO3WEpiN1 GT NearZeroN1 THEN sNO3WEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPO4WEpiN1= IF sPO4WEpiN1 GT NearZeroN1 THEN sPO4WEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPAIMWEpiN1= IF sPAIMWEpiN1 GT NearZeroN1 THEN sPAIMWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oSiO2WEpiN1= IF sSiO2WEpiN1 GT NearZeroN1 THEN sSiO2WEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oO2WEpiN1= IF sO2WEpiN1 GT NearZeroN1 THEN sO2WEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDDetWEpiN1= IF sDDetWEpiN1 GT NearZeroN1 THEN sDDetWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNDetWEpiN1= IF sNDetWEpiN1 GT NearZeroN1 THEN sNDetWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPDetWEpiN1= IF sPDetWEpiN1 GT NearZeroN1 THEN sPDetWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oSiDetWEpiN1= IF sSiDetWEpiN1 GT NearZeroN1 THEN sSiDetWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDIMWEpiN1= IF sDIMWEpiN1 GT NearZeroN1 THEN sDIMWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDDiatWEpiN1= IF sDDiatWEpiN1 GT NearZeroN1 THEN sDDiatWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNDiatWEpiN1= IF sNDiatWEpiN1 GT NearZeroN1 THEN sNDiatWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPDiatWEpiN1= IF sPDiatWEpiN1 GT NearZeroN1 THEN sPDiatWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDGrenWEpiN1= IF sDGrenWEpiN1 GT NearZeroN1 THEN sDGrenWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNGrenWEpiN1= IF sNGrenWEpiN1 GT NearZeroN1 THEN sNGrenWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPGrenWEpiN1= IF sPGrenWEpiN1 GT NearZeroN1 THEN sPGrenWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDBlueWEpiN1= IF sDBlueWEpiN1 GT NearZeroN1 THEN sDBlueWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNBlueWEpiN1= IF sNBlueWEpiN1 GT NearZeroN1 THEN sNBlueWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPBlueWEpiN1= IF sPBlueWEpiN1 GT NearZeroN1 THEN sPBlueWEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oDZooEpiN1= IF sDZooEpiN1 GT NearZeroN1 THEN sDZooEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oNZooEpiN1= IF sNZooEpiN1 GT NearZeroN1 THEN sNZooEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
oPZooEpiN1= IF sPZooEpiN1 GT NearZeroN1 THEN sPZooEpiN1 / MassEpiN1 ELSE NearZeroN1 ENDIF;
aDBlueSurfN1= IF sDBlueSurfN1 GT NearZeroN1 THEN sDBlueSurfN1 ELSE NearZeroN1 ENDIF;
aNBlueSurfN1= IF sNBlueSurfN1 GT NearZeroN1 THEN sNBlueSurfN1  ELSE NearZeroN1 ENDIF;
aPBlueSurfN1= IF sPBlueSurfN1 GT NearZeroN1 THEN sPBlueSurfN1  ELSE NearZeroN1 ENDIF;
aDExtTotTN1= sDExtTotTN1;
aNExtTotTN1= sNExtTotTN1 ;
aPExtTotTN1=  sPExtTotTN1 ;
aSiExtTotTN1= sSiExtTotTN1;
aO2ExtTotTN1=sO2ExtTotTN1 ;
aDepthExtTotTN1=sDepthExtTotTN1 ;
aDDetWEpiN1= IF sDDetWEpiN1 GT NearZeroN1 THEN sDDetWEpiN1 ELSE NearZeroN1 ENDIF;
aNDetWEpiN1= IF sNDetWEpiN1 GT NearZeroN1 THEN sNDetWEpiN1  ELSE NearZeroN1 ENDIF;
aPDetWEpiN1= IF sPDetWEpiN1 GT NearZeroN1 THEN sPDetWEpiN1  ELSE NearZeroN1 ENDIF;
aSiDetWEpiN1= IF sSiDetWEpiN1 GT NearZeroN1 THEN sSiDetWEpiN1 ELSE NearZeroN1 ENDIF;
aDIMWEpiN1= IF sDIMWEpiN1 GT NearZeroN1 THEN aDIMWEpiN1  ELSE NearZeroN1 ENDIF;
aDDiatWEpiN1= IF sDDiatWEpiN1 GT NearZeroN1 THEN sDDiatWEpiN1 ELSE NearZeroN1 ENDIF;
aNDiatWEpiN1= IF sNDiatWEpiN1 GT NearZeroN1 THEN sNDiatWEpiN1  ELSE NearZeroN1 ENDIF;
aPDiatWEpiN1= IF sPDiatWEpiN1 GT NearZeroN1 THEN sPDiatWEpiN1  ELSE NearZeroN1 ENDIF;
aDGrenWEpiN1= IF sDGrenWEpiN1 GT NearZeroN1 THEN sDGrenWEpiN1 ELSE NearZeroN1 ENDIF;
aNGrenWEpiN1= IF sNGrenWEpiN1 GT NearZeroN1 THEN sNGrenWEpiN1 ELSE NearZeroN1 ENDIF;
aPGrenWEpiN1= IF sPGrenWEpiN1 GT NearZeroN1 THEN sPGrenWEpiN1 ELSE NearZeroN1 ENDIF;
aDBlueWEpiN1= IF sDBlueWEpiN1 GT NearZeroN1 THEN sDBlueWEpiN1 ELSE NearZeroN1 ENDIF;
aNBlueWEpiN1= IF sNBlueWEpiN1 GT NearZeroN1 THEN sNBlueWEpiN1  ELSE NearZeroN1 ENDIF;
aPBlueWEpiN1= IF sPBlueWEpiN1 GT NearZeroN1 THEN sPBlueWEpiN1 ELSE NearZeroN1 ENDIF;
aDBlueWHypN1= IF sDBlueWEpiN1 GT NearZeroN1 THEN sDBlueWEpiN1 ELSE NearZeroN1 ENDIF;
TimeYearsN1 = sTimeN1 / DaysPerYearN1;
DayN1 = sTimeN1 - FLOOR(TimeYearsN1) * DaysPerYearN1;
YearsN1 = YearZeroN1 + TimeYearsN1;
aVegEHeightN1 =   POW ( cVegHPar1N1*aDVegN1 , cVegHPar2N1 ) ;
uVegHeightN1 =  IF ( UseVegHeightN1 EQ FALSE AND  aVegHeightN1 LT uDepthWN1 ) THEN aVegHeightN1 ELSEIF ( UseVegHeightN1 EQ FALSE ) THEN ( uDepthWN1 ) ELSE MIN ( aVegHeightN1 , uDepthWN1 , aVegEHeightN1 ) ENDIF;
uVegHeightHypN1 = IF ( aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uVegHeightN1 GT uDepthWHypN1 ) THEN uDepthWHypN1 ELSE uVegHeightN1 ENDIF;
uVegHeightEpiN1 = IF ( aInclStratN1 EQ FALSE AND uVegHeightN1 LT uDepthWEpiN1 ) THEN uVegHeightN1 ELSEIF ( aInclStratN1 EQ FALSE AND uVegHeightN1 GE uDepthWEpiN1 ) THEN uDepthWEpiN1 ELSEIF (uVegHeightN1 GT uDepthWHypN1 ) THEN uVegHeightN1 -uDepthWHypN1 ELSE 0.0 ENDIF;
aDepth2VegHypN1 = IF ( aInclStratN1 EQ TRUE AND fDepth2VegN1 GE 1 ) THEN uDepthWHypN1  ELSEIF ( aInclStratN1 EQ TRUE AND fDepth2VegN1 LT 1 ) THEN MAX (0.0, uVegHeightN1 - uDepthWEpiN1 ) ELSE 0.0 ENDIF;
aDepth1VegHypN1 = IF ( aInclStratN1 EQ TRUE AND fDepth2VegN1 GE 1 ) THEN uDepthWHypN1 - uVegHeightHypN1  ELSE 0.0 ENDIF;
aDepth2VegEpiN1 = IF (fDepth2VegN1 GE 1 ) THEN uDepthWEpiN1 ELSE uDepthWEpiN1 - uVegHeightEpiN1 ENDIF;
aDepth1VegEpiN1 = IF (fDepth2VegN1 GE 1 ) THEN uDepthWEpiN1 - uVegHeightEpiN1  ELSE 0.0 ENDIF;
uVegHeightLightN1 = cVegLN1 *LN( 1.0 + uVegHeightN1 );
uVegHeightLightSumN1 = cVegLN1 *LN( 1.0 + MAX (uVegHeightN1, MIN (uDepthWN1, cVegHeightN1) ) );
uVegHeightLightEpiN1 = IF (  uVegHeightLightN1 GT uVegHeightEpiN1 ) THEN uVegHeightEpiN1 ELSE uVegHeightLightN1 ENDIF;
uVegHeightLightHypN1 =  uVegHeightLightN1 - uVegHeightLightEpiN1  ;
uDVegHypN1 = uVegHeightHypN1 / uVegHeightN1 * aDVegN1;
uDVegEpiN1 = uVegHeightEpiN1 / uVegHeightN1 * aDVegN1;
uVegShadeN1 = IF ( ReadVegShadeN1  EQ  TRUE) THEN mVegShadeN1 ELSE fVegShadeN1 ENDIF;
aExtPhytHypN1 = cExtSpDiatN1 * oDDiatWHypN1 + cExtSpGrenN1 * oDGrenWHypN1 + cExtSpBlueN1 * oDBlueWHypN1;
aExtDetHypN1 = cExtSpDetN1 * oDDetWHypN1;
aExtIMHypN1 = cExtSpIMN1 * oDIMWHypN1;
aExtCoefOpenHypN1 = cExtWatN1 + aExtIMHypN1 + aExtDetHypN1 + aExtPhytHypN1;
aExtPhytEpiN1 = cExtSpDiatN1 * oDDiatWEpiN1 + cExtSpGrenN1 * oDGrenWEpiN1 + cExtSpBlueN1 * oDBlueWEpiN1;
aExtDetEpiN1 = cExtSpDetN1 * oDDetWEpiN1;
aExtIMEpiN1 = cExtSpIMN1 * oDIMWEpiN1;
aExtCoefOpenEpiN1 = cExtWatN1 + aExtIMEpiN1 + aExtDetEpiN1 + aExtPhytEpiN1;
aExtSurfN1 = cExtSpBlueN1 * aDBlueSurfN1;
aTmEpiN1 =  cTmAveEpiN1 - cTmVarEpiN1 * COS(2.0*PiN1*(sTimeN1 + TenDaysN1 - cTimeLagN1) / DaysInYearN1) ;
aTmHypN1 =  cTmAveHypN1 - cTmVarHypN1 * COS(2.0*PiN1*(sTimeN1 + TenDaysN1 - cTimeLagN1) / DaysInYearN1) ;
uTmEpiN1 = IF (FALSE EQ InclSeasonN1) THEN cTmAveEpiN1 ELSEIF (ReadTempN1 EQ TRUE) THEN mTempEpiN1 ELSEIF ( aTmEpiN1 GT 0.0  ) THEN aTmEpiN1 ELSE  0.0 ENDIF;
uTmHypN1 = IF (FALSE EQ InclSeasonN1) THEN cTmAveHypN1 ELSEIF (ReadTempN1 EQ TRUE) THEN mTempHypN1 ELSEIF ( aTmHypN1 GT 0.0  ) THEN aTmHypN1 ELSE  0.0 ENDIF;
uTmBotN1 = IF (aInclStratN1 EQ TRUE ) THEN uTmHypN1 ELSE uTmEpiN1 ENDIF;
uTmSurfN1 = uTmEpiN1;
uLATN1= cLATN1*2*PiN1/360;
uSolDecAngN1= IF(InclLatN1 EQ TRUE) THEN cPhiRN1*COS(2*PiN1*(DayN1-cDayRN1)/DaysInYearN1) ELSE 0.0 ENDIF;
uSunRiseN1 = HoursInDayN1/(2*PiN1)*ACOS((SIN(uLATN1)* SIN(uSolDecAngN1))/(COS(uLATN1)*COS(uSolDecAngN1))) ;
uSunSetN1=HoursInDayN1-uSunRiseN1;
uSunHoursN1=uSunSetN1-uSunRiseN1;
uSunPathN1= IF(InclLatN1 EQ TRUE) THEN SIN(uLATN1)*SIN( uSolDecAngN1 )*( uSunSetN1-uSunRiseN1)- COS(uLATN1) * COS (uSolDecAngN1) * HoursInDayN1 / (2*PiN1) * ( SIN (2*PiN1*uSunSetN1/HoursInDayN1 ) -SIN(2*PiN1*uSunRiseN1 /HoursInDayN1 )) ELSE 0.0 ENDIF;
uTransN1=IF((InclLatN1 EQ TRUE) AND (ConstTransN1 EQ FALSE)) THEN (0.6-0.2*(uSunPathN1/(uSunSetN1 - uSunRiseN1)))*(1-0.4*fCloudHN1) *(1-0.7* fCloudMN1) *(1-0.4*fCloudLN1)ELSEIF ((InclLatN1 EQ TRUE) AND (ConstTransN1 EQ TRUE)) THEN cTransN1 ELSE 0.0 ENDIF;
ufDayN1 = IF (FALSE EQ InclSeasonN1) THEN cfDayAveN1 ELSEIF (InclLatN1 EQ TRUE) THEN (uSunSetN1 -uSunRiseN1 )/ HoursInDayN1 ELSE cfDayAveN1 - cfDayVarN1 * COS( 2.0 *PiN1*(sTimeN1+TenDaysN1) / DaysInYearN1) ENDIF;
uLDayN1 = IF (FALSE EQ InclSeasonN1) THEN cLDayAveN1 ELSEIF (ReadLOutN1 EQ TRUE) THEN 0.0 ELSEIF (InclLatN1 EQ TRUE) THEN cSolarN1*uTransN1*uSunPathN1 * SecsPerDayN1 /HoursInDayN1 ELSE cLDayAveN1 - cLDayVarN1 * COS(2.0*PiN1*(sTimeN1+TenDaysN1) / DaysInYearN1) ENDIF;
uLOutN1 = IF (FALSE EQ InclSeasonN1) THEN uLDayN1 / SecsPerDayN1 / ufDayN1 ELSEIF (ReadLOutN1 EQ TRUE) THEN mLOutN1 / ufDayN1 ELSE uLDayN1 / SecsPerDayN1 / ufDayN1 ENDIF;
uLPARSurfN1 = fPARN1 * (1.0 - fReflN1) * uLOutN1;
aLPARBotSurfN1 = IF (InclSurfN1 EQ TRUE) THEN uLPARSurfN1 * EXP(- aExtSurfN1) ELSE uLPARSurfN1 ENDIF;
aLPARBotEpiOpenN1 = aLPARBotSurfN1 * EXP(- aExtCoefOpenEpiN1 * uDepthWEpiN1);
aLPARBotHypOpenN1 = aLPARBotEpiOpenN1 * EXP(- aExtCoefOpenHypN1 * uDepthWHypN1);
aLPAR1VegEpiN1 = aLPARBotSurfN1 * EXP(- aExtCoefOpenEpiN1 * aDepth1VegEpiN1) * ( 1 - uVegShadeN1 );
aLPAR1VegHypN1 = aLPAR1VegEpiN1 * EXP(- aExtCoefOpenHypN1 * aDepth1VegHypN1);
aLPARVegLightN1 =  IF  ( aInclStratN1 EQ TRUE AND  uVegHeightN1 LE uDepthWHypN1 ) THEN aLPAR1VegHypN1 *   EXP(- aExtCoefOpenHypN1 * uVegHeightLightEpiN1) ELSE aLPAR1VegEpiN1 *  EXP(- aExtCoefOpenEpiN1 * uVegHeightLightEpiN1)  *  EXP(- aExtCoefOpenHypN1 * uVegHeightLightEpiN1) ENDIF;
uTmVegAveN1 = ( uVegHeightHypN1 * uTmHypN1 + uVegHeightEpiN1 * uTmEpiN1 ) / uVegHeightN1;
uFunTmVegN1 = EXP(-0.5/(cSigTmVegN1*cSigTmVegN1) *((uTmVegAveN1-cTmOptVegN1)*(uTmVegAveN1-cTmOptVegN1) - (cTmRefN1-cTmOptVegN1)*(cTmRefN1-cTmOptVegN1)));
uFunTmProdVegN1 = IF ( UseExpVegN1 EQ TRUE ) THEN uFunTmVegN1 ELSE POW ( cQ10ProdVegN1 , (0.1 * (uTmVegAveN1 - cTmRefN1))) ENDIF;
uhLVegN1 = hLRefVegN1 * uFunTmProdVegN1;
aLPIVegN1 = IF ( aInclStratN1 EQ TRUE AND  uVegHeightN1 GT uDepthWHypN1 ) THEN cPMaxN1*(aLPAR1VegEpiN1- aLPARVegLightN1 + uhLVegN1*LN((1.0 +aLPARVegLightN1/ uhLVegN1)  /(1.0 +aLPAR1VegEpiN1  / uhLVegN1) + NearZeroN1  ) )ELSEIF  ( aInclStratN1 EQ TRUE AND  uVegHeightN1 LE uDepthWHypN1 ) THEN cPMaxN1*( aLPAR1VegHypN1- aLPARVegLightN1 + uhLVegN1* LN((1.0 +aLPARVegLightN1/ uhLVegN1)  / (1.0 +aLPAR1VegHypN1  / uhLVegN1) ) ) ELSE cPMaxN1 * (aLPAR1VegEpiN1- aLPARVegLightN1 + uhLVegN1*LN((1.0 +aLPARVegLightN1/ uhLVegN1)  /(1.0 +aLPAR1VegEpiN1  / uhLVegN1) + NearZeroN1  ) )ENDIF;
aSpringN1 =  IF ( cLATN1 LT 0 AND DayN1 GE 265 AND DayN1 LE 356 ) THEN 1 ELSEIF ( cLATN1 GT 0 AND DayN1 GE 80 AND DayN1 LE 173) THEN 1 ELSEIF ( cLATN1 EQ 0) THEN 1 ELSE 0 ENDIF;
aTimeWinVegN1 =  IF ( sTimeN1 LT StartTimeN1 + 1.0 ) THEN -999 ELSEIF ( UsePhotVegN1 EQ FALSE  AND  ( uTmBotN1 GE cTmInitVegN1 )  AND aSpringN1 EQ 1 ) THEN sTimeN1  ELSEIF (UsePhotVegN1 EQ TRUE  AND  uSunHoursN1 GE cPhotInitVegN1   AND aSpringN1 EQ 1 ) THEN sTimeN1 ELSEIF (( aLPIVegN1 / uVegHeightLightN1 )LE cLAlloVegN1 ) THEN aTimeWinVegN1 ELSEIF (FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeWinVegN1 + 0.3) GT 1 AND FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeWinVegN1 + 0.3) LT cVegWinLenN1 ) THEN aTimeWinVegN1 ELSE sTimeN1 ENDIF ;
aTimeInitVegN1 =  IF ( sTimeN1 LT StartTimeN1 + 1.0 ) THEN -999 ELSEIF ( FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeWinVegN1 + 0.3) GT 1 ) THEN sTimeN1 ELSEIF ( UsePhotVegN1 EQ FALSE  AND  uTmBotN1 GE cTmInitVegN1 ) THEN aTimeInitVegN1 ELSEIF ( UsePhotVegN1 EQ TRUE  AND    uSunHoursN1 GE cPhotInitVegN1  ) THEN aTimeInitVegN1 ELSEIF (UsePhotVegN1 EQ FALSE  AND  uTmBotN1 LT cTmInitVegN1 AND ( ( aLPIVegN1 / uVegHeightLightN1 ) GE cLAlloVegN1 ) AND FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeInitVegN1 + 0.3) GT 1) THEN aTimeInitVegN1 ELSEIF (UsePhotVegN1 EQ TRUE  AND   uSunHoursN1 LT cPhotInitVegN1 AND ( ( aLPIVegN1 / uVegHeightLightN1 ) GE cLAlloVegN1 ) AND FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeInitVegN1 + 0.3) GT 1) THEN aTimeInitVegN1 ELSEIF (FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeInitVegN1 + 0.3) GT 1 AND FLOOR ( sTimeN1+ 0.3 ) - FLOOR (aTimeInitVegN1 + 0.3) LT cVegInitLenN1 ) THEN aTimeInitVegN1 ELSE sTimeN1 ENDIF ;
aTimeWinVegCorN1 = IF ( UseLWinVegN1 LE NearZeroN1 ) THEN FLOOR (TimeYearsN1 - 1) + cDayWinVegN1  ELSE aTimeWinVegN1 ENDIF;
aDayInitVegN1 = IF (DayN1 LT 1.0 OR sTimeN1 LT StartTimeN1 + 1.0) THEN 367 ELSEIF (uTmBotN1 GE cTmInitVegN1 AND aDayInitVegN1 GT 366) THEN DayN1 ELSE aDayInitVegN1 ENDIF;
aTimeInitVegCorN1 = IF (UsePhotVegN1 LE NearZeroN1 AND UseLWinVegN1 LE NearZeroN1 ) THEN  (TimeYearsN1 - 1)  + aDayInitVegN1  ELSE aTimeInitVegN1 ENDIF;
aVegSumN1 =  IF ( FLOOR ( aTimeInitVegCorN1 + 0.3) LT FLOOR (  sTimeN1 + 0.3 ) AND FLOOR ( aTimeWinVegCorN1 + 0.3 ) EQ FLOOR (  sTimeN1  + 0.3 ) ) THEN 1 ELSE 0 ENDIF;
aVegWinN1 =  1 - aVegSumN1;
aDaysVegSumN1 = ( FLOOR ( sTimeN1+ 0.3) - FLOOR (aTimeInitVegCorN1 + 0.3) ) * aVegSumN1;
aDaysVegWinN1 = ( FLOOR ( sTimeN1 + 0.3) - FLOOR ( aTimeWinVegCorN1  + 0.3 )  ) * aVegWinN1;
bfRootVegN1 = IF (FALSE EQ InclSeasonN1) THEN fRootVegSumN1 ELSEIF (aVegWinN1 EQ TRUE AND aDaysVegWinN1 GT cLengAlloN1) THEN fRootVegWinN1 ELSEIF (aVegSumN1 EQ TRUE AND aDaysVegSumN1 LE cLengAlloN1) THEN 0.5*(fRootVegWinN1 + fRootVegSumN1) + 0.5*(fRootVegWinN1 - fRootVegSumN1) * COS ( PiN1 /cLengAlloN1 * ( sTimeN1 - aTimeInitVegCorN1 )) ELSEIF ( aVegWinN1 EQ TRUE AND aDaysVegWinN1 EQ 0) THEN fRootVegWinN1 ELSEIF ( aVegWinN1 EQ TRUE) THEN 0.5*( fRootVegWinN1 + fRootVegSumN1) - 0.5*( fRootVegWinN1 - fRootVegSumN1) * COS ( PiN1 / cLengAlloN1 * ( sTimeN1 - aTimeWinVegCorN1 )) ELSE fRootVegSumN1 ENDIF;
bfShootVegN1 = 1.0 - bfRootVegN1;
aDShootVegN1 = bfShootVegN1 * aDVegN1;
aDEmergVegN1 = fEmergVegN1 * aDShootVegN1;
aDFloatVegN1 = IF  ( aDepth1VegEpiN1 LT 0.005 ) THEN fFloatVegN1 * aDShootVegN1 ELSE 0 ENDIF;
bfSubVegN1 = 1.0 - fFloatVegN1 - fEmergVegN1;
aDSubVegN1 = bfSubVegN1 * aDShootVegN1;
aExtVegHypN1 = cExtSpVegN1 * aDSubVegN1 / uDepthWHypN1 * (uVegHeightHypN1 /uDepthWN1 );
aExtCoefHypN1 = aExtCoefOpenHypN1 + aExtVegHypN1;
aExtVegEpiN1 = cExtSpVegN1 * aDSubVegN1 / uDepthWEpiN1 * (uVegHeightEpiN1 /uDepthWN1 ) ;
aExtCoefEpiN1 = aExtCoefOpenEpiN1 + aExtVegEpiN1;
aLPARBotEpiN1 = aLPARBotSurfN1 * EXP(- aExtCoefEpiN1 * uDepthWEpiN1);
uLPARSurfHypN1 = IF ( aInclStratN1 EQ TRUE ) THEN aLPARBotEpiN1 ELSE 0.0 ENDIF;
aLPAR2VegEpiN1 = aLPAR1VegEpiN1 * EXP(- aExtCoefEpiN1 * (aDepth2VegEpiN1 - aDepth1VegEpiN1));
aLPAR2VegHypN1 = aLPAR1VegHypN1 * EXP(- aExtCoefHypN1 * (aDepth2VegHypN1 - aDepth1VegHypN1));
uVWindN1 = IF (ReadVWindN1 EQ TRUE)THEN mVWindN1 ELSE cVWindN1 ENDIF;
aStratN1 = IF (ReadStratN1 EQ TRUE) THEN mStratN1 ELSEIF ((uTmEpiN1 -uTmHypN1) GT  cStratTmN1 OR (uTmHypN1 -uTmEpiN1) GT  cStratTmN1) THEN 1.0  ELSE 0.0 ENDIF;
uQInSeasonN1 = IF (FALSE EQ UseSeasonLoadN1) THEN 0.0 ELSEIF (DayN1 LT cDayApril1N1 - 0.5*cLengChangeN1) THEN cQInWinN1 ELSEIF (DayN1 LT cDayApril1N1 + 0.5*cLengChangeN1) THEN 0.5*(cQInWinN1 + cQInSumN1) + 0.5*(cQInWinN1 - cQInSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayApril1N1)) ELSEIF (DayN1 LT cDayOct1N1 - 0.5*cLengChangeN1) THEN cQInSumN1 ELSEIF (DayN1 LT cDayOct1N1 + 0.5*cLengChangeN1) THEN 0.5*(cQInWinN1 + cQInSumN1) - 0.5*(cQInWinN1 - cQInSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayOct1N1)) ELSE cQInWinN1 ENDIF;
uQEvSinusN1 = cQEvAveN1 - cQEvVarN1 * COS(2.0*PiN1 * (sTimeN1 + TenDaysN1 - cTimeLagN1) / DaysInYearN1);
aQEvN1 = IF (10 *uTmEpiN1 /cHeatN1) LE NearZeroN1 THEN 16 * 2*ufDayN1 * 1 / 30 * POW ( NearZeroN1 , (cAlphaN1) ) ELSE 16 * 2*ufDayN1 * 1 / 30 * POW ( 10 *uTmEpiN1 /cHeatN1 , (cAlphaN1) ) ENDIF;
uQEvN1 = IF (FALSE EQ InclSeasonN1) THEN cQEvAveN1 ELSEIF (ReadQEvN1 EQ TRUE) THEN mQEvN1 ELSEIF (calcQEvN1 EQ TRUE ) THEN aQEvN1 ELSE uQEvSinusN1 ENDIF;
uDepthDifMeasN1 = IF ( ReadDepthWN1 EQ TRUE ) THEN mDepthWN1 - uDepthWN1 ELSE 0.0 ENDIF;
uQInCorN1 = IF (uDepthDifMeasN1 GE 0) THEN uDepthDifMeasN1 * cMaxWOutN1 * mmPermN1 ELSE 0.0 ENDIF;
uQOutCorN1 = IF (uDepthDifMeasN1 LT 0) THEN -1 * uDepthDifMeasN1 * cMaxWOutN1 * mmPermN1 ELSE 0.0 ENDIF;
uQInEpiN1 = IF ((ReadQInN1 EQ TRUE) OR (ReadTranFracN1 EQ TRUE)) THEN mQInEpiN1 + uQInCorN1 ELSEIF (UseSeasonLoadN1 EQ TRUE) THEN uQInSeasonN1 + uQInCorN1 ELSE cQInEpiN1 + uQInCorN1 ENDIF;
uQInHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF ((ReadQInN1 EQ TRUE) OR (ReadTranFracN1 EQ TRUE)) THEN mQInHypN1 ELSE 0.0 ENDIF;
aQInTotN1 = uQInEpiN1 + uQInHypN1;
uQPrecN1 = IF (ReadQPrecN1 EQ TRUE) THEN mQPrecN1 ELSE 0 ENDIF;
uQInSeepN1 = IF (ReadQGroundN1 EQ TRUE) THEN mQInSeepN1 ELSE cQInSeepN1 ENDIF;
uQOutInfN1 = IF (ReadQGroundN1 EQ TRUE) THEN mQOutInfN1 ELSE cQOutInfN1 ENDIF;
uQOutPotN1 = uQPrecN1 + uQInEpiN1 - uQInCorN1 + uQInHypN1 + uQInSeepN1 - uQEvN1 - uQOutCorN1 - uQOutInfN1;
aMaxQOutEpiN1 = IF ( uDepthWEpiN1 LE cMinDepthHypEpiN1 ) THEN 0.0 ELSE uDepthWEpiN1 * mmPermN1 * cMaxWOutN1 ENDIF;
aMaxQOutHypN1 = IF (aInclStratN1 EQ TRUE) AND ( uDepthWHypN1 GT cMinDepthHypEpiN1 ) THEN (uDepthWHypN1 - cMinDepthHypEpiN1) * mmPermN1 * cMaxWOutN1 ELSE 0.0 ENDIF;
uQOutEpiN1 = IF (ReadQOutN1 EQ TRUE) THEN MIN(mQOutEpiN1, aMaxQOutEpiN1) ELSE MIN(aMaxQOutEpiN1, MAX(0.0, uQOutPotN1)) ENDIF;
uQOutHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadQOutN1 EQ TRUE) THEN MIN(mQOutHypN1, aMaxQOutHypN1) ELSE MIN(aMaxQOutHypN1, MAX(0.0, (uQOutPotN1 - uQOutEpiN1))) ENDIF;
ukOutEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uQOutEpiN1 / mmPermN1 / uDepthWEpiN1 ENDIF;
ukOutHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uQOutHypN1 / mmPermN1 / uDepthWHypN1 ENDIF;
uTauWatEpiN1 = IF (aInclStratN1 EQ FALSE) THEN 1.0 / ((uQInEpiN1 + uQPrecN1 + uQInSeepN1) / mmPermN1 / uDepthWEpiN1 +NearZeroN1) ELSE 1.0 / (( uQInEpiN1 + uQPrecN1 ) / mmPermN1 / uDepthWEpiN1 +NearZeroN1) ENDIF;
uTauWatHypN1 = IF (aInclStratN1 EQ FALSE )THEN -9999 ELSE 1.0 / ((uQInHypN1 + uQInSeepN1 ) / mmPermN1 / uDepthWHypN1 +NearZeroN1) ENDIF;
uTauWatN1 = 1.0 / ((uQPrecN1 + uQInEpiN1 + uQInHypN1 + uQInSeepN1 ) / mmPermN1 / uDepthWN1 +NearZeroN1);
uTauSubstHypN1 = 1.0 / (ukOutHypN1+NearZeroN1);
uFiJvMortHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiJvMortHypN1 ELSE 0.0 ENDIF;
uFiJvEgesHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiJvEgesHypN1 ELSE 0.0 ENDIF;
uFiJvExcrHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiJvExcrHypN1 ELSE 0.0 ENDIF;
uFiAdMortHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiAdMortHypN1 ELSE 0.0 ENDIF;
uFiAdEgesHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiAdEgesHypN1 ELSE 0.0 ENDIF;
uFiAdExcrHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fFiAdExcrHypN1 ELSE 0.0 ENDIF;
uPiscMortHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fPiscMortHypN1 ELSE 0.0 ENDIF;
uPiscEgesHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fPiscEgesHypN1 ELSE 0.0 ENDIF;
uPiscExcrHypN1 = IF (aInclStratN1 EQ TRUE ) THEN fPiscExcrHypN1 ELSE 0.0 ENDIF;
vTranDepthWN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN (uQInEpiN1 + uQInHypN1 + uQPrecN1 + uQInSeepN1 - uQEvN1 - uQOutInfN1 - uQOutHypN1 - uQOutEpiN1 - uQOutCorN1) / mmPermN1 ELSE ((uQInEpiN1 + uQInHypN1 + uQPrecN1 + uQInSeepN1 - uQEvN1 - uQOutInfN1 - uQOutHypN1 - uQOutEpiN1 - uQOutCorN1) / mmPermN1) / (1.0 + fMarshN1) ENDIF;
vTranHypEpiWN1 = IF (InclStratN1 EQ FALSE) THEN 0.0 ELSEIF ( uDepthWN1 -uDepthMixMeasN1 LT cMinDepthHypEpiN1 ) THEN ( uDepthWN1 - cMinDepthHypEpiN1 -uDepthWEpiN1 ) * kExchWN1 ELSEIF ( uDepthMixMeasN1 LT cMinDepthHypEpiN1 ) THEN ( cMinDepthHypEpiN1 -uDepthWEpiN1 ) * kExchWN1 ELSE ( uDepthMixMeasN1 -uDepthWEpiN1 ) * kExchWN1 ENDIF;
vDeltaWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1 ) THEN (uQInHypN1 + uQInSeepN1 - uQOutInfN1 - uQOutHypN1) / mmPermN1 ELSE (uQInHypN1 + uQInSeepN1 - uQOutInfN1 - uQOutHypN1) / mmPermN1 / (1.0 + fMarshN1 ) ENDIF;
vDeltaWEpiN1 = IF (aInclStratN1 EQ FALSE) AND (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1 ) THEN (uQInEpiN1 + uQPrecN1 + uQInSeepN1 - uQEvN1 - uQOutEpiN1 - uQOutInfN1 - uQOutCorN1) / mmPermN1 ELSEIF (aInclStratN1 EQ TRUE) AND (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1 ) THEN (uQInEpiN1 + uQPrecN1 - uQEvN1 - uQOutEpiN1 - uQOutCorN1) / mmPermN1 ELSEIF (aInclStratN1 EQ FALSE) AND (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1 ) THEN (uQInEpiN1 + uQPrecN1 + uQInSeepN1 - uQEvN1 - uQOutEpiN1 - uQOutInfN1 - uQOutCorN1) / mmPermN1 / (1.0 + fMarshN1 ) ELSE (uQInEpiN1 + uQPrecN1 - uQEvN1 - uQOutEpiN1 - uQOutCorN1) / mmPermN1 / (1.0 + fMarshN1 ) ENDIF;
afVolHypEpiN1= IF (aInclStratN1 EQ TRUE AND uDepthWHypN1 GT NearZeroN1) THEN  uDepthWHypN1 / uDepthWEpiN1 ELSE 0.0 ENDIF;
wDAdvIMWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDIMWHypN1 ELSE vTranHypEpiWN1 * oDIMWEpiN1 ENDIF;
wPAdvPO4WN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPO4WHypN1 ELSE vTranHypEpiWN1 * oPO4WEpiN1 ENDIF;
wPAdvAIMWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPAIMWHypN1 ELSE vTranHypEpiWN1 * oPAIMWEpiN1 ENDIF;
wNAdvNH4WN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNH4WHypN1 ELSE vTranHypEpiWN1 * oNH4WEpiN1 ENDIF;
wNAdvNO3WN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNO3WHypN1 ELSE vTranHypEpiWN1 * oNO3WEpiN1 ENDIF;
wSiAdvSiO2WN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oSiO2WHypN1 ELSE vTranHypEpiWN1 * oSiO2WEpiN1 ENDIF;
wO2AdvWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oO2WHypN1 ELSE vTranHypEpiWN1 * oO2WEpiN1 ENDIF;
wDAdvDetWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDDetWHypN1 ELSE vTranHypEpiWN1 * oDDetWEpiN1 ENDIF;
wPAdvDetWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPDetWHypN1 ELSE vTranHypEpiWN1 * oPDetWEpiN1 ENDIF;
wNAdvDetWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNDetWHypN1 ELSE vTranHypEpiWN1 * oNDetWEpiN1 ENDIF;
wSiAdvDetWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oSiDetWHypN1 ELSE vTranHypEpiWN1 * oSiDetWEpiN1 ENDIF;
wDAdvDiatWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDDiatWHypN1 ELSE vTranHypEpiWN1 * oDDiatWEpiN1 ENDIF;
wPAdvDiatWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPDiatWHypN1 ELSE vTranHypEpiWN1 * oPDiatWEpiN1 ENDIF;
wNAdvDiatWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNDiatWHypN1 ELSE vTranHypEpiWN1 * oNDiatWEpiN1 ENDIF;
wSiAdvDiatWN1 = vTranHypEpiWN1 * cSiDDiatN1;
wDAdvGrenWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDGrenWHypN1 ELSE vTranHypEpiWN1 * oDGrenWEpiN1 ENDIF;
wPAdvGrenWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPGrenWHypN1 ELSE vTranHypEpiWN1 * oPGrenWEpiN1 ENDIF;
wNAdvGrenWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNGrenWHypN1 ELSE vTranHypEpiWN1 * oNGrenWEpiN1 ENDIF;
wDAdvBlueWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDBlueWHypN1 ELSE vTranHypEpiWN1 * oDBlueWEpiN1 ENDIF;
wPAdvBlueWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPBlueWHypN1 ELSE vTranHypEpiWN1 * oPBlueWEpiN1 ENDIF;
wNAdvBlueWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNBlueWHypN1 ELSE vTranHypEpiWN1 * oNBlueWEpiN1 ENDIF;
wDAdvZooWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oDZooHypN1 ELSE vTranHypEpiWN1 * oDZooEpiN1 ENDIF;
wPAdvZooWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oPZooHypN1 ELSE vTranHypEpiWN1 * oPZooEpiN1 ENDIF;
wNAdvZooWN1 = IF ( vTranHypEpiWN1 GT 0.0) THEN vTranHypEpiWN1 * oNZooHypN1 ELSE vTranHypEpiWN1 * oNZooEpiN1 ENDIF;
wDAdvIMWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDIMWEpiN1 ELSE vTranDepthWN1 *  oDIMWMN1 ENDIF;
wPAdvPO4WMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPO4WEpiN1 ELSE vTranDepthWN1 *  oPO4WMN1 ENDIF;
wPAdvAIMWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPAIMWEpiN1 ELSE vTranDepthWN1 *  oPAIMWMN1 ENDIF;
wNAdvNH4WMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNH4WEpiN1 ELSE vTranDepthWN1 *  oNH4WMN1 ENDIF;
wNAdvNO3WMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNO3WEpiN1 ELSE vTranDepthWN1 *  oNO3WMN1 ENDIF;
wSiAdvSiO2WMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oSiO2WEpiN1 ELSE vTranDepthWN1 *  oSiO2WMN1 ENDIF;
wO2AdvWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oO2WEpiN1 ELSE vTranDepthWN1 *  oO2WMN1 ENDIF;
wDAdvDetWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDDetWEpiN1 ELSE vTranDepthWN1 *  oDDetWMN1 ENDIF;
wPAdvDetWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPDetWEpiN1 ELSE vTranDepthWN1 *  oPDetWMN1 ENDIF;
wNAdvDetWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNDetWEpiN1 ELSE vTranDepthWN1 *  oNDetWMN1 ENDIF;
wSiAdvDetWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oSiDetWEpiN1 ELSE vTranDepthWN1 *  oSiDetWMN1 ENDIF;
wDAdvDiatWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDDiatWEpiN1 ELSE vTranDepthWN1 *  oDDiatWMN1 ENDIF;
wPAdvDiatWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPDiatWEpiN1 ELSE vTranDepthWN1 *  oPDiatWMN1 ENDIF;
wNAdvDiatWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNDiatWEpiN1 ELSE vTranDepthWN1 *  oNDiatWMN1 ENDIF;
wDAdvGrenWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDGrenWEpiN1 ELSE vTranDepthWN1 *  oDGrenWMN1 ENDIF;
wPAdvGrenWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPGrenWEpiN1 ELSE vTranDepthWN1 *  oPGrenWMN1 ENDIF;
wNAdvGrenWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNGrenWEpiN1 ELSE vTranDepthWN1 *  oNGrenWMN1 ENDIF;
wDAdvBlueWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDBlueWEpiN1 ELSE vTranDepthWN1 *  oDBlueWMN1 ENDIF;
wPAdvBlueWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPBlueWEpiN1 ELSE vTranDepthWN1 *  oPBlueWMN1 ENDIF;
wNAdvBlueWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNBlueWEpiN1 ELSE vTranDepthWN1 *  oNBlueWMN1 ENDIF;
wDAdvZooWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oDZooEpiN1 ELSE vTranDepthWN1 *  oDZooMN1 ENDIF;
wPAdvZooWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oPZooEpiN1 ELSE vTranDepthWN1 *  oPZooMN1 ENDIF;
wNAdvZooWMN1= IF (InclMarshN1 EQ FALSE OR fMarshN1 LT NearZeroN1) THEN 0.0 ELSEIF ( vTranDepthWN1 GT 0.0) THEN vTranDepthWN1 * oNZooEpiN1 ELSE vTranDepthWN1 *  oNZooMN1 ENDIF;
uExchMaxWN1 =   IF ( aInclStratN1 EQ TRUE) THEN kExchMaxWN1 /( aStratN1* fMetaN1 * uDepthWN1 + cDepthMetaMinN1 ) ELSE 0.0 ENDIF;
akExchWHypN1= IF (aInclStratN1 EQ TRUE AND uDepthWHypN1 GT NearZeroN1) THEN  ( uExchMaxWN1 ) / uDepthWHypN1 ELSE 0.0 ENDIF;
akExchWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 * afVolHypEpiN1 ELSE 0.0 ENDIF;
wDExchIMWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDIMWHypN1 - oDIMWEpiN1) ELSE 0.0 ENDIF;
wPExchPO4WHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPO4WHypN1 - oPO4WEpiN1) ELSE 0.0 ENDIF;
wPExchAIMWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPAIMWHypN1 - oPAIMWEpiN1) ELSE 0.0 ENDIF;
wNExchNH4WHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNH4WHypN1 - oNH4WEpiN1) ELSE 0.0 ENDIF;
wNExchNO3WHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNO3WHypN1 - oNO3WEpiN1) ELSE 0.0 ENDIF;
wSiExchSiO2WHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oSiO2WHypN1 - oSiO2WEpiN1) ELSE 0.0 ENDIF;
wO2ExchWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oO2WHypN1 - oO2WEpiN1) ELSE 0.0 ENDIF;
wDExchDetWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDDetWHypN1 - oDDetWEpiN1) ELSE 0.0 ENDIF;
wPExchDetWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPDetWHypN1 - oPDetWEpiN1) ELSE 0.0 ENDIF;
wNExchDetWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNDetWHypN1 - oNDetWEpiN1) ELSE 0.0 ENDIF;
wSiExchDetWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oSiDetWHypN1 - oSiDetWEpiN1) ELSE 0.0 ENDIF;
wDExchDiatWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDDiatWHypN1 - oDDiatWEpiN1) ELSE 0.0 ENDIF;
wPExchDiatWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPDiatWHypN1 - oPDiatWEpiN1) ELSE 0.0 ENDIF;
wNExchDiatWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNDiatWHypN1 - oNDiatWEpiN1) ELSE 0.0 ENDIF;
wSiExchDiatWHypN1= IF (aInclStratN1 EQ TRUE ) THEN cSiDDiatN1 * wDExchDiatWHypN1 ELSE 0.0 ENDIF;
wDExchGrenWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDGrenWHypN1 - oDGrenWEpiN1) ELSE 0.0 ENDIF;
wPExchGrenWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPGrenWHypN1 - oPGrenWEpiN1) ELSE 0.0 ENDIF;
wNExchGrenWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNGrenWHypN1 - oNGrenWEpiN1) ELSE 0.0 ENDIF;
wDExchBlueWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDBlueWHypN1 - oDBlueWEpiN1) ELSE 0.0 ENDIF;
wPExchBlueWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPBlueWHypN1 - oPBlueWEpiN1) ELSE 0.0 ENDIF;
wNExchBlueWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNBlueWHypN1 - oNBlueWEpiN1) ELSE 0.0 ENDIF;
wDExchZooWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oDZooHypN1 - oDZooEpiN1) ELSE 0.0 ENDIF;
wPExchZooWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oPZooHypN1 - oPZooEpiN1) ELSE 0.0 ENDIF;
wNExchZooWHypN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWHypN1 *(oNZooHypN1 - oNZooEpiN1) ELSE 0.0 ENDIF;
wDExchIMWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDIMWHypN1 - oDIMWEpiN1) ELSE 0.0 ENDIF;
wPExchPO4WEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPO4WHypN1 - oPO4WEpiN1) ELSE 0.0 ENDIF;
wPExchAIMWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPAIMWHypN1 - oPAIMWEpiN1) ELSE 0.0 ENDIF;
wNExchNH4WEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNH4WHypN1 - oNH4WEpiN1) ELSE 0.0 ENDIF;
wNExchNO3WEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNO3WHypN1 - oNO3WEpiN1) ELSE 0.0 ENDIF;
wSiExchSiO2WEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oSiO2WHypN1 - oSiO2WEpiN1) ELSE 0.0 ENDIF;
wO2ExchWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oO2WHypN1 - oO2WEpiN1) ELSE 0.0 ENDIF;
wDExchDetWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDDetWHypN1 - oDDetWEpiN1) ELSE 0.0 ENDIF;
wPExchDetWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPDetWHypN1 - oPDetWEpiN1) ELSE 0.0 ENDIF;
wNExchDetWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNDetWHypN1 - oNDetWEpiN1) ELSE 0.0 ENDIF;
wSiExchDetWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oSiDetWHypN1 - oSiDetWEpiN1) ELSE 0.0 ENDIF;
wDExchDiatWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDDiatWHypN1 - oDDiatWEpiN1) ELSE 0.0 ENDIF;
wPExchDiatWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPDiatWHypN1 - oPDiatWEpiN1) ELSE 0.0 ENDIF;
wNExchDiatWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNDiatWHypN1 - oNDiatWEpiN1) ELSE 0.0 ENDIF;
wSiExchDiatWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN cSiDDiatN1 * wDExchDiatWEpiN1 ELSE 0.0 ENDIF;
wDExchGrenWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDGrenWHypN1 - oDGrenWEpiN1) ELSE 0.0 ENDIF;
wPExchGrenWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPGrenWHypN1 - oPGrenWEpiN1) ELSE 0.0 ENDIF;
wNExchGrenWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNGrenWHypN1 - oNGrenWEpiN1) ELSE 0.0 ENDIF;
wDExchBlueWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDBlueWHypN1 - oDBlueWEpiN1) ELSE 0.0 ENDIF;
wPExchBlueWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPBlueWHypN1 - oPBlueWEpiN1) ELSE 0.0 ENDIF;
wNExchBlueWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNBlueWHypN1 - oNBlueWEpiN1) ELSE 0.0 ENDIF;
wDExchZooWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oDZooHypN1 - oDZooEpiN1) ELSE 0.0 ENDIF;
wPExchZooWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oPZooHypN1 - oPZooEpiN1) ELSE 0.0 ENDIF;
wNExchZooWEpiN1= IF (aInclStratN1 EQ TRUE ) THEN akExchWEpiN1 *(oNZooHypN1 - oNZooEpiN1) ELSE 0.0 ENDIF;
akExchMHypN1 = 0.0;
akExchLHypN1 = 0.0;
oDPhytWHypN1 = oDDiatWHypN1 + oDGrenWHypN1 + oDBlueWHypN1;
oPPhytWHypN1 = oPDiatWHypN1 + oPGrenWHypN1 + oPBlueWHypN1;
oNPhytWHypN1 = oNDiatWHypN1 + oNGrenWHypN1 + oNBlueWHypN1;
aDPhytSN1 = aDDiatSN1 + aDGrenSN1 + aDBlueSN1 ;
aPPhytSN1 = aPDiatSN1 + aPGrenSN1 + aPBlueSN1 ;
aNPhytSN1 = aNDiatSN1 + aNGrenSN1 + aNBlueSN1;
oDPhytWEpiN1 = oDDiatWEpiN1 + oDGrenWEpiN1 + oDBlueWEpiN1;
oDOMWEpiN1 = oDDetWEpiN1 + oDPhytWEpiN1;
oDOMWHypN1 = oDDetWHypN1 + oDPhytWHypN1;
oTDOMWN1 = oDOMWEpiN1 + oDOMWHypN1;
oDSestWHypN1 = oDOMWHypN1 + oDIMWHypN1;
oPOMWHypN1 = oPPhytWHypN1 + oPDetWHypN1;
oPSestWHypN1 = oPPhytWHypN1 + oPDetWHypN1 + oPAIMWHypN1;
oPInorgWHypN1 = oPO4WHypN1 + oPAIMWHypN1;
oPTotWHypN1 = oPSestWHypN1 + oPO4WHypN1;
oNDissWEpiN1 = oNO3WEpiN1 + oNH4WEpiN1;
oNDissWHypN1 = oNO3WHypN1 + oNH4WHypN1;
oNOMWHypN1 = oNPhytWHypN1 + oNDetWHypN1;
oNSestWHypN1 = oNOMWHypN1;
oNkjWHypN1 = oNSestWHypN1 + oNH4WHypN1;
oNTotWHypN1 = oNkjWHypN1 + oNO3WHypN1;
bPorSN1 = (1.0 - fDTotS0N1) * (fDOrgS0N1 * cRhoOMN1 + (1 - fDOrgS0N1) * cRhoIMN1) / cRhoWatN1 / ( fDTotS0N1 + (1.0 - fDTotS0N1) * (fDOrgS0N1 * cRhoOMN1 + (1 - fDOrgS0N1) * cRhoIMN1) / cRhoWatN1 );
bPorCorSN1 = IF POW(bPorSN1 , (bPorSN1 + 1.0)) LE NearZeroN1 THEN 1 ELSE POW(bPorSN1 , (bPorSN1 + 1.0)) ENDIF;
aDTotSN1 = aDIMSN1 + aDHumSN1 + aDDetSN1;
aRhoTotSN1 = aDTotSN1 / cDepthSN1;
aRhoSolidSN1 = (aDIMSN1 * cRhoIMN1 + (aDHumSN1 + aDDetSN1) * cRhoOMN1) / aDTotSN1;
afDTotSN1 = 1.0 / (1.0 + bPorSN1/(1.0-bPorSN1) * cRhoWatN1 / aRhoSolidSN1);
afDOrgSN1 = (aDHumSN1 + aDDetSN1) / aDTotSN1;
afDetSN1 = aDDetSN1 / (aDHumSN1 + aDDetSN1);
afDetTotSN1 = aDDetSN1 / (aDIMSN1 + aDHumSN1 + aDDetSN1);
aPInorgSN1 = aPO4SN1 + aPAIMSN1;
aPTotAvailSN1 = aPDetSN1 + aPInorgSN1 + aPPhytSN1;
aPTotSN1 = aPTotAvailSN1 + aPHumSN1;
afPInorgSN1 = aPInorgSN1 / aDTotSN1;
afPTotSN1 = aPTotSN1 / aDTotSN1;
afPO4SN1 = aPO4SN1 / (aPTotAvailSN1 + NearZeroN1);
oPO4SN1 = aPO4SN1 / cDepthSN1 / bPorSN1;
aNDissSN1 = aNH4SN1 + aNO3SN1;
aNkjAvailSN1 = aNDetSN1 + aNPhytSN1 + aNH4SN1;
aNkjSN1 = aNkjAvailSN1 + aNHumSN1;
aNTotAvailSN1 = aNkjAvailSN1 + aNO3SN1;
aNTotSN1 = aNkjSN1 + aNO3SN1;
afNInorgSN1 = aNDissSN1 / aDTotSN1;
afNTotSN1 = aNTotSN1 / aDTotSN1;
oNO3SN1 = aNO3SN1 / cDepthSN1 / bPorSN1;
oNH4SN1 = aNH4SN1 / cDepthSN1 / bPorSN1;
oNDissSN1 = aNDissSN1 / cDepthSN1 / bPorSN1;
rPDIMWHypN1 = oPAIMWHypN1 / oDIMWHypN1;
rPDIMSN1 = aPAIMSN1 / aDIMSN1;
rPDDetWHypN1 = oPDetWHypN1 / (oDDetWHypN1+NearZeroN1);
rNDDetWHypN1 = oNDetWHypN1 / (oDDetWHypN1+NearZeroN1);
rSiDDetWHypN1 = oSiDetWHypN1 / (oDDetWHypN1+NearZeroN1);
rPDHumSN1 = aPHumSN1 / (aDHumSN1+NearZeroN1);
rNDHumSN1 = aNHumSN1 / (aDHumSN1+NearZeroN1);
rPDDetSN1 = aPDetSN1 / (aDDetSN1+NearZeroN1);
rNDDetSN1 = aNDetSN1 / (aDDetSN1+NearZeroN1);
rSiDDetSN1 = aSiDetSN1 / (aDDetSN1+NearZeroN1);
oDPhytWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oDDiatWMN1 + oDGrenWMN1 + oDBlueWMN1 ELSE 0.0 ENDIF;
oPPhytWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPDiatWMN1 + oPGrenWMN1 + oPBlueWMN1 ELSE 0.0 ENDIF;
oNPhytWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNDiatWMN1 + oNGrenWMN1 + oNBlueWMN1 ELSE 0.0 ENDIF;
oSiDiatWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cSiDDiatN1 * oDDiatWMN1 ELSE 0.0 ENDIF;
oDOMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oDDetWMN1 + oDPhytWMN1 ELSE 0.0 ENDIF;
oDSestWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oDOMWMN1 + oDIMWMN1 ELSE 0.0 ENDIF;
oPOMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPPhytWMN1 + oPDetWMN1 ELSE 0.0 ENDIF;
oPSestWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPPhytWMN1 + oPDetWMN1 + oPAIMWMN1 ELSE 0.0 ENDIF;
oPInorgWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPO4WMN1 + oPAIMWMN1 ELSE 0.0 ENDIF;
oPTotWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPSestWMN1 + oPO4WMN1 ELSE 0.0 ENDIF;
oNDissWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNO3WMN1 + oNH4WMN1 ELSE 0.0 ENDIF;
oNOMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNPhytWMN1 + oNDetWMN1 ELSE 0.0 ENDIF;
oNSestWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNOMWMN1 ELSE 0.0 ENDIF;
oNkjWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNSestWMN1 + oNH4WMN1 ELSE 0.0 ENDIF;
oNTotWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNkjWMN1 + oNO3WMN1 ELSE 0.0 ENDIF;
bPorSMN1 = (1.0 - fDTotSM0N1) * (fDOrgSM0N1 * cRhoOMN1 +(1 - fDOrgSM0N1) * cRhoIMN1) / cRhoWatN1 /(fDTotSM0N1 + (1.0 - fDTotSM0N1) * (fDOrgSM0N1 * cRhoOMN1 +(1 - fDOrgSM0N1) * cRhoIMN1) / cRhoWatN1);
bPorCorSMN1 = IF POW ( bPorSMN1 , (bPorSMN1 + 1.0)) LE NearZeroN1 THEN 1 ELSE POW ( bPorSMN1 , (bPorSMN1 + 1.0)) ENDIF;
aDTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDIMSMN1 + aDHumSMN1 + aDDetSMN1 ELSE 0.0 ENDIF;
aRhoTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDTotSMN1 / cDepthSMN1 ELSE 0.0 ENDIF;
aRhoSolidSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (aDIMSMN1 * cRhoIMN1 +(aDHumSMN1 + aDDetSMN1) * cRhoOMN1) / aDTotSMN1 ELSE 0.0 ENDIF;
afDTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN 1.0 /(1.0 + bPorSMN1/(1.0-bPorSMN1) * cRhoWatN1 / aRhoSolidSMN1) ELSE 0.0 ENDIF;
afDOrgSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (aDHumSMN1 + aDDetSMN1) / aDTotSMN1 ELSE 0.0 ENDIF;
afDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDDetSMN1 /(aDHumSMN1 + aDDetSMN1) ELSE 0.0 ENDIF;
afDetTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDDetSMN1 /(aDIMSMN1 + aDHumSMN1 + aDDetSMN1) ELSE 0.0 ENDIF;
aPInorgSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPO4SMN1 + aPAIMSMN1 ELSE 0.0 ENDIF;
aPTotAvailSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPDetSMN1 + aPInorgSMN1 ELSE 0.0 ENDIF;
aPTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPTotAvailSMN1 + aPHumSMN1 ELSE 0.0 ENDIF;
afPInorgSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPInorgSMN1 / aDTotSMN1 ELSE 0.0 ENDIF;
afPTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPTotSMN1 / aDTotSMN1 ELSE 0.0 ENDIF;
afPO4SMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPO4SMN1 /(aPTotAvailSMN1 + NearZeroN1) ELSE 0.0 ENDIF;
oPO4SMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPO4SMN1 / cDepthSMN1 / bPorSMN1 ELSE 0.0 ENDIF;
aNDissSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNH4SMN1 + aNO3SMN1 ELSE 0.0 ENDIF;
aNkjAvailSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNDetSMN1 + aNH4SMN1 ELSE 0.0 ENDIF;
aNkjSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNkjAvailSMN1 + aNHumSMN1 ELSE 0.0 ENDIF;
aNTotAvailSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNkjAvailSMN1 + aNO3SMN1 ELSE 0.0 ENDIF;
aNTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNkjSMN1 + aNO3SMN1 ELSE 0.0 ENDIF;
afNInorgSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNDissSMN1 / aDTotSMN1 ELSE 0.0 ENDIF;
afNTotSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNTotSMN1 / aDTotSMN1 ELSE 0.0 ENDIF;
oNO3SMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNO3SMN1 / cDepthSMN1 / bPorSMN1 ELSE 0.0 ENDIF;
oNH4SMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNH4SMN1 / cDepthSMN1 / bPorSMN1 ELSE 0.0 ENDIF;
oNDissSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNDissSMN1 / cDepthSMN1 / bPorSMN1 ELSE 0.0 ENDIF;
rPDIMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPAIMWMN1 / oDIMWMN1 ELSE 0.0 ENDIF;
rPDIMSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPAIMSMN1 / aDIMSMN1 ELSE 0.0 ENDIF;
rPDDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oPDetWMN1 /(oDDetWMN1+NearZeroN1) ELSE 0.0 ENDIF;
rNDDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNDetWMN1 /(oDDetWMN1+NearZeroN1) ELSE 0.0 ENDIF;
rSiDDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oSiDetWMN1 /(oDDetWMN1+NearZeroN1) ELSE 0.0 ENDIF;
rPDHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPHumSMN1 /(aDHumSMN1+NearZeroN1) ELSE 0.0 ENDIF;
rNDHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNHumSMN1 /(aDHumSMN1+NearZeroN1) ELSE 0.0 ENDIF;
rPDDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPDetSMN1 /(aDDetSMN1+NearZeroN1) ELSE 0.0 ENDIF;
rNDDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNDetSMN1 /(aDDetSMN1+NearZeroN1) ELSE 0.0 ENDIF;
rSiDDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aSiDetSMN1 /(aDDetSMN1+NearZeroN1) ELSE 0.0 ENDIF;
aDTotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ((oDIMWMN1 + oDDetWMN1 + oDPhytWMN1 + oDZooMN1) * uDepthWMN1 + aDIMSMN1 + aDHumSMN1 + aDDetSMN1 + aDShootPhraN1 + aDRootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
aPTotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ((oPO4WMN1 + oPDetWMN1 + oPAIMWMN1 + oPPhytWMN1 + oPZooMN1) * uDepthWMN1 + aPO4SMN1 + aPHumSMN1 + aPDetSMN1 + aPAIMSMN1 + aPShootPhraN1 + aPRootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
aNTotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ((oNH4WMN1 + oNO3WMN1 + oNDetWMN1 + oNPhytWMN1 + oNZooMN1) * uDepthWMN1 + aNH4SMN1 + aNO3SMN1 + aNHumSMN1 + aNDetSMN1 + aNShootPhraN1 + aNRootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
aSiTotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ((oSiO2WMN1 + oSiDetWMN1 + oSiDiatWMN1) * uDepthWMN1 + aSiDetSMN1) * fMarshN1 ELSE 0.0 ENDIF;
aO2TotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ((oO2WMN1) * uDepthWMN1 ) * fMarshN1 ELSE 0.0 ENDIF;
uPLoadSeasonEpiN1 = IF (FALSE EQ UseSeasonLoadN1) THEN 0.0 ELSEIF (DayN1 LT cDayApril1N1 - 0.5*cLengChangeN1) THEN cPLoadWinN1 ELSEIF (DayN1 LT cDayApril1N1 + 0.5*cLengChangeN1) THEN 0.5*(cPLoadWinN1 + cPLoadSumN1) + 0.5*(cPLoadWinN1 - cPLoadSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayApril1N1)) ELSEIF (DayN1 LT cDayOct1N1 - 0.5*cLengChangeN1) THEN cPLoadSumN1 ELSEIF (DayN1 LT cDayOct1N1 + 0.5*cLengChangeN1) THEN 0.5*(cPLoadWinN1 + cPLoadSumN1) - 0.5*(cPLoadWinN1 - cPLoadSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayOct1N1)) ELSE cPLoadWinN1 ENDIF;
uPLoadEpiN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mPLoadPO4EpiN1 + mPLoadAIMEpiN1 + mPLoadDiatEpiN1 + mPLoadGrenEpiN1 + mPLoadBlueEpiN1 + mPLoadDetEpiN1) ELSEIF (ReadPLoadN1 EQ TRUE AND ReadNutFracN1 EQ TRUE) THEN mPLoadPO4EpiN1 + mPLoadOrgEpiN1 ELSEIF (ReadPLoadN1 EQ TRUE AND FALSE EQ ReadNutFracN1) THEN mPLoadEpiN1 * mPLoadEpiMultN1 ELSEIF (UsePulseLoadN1 EQ TRUE) THEN 0.0 ELSEIF (UseSeasonLoadN1 EQ TRUE) THEN uPLoadSeasonEpiN1 ELSE cPLoadN1 ENDIF;
uPLoadPO4EpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadPO4EpiN1 ELSEIF (ReadPLoadN1 EQ FALSE) THEN fPO4InN1 * uPLoadEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN mPLoadPO4EpiN1 ELSE fPO4InN1 * uPLoadEpiN1 ENDIF;
uPLoadOrgEpiN1 = IF (FALSE EQ ReadPLoadN1) THEN (1.0 - fPO4InN1) * uPLoadEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN mPLoadOrgEpiN1 ELSE (1.0 - fPO4InN1) * uPLoadEpiN1 ENDIF;
uPLoadPhytTotEpiN1 = IF (FALSE EQ InclSeasonN1) THEN (((fPhytInSumN1 + fPhytInWinN1)/2)*uPLoadOrgEpiN1) ELSEIF (ReadPLoadPhytN1 EQ TRUE) THEN mPLoadPhytTotEpiN1 ELSE ((fPhytInSumN1+fPhytInWinN1)/2.0 - (fPhytInSumN1-fPhytInWinN1)/2.0 * COS(2.0*PiN1 * (sTimeN1 + TenDaysN1 - cTimeLagN1) / DaysInYearN1)) * uPLoadOrgEpiN1 ENDIF;
uPLoadDetEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadDetEpiN1 ELSE uPLoadOrgEpiN1 - uPLoadPhytTotEpiN1 ENDIF;
uPLoadAIMEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadAIMEpiN1 ELSE 0.0 ENDIF;
uPBackLoadHypN1 = IF (FALSE EQ aInclStratN1) THEN 0.0 ELSE cPBackLoadN1 ENDIF;
uPTotInEpiN1 = uPLoadEpiN1 / (uQInEpiN1 / mmPermN1 + NearZeroN1);
uNLoadSeasonEpiN1 = IF (FALSE EQ UseSeasonLoadN1) THEN 0.0 ELSEIF (DayN1 LT cDayApril1N1 - 0.5*cLengChangeN1) THEN cNLoadWinN1 ELSEIF (DayN1 LT cDayApril1N1 + 0.5*cLengChangeN1) THEN 0.5*(cNLoadWinN1 + cNLoadSumN1) + 0.5*(cNLoadWinN1 - cNLoadSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayApril1N1)) ELSEIF (DayN1 LT cDayOct1N1 - 0.5*cLengChangeN1) THEN cNLoadSumN1 ELSEIF (DayN1 LT cDayOct1N1 + 0.5*cLengChangeN1) THEN 0.5*(cNLoadWinN1 + cNLoadSumN1) - 0.5*(cNLoadWinN1 - cNLoadSumN1) * COS(PiN1/cLengChangeN1 * (DayN1 - cDayOct1N1)) ELSE cNLoadWinN1 ENDIF;
uNLoadPhytTotEpiN1 = IF (ReadNutFracN1 EQ FALSE) THEN (cNPPhytInN1 * uPLoadPhytTotEpiN1) ELSE  mNLoadPhytTotEpiN1 ENDIF ;
uNLoadEpiN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mNLoadNH4EpiN1 + mNLoadNO3EpiN1 + mNLoadGrenEpiN1 + mNLoadDiatEpiN1 + mNLoadBlueEpiN1 + mNLoadDetEpiN1) ELSEIF (ReadNLoadN1 EQ TRUE AND ReadNutFracN1 EQ TRUE) THEN mNLoadNH4EpiN1 + mNLoadNO3EpiN1 + mNLoadOrgEpiN1 ELSEIF (ReadNLoadN1 EQ TRUE AND ReadNutFracN1 EQ FALSE) THEN mNLoadEpiN1 ELSEIF (UsePulseLoadN1 EQ TRUE) THEN 0.0 ELSEIF (ReadPLoadN1 EQ TRUE) THEN cNPLoadMeasN1 * uPLoadEpiN1 ELSEIF (UseSeasonLoadN1 EQ TRUE) THEN uNLoadSeasonEpiN1 ELSE cNLoadN1 ENDIF;
uNLoadDetEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadDetEpiN1 ELSEIF (ReadNLoadN1 EQ FALSE ) THEN MIN(cNPDetInN1 * uPLoadDetEpiN1, uNLoadEpiN1 - uNLoadPhytTotEpiN1) ELSEIF (ReadNutFracN1 EQ TRUE) THEN mNLoadOrgEpiN1 - mNLoadPhytTotEpiN1 ELSE MIN(cNPDetInN1 * uPLoadDetEpiN1, uNLoadEpiN1 - uNLoadPhytTotEpiN1) ENDIF;
uNLoadOrgEpiN1 = IF (FALSE EQ ReadNLoadN1) THEN uNLoadPhytTotEpiN1 + uNLoadDetEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN mNLoadOrgEpiN1 ELSE uNLoadPhytTotEpiN1 + uNLoadDetEpiN1 ENDIF;
uNLoadDissEpiN1 = IF (FALSE EQ ReadNLoadN1) THEN uNLoadEpiN1 - uNLoadOrgEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN 0.0 ELSE uNLoadEpiN1 - uNLoadOrgEpiN1 ENDIF;
uNLoadNH4EpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadNH4EpiN1 ELSEIF (ReadNLoadN1 EQ FALSE) THEN fNH4DissInN1 * uNLoadDissEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN mNLoadNH4EpiN1 ELSE fNH4DissInN1 * uNLoadDissEpiN1 ENDIF;
uNLoadNO3EpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadNO3EpiN1 ELSEIF (ReadNLoadN1 EQ FALSE) THEN (1.0 - fNH4DissInN1) * uNLoadDissEpiN1 ELSEIF (ReadNutFracN1 EQ TRUE) THEN mNLoadNO3EpiN1 ELSE (1.0 - fNH4DissInN1) * uNLoadDissEpiN1 ENDIF;
uNBackLoadHypN1 = IF (FALSE EQ aInclStratN1) THEN 0.0 ELSE cNBackLoadN1 ENDIF;
uNTotInEpiN1 = uNLoadEpiN1 / (uQInEpiN1 / mmPermN1 + NearZeroN1);
uDLoadDetEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mDLoadDetEpiN1 ELSEIF (ReadDLoadDetN1 EQ TRUE) THEN mDLoadDetEpiN1 ELSE uNLoadDetEpiN1 / cNDDetInN1 ENDIF;
uDLoadPhytTotEpiN1 = uNLoadPhytTotEpiN1 / cNDPhytInN1;
uDLoadIMEpiN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadIMEpiN1 ELSEIF (ReadDLoadIMN1 EQ TRUE) THEN mDLoadIMEpiN1 ELSE cDIMInN1 * uQInEpiN1 / mmPermN1 ENDIF;
uDLoadEpiN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mDLoadIMEpiN1 + mDLoadDetEpiN1 + mDLoadDiatEpiN1 + mDLoadGrenEpiN1 + mDLoadBlueEpiN1) ELSE uDLoadIMEpiN1 + uDLoadDetEpiN1 + uDLoadPhytTotEpiN1 ENDIF;
uDLoadDiatEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mDLoadDiatEpiN1 ELSE fDiatPhytInN1 * uDLoadPhytTotEpiN1 ENDIF;
uPLoadDiatEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadDiatEpiN1 ELSE fDiatPhytInN1 * uPLoadPhytTotEpiN1 ENDIF;
uNLoadDiatEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadDiatEpiN1 ELSE fDiatPhytInN1 * uNLoadPhytTotEpiN1 ENDIF;
uDLoadGrenEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mDLoadGrenEpiN1 ELSE fGrenPhytInN1 * uDLoadPhytTotEpiN1 ENDIF;
uPLoadGrenEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadGrenEpiN1 ELSE fGrenPhytInN1 * uPLoadPhytTotEpiN1 ENDIF;
uNLoadGrenEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadGrenEpiN1 ELSE fGrenPhytInN1 * uNLoadPhytTotEpiN1 ENDIF;
uDLoadBlueEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mDLoadBlueEpiN1 ELSE fBluePhytInN1 * uDLoadPhytTotEpiN1 ENDIF;
uPLoadBlueEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadBlueEpiN1 ELSE fBluePhytInN1 * uPLoadPhytTotEpiN1 ENDIF;
uNLoadBlueEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadBlueEpiN1 ELSE fBluePhytInN1 * uNLoadPhytTotEpiN1 ENDIF;
uDLoadZooEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mDLoadZooEpiN1 ELSE cDZooInN1 * uQInEpiN1 / mmPermN1 ENDIF;
uPLoadZooEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mPLoadZooEpiN1 ELSE cDZooInN1 * cPDZooRefN1 * uQInEpiN1 / mmPermN1 ENDIF;
uNLoadZooEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mNLoadZooEpiN1 ELSE cDZooInN1 * cNDZooRefN1 * uQInEpiN1 / mmPermN1 ENDIF;
uSiLoadSiO2EpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mSiLoadSiO2EpiN1 ELSE cSiO2InN1 * uQInEpiN1 / mmPermN1 ENDIF;
uSiLoadDetEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mSiLoadDetEpiN1 ELSE cSiDDetInN1 * uDLoadDetEpiN1 ENDIF;
uSiLoadDiatEpiN1 = cSiDDiatN1 * uDLoadDiatEpiN1;
uSiLoadEpiN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2EpiN1 + uSiLoadDetEpiN1 + uSiLoadDiatEpiN1 ENDIF;
uDLoadBlueSurfN1= IF (ReadTranFracN1 EQ TRUE) THEN mDLoadBlueSurfN1 ELSE 0.0 ENDIF;
uPLoadBlueSurfN1= IF (ReadTranFracN1 EQ TRUE) THEN mPLoadBlueSurfN1 ELSE 0.0 ENDIF;
uNLoadBlueSurfN1= IF (ReadTranFracN1 EQ TRUE) THEN mNLoadBlueSurfN1 ELSE 0.0 ENDIF;
uNLoadNH4HypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadNH4HypN1 ELSE 0 ENDIF;
uNLoadNO3HypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadNO3HypN1 ELSE 0 ENDIF;
uPLoadPO4HypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadPO4HypN1 ELSE 0 ENDIF;
uPLoadAIMHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadAIMHypN1 ELSE 0 ENDIF;
uSiLoadSiO2HypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mSiLoadSiO2HypN1 ELSE 0 ENDIF;
uO2LoadHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mO2LoadHypN1 ELSE cO2InN1 * uQInHypN1 / mmPermN1 ENDIF;
uDLoadDetHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadDetHypN1 ELSE 0 ENDIF;
uNLoadDetHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadDetHypN1 ELSE 0 ENDIF;
uPLoadDetHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadDetHypN1 ELSE 0 ENDIF;
uSiLoadDetHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mSiLoadDetHypN1 ELSE 0 ENDIF;
uDLoadIMHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadIMHypN1 ELSE 0 ENDIF;
uDLoadDiatHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadDiatHypN1 ELSE 0 ENDIF;
uNLoadDiatHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadDiatHypN1 ELSE 0 ENDIF;
uPLoadDiatHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadDiatHypN1 ELSE 0 ENDIF;
uSiLoadDiatHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN cSiDDiatN1 * uDLoadDiatHypN1 ELSE 0 ENDIF;
uDLoadGrenHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadGrenHypN1 ELSE 0 ENDIF;
uNLoadGrenHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadGrenHypN1 ELSE 0 ENDIF;
uPLoadGrenHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadGrenHypN1 ELSE 0 ENDIF;
uDLoadBlueHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadBlueHypN1 ELSE 0 ENDIF;
uNLoadBlueHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadBlueHypN1 ELSE 0 ENDIF;
uPLoadBlueHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadBlueHypN1 ELSE 0 ENDIF;
uDLoadZooHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mDLoadZooHypN1 ELSE 0 ENDIF;
uNLoadZooHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mNLoadZooHypN1 ELSE 0 ENDIF;
uPLoadZooHypN1= IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN mPLoadZooHypN1 ELSE 0 ENDIF;
uDLoadHypN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mDLoadIMHypN1 + mDLoadDetHypN1 + mDLoadDiatHypN1 + mDLoadGrenHypN1 + mDLoadBlueHypN1) ELSE 0.0 ENDIF;
uNLoadHypN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mNLoadNH4HypN1 + mNLoadNO3HypN1 + mNLoadGrenHypN1 + mNLoadDiatHypN1 + mNLoadBlueHypN1 + mNLoadDetHypN1) ELSE 0.0 ENDIF;
uPLoadHypN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN1 EQ TRUE) THEN (mPLoadPO4HypN1 + mPLoadAIMHypN1 + mPLoadDiatHypN1 + mPLoadGrenHypN1 + mPLoadBlueHypN1 + mPLoadDetHypN1) ELSE 0.0 ENDIF;
uSiLoadHypN1 = IF (InclTranN1 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2HypN1 + uSiLoadDetHypN1 + uSiLoadDiatHypN1 ENDIF;
wDDilIMHypN1 = ukOutHypN1 * oDIMWHypN1;
wDDilDetHypN1 = ukOutHypN1 * oDDetWHypN1;
wDDilGrenHypN1 = ukOutHypN1 * oDGrenWHypN1;
wDDilBlueHypN1 = ukOutHypN1 * oDBlueWHypN1;
wDDilDiatHypN1 = ukOutHypN1 * oDDiatWHypN1;
wDDilZooHypN1 = ukOutHypN1 * oDZooHypN1;
wPDilZooHypN1 = ukOutHypN1 * oPZooHypN1;
wNDilZooHypN1 = ukOutHypN1 * oNZooHypN1;
wPDilPO4HypN1 = ukOutHypN1 * oPO4WHypN1;
wPDilDetHypN1 = ukOutHypN1*oPDetWHypN1;
wPDilAIMHypN1 = ukOutHypN1 * oPAIMWHypN1;
wNDilNH4HypN1 = ukOutHypN1 * oNH4WHypN1;
wNDilNO3HypN1 = ukOutHypN1 * oNO3WHypN1;
wNDilDetHypN1 = ukOutHypN1 * oNDetWHypN1;
wO2OutflHypN1 = ukOutHypN1 * oO2WHypN1;
wPDilDiatHypN1 = ukOutHypN1 * oPDiatWHypN1;
wNDilDiatHypN1 = ukOutHypN1 * oNDiatWHypN1;
wPDilGrenHypN1 = ukOutHypN1 * oPGrenWHypN1;
wNDilGrenHypN1 = ukOutHypN1 * oNGrenWHypN1;
wPDilBlueHypN1 = ukOutHypN1 * oPBlueWHypN1;
wNDilBlueHypN1 = ukOutHypN1 * oNBlueWHypN1;
wSiDilSiO2HypN1 = ukOutHypN1 * oSiO2WHypN1;
wSiDilDetHypN1 = ukOutHypN1 * oSiDetWHypN1;
wSiDilDiatHypN1 = cSiDDiatN1 * wDDilDiatHypN1;
wDDilPhytHypN1 = wDDilDiatHypN1 + wDDilGrenHypN1 + wDDilBlueHypN1;
wPDilPhytHypN1 = wPDilDiatHypN1 + wPDilGrenHypN1 + wPDilBlueHypN1;
wNDilPhytHypN1 = wNDilDiatHypN1 + wNDilGrenHypN1 + wNDilBlueHypN1;
wSiDilTotHypN1 = wSiDilDetHypN1 + wSiDilSiO2HypN1 + wSiDilDiatHypN1;
wDOutflTotHypN1 = ukOutHypN1 * oDSestWHypN1;
wPOutflTotHypN1 = ukOutHypN1 * oPTotWHypN1;
wNOutflTotHypN1 = ukOutHypN1 * oNTotWHypN1;
wSiOutflTotHypN1 = ukOutHypN1 * (oSiO2WHypN1 + oSiDetWHypN1 + cSiDDiatN1 * oDDiatWHypN1);
tSiTranTotTHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadHypN1 - wSiDilTotHypN1 * uDepthWHypN1 ENDIF;
wDDilTotHypN1 = wDDilIMHypN1 + wDDilDetHypN1 + wDDilPhytHypN1;
wPDilTotHypN1 = wPDilDetHypN1 + wPDilPO4HypN1 + wPDilAIMHypN1 + wPDilPhytHypN1;
wNDilTotHypN1 = wNDilDetHypN1 + wNDilNO3HypN1 + wNDilNH4HypN1 + wNDilPhytHypN1;
tDTranTotTHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadHypN1 - wDDilTotHypN1 * uDepthWHypN1 ENDIF;
tPTranTotTHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadHypN1 - wPDilTotHypN1 * uDepthWHypN1 ENDIF;
tNTranTotTHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadHypN1 - wNDilTotHypN1 * uDepthWHypN1 ENDIF;
uDLoadTotTWN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadEpiN1 + uDLoadHypN1 ENDIF;
uPLoadTotTWN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadEpiN1 + uPLoadHypN1 ENDIF;
uNLoadTotTWN1 =  IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadEpiN1 + uNLoadHypN1 ENDIF;
uSiLoadTotTWN1 =  IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadEpiN1 + uSiLoadHypN1 ENDIF;
wDExchIMMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDIMWHypN1 - oDIMWMN1) ELSE 0.0 ENDIF;
wPExchPO4MHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPO4WHypN1 - oPO4WMN1) ELSE 0.0 ENDIF;
wPExchAIMMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPAIMWHypN1 - oPAIMWMN1) ELSE 0.0 ENDIF;
wNExchNH4MHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNH4WHypN1 - oNH4WMN1) ELSE 0.0 ENDIF;
wNExchNO3MHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNO3WHypN1 - oNO3WMN1) ELSE 0.0 ENDIF;
wSiExchSiO2MHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oSiO2WHypN1 - oSiO2WMN1) ELSE 0.0 ENDIF;
wO2ExchMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oO2WHypN1 - oO2WMN1) ELSE 0.0 ENDIF;
wDExchDetMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDDetWHypN1 - oDDetWMN1) ELSE 0.0 ENDIF;
wPExchDetMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPDetWHypN1 - oPDetWMN1) ELSE 0.0 ENDIF;
wNExchDetMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNDetWHypN1 - oNDetWMN1) ELSE 0.0 ENDIF;
wSiExchDetMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oSiDetWHypN1 - oSiDetWMN1) ELSE 0.0 ENDIF;
wDExchDiatMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDDiatWHypN1 - oDDiatWMN1) ELSE 0.0 ENDIF;
wPExchDiatMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPDiatWHypN1 - oPDiatWMN1) ELSE 0.0 ENDIF;
wNExchDiatMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNDiatWHypN1 - oNDiatWMN1) ELSE 0.0 ENDIF;
wSiExchDiatMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cSiDDiatN1 * wDExchDiatMHypN1 ELSE 0.0 ENDIF;
wDExchGrenMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDGrenWHypN1 - oDGrenWMN1) ELSE 0.0 ENDIF;
wPExchGrenMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPGrenWHypN1 - oPGrenWMN1) ELSE 0.0 ENDIF;
wNExchGrenMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNGrenWHypN1 - oNGrenWMN1) ELSE 0.0 ENDIF;
wDExchBlueMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDBlueWHypN1 - oDBlueWMN1) ELSE 0.0 ENDIF;
wPExchBlueMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPBlueWHypN1 - oPBlueWMN1) ELSE 0.0 ENDIF;
wNExchBlueMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNBlueWHypN1 - oNBlueWMN1) ELSE 0.0 ENDIF;
wDExchZooMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oDZooHypN1 - oDZooMN1) ELSE 0.0 ENDIF;
wPExchZooMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oPZooHypN1 - oPZooMN1) ELSE 0.0 ENDIF;
wNExchZooMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMHypN1 *(oNZooHypN1 - oNZooMN1) ELSE 0.0 ENDIF;
wDExchIMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDIMWHypN1 - oDIMWMN1) ELSE 0.0 ENDIF;
wPExchPO4HypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPO4WHypN1 - oPO4WMN1) ELSE 0.0 ENDIF;
wPExchAIMHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPAIMWHypN1 - oPAIMWMN1) ELSE 0.0 ENDIF;
wNExchNH4HypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNH4WHypN1 - oNH4WMN1) ELSE 0.0 ENDIF;
wNExchNO3HypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNO3WHypN1 - oNO3WMN1) ELSE 0.0 ENDIF;
wSiExchSiO2HypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oSiO2WHypN1 - oSiO2WMN1) ELSE 0.0 ENDIF;
wO2ExchHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oO2WHypN1 - oO2WMN1) ELSE 0.0 ENDIF;
wDExchDetHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDDetWHypN1 - oDDetWMN1) ELSE 0.0 ENDIF;
wPExchDetHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPDetWHypN1 - oPDetWMN1) ELSE 0.0 ENDIF;
wNExchDetHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNDetWHypN1 - oNDetWMN1) ELSE 0.0 ENDIF;
wSiExchDetHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oSiDetWHypN1 - oSiDetWMN1) ELSE 0.0 ENDIF;
wDExchDiatHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDDiatWHypN1 - oDDiatWMN1) ELSE 0.0 ENDIF;
wPExchDiatHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPDiatWHypN1 - oPDiatWMN1) ELSE 0.0 ENDIF;
wNExchDiatHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNDiatWHypN1 - oNDiatWMN1) ELSE 0.0 ENDIF;
wSiExchDiatHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cSiDDiatN1 * wDExchDiatHypN1 ELSE 0.0 ENDIF;
wDExchGrenHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDGrenWHypN1 - oDGrenWMN1) ELSE 0.0 ENDIF;
wPExchGrenHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPGrenWHypN1 - oPGrenWMN1) ELSE 0.0 ENDIF;
wNExchGrenHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNGrenWHypN1 - oNGrenWMN1) ELSE 0.0 ENDIF;
wDExchBlueHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDBlueWHypN1 - oDBlueWMN1) ELSE 0.0 ENDIF;
wPExchBlueHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPBlueWHypN1 - oPBlueWMN1) ELSE 0.0 ENDIF;
wNExchBlueHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNBlueWHypN1 - oNBlueWMN1) ELSE 0.0 ENDIF;
wDExchZooHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oDZooHypN1 - oDZooMN1) ELSE 0.0 ENDIF;
wPExchZooHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oPZooHypN1 - oPZooMN1) ELSE 0.0 ENDIF;
wNExchZooHypN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLHypN1 *(oNZooHypN1 - oNZooMN1) ELSE 0.0 ENDIF;
tInfSiO2WHypN1 =  IF (InclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oSiO2WHypN1 ELSE 0.0 ENDIF;
tInfO2WHypN1 =  IF (InclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oO2WHypN1 ELSE 0.0 ENDIF;
tPInfPO4WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oPO4WHypN1 ELSE 0.0 ENDIF;
tNInfNH4WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNH4WHypN1 ELSE 0.0 ENDIF;
tNInfNO3WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNO3WHypN1 ELSE 0.0 ENDIF;
tPInfPO4SN1 = IF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oPO4SN1 ELSE 0.0 ENDIF;
tNInfNH4SN1 = IF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNH4SN1 ELSE 0.0 ENDIF;
tNInfNO3SN1 = IF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNO3SN1 ELSE 0.0 ENDIF;
tSeepSiO2WHypN1 =  IF (InclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WHypN1 =  IF (InclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oPO4SN1 ELSE 0.0 ENDIF;
tNSeepNH4WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNH4SN1 ELSE 0.0 ENDIF;
tNSeepNO3WHypN1 = IF (aInclStratN1 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNO3SN1 ELSE 0.0 ENDIF;
tPSeepPO4SN1 = IF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cPO4GroundN1 ELSE 0.0 ENDIF;
tNSeepNH4SN1 = IF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cNH4GroundN1 ELSE 0.0 ENDIF;
tNSeepNO3SN1 = IF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cNO3GroundN1 ELSE 0.0 ENDIF;
tNH4LoadSN1 = fNH4LoadSN1 * cNLoadSN1;
tNO3LoadSN1 = cNLoadSN1 - tNH4LoadSN1;
uDErosIMN1 = (1.0 - fDOrgSoilN1) * cDErosTotN1;
uDErosIMSN1 = fSedErosIMN1 * uDErosIMN1;
uDErosIMWN1 = uDErosIMN1 - uDErosIMSN1;
uDErosOMN1 = fDOrgSoilN1 * cDErosTotN1;
uPErosOMN1 = cPDSoilOMN1 * uDErosOMN1;
uNErosOMN1 = cNDSoilOMN1 * uDErosOMN1;
uO2SatEpiN1 = 14.652 - 0.41022 * uTmEpiN1 + 0.007991 * uTmEpiN1*uTmEpiN1 - 0.000077774 * uTmEpiN1*uTmEpiN1*uTmEpiN1;
uO2SatHypN1 = 14.652 - 0.41022 * uTmHypN1 + 0.007991 * uTmHypN1*uTmHypN1- 0.000077774 *uTmHypN1*uTmHypN1*uTmHypN1;
kAerN1 = IF POW ( uVWindN1 , (0.5))  LE NearZeroN1 THEN 1 ELSE cAerRootN1 * POW ( uVWindN1 , (0.5)) + cAerLinN1 * uVWindN1 + cAerSquareN1 * uVWindN1*uVWindN1 ENDIF;
uFunTmAerEpiN1 = IF  POW ( cThetaAerN1 , (uTmEpiN1-cTmRefN1)) LE NearZeroN1 THEN 1 ELSE POW ( cThetaAerN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
uFunTmAerHypN1 = IF POW ( cThetaAerN1 , (uTmHypN1-cTmRefN1)) LE NearZeroN1 THEN 1 ELSE POW ( cThetaAerN1 , (uTmHypN1-cTmRefN1)) ENDIF;
aFunFloatAerN1 =  MAX( 0.0, 1.0 -  ( kFloatAerN1 * aDFloatVegN1 ) );
aFunBlueSurfAerN1 = MAX(0.0, 1.0 - (kBlueSurfAerN1 * aDBlueSurfN1));
tO2BubHypN1 = IF (uO2SatHypN1 LT oO2WHypN1 ) THEN kBubN1 * uFunTmAerHypN1 * (uO2SatHypN1 - oO2WHypN1) ELSE 0 ENDIF;
uFunTmFishN1 = IF (InclWebN1 EQ TRUE) THEN EXP( -0.5/(cSigTmFishN1*cSigTmFishN1) * (( MAX (uTmEpiN1, uTmHypN1 * aInclStratN1) - cTmOptFishN1)*( MAX (uTmEpiN1, uTmHypN1 * aInclStratN1) - cTmOptFishN1) - (cTmRefN1 - cTmOptFishN1)*(cTmRefN1 - cTmOptFishN1))) ELSE 0.0 ENDIF;
tDTurbFishN1 = IF (InclWebN1 EQ TRUE) THEN (kTurbFishN1 * uFunTmFishN1 * aDFiAdN1) ELSE 0.0 ENDIF;
aFunVegResusN1 = MAX(1.0 - kVegResusN1 * aDVegN1, NearZeroN1);
aFunDimSuspN1 = IF (uTmEpiN1 GE 0.1) OR  POW(((cFetchN1 +NearZeroN1)/ cFetchRefN1) , (0.5)) LE NearZeroN1 THEN cSuspRefN1 * ((cSuspMinN1 + cSuspMaxN1 / (1.0 + EXP(cSuspSlopeN1 * (uDepthWN1 - hDepthSuspN1)))) * POW(((cFetchN1 +NearZeroN1)/ cFetchRefN1) , (0.5))) ELSE 0.0 ENDIF;
tDResusTauDeadN1 = IF POW(aFunDimSuspN1 +NearZeroN1 , (0.5)) LE NearZeroN1 THEN MIN(aFunDimSuspN1, POW( 1  , (0.5))) * POW(fLutumN1 / fLutumRefN1 , (0.5)) * bPorSN1 ELSE MIN(aFunDimSuspN1, POW(aFunDimSuspN1 +NearZeroN1 , (0.5))) * POW(fLutumN1 / fLutumRefN1 , (0.5)) * bPorSN1 ENDIF;
tDResusBareDeadN1 = tDResusTauDeadN1 + tDTurbFishN1;
tDResusDeadN1 = tDResusBareDeadN1 * aFunVegResusN1;
tDResusIMN1 = fLutumN1 * aDIMSN1 / (fLutumN1 * aDIMSN1 + aDDetSN1) * tDResusDeadN1;
tDResusDetN1 = aDDetSN1 / (fLutumN1 * aDIMSN1 + aDDetSN1) * tDResusDeadN1;
akResusPhytRefN1 = kResusPhytMaxN1 * (1.0 - EXP(cResusPhytExpN1 * tDResusDeadN1));
tDResusPhytTotN1 = akResusPhytRefN1 * aDPhytSN1;
tPResusDetN1 = rPDDetSN1 * tDResusDetN1;
tPResusPO4N1 = aPO4SN1 / aDDetSN1 * tDResusDetN1;
tPResusAIMN1 = aPAIMSN1 / aDIMSN1 * tDResusIMN1;
tNResusNO3N1 = aNO3SN1 / aDDetSN1 * tDResusDetN1;
tNResusNH4N1 = aNH4SN1 / aDDetSN1 * tDResusDetN1;
tNResusDetN1 = rNDDetSN1 * tDResusDetN1;
tSiResusDetN1 = rSiDDetSN1 * tDResusDetN1;
aFunTauSetOMHypN1 = IF POW(aFunDimSuspN1 +NearZeroN1 , (0.5)) LT NearZeroN1 THEN 1 ELSE MIN(1.0 / POW(aFunDimSuspN1 +NearZeroN1 , (0.5)), 1.0) ENDIF;
aFunTauSetIMHypN1 = aFunTauSetOMHypN1;
uFunTmSetEpiN1 = IF POW ( cThetaSetN1 , (uTmEpiN1-cTmRefN1)) LT NearZeroN1 THEN 1 ELSE POW ( cThetaSetN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
uFunTmSetHypN1 = IF POW(cThetaSetN1 , (uTmHypN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE POW(cThetaSetN1 , (uTmHypN1-cTmRefN1)) ENDIF;
uCorVSetIMHypN1 = IF POW((fLutumRefN1/fLutumN1) , (0.5))  LT NearZeroN1 THEN 1 ELSE aFunTauSetIMHypN1 * POW((fLutumRefN1/fLutumN1) , (0.5)) * uFunTmSetHypN1 * (cVSetIMN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) ENDIF;
tDSetIMHypN1 = uCorVSetIMHypN1 * oDIMWHypN1;
tPSetAIMHypN1 = oPAIMWHypN1 / oDIMWHypN1 * tDSetIMHypN1;
uCorVSetDetHypN1 = (cVSetDetN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMHypN1 * uFunTmSetHypN1;
tDSetDetHypN1 = uCorVSetDetHypN1 * oDDetWHypN1;
tPSetDetHypN1 = uCorVSetDetHypN1 * oPDetWHypN1;
tNSetDetHypN1 = uCorVSetDetHypN1 * oNDetWHypN1;
tSiSetDetHypN1 = uCorVSetDetHypN1 * oSiDetWHypN1;
kPMinDetWN1 = kDMinDetWN1;
kNMinDetWN1 = kDMinDetWN1;
kSiMinDetWN1 = kDMinDetWN1;
uFunTmMinWEpiN1 =  IF POW(cThetaMinWN1 , (uTmEpiN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE POW(cThetaMinWN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
uFunTmMinWHypN1 = IF POW(cThetaMinWN1 , (uTmEpiN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE  POW(cThetaMinWN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
wDMinDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kDMinDetWN1 * uFunTmMinWHypN1 * oDDetWHypN1 ENDIF;
wPMinDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kPMinDetWN1 * uFunTmMinWHypN1 * oPDetWHypN1 ENDIF;
wNMinDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kNMinDetWN1 * uFunTmMinWHypN1 * oNDetWHypN1 ENDIF;
wSiMinDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kSiMinDetWN1 * uFunTmMinWHypN1 * oSiDetWHypN1 ENDIF;
aCorO2BODHypN1 = oO2WHypN1 / (hO2BODN1 + oO2WHypN1);
wO2MinDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE molO2molCN1 * cCPerDWN1 * aCorO2BODHypN1 * wDMinDetWHypN1 ENDIF;
wDDenitWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE oNO3WHypN1*oNO3WHypN1 / (hNO3DenitN1*hNO3DenitN1 + oNO3WHypN1*oNO3WHypN1) * (1.0 - aCorO2BODHypN1) * wDMinDetWHypN1 ENDIF;
wNDenitWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE NO3PerCN1 * molNmolCN1 * cCPerDWN1 * wDDenitWHypN1 ENDIF;
uFunTmNitrHypN1 = IF   POW(cThetaNitrN1 , (uTmHypN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE POW(cThetaNitrN1 , (uTmHypN1-cTmRefN1)) ENDIF;
uFunTmNitrEpiN1 =  IF POW(cThetaNitrN1 , (uTmEpiN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE POW(cThetaNitrN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
uFunTmNitrSN1 = IF POW(cThetaNitrN1 , (uTmEpiN1-cTmRefN1))  LT NearZeroN1 THEN 1 ELSE POW(cThetaNitrN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
aCorO2NitrWHypN1 = oO2WHypN1*oO2WHypN1 / (hO2NitrN1*hO2NitrN1 + oO2WHypN1*oO2WHypN1);
wNNitrWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kNitrWN1 * uFunTmNitrHypN1 * aCorO2NitrWHypN1 * oNH4WHypN1 ENDIF;
wO2NitrWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE O2PerNH4N1 * molO2molNN1 * wNNitrWHypN1 ENDIF;
kPMinDetSN1 = kDMinDetSN1;
kNMinDetSN1 = kDMinDetSN1;
kSiMinDetSN1 = kDMinDetSN1;
uFunTmMinSN1 = IF POW(cThetaMinSN1 , (uTmBotN1-cTmRefN1)) LT NearZeroN1 THEN 1 ELSE  POW(cThetaMinSN1 , (uTmBotN1-cTmRefN1)) ENDIF;
tDMinDetSN1 = kDMinDetSN1 * uFunTmMinSN1 * aDDetSN1;
tPMinDetSN1 = kPMinDetSN1 * uFunTmMinSN1 * aPDetSN1;
tNMinDetSN1 = kNMinDetSN1 * uFunTmMinSN1 * aNDetSN1;
tSiMinDetSN1 = kSiMinDetSN1 * uFunTmMinSN1 * aSiDetSN1;
uFunTmDifN1 = IF POW(cThetaDifN1 , (uTmEpiN1-cTmRefN1)) LT NearZeroN1 THEN 1 ELSE POW(cThetaDifN1 , (uTmEpiN1-cTmRefN1)) ENDIF;
akO2DifCorN1 = kO2DifN1 * uFunTmDifN1 * cTurbDifO2N1 * bPorCorSN1;
tSODN1 = (molO2molCN1 * cCPerDWN1 * (1.0 - fRefrDetSN1) * tDMinDetSN1 + O2PerNH4N1 * molO2molNN1 * kNitrSN1 * uFunTmNitrSN1 * aNH4SN1) / cDepthSN1;
aDepthDifN1 = fDepthDifSN1 * cDepthSN1;
tPDifPO4HypN1 = IF ( aInclStratN1 EQ TRUE ) THEN kPDifPO4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oPO4SN1 - oPO4WHypN1 ) / aDepthDifN1 ELSE 0.0 ENDIF ;
tNDifNO3HypN1 = IF ( aInclStratN1 EQ TRUE ) THEN kNDifNO3N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oNO3SN1 - oNO3WHypN1 ) / aDepthDifN1 ELSE 0.0 ENDIF ;
tNDifNH4HypN1 = IF ( aInclStratN1 EQ TRUE ) THEN kNDifNH4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oNH4SN1 - oNH4WHypN1 ) / aDepthDifN1 ELSE 0.0 ENDIF ;
tO2DifHypN1 = IF ( aInclStratN1 EQ TRUE ) THEN kO2DifN1 / aDepthDifN1 * uFunTmDifN1 * cTurbDifO2N1 * bPorCorSN1 * oO2WHypN1 ELSE 0.0 ENDIF ;
tPDifGroundPO4N1 = 0.0;
tNDifGroundNO3N1 = 0.0;
tNDifGroundNH4N1 = 0.0;
aPAdsMaxWHypN1 = cRelPAdsDN1 + aCorO2BODHypN1 * cRelPAdsFeN1 * fFeDIMN1 + cRelPAdsAlN1 * fAlDIMN1;
aKPAdsWHypN1 = (1.0 - fRedMaxN1 * (1.0-aCorO2BODHypN1)) * cKPAdsOxN1;
aPIsoAdsWHypN1 = aPAdsMaxWHypN1 * aKPAdsWHypN1 * oPO4WHypN1 / (1.0 + aKPAdsWHypN1 * oPO4WHypN1);
aPEqIMWHypN1 = aPIsoAdsWHypN1 * oDIMWHypN1;
wPSorpIMWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kPSorpN1 * (aPEqIMWHypN1 - oPAIMWHypN1) ENDIF;
tPChemPO4N1 = MAX( 0.0, kPChemPO4N1 * (oPO4SN1 - coPO4MaxN1) );
uQEvPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN uQEvN1 ELSE 0.0 ENDIF;
tPEvPO4WMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN uQEvPhraN1 / mmPermN1 * oPO4WMN1 ELSE 0.0 ENDIF;
tNEvNH4WMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN uQEvPhraN1 / mmPermN1 * oNH4WMN1 ELSE 0.0 ENDIF;
tNEvNO3WMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN uQEvPhraN1 / mmPermN1 * oNO3WMN1 ELSE 0.0 ENDIF;
tInfSiO2WMN1 = IF ((InclMarshN1 EQ FALSE) OR (fMarshN1 LE NearZeroN1)) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oSiO2WMN1 ELSE 0.0 ENDIF;
tInfO2WMN1 = IF ((InclMarshN1 EQ FALSE) OR (fMarshN1 LE NearZeroN1)) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oO2WMN1 ELSE 0.0 ENDIF;
tPInfPO4WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oPO4WMN1 ELSE 0.0 ENDIF;
tNInfNH4WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNH4WMN1 ELSE 0.0 ENDIF;
tNInfNO3WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNO3WMN1 ELSE 0.0 ENDIF;
tPInfPO4SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oPO4SMN1 ELSE 0.0 ENDIF;
tNInfNH4SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNH4SMN1 ELSE 0.0 ENDIF;
tNInfNO3SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNO3SMN1 ELSE 0.0 ENDIF;
tSeepSiO2WMN1 = IF ((InclMarshN1 EQ FALSE) OR (fMarshN1 LT NearZeroN1)) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WMN1 = IF ((InclMarshN1 EQ FALSE) OR (fMarshN1 LT NearZeroN1)) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oPO4SMN1 ELSE 0.0 ENDIF;
tNSeepNH4WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNH4SMN1 ELSE 0.0 ENDIF;
tNSeepNO3WMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNO3SMN1 ELSE 0.0 ENDIF;
tPSeepPO4SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cPO4GroundN1 ELSE 0.0 ENDIF;
tNSeepNH4SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cNH4GroundN1 ELSE 0.0 ENDIF;
tNSeepNO3SMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * cNO3GroundN1 ELSE 0.0 ENDIF;
tO2AerMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kAerN1 * uFunTmAerEpiN1 *(uO2SatEpiN1 - oO2WMN1) ELSE 0.0 ENDIF;
tDSetIMMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetIMN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oDIMWMN1 ELSE 0.0 ENDIF;
tPSetAIMMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetIMN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oPAIMWMN1 ELSE 0.0 ENDIF;
tDSetDetMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDetN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oDDetWMN1 ELSE 0.0 ENDIF;
tPSetDetMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDetN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oPDetWMN1 ELSE 0.0 ENDIF;
tNSetDetMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDetN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oNDetWMN1 ELSE 0.0 ENDIF;
tSiSetDetMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDetN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oSiDetWMN1 ELSE 0.0 ENDIF;
tDSetDiatMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ( cVSetDiatN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oDDiatWMN1 ELSE 0.0 ENDIF;
tPSetDiatMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDiatN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oPDiatWMN1 ELSE 0.0 ENDIF;
tNSetDiatMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ( cVSetDiatN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oNDiatWMN1 ELSE 0.0 ENDIF;
tSiSetDiatMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetDiatN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oSiDiatWMN1 ELSE 0.0 ENDIF;
tDSetGrenMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetGrenN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oDGrenWMN1 ELSE 0.0 ENDIF;
tPSetGrenMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetGrenN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oPGrenWMN1 ELSE 0.0 ENDIF;
tNSetGrenMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetGrenN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oNGrenWMN1 ELSE 0.0 ENDIF;
tDSetBlueMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1 * oDBlueWMN1 ELSE 0.0 ENDIF;
tPSetBlueMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1)* uFunTmSetEpiN1* oPBlueWMN1 ELSE 0.0 ENDIF;
tNSetBlueMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * uFunTmSetEpiN1* oNBlueWMN1 ELSE 0.0 ENDIF;
tDSetPhytMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDSetDiatMN1 + tDSetGrenMN1 + tDSetBlueMN1 ELSE 0.0 ENDIF;
tPSetPhytMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tPSetDiatMN1 + tPSetGrenMN1 + tPSetBlueMN1 ELSE 0.0 ENDIF;
tNSetPhytMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tNSetDiatMN1 + tNSetGrenMN1 + tNSetBlueMN1 ELSE 0.0 ENDIF;
tDSetTotMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDSetIMMN1 + tDSetDetMN1 + tDSetPhytMN1 ELSE 0.0 ENDIF;
wDMinDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMinDetWN1 * uFunTmMinWEpiN1 * oDDetWMN1 ELSE 0.0 ENDIF;
wPMinDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kPMinDetWN1 * uFunTmMinWEpiN1 * oPDetWMN1 ELSE 0.0 ENDIF;
wNMinDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kNMinDetWN1 * uFunTmMinWEpiN1 * oNDetWMN1 ELSE 0.0 ENDIF;
wSiMinDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kSiMinDetWN1 * uFunTmMinWEpiN1 * oSiDetWMN1 ELSE 0.0 ENDIF;
aCorO2BODMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oO2WMN1 /(hO2BODN1 + oO2WMN1) ELSE 0.0 ENDIF;
wO2MinDetWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN molO2molCN1 * cCPerDWN1 * aCorO2BODMN1 * wDMinDetWMN1 ELSE 0.0 ENDIF;
wDDenitWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNO3WMN1*oNO3WMN1 /(hNO3DenitN1*hNO3DenitN1 + oNO3WMN1*oNO3WMN1) *(1.0 - aCorO2BODMN1) * wDMinDetWMN1 ELSE 0.0 ENDIF;
wNDenitWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN NO3PerCN1 * molNmolCN1 * cCPerDWN1 * wDDenitWMN1 ELSE 0.0 ENDIF;
aCorO2NitrWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oO2WMN1 * oO2WMN1 /(hO2NitrN1 * hO2NitrN1 + oO2WMN1 * oO2WMN1) ELSE 0.0 ENDIF;
wNNitrWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kNitrWN1 * uFunTmNitrEpiN1 * aCorO2NitrWMN1 * oNH4WMN1 ELSE 0.0 ENDIF;
wO2NitrWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN O2PerNH4N1 * molO2molNN1 * wNNitrWMN1 ELSE 0.0 ENDIF;
tDMinDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMinDetSN1 * uFunTmMinSN1 * aDDetSMN1 ELSE 0.0 ENDIF;
tPMinDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kPMinDetSN1 * uFunTmMinSN1 * aPDetSMN1 ELSE 0.0 ENDIF;
tNMinDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kNMinDetSN1 * uFunTmMinSN1 * aNDetSMN1 ELSE 0.0 ENDIF;
tSiMinDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kSiMinDetSN1 * uFunTmMinSN1 * aSiDetSMN1 ELSE 0.0 ENDIF;
akO2DifCorMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kO2DifN1 * uFunTmDifN1 * cTurbDifO2N1 * bPorCorSMN1 ELSE 0.0 ENDIF;
tSODMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN(molO2molCN1 * cCPerDWN1 *(1.0 - fRefrDetSN1) * tDMinDetSMN1 + O2PerNH4N1 * molO2molNN1 * kNitrSN1 * uFunTmNitrEpiN1 * aNH4SMN1) / cDepthSMN1 ELSE 0.0 ENDIF;
aDepthOxySedMN1 = IF (InclMarshN1 EQ FALSE OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF POW((2.0 * oO2WMN1 * akO2DifCorMN1 / tSODMN1) , (0.5)) LE NearZeroN1 THEN 1 ELSE POW((2.0 * oO2WMN1 * akO2DifCorMN1 / tSODMN1) , (0.5)) ENDIF ;
afOxySedMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDepthOxySedMN1 / cDepthSMN1 ELSE 0.0 ENDIF;
tDMinOxyDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN afOxySedMN1 *(1.0 - fRefrDetSN1) * tDMinDetSMN1 ELSE 0.0 ENDIF;
tO2MinDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN molO2molCN1 * cCPerDWN1 * tDMinOxyDetSMN1 ELSE 0.0 ENDIF;
tDDenitSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN oNO3SMN1*oNO3SMN1 /(hNO3DenitN1*hNO3DenitN1 + oNO3SMN1*oNO3SMN1) *(1.0 - afOxySedMN1) *(1.0 - fRefrDetSN1) * tDMinDetSMN1 ELSE 0.0 ENDIF;
tNDenitSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN NO3PerCN1 * molNmolCN1 * cCPerDWN1 * tDDenitSMN1 ELSE 0.0 ENDIF;
tNNitrSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN afOxySedMN1 * kNitrSN1 * uFunTmNitrEpiN1 * aNH4SMN1 ELSE 0.0 ENDIF;
tO2NitrSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN O2PerNH4N1 * molO2molNN1 * tNNitrSMN1 ELSE 0.0 ENDIF;
tDMinHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMinHumN1 * uFunTmMinSN1 * afOxySedMN1 * aDHumSMN1 ELSE 0.0 ENDIF;
tPMinHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMinHumN1 * uFunTmMinSN1 * afOxySedMN1 * aPHumSMN1 ELSE 0.0 ENDIF;
tNMinHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMinHumN1 * uFunTmMinSN1 * afOxySedMN1 * aNHumSMN1 ELSE 0.0 ENDIF;
aDepthDifMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN fDepthDifSN1 * cDepthSMN1 ELSE 0.0 ENDIF;
tPDifPO4MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kPDifPO4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSMN1 * (oPO4SMN1 - oPO4WMN1) / aDepthDifMN1 ELSE 0.0 ENDIF;
tNDifNO3MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kNDifNO3N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSMN1 * (oNO3SMN1 - oNO3WMN1) / aDepthDifMN1 ELSE 0.0 ENDIF;
tNDifNH4MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kNDifNH4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSMN1 * (oNH4SMN1 - oNH4WMN1) / aDepthDifMN1 ELSE 0.0 ENDIF;
tO2DifMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kO2DifN1 / aDepthDifMN1 * uFunTmDifN1 * cTurbDifO2N1 * bPorCorSMN1 * oO2WMN1 ELSE 0.0 ENDIF;
tPDifGroundPO4MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNO3MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNH4MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN 0.0 ELSE 0.0 ENDIF;
aPAdsMaxWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cRelPAdsDN1 + aCorO2BODMN1 * cRelPAdsFeN1 * fFeDIMN1 + cRelPAdsAlN1 * fAlDIMN1 ELSE 0.0 ENDIF;
aKPAdsWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN(1.0 - fRedMaxN1 *(1.0-aCorO2BODMN1)) * cKPAdsOxN1 ELSE 0.0 ENDIF;
aPIsoAdsWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPAdsMaxWMN1 * aKPAdsWMN1 * oPO4WMN1 /(1.0 + aKPAdsWMN1 * oPO4WMN1) ELSE 0.0 ENDIF;
aPEqIMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPIsoAdsWMN1 * oDIMWMN1 ELSE 0.0 ENDIF;
wPSorpIMWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kPSorpN1 *(aPEqIMWMN1 - oPAIMWMN1) ELSE 0.0 ENDIF;
aPAdsMaxSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cRelPAdsDN1 + afOxySedMN1 * cRelPAdsFeN1 * fFeDIMN1 + cRelPAdsAlN1 * fAlDIMN1 ELSE 0.0 ENDIF;
aKPAdsSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN(1.0 - fRedMaxN1 *(1.0-afOxySedMN1)) * cKPAdsOxN1 ELSE 0.0 ENDIF;
aPIsoAdsSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPAdsMaxSMN1 * aKPAdsSMN1 * oPO4SMN1 /(1.0 + aKPAdsSMN1 * oPO4SMN1) ELSE 0.0 ENDIF;
aPEqIMSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPIsoAdsSMN1 * aDIMSMN1 ELSE 0.0 ENDIF;
tPSorpIMSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kPSorpN1 *(aPEqIMSMN1 - aPAIMSMN1) ELSE 0.0 ENDIF;
tPChemPO4MN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN MAX(0.0,kPChemPO4N1 *(oPO4SMN1 - coPO4MaxN1)) ELSE 0.0 ENDIF;
aDRootVegN1 = bfRootVegN1 * aDVegN1;
bfSubVegEpiN1 = bfSubVegN1 * ( uVegHeightEpiN1 / uDepthWN1 );
bfSubVegHypN1 = bfSubVegN1 * ( uVegHeightHypN1 / uDepthWN1 );
afCovSurfVegN1 = MIN(1.0, MAX(aDFloatVegN1 / (cDLayerVegN1 + NearZeroN1), aDEmergVegN1 / (fEmergVegN1 * cDCarrVegN1 + NearZeroN1) ) ) ;
afCovEmergVegN1 = MIN(1.0, PerCentN1 * cCovSpVegN1 * aDEmergVegN1);
aCovVegN1 = MIN(100.0, cCovSpVegN1 * aDShootVegN1);
aLPARBotHypN1 = uLPARSurfHypN1 * EXP(- aExtCoefHypN1 * uDepthWHypN1);
rPDVegN1 = aPVegN1 / (aDVegN1+NearZeroN1);
rNDVegN1 = aNVegN1 / (aDVegN1+NearZeroN1);
tDMigrVegN1 = kMigrVegN1 * (cDVegInN1 - aDVegN1);
tPMigrVegN1 = kMigrVegN1 * (cPDVeg0N1* cDVegInN1 - aPVegN1);
tNMigrVegN1 = kMigrVegN1 * (cNDVeg0N1* cDVegInN1 - aNVegN1);
uFunTmRespVegN1 = IF ( UseExpVegN1 GT NearZeroN1 ) THEN uFunTmVegN1 ELSE POW(cQ10RespVegN1 , (0.1 * (uTmVegAveN1 - cTmRefN1))) ENDIF;
afPUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN 0.0 ELSEIF (bfRootVegN1 LE NearZeroN1) THEN 0.0 ELSEIF (fFloatVegN1 + bfSubVegN1 LE NearZeroN1) THEN 1.0 ELSEIF (aInclStratN1 EQ TRUE AND ((oPO4SN1+NearZeroN1) / (oPO4WHypN1+NearZeroN1)) GT NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(((oPO4SN1+NearZeroN1) / (oPO4WHypN1+NearZeroN1)) , fSedUptVegExpN1)) ELSEIF (aInclStratN1 EQ TRUE AND ((oPO4SN1+NearZeroN1) / (oPO4WHypN1+NearZeroN1)) LE NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW( NearZeroN1 , fSedUptVegExpN1)) ELSEIF (((oPO4SN1+NearZeroN1) / (oPO4WEpiN1+NearZeroN1)) LE NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW (NearZeroN1 , fSedUptVegExpN1)) ELSE fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(((oPO4SN1+NearZeroN1) / (oPO4WEpiN1+NearZeroN1)) , fSedUptVegExpN1)) ENDIF;
afNUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN 0.0 ELSEIF (bfRootVegN1 LE NearZeroN1) THEN 0.0 ELSEIF (fFloatVegN1 + bfSubVegN1 LE NearZeroN1) THEN 1.0 ELSEIF ( aInclStratN1 EQ TRUE AND ((oNDissSN1+NearZeroN1) / (oNDissWHypN1+NearZeroN1)) GT NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(((oNDissSN1+NearZeroN1) / (oNDissWHypN1+NearZeroN1)) , fSedUptVegExpN1)) ELSEIF ( aInclStratN1 EQ TRUE AND ((oNDissSN1+NearZeroN1) / (oNDissWHypN1+NearZeroN1)) LE NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(NearZeroN1 , fSedUptVegExpN1)) ELSEIF ( ((oNDissSN1+NearZeroN1) / (oNDissWEpiN1+NearZeroN1)) LE NearZeroN1 ) THEN fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(NearZeroN1 , fSedUptVegExpN1)) ELSE fSedUptVegMaxN1 / (1.0 + fSedUptVegCoefN1 * POW(((oNDissSN1+NearZeroN1) / (oNDissWEpiN1+NearZeroN1)) , fSedUptVegExpN1)) ENDIF;
aVPUptMaxCrVegN1 = IF (FALSE EQ UseEmpUptN1) THEN MAX( 0.0, cVPUptMaxVegN1 * uFunTmProdVegN1 * (cPDVegMaxN1-rPDVegN1) / (cPDVegMaxN1-cPDVegMinN1) ) ELSE MAX( 0.0, cVPUptMaxVegN1 * uFunTmProdVegN1 * (cPDVegMaxN1-rPDVegN1) / (cPDVegMaxN1-cPDVegMinN1) ) ENDIF;
aVPUptVegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN oPO4WHypN1 * aVPUptMaxCrVegN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4WHypN1) ELSE 0.0 ENDIF;
aVPUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN oPO4SN1 * aVPUptMaxCrVegN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4SN1) ELSE 0.0 ENDIF;
aVPUptVegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN oPO4WEpiN1 * aVPUptMaxCrVegN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4WEpiN1) ELSE 0.0 ENDIF;
tPUptVegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN aVPUptVegWEpiN1 * (aDSubVegN1 + aDFloatVegN1) ELSE (1.0 - afPUptVegSN1) * aVPUptMaxCrVegN1 * oPO4WEpiN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4WEpiN1) * uDVegEpiN1 ENDIF;
tPUptVegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN aVPUptVegWHypN1 * (aDSubVegN1 + aDFloatVegN1) ELSE (1.0 - afPUptVegSN1) * aVPUptMaxCrVegN1 * oPO4WHypN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4WHypN1) * uDVegHypN1 ENDIF;
tPUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN aVPUptVegSN1 * aDRootVegN1 ELSE afPUptVegSN1 * aVPUptMaxCrVegN1 * oPO4SN1 / (aVPUptMaxCrVegN1 / cAffPUptVegN1 + oPO4SN1) * aDVegN1 ENDIF;
tPUptVegEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN tPUptVegWEpiN1 + tPUptVegSN1 * uDVegEpiN1 / aDVegN1 ELSEIF (aInclStratN1 EQ FALSE AND FALSE EQ UseEmpUptN1) THEN tPUptVegWEpiN1 + tPUptVegSN1 ELSE tPUptVegWEpiN1 + tPUptVegSN1 ENDIF;
tPUptVegHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN1) THEN tPUptVegWHypN1 + tPUptVegSN1 * uDVegHypN1 / aDVegN1 ELSE tPUptVegWHypN1 + tPUptVegSN1 * uDVegHypN1 / aDVegN1 ENDIF ;
aVNUptMaxCrVegN1 = IF (FALSE EQ UseEmpUptN1) THEN MAX( 0.0, cVNUptMaxVegN1 * uFunTmProdVegN1 * (cNDVegMaxN1 - rNDVegN1) / (cNDVegMaxN1 - cNDVegMinN1)) ELSE MAX( 0.0, cVNUptMaxVegN1 * uFunTmProdVegN1 * (cNDVegMaxN1 - rNDVegN1) / (cNDVegMaxN1 - cNDVegMinN1)) ENDIF;
ahNUptVegN1 = IF (FALSE EQ UseEmpUptN1) THEN aVNUptMaxCrVegN1 / cAffNUptVegN1 ELSE aVNUptMaxCrVegN1 / cAffNUptVegN1 ENDIF;
aVNUptVegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN oNDissWEpiN1 * aVNUptMaxCrVegN1 / (ahNUptVegN1 + oNDissWEpiN1) ELSE 0.0 ENDIF;
aVNUptVegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN oNDissWHypN1 * aVNUptMaxCrVegN1 / (ahNUptVegN1 + oNDissWHypN1) ELSE 0.0 ENDIF;
afNH4UptVegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN oNH4WEpiN1 * oNO3WEpiN1 / ((ahNUptVegN1 + oNH4WEpiN1) * (ahNUptVegN1 + oNO3WEpiN1 + NearZeroN1)) + oNH4WEpiN1 * ahNUptVegN1 / ((oNH4WEpiN1 + oNO3WEpiN1 + NearZeroN1) * (ahNUptVegN1 + oNO3WEpiN1 + NearZeroN1)) ELSE oNH4WEpiN1 * oNO3WEpiN1 / ((ahNUptVegN1 + oNH4WEpiN1) * (ahNUptVegN1 + oNO3WEpiN1 + NearZeroN1)) + oNH4WEpiN1 * ahNUptVegN1 / ((oNH4WEpiN1 + oNO3WEpiN1 + NearZeroN1) * (ahNUptVegN1 + oNO3WEpiN1 + NearZeroN1)) ENDIF;
afNH4UptVegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN oNH4WHypN1 * oNO3WHypN1 / ((ahNUptVegN1 + oNH4WHypN1) * (ahNUptVegN1 + oNO3WHypN1 + NearZeroN1)) + oNH4WHypN1 * ahNUptVegN1 / ((oNH4WHypN1 + oNO3WHypN1 + NearZeroN1) * (ahNUptVegN1 + oNO3WHypN1 + NearZeroN1)) ELSE oNH4WHypN1 * oNO3WHypN1 / ((ahNUptVegN1 + oNH4WHypN1) * (ahNUptVegN1 + oNO3WHypN1 + NearZeroN1)) + oNH4WHypN1 * ahNUptVegN1 / ((oNH4WHypN1 + oNO3WHypN1 + NearZeroN1) * (ahNUptVegN1 + oNO3WHypN1 + NearZeroN1)) ENDIF;
tNUptVegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN aVNUptVegWEpiN1 * (aDSubVegN1 + aDFloatVegN1) ELSE (1.0 - afNUptVegSN1) * aVNUptMaxCrVegN1 * oNDissWEpiN1 / (aVNUptMaxCrVegN1 / cAffNUptVegN1 + oNDissWEpiN1) * uDVegEpiN1 ENDIF;
tNUptVegWHypN1 = IF (FALSE EQ aInclStratN1) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN1) THEN aVNUptVegWHypN1 * (aDSubVegN1 + aDFloatVegN1) ELSE (1.0 - afNUptVegSN1) * aVNUptMaxCrVegN1 * oNDissWHypN1 / (aVNUptMaxCrVegN1 / cAffNUptVegN1 + oNDissWHypN1) * uDVegHypN1 ENDIF;
tNUptNH4VegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN afNH4UptVegWEpiN1 * tNUptVegWEpiN1 ELSE afNH4UptVegWEpiN1 * tNUptVegWEpiN1 ENDIF;
tNUptNO3VegWEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN tNUptVegWEpiN1 - tNUptNH4VegWEpiN1 ELSE tNUptVegWEpiN1 - tNUptNH4VegWEpiN1 ENDIF;
tNUptNH4VegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN afNH4UptVegWHypN1 * tNUptVegWHypN1 ELSE afNH4UptVegWHypN1 * tNUptVegWHypN1 ENDIF;
tNUptNO3VegWHypN1 = IF (FALSE EQ UseEmpUptN1) THEN tNUptVegWHypN1 - tNUptNH4VegWHypN1 ELSE tNUptVegWHypN1 - tNUptNH4VegWHypN1 ENDIF;
aVNUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN oNDissSN1 * aVNUptMaxCrVegN1 / (ahNUptVegN1 + oNDissSN1) ELSE 0.0 ENDIF;
tNUptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN aVNUptVegSN1 * aDRootVegN1 ELSE afNUptVegSN1 * aVNUptMaxCrVegN1 * oNDissSN1 / (aVNUptMaxCrVegN1 / cAffNUptVegN1 + oNDissSN1) * aDVegN1 ENDIF;
afNH4UptVegSN1 = IF (FALSE EQ UseEmpUptN1) THEN oNH4SN1 * oNO3SN1 / ((ahNUptVegN1 + oNH4SN1 +NearZeroN1) * (ahNUptVegN1 + oNO3SN1 +NearZeroN1)) + oNH4SN1 * ahNUptVegN1 / ((oNH4SN1 + oNO3SN1+NearZeroN1) * (ahNUptVegN1 + oNO3SN1+NearZeroN1)) ELSE oNH4SN1 * oNO3SN1 / ((ahNUptVegN1 + oNH4SN1 +NearZeroN1) * (ahNUptVegN1 + oNO3SN1 +NearZeroN1)) + oNH4SN1 * ahNUptVegN1 / ((oNH4SN1 + oNO3SN1+NearZeroN1) * (ahNUptVegN1 + oNO3SN1+NearZeroN1)) ENDIF;
tNUptNH4VegSN1 = IF (FALSE EQ UseEmpUptN1) THEN afNH4UptVegSN1 * tNUptVegSN1 ELSE afNH4UptVegSN1 * tNUptVegSN1 ENDIF;
tNUptVegSEpiN1 = IF (FALSE EQ UseEmpUptN1) THEN aVNUptVegSN1 * aDRootVegN1 ELSE afNUptVegSN1 * aVNUptMaxCrVegN1 * oNDissSN1 / (aVNUptMaxCrVegN1 / cAffNUptVegN1 + oNDissSN1) * aDVegN1 ENDIF;
tNUptNO3VegSN1 = IF (FALSE EQ UseEmpUptN1) THEN tNUptVegSN1 - tNUptNH4VegSN1 ELSE tNUptVegSN1 - tNUptNH4VegSN1 ENDIF;
tNUptVegN1 =tNUptVegWEpiN1 + tNUptVegWHypN1 + tNUptVegSN1;
aLLimShootVegEpiN1 = fEmergVegN1 + fFloatVegN1 * (1.0 - afCovEmergVegN1) + bfSubVegEpiN1 * (1.0 - afCovSurfVegN1) * 1.0 / (aExtCoefEpiN1 * uDepthWEpiN1) * LN( (1.0 + aLPAR1VegEpiN1 / uhLVegN1) / (1.0 + aLPAR2VegEpiN1 / uhLVegN1));
aLLimShootVegHypN1 = fEmergVegN1 + fFloatVegN1 * (1.0 - afCovEmergVegN1) + bfSubVegHypN1 * (1.0 - afCovSurfVegN1) * 1.0 / (aExtCoefHypN1 * uDepthWHypN1) * LN( (1.0 + aLPAR1VegHypN1 / uhLVegN1) / (1.0 + aLPAR2VegHypN1 / uhLVegN1));
aMuTmLVegHypN1 = ufDayN1 * bfShootVegN1 * aLLimShootVegHypN1 * uFunTmProdVegN1 * cMuMaxVegN1;
aPLimVegN1 = MAX(0.0, (1.0 - cPDVegMinN1 / rPDVegN1) * cPDVegMaxN1 / (cPDVegMaxN1 - cPDVegMinN1) );
aNLimVegN1 = MAX(0.0, (1.0 - cNDVegMinN1 / rNDVegN1) * cNDVegMaxN1 / (cNDVegMaxN1 - cNDVegMinN1) );
aNutLimVegN1 = MIN( aPLimVegN1, aNLimVegN1);
aMuVegHypN1 = aMuTmLVegHypN1 * aNutLimVegN1;
bkMortVegN1 = IF (FALSE EQ InclSeasonN1) THEN kMortVegSumN1 ELSEIF (aVegWinN1 EQ TRUE AND aDaysVegWinN1 LE cLengMortN1 AND aDaysVegWinN1 GT 0) THEN - LN(fWinVegN1) / cLengMortN1 ELSE kMortVegSumN1 ENDIF;
akDIncrVegHypN1 = aMuTmLVegHypN1 - kDRespVegN1 * uFunTmRespVegN1 - bkMortVegN1;
tDEnvVegHypN1 = MAX(0.0, akDIncrVegHypN1 / (cDCarrVegN1+NearZeroN1) * aDVegN1*aDVegN1);
tDEnvProdVegHypN1 = aMuVegHypN1 / cMuMaxVegN1 * tDEnvVegHypN1;
tDProdVegHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE MAX(0.0, aMuVegHypN1 * uDVegHypN1 - tDEnvProdVegHypN1) ENDIF;
tDProdSubVegHypN1 = bfSubVegHypN1 * tDProdVegHypN1;
tDRespVegN1 = kDRespVegN1 * uFunTmRespVegN1 * aDVegN1;
tDEnvMortVegHypN1 = tDEnvVegHypN1 - tDEnvProdVegHypN1;
tDMortVegHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE bkMortVegN1 * uDVegHypN1 + tDEnvMortVegHypN1 ENDIF;
tDMortVegWHypN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tDMortVegHypN1;
tDGrazVegBirdN1 = IF ( (sTimeN1 GE cYearStartBirdsN1 * DaysPerYearN1) AND (DayN1 GE cDayStartBirdsN1) AND (DayN1 LE cDayEndBirdsN1) ) THEN cPrefVegBirdN1 * aDVegN1 / (hDVegBirdN1 + aDVegN1) * cBirdsPerhaN1 / m2PerhaN1 * cDGrazPerBirdN1 ELSE 0.0 ENDIF;
bkManVegN1 = IF ((DayN1 GE cDayManVeg1N1 AND DayN1 LT cDayManVeg1N1 + cLengManN1) OR (DayN1 GE cDayManVeg2N1 AND DayN1 LT cDayManVeg2N1 + cLengManN1)) THEN -LN(1.0 - fManVegN1) / cLengManN1 ELSE 0.0 ENDIF;
tDManVegN1 = bkManVegN1 * aDVegN1;
tPManVegN1 = rPDVegN1 * tDManVegN1;
tNManVegN1 = rNDVegN1 * tDManVegN1;
tO2ProdVegHypN1 = molO2molCN1 * cCPerDWN1 * tDProdVegHypN1;
tO2RespVegWHypN1 = molO2molCN1 * cCPerDWN1 * bfSubVegHypN1 * tDRespVegN1 * aCorO2BODHypN1;
aDepthOxySedN1 = IF(aInclStratN1 EQ TRUE AND (2.0 * oO2WHypN1 * akO2DifCorN1 / tSODN1) GT NearZeroN1 ) THEN POW((2.0 * oO2WHypN1 * akO2DifCorN1 / tSODN1) , (0.5)) ELSEIF ( aInclStratN1 EQ TRUE AND (2.0 * oO2WHypN1 * akO2DifCorN1 / tSODN1) LE NearZeroN1 ) THEN POW ( NearZeroN1 , (0.5)) ELSEIF ( aInclStratN1 EQ TRUE AND ( 2.0 * oO2WEpiN1 * akO2DifCorN1 / tSODN1 ) LE NearZeroN1 ) THEN POW ( NearZeroN1 , (0.5)) ELSE POW ( ( 2.0 * oO2WEpiN1 * akO2DifCorN1 / tSODN1 ) , (0.5)) ENDIF;
afOxySedN1 = aDepthOxySedN1 / cDepthSN1;
tO2RespVegSN1 = molO2molCN1 * cCPerDWN1 * bfRootVegN1 * tDRespVegN1 * afOxySedN1;
tO2ProdVegSHypN1 = MIN (tO2RespVegSN1, tO2ProdVegHypN1);
tO2ProdVegWHypN1 = MIN( tO2ProdVegHypN1 - tO2ProdVegSHypN1, bfSubVegN1 * tO2ProdVegHypN1);
tO2UptNO3VegWHypN1 = O2PerNO3N1 * molO2molNN1 * bfSubVegN1 * tNUptNO3VegWHypN1;
tO2UptNO3VegSN1 = O2PerNO3N1 * molO2molNN1 * tNUptNO3VegSN1;
tPExcrVegN1 = (rPDVegN1 *2.0)/ (cPDVegMaxN1 + rPDVegN1) * rPDVegN1 * tDRespVegN1;
tPExcrVegSN1 = bfRootVegN1 * tPExcrVegN1;
tPExcrVegWN1 = tPExcrVegN1 - tPExcrVegSN1;
tPMortVegHypN1 = rPDVegN1 * tDMortVegHypN1;
tPMortVegPO4HypN1 = fDissMortVegN1 * tPMortVegHypN1;
tPMortVegPO4SHypN1 = bfRootVegN1 * tPMortVegPO4HypN1;
tPMortVegPO4WHypN1 = tPMortVegPO4HypN1 - tPMortVegPO4SHypN1;
tPMortVegDetHypN1 = tPMortVegHypN1 - tPMortVegPO4HypN1;
tPMortVegDetWHypN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tPMortVegDetHypN1;
tPMortVegDetSHypN1 = tPMortVegDetHypN1 - tPMortVegDetWHypN1;
tPGrazVegBirdN1 = rPDVegN1 * tDGrazVegBirdN1;
tNExcrVegN1 = (2.0 * rNDVegN1) / (cNDVegMaxN1 + rNDVegN1) * rNDVegN1 * tDRespVegN1;
tNExcrVegSN1 = bfRootVegN1 * tNExcrVegN1;
tNExcrVegWN1 = tNExcrVegN1 - tNExcrVegSN1;
tNMortVegHypN1 = rNDVegN1 * tDMortVegHypN1;
tNMortVegNH4HypN1 = fDissMortVegN1 * tNMortVegHypN1;
tNMortVegNH4SHypN1 = IF (aInclStratN1 EQ TRUE ) THEN bfRootVegN1 * tNMortVegNH4HypN1 ELSE 0.0 ENDIF;
tNMortVegNH4WHypN1 = tNMortVegNH4HypN1 - tNMortVegNH4SHypN1;
tNMortVegDetHypN1 = tNMortVegHypN1 - tNMortVegNH4HypN1;
tNMortVegDetWHypN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tNMortVegDetHypN1;
tNMortVegDetSHypN1 = tNMortVegDetHypN1 - tNMortVegDetWHypN1;
tNGrazVegBirdN1 = rNDVegN1 * tDGrazVegBirdN1;
tDAssVegBirdN1 = fDAssBirdN1 * tDGrazVegBirdN1;
tDEgesBirdN1 = tDGrazVegBirdN1 - tDAssVegBirdN1;
tPAssVegBirdN1 = fDAssBirdN1 * tPGrazVegBirdN1;
tPEgesBirdN1 = tPGrazVegBirdN1 - tPAssVegBirdN1;
tPEgesBirdPO4N1 = fDissEgesBirdN1 * tPEgesBirdN1;
tPEgesBirdDetN1 = tPEgesBirdN1 - tPEgesBirdPO4N1;
tNAssVegBirdN1 = fDAssBirdN1 * tNGrazVegBirdN1;
tNEgesBirdN1 = tNGrazVegBirdN1 - tNAssVegBirdN1;
tNEgesBirdNH4N1 = fDissEgesBirdN1 * tNEgesBirdN1;
tNEgesBirdDetN1 = tNEgesBirdN1 - tNEgesBirdNH4N1;
wDBedDetWHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE) THEN (tDMortVegWHypN1) / uDepthWHypN1 ELSE 0.0 ENDIF;
aMuTmLVegEpiN1 = ufDayN1 * bfShootVegN1 * aLLimShootVegEpiN1 * uFunTmProdVegN1 * cMuMaxVegN1;
akDIncrVegEpiN1 = aMuTmLVegEpiN1 - kDRespVegN1 * uFunTmRespVegN1 - bkMortVegN1;
tDEnvVegEpiN1 = MAX(0.0, akDIncrVegEpiN1 / (cDCarrVegN1+NearZeroN1) * aDVegN1*aDVegN1);
aMuVegEpiN1 = aMuTmLVegEpiN1 * aNutLimVegN1;
tDEnvProdVegEpiN1 = aMuVegEpiN1 / cMuMaxVegN1 * tDEnvVegEpiN1;
tDProdVegEpiN1 = MAX(0.0, aMuVegEpiN1 * uDVegEpiN1 - tDEnvProdVegEpiN1);
tDEnvMortVegEpiN1 = tDEnvVegEpiN1 - tDEnvProdVegEpiN1;
tDMortVegEpiN1 = bkMortVegN1 * uDVegEpiN1 + tDEnvMortVegEpiN1;
tNMortVegEpiN1 = rNDVegN1 * tDMortVegEpiN1;
tNMortVegNH4EpiN1 = fDissMortVegN1 * tNMortVegEpiN1;
tNMortVegNH4SEpiN1 = bfRootVegN1 * tNMortVegNH4EpiN1;
wPBedPO4WHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE ) THEN (- tPUptVegWHypN1 + tPExcrVegWN1 * uVegHeightHypN1 / uVegHeightN1 + tPMortVegPO4WHypN1 ) /uDepthWHypN1 ELSE 0.0 ENDIF;
wPBedDetWHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE) THEN (tPMortVegDetWHypN1 ) / uDepthWHypN1 ELSE 0.0 ENDIF;
wNBedNH4WHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE ) THEN (- tNUptNH4VegWHypN1 + tNExcrVegWN1 * (uVegHeightHypN1 /uVegHeightN1 ) + tNMortVegNH4WHypN1 ) / uDepthWHypN1 ELSE 0.0 ENDIF;
wNBedNO3WHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE) THEN - tNUptNO3VegWHypN1 / uDepthWHypN1 ELSE 0.0 ENDIF;
wNBedDetWHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE) THEN (tNMortVegDetWHypN1 ) / uDepthWHypN1 ELSE 0.0 ENDIF;
tDMortVegSHypN1 = tDMortVegHypN1 - tDMortVegWHypN1;
tDBedDetSHypN1 = IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE ) THEN tDMortVegSHypN1 ELSE 0.0 ENDIF;
tO2BedWHypN1 =IF (aInclStratN1 EQ TRUE AND InclVegN1 EQ TRUE ) THEN tO2ProdVegWHypN1 - tO2RespVegWHypN1 + tO2UptNO3VegWHypN1 ELSE 0.0 ENDIF;
UseLossN1 = IF (InclWebN1 EQ TRUE) THEN 0.0 ELSE 1.0 ENDIF;
uFunTmLossHypN1 = EXP(-0.5/(cSigTmLossN1*cSigTmLossN1) *((uTmHypN1-cTmOptLossN1)*(uTmHypN1-cTmOptLossN1) -(cTmRefN1-cTmOptLossN1)*(cTmRefN1-cTmOptLossN1)));
uFunTmLossEpiN1 = EXP(-0.5/(cSigTmLossN1*cSigTmLossN1) *((uTmEpiN1-cTmOptLossN1)*(uTmEpiN1-cTmOptLossN1) -(cTmRefN1-cTmOptLossN1)*(cTmRefN1-cTmOptLossN1)));
rPDBlueWHypN1 = oPBlueWHypN1 /(oDBlueWHypN1+NearZeroN1);
rNDBlueWHypN1 = oNBlueWHypN1 /(oDBlueWHypN1+NearZeroN1);
rPDBlueSN1 = aPBlueSN1 /(aDBlueSN1+NearZeroN1);
rNDBlueSN1 = aNBlueSN1 /(aDBlueSN1+NearZeroN1);
uFunTmBlueHypN1 = EXP(-0.5/(cSigTmBlueN1*cSigTmBlueN1) *((uTmHypN1-cTmOptBlueN1)*(uTmHypN1-cTmOptBlueN1) - (cTmRefN1-cTmOptBlueN1)*(cTmRefN1-cTmOptBlueN1)));
uFunTmProdBlueHypN1 = uFunTmBlueHypN1;
uFunTmRespBlueHypN1 = uFunTmBlueHypN1;
uFunTmBlueEpiN1 = EXP(-0.5/(cSigTmBlueN1*cSigTmBlueN1) *((uTmEpiN1-cTmOptBlueN1)*(uTmEpiN1-cTmOptBlueN1) - (cTmRefN1-cTmOptBlueN1)*(cTmRefN1-cTmOptBlueN1)));
uFunTmProdBlueEpiN1 = uFunTmBlueEpiN1;
uFunTmRespBlueEpiN1 = uFunTmBlueEpiN1;
uFunTmBlueSN1 = EXP(-0.5/(cSigTmBlueN1*cSigTmBlueN1) *((uTmBotN1-cTmOptBlueN1)*(uTmBotN1-cTmOptBlueN1) - (cTmRefN1-cTmOptBlueN1)*(cTmRefN1-cTmOptBlueN1)));
uFunTmRespBlueSN1 = uFunTmBlueSN1;
uFunTmBlueSurfN1 = EXP(-0.5/(cSigTmBlueN1*cSigTmBlueN1) *((uTmSurfN1-cTmOptBlueN1)*(uTmSurfN1-cTmOptBlueN1) - (cTmRefN1-cTmOptBlueN1)*(cTmRefN1-cTmOptBlueN1)));
uFunTmProdBlueSurfN1 = uFunTmBlueSurfN1;
uFunTmRespBlueSurfN1 = uFunTmBlueSurfN1;
aLPARAveSurfN1 = MAX(0.0,(uLPARSurfN1 - aLPARBotSurfN1)/aExtSurfN1);
aLPARAveEpiN1 = (aLPARBotSurfN1 - aLPARBotEpiN1)/ (aExtCoefOpenEpiN1 * uDepthWEpiN1);
aLPARAveHypN1 = (aLPARBotEpiOpenN1 -aLPARBotHypN1)/ (aExtCoefOpenHypN1 * uDepthWEpiN1);
aAuxNfixLSurfN1 = cAlphNfixN1 * aLPARAveSurfN1 ;
aAuxNfixLEpiN1 = cAlphNfixN1 * aLPARAveEpiN1;
aAuxNfixLHypN1 = cAlphNfixN1 * aLPARAveHypN1;
rNfixBlueSurfN1 = cNfixMaxBlueN1 - cNfixMaxBlueN1 * EXP(- aAuxNfixLSurfN1) + cNfixDarkBlueN1;
rNfixBlueEpiN1 = cNfixMaxBlueN1 - cNfixMaxBlueN1 * EXP(- aAuxNfixLEpiN1) + cNfixDarkBlueN1;
rNfixBlueHypN1 = cNfixMaxBlueN1 - cNfixMaxBlueN1 * EXP(- aAuxNfixLHypN1) + cNfixDarkBlueN1;
aVPUptMaxCrBlueHypN1 = MAX(0.0,cVPUptMaxBlueN1 * uFunTmProdBlueHypN1 *(cPDBlueMaxN1 - rPDBlueWHypN1) /(cPDBlueMaxN1 - cPDBlueMinN1));
aVPUptBlueHypN1 = oPO4WHypN1 * aVPUptMaxCrBlueHypN1 /(aVPUptMaxCrBlueHypN1 / cAffPUptBlueN1 + oPO4WHypN1);
wPUptBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVPUptBlueHypN1 * oDBlueWHypN1 ENDIF;
aVNUptMaxCrBlueHypN1 = MAX(0.0,cVNUptMaxBlueN1 * uFunTmProdBlueHypN1 * (cNDBlueMaxN1 - rNDBlueWHypN1) /(cNDBlueMaxN1 - cNDBlueMinN1));
ahNUptBlueHypN1 = aVNUptMaxCrBlueHypN1 / cAffNUptBlueN1;
aVNUptBlueHypN1 = oNDissWHypN1 * aVNUptMaxCrBlueHypN1 /(ahNUptBlueHypN1 + oNDissWHypN1);
wNUptBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVNUptBlueHypN1 * oDBlueWHypN1 ENDIF;
tNUptBlueHypN1 = wNUptBlueHypN1 * uDepthWHypN1;
afNH4UptBlueHypN1 = oNH4WHypN1 * oNO3WHypN1 /((ahNUptBlueHypN1 + oNH4WHypN1) *(ahNUptBlueHypN1 + oNO3WHypN1)) + oNH4WHypN1 * ahNUptBlueHypN1 /((oNH4WHypN1 + oNO3WHypN1) *(ahNUptBlueHypN1 + oNO3WHypN1));
uMuMaxTmBlueHypN1 = cMuMaxBlueN1 * uFunTmProdBlueHypN1;
uMuMaxTmBlueEpiN1 = cMuMaxBlueN1 * uFunTmProdBlueEpiN1;
aPLimBlueHypN1 = MAX(0.0,(1.0 - cPDBlueMinN1 / rPDBlueWHypN1) * cPDBlueMaxN1 /(cPDBlueMaxN1 - cPDBlueMinN1));
aNLimBlueHypN1 = MAX(0.0,(1.0 - cNDBlueMinN1 / rNDBlueWHypN1) * cNDBlueMaxN1 /(cNDBlueMaxN1 - cNDBlueMinN1));
aSiLimBlueHypN1 = oSiO2WHypN1 /(hSiAssBlueN1 + oSiO2WHypN1);
aLLimBlueHypN1 = UseSteeleBlueN1 *(EXP(1.0) /(aExtCoefHypN1 * uDepthWHypN1) *(EXP(- aLPARBotHypN1 /(cLOptRefBlueN1 * uFunTmProdBlueHypN1)) - EXP(- uLPARSurfHypN1 /(cLOptRefBlueN1 * uFunTmProdBlueHypN1)))) +(1.0 - UseSteeleBlueN1) *(1.0 /(aExtCoefHypN1 * uDepthWHypN1) * LN((1.0 + uLPARSurfHypN1 / (hLRefBlueN1 * uFunTmProdBlueHypN1)) / (1.0 + aLPARBotHypN1 /(hLRefBlueN1 * uFunTmProdBlueHypN1))));
aMuTmLBlueHypN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimBlueHypN1 * uMuMaxTmBlueHypN1;
aNutLimBlueHypN1 = MIN(aPLimBlueHypN1,(MIN(aNLimBlueHypN1,aSiLimBlueHypN1)));
aMuBlueHypN1 = aNutLimBlueHypN1 * aMuTmLBlueHypN1;
wDAssBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aMuBlueHypN1*oDBlueWHypN1 ENDIF;
rChDBlueHypN1 = cChDBlueMaxN1 -(cChDBlueMaxN1 - cChDBlueMinN1) * aLLimBlueHypN1;
oChlaBlueHypN1 = mgPergN1 * rChDBlueHypN1 * oDBlueWHypN1;
aChlaBlueHypN1 = mgPergN1 * rChDBlueHypN1 * aDBlueWHypN1;
aExtChBlueHypN1 = cExtSpBlueN1 / rChDBlueHypN1;
aNfixBlueHypN1  = rNfixBlueHypN1 *aChlaBlueHypN1 /ugPergN1;
tNUptBlueAirHypN1 = IF (InclNfixN1 EQ FALSE) THEN 0.0 ELSE aNfixBlueHypN1 ENDIF;
tNUptBlueWHypN1 = IF (InclNfixN1 EQ FALSE) THEN tNUptBlueHypN1 ELSE tNUptBlueHypN1 - tNUptBlueAirHypN1 ENDIF;
wNUptBlueWHypN1 = tNUptBlueWHypN1 / uDepthWHypN1;
ukDRespTmBlueHypN1 = kDRespBlueN1 * uFunTmRespBlueHypN1;
wNUptNH4BlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE afNH4UptBlueHypN1 * wNUptBlueWHypN1 ENDIF;
wNUptNO3BlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptBlueWHypN1 - wNUptNH4BlueHypN1 ENDIF;
ukDRespTmBlueEpiN1 = kDRespBlueN1 * uFunTmRespBlueEpiN1;
ukDRespTmBlueSN1 = kDRespBlueN1 * uFunTmRespBlueSN1;
wDRespBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukDRespTmBlueHypN1 * oDBlueWHypN1 ENDIF;
ukDRespTmBlueSurfN1 = kDRespBlueN1 * uFunTmRespBlueSurfN1;
ukLossTmBlueHypN1 = UseLossN1 * kLossBlueN1 * uFunTmLossHypN1;
ukLossTmBlueEpiN1 = UseLossN1 * kLossBlueN1 * uFunTmLossEpiN1;
wDLossBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukLossTmBlueHypN1 * oDBlueWHypN1 ENDIF;
wDMortBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortBlueWN1 * oDBlueWHypN1 ENDIF;
uCorVSetBlueHypN1 = (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMHypN1 * uFunTmSetHypN1;
tDResusBlueN1 = aDBlueSN1 /(aDPhytSN1+NearZeroN1) * tDResusPhytTotN1;
tDRespBlueSN1 = ukDRespTmBlueSN1 * aDBlueSN1;
tDMortBlueSN1 = kMortBlueSN1 * aDBlueSN1;
ukDDecBlueHypN1 = ukDRespTmBlueHypN1 + ukLossTmBlueHypN1 + kMortBlueWN1 +(uCorVSetBlueHypN1 * uFunTmSetHypN1) / uDepthWHypN1;
wPExcrBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (rPDBlueWHypN1 * 2.0 )/(cPDBlueMaxN1 + rPDBlueWHypN1) * rPDBlueWHypN1 * wDRespBlueWHypN1 ENDIF;
wPLossBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN1 * wDLossBlueHypN1 ENDIF;
wPMortBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortBlueWN1 * oPBlueWHypN1 ENDIF;
tPResusBlueN1 = rPDBlueSN1 * tDResusBlueN1;
tPExcrBlueSN1 = (rPDBlueSN1 *2.0)/(cPDBlueMaxN1 + rPDBlueSN1) * rPDBlueSN1 * tDRespBlueSN1;
tPMortBlueSN1 = kMortBlueSN1 * aPBlueSN1;
wNExcrBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (rNDBlueWHypN1 *2.0)/(cNDBlueMaxN1 + rNDBlueWHypN1) * rNDBlueWHypN1 * wDRespBlueWHypN1 ENDIF;
wNLossBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN1 * wDLossBlueHypN1 ENDIF;
wNMortBlueWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortBlueWN1 * oNBlueWHypN1 ENDIF;
tNResusBlueN1 = rNDBlueSN1 * tDResusBlueN1;
tNExcrBlueSN1 = (2.0 * rNDBlueSN1) /(cNDBlueMaxN1 + rNDBlueSN1) * rNDBlueSN1 * tDRespBlueSN1;
tNMortBlueSN1 = kMortBlueSN1 * aNBlueSN1;
aFunTauSetOMEpiN1 = MIN(1.0 / POW(aFunDimSuspN1 +NearZeroN1 , (0.5)), 1.0);
aFunTauSetIMEpiN1 = aFunTauSetOMEpiN1;
uCorVSetBlueEpiN1 = (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMEpiN1 * uFunTmSetEpiN1;
rNDGrenWHypN1 = oNGrenWHypN1 /(oDGrenWHypN1+NearZeroN1);
rPDGrenSN1 = aPGrenSN1 /(aDGrenSN1+NearZeroN1);
rNDGrenSN1 = aNGrenSN1 /(aDGrenSN1+NearZeroN1);
uFunTmGrenHypN1 = EXP(-0.5/(cSigTmGrenN1*cSigTmGrenN1) *((uTmHypN1-cTmOptGrenN1)*(uTmHypN1-cTmOptGrenN1) - (cTmRefN1-cTmOptGrenN1)*(cTmRefN1-cTmOptGrenN1)));
uFunTmGrenEpiN1 = EXP(-0.5/(cSigTmGrenN1*cSigTmGrenN1) *((uTmEpiN1-cTmOptGrenN1)*(uTmEpiN1-cTmOptGrenN1) - (cTmRefN1-cTmOptGrenN1)*(cTmRefN1-cTmOptGrenN1)));
uFunTmGrenSN1 = EXP(-0.5/(cSigTmGrenN1*cSigTmGrenN1) *((uTmBotN1-cTmOptGrenN1)*(uTmBotN1-cTmOptGrenN1) - (cTmRefN1-cTmOptGrenN1)*(cTmRefN1-cTmOptGrenN1)));
uFunTmProdGrenHypN1 = uFunTmGrenHypN1;
uFunTmRespGrenHypN1 = uFunTmGrenHypN1;
uFunTmProdGrenEpiN1 = uFunTmGrenEpiN1;
uFunTmRespGrenEpiN1 = uFunTmGrenEpiN1;
uFunTmRespGrenSN1 = uFunTmGrenSN1;
aVNUptMaxCrGrenHypN1 = MAX(0.0,cVNUptMaxGrenN1 * uFunTmProdGrenHypN1 * (cNDGrenMaxN1 - rNDGrenWHypN1) /(cNDGrenMaxN1 - cNDGrenMinN1));
ahNUptGrenHypN1 = aVNUptMaxCrGrenHypN1 / cAffNUptGrenN1;
aVNUptGrenHypN1 = oNDissWHypN1 * aVNUptMaxCrGrenHypN1 /(ahNUptGrenHypN1 + oNDissWHypN1);
wNUptGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVNUptGrenHypN1 * oDGrenWHypN1 ENDIF;
afNH4UptGrenHypN1 = oNH4WHypN1 * oNO3WHypN1 /((ahNUptGrenHypN1 + oNH4WHypN1) *(ahNUptGrenHypN1 + oNO3WHypN1)) + oNH4WHypN1 * ahNUptGrenHypN1 /((oNH4WHypN1 + oNO3WHypN1) *(ahNUptGrenHypN1 + oNO3WHypN1));
wNUptNH4GrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE afNH4UptGrenHypN1 * wNUptGrenHypN1 ENDIF;
wNUptNO3GrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN1 - wNUptNH4GrenHypN1 ENDIF;
uMuMaxTmGrenHypN1 = cMuMaxGrenN1 * uFunTmProdGrenHypN1;
uMuMaxTmGrenEpiN1 = cMuMaxGrenN1 * uFunTmProdGrenEpiN1;
aNLimGrenHypN1 = MAX(0.0,(1.0 - cNDGrenMinN1 / rNDGrenWHypN1) * cNDGrenMaxN1 /(cNDGrenMaxN1 - cNDGrenMinN1));
aSiLimGrenHypN1 = oSiO2WHypN1 /(hSiAssGrenN1 + oSiO2WHypN1);
aLLimGrenHypN1 = UseSteeleGrenN1 *(EXP(1.0) /(aExtCoefHypN1 * uDepthWHypN1) *(EXP(- aLPARBotHypN1 /(cLOptRefGrenN1 * uFunTmProdGrenHypN1)) - EXP(- uLPARSurfHypN1 /(cLOptRefGrenN1 * uFunTmProdGrenHypN1)))) +(1.0 - UseSteeleGrenN1) *(1.0 /(aExtCoefHypN1 * uDepthWHypN1) * LN((1.0 + uLPARSurfHypN1 / (hLRefGrenN1 * uFunTmProdGrenHypN1)) / (1.0 + aLPARBotHypN1 /(hLRefGrenN1 * uFunTmProdGrenHypN1))));
aMuTmLGrenHypN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimGrenHypN1 * uMuMaxTmGrenHypN1;
rChDGrenHypN1 = cChDGrenMaxN1 -(cChDGrenMaxN1 - cChDGrenMinN1) * aLLimGrenHypN1;
oChlaGrenHypN1 = mgPergN1 * rChDGrenHypN1 * oDGrenWHypN1;
aExtChGrenHypN1 = cExtSpGrenN1 / rChDGrenHypN1;
ukDRespTmGrenHypN1 = kDRespGrenN1 * uFunTmRespGrenHypN1;
ukDRespTmGrenEpiN1 = kDRespGrenN1 * uFunTmRespGrenEpiN1;
ukDRespTmGrenSN1 = kDRespGrenN1 * uFunTmRespGrenSN1;
wDRespGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukDRespTmGrenHypN1 * oDGrenWHypN1 ENDIF;
ukLossTmGrenHypN1 = UseLossN1 * kLossGrenN1 * uFunTmLossHypN1;
ukLossTmGrenEpiN1 = UseLossN1 * kLossGrenN1 * uFunTmLossEpiN1;
wDLossGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukLossTmGrenHypN1 * oDGrenWHypN1 ENDIF;
wDMortGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortGrenWN1 * oDGrenWHypN1 ENDIF;
uCorVSetGrenHypN1 = (cVSetGrenN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMHypN1 * uFunTmSetHypN1;
tDSetGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE uCorVSetGrenHypN1 * oDGrenWHypN1 ENDIF;
tDResusGrenN1 = aDGrenSN1 /(aDPhytSN1+NearZeroN1) * tDResusPhytTotN1;
tDRespGrenSN1 = ukDRespTmGrenSN1 * aDGrenSN1;
tDMortGrenSN1 = kMortGrenSN1 * aDGrenSN1;
ukDDecGrenHypN1 = ukDRespTmGrenHypN1 + ukLossTmGrenHypN1 + kMortGrenWN1 +(uCorVSetGrenHypN1 * uFunTmSetHypN1) / uDepthWHypN1;
wPMortGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortGrenWN1 * oPGrenWHypN1 ENDIF;
tPResusGrenN1 = rPDGrenSN1 * tDResusGrenN1;
tPExcrGrenSN1 = (2.0 * rPDGrenSN1) /(cPDGrenMaxN1 + rPDGrenSN1) * rPDGrenSN1 * tDRespGrenSN1;
tPMortGrenSN1 = kMortGrenSN1 * aPGrenSN1;
wNExcrGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDGrenWHypN1) /(cNDGrenMaxN1 + rNDGrenWHypN1) * rNDGrenWHypN1 * wDRespGrenWHypN1 ENDIF;
wNLossGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN1 * wDLossGrenHypN1 ENDIF;
wNMortGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortGrenWN1 * oNGrenWHypN1 ENDIF;
tNSetGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN1 * tDSetGrenHypN1 ENDIF;
tNResusGrenN1 = rNDGrenSN1 * tDResusGrenN1;
tNExcrGrenSN1 = (2.0 * rNDGrenSN1) /(cNDGrenMaxN1 + rNDGrenSN1) * rNDGrenSN1 * tDRespGrenSN1;
tNMortGrenSN1 = kMortGrenSN1 * aNGrenSN1;
uCorVSetGrenEpiN1 = (cVSetGrenN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMEpiN1 * uFunTmSetEpiN1;
tDSetGrenEpiN1 = uCorVSetGrenEpiN1 * oDGrenWEpiN1;
rNDGrenWEpiN1 = oNGrenWEpiN1 /(oDGrenWEpiN1+NearZeroN1);
tNSetGrenEpiN1 = rNDGrenWEpiN1 * tDSetGrenEpiN1;
rPDGrenWEpiN1 = oPGrenWEpiN1 /(oDGrenWEpiN1+NearZeroN1);
tPSetGrenEpiN1 = rPDGrenWEpiN1 * tDSetGrenEpiN1;
wNPrimGrenWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN1 - wNExcrGrenWHypN1 - wNLossGrenHypN1 - wNMortGrenWHypN1 -(tNSetGrenHypN1 -tNSetGrenEpiN1 - tNResusGrenN1) / uDepthWHypN1 ENDIF;
rPDDiatWHypN1 = oPDiatWHypN1 /(oDDiatWHypN1+NearZeroN1);
rNDDiatWHypN1 = oNDiatWHypN1 /(oDDiatWHypN1+NearZeroN1);
rPDDiatSN1 = aPDiatSN1 /(aDDiatSN1+NearZeroN1);
uFunTmDiatHypN1 = EXP(-0.5/(cSigTmDiatN1*cSigTmDiatN1) *((uTmHypN1-cTmOptDiatN1)*(uTmHypN1-cTmOptDiatN1) - (cTmRefN1-cTmOptDiatN1)*(cTmRefN1-cTmOptDiatN1)));
rNDDiatSN1 = aNDiatSN1 /(aDDiatSN1+NearZeroN1);
uFunTmDiatEpiN1 = EXP(-0.5/(cSigTmDiatN1*cSigTmDiatN1) *((uTmEpiN1-cTmOptDiatN1)*(uTmEpiN1-cTmOptDiatN1) - (cTmRefN1-cTmOptDiatN1)*(cTmRefN1-cTmOptDiatN1)));
uFunTmDiatSN1 = EXP(-0.5/(cSigTmDiatN1*cSigTmDiatN1) *((uTmBotN1-cTmOptDiatN1)*(uTmBotN1-cTmOptDiatN1) - (cTmRefN1-cTmOptDiatN1)*(cTmRefN1-cTmOptDiatN1)));
uFunTmProdDiatHypN1 = uFunTmDiatHypN1;
uFunTmRespDiatHypN1 = uFunTmDiatHypN1;
uFunTmProdDiatEpiN1 = uFunTmDiatEpiN1;
uFunTmRespDiatEpiN1 = uFunTmDiatEpiN1;
uFunTmRespDiatSN1 = uFunTmDiatSN1;
aVPUptMaxCrDiatHypN1 = MAX(0.0,cVPUptMaxDiatN1 * uFunTmProdDiatHypN1 *(cPDDiatMaxN1 - rPDDiatWHypN1) /(cPDDiatMaxN1 - cPDDiatMinN1));
aVPUptDiatHypN1 = oPO4WHypN1 * aVPUptMaxCrDiatHypN1 /(aVPUptMaxCrDiatHypN1 / cAffPUptDiatN1 + oPO4WHypN1);
wPUptDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVPUptDiatHypN1 * oDDiatWHypN1 ENDIF;
aVNUptMaxCrDiatHypN1 = MAX(0.0,cVNUptMaxDiatN1 * uFunTmProdDiatHypN1 * (cNDDiatMaxN1 - rNDDiatWHypN1) /(cNDDiatMaxN1 - cNDDiatMinN1));
ahNUptDiatHypN1 = aVNUptMaxCrDiatHypN1 / cAffNUptDiatN1;
aVNUptDiatHypN1 = oNDissWHypN1 * aVNUptMaxCrDiatHypN1 /(ahNUptDiatHypN1 + oNDissWHypN1);
wNUptDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVNUptDiatHypN1 * oDDiatWHypN1 ENDIF;
afNH4UptDiatHypN1 = oNH4WHypN1 * oNO3WHypN1 /((ahNUptDiatHypN1 + oNH4WHypN1) *(ahNUptDiatHypN1 + oNO3WHypN1)) + oNH4WHypN1 * ahNUptDiatHypN1 /((oNH4WHypN1 + oNO3WHypN1) *(ahNUptDiatHypN1 + oNO3WHypN1));
wNUptNH4DiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE afNH4UptDiatHypN1 * wNUptDiatHypN1 ENDIF;
wNUptNO3DiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN1 - wNUptNH4DiatHypN1 ENDIF;
uMuMaxTmDiatHypN1 = cMuMaxDiatN1 * uFunTmProdDiatHypN1;
uMuMaxTmDiatEpiN1 = cMuMaxDiatN1 * uFunTmProdDiatEpiN1;
aPLimDiatHypN1 = MAX(0.0,(1.0 - cPDDiatMinN1 / rPDDiatWHypN1) * cPDDiatMaxN1 /(cPDDiatMaxN1 - cPDDiatMinN1));
aNLimDiatHypN1 = MAX(0.0,(1.0 - cNDDiatMinN1 / rNDDiatWHypN1) * cNDDiatMaxN1 /(cNDDiatMaxN1 - cNDDiatMinN1));
aSiLimDiatHypN1 = oSiO2WHypN1 /(hSiAssDiatN1 + oSiO2WHypN1);
aLLimDiatHypN1 = UseSteeleDiatN1 *(EXP(1.0) /(aExtCoefHypN1 * uDepthWHypN1) *(EXP(- aLPARBotHypN1 /(cLOptRefDiatN1 * uFunTmProdDiatHypN1)) - EXP(- uLPARSurfHypN1 /(cLOptRefDiatN1 * uFunTmProdDiatHypN1)))) +(1.0 - UseSteeleDiatN1) *(1.0 /(aExtCoefHypN1 * uDepthWHypN1) * LN((1.0 + uLPARSurfHypN1 / (hLRefDiatN1 * uFunTmProdDiatHypN1)) / (1.0 + aLPARBotHypN1 /(hLRefDiatN1 * uFunTmProdDiatHypN1))));
aMuTmLDiatHypN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimDiatHypN1 * uMuMaxTmDiatHypN1;
aNutLimDiatHypN1 = MIN(aPLimDiatHypN1,(MIN(aNLimDiatHypN1,aSiLimDiatHypN1)));
aMuDiatHypN1 = aNutLimDiatHypN1 * aMuTmLDiatHypN1;
wDAssDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aMuDiatHypN1*oDDiatWHypN1 ENDIF;
rChDDiatHypN1 = cChDDiatMaxN1 -(cChDDiatMaxN1 - cChDDiatMinN1) * aLLimDiatHypN1;
oChlaDiatHypN1 = mgPergN1 * rChDDiatHypN1 * oDDiatWHypN1;
aExtChDiatHypN1 = cExtSpDiatN1 / rChDDiatHypN1;
ukDRespTmDiatHypN1 = kDRespDiatN1 * uFunTmRespDiatHypN1;
ukDRespTmDiatEpiN1 = kDRespDiatN1 * uFunTmRespDiatEpiN1;
ukDRespTmDiatSN1 = kDRespDiatN1 * uFunTmRespDiatSN1;
wDRespDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukDRespTmDiatHypN1 * oDDiatWHypN1 ENDIF;
ukLossTmDiatHypN1 = UseLossN1 * kLossDiatN1 * uFunTmLossHypN1;
ukLossTmDiatEpiN1 = UseLossN1 * kLossDiatN1 * uFunTmLossEpiN1;
wDLossDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE ukLossTmDiatHypN1 * oDDiatWHypN1 ENDIF;
wDMortDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortDiatWN1 * oDDiatWHypN1 ENDIF;
uCorVSetDiatHypN1 = (cVSetDiatN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMHypN1 * uFunTmSetHypN1;
tDSetDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE uCorVSetDiatHypN1 * oDDiatWHypN1 ENDIF;
tDResusDiatN1 = aDDiatSN1 /(aDPhytSN1+NearZeroN1) * tDResusPhytTotN1;
tDRespDiatSN1 = ukDRespTmDiatSN1 * aDDiatSN1;
tDMortDiatSN1 = kMortDiatSN1 * aDDiatSN1;
ukDDecDiatHypN1 = ukDRespTmDiatHypN1 + ukLossTmDiatHypN1 + kMortDiatWN1 +(uCorVSetDiatHypN1 * uFunTmSetHypN1) / uDepthWHypN1;
wPExcrDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (2.0 * rPDDiatWHypN1) /(cPDDiatMaxN1 + rPDDiatWHypN1) * rPDDiatWHypN1 * wDRespDiatWHypN1 ENDIF;
wPLossDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN1 * wDLossDiatHypN1 ENDIF;
wPMortDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortDiatWN1 * oPDiatWHypN1 ENDIF;
tPSetDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN1 * tDSetDiatHypN1 ENDIF;
tPResusDiatN1 = rPDDiatSN1 * tDResusDiatN1;
tPExcrDiatSN1 = (2.0 * rPDDiatSN1) /(cPDDiatMaxN1 + rPDDiatSN1) * rPDDiatSN1 * tDRespDiatSN1;
tPMortDiatSN1 = kMortDiatSN1 * aPDiatSN1;
wNExcrDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDDiatWHypN1) /(cNDDiatMaxN1 + rNDDiatWHypN1) * rNDDiatWHypN1 * wDRespDiatWHypN1 ENDIF;
wNLossDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN1 * wDLossDiatHypN1 ENDIF;
wNMortDiatWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortDiatWN1 * oNDiatWHypN1 ENDIF;
tNSetDiatHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN1 * tDSetDiatHypN1 ENDIF;
tNResusDiatN1 = rNDDiatSN1 * tDResusDiatN1;
tNExcrDiatSN1 = (2.0 * rNDDiatSN1) /(cNDDiatMaxN1 + rNDDiatSN1) * rNDDiatSN1 * tDRespDiatSN1;
tNMortDiatSN1 = kMortDiatSN1 * aNDiatSN1;
uCorVSetDiatEpiN1 = (cVSetDiatN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1)  * aFunTauSetOMEpiN1 * uFunTmSetEpiN1;
tDSetDiatEpiN1 = uCorVSetDiatEpiN1 * oDDiatWEpiN1;
rPDDiatWEpiN1 = oPDiatWEpiN1 /(oDDiatWEpiN1+NearZeroN1);
tPSetDiatEpiN1 = rPDDiatWEpiN1 * tDSetDiatEpiN1;
rNDDiatWEpiN1 = oNDiatWEpiN1 /(oDDiatWEpiN1+NearZeroN1);
tNSetDiatEpiN1 = rNDDiatWEpiN1 * tDSetDiatEpiN1;
wDPrimDiatWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wDAssDiatHypN1 - wDRespDiatWHypN1 - wDLossDiatHypN1 - wDMortDiatWHypN1 -(tDSetDiatHypN1 - tDSetDiatEpiN1 - tDResusDiatN1) / uDepthWHypN1 ENDIF;
wPPrimDiatWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wPUptDiatHypN1 - wPExcrDiatWHypN1 - wPLossDiatHypN1 - wPMortDiatWHypN1 -(tPSetDiatHypN1 -tPSetDiatEpiN1 - tPResusDiatN1) / uDepthWHypN1 ENDIF;
wNPrimDiatWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN1 - wNExcrDiatWHypN1 - wNLossDiatHypN1 - wNMortDiatWHypN1 -(tNSetDiatHypN1 - tNSetDiatEpiN1 - tNResusDiatN1) / uDepthWHypN1 ENDIF;
oChlaHypN1 = oChlaDiatHypN1 + oChlaGrenHypN1 + oChlaBlueHypN1;
wDRespPhytWHypN1 = wDRespDiatWHypN1 + wDRespGrenWHypN1 + wDRespBlueWHypN1;
wDMortPhytWHypN1 = wDMortDiatWHypN1 + wDMortGrenWHypN1 + wDMortBlueWHypN1;
wDLossPhytHypN1 = wDLossDiatHypN1 + wDLossGrenHypN1 + wDLossBlueHypN1;
wPMortPhytWHypN1 = wPMortDiatWHypN1 + wPMortGrenWHypN1 + wPMortBlueWHypN1;
tPResusPhytN1 = tPResusDiatN1 + tPResusGrenN1 + tPResusBlueN1;
wNUptPhytHypN1 = wNUptDiatHypN1 + wNUptGrenHypN1 + wNUptBlueHypN1;
wNUptNH4PhytHypN1 = wNUptNH4DiatHypN1 + wNUptNH4GrenHypN1 + wNUptNH4BlueHypN1;
wNUptNO3PhytHypN1 = wNUptNO3DiatHypN1 + wNUptNO3GrenHypN1 + wNUptNO3BlueHypN1;
wNExcrPhytWHypN1 = wNExcrDiatWHypN1 + wNExcrGrenWHypN1 + wNExcrBlueWHypN1;
wNMortPhytWHypN1 = wNMortDiatWHypN1 + wNMortGrenWHypN1 + wNMortBlueWHypN1;
tNResusPhytN1 = tNResusDiatN1 + tNResusGrenN1 + tNResusBlueN1;
wNLossPhytHypN1 = wNLossDiatHypN1 + wNLossGrenHypN1 + wNLossBlueHypN1;
tDRespPhytSN1 = tDRespDiatSN1 + tDRespGrenSN1 + tDRespBlueSN1;
tDMortPhytSN1 = tDMortDiatSN1 + tDMortGrenSN1 + tDMortBlueSN1;
tPExcrPhytSN1 = tPExcrDiatSN1 + tPExcrGrenSN1 + tPExcrBlueSN1;
tPMortPhytSN1 = tPMortDiatSN1 + tPMortGrenSN1 + tPMortBlueSN1;
tNExcrPhytSN1 = tNExcrDiatSN1 + tNExcrGrenSN1 + tNExcrBlueSN1;
tNMortPhytSN1 = tNMortDiatSN1 + tNMortGrenSN1 + tNMortBlueSN1;
wSiUptDiatHypN1 = cSiDDiatN1 * wDAssDiatHypN1;
wSiExcrDiatWHypN1 = cSiDDiatN1 * wDRespDiatWHypN1 ;
wSiLossDiatHypN1 = cSiDDiatN1 * wDLossDiatHypN1;
wSiMortDiatWHypN1 = cSiDDiatN1 * wDMortDiatWHypN1;
tSiSetDiatHypN1 = cSiDDiatN1 * tDSetDiatHypN1;
tSiResusDiatN1 = cSiDDiatN1 * tDResusDiatN1 ;
rCyDBlueHypN1 = cCyDBlueMaxN1 -(cCyDBlueMaxN1 - cCyDBlueMinN1) * aLLimBlueHypN1;
oCyanHypN1 = rCyDBlueHypN1 * oDBlueWHypN1 * mgPergN1;
fDDiatHypN1 = oDDiatWHypN1 /(oDDiatWHypN1 + oDGrenWHypN1 + oDBlueWHypN1 + NearZeroN1);
wDPrimDetWHypN1 = wDMortPhytWHypN1 + wDLossPhytHypN1;
wO2RespPhytWHypN1 = molO2molCN1 * cCPerDWN1 * wDRespPhytWHypN1 * aCorO2BODHypN1;
wO2UptNO3PhytHypN1 = O2PerNO3N1 * molO2molNN1 * wNUptNO3PhytHypN1;
wPMortPhytPO4WHypN1 = fDissMortPhytN1 * wPMortPhytWHypN1;
wPMortPhytDetWHypN1 = wPMortPhytWHypN1 - wPMortPhytPO4WHypN1;
tPMortPhytPO4SN1 = fDissMortPhytN1 * tPMortPhytSN1;
tPMortPhytDetSN1 = tPMortPhytSN1 - tPMortPhytPO4SN1;
tPPrimPO4SN1 = tPExcrPhytSN1 + tPMortPhytPO4SN1;
tPPrimTotTN1 = 0.0;
wNMortPhytNH4WHypN1 = fDissMortPhytN1 * wNMortPhytWHypN1;
wNMortPhytDetWHypN1 = wNMortPhytWHypN1 - wNMortPhytNH4WHypN1;
wNLossPhytNH4HypN1 = fDissLossN1 * wNLossPhytHypN1;
wNLossPhytDetHypN1 = wNLossPhytHypN1 - wNLossPhytNH4HypN1;
wNPrimNH4WHypN1 = - wNUptNH4PhytHypN1 + wNExcrPhytWHypN1 + wNLossPhytNH4HypN1 + wNMortPhytNH4WHypN1;
wNPrimNO3WHypN1 = - wNUptNO3PhytHypN1;
wNPrimDetWHypN1 = wNLossPhytDetHypN1 + wNMortPhytDetWHypN1;
tNMortPhytNH4SN1 = fDissMortPhytN1 * tNMortPhytSN1;
tNMortPhytDetSN1 = tNMortPhytSN1 - tNMortPhytNH4SN1;
tNPrimNH4SN1 = tNExcrPhytSN1 + tNMortPhytNH4SN1;
tNPrimNO3SN1 = 0.0;
tNPrimTotTN1 = 0.0;
tSiExcrDiatSN1 = cSiDDiatN1 * tDRespDiatSN1 ;
tSiMortDiatSN1 = cSiDDiatN1 * tDMortDiatSN1;
wSiPrimSiO2WHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wSiExcrDiatWHypN1 - wSiUptDiatHypN1 + tSiExcrDiatSN1 / uDepthWHypN1 ENDIF;
wSiPrimDetWHypN1 = wSiMortDiatWHypN1 + wSiLossDiatHypN1;
tSiPrimTotTN1 = 0.0;
aPACoefEpiN1 = cPACoefMinN1 +(cPACoefMaxN1 - cPACoefMinN1) * hPACoefN1 / (hPACoefN1 + oDOMWEpiN1);
aPACoefHypN1 = cPACoefMinN1 +(cPACoefMaxN1 - cPACoefMinN1) * hPACoefN1 / (hPACoefN1 + oDOMWHypN1);
bSecchiMaxEpiN1 = uDepthWEpiN1;
aSecchiEpiN1 = MIN(bSecchiMaxEpiN1,aPACoefEpiN1 / aExtCoefOpenEpiN1);
aTransparencyEpiN1 = aSecchiEpiN1 / uDepthWEpiN1;
bSecchiMaxHypN1 = uDepthWHypN1 + cSecchiPlusN1;
aSecchiHypN1 = IF ( aInclStratN1 EQ TRUE AND uDepthWEpiN1 LE aPACoefEpiN1 / aExtCoefOpenEpiN1 ) THEN MIN(bSecchiMaxHypN1,aPACoefHypN1 / aExtCoefOpenHypN1 - aSecchiEpiN1) ELSEIF ( aInclStratN1 EQ TRUE AND uDepthWEpiN1 GT aPACoefEpiN1 / aExtCoefOpenEpiN1) THEN 0.0 ELSE MIN(bSecchiMaxHypN1,aPACoefHypN1 / aExtCoefOpenHypN1) ENDIF;
aSecchiTN1 = IF ( aInclStratN1 EQ TRUE ) THEN aSecchiEpiN1 +aSecchiHypN1 ELSE aSecchiEpiN1 ENDIF;
aTransparencyHypN1 = aSecchiHypN1 / uDepthWHypN1;
aTransparencyTN1 = IF ( aInclStratN1 EQ TRUE ) THEN aSecchiTN1 / uDepthWN1 ELSE aSecchiTN1 / uDepthWHypN1 ENDIF;
aDepthEuphHypN1 = cEuphN1 * aSecchiHypN1;
aRelDepthEuphHypN1 = aDepthEuphHypN1 / uDepthWHypN1;
aChlaHHypN1 = oChlaHypN1 * uDepthWHypN1;
aCovPhytWHypN1 = cCovSpPhytN1 *(oDPhytWHypN1 * uDepthWHypN1);
rExtChPhytHypN1 = aExtPhytHypN1 /(oChlaHypN1 / mgPergN1 + NearZeroN1);
uFunTmZooHypN1 = EXP(-0.5/(cSigTmZooN1*cSigTmZooN1) *((uTmHypN1-cTmOptZooN1)*(uTmHypN1-cTmOptZooN1) -(cTmRefN1-cTmOptZooN1)*(cTmRefN1-cTmOptZooN1)));
uFunTmZooEpiN1 = EXP(-0.5/(cSigTmZooN1*cSigTmZooN1) *((uTmEpiN1-cTmOptZooN1)*(uTmEpiN1-cTmOptZooN1) -(cTmRefN1-cTmOptZooN1)*(cTmRefN1-cTmOptZooN1)));
rPDZooHypN1 = oPZooHypN1 /(oDZooHypN1+NearZeroN1);
rNDZooHypN1 = oNZooHypN1/(oDZooHypN1+NearZeroN1);
oDFoodZooHypN1 = cPrefDiatN1 * oDDiatWHypN1 + cPrefGrenN1 * oDGrenWHypN1 + cPrefBlueN1 * oDBlueWHypN1 + cPrefDetN1 * oDDetWHypN1;
aFiltHypN1 = cFiltMaxN1 * uFunTmZooHypN1 * hFiltN1 /(hFiltN1 + oDOMWHypN1);
ukDAssTmZooHypN1 = fDAssZooN1 * cFiltMaxN1 * uFunTmZooHypN1 * hFiltN1;
ukDAssTmZooEpiN1 = fDAssZooN1 * cFiltMaxN1 * uFunTmZooEpiN1 * hFiltN1;
aDSatZooHypN1 = oDFoodZooHypN1 /(hFiltN1 + oDOMWHypN1);
ukDRespTmZooHypN1 = kDRespZooN1 * uFunTmZooHypN1;
ukDRespTmZooEpiN1 = kDRespZooN1 * uFunTmZooEpiN1;
ukDIncrZooHypN1 = ukDAssTmZooHypN1 - ukDRespTmZooHypN1 - kMortZooN1;
ukDIncrZooEpiN1 = ukDAssTmZooEpiN1 - ukDRespTmZooEpiN1 - kMortZooN1;
wDEnvZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE MAX(0.0,ukDIncrZooHypN1 / cDCarrZooN1 * oDZooHypN1*oDZooHypN1) ENDIF;
wDAssZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aDSatZooHypN1 *(ukDAssTmZooHypN1 * oDZooHypN1 - wDEnvZooHypN1) ENDIF;
wDConsZooHypN1 = wDAssZooHypN1 / fDAssZooN1;
wDConsDetZooHypN1 = cPrefDetN1*oDDetWHypN1 / oDFoodZooHypN1 * wDConsZooHypN1;
wDConsDiatZooHypN1 = cPrefDiatN1*oDDiatWHypN1 / oDFoodZooHypN1 * wDConsZooHypN1;
wDConsGrenZooHypN1 = cPrefGrenN1*oDGrenWHypN1 / oDFoodZooHypN1 * wDConsZooHypN1;
wDConsBlueZooHypN1 = cPrefBlueN1*oDBlueWHypN1 / oDFoodZooHypN1 * wDConsZooHypN1;
wDConsPhytZooHypN1 = wDConsDiatZooHypN1 + wDConsGrenZooHypN1 + wDConsBlueZooHypN1;
wDEgesZooHypN1 = wDConsZooHypN1 - wDAssZooHypN1;
aCorDRespZooHypN1 = MAX(cPDZooRefN1 / rPDZooHypN1,cNDZooRefN1 / rNDZooHypN1);
wDRespZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aCorDRespZooHypN1 * ukDRespTmZooHypN1 * oDZooHypN1 ENDIF;
wDMortZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kMortZooN1 * oDZooHypN1 +(1.0 - aDSatZooHypN1) * wDEnvZooHypN1 ENDIF;
oPFoodZooHypN1 = cPrefDiatN1*oPDiatWHypN1 + cPrefGrenN1*oPGrenWHypN1 + cPrefBlueN1*oPBlueWHypN1 + cPrefDetN1 * oPDetWHypN1;
rPDFoodZooHypN1 = oPFoodZooHypN1 /(oDFoodZooHypN1+NearZeroN1);
wPConsDiatZooHypN1 = rPDDiatWHypN1 * wDConsDiatZooHypN1;
wPConsBlueZooHypN1 = rPDBlueWHypN1 * wDConsBlueZooHypN1;
wPConsDetZooHypN1 = rPDDetWHypN1 * wDConsDetZooHypN1;
afPAssZooHypN1 = MIN(1.0,cPDZooRefN1 / rPDFoodZooHypN1 * fDAssZooN1);
akPExcrZooHypN1 = rPDZooHypN1 / cPDZooRefN1 * kDRespZooN1 * uFunTmZooHypN1;
wPExcrZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE akPExcrZooHypN1*oPZooHypN1 ENDIF;
wPMortZooHypN1 = rPDZooHypN1 * wDMortZooHypN1;
wPMortZooPO4HypN1 = fDissMortZooN1 * wPMortZooHypN1;
wPMortZooDetHypN1 = wPMortZooHypN1 - wPMortZooPO4HypN1;
oNFoodZooHypN1 = cPrefDiatN1*oNDiatWHypN1 + cPrefGrenN1*oNGrenWHypN1 + cPrefBlueN1*oNBlueWHypN1 + cPrefDetN1*oNDetWHypN1;
rNDFoodZooHypN1 = oNFoodZooHypN1 /(oDFoodZooHypN1+NearZeroN1);
wNConsDiatZooHypN1 = rNDDiatWHypN1*wDConsDiatZooHypN1;
wNConsGrenZooHypN1 = rNDGrenWHypN1*wDConsGrenZooHypN1;
wNConsBlueZooHypN1 = rNDBlueWHypN1*wDConsBlueZooHypN1;
wNConsPhytZooHypN1 = wNConsDiatZooHypN1 + wNConsGrenZooHypN1 + wNConsBlueZooHypN1;
wNConsDetZooHypN1 = rNDDetWHypN1*wDConsDetZooHypN1;
wNConsZooHypN1 = wNConsPhytZooHypN1 + wNConsDetZooHypN1;
afNAssZooHypN1 = MIN(1.0,cNDZooRefN1 / rNDFoodZooHypN1 * fDAssZooN1);
wNAssZooHypN1 = afNAssZooHypN1*wNConsZooHypN1;
wNEgesZooHypN1 = wNConsZooHypN1 - wNAssZooHypN1;
wNEgesZooNH4HypN1 = fDissEgesZooN1*wNEgesZooHypN1;
wNEgesZooDetHypN1 = wNEgesZooHypN1 - wNEgesZooNH4HypN1;
kNExcrZooHypN1 = rNDZooHypN1 / cNDZooRefN1 * kDRespZooN1 * uFunTmZooHypN1;
wNExcrZooHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE kNExcrZooHypN1*oNZooHypN1 ENDIF;
wNMortZooHypN1 = rNDZooHypN1*wDMortZooHypN1;
wNMortZooNH4HypN1 = fDissMortZooN1*wNMortZooHypN1;
wNMortZooDetHypN1 = wNMortZooHypN1 - wNMortZooNH4HypN1;
wSiConsDiatZooHypN1 = cSiDDiatN1 * wDConsDiatZooHypN1;
uFunTmBentN1 = EXP(-0.5/(cSigTmBentN1*cSigTmBentN1) *((uTmBotN1-cTmOptBentN1)*(uTmBotN1-cTmOptBentN1) - (cTmRefN1-cTmOptBentN1)*(cTmRefN1-cTmOptBentN1)));
aDFoodBentN1 = aDDetSN1 + aDPhytSN1;
rPDBentN1 = aPBentN1 /(aDBentN1+NearZeroN1);
rNDBentN1 = aNBentN1 /(aDBentN1+NearZeroN1);
tDMigrBentN1 = kMigrBentN1 *(cDBentInN1 - aDBentN1);
aDSatBentN1 = aDFoodBentN1 /(hDFoodBentN1 + aDFoodBentN1);
ukDIncrBentN1 = (kDAssBentN1 - kDRespBentN1) * uFunTmBentN1 - kMortBentN1;
tDEnvBentN1 = MAX(0.0,ukDIncrBentN1 / cDCarrBentN1 * aDBentN1*aDBentN1);
tDAssBentN1 = aDSatBentN1 *(kDAssBentN1 * uFunTmBentN1 * aDBentN1 - tDEnvBentN1);
aDAssBentSpN1 = tDAssBentN1 / aDBentN1;
tDConsBentN1 = tDAssBentN1 / fDAssBentN1;
tDConsDetBentN1 = aDDetSN1 / aDFoodBentN1 * tDConsBentN1;
tDConsDiatBentN1 = aDDiatSN1 / aDFoodBentN1 * tDConsBentN1;
tDConsGrenBentN1 = aDGrenSN1 / aDFoodBentN1 * tDConsBentN1;
tDConsBlueBentN1 = aDBlueSN1 / aDFoodBentN1 * tDConsBentN1;
tDConsPhytBentN1 = tDConsDiatBentN1 + tDConsGrenBentN1 + tDConsBlueBentN1;
tDEgesBentN1 = tDConsBentN1 - tDAssBentN1;
tDRespBentN1 = (cPDBentRefN1 / rPDBentN1) * kDRespBentN1 * uFunTmBentN1 * aDBentN1;
tDMortBentN1 = kMortBentN1*aDBentN1 +(1.0 - aDSatBentN1) * tDEnvBentN1;
aPFoodBentN1 = aPDetSN1 + aPPhytSN1;
rPDFoodBentN1 = aPFoodBentN1 /(aDFoodBentN1+NearZeroN1);
tPConsDetBentN1 = rPDDetSN1 * tDConsDetBentN1;
tPConsDiatBentN1 = rPDDiatSN1 * tDConsDiatBentN1;
tPConsGrenBentN1 = rPDGrenSN1 * tDConsGrenBentN1;
tPConsBlueBentN1 = rPDBlueSN1 * tDConsBlueBentN1;
tPConsPhytBentN1 = tPConsDiatBentN1 + tPConsGrenBentN1 + tPConsBlueBentN1;
tPConsBentN1 = tPConsDetBentN1 + tPConsPhytBentN1;
afPAssBentN1 = MIN(1.0,cPDBentRefN1 / rPDFoodBentN1 * fDAssBentN1);
tPAssBentN1 = afPAssBentN1 * tPConsBentN1;
tPEgesBentN1 = tPConsBentN1 - tPAssBentN1;
tPEgesBentPO4N1 = fDissEgesBentN1 * tPEgesBentN1;
tPEgesBentDetN1 = (1.0 - fDissEgesBentN1) * tPEgesBentN1;
tPExcrBentN1 = (rPDBentN1 / cPDBentRefN1) * kDRespBentN1 * uFunTmBentN1 * aPBentN1;
tPMortBentN1 = rPDBentN1 * tDMortBentN1;
tPMortBentPO4N1 = fDissMortBentN1 * tPMortBentN1;
tPMortBentDetN1 = (1.0-fDissMortBentN1)*tPMortBentN1;
tPMigrBentN1 = kMigrBentN1 *(cPDBentRefN1*cDBentInN1 - aPBentN1);
aNFoodBentN1 = aNDetSN1 + aNPhytSN1;
rNDFoodBentN1 = aNFoodBentN1 /(aDFoodBentN1+NearZeroN1);
tNMigrBentN1 = kMigrBentN1 *(cNDBentRefN1*cDBentInN1 - aNBentN1);
tNConsDetBentN1 = rNDDetSN1 * tDConsDetBentN1;
tNConsDiatBentN1 = rNDDiatSN1 * tDConsDiatBentN1;
tNConsGrenBentN1 = rNDGrenSN1 * tDConsGrenBentN1;
tNConsBlueBentN1 = rNDBlueSN1 * tDConsBlueBentN1;
tNConsPhytBentN1 = tNConsDiatBentN1 + tNConsGrenBentN1 + tNConsBlueBentN1;
tNConsBentN1 = tNConsDetBentN1 + tNConsPhytBentN1;
afNAssBentN1 = MIN(1.0,cNDBentRefN1 / rNDFoodBentN1 * fDAssBentN1);
tNAssBentN1 = afNAssBentN1 * tNConsBentN1;
tNEgesBentN1 = tNConsBentN1 - tNAssBentN1;
tNEgesBentNH4N1 = fDissEgesBentN1 * tNEgesBentN1;
tNEgesBentDetN1 = (1.0 - fDissEgesBentN1) * tNEgesBentN1;
tNExcrBentN1 = (rNDBentN1 / cNDBentRefN1) * kDRespBentN1 * uFunTmBentN1 * aNBentN1;
tNMortBentN1 = rNDBentN1 * tDMortBentN1;
tNMortBentNH4N1 = fDissMortBentN1*tNMortBentN1;
tNMortBentDetN1 = (1.0-fDissMortBentN1)*tNMortBentN1;
tSiConsDiatBentN1 = cSiDDiatN1 * tDConsDiatBentN1;
aFunVegFishN1 = MAX(0.0,1.0 - cRelVegFishN1 * aCovVegN1);
ukDIncrFiJvN1 = (kDAssFiJvN1 - kDRespFiJvN1) * uFunTmFishN1 - kMortFiJvN1;
aDSatFiAdN1 = (aFunVegFishN1 * aDBentN1) *(aFunVegFishN1 * aDBentN1) /(hDBentFiAdN1 * hDBentFiAdN1 + (aFunVegFishN1 * aDBentN1) *(aFunVegFishN1 * aDBentN1));
ukDIncrFiAdN1 = (kDAssFiAdN1 - kDRespFiAdN1) * uFunTmFishN1 - kMortFiAdN1;
ukHarvFishN1 = IF (COS(2.0 * PiN1 * sTimeN1 / DaysInYearN1) GT 0.1) THEN kHarvFishWinN1 ELSE kHarvFishSumN1 ENDIF;
afPAssFiAdN1 = MIN(1.0,cPDFishRefN1 / rPDBentN1 * fDAssFiAdN1);
afNAssFiAdN1 = MIN(1.0,cNDFishRefN1 / rNDBentN1 * fDAssFiAdN1);
uFunTmPiscN1 = EXP(-0.5 /(cSigTmPiscN1*cSigTmPiscN1) *((uTmEpiN1 - cTmOptPiscN1)*(uTmEpiN1 - cTmOptPiscN1) - (cTmRefN1 - cTmOptPiscN1)*(cTmRefN1 - cTmOptPiscN1)));
aDCarrPiscN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN MAX(cDCarrPiscMinN1,MIN(cDCarrPiscMaxN1,cDCarrPiscBareN1)) ELSEIF (aDShootPhraN1 LT cDPhraMinPiscN1) THEN cDCarrPiscMinN1 ELSEIF (aCovVegN1 LT cCovVegMinN1) THEN MAX(cDCarrPiscMinN1,MIN(cDCarrPiscMaxN1,fMarshN1 *(1.0/PerCentN1) * cRelPhraPiscN1)) ELSE MAX(cDCarrPiscMinN1,MIN(cDCarrPiscMaxN1,fMarshN1 *(1.0/PerCentN1) *(cRelPhraPiscN1 + cRelVegPiscN1))) ENDIF;
aFunVegPiscN1 = aDSubVegN1 /(hDVegPiscN1 + aDSubVegN1 + NearZeroN1);
akDIncrPiscN1 = (kDAssPiscN1 * aFunVegPiscN1 - kDRespPiscN1) * uFunTmPiscN1 - kMortPiscN1;
ukHarvPiscN1 = IF (COS(2.0*PiN1 * sTimeN1 / DaysInYearN1) GT 0.1) THEN kHarvPiscWinN1 ELSE kHarvPiscSumN1 ENDIF;
tDWebDetSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tDConsDetBentN1 + tDEgesBentN1 + tDMortBentN1 ENDIF;
tDWebDiatSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tDConsDiatBentN1 ENDIF;
tDWebGrenSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tDConsGrenBentN1 ENDIF;
tDWebBlueSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tDConsBlueBentN1 ENDIF;
tDWebPhytSN1 = tDWebDiatSN1 + tDWebGrenSN1 + tDWebBlueSN1;
tPWebPO4SN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tPExcrBentN1 + tPEgesBentPO4N1 + tPMortBentPO4N1 ENDIF;
tPWebDetSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tPConsDetBentN1 + tPEgesBentDetN1 + tPMortBentDetN1 ENDIF;
tPWebDiatSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tPConsDiatBentN1 ENDIF;
tPWebGrenSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tPConsGrenBentN1 ENDIF;
tPWebBlueSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tPConsBlueBentN1 ENDIF;
tPWebPhytSN1 = tPWebDiatSN1 + tPWebGrenSN1 + tPWebBlueSN1;
tNWebNH4SN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tNExcrBentN1 + tNEgesBentNH4N1 + tNMortBentNH4N1 ENDIF;
tNWebNO3SN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE 0.0 ENDIF;
tNWebDetSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tNConsDetBentN1 + tNEgesBentDetN1 + tNMortBentDetN1 ENDIF;
tNWebDiatSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tNConsDiatBentN1 ENDIF;
tNWebGrenSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tNConsGrenBentN1 ENDIF;
tNWebBlueSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - tNConsBlueBentN1 ENDIF;
tNWebPhytSN1 = tNWebDiatSN1 + tNWebGrenSN1 + tNWebBlueSN1;
wSiWebSiO2WN1 = 0.0;
wSiWebDetWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wSiConsDiatZooHypN1 ENDIF;
tSiWebDetSN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tSiConsDiatBentN1 ENDIF;
tSiWebTotTN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE 0.0 ENDIF;
aPrefAveHypN1 = (cPrefDiatN1 * oDDiatWHypN1 + cPrefGrenN1 * oDGrenWHypN1 + cPrefBlueN1 * oDBlueWHypN1 + cPrefDetN1 * oDDetWHypN1) / oDOMWHypN1;
wDConsZoo2HypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aFiltHypN1 * aPrefAveHypN1 * oDOMWHypN1 * oDZooHypN1 ENDIF;
aDConsZooSpHypN1 = wDConsZooHypN1 / oDZooHypN1;
aDAssZooSpHypN1 = wDAssZooHypN1 / oDZooHypN1;
aDGrazSpHypN1 = wDConsZooHypN1 / oDOMWHypN1;
aNConsZooSpHypN1 = wNConsZooHypN1 / oNZooHypN1;
aNGrazSpHypN1 = wNConsZooHypN1 / oNOMWHypN1;
afDShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDShootPhraN1 /(aDRootPhraN1 + aDShootPhraN1) ELSE 0.0 ENDIF;
rDSRPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDShootPhraN1/aDRootPhraN1 ELSE 0.0 ENDIF;
rPDShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPShootPhraN1/aDShootPhraN1 ELSE 0.0 ENDIF;
rNDShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNShootPhraN1/aDShootPhraN1 ELSE 0.0 ENDIF;
rPDRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aPRootPhraN1/aDRootPhraN1 ELSE 0.0 ENDIF;
rNDRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNRootPhraN1/aDRootPhraN1 ELSE 0.0 ENDIF;
aLengShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aDShootPhraN1 / cDStemPhraN1 / cDensStemPhraN1 ELSE 0.0 ENDIF;
bDayInitPhraN1 = IF (DayN1 LT 1.0 OR sTimeN1 LT StartTimeN1 + 1.0) THEN 367 ELSEIF (uTmEpiN1 GE cTmInitPhraN1 AND bDayInitPhraN1 GT 366) THEN DayN1 ELSE bDayInitPhraN1 ENDIF;
aDAllPhraN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (DayN1 LT bDayInitPhraN1) THEN 0.0 ELSEIF (DayN1 LE bDayInitPhraN1 + 1.0 / kDAllPhraN1) THEN fDAllPhraN1 * aDRootPhraN1 ELSE 0.0 ENDIF;
tDAllPhraN1 = IF (FALSE EQ InclSeasonN1) THEN 0.0 ELSEIF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (DayN1 LT bDayInitPhraN1) THEN 0.0 ELSEIF (DayN1 LE bDayInitPhraN1 + 1.0 / kDAllPhraN1) THEN kDAllPhraN1 * aDAllPhraN1 ELSE 0.0 ENDIF;
tNTransPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rNDRootPhraN1 * tDAllPhraN1 ELSE 0.0 ENDIF;
tPTransPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rPDRootPhraN1 * tDAllPhraN1 ELSE 0.0 ENDIF;
aVNUptPhraMaxCrN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN MAX(0.0,cVNUptPhraMaxN1 * POW(cQ10ProdPhraN1 , (0.1 *(uTmEpiN1 - cTmRefN1))) *(cNDPhraMaxN1 - rNDRootPhraN1) /(cNDPhraMaxN1 - cNDPhraMinN1)) ELSE 0.0 ENDIF;
ahNUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVNUptPhraMaxCrN1 / cAffNUptPhraN1 ELSE 0.0 ENDIF;
aVNUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVNUptPhraMaxCrN1 * oNDissSMN1 /(ahNUptPhraSN1 + oNDissSMN1) ELSE 0.0 ENDIF;
tNUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVNUptPhraSN1 * aDRootPhraN1 ELSE 0.0 ENDIF;
tNUptNH4PhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aNH4SMN1 / aNDissSMN1 * tNUptPhraSN1 ELSE 0.0 ENDIF;
tNUptNO3PhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tNUptPhraSN1 - tNUptNH4PhraSN1 ELSE 0.0 ENDIF;
tNUptShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN afDShootPhraN1 * tNUptPhraSN1 ELSE 0.0 ENDIF;
tNUptRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tNUptPhraSN1 - tNUptShootPhraN1 ELSE 0.0 ENDIF;
aVPUptPhraMaxCrN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN MAX(0.0,cVPUptPhraMaxN1 * POW(cQ10ProdPhraN1 , (0.1 *(uTmEpiN1 - cTmRefN1))) *(cPDPhraMaxN1 - rPDRootPhraN1) /(cPDPhraMaxN1 - cPDPhraMinN1)) ELSE 0.0 ENDIF;
ahPUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVPUptPhraMaxCrN1 / cAffPUptPhraN1 ELSE 0.0 ENDIF;
aVPUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVPUptPhraMaxCrN1 * oPO4SMN1 /(ahPUptPhraSN1 + oPO4SMN1) ELSE 0.0 ENDIF;
tPUptPhraSN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aVPUptPhraSN1 * aDRootPhraN1 ELSE 0.0 ENDIF;
tPUptShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN afDShootPhraN1 * tPUptPhraSN1 ELSE 0.0 ENDIF;
tPUptRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tPUptPhraSN1 - tPUptShootPhraN1 ELSE 0.0 ENDIF;
uFunTmProdPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN POW(cQ10ProdPhraN1 , (0.1 *(uTmEpiN1 - cTmRefN1))) ELSE 0.0 ENDIF;
ukDRespTmPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDRespPhraN1 * POW(cQ10RespPhraN1 , (0.1 *(uTmEpiN1 - cTmRefN1))) ELSE 0.0 ENDIF;
aMuPhotPhraN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (aLengShootPhraN1 GE uDepthWMN1) THEN cMuPhraMaxN1 * uFunTmProdPhraN1 * ufDayN1 ELSE 0.0 ENDIF;
aNLimProdPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (1.0 - cNDPhraMinN1 / rNDRootPhraN1) * cNDPhraMaxN1 /(cNDPhraMaxN1 - cNDPhraMinN1) ELSE 0.0 ENDIF;
aPLimProdPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (1.0 - cPDPhraMinN1 / rPDRootPhraN1) * cPDPhraMaxN1 /(cPDPhraMaxN1 - cPDPhraMinN1) ELSE 0.0 ENDIF;
aNutLimPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN MIN(aNLimProdPhraN1,aPLimProdPhraN1) ELSE 0.0 ENDIF;
aMuPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aMuPhotPhraN1 * aNutLimPhraN1 ELSE 0.0 ENDIF;
akDIncrPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aMuPhotPhraN1 - ukDRespTmPhraN1 - kDMortShootPhraN1 ELSE 0.0 ENDIF;
tDDensPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN MAX(0.0,akDIncrPhraN1 / cDShootPhraMaxN1 * aDShootPhraN1 * aDShootPhraN1) ELSE 0.0 ENDIF;
tDDensProdPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aMuPhraN1 / cMuPhraMaxN1 * tDDensPhraN1 ELSE 0.0 ENDIF;
tDProdPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN aMuPhraN1 * aDShootPhraN1 - tDDensProdPhraN1 ELSE 0.0 ENDIF;
tDProdShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN afDShootPhraN1 * tDProdPhraN1 ELSE 0.0 ENDIF;
tDProdRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDProdPhraN1 - tDProdShootPhraN1 ELSE 0.0 ENDIF;
tDRespShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ukDRespTmPhraN1 * aDShootPhraN1 ELSE 0.0 ENDIF;
tDRespRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN ukDRespTmPhraN1 * aDRootPhraN1 ELSE 0.0 ENDIF;
tO2RespRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN molO2molCN1 * cCPerDWN1 * tDRespRootPhraN1 * afOxySedMN1 ELSE 0.0 ENDIF;
tO2FlowPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tO2RespRootPhraN1 ELSE 0.0 ENDIF;
bDayRealPhraN1 = IF (DayN1 LT 180.0) THEN 367 ELSEIF (ufDayN1 LE fDayWinN1 AND bDayRealPhraN1 GT 366) THEN DayN1 ELSE bDayRealPhraN1 ENDIF;
aDRealPhraN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (DayN1 LT bDayRealPhraN1) THEN 0.0 ELSEIF (DayN1 LE bDayRealPhraN1 + 1.0 / kDRealPhraN1) THEN fDRealPhraN1 * aDShootPhraN1 ELSE 0.0 ENDIF;
tDRealPhraN1 = IF (FALSE EQ InclSeasonN1) THEN 0.0 ELSEIF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (DayN1 LT bDayRealPhraN1) THEN 0.0 ELSEIF (DayN1 LE bDayRealPhraN1 + 1.0 / kDRealPhraN1) THEN kDRealPhraN1 * aDRealPhraN1 ELSE 0.0 ENDIF;
tNRetrPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rNDShootPhraN1 * tDRealPhraN1 ELSE 0.0 ENDIF;
tPRetrPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rPDShootPhraN1 * tDRealPhraN1 ELSE 0.0 ENDIF;
tDMortShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMortShootPhraN1 * aDShootPhraN1 ELSE 0.0 ENDIF;
tNMortShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rNDShootPhraN1 * tDMortShootPhraN1 ELSE 0.0 ENDIF;
tPMortShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rPDShootPhraN1 * tDMortShootPhraN1 ELSE 0.0 ENDIF;
tDMortRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kDMortRootPhraN1 * aDRootPhraN1 ELSE 0.0 ENDIF;
tNMortRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rNDRootPhraN1 * tDMortRootPhraN1 ELSE 0.0 ENDIF;
tPMortRootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN rPDRootPhraN1 * tDMortRootPhraN1 ELSE 0.0 ENDIF;
tDManShootPhraN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 GT NearZeroN1) THEN 0.0 ELSEIF ((DayN1 GE cDayManPhraN1) AND (DayN1 LT cDayManPhraN1 + 1.0)) THEN fManPhraN1 * aDShootPhraN1 ELSE 0.0 ENDIF;
tNManShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDManShootPhraN1 * rNDShootPhraN1 ELSE 0.0 ENDIF;
tPManShootPhraN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDManShootPhraN1 * rPDShootPhraN1 ELSE 0.0 ENDIF;
tDIMSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDSetIMMN1 ELSE 0.0 ENDIF;
tDHumSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN fRefrDetSN1 * tDMinDetSMN1 - tDMinHumSMN1 ELSE 0.0 ENDIF;
tDDetSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN tDSetDetMN1 - tDMinDetSMN1 + tDSetPhytMN1 + tDMortRootPhraN1 ELSE 0.0 ENDIF;
vDeltaSMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (tDIMSMN1 / cRhoIMN1 +(tDHumSMN1 + tDDetSMN1) / cRhoOMN1)/(1.0 - bPorSN1) ELSE 0.0 ENDIF;
tDBurIMMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN ((tDHumSMN1 + tDDetSMN1) +(cRhoOMN1 / cRhoIMN1) * tDIMSMN1) / ((aDHumSMN1 + aDDetSMN1) / aDIMSMN1 + cRhoOMN1 / cRhoIMN1) ELSE ((tDHumSMN1 + tDDetSMN1) +(cRhoOMN1 / cRhoIMN1) * tDIMSMN1) / (fDOrgSoilN1 /(1.0 - fDOrgSoilN1) + cRhoOMN1 / cRhoIMN1) ENDIF;
tDBurOMMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN (aDHumSMN1 + aDDetSMN1) / aDIMSMN1 * tDBurIMMN1 ELSE fDOrgSoilN1 /(1.0 - fDOrgSoilN1) * tDBurIMMN1 ENDIF;
tDBurDetMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN aDDetSMN1 /(aDHumSMN1 + aDDetSMN1) * tDBurOMMN1 ELSE 0.0 ENDIF;
tDBurHumMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN tDBurOMMN1 - tDBurDetMN1 ELSE tDBurOMMN1 ENDIF;
tDBurTotMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN tDBurIMMN1 + tDBurOMMN1 ELSE tDBurIMMN1 + tDBurOMMN1 ENDIF;
tPBurHumMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN rPDHumSMN1 * tDBurHumMN1 ELSE cPDSoilOMN1 * tDBurHumMN1 ENDIF;
tPBurDetMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN rPDDetSMN1 * tDBurDetMN1 ELSE 0.0 ENDIF;
tPBurAIMMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN aPAIMSMN1 / aDIMSMN1 * tDBurIMMN1 ELSE 0.0 ENDIF;
tPBurPO4MN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN aPO4SMN1 *(vDeltaSMN1 / cDepthSMN1) ELSE cPO4GroundN1 *(bPorSMN1 * vDeltaSMN1) ENDIF;
tPBurTotMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN tPBurDetMN1 + tPBurHumMN1 + tPBurAIMMN1 + tPBurPO4MN1 ELSE tPBurHumMN1 + tPBurAIMMN1 + tPBurPO4MN1 ENDIF;
tNBurHumMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN rNDHumSMN1 * tDBurHumMN1 ELSE cNDSoilOMN1 * tDBurHumMN1 ENDIF;
tNBurDetMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN rNDDetSMN1 * tDBurDetMN1 ELSE 0.0 ENDIF;
tNBurNH4MN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN aNH4SMN1 *(vDeltaSMN1 / cDepthSMN1) ELSE cNH4GroundN1 *(bPorSMN1 * vDeltaSMN1) ENDIF;
tNBurNO3MN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN aNO3SMN1 *(vDeltaSMN1 / cDepthSMN1) ELSE cNO3GroundN1 *(bPorSMN1 * vDeltaSMN1) ENDIF;
tNBurTotMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN tNBurDetMN1 + tNBurHumMN1 + tNBurNH4MN1 + tNBurNO3MN1 ELSE tNBurHumMN1 + tNBurNH4MN1 + tNBurNO3MN1 ENDIF;
tSiBurDetMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN rSiDDetSMN1 * tDBurDetMN1 ELSE 0.0 ENDIF;
tSiBurTotMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (vDeltaSMN1 GE 0.0) THEN tSiBurDetMN1 ELSE 0.0 ENDIF;
vDeltaWMN1 = IF (FALSE EQ InclMarshN1 OR fMarshN1 LE NearZeroN1) THEN 0.0 ELSEIF (ConstDepthN1 EQ TRUE) THEN 0.0 ELSE - vDeltaSMN1 ENDIF;
aRelDeltaWMN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN vDeltaWMN1 / uDepthWMN1 ELSE 0.0 ENDIF;
bTimeDredN1 = IF (sTimeN1 GE cDredStartN1 * DaysPerYearN1) THEN (FLOOR(TimeYearsN1/cDredIntervalN1) * cDredIntervalN1) * DaysPerYearN1 ELSE -9999.999 ENDIF;
bRhoSolidSoilN1 = fDOrgSoilN1 * cRhoOMN1 +(1.0 - fDOrgSoilN1) * cRhoIMN1;
tDMarsTotTN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (- tDBurTotMN1 - wDMinDetWMN1 * uDepthWMN1 -(1.0 - fRefrDetSN1) * tDMinDetSMN1 - tDMinHumSMN1 + tDProdPhraN1 - tDRespShootPhraN1 - tDRespRootPhraN1 - tDManShootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
tPMarsTotTN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (- tPInfPO4SMN1 + tPSeepPO4SMN1 - tPDifGroundPO4MN1 - tPBurTotMN1 - tPChemPO4MN1 - tPManShootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
tNMarsTotTN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN (- tNInfNH4SMN1 + tNSeepNH4SMN1 - tNInfNO3SMN1 + tNSeepNO3SMN1 - tNDifGroundNO3MN1 - tNDifGroundNH4MN1 - tNBurTotMN1 - wNDenitWMN1 * uDepthWMN1 - tNDenitSMN1 - tNManShootPhraN1) * fMarshN1 ELSE 0.0 ENDIF;
tSiMarsTotTN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN - tSiBurDetMN1 * fMarshN1 - tInfSiO2WMN1 + tSeepSiO2WMN1 ELSE 0.0 ENDIF;
uTauSubstEpiN1 = 1.0 / (ukOutEpiN1+NearZeroN1);
akExchMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN kExchMaxMN1 * hfMarshN1 /(hfMarshN1 + fMarshN1)  ELSE 0.0 ENDIF;
afVolMarshEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN fMarshN1 * uDepthWMN1 / uDepthWEpiN1 ELSE 0.0 ENDIF;
akExchLEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 * afVolMarshEpiN1 ELSE 0.0 ENDIF;
oPPhytWEpiN1 = oPDiatWEpiN1 + oPGrenWEpiN1 + oPBlueWEpiN1;
oNPhytWEpiN1 = oNDiatWEpiN1 + oNGrenWEpiN1 + oNBlueWEpiN1;
oDSestWEpiN1 = oDOMWEpiN1 + oDIMWEpiN1;
oPOMWEpiN1 = oPPhytWEpiN1 + oPDetWEpiN1;
oPSestWEpiN1 = oPPhytWEpiN1 + oPDetWEpiN1 + oPAIMWEpiN1;
oPInorgWEpiN1 = oPO4WEpiN1 + oPAIMWEpiN1;
oPTotWEpiN1 = oPSestWEpiN1 + oPO4WEpiN1;
oNOMWEpiN1 = oNPhytWEpiN1 + oNDetWEpiN1;
oNSestWEpiN1 = oNOMWEpiN1;
oNkjWEpiN1 = oNSestWEpiN1 + oNH4WEpiN1;
oNTotWEpiN1 = oNkjWEpiN1 + oNO3WEpiN1;
rPDIMWEpiN1 = oPAIMWEpiN1 / oDIMWEpiN1;
rPDDetWEpiN1 = oPDetWEpiN1 / (oDDetWEpiN1+NearZeroN1);
rNDDetWEpiN1 = oNDetWEpiN1 / (oDDetWEpiN1+NearZeroN1);
rSiDDetWEpiN1 = oSiDetWEpiN1 / (oDDetWEpiN1+NearZeroN1);
wDDilIMEpiN1 = ukOutEpiN1 * oDIMWEpiN1;
wDDilDetEpiN1 = ukOutEpiN1 * oDDetWEpiN1;
wDDilDiatEpiN1 = ukOutEpiN1 * oDDiatWEpiN1;
wDDilGrenEpiN1 = ukOutEpiN1 * oDGrenWEpiN1;
wDDilBlueEpiN1 = ukOutEpiN1 * oDBlueWEpiN1;
wDDilPhytEpiN1 = wDDilDiatEpiN1 + wDDilGrenEpiN1 + wDDilBlueEpiN1;
wDDilZooEpiN1 = ukOutEpiN1 * oDZooEpiN1;
wPDilZooEpiN1 = ukOutEpiN1 * oPZooEpiN1;
wNDilZooEpiN1 = ukOutEpiN1 * oNZooEpiN1;
wPDilPO4EpiN1 = ukOutEpiN1 * oPO4WEpiN1;
wPDilDetEpiN1 = ukOutEpiN1*oPDetWEpiN1;
wPDilAIMEpiN1 = ukOutEpiN1 * oPAIMWEpiN1;
wNDilNH4EpiN1 = ukOutEpiN1 * oNH4WEpiN1;
wNDilNO3EpiN1 = ukOutEpiN1 * oNO3WEpiN1;
wNDilDetEpiN1 = ukOutEpiN1 * oNDetWEpiN1;
uO2LoadEpiN1 = IF (ReadTranFracN1 EQ TRUE) THEN mO2LoadEpiN1 ELSE cO2InN1 * uQInEpiN1 / mmPermN1 ENDIF;
wO2OutflEpiN1 = ukOutEpiN1 * oO2WEpiN1;
wPDilDiatEpiN1 = ukOutEpiN1 * oPDiatWEpiN1;
wNDilDiatEpiN1 = ukOutEpiN1 * oNDiatWEpiN1;
wPDilGrenEpiN1 = ukOutEpiN1 * oPGrenWEpiN1;
wNDilGrenEpiN1 = ukOutEpiN1 * oNGrenWEpiN1;
wPDilBlueEpiN1 = ukOutEpiN1 * oPBlueWEpiN1;
wNDilBlueEpiN1 = ukOutEpiN1 * oNBlueWEpiN1;
wPDilPhytEpiN1 = wPDilDiatEpiN1 + wPDilGrenEpiN1 + wPDilBlueEpiN1;
wNDilPhytEpiN1 = wNDilDiatEpiN1 + wNDilGrenEpiN1 + wNDilBlueEpiN1;
wDOutflTotEpiN1 = ukOutEpiN1 * oDSestWEpiN1;
wPOutflTotEpiN1 = ukOutEpiN1 * oPTotWEpiN1;
wNOutflTotEpiN1 = ukOutEpiN1 * oNTotWEpiN1;
wSiDilSiO2EpiN1 = ukOutEpiN1 * oSiO2WEpiN1;
wSiDilDetEpiN1 = ukOutEpiN1 * oSiDetWEpiN1;
wSiDilDiatEpiN1 = cSiDDiatN1 * wDDilDiatEpiN1;
wSiOutflTotEpiN1 = ukOutEpiN1 * (oSiO2WEpiN1 + oSiDetWEpiN1 + cSiDDiatN1 * oDDiatWEpiN1);
wDDilTotEpiN1 = wDDilIMEpiN1 + wDDilDetEpiN1 + wDDilPhytEpiN1;
wPDilTotEpiN1 = wPDilDetEpiN1 + wPDilPO4EpiN1 + wPDilAIMEpiN1 + wPDilPhytEpiN1;
wNDilTotEpiN1 = wNDilDetEpiN1 + wNDilNO3EpiN1 + wNDilNH4EpiN1 + wNDilPhytEpiN1;
wSiDilTotEpiN1 = wSiDilDetEpiN1 + wSiDilSiO2EpiN1 + wSiDilDiatEpiN1;
tSiTranTotTEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadEpiN1 - wSiDilTotEpiN1 * uDepthWEpiN1 ENDIF;
tDTranTotTEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadEpiN1 - wDDilTotEpiN1 * uDepthWEpiN1 ENDIF;
tPTranTotTEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadEpiN1 - wPDilTotEpiN1 * uDepthWEpiN1 ENDIF;
tNTranTotTEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadEpiN1 - wNDilTotEpiN1 * uDepthWEpiN1 ENDIF;
wDExchIMMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDIMWEpiN1 - oDIMWMN1) ELSE 0.0 ENDIF;
wPExchPO4MEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPO4WEpiN1 - oPO4WMN1) ELSE 0.0 ENDIF;
wPExchAIMMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPAIMWEpiN1 - oPAIMWMN1) ELSE 0.0 ENDIF;
wNExchNH4MEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNH4WEpiN1 - oNH4WMN1) ELSE 0.0 ENDIF;
wNExchNO3MEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNO3WEpiN1 - oNO3WMN1) ELSE 0.0 ENDIF;
wSiExchSiO2MEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oSiO2WEpiN1 - oSiO2WMN1) ELSE 0.0 ENDIF;
wO2ExchMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oO2WEpiN1 - oO2WMN1) ELSE 0.0 ENDIF;
wDExchDetMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDDetWEpiN1 - oDDetWMN1) ELSE 0.0 ENDIF;
wPExchDetMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPDetWEpiN1 - oPDetWMN1) ELSE 0.0 ENDIF;
wNExchDetMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNDetWEpiN1 - oNDetWMN1) ELSE 0.0 ENDIF;
wSiExchDetMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oSiDetWEpiN1 - oSiDetWMN1) ELSE 0.0 ENDIF;
wDExchDiatMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDDiatWEpiN1 - oDDiatWMN1) ELSE 0.0 ENDIF;
wPExchDiatMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPDiatWEpiN1 - oPDiatWMN1) ELSE 0.0 ENDIF;
wNExchDiatMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNDiatWEpiN1 - oNDiatWMN1) ELSE 0.0 ENDIF;
wSiExchDiatMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cSiDDiatN1 * wDExchDiatMEpiN1 ELSE 0.0 ENDIF;
wDExchGrenMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDGrenWEpiN1 - oDGrenWMN1) ELSE 0.0 ENDIF;
wPExchGrenMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPGrenWEpiN1 - oPGrenWMN1) ELSE 0.0 ENDIF;
wNExchGrenMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNGrenWEpiN1 - oNGrenWMN1) ELSE 0.0 ENDIF;
wDExchBlueMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDBlueWEpiN1 - oDBlueWMN1) ELSE 0.0 ENDIF;
wPExchBlueMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPBlueWEpiN1 - oPBlueWMN1) ELSE 0.0 ENDIF;
wNExchBlueMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNBlueWEpiN1 - oNBlueWMN1) ELSE 0.0 ENDIF;
wDExchZooMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oDZooEpiN1 - oDZooMN1) ELSE 0.0 ENDIF;
wPExchZooMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oPZooEpiN1 - oPZooMN1) ELSE 0.0 ENDIF;
wNExchZooMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchMEpiN1 *(oNZooEpiN1 - oNZooMN1) ELSE 0.0 ENDIF;
wDExchIMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDIMWEpiN1 - oDIMWMN1) ELSE 0.0 ENDIF;
wPExchPO4EpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPO4WEpiN1 - oPO4WMN1) ELSE 0.0 ENDIF;
wPExchAIMEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPAIMWEpiN1 - oPAIMWMN1) ELSE 0.0 ENDIF;
wNExchNH4EpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNH4WEpiN1 - oNH4WMN1) ELSE 0.0 ENDIF;
wNExchNO3EpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNO3WEpiN1 - oNO3WMN1) ELSE 0.0 ENDIF;
wSiExchSiO2EpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oSiO2WEpiN1 - oSiO2WMN1) ELSE 0.0 ENDIF;
wO2ExchEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oO2WEpiN1 - oO2WMN1) ELSE 0.0 ENDIF;
wDExchDetEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDDetWEpiN1 - oDDetWMN1) ELSE 0.0 ENDIF;
wPExchDetEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPDetWEpiN1 - oPDetWMN1) ELSE 0.0 ENDIF;
wNExchDetEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNDetWEpiN1 - oNDetWMN1) ELSE 0.0 ENDIF;
wSiExchDetEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oSiDetWEpiN1 - oSiDetWMN1) ELSE 0.0 ENDIF;
wDExchDiatEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDDiatWEpiN1 - oDDiatWMN1) ELSE 0.0 ENDIF;
wPExchDiatEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPDiatWEpiN1 - oPDiatWMN1) ELSE 0.0 ENDIF;
wNExchDiatEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNDiatWEpiN1 - oNDiatWMN1) ELSE 0.0 ENDIF;
wSiExchDiatEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN cSiDDiatN1 * wDExchDiatEpiN1 ELSE 0.0 ENDIF;
wDExchGrenEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDGrenWEpiN1 - oDGrenWMN1) ELSE 0.0 ENDIF;
wPExchGrenEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPGrenWEpiN1 - oPGrenWMN1) ELSE 0.0 ENDIF;
wNExchGrenEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNGrenWEpiN1 - oNGrenWMN1) ELSE 0.0 ENDIF;
wDExchBlueEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDBlueWEpiN1 - oDBlueWMN1) ELSE 0.0 ENDIF;
wPExchBlueEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPBlueWEpiN1 - oPBlueWMN1) ELSE 0.0 ENDIF;
wNExchBlueEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNBlueWEpiN1 - oNBlueWMN1) ELSE 0.0 ENDIF;
wDExchZooEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oDZooEpiN1 - oDZooMN1) ELSE 0.0 ENDIF;
wPExchZooEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oPZooEpiN1 - oPZooMN1) ELSE 0.0 ENDIF;
wNExchZooEpiN1 = IF (InclMarshN1 EQ TRUE AND fMarshN1 GT NearZeroN1) THEN akExchLEpiN1 *(oNZooEpiN1 - oNZooMN1) ELSE 0.0 ENDIF;
tInfSiO2WEpiN1 =IF (InclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oSiO2WEpiN1 ELSE 0.0 ENDIF;
tInfO2WEpiN1 =IF (InclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oO2WEpiN1 ELSE 0.0 ENDIF;
tPInfPO4WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oPO4WEpiN1 ELSE 0.0 ENDIF;
tNInfNH4WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNH4WEpiN1 ELSE 0.0 ENDIF;
tNInfNO3WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN1 GE 0.0) THEN uQOutInfN1 / mmPermN1 * oNO3WEpiN1 ELSE 0.0 ENDIF;
tSeepSiO2WEpiN1 =IF (InclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WEpiN1 =IF (InclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oPO4SN1 ELSE 0.0 ENDIF;
tNSeepNH4WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNH4SN1 ELSE 0.0 ENDIF;
tNSeepNO3WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN1 GE 0.0) THEN uQInSeepN1 / mmPermN1 * oNO3SN1 ELSE 0.0 ENDIF;
tSiAbioTotTN1 = - fRefrDetSN1 * tSiMinDetSN1 - tInfSiO2WHypN1 - tInfSiO2WEpiN1 + tSeepSiO2WHypN1 + tSeepSiO2WEpiN1;
tO2AerEpiN1 = kAerN1 * uFunTmAerEpiN1 * (uO2SatEpiN1 - oO2WEpiN1) * aFunFloatAerN1 * aFunBlueSurfAerN1;
tDTurbFishIMN1 = fLutumN1 * aDIMSN1 / (fLutumN1 * aDIMSN1 + aDDetSN1) * tDTurbFishN1;
uCorVSetIMEpiN1 = (aFunTauSetIMEpiN1+ uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * POW((fLutumRefN1/fLutumN1) , (0.5)) * uFunTmSetEpiN1 * cVSetIMN1;
tDSetIMEpiN1 = uCorVSetIMEpiN1 * oDIMWEpiN1;
tPSetAIMEpiN1 = oPAIMWEpiN1 / oDIMWEpiN1 * tDSetIMEpiN1;
uCorVSetDetEpiN1 = (cVSetDetN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMEpiN1 * uFunTmSetEpiN1;
tDSetDetEpiN1 = uCorVSetDetEpiN1 * oDDetWEpiN1;
tPSetDetEpiN1 = uCorVSetDetEpiN1 * oPDetWEpiN1;
tNSetDetEpiN1 = uCorVSetDetEpiN1 * oNDetWEpiN1;
tSiSetDetEpiN1 = uCorVSetDetEpiN1 * oSiDetWEpiN1;
wDMinDetWEpiN1 = kDMinDetWN1 * uFunTmMinWEpiN1 * oDDetWEpiN1;
wPMinDetWEpiN1 = kPMinDetWN1 * uFunTmMinWEpiN1 * oPDetWEpiN1;
wNMinDetWEpiN1 = kNMinDetWN1 * uFunTmMinWEpiN1 * oNDetWEpiN1;
wSiMinDetWEpiN1 = kSiMinDetWN1 * uFunTmMinWEpiN1 * oSiDetWEpiN1;
aCorO2BODEpiN1 = oO2WEpiN1 / (hO2BODN1 + oO2WEpiN1);
wO2MinDetWEpiN1 = molO2molCN1 * cCPerDWN1 * aCorO2BODEpiN1 * wDMinDetWEpiN1;
wDDenitWEpiN1 = oNO3WEpiN1*oNO3WEpiN1 / (hNO3DenitN1*hNO3DenitN1 + oNO3WEpiN1*oNO3WEpiN1) * (1.0 - aCorO2BODEpiN1) * wDMinDetWEpiN1;
wNDenitWEpiN1 = NO3PerCN1 * molNmolCN1 * cCPerDWN1 * wDDenitWEpiN1;
aCorO2NitrWEpiN1 = oO2WEpiN1*oO2WEpiN1 / (hO2NitrN1*hO2NitrN1 + oO2WEpiN1*oO2WEpiN1);
wNNitrWEpiN1 = kNitrWN1 * uFunTmNitrEpiN1 * aCorO2NitrWEpiN1 * oNH4WEpiN1;
wO2NitrWEpiN1 = O2PerNH4N1 * molO2molNN1 * wNNitrWEpiN1;
tDMinOxyDetSN1 = afOxySedN1 * (1.0 - fRefrDetSN1) * tDMinDetSN1;
tO2MinDetSN1 = molO2molCN1 * cCPerDWN1 * tDMinOxyDetSN1;
tDDenitSN1 = oNO3SN1*oNO3SN1 / (hNO3DenitN1*hNO3DenitN1 + oNO3SN1*oNO3SN1) * (1.0 - afOxySedN1) * (1.0 - fRefrDetSN1) * tDMinDetSN1;
tNDenitSN1 = NO3PerCN1 * molNmolCN1 * cCPerDWN1 * tDDenitSN1;
tNNitrSN1 = afOxySedN1 * kNitrSN1 * uFunTmNitrSN1 * aNH4SN1;
tO2NitrSN1 = O2PerNH4N1 * molO2molNN1 * tNNitrSN1;
tDMinHumSN1 = kDMinHumN1 * uFunTmMinSN1 * afOxySedN1 * aDHumSN1;
tPMinHumSN1 = kDMinHumN1 * uFunTmMinSN1 * afOxySedN1 * aPHumSN1;
tNMinHumSN1 = kDMinHumN1 * uFunTmMinSN1 * afOxySedN1 * aNHumSN1;
tPDifPO4EpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN 0.0 ELSE kPDifPO4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oPO4SN1 - oPO4WEpiN1 ) / aDepthDifN1 ENDIF;
tNDifNO3EpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN 0.0 ELSE kNDifNO3N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oNO3SN1 - oNO3WEpiN1 ) / aDepthDifN1 ENDIF;
tNDifNH4EpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN 0.0 ELSE kNDifNH4N1 * uFunTmDifN1 * cTurbDifNutN1 * bPorCorSN1 * (oNH4SN1 - oNH4WEpiN1 ) / aDepthDifN1 ENDIF;
tO2DifEpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN 0.0 ELSE kO2DifN1 / aDepthDifN1 * uFunTmDifN1 * cTurbDifO2N1 * bPorCorSN1 * oO2WEpiN1 ENDIF;
aPAdsMaxWEpiN1 = cRelPAdsDN1 + aCorO2BODEpiN1 * cRelPAdsFeN1 * fFeDIMN1 + cRelPAdsAlN1 * fAlDIMN1;
aKPAdsWEpiN1 = (1.0 - fRedMaxN1 * (1.0-aCorO2BODEpiN1)) * cKPAdsOxN1;
aPIsoAdsWEpiN1 = aPAdsMaxWEpiN1 * aKPAdsWEpiN1 * oPO4WEpiN1 / (1.0 + aKPAdsWEpiN1 * oPO4WEpiN1);
aPEqIMWEpiN1 = aPIsoAdsWEpiN1 * oDIMWEpiN1;
wPSorpIMWEpiN1 = kPSorpN1 * (aPEqIMWEpiN1 - oPAIMWEpiN1);
aPAdsMaxSN1 = cRelPAdsDN1 + afOxySedN1 * cRelPAdsFeN1 * fFeDIMN1 + cRelPAdsAlN1 * fAlDIMN1;
aKPAdsSN1 = (1.0 - fRedMaxN1 * (1.0-afOxySedN1)) * cKPAdsOxN1;
aPIsoAdsSN1 = aPAdsMaxSN1 * aKPAdsSN1 * oPO4SN1 / (1.0 + aKPAdsSN1 * oPO4SN1);
aPEqIMSN1 = aPIsoAdsSN1 * aDIMSN1;
tPSorpIMSN1 = kPSorpN1 * (aPEqIMSN1 - aPAIMSN1);
wO2AbioWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE tO2BubHypN1 / uDepthWHypN1 - wO2MinDetWHypN1 - wO2NitrWHypN1 - (tO2MinDetSN1 + tO2NitrSN1) / uDepthWHypN1 - (tInfO2WHypN1 / uDepthWHypN1) + (tSeepO2WHypN1 / uDepthWHypN1) ENDIF;
wPAbioDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE - wPMinDetWHypN1 - (tPSetDetHypN1 - tPSetDetEpiN1 - tPResusDetN1) / uDepthWHypN1 ENDIF;
wPAbioPO4WHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wPMinDetWHypN1 - wPSorpIMWHypN1 - (tPInfPO4WHypN1 / uDepthWHypN1) + ((tPSeepPO4WHypN1 + tPDifPO4HypN1 + tPResusPO4N1) / uDepthWHypN1) ENDIF;
wPAbioAIMWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (- tPSetAIMHypN1 +tPSetAIMEpiN1 + tPResusAIMN1) / uDepthWHypN1 + wPSorpIMWHypN1 ENDIF;
tPAbioTotTN1 = uPErosOMN1 - tPChemPO4N1 - tPInfPO4SN1 + tPSeepPO4SN1 - tPDifGroundPO4N1;
wNAbioNH4WHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNMinDetWHypN1 - wNNitrWHypN1 - (tNInfNH4WHypN1 / uDepthWHypN1) + ((tNSeepNH4WHypN1 + tNDifNH4HypN1 + tNResusNH4N1) / uDepthWHypN1) ENDIF;
wNAbioNO3WHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNNitrWHypN1 - wNDenitWHypN1 + ((tNDifNO3HypN1 + tNResusNO3N1 - tNInfNO3WHypN1 + tNSeepNO3WHypN1) / uDepthWHypN1) ENDIF;
wNAbioDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE - wNMinDetWHypN1 - (tNSetDetHypN1 -tNSetDetEpiN1 - tNResusDetN1 ) / uDepthWHypN1 ENDIF;
wSiAbioSiO2WHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wSiMinDetWHypN1 + (1.0 - fRefrDetSN1) * tSiMinDetSN1 / uDepthWHypN1 - tInfSiO2WHypN1 / uDepthWHypN1 + tSeepSiO2WHypN1 / uDepthWHypN1 ENDIF;
wSiAbioDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE - wSiMinDetWHypN1 - (tSiSetDetHypN1 -tSiSetDetEpiN1 - tSiResusDetN1) / uDepthWHypN1 ENDIF;
wDAbioDetWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (- tDSetDetHypN1 + tDSetDetEpiN1 + tDResusDetN1 ) / uDepthWHypN1 - wDMinDetWHypN1 ENDIF;
wDAbioIMWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (uDErosIMWN1 * fHypErosIMN1 - tDSetIMHypN1+ tDSetIMEpiN1 + tDResusIMN1) / uDepthWHypN1 ENDIF;
wDAbioIMWEpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN (uDErosIMWN1 * (1- fHypErosIMN1) - tDSetIMEpiN1 ) / uDepthWEpiN1 ELSE (uDErosIMWN1 * (1- fHypErosIMN1) - tDSetIMEpiN1 + tDResusIMN1) / uDepthWEpiN1 ENDIF;
wDAbioDetWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN (- tDSetDetEpiN1 ) / uDepthWEpiN1 - wDMinDetWEpiN1 ELSE (- tDSetDetEpiN1 + tDResusDetN1 ) / uDepthWEpiN1 - wDMinDetWEpiN1 ENDIF;
tDAbioIMSN1 = IF ( aInclStratN1 EQ TRUE ) THEN uDErosIMSN1 + tDSetIMHypN1 - tDResusIMN1 ELSE uDErosIMSN1 + tDSetIMEpiN1 - tDResusIMN1 ENDIF ;
tDAbioDetSN1 = IF ( aInclStratN1 EQ TRUE ) THEN tDSetDetHypN1 - tDResusDetN1 - tDMinDetSN1 ELSE tDSetDetEpiN1 - tDResusDetN1 - tDMinDetSN1 ENDIF ;
tDAbioHumSN1 = uDErosOMN1 + fRefrDetSN1 * tDMinDetSN1 - tDMinHumSN1;
tDAbioTotTN1 = cDErosTotN1 - wDMinDetWEpiN1 * uDepthWEpiN1 - wDMinDetWHypN1 * uDepthWHypN1 - (1.0 - fRefrDetSN1) * tDMinDetSN1 - tDMinHumSN1;
wO2AbioWEpiN1 = IF (aInclStratN1 EQ FALSE) THEN tO2AerEpiN1 / uDepthWEpiN1 - wO2MinDetWEpiN1 - wO2NitrWEpiN1 - (tO2MinDetSN1 + tO2NitrSN1) / uDepthWEpiN1 - tInfO2WEpiN1/uDepthWEpiN1 + tSeepO2WEpiN1/uDepthWEpiN1 ELSE tO2AerEpiN1 / uDepthWEpiN1 - wO2MinDetWEpiN1 - wO2NitrWEpiN1 ENDIF;
wO2AbioMN1 = tO2AerMN1 / uDepthWMN1 - wO2MinDetWMN1 - wO2NitrWMN1 - (tO2MinDetSMN1 + tO2NitrSMN1) / uDepthWMN1  - tInfO2WMN1 /uDepthWMN1  + tSeepO2WMN1 /uDepthWMN1 ;
wPAbioDetWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN - wPMinDetWEpiN1 - (tPSetDetEpiN1 ) / uDepthWEpiN1 ELSE - wPMinDetWEpiN1 - (tPSetDetEpiN1 - tPResusDetN1) / uDepthWEpiN1 ENDIF;
wPAbioPO4WEpiN1 =IF (aInclStratN1 EQ TRUE ) THEN wPMinDetWEpiN1 - wPSorpIMWEpiN1 + (tPDifPO4EpiN1 / uDepthWEpiN1) ELSE wPMinDetWEpiN1 - wPSorpIMWEpiN1 + ((tPSeepPO4WEpiN1 - tPInfPO4WEpiN1 + tPDifPO4EpiN1 + tPResusPO4N1) / uDepthWEpiN1) ENDIF;
wPAbioAIMWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN (- tPSetAIMEpiN1 ) / uDepthWEpiN1 + wPSorpIMWEpiN1 ELSE (- tPSetAIMEpiN1 + tPResusAIMN1 ) / uDepthWEpiN1 + wPSorpIMWEpiN1 ENDIF;
tPAbioDetSN1 = IF ( aInclStratN1 EQ TRUE ) THEN - tPMinDetSN1 + tPSetDetHypN1 - tPResusDetN1 ELSE - tPMinDetSN1 + tPSetDetEpiN1 - tPResusDetN1 ENDIF ;
tPAbioHumSN1 = uPErosOMN1 + fRefrDetSN1 * tPMinDetSN1 - tPMinHumSN1;
tPAbioPO4SN1 = IF ( aInclStratN1 EQ TRUE ) THEN tPInfPO4WHypN1 - tPSeepPO4WHypN1 - tPInfPO4SN1 + tPSeepPO4SN1 + (1.0-fRefrDetSN1) * tPMinDetSN1 + tPMinHumSN1 - tPSorpIMSN1 - tPResusPO4N1 - tPDifPO4HypN1 - tPDifGroundPO4N1 - tPChemPO4N1 ELSE tPInfPO4WEpiN1 - tPSeepPO4WEpiN1 - tPInfPO4SN1 + tPSeepPO4SN1 + (1.0-fRefrDetSN1) * tPMinDetSN1 + tPMinHumSN1 - tPSorpIMSN1 - tPResusPO4N1 - tPDifPO4EpiN1 - tPDifGroundPO4N1 - tPChemPO4N1 ENDIF;
tPAbioAIMSN1 = IF ( aInclStratN1 EQ TRUE ) THEN tPSetAIMHypN1 - tPResusAIMN1 + tPSorpIMSN1 ELSE tPSetAIMEpiN1 - tPResusAIMN1 + tPSorpIMSN1 ENDIF;
wNAbioNH4WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wNMinDetWEpiN1 - wNNitrWEpiN1 + (tNDifNH4EpiN1 / uDepthWEpiN1) ELSE wNMinDetWEpiN1 - wNNitrWEpiN1 + ((tNSeepNH4WEpiN1 - tNInfNH4WEpiN1 + tNDifNH4EpiN1 + tNResusNH4N1) / uDepthWEpiN1) ENDIF;
wNAbioNO3WEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wNNitrWEpiN1 - wNDenitWEpiN1 + (tNDifNO3EpiN1 / uDepthWEpiN1) ELSE wNNitrWEpiN1 - wNDenitWEpiN1 + ((tNDifNO3EpiN1 + tNResusNO3N1 - tNInfNO3WEpiN1 + tNSeepNO3WEpiN1) / uDepthWEpiN1) ENDIF;
wNAbioDetWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN - wNMinDetWEpiN1 - (tNSetDetEpiN1) / uDepthWEpiN1 ELSE - wNMinDetWEpiN1 - (tNSetDetEpiN1 - tNResusDetN1 ) / uDepthWEpiN1 ENDIF;
tNAbioNH4SN1 = IF ( aInclStratN1 EQ TRUE ) THEN tNInfNH4WHypN1 - tNSeepNH4WHypN1 - tNInfNH4SN1 + tNSeepNH4SN1 + (1.0-fRefrDetSN1) * tNMinDetSN1 + tNMinHumSN1 - tNResusNH4N1 - tNDifNH4HypN1 - tNDifGroundNH4N1 - tNNitrSN1 ELSE tNInfNH4WEpiN1 - tNSeepNH4WEpiN1 - tNInfNH4SN1 + tNSeepNH4SN1 + (1.0-fRefrDetSN1) * tNMinDetSN1 + tNMinHumSN1 - tNResusNH4N1 - tNDifNH4EpiN1 - tNDifGroundNH4N1 - tNNitrSN1 ENDIF;
tNAbioNO3SN1 = IF ( aInclStratN1 EQ TRUE ) THEN tNInfNO3WHypN1 - tNSeepNO3WHypN1 - tNInfNO3SN1 + tNSeepNO3SN1 + tNNitrSN1 - tNDenitSN1 - tNResusNO3N1 - tNDifNO3HypN1 - tNDifGroundNO3N1 ELSE tNInfNO3WEpiN1 - tNSeepNO3WEpiN1 - tNInfNO3SN1 + tNSeepNO3SN1 + tNNitrSN1 - tNDenitSN1 - tNResusNO3N1 - tNDifNO3EpiN1 - tNDifGroundNO3N1 ENDIF;
tNAbioDetSN1 = IF ( aInclStratN1 EQ TRUE ) THEN - tNMinDetSN1 + tNSetDetHypN1 - tNResusDetN1 ELSE - tNMinDetSN1 + tNSetDetEpiN1 - tNResusDetN1 ENDIF ;
tNAbioHumSN1 = uNErosOMN1 + fRefrDetSN1 * tNMinDetSN1 - tNMinHumSN1;
tNAbioTotTN1 = uNErosOMN1 - tNDenitSN1 - wNDenitWEpiN1 * uDepthWEpiN1 - wNDenitWHypN1 * uDepthWHypN1 - tNInfNH4SN1 - tNInfNO3SN1 + tNSeepNH4SN1 + tNSeepNO3SN1 - tNDifGroundNO3N1 - tNDifGroundNH4N1;
wSiAbioSiO2WEpiN1 = IF (aInclStratN1 EQ FALSE ) THEN wSiMinDetWEpiN1 + (1.0 - fRefrDetSN1) * tSiMinDetSN1 / uDepthWEpiN1 - tInfSiO2WEpiN1 / uDepthWEpiN1 + tSeepSiO2WEpiN1 / uDepthWEpiN1 ELSE wSiMinDetWEpiN1 ENDIF;
wSiAbioDetWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN - wSiMinDetWEpiN1 - (tSiSetDetEpiN1 ) / uDepthWEpiN1 ELSE - wSiMinDetWEpiN1 - (tSiSetDetEpiN1 - tSiResusDetN1) / uDepthWEpiN1 ENDIF;
tSiAbioDetSN1 = IF ( aInclStratN1 EQ TRUE ) THEN - tSiMinDetSN1 + tSiSetDetHypN1 - tSiResusDetN1 ELSE - tSiMinDetSN1 + tSiSetDetEpiN1 - tSiResusDetN1 ENDIF;
tDProdSubVegEpiN1 = bfSubVegEpiN1 * tDProdVegEpiN1;
tDMortVegWEpiN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tDMortVegEpiN1;
tDMortVegSEpiN1 = tDMortVegEpiN1 - tDMortVegWEpiN1;
tDBedVegN1 = IF InclVegN1 EQ TRUE THEN tDMigrVegN1 + tDProdVegEpiN1 + tDProdVegHypN1- tDRespVegN1 - tDMortVegEpiN1 - tDMortVegHypN1 - tDGrazVegBirdN1 - tDManVegN1 ELSE 0.0 ENDIF;
tO2ProdVegEpiN1 = molO2molCN1 * cCPerDWN1 * tDProdVegEpiN1;
tO2RespVegWEpiN1 = molO2molCN1 * cCPerDWN1 * bfSubVegEpiN1 * tDRespVegN1 * aCorO2BODEpiN1;
tO2ProdVegSEpiN1 = MIN (tO2RespVegSN1, tO2ProdVegEpiN1);
tO2ProdVegWEpiN1 = MIN ( tO2ProdVegEpiN1 - tO2ProdVegSEpiN1, bfSubVegN1 * tO2ProdVegEpiN1) ;
tO2BedSN1 = tO2ProdVegSHypN1 + tO2ProdVegSEpiN1 - tO2RespVegSN1 + tO2UptNO3VegSN1;
tO2UptNO3VegWEpiN1 = O2PerNO3N1 * molO2molNN1 * bfSubVegN1 * tNUptNO3VegWEpiN1;
tPMortVegEpiN1 = rPDVegN1 * tDMortVegEpiN1;
tPMortVegPO4EpiN1 = fDissMortVegN1 * tPMortVegEpiN1;
tPMortVegPO4SEpiN1 = bfRootVegN1 * tPMortVegPO4EpiN1;
tPMortVegPO4WEpiN1 = tPMortVegPO4EpiN1 - tPMortVegPO4SEpiN1;
tPMortVegDetEpiN1 = tPMortVegEpiN1 - tPMortVegPO4EpiN1;
tPMortVegDetWEpiN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tPMortVegDetEpiN1;
tPMortVegDetSEpiN1 = tPMortVegDetEpiN1 - tPMortVegDetWEpiN1;
tPBedVegN1 = IF InclVegN1 EQ TRUE THEN tPMigrVegN1 + tPUptVegEpiN1 + tPUptVegHypN1 - tPExcrVegN1 - tPMortVegEpiN1 - tPMortVegHypN1 - tPGrazVegBirdN1 - tPManVegN1 ELSE 0.0 ENDIF;
tNMortVegNH4WEpiN1 = tNMortVegNH4EpiN1 - tNMortVegNH4SEpiN1;
tNMortVegDetEpiN1 = tNMortVegEpiN1 - tNMortVegNH4EpiN1;
tNMortVegDetWEpiN1 = fDetWMortVegN1 * (1.0 - bfRootVegN1) * tNMortVegDetEpiN1;
tNMortVegDetSEpiN1 = tNMortVegDetEpiN1 - tNMortVegDetWEpiN1;
tNBedVegN1 = IF InclVegN1 EQ TRUE THEN tNMigrVegN1 + tNUptVegN1 - tNExcrVegN1 - tNMortVegEpiN1 - tNMortVegHypN1 - tNGrazVegBirdN1 - tNManVegN1 ELSE 0.0 ENDIF;
wDBedDetWEpiN1 = IF (InclVegN1 EQ TRUE) THEN (tDMortVegWEpiN1 + tDEgesBirdN1) / uDepthWEpiN1 ELSE 0.0 ENDIF;
tDBedDetSEpiN1 = IF ( InclVegN1 EQ TRUE) THEN tDMortVegSEpiN1 ELSE 0.0 ENDIF;
wPBedPO4WEpiN1 = IF (InclVegN1 EQ FALSE) THEN 0.0 ELSE (- tPUptVegWEpiN1 + tPExcrVegWN1 * uVegHeightEpiN1 / uVegHeightN1 + tPMortVegPO4WEpiN1 + tPEgesBirdPO4N1) /uDepthWEpiN1 ENDIF;
wPBedDetWEpiN1 = IF (InclVegN1 EQ TRUE) THEN (tPMortVegDetWEpiN1 + tPEgesBirdDetN1) / uDepthWEpiN1 ELSE 0.0 ENDIF;
tPBedPO4SN1 = IF ( InclVegN1 EQ TRUE) THEN - tPUptVegSN1 + tPExcrVegSN1 + tPMortVegPO4SEpiN1 + tPMortVegPO4SHypN1 ELSE 0.0 ENDIF;
tPBedDetSN1 = IF (InclVegN1 EQ TRUE) THEN tPMortVegDetSEpiN1 + tPMortVegDetSHypN1 ELSE 0.0 ENDIF;
wNBedNH4WEpiN1 = IF ( InclVegN1 EQ TRUE ) THEN (- tNUptNH4VegWEpiN1 + tNExcrVegWN1 * (uVegHeightEpiN1 /uVegHeightN1 ) + tNMortVegNH4WEpiN1 + tNEgesBirdNH4N1) / uDepthWEpiN1 ELSE 0.0 ENDIF;
wNBedNO3WEpiN1 = IF ( InclVegN1 EQ TRUE) THEN - tNUptNO3VegWEpiN1 / uDepthWEpiN1 ELSE 0.0 ENDIF;
wNBedDetWEpiN1 = IF (InclVegN1 EQ TRUE) THEN (tNMortVegDetWEpiN1 + tNEgesBirdDetN1) / uDepthWEpiN1 ELSE 0.0 ENDIF;
tNBedNH4SN1 = IF ( InclVegN1 EQ TRUE) THEN - tNUptNH4VegSN1 + tNExcrVegSN1 + tNMortVegNH4SEpiN1 + tNMortVegNH4SHypN1 ELSE 0.0 ENDIF;
tNBedNO3SN1 = IF ( InclVegN1 EQ TRUE ) THEN - tNUptNO3VegSN1 ELSE 0.0 ENDIF;
tNBedDetSN1 = IF ( InclVegN1 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN1 EQ TRUE) THEN tNMortVegDetSEpiN1 + tNMortVegDetSHypN1 ELSE tNMortVegDetSEpiN1 ENDIF;
tO2BedWEpiN1 = IF ( InclVegN1 EQ TRUE ) THEN tO2ProdVegWEpiN1 - tO2RespVegWEpiN1 + tO2UptNO3VegWEpiN1 ELSE 0.0 ENDIF;
rPDBlueWEpiN1 = oPBlueWEpiN1 /(oDBlueWEpiN1+NearZeroN1);
aVPUptMaxCrBlueEpiN1 = MAX(0.0,cVPUptMaxBlueN1 * uFunTmProdBlueEpiN1 *(cPDBlueMaxN1 - rPDBlueWEpiN1) /(cPDBlueMaxN1 - cPDBlueMinN1));
aVPUptBlueEpiN1 = oPO4WEpiN1 * aVPUptMaxCrBlueEpiN1 /(aVPUptMaxCrBlueEpiN1 / cAffPUptBlueN1 + oPO4WEpiN1);
wPUptBlueEpiN1 = aVPUptBlueEpiN1 * oDBlueWEpiN1;
rNDBlueWEpiN1 = oNBlueWEpiN1 /(oDBlueWEpiN1+NearZeroN1);
aVNUptMaxCrBlueEpiN1 = MAX(0.0,cVNUptMaxBlueN1 * uFunTmProdBlueEpiN1 * (cNDBlueMaxN1 - rNDBlueWEpiN1) /(cNDBlueMaxN1 - cNDBlueMinN1));
ahNUptBlueEpiN1 = aVNUptMaxCrBlueEpiN1 / cAffNUptBlueN1;
aVNUptBlueEpiN1 = oNDissWEpiN1 * aVNUptMaxCrBlueEpiN1 /(ahNUptBlueEpiN1 + oNDissWEpiN1);
wNUptBlueEpiN1 = aVNUptBlueEpiN1 * oDBlueWEpiN1;
tNUptBlueEpiN1 = wNUptBlueEpiN1 * uDepthWEpiN1;
aLLimBlueEpiN1 = UseSteeleBlueN1 *(EXP(1.0) /(aExtCoefEpiN1 * uDepthWEpiN1) *(EXP(- aLPARBotEpiN1 /(cLOptRefBlueN1 * uFunTmProdBlueEpiN1)) - EXP(- aLPARBotSurfN1 /(cLOptRefBlueN1 * uFunTmProdBlueEpiN1)))) +(1.0 - UseSteeleBlueN1) *(1.0 /(aExtCoefEpiN1 * uDepthWEpiN1) * LN((1.0 + aLPARBotSurfN1 / (hLRefBlueN1 * uFunTmProdBlueEpiN1)) / (1.0 + aLPARBotEpiN1 /(hLRefBlueN1 * uFunTmProdBlueEpiN1))));
rChDBlueEpiN1 = cChDBlueMaxN1 -(cChDBlueMaxN1 - cChDBlueMinN1) * aLLimBlueEpiN1;
aChlaBlueEpiN1 = mgPergN1 * rChDBlueEpiN1 * aDBlueWEpiN1;
aNfixBlueEpiN1 = rNfixBlueEpiN1 *aChlaBlueEpiN1 /ugPergN1;
afNH4UptBlueEpiN1 = oNH4WEpiN1 * oNO3WEpiN1 /((ahNUptBlueEpiN1 + oNH4WEpiN1) *(ahNUptBlueEpiN1 + oNO3WEpiN1)) + oNH4WEpiN1 * ahNUptBlueEpiN1 /((oNH4WEpiN1 + oNO3WEpiN1) *(ahNUptBlueEpiN1 + oNO3WEpiN1));
tNUptBlueAirEpiN1 = IF (InclNfixN1 EQ FALSE) THEN 0.0 ELSE aNfixBlueEpiN1 ENDIF;
tNUptBlueWEpiN1 = IF (InclNfixN1 EQ FALSE) THEN tNUptBlueEpiN1 ELSE tNUptBlueEpiN1 - tNUptBlueAirEpiN1 ENDIF;
wNUptBlueWEpiN1 = tNUptBlueWEpiN1 / uDepthWEpiN1;
wNUptNH4BlueEpiN1 = afNH4UptBlueEpiN1 * wNUptBlueWEpiN1;
wNUptNO3BlueEpiN1 = wNUptBlueWEpiN1 - wNUptNH4BlueEpiN1;
aPLimBlueEpiN1 = MAX(0.0,(1.0 - cPDBlueMinN1 / rPDBlueWEpiN1) * cPDBlueMaxN1 /(cPDBlueMaxN1 - cPDBlueMinN1));
aNLimBlueEpiN1 = MAX(0.0,(1.0 - cNDBlueMinN1 / rNDBlueWEpiN1) * cNDBlueMaxN1 /(cNDBlueMaxN1 - cNDBlueMinN1));
aSiLimBlueEpiN1 = oSiO2WEpiN1 /(hSiAssBlueN1 + oSiO2WEpiN1);
aMuTmLBlueEpiN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimBlueEpiN1 * uMuMaxTmBlueEpiN1;
aNutLimBlueEpiN1 = MIN(aPLimBlueEpiN1 , (MIN(aNLimBlueEpiN1,aSiLimBlueEpiN1)));
aMuBlueEpiN1 = aNutLimBlueEpiN1 * aMuTmLBlueEpiN1;
wDAssBlueEpiN1 = aMuBlueEpiN1*oDBlueWEpiN1;
oChlaBlueEpiN1 = mgPergN1 * rChDBlueEpiN1 * oDBlueWEpiN1;
aLLimBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN -9999 ELSE MAX(0.0,UseSteeleBlueN1 *(EXP(1.0) /(aExtSurfN1) *(EXP(- aLPARBotSurfN1/(cLOptRefBlueN1 *  uFunTmProdBlueSurfN1)) - EXP(- uLPARSurfN1 /(cLOptRefBlueN1 *  uFunTmProdBlueSurfN1)))) +(1.0 - UseSteeleBlueN1) *(1.0 /(aExtSurfN1) * LN((1.0 + uLPARSurfN1 / (hLRefBlueN1 * uFunTmProdBlueSurfN1)) / (1.0 + aLPARBotSurfN1 /(hLRefBlueN1 * uFunTmProdBlueSurfN1))))) ENDIF;
aRepLLimBlueN1 = (aLLimBlueSurfN1* aDBlueSurfN1 + aLLimBlueEpiN1* aDBlueWEpiN1) / (aDBlueSurfN1 + aDBlueWEpiN1);
rChDBlueSurfN1 = cChDBlueMaxN1 -(cChDBlueMaxN1 - cChDBlueMinN1) * aLLimBlueSurfN1;
aChlaBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE mgPergN1 * rChDBlueSurfN1 * aDBlueSurfN1 ENDIF;
oChlaBlueWN1 = IF ( aInclStratN1 EQ TRUE ) THEN (oChlaBlueEpiN1 * uDepthWEpiN1 + oChlaBlueHypN1 * uDepthWHypN1) / uDepthWN1 ELSE (oChlaBlueEpiN1 * uDepthWEpiN1) / uDepthWN1 ENDIF;
oChlaBlueN1 = IF ( aInclStratN1 EQ TRUE ) THEN (oChlaBlueEpiN1 * uDepthWEpiN1 + oChlaBlueHypN1 * uDepthWHypN1 + aChlaBlueSurfN1) / uDepthWN1 ELSE (oChlaBlueEpiN1 * uDepthWEpiN1 + aChlaBlueSurfN1 ) / uDepthWN1 ENDIF;
aChlaLimFloBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE (1.0 - (POW ((aChlaBlueSurfN1 / cDepthSurfN1) , (-cStepPowN1))) / ((POW (cChlaThrBlueN1 , (-cStepPowN1))) + (POW ((aChlaBlueSurfN1 / cDepthSurfN1) , (-cStepPowN1))))) ENDIF;
aChlaLimFloBlueEpiN1 = IF (InclSurfN1 EQ FALSE  OR aDBlueWEpiN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE (1.0 - (POW (oChlaBlueEpiN1 , (-cStepPowN1))) / ((POW (cChlaThrBlueN1 , (-cStepPowN1))) + (POW (oChlaBlueEpiN1 , (-cStepPowN1))))) ENDIF;
aChlaLimFloBlueHypN1 = IF (aInclStratN1 EQ FALSE OR aDBlueWHypN1 LT cDBlueSurfMinN1) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (oChlaBlueHypN1 , (-cStepPowN1))) / ((POW (cChlaThrBlueN1 , (-cStepPowN1))) + (POW (oChlaBlueHypN1 , (-cStepPowN1))))) ENDIF;
aVWLimFloBlueN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uVWindN1 , cStepPowN1)) / ((POW (cVWindThrBlueN1 , cStepPowN1)) + (POW (uVWindN1 , cStepPowN1)))) ENDIF;
aTmLimFloBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE (1.0 - (POW (uTmSurfN1 , (-cStepPowN1))) / ((POW (cTmThrBlueN1 , (-cStepPowN1))) + (POW (uTmSurfN1 , (-cStepPowN1))))) ENDIF;
aTmLimFloBlueEpiN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE (1.0 - (POW (uTmEpiN1 , (-cStepPowN1))) / ((POW (cTmThrBlueN1 , (-cStepPowN1))) + (POW (uTmEpiN1 , (-cStepPowN1))))) ENDIF;
aTmLimFloBlueHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uTmHypN1 , (-cStepPowN1))) / ((POW (cTmThrBlueN1 , (-cStepPowN1))) + (POW (uTmHypN1 , (-cStepPowN1))))) ENDIF;
aTrigFloBlueSurfN1 =  aVWLimFloBlueN1 * aTmLimFloBlueSurfN1 * aChlaLimFloBlueSurfN1;
aTrigFloBlueEpiN1 =  aVWLimFloBlueN1 * aTmLimFloBlueEpiN1 * aChlaLimFloBlueEpiN1;
aTrigFloBlueHypN1 =   aTmLimFloBlueHypN1 * aChlaLimFloBlueHypN1;
uVFloBlueSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE aTrigFloBlueSurfN1 * cVFloMaxBlueWN1 ENDIF;
uVFloBlueEpiN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueEpiN1 * cVFloMaxBlueWN1 ENDIF;
uVFloBlueHypN1 =  IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueHypN1 * cVFloMaxBlueWN1 ENDIF;
uVBlueHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE) THEN  - uCorVSetBlueHypN1 ELSE  uVFloBlueHypN1 - uCorVSetBlueHypN1  ENDIF;
tDSetBlueHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN1 LT 0.0) THEN - uVBlueHypN1 * oDBlueWHypN1 ELSE 0.0 ENDIF;
tPSetBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN1 * tDSetBlueHypN1 ENDIF;
tNSetBlueHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN1 * tDSetBlueHypN1 ENDIF;
tDFloBlueHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN1 GE 0.0) THEN uVBlueHypN1 * oDBlueWHypN1 ELSE 0.0 ENDIF;
tPFloBlueHypN1 =  tDFloBlueHypN1  * rPDBlueWHypN1;
tNFloBlueHypN1 =  tDFloBlueHypN1  * rNDBlueWHypN1;
uVBlueEpiN1 = IF (InclSurfN1 EQ TRUE) THEN uVFloBlueEpiN1 - uCorVSetBlueEpiN1 ELSE - uCorVSetBlueEpiN1 ENDIF;
tDSetBlueEpiN1 = IF (uVBlueEpiN1 LT 0.0) THEN - uVBlueEpiN1 * oDBlueWEpiN1 ELSE 0.0 ENDIF;
tDFloBlueEpiN1 = IF (uVBlueEpiN1 GE 0.0) THEN uVBlueEpiN1 * oDBlueWEpiN1 ELSE 0.0 ENDIF;
tNSetBlueEpiN1 = rNDBlueWEpiN1 * tDSetBlueEpiN1;
tNFloBlueEpiN1 =  tDFloBlueEpiN1  * rNDBlueWEpiN1;
tPSetBlueEpiN1 = rPDBlueWEpiN1 * tDSetBlueEpiN1;
tPFloBlueEpiN1 =  tDFloBlueEpiN1  * rPDBlueWEpiN1;
aFunTauSetOMSurfN1 =MIN(1.0 / POW(aFunDimSuspN1 +NearZeroN1 , (0.5)), 1.0);
uFunTmSetSurfN1 = POW(cThetaSetN1 , (uTmSurfN1-cTmRefN1));
uCorVSetBlueSurfN1 = (cVSetBlueN1 + uQOutInfN1 /mmPermN1 - uQInSeepN1 / mmPermN1) * aFunTauSetOMSurfN1 * uFunTmSetSurfN1;
uVBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN - uCorVSetBlueSurfN1 ELSE uVFloBlueSurfN1 - uCorVSetBlueSurfN1 ENDIF;
tDSetBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSEIF (uVBlueSurfN1 LT 0.0) THEN aDBlueSurfN1  / cDepthSurfN1 * (- uVBlueSurfN1) ELSE 0.0 ENDIF;
rNDBlueSurfN1 = aNBlueSurfN1 / (aDBlueSurfN1 + NearZeroN1);
tNSetBlueSurfN1 = rNDBlueSurfN1 * tDSetBlueSurfN1;
rPDBlueSurfN1 = aPBlueSurfN1 / (aDBlueSurfN1 + NearZeroN1);
tPSetBlueSurfN1 = rPDBlueSurfN1 * tDSetBlueSurfN1;
rPDGrenWHypN1 = oPGrenWHypN1 /(oDGrenWHypN1+NearZeroN1);
aVPUptMaxCrGrenHypN1 = MAX(0.0,cVPUptMaxGrenN1 * uFunTmProdGrenHypN1 *(cPDGrenMaxN1 - rPDGrenWHypN1) /(cPDGrenMaxN1 - cPDGrenMinN1));
aVPUptGrenHypN1 = oPO4WHypN1 * aVPUptMaxCrGrenHypN1 /(aVPUptMaxCrGrenHypN1 / cAffPUptGrenN1 + oPO4WHypN1);
wPUptGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aVPUptGrenHypN1 * oDGrenWHypN1 ENDIF;
wPUptPhytHypN1 = wPUptDiatHypN1 + wPUptGrenHypN1 + wPUptBlueHypN1;
wPExcrGrenWHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE (2.0 *rPDGrenWHypN1) /(cPDGrenMaxN1 + rPDGrenWHypN1) * rPDGrenWHypN1 * wDRespGrenWHypN1 ENDIF;
wPExcrPhytWHypN1 = wPExcrDiatWHypN1 + wPExcrGrenWHypN1 + wPExcrBlueWHypN1;
aPLimGrenHypN1 = MAX(0.0,(1.0 - cPDGrenMinN1 / rPDGrenWHypN1) * cPDGrenMaxN1 /(cPDGrenMaxN1 - cPDGrenMinN1));
aNutLimGrenHypN1 = MIN(aPLimGrenHypN1,(MIN(aNLimGrenHypN1,aSiLimGrenHypN1)));
aMuGrenHypN1 = aNutLimGrenHypN1 * aMuTmLGrenHypN1;
wDAssGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE aMuGrenHypN1*oDGrenWHypN1 ENDIF;
wDPrimGrenWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wDAssGrenHypN1 - wDRespGrenWHypN1 - wDLossGrenHypN1 - wDMortGrenWHypN1 -(tDSetGrenHypN1 -tDSetGrenEpiN1 - tDResusGrenN1) / uDepthWHypN1 ENDIF;
wDAssPhytHypN1 = wDAssDiatHypN1 + wDAssGrenHypN1 + wDAssBlueHypN1;
wO2ProdPhytHypN1 = molO2molCN1 * cCPerDWN1 * wDAssPhytHypN1;
wO2PrimWHypN1 = wO2ProdPhytHypN1 - wO2RespPhytWHypN1 + wO2UptNO3PhytHypN1;
wPLossGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN1 * wDLossGrenHypN1 ENDIF;
wPLossPhytHypN1 = wPLossDiatHypN1 + wPLossGrenHypN1 + wPLossBlueHypN1;
wPLossPhytPO4HypN1 = fDissLossN1 * wPLossPhytHypN1;
wPLossPhytDetHypN1 = wPLossPhytHypN1 - wPLossPhytPO4HypN1;
wPPrimDetWHypN1 = wPLossPhytDetHypN1 + wPMortPhytDetWHypN1;
wPPrimPO4WHypN1 = - wPUptPhytHypN1 + wPExcrPhytWHypN1 + wPLossPhytPO4HypN1 + wPMortPhytPO4WHypN1;
tPSetGrenHypN1 =IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN1 * tDSetGrenHypN1 ENDIF;
wPPrimGrenWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wPUptGrenHypN1 - wPExcrGrenWHypN1 - wPLossGrenHypN1 - wPMortGrenWHypN1 -(tPSetGrenHypN1 -tPSetGrenEpiN1 - tPResusGrenN1) / uDepthWHypN1 ENDIF;
wPConsGrenZooHypN1 = rPDGrenWHypN1 * wDConsGrenZooHypN1;
wPConsPhytZooHypN1 = wPConsDiatZooHypN1 + wPConsGrenZooHypN1 + wPConsBlueZooHypN1;
wPConsZooHypN1 = wPConsPhytZooHypN1 + wPConsDetZooHypN1;
wPAssZooHypN1 = afPAssZooHypN1 * wPConsZooHypN1;
wPEgesZooHypN1 = wPConsZooHypN1 - wPAssZooHypN1;
wPEgesZooPO4HypN1 = fDissEgesZooN1*wPEgesZooHypN1;
wPEgesZooDetHypN1 = wPEgesZooHypN1 - wPEgesZooPO4HypN1;
aPConsZooSpHypN1 = wPConsZooHypN1 / oPZooHypN1;
aPGrazSpHypN1 = wPConsZooHypN1 / oPOMWHypN1;
wDPrimBlueWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wDAssBlueHypN1 - wDRespBlueWHypN1 - wDLossBlueHypN1 - wDMortBlueWHypN1 + (tDResusBlueN1 + tDSetBlueEpiN1 - tDSetBlueHypN1 - tDFloBlueHypN1) / uDepthWHypN1 ENDIF;
wPPrimBlueWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wPUptBlueHypN1 - wPExcrBlueWHypN1 - wPLossBlueHypN1 - wPMortBlueWHypN1+ (tPResusBlueN1 + tPSetBlueEpiN1 - tPSetBlueHypN1 - tPFloBlueHypN1) / uDepthWHypN1 ENDIF;
wNPrimBlueWHypN1 = IF (aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNUptBlueHypN1 - wNExcrBlueWHypN1 - wNLossBlueHypN1 - wNMortBlueWHypN1+ (tNResusBlueN1 + tNSetBlueEpiN1 - tNSetBlueHypN1 - tNFloBlueHypN1) / uDepthWHypN1 ENDIF;
tDSetPhytHypN1 = tDSetDiatHypN1 + tDSetGrenHypN1 + tDSetBlueHypN1;
wDPrimPhytWHypN1 = wDPrimDiatWHypN1 + wDPrimGrenWHypN1 + wDPrimBlueWHypN1;
tPSetPhytHypN1 = tPSetDiatHypN1 + tPSetGrenHypN1 + tPSetBlueHypN1;
wPPrimPhytWHypN1 = wPPrimDiatWHypN1 + wPPrimGrenWHypN1 + wPPrimBlueWHypN1;
tNSetPhytHypN1 = tNSetDiatHypN1 + tNSetGrenHypN1 + tNSetBlueHypN1;
wNPrimPhytWHypN1 = wNPrimDiatWHypN1 + wNPrimGrenWHypN1 + wNPrimBlueWHypN1;
tDSetTotHypN1 = tDSetIMHypN1 + tDSetDetHypN1 + tDSetPhytHypN1;
tPSetTotHypN1 = tPSetAIMHypN1 + tPSetDetHypN1 + tPSetPhytHypN1;
tNSetTotHypN1 = tNSetDetHypN1 + tNSetPhytHypN1;
aLLimGrenEpiN1 = UseSteeleGrenN1 *(EXP(1.0) /(aExtCoefEpiN1 * uDepthWEpiN1) *(EXP(- aLPARBotEpiN1 /(cLOptRefGrenN1 * uFunTmProdGrenEpiN1)) - EXP(- aLPARBotSurfN1 /(cLOptRefGrenN1 * uFunTmProdGrenEpiN1)))) +(1.0 - UseSteeleGrenN1) *(1.0 /(aExtCoefEpiN1 * uDepthWEpiN1) * LN((1.0 + aLPARBotSurfN1 / (hLRefGrenN1 * uFunTmProdGrenEpiN1)) / (1.0 + aLPARBotEpiN1 /(hLRefGrenN1 * uFunTmProdGrenEpiN1))));
rChDGrenEpiN1 = cChDGrenMaxN1 -(cChDGrenMaxN1 - cChDGrenMinN1) * aLLimGrenEpiN1;
oChlaGrenEpiN1 = mgPergN1 * rChDGrenEpiN1 * oDGrenWEpiN1;
aLLimDiatEpiN1 = UseSteeleDiatN1 *(EXP(1.0) /(aExtCoefEpiN1 * uDepthWEpiN1) *(EXP(- aLPARBotEpiN1 /(cLOptRefDiatN1 * uFunTmProdDiatEpiN1)) - EXP(- aLPARBotSurfN1 /(cLOptRefDiatN1 * uFunTmProdDiatEpiN1)))) +(1.0 - UseSteeleDiatN1) *(1.0 /(aExtCoefEpiN1 * uDepthWEpiN1) * LN((1.0 + aLPARBotSurfN1 / (hLRefDiatN1 * uFunTmProdDiatEpiN1)) / (1.0 + aLPARBotEpiN1 /(hLRefDiatN1 * uFunTmProdDiatEpiN1))));
rChDDiatEpiN1 = cChDDiatMaxN1 -(cChDDiatMaxN1 - cChDDiatMinN1) * aLLimDiatEpiN1;
oChlaDiatEpiN1 = mgPergN1 * rChDDiatEpiN1 * oDDiatWEpiN1;
oChlaEpiN1 = oChlaDiatEpiN1 + oChlaGrenEpiN1 + oChlaBlueEpiN1;
wDRespBlueWEpiN1 = ukDRespTmBlueEpiN1 * oDBlueWEpiN1;
wDLossBlueEpiN1 = ukLossTmBlueEpiN1 * oDBlueWEpiN1;
wDMortBlueWEpiN1 = kMortBlueWN1 * oDBlueWEpiN1;
ukDDecBlueEpiN1 = ukDRespTmBlueEpiN1 + ukLossTmBlueEpiN1 + kMortBlueWN1 +(uCorVSetBlueEpiN1 * uFunTmSetEpiN1) / uDepthWEpiN1;
wPExcrBlueWEpiN1 = (rPDBlueWEpiN1 * 2.0 )/(cPDBlueMaxN1 + rPDBlueWEpiN1) * rPDBlueWEpiN1 * wDRespBlueWEpiN1 ;
wPLossBlueEpiN1 = rPDBlueWEpiN1 * wDLossBlueEpiN1;
wPMortBlueWEpiN1 = kMortBlueWN1 * oPBlueWEpiN1;
wNExcrBlueWEpiN1 = (rNDBlueWEpiN1 *2.0)/(cNDBlueMaxN1 + rNDBlueWEpiN1) * rNDBlueWEpiN1 * wDRespBlueWEpiN1 ;
wNLossBlueEpiN1 = rNDBlueWEpiN1 * wDLossBlueEpiN1;
wNMortBlueWEpiN1 = kMortBlueWN1 * oNBlueWEpiN1;
wDPrimBlueWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wDAssBlueEpiN1 - wDRespBlueWEpiN1 - wDLossBlueEpiN1 - wDMortBlueWEpiN1 + (tDSetBlueSurfN1-tDFloBlueEpiN1 + tDFloBlueHypN1- tDSetBlueEpiN1 ) / uDepthWEpiN1 ELSE wDAssBlueEpiN1 - wDRespBlueWEpiN1 - wDLossBlueEpiN1 - wDMortBlueWEpiN1 + (tDResusBlueN1 + tDSetBlueSurfN1 - tDSetBlueEpiN1 -  tDFloBlueEpiN1) / uDepthWEpiN1 ENDIF;
wPPrimBlueWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wPUptBlueEpiN1 - wPExcrBlueWEpiN1 - wPLossBlueEpiN1 - wPMortBlueWEpiN1+ (tPSetBlueSurfN1-tPFloBlueEpiN1 + tPFloBlueHypN1- tPSetBlueEpiN1 ) / uDepthWEpiN1 ELSE wPUptBlueEpiN1 - wPExcrBlueWEpiN1 - wPLossBlueEpiN1 - wPMortBlueWEpiN1+ (tPResusBlueN1 + tPSetBlueSurfN1 - tPSetBlueEpiN1 -  tPFloBlueEpiN1) / uDepthWEpiN1 ENDIF;
wNPrimBlueWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wNUptBlueEpiN1 - wNExcrBlueWEpiN1 - wNLossBlueEpiN1 - wNMortBlueWEpiN1 + (tNSetBlueSurfN1-tNFloBlueEpiN1 + tNFloBlueHypN1- tNSetBlueEpiN1 ) / uDepthWEpiN1 ELSE wNUptBlueEpiN1 - wNExcrBlueWEpiN1 - wNLossBlueEpiN1 - wNMortBlueWEpiN1+ (tNResusBlueN1 + tNSetBlueSurfN1 - tNSetBlueEpiN1 -  tNFloBlueEpiN1) / uDepthWEpiN1 ENDIF;
ukDilSurfN1 = ukOutEpiN1;
tDDilBlueSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE ukDilSurfN1 * aDBlueSurfN1 ENDIF;
tNDilBlueSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE ukDilSurfN1 * aNBlueSurfN1 ENDIF;
tPDilBlueSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE ukDilSurfN1 * aPBlueSurfN1 ENDIF;
tDTranBlueSurfN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE uDLoadBlueSurfN1 - tDDilBlueSurfN1 ENDIF;
tPTranBlueSurfN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE uPLoadBlueSurfN1 - tPDilBlueSurfN1 ENDIF;
tNTranBlueSurfN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSEIF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE uNLoadBlueSurfN1 - tNDilBlueSurfN1 ENDIF;
uMuMaxTmBlueSurfN1 = cMuMaxBlueN1 * uFunTmProdBlueSurfN1;
aMuTmLBlueSurfN1 = ufDayN1 * aLLimBlueSurfN1 * uMuMaxTmBlueSurfN1;
aPLimBlueSurfN1 = MAX(0.0,(1.0 - cPDBlueMinN1 / rPDBlueSurfN1) * cPDBlueMaxN1 /(cPDBlueMaxN1 - cPDBlueMinN1));
aNLimBlueSurfN1 = MAX(0.0,(1.0 - cNDBlueMinN1 / rNDBlueSurfN1) * cNDBlueMaxN1 /(cNDBlueMaxN1 - cNDBlueMinN1));
aSiLimBlueSurfN1 = oSiO2WEpiN1 /(hSiAssBlueN1 + oSiO2WEpiN1);
aNutLimBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN -9999 ELSE MIN(aPLimBlueSurfN1,MIN(aNLimBlueSurfN1,aSiLimBlueSurfN1)) ENDIF;
aRepPLimBlueN1 = (aPLimBlueSurfN1* aDBlueSurfN1 + aPLimBlueEpiN1* aDBlueWEpiN1) / (aDBlueSurfN1 + aDBlueWEpiN1);
aRepNLimBlueN1 = (aNLimBlueSurfN1* aDBlueSurfN1 + aNLimBlueEpiN1* aDBlueWEpiN1) / (aDBlueSurfN1 + aDBlueWEpiN1);
aRepNutLimBlueN1 = (aNutLimBlueSurfN1* aDBlueSurfN1 + aNutLimBlueEpiN1* aDBlueWEpiN1) / (aDBlueSurfN1 + aDBlueWEpiN1);
aMuBlueSurfN1 = aNutLimBlueSurfN1 * aMuTmLBlueSurfN1;
tDAssBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE aMuBlueSurfN1 * aDBlueSurfN1 ENDIF;
aVNUptMaxCrBlueSurfN1 = MAX(0.0,cVNUptMaxBlueN1 * uFunTmProdBlueSurfN1 * (cNDBlueMaxN1 - rNDBlueSurfN1) /(cNDBlueMaxN1 - cNDBlueMinN1));
aVPUptMaxCrBlueSurfN1 = MAX(0.0,cVPUptMaxBlueN1 * uFunTmProdBlueSurfN1 *(cPDBlueMaxN1 - rPDBlueSurfN1) /(cPDBlueMaxN1 - cPDBlueMinN1));
ahNUptBlueSurfN1 = aVNUptMaxCrBlueSurfN1 / cAffNUptBlueN1;
aVNUptBlueSurfN1 = oNDissWEpiN1 * aVNUptMaxCrBlueSurfN1 /(ahNUptBlueSurfN1 + oNDissWEpiN1);
aVPUptBlueSurfN1 = oPO4WEpiN1 * aVPUptMaxCrBlueSurfN1 /(aVPUptMaxCrBlueSurfN1 / cAffPUptBlueN1 + oPO4WEpiN1);
tNUptBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE aVNUptBlueSurfN1 * aDBlueSurfN1 ENDIF;
aNfixBlueSurfN1 = rNfixBlueSurfN1 *aChlaBlueSurfN1 /ugPergN1;
tNUptBlueAirSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSEIF (InclNfixN1 EQ FALSE) THEN 0.0 ELSE aNfixBlueSurfN1 ENDIF;
tNUptBlueWSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSEIF (InclNfixN1 EQ FALSE) THEN tNUptBlueSurfN1 ELSE tNUptBlueSurfN1 - tNUptBlueAirSurfN1 ENDIF;
afNH4UptBlueSurfN1 = oNH4WEpiN1 * oNO3WEpiN1 /((ahNUptBlueSurfN1 + oNH4WEpiN1) *(ahNUptBlueSurfN1 + oNO3WEpiN1)) + oNH4WEpiN1 * ahNUptBlueSurfN1 /((oNH4WEpiN1 + oNO3WEpiN1) *(ahNUptBlueSurfN1 + oNO3WEpiN1));
tNUptNH4BlueSurfN1 = afNH4UptBlueSurfN1 * tNUptBlueWSurfN1;
tNUptNO3BlueSurfN1 = tNUptBlueWSurfN1 - tNUptNH4BlueSurfN1;
tPUptBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE aVPUptBlueSurfN1 * aDBlueSurfN1 ENDIF;
tDRespBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE ukDRespTmBlueSurfN1 *aDBlueSurfN1 ENDIF;
tNExcrBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE (rNDBlueSurfN1 * 2.0 )/(cNDBlueMaxN1 + rNDBlueSurfN1) * rNDBlueSurfN1 * tDRespBlueSurfN1 ENDIF;
tPExcrBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE (rPDBlueSurfN1 * 2.0 )/(cPDBlueMaxN1 + rPDBlueSurfN1) * rPDBlueSurfN1 * tDRespBlueSurfN1 ENDIF;
tDMortBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE kMortBlueWN1 * aDBlueSurfN1 ENDIF;
tNMortBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE kMortBlueWN1 * aNBlueSurfN1 ENDIF;
wNMortBlueNH4WSurfN1 = fDissMortPhytN1 * tNMortBlueSurfN1 / uDepthWEpiN1;
wNMortBlueDetSurfN1 = ( 1 -fDissMortPhytN1) * tNMortBlueSurfN1 / uDepthWEpiN1;
tPMortBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE kMortBlueWN1 * aPBlueSurfN1 ENDIF;
uFunTmLossSurfN1 = EXP(-0.5/(cSigTmLossN1*cSigTmLossN1) *((uTmSurfN1-cTmOptLossN1)*(uTmSurfN1-cTmOptLossN1) -(cTmRefN1-cTmOptLossN1)*(cTmRefN1-cTmOptLossN1)));
ukLossTmBlueSurfN1 = UseLossN1 * kLossBlueN1 * uFunTmLossSurfN1;
tDLossBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE ukLossTmBlueSurfN1 * aDBlueSurfN1 ENDIF;
tPLossBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE rPDBlueSurfN1 * tDLossBlueSurfN1 ENDIF;
tNLossBlueSurfN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE rNDBlueSurfN1 * tDLossBlueSurfN1 ENDIF;
tDPrimBlueSurfN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE tDAssBlueSurfN1 - tDRespBlueSurfN1 + tDFloBlueEpiN1 - tDSetBlueSurfN1- tDMortBlueSurfN1 ENDIF;
tNPrimBlueSurfN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE tNUptBlueSurfN1 - tNExcrBlueSurfN1  + tNFloBlueEpiN1 - tNSetBlueSurfN1 - tNMortBlueSurfN1 ENDIF;
tPPrimBlueSurfN1 = IF (InclSurfN1 EQ FALSE) THEN 0.0 ELSE tPUptBlueSurfN1 - tPExcrBlueSurfN1 + tPFloBlueEpiN1 - tPSetBlueSurfN1- tPMortBlueSurfN1 ENDIF;
tDPrimBlueSN1 = IF ( aInclStratN1 EQ FALSE) THEN tDSetBlueEpiN1 - tDResusBlueN1 - tDMortBlueSN1 - tDRespBlueSN1 ELSE tDSetBlueHypN1 - tDResusBlueN1 - tDMortBlueSN1 - tDRespBlueSN1 ENDIF;
tPPrimBlueSN1 = IF ( aInclStratN1 EQ FALSE) THEN tPSetBlueEpiN1 - tPResusBlueN1 - tPMortBlueSN1 - tPExcrBlueSN1 ELSE tPSetBlueHypN1 - tPResusBlueN1 - tPMortBlueSN1 - tPExcrBlueSN1 ENDIF;
tNPrimBlueSN1 = IF (aInclStratN1 EQ FALSE) THEN tNSetBlueEpiN1 - tNResusBlueN1 - tNMortBlueSN1 - tNExcrBlueSN1 ELSE tNSetBlueHypN1 - tNResusBlueN1 - tNMortBlueSN1 - tNExcrBlueSN1 ENDIF;
aVPUptMaxCrGrenEpiN1 = MAX(0.0,cVPUptMaxGrenN1 * uFunTmProdGrenEpiN1 *(cPDGrenMaxN1 - rPDGrenWEpiN1) /(cPDGrenMaxN1 - cPDGrenMinN1));
aVPUptGrenEpiN1 = oPO4WEpiN1 * aVPUptMaxCrGrenEpiN1 /(aVPUptMaxCrGrenEpiN1 / cAffPUptGrenN1 + oPO4WEpiN1);
wPUptGrenEpiN1 = aVPUptGrenEpiN1 * oDGrenWEpiN1;
aVNUptMaxCrGrenEpiN1 = MAX(0.0,cVNUptMaxGrenN1 * uFunTmProdGrenEpiN1 * (cNDGrenMaxN1 - rNDGrenWEpiN1) /(cNDGrenMaxN1 - cNDGrenMinN1));
ahNUptGrenEpiN1 = aVNUptMaxCrGrenEpiN1 / cAffNUptGrenN1;
aVNUptGrenEpiN1 = oNDissWEpiN1 * aVNUptMaxCrGrenEpiN1 /(ahNUptGrenEpiN1 + oNDissWEpiN1);
wNUptGrenEpiN1 = aVNUptGrenEpiN1 * oDGrenWEpiN1;
afNH4UptGrenEpiN1 = oNH4WEpiN1 * oNO3WEpiN1 /((ahNUptGrenEpiN1 + oNH4WEpiN1) *(ahNUptGrenEpiN1 + oNO3WEpiN1)) + oNH4WEpiN1 * ahNUptGrenEpiN1 /((oNH4WEpiN1 + oNO3WEpiN1) *(ahNUptGrenEpiN1 + oNO3WEpiN1));
wNUptNH4GrenEpiN1 = afNH4UptGrenEpiN1 * wNUptGrenEpiN1;
wNUptNO3GrenEpiN1 = wNUptGrenEpiN1 - wNUptNH4GrenEpiN1;
aPLimGrenEpiN1 = MAX(0.0,(1.0 - cPDGrenMinN1 / rPDGrenWEpiN1) * cPDGrenMaxN1 /(cPDGrenMaxN1 - cPDGrenMinN1));
aNLimGrenEpiN1 = MAX(0.0,(1.0 - cNDGrenMinN1 / rNDGrenWEpiN1) * cNDGrenMaxN1 /(cNDGrenMaxN1 - cNDGrenMinN1));
aSiLimGrenEpiN1 = oSiO2WEpiN1 /(hSiAssGrenN1 + oSiO2WEpiN1);
aMuTmLGrenEpiN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimGrenEpiN1 * uMuMaxTmGrenEpiN1;
aNutLimGrenEpiN1 = MIN(aPLimGrenEpiN1 , (MIN(aNLimGrenEpiN1,aSiLimGrenEpiN1)));
aMuGrenEpiN1 = aNutLimGrenEpiN1 * aMuTmLGrenEpiN1;
wDAssGrenEpiN1 = aMuGrenEpiN1*oDGrenWEpiN1;
aExtChGrenEpiN1 = cExtSpGrenN1 / rChDGrenEpiN1;
wDRespGrenWEpiN1 = ukDRespTmGrenEpiN1 * oDGrenWEpiN1;
wDLossGrenEpiN1 = ukLossTmGrenEpiN1 * oDGrenWEpiN1;
wDMortGrenWEpiN1 = kMortGrenWN1 * oDGrenWEpiN1;
ukDDecGrenEpiN1 = ukDRespTmGrenEpiN1 + ukLossTmGrenEpiN1 + kMortGrenWN1 +(uCorVSetGrenEpiN1 * uFunTmSetEpiN1) / uDepthWEpiN1;
wPExcrGrenWEpiN1 = (2.0 *rPDGrenWEpiN1) /(cPDGrenMaxN1 + rPDGrenWEpiN1) * rPDGrenWEpiN1 * wDRespGrenWEpiN1 ;
wPLossGrenEpiN1 = rPDGrenWEpiN1 * wDLossGrenEpiN1;
wPMortGrenWEpiN1 = kMortGrenWN1 * oPGrenWEpiN1;
wNExcrGrenWEpiN1 = (2.0 * rNDGrenWEpiN1) /(cNDGrenMaxN1 + rNDGrenWEpiN1) * rNDGrenWEpiN1 * wDRespGrenWEpiN1;
wNLossGrenEpiN1 = rNDGrenWEpiN1 * wDLossGrenEpiN1;
wNMortGrenWEpiN1 = kMortGrenWN1 * oNGrenWEpiN1;
wDPrimGrenWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wDAssGrenEpiN1 - wDRespGrenWEpiN1 - wDLossGrenEpiN1 - wDMortGrenWEpiN1 -(tDSetGrenEpiN1 ) / uDepthWEpiN1 ELSE wDAssGrenEpiN1 - wDRespGrenWEpiN1 - wDLossGrenEpiN1 - wDMortGrenWEpiN1 -(tDSetGrenEpiN1 - tDResusGrenN1) / uDepthWEpiN1 ENDIF;
wPPrimGrenWEpiN1 =IF (aInclStratN1 EQ TRUE ) THEN wPUptGrenEpiN1 - wPExcrGrenWEpiN1 - wPLossGrenEpiN1 - wPMortGrenWEpiN1 -(tPSetGrenEpiN1 ) / uDepthWEpiN1 ELSE wPUptGrenEpiN1 - wPExcrGrenWEpiN1 - wPLossGrenEpiN1 - wPMortGrenWEpiN1 -(tPSetGrenEpiN1 - tPResusGrenN1) / uDepthWEpiN1 ENDIF;
wNPrimGrenWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wNUptGrenEpiN1 - wNExcrGrenWEpiN1 - wNLossGrenEpiN1 - wNMortGrenWEpiN1 -(tNSetGrenEpiN1 ) / uDepthWEpiN1 ELSE wNUptGrenEpiN1 - wNExcrGrenWEpiN1 - wNLossGrenEpiN1 - wNMortGrenWEpiN1 -(tNSetGrenEpiN1 - tNResusGrenN1) / uDepthWEpiN1 ENDIF;
tDPrimGrenSN1 = IF ( aInclStratN1 EQ FALSE) THEN tDSetGrenEpiN1 - tDResusGrenN1 - tDMortGrenSN1 - tDRespGrenSN1 ELSE tDSetGrenHypN1 - tDResusGrenN1 - tDMortGrenSN1 - tDRespGrenSN1 ENDIF;
tPPrimGrenSN1 = IF ( aInclStratN1 EQ FALSE) THEN tPSetGrenEpiN1 - tPResusGrenN1 - tPMortGrenSN1 - tPExcrGrenSN1 ELSE tPSetGrenHypN1 - tPResusGrenN1 - tPMortGrenSN1 - tPExcrGrenSN1 ENDIF;
tNPrimGrenSN1 = IF ( aInclStratN1 EQ FALSE) THEN tNSetGrenEpiN1 - tNResusGrenN1 - tNMortGrenSN1 - tNExcrGrenSN1 ELSE tNSetGrenHypN1 - tNResusGrenN1 - tNMortGrenSN1 - tNExcrGrenSN1 ENDIF;
aVPUptMaxCrDiatEpiN1 = MAX(0.0,cVPUptMaxDiatN1 * uFunTmProdDiatEpiN1 *(cPDDiatMaxN1 - rPDDiatWEpiN1) /(cPDDiatMaxN1 - cPDDiatMinN1));
aVPUptDiatEpiN1 = oPO4WEpiN1 * aVPUptMaxCrDiatEpiN1 /(aVPUptMaxCrDiatEpiN1 / cAffPUptDiatN1 + oPO4WEpiN1);
wPUptDiatEpiN1 = aVPUptDiatEpiN1 * oDDiatWEpiN1;
aVNUptMaxCrDiatEpiN1 = MAX(0.0,cVNUptMaxDiatN1 * uFunTmProdDiatEpiN1 * (cNDDiatMaxN1 - rNDDiatWEpiN1) /(cNDDiatMaxN1 - cNDDiatMinN1));
ahNUptDiatEpiN1 = aVNUptMaxCrDiatEpiN1 / cAffNUptDiatN1;
aVNUptDiatEpiN1 = oNDissWEpiN1 * aVNUptMaxCrDiatEpiN1 /(ahNUptDiatEpiN1 + oNDissWEpiN1);
wNUptDiatEpiN1 = aVNUptDiatEpiN1 * oDDiatWEpiN1;
afNH4UptDiatEpiN1 = oNH4WEpiN1 * oNO3WEpiN1 /((ahNUptDiatEpiN1 + oNH4WEpiN1) *(ahNUptDiatEpiN1 + oNO3WEpiN1)) + oNH4WEpiN1 * ahNUptDiatEpiN1 /((oNH4WEpiN1 + oNO3WEpiN1) *(ahNUptDiatEpiN1 + oNO3WEpiN1));
wNUptNH4DiatEpiN1 = afNH4UptDiatEpiN1 * wNUptDiatEpiN1;
wNUptNO3DiatEpiN1 = wNUptDiatEpiN1 - wNUptNH4DiatEpiN1;
aPLimDiatEpiN1 = MAX(0.0,(1.0 - cPDDiatMinN1 / rPDDiatWEpiN1) * cPDDiatMaxN1 /(cPDDiatMaxN1 - cPDDiatMinN1));
aNLimDiatEpiN1 = MAX(0.0,(1.0 - cNDDiatMinN1 / rNDDiatWEpiN1) * cNDDiatMaxN1 /(cNDDiatMaxN1 - cNDDiatMinN1));
aSiLimDiatEpiN1 = oSiO2WEpiN1 /(hSiAssDiatN1 + oSiO2WEpiN1);
aMuTmLDiatEpiN1 = ufDayN1 *(1.0 - afCovSurfVegN1) * aLLimDiatEpiN1 * uMuMaxTmDiatEpiN1;
aNutLimDiatEpiN1 = MIN(aPLimDiatEpiN1 , (MIN(aNLimDiatEpiN1,aSiLimDiatEpiN1)));
aMuDiatEpiN1 = aNutLimDiatEpiN1 * aMuTmLDiatEpiN1;
wDAssDiatEpiN1 = aMuDiatEpiN1*oDDiatWEpiN1;
aExtChDiatEpiN1 = cExtSpDiatN1 / rChDDiatEpiN1;
wDRespDiatWEpiN1 = ukDRespTmDiatEpiN1 * oDDiatWEpiN1;
wDLossDiatEpiN1 = ukLossTmDiatEpiN1 * oDDiatWEpiN1;
wDMortDiatWEpiN1 = kMortDiatWN1 * oDDiatWEpiN1;
ukDDecDiatEpiN1 = ukDRespTmDiatEpiN1 + ukLossTmDiatEpiN1 + kMortDiatWN1 +(uCorVSetDiatEpiN1 * uFunTmSetEpiN1) / uDepthWEpiN1;
wPExcrDiatWEpiN1 = (2.0 * rPDDiatWEpiN1) /(cPDDiatMaxN1 + rPDDiatWEpiN1) * rPDDiatWEpiN1 * wDRespDiatWEpiN1 ;
wPLossDiatEpiN1 = rPDDiatWEpiN1 * wDLossDiatEpiN1;
wPMortDiatWEpiN1 = kMortDiatWN1 * oPDiatWEpiN1;
wNExcrDiatWEpiN1 = (2.0 * rNDDiatWEpiN1) /(cNDDiatMaxN1 + rNDDiatWEpiN1) * rNDDiatWEpiN1 * wDRespDiatWEpiN1 ;
wNLossDiatEpiN1 = rNDDiatWEpiN1 * wDLossDiatEpiN1;
wNMortDiatWEpiN1 = kMortDiatWN1 * oNDiatWEpiN1;
wDPrimDiatWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wDAssDiatEpiN1 - wDRespDiatWEpiN1 - wDLossDiatEpiN1 - wDMortDiatWEpiN1 -(tDSetDiatEpiN1 ) / uDepthWEpiN1 ELSE wDAssDiatEpiN1 - wDRespDiatWEpiN1 - wDLossDiatEpiN1 - wDMortDiatWEpiN1 -(tDSetDiatEpiN1 - tDResusDiatN1) / uDepthWEpiN1 ENDIF;
wPPrimDiatWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wPUptDiatEpiN1 - wPExcrDiatWEpiN1 - wPLossDiatEpiN1 - wPMortDiatWEpiN1 -(tPSetDiatEpiN1 ) / uDepthWEpiN1 ELSE wPUptDiatEpiN1 - wPExcrDiatWEpiN1 - wPLossDiatEpiN1 - wPMortDiatWEpiN1 -(tPSetDiatEpiN1 - tPResusDiatN1) / uDepthWEpiN1 ENDIF;
wNPrimDiatWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wNUptDiatEpiN1 - wNExcrDiatWEpiN1 - wNLossDiatEpiN1 - wNMortDiatWEpiN1 -(tNSetDiatEpiN1 ) / uDepthWEpiN1 ELSE wNUptDiatEpiN1 - wNExcrDiatWEpiN1 - wNLossDiatEpiN1 - wNMortDiatWEpiN1 -(tNSetDiatEpiN1 - tNResusDiatN1) / uDepthWEpiN1 ENDIF;
tDPrimDiatSN1 = IF ( aInclStratN1 EQ FALSE) THEN tDSetDiatEpiN1 - tDResusDiatN1 - tDMortDiatSN1 - tDRespDiatSN1 ELSE tDSetDiatHypN1 - tDResusDiatN1 - tDMortDiatSN1 - tDRespDiatSN1 ENDIF;
tPPrimDiatSN1 = IF ( aInclStratN1 EQ FALSE) THEN tPSetDiatEpiN1 - tPResusDiatN1 - tPMortDiatSN1 - tPExcrDiatSN1 ELSE tPSetDiatHypN1 - tPResusDiatN1 - tPMortDiatSN1 - tPExcrDiatSN1 ENDIF;
tNPrimDiatSN1 = IF ( aInclStratN1 EQ FALSE) THEN tNSetDiatEpiN1 - tNResusDiatN1 - tNMortDiatSN1 - tNExcrDiatSN1 ELSE tNSetDiatHypN1 - tNResusDiatN1 - tNMortDiatSN1 - tNExcrDiatSN1 ENDIF;
oChlaN1 = IF ( aInclStratN1 EQ TRUE ) THEN (oChlaEpiN1 * uDepthWEpiN1 + oChlaHypN1 * uDepthWHypN1 + aChlaBlueSurfN1) / uDepthWN1 ELSE (oChlaEpiN1 * uDepthWEpiN1+ aChlaBlueSurfN1 ) / uDepthWN1 ENDIF;
oChlaWN1 = IF ( aInclStratN1 EQ TRUE ) THEN (oChlaEpiN1 * uDepthWEpiN1 + oChlaHypN1 * uDepthWHypN1) / uDepthWN1 ELSE (oChlaEpiN1 * uDepthWEpiN1) / uDepthWN1 ENDIF;
aChlaHN1 = oChlaN1 * uDepthWN1;
aLPIEpiN1 =  (aLPARBotSurfN1- aLPARBotEpiOpenN1 + uhLVegN1* LN((1.0 +aLPARBotEpiOpenN1/ uhLVegN1)  /(1.0 + aLPARBotSurfN1  / uhLVegN1) + NearZeroN1  ) ) / uDepthWEpiN1;
aLPIHypN1 =  (aLPARBotEpiN1- aLPARBotHypOpenN1 + uhLVegN1* LN((1.0 +aLPARBotHypOpenN1/ uhLVegN1)  /(1.0 + aLPARBotEpiN1  / uhLVegN1) + NearZeroN1  ) ) / uDepthWHypN1;
aLPIMeasEpiN1 =  (aLPARBotSurfN1- aLPARBotEpiN1 ) /aExtCoefEpiN1;
aLPIMeasHypN1 =  (aLPARBotEpiN1- aLPARBotHypN1) / aExtCoefHypN1;
aLMeasEpiN1 = aLPARBotSurfN1 * EXP(- aExtCoefOpenEpiN1 *cDepthMeasoChlN1);
aLMeasHypN1 = aLPARBotEpiN1 * EXP(- aExtCoefOpenHypN1 * (cDepthMeasoChlN1 -  uDepthWEpiN1));
aLPAREuphoN1 = PerCentN1 * uLPARSurfN1;
aDepthEuphWN1 = IF (aLPAREuphoN1 GT aLPARBotSurfN1) THEN  0.0 ELSEIF (aLPAREuphoN1 GE aLPARBotEpiOpenN1) THEN - LN(aLPAREuphoN1/aLPARBotSurfN1) / aExtCoefEpiN1 ELSE uDepthWEpiN1 - LN(aLPAREuphoN1/aLPARBotEpiOpenN1) / aExtCoefOpenHypN1 ENDIF;
oChlaMeasEpiN1 = IF (cDepthMeasoChlN1 LT aDepthEuphWN1) THEN aLMeasEpiN1/ aLPIMeasEpiN1 *oChlaEpiN1 * uDepthWEpiN1 ELSE oChlaEpiN1 ENDIF;
oChlaMeasHypN1 = IF (cDepthMeasoChlN1 LT aDepthEuphWN1) THEN  aLMeasHypN1/ aLPIMeasHypN1 *oChlaHypN1* uDepthWHypN1  ELSE oChlaHypN1 ENDIF;
oChlaMeasWN1 = IF (cDepthMeasoChlN1 LT uDepthWEpiN1) THEN oChlaMeasEpiN1 ELSE oChlaMeasHypN1 ENDIF;
wDAssPhytEpiN1 = wDAssDiatEpiN1 + wDAssGrenEpiN1 + wDAssBlueEpiN1;
wDRespPhytWEpiN1 = wDRespDiatWEpiN1 + wDRespGrenWEpiN1 + wDRespBlueWEpiN1;
wDMortPhytWEpiN1 = wDMortDiatWEpiN1 + wDMortGrenWEpiN1 + wDMortBlueWEpiN1;
tDSetPhytEpiN1 = tDSetDiatEpiN1 + tDSetGrenEpiN1 + tDSetBlueEpiN1;
wDLossPhytEpiN1 = wDLossDiatEpiN1 + wDLossGrenEpiN1 + wDLossBlueEpiN1 + tDLossBlueSurfN1 / uDepthWEpiN1;
wDPrimPhytWEpiN1 = wDPrimDiatWEpiN1 + wDPrimGrenWEpiN1 + wDPrimBlueWEpiN1;
wPUptPhytEpiN1 = wPUptDiatEpiN1 + wPUptGrenEpiN1 + wPUptBlueEpiN1;
wPExcrPhytWEpiN1 = wPExcrDiatWEpiN1 + wPExcrGrenWEpiN1 + wPExcrBlueWEpiN1;
wPMortPhytWEpiN1 = wPMortDiatWEpiN1 + wPMortGrenWEpiN1 + wPMortBlueWEpiN1;
tPSetPhytEpiN1 = tPSetDiatEpiN1 + tPSetGrenEpiN1 + tPSetBlueEpiN1;
wPLossPhytEpiN1 = wPLossDiatEpiN1 + wPLossGrenEpiN1 + wPLossBlueEpiN1 + tPLossBlueSurfN1 / uDepthWEpiN1;
wPPrimPhytWEpiN1 = wPPrimDiatWEpiN1 + wPPrimGrenWEpiN1 + wPPrimBlueWEpiN1;
wNUptPhytEpiN1 = wNUptDiatEpiN1 + wNUptGrenEpiN1 + wNUptBlueEpiN1;
wNUptNH4PhytEpiN1 = wNUptNH4DiatEpiN1 + wNUptNH4GrenEpiN1 + wNUptNH4BlueEpiN1;
wNUptNO3PhytEpiN1 = wNUptNO3DiatEpiN1 + wNUptNO3GrenEpiN1 + wNUptNO3BlueEpiN1;
wNExcrPhytWEpiN1 = wNExcrDiatWEpiN1 + wNExcrGrenWEpiN1 + wNExcrBlueWEpiN1;
wNMortPhytWEpiN1 = wNMortDiatWEpiN1 + wNMortGrenWEpiN1 + wNMortBlueWEpiN1;
tNSetPhytEpiN1 = tNSetDiatEpiN1 + tNSetGrenEpiN1 + tNSetBlueEpiN1;
wNLossPhytEpiN1 = wNLossDiatEpiN1 + wNLossGrenEpiN1 + wNLossBlueEpiN1 + tNLossBlueSurfN1 / uDepthWEpiN1;
wNPrimPhytWEpiN1 = wNPrimDiatWEpiN1 + wNPrimGrenWEpiN1 + wNPrimBlueWEpiN1;
tDPrimPhytSN1 = tDPrimDiatSN1 + tDPrimGrenSN1 + tDPrimBlueSN1;
tPPrimPhytSN1 = tPPrimDiatSN1 + tPPrimGrenSN1 + tPPrimBlueSN1;
tNPrimPhytSN1 = tNPrimDiatSN1 + tNPrimGrenSN1 + tNPrimBlueSN1;
wSiUptDiatEpiN1 = cSiDDiatN1 * wDAssDiatEpiN1;
wSiExcrDiatWEpiN1 = cSiDDiatN1 * wDRespDiatWEpiN1 ;
wSiLossDiatEpiN1 = cSiDDiatN1 * wDLossDiatEpiN1;
wSiMortDiatWEpiN1 = cSiDDiatN1 * wDMortDiatWEpiN1;
tSiSetDiatEpiN1 = cSiDDiatN1 * tDSetDiatEpiN1;
wSiPrimDiatWHypN1 = IF (aInclStratN1 EQ TRUE ) THEN wSiUptDiatHypN1 - tSiSetDiatHypN1 / uDepthWHypN1 - wSiExcrDiatWHypN1 - wSiMortDiatWHypN1 - wSiLossDiatHypN1 ELSE 0.0 ENDIF;
wSiPrimDiatWEpiN1 = IF (aInclStratN1 EQ TRUE ) THEN wSiUptDiatEpiN1 - tSiSetDiatEpiN1 / uDepthWEpiN1 - wSiExcrDiatWEpiN1 - wSiMortDiatWEpiN1 - wSiLossDiatEpiN1 ELSE wSiUptDiatEpiN1 - tSiSetDiatEpiN1 / uDepthWEpiN1 - wSiExcrDiatWEpiN1 - wSiMortDiatWEpiN1 - wSiLossDiatEpiN1 + tSiResusDiatN1 / uDepthWEpiN1 ENDIF;
rCyDBlueEpiN1 = cCyDBlueMaxN1 -(cCyDBlueMaxN1 - cCyDBlueMinN1) * aLLimBlueEpiN1;
oCyanEpiN1 = rCyDBlueEpiN1 * oDBlueWEpiN1 * mgPergN1;
fDDiatEpiN1 = oDDiatWEpiN1 /(oDDiatWEpiN1 + oDGrenWEpiN1 + oDBlueWEpiN1 + NearZeroN1);
wDPrimDetWEpiN1 = IF (InclSurfN1 EQ TRUE) THEN wDMortPhytWEpiN1 + wDLossPhytEpiN1 + tDMortBlueSurfN1 / uDepthWEpiN1 ELSE wDMortPhytWEpiN1 + wDLossPhytEpiN1 ENDIF;
tDPrimDetSN1 = tDMortPhytSN1;
tDPrimTotSurfN1 = IF (InclSurfN1 EQ TRUE) THEN tDAssBlueSurfN1 - tDRespBlueSurfN1 ELSE 0.0 ENDIF;
tDPrimTotTN1 = IF (aInclStratN1 EQ FALSE ) THEN(wDAssPhytEpiN1 - wDRespPhytWEpiN1) * uDepthWEpiN1 - tDRespPhytSN1 + tDPrimTotSurfN1 ELSE (wDAssPhytEpiN1 - wDRespPhytWEpiN1) * uDepthWEpiN1 + (wDAssPhytHypN1 - wDRespPhytWHypN1) * uDepthWHypN1 - tDRespPhytSN1 + tDPrimTotSurfN1 ENDIF;
wO2ProdPhytEpiN1 = molO2molCN1 * cCPerDWN1 * wDAssPhytEpiN1;
wO2RespPhytWEpiN1 = molO2molCN1 * cCPerDWN1 * wDRespPhytWEpiN1 * aCorO2BODEpiN1;
wO2UptNO3PhytEpiN1 = O2PerNO3N1 * molO2molNN1 * wNUptNO3PhytEpiN1;
wO2PrimWEpiN1 = wO2ProdPhytEpiN1 - wO2RespPhytWEpiN1 + wO2UptNO3PhytEpiN1;
tO2RespPhytSN1 = molO2molCN1 * cCPerDWN1 * tDRespPhytSN1 * afOxySedN1;
tO2PrimSN1 = tO2RespPhytSN1;
tO2PrimSHypN1 = IF aInclStratN1 EQ TRUE THEN tO2PrimSN1 / uDepthWHypN1 ELSE 0.0 ENDIF;
tO2PrimSEpiN1 = IF aInclStratN1 EQ FALSE THEN tO2PrimSN1 / uDepthWEpiN1 ELSE 0.0 ENDIF;
wPMortBluePO4WSurfN1 = fDissMortPhytN1 * tPMortBlueSurfN1 / uDepthWEpiN1;
wPMortBlueDetSurfN1 = ( 1 -fDissMortPhytN1) * tPMortBlueSurfN1 / uDepthWEpiN1;
wPMortPhytPO4WEpiN1 = fDissMortPhytN1 * wPMortPhytWEpiN1;
wPMortPhytDetWEpiN1 = wPMortPhytWEpiN1 - wPMortPhytPO4WEpiN1 + wPMortBlueDetSurfN1;
wPLossPhytPO4EpiN1 = fDissLossN1 * wPLossPhytEpiN1;
wPLossPhytDetEpiN1 = wPLossPhytEpiN1 - wPLossPhytPO4EpiN1;
wPPrimPO4WEpiN1 = - wPUptPhytEpiN1 + wPExcrPhytWEpiN1 + wPLossPhytPO4EpiN1 + wPMortPhytPO4WEpiN1 - tPUptBlueSurfN1 / uDepthWEpiN1 + tPExcrBlueSurfN1 / uDepthWEpiN1 + wPMortBluePO4WSurfN1;
wPPrimDetWEpiN1 = wPLossPhytDetEpiN1 + wPMortPhytDetWEpiN1;
tPPrimDetSN1 = tPMortPhytDetSN1 ;
wNMortPhytNH4WEpiN1 = fDissMortPhytN1 * wNMortPhytWEpiN1;
wNMortPhytDetWEpiN1 = wNMortPhytWEpiN1 - wNMortPhytNH4WEpiN1+ wNMortBlueDetSurfN1;
wNLossPhytNH4EpiN1 = fDissLossN1 * wNLossPhytEpiN1;
wNLossPhytDetEpiN1 = wNLossPhytEpiN1 - wNLossPhytNH4EpiN1;
wNPrimNH4WEpiN1 = - wNUptNH4PhytEpiN1 + wNExcrPhytWEpiN1 + wNLossPhytNH4EpiN1 + wNMortPhytNH4WEpiN1- tNUptNH4BlueSurfN1 / uDepthWEpiN1 + tNExcrBlueSurfN1 / uDepthWEpiN1 + wNMortBlueNH4WSurfN1;
wNPrimNO3WEpiN1 = - wNUptNO3PhytEpiN1 - tNUptNO3BlueSurfN1 / uDepthWEpiN1;
wNPrimDetWEpiN1 = wNLossPhytDetEpiN1 + wNMortPhytDetWEpiN1;
tNPrimDetSN1 = tNMortPhytDetSN1 ;
wSiPrimSiO2WEpiN1 = IF (aInclStratN1 EQ FALSE) THEN wSiExcrDiatWEpiN1 - wSiUptDiatEpiN1 + tSiExcrDiatSN1 / uDepthWEpiN1 ELSE wSiExcrDiatWEpiN1 - wSiUptDiatEpiN1 ENDIF;
wSiPrimDetWEpiN1 = wSiMortDiatWEpiN1 + wSiLossDiatEpiN1;
tSiPrimDiatSN1 = IF (aInclStratN1 EQ FALSE) THEN tSiSetDiatEpiN1 - tSiResusDiatN1 - tSiExcrDiatSN1 - tSiMortDiatSN1 ELSE tSiSetDiatHypN1 - tSiResusDiatN1 - tSiExcrDiatSN1 - tSiMortDiatSN1 ENDIF;
tSiPrimDetSN1 = tSiMortDiatSN1 ;
aDepthEuphEpiN1 = cEuphN1 * aSecchiEpiN1;
aRelDepthEuphEpiN1 = aDepthEuphEpiN1 / uDepthWEpiN1;
aChlaHEpiN1 = oChlaEpiN1 * uDepthWEpiN1;
aCovPhytWEpiN1 = cCovSpPhytN1 *(oDPhytWEpiN1 * uDepthWEpiN1);
rExtChPhytEpiN1 = aExtPhytEpiN1 /(oChlaEpiN1 / mgPergN1 + NearZeroN1);
rPDZooEpiN1 = oPZooEpiN1 /(oDZooEpiN1+NearZeroN1);
rNDZooEpiN1 = oNZooEpiN1/(oDZooEpiN1+NearZeroN1);
aDFoodZooEpiN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN cPrefDiatN1 * aDDiatWEpiN1 + cPrefGrenN1 * aDGrenWEpiN1 + cPrefBlueN1 * aDBlueWEpiN1 + cPrefDetN1 * aDDetWEpiN1 ELSE cPrefDiatN1 * aDDiatWEpiN1 + cPrefGrenN1 * aDGrenWEpiN1 + cPrefBlueN1 * aDBlueWEpiN1 + cPrefBlueSurfN1 * aDBlueSurfN1 + cPrefDetN1 * aDDetWEpiN1 ENDIF;
oDFoodZooEpiN1 = aDFoodZooEpiN1 / uDepthWEpiN1;
aFiltEpiN1 = cFiltMaxN1 * uFunTmZooEpiN1 * hFiltN1 /(hFiltN1 + oDOMWEpiN1);
aDSatZooEpiN1 = oDFoodZooEpiN1 /(hFiltN1 + oDOMWEpiN1);
wDEnvZooEpiN1 = MAX(0.0,ukDIncrZooEpiN1 / cDCarrZooN1 * oDZooEpiN1*oDZooEpiN1);
wDAssZooEpiN1 = aDSatZooEpiN1 *(ukDAssTmZooEpiN1 * oDZooEpiN1 - wDEnvZooEpiN1);
wDConsZooEpiN1 = wDAssZooEpiN1 / fDAssZooN1;
wDConsDetZooEpiN1 = cPrefDetN1*oDDetWEpiN1 / oDFoodZooEpiN1 * wDConsZooEpiN1;
wDConsDiatZooEpiN1 = cPrefDiatN1*oDDiatWEpiN1 / oDFoodZooEpiN1 * wDConsZooEpiN1;
wDConsGrenZooEpiN1 = cPrefGrenN1*oDGrenWEpiN1 / oDFoodZooEpiN1 * wDConsZooEpiN1;
wDConsBlueZooEpiN1 = cPrefBlueN1*oDBlueWEpiN1 / oDFoodZooEpiN1 * wDConsZooEpiN1;
wDConsBlueZooSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE cPrefBlueSurfN1 *aDBlueSurfN1 / aDFoodZooEpiN1 * wDConsZooEpiN1 ENDIF;
tDConsBlueZooSurfN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE wDConsBlueZooSurfN1 *uDepthWEpiN1 ENDIF;
wDConsPhytZooEpiN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN wDConsDiatZooEpiN1 + wDConsGrenZooEpiN1 + wDConsBlueZooEpiN1 ELSE wDConsDiatZooEpiN1 + wDConsGrenZooEpiN1 + wDConsBlueZooEpiN1 + wDConsBlueZooSurfN1 ENDIF;
wDEgesZooEpiN1 = wDConsZooEpiN1 - wDAssZooEpiN1;
aCorDRespZooEpiN1 = MAX(cPDZooRefN1 / rPDZooEpiN1,cNDZooRefN1 / rNDZooEpiN1);
wDRespZooEpiN1 = aCorDRespZooEpiN1 * ukDRespTmZooEpiN1 * oDZooEpiN1;
wDMortZooEpiN1 = kMortZooN1 * oDZooEpiN1 +(1.0 - aDSatZooEpiN1) * wDEnvZooEpiN1;
aPFoodZooEpiN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN cPrefDiatN1*aPDiatWEpiN1 + cPrefGrenN1*aPGrenWEpiN1 + cPrefBlueN1 * aPBlueWEpiN1  + cPrefDetN1 * aPDetWEpiN1 ELSE cPrefDiatN1*aPDiatWEpiN1 + cPrefGrenN1*aPGrenWEpiN1 + cPrefBlueN1*aPBlueWEpiN1 + cPrefBlueSurfN1 *aPBlueSurfN1 + cPrefDetN1 * aPDetWEpiN1 ENDIF;
oPFoodZooEpiN1 = aPFoodZooEpiN1 / MassEpiN1;
rPDFoodZooEpiN1 = oPFoodZooEpiN1 /(oDFoodZooEpiN1+NearZeroN1);
wPConsDiatZooEpiN1 = rPDDiatWEpiN1 * wDConsDiatZooEpiN1;
wPConsGrenZooEpiN1 = rPDGrenWEpiN1 * wDConsGrenZooEpiN1;
wPConsBlueZooEpiN1 = rPDBlueWEpiN1 * wDConsBlueZooEpiN1;
wPConsBlueZooSurfN1 = rPDBlueSurfN1 * wDConsBlueZooSurfN1;
tPConsBlueZooSurfN1 = wPConsBlueZooSurfN1 *uDepthWEpiN1;
wPConsPhytZooEpiN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN wPConsDiatZooEpiN1 + wPConsGrenZooEpiN1 + wPConsBlueZooEpiN1 ELSE wPConsDiatZooEpiN1 + wPConsGrenZooEpiN1 + wPConsBlueZooEpiN1 + wPConsBlueZooSurfN1 ENDIF;
wPConsDetZooEpiN1 = rPDDetWEpiN1 * wDConsDetZooEpiN1;
wPConsZooEpiN1 = wPConsPhytZooEpiN1 + wPConsDetZooEpiN1;
afPAssZooEpiN1 = MIN(1.0,cPDZooRefN1 / rPDFoodZooEpiN1 * fDAssZooN1);
wPAssZooEpiN1 = afPAssZooEpiN1 * wPConsZooEpiN1;
wPEgesZooEpiN1 = wPConsZooEpiN1 - wPAssZooEpiN1;
wPEgesZooPO4EpiN1 = fDissEgesZooN1*wPEgesZooEpiN1;
wPEgesZooDetEpiN1 = wPEgesZooEpiN1 - wPEgesZooPO4EpiN1;
akPExcrZooEpiN1 = rPDZooEpiN1 / cPDZooRefN1 * kDRespZooN1 * uFunTmZooEpiN1;
wPExcrZooEpiN1 = akPExcrZooEpiN1*oPZooEpiN1 ;
wPMortZooEpiN1 = rPDZooEpiN1 * wDMortZooEpiN1;
wPMortZooPO4EpiN1 = fDissMortZooN1 * wPMortZooEpiN1;
wPMortZooDetEpiN1 = wPMortZooEpiN1 - wPMortZooPO4EpiN1;
aNFoodZooEpiN1 =  IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN cPrefDiatN1*aNDiatWEpiN1 + cPrefGrenN1*aNGrenWEpiN1 + cPrefBlueN1*aNBlueWEpiN1 + cPrefDetN1 * aNDetWEpiN1 ELSE cPrefDiatN1*aNDiatWEpiN1 + cPrefGrenN1*aNGrenWEpiN1 + cPrefBlueN1*aNBlueWEpiN1 + cPrefBlueSurfN1*aNBlueSurfN1 + cPrefDetN1 * aNDetWEpiN1 ENDIF;
oNFoodZooEpiN1 = aNFoodZooEpiN1 / MassEpiN1;
rNDFoodZooEpiN1 = oNFoodZooEpiN1 /(oDFoodZooEpiN1+NearZeroN1);
wNConsDiatZooEpiN1 = rNDDiatWEpiN1*wDConsDiatZooEpiN1;
wNConsGrenZooEpiN1 = rNDGrenWEpiN1*wDConsGrenZooEpiN1;
wNConsBlueZooEpiN1 = rNDBlueWEpiN1*wDConsBlueZooEpiN1;
wNConsBlueZooSurfN1 = rNDBlueSurfN1 * wDConsBlueZooSurfN1;
tNConsBlueZooSurfN1 = wNConsBlueZooSurfN1 *uDepthWEpiN1;
wNConsPhytZooEpiN1 = IF (InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN  wNConsDiatZooEpiN1 + wNConsGrenZooEpiN1 + wNConsBlueZooEpiN1 ELSE wNConsDiatZooEpiN1 + wNConsGrenZooEpiN1 + wNConsBlueZooEpiN1 + wNConsBlueZooSurfN1 ENDIF;
wNConsDetZooEpiN1 = rNDDetWEpiN1*wDConsDetZooEpiN1;
wNConsZooEpiN1 = wNConsPhytZooEpiN1 + wNConsDetZooEpiN1;
afNAssZooEpiN1 = MIN(1.0,cNDZooRefN1 / rNDFoodZooEpiN1 * fDAssZooN1);
wNAssZooEpiN1 = afNAssZooEpiN1*wNConsZooEpiN1;
wNEgesZooEpiN1 = wNConsZooEpiN1 - wNAssZooEpiN1;
wNEgesZooNH4EpiN1 = fDissEgesZooN1*wNEgesZooEpiN1;
wNEgesZooDetEpiN1 = wNEgesZooEpiN1 - wNEgesZooNH4EpiN1;
kNExcrZooEpiN1 = rNDZooEpiN1 / cNDZooRefN1 * kDRespZooN1 * uFunTmZooEpiN1;
wNExcrZooEpiN1 = kNExcrZooEpiN1*oNZooEpiN1 ;
wNMortZooEpiN1 = rNDZooEpiN1*wDMortZooEpiN1;
wNMortZooNH4EpiN1 = fDissMortZooN1*wNMortZooEpiN1;
wNMortZooDetEpiN1 = wNMortZooEpiN1 - wNMortZooNH4EpiN1;
wSiConsDiatZooEpiN1 = cSiDDiatN1 * wDConsDiatZooEpiN1;
rPDFiJvN1 = aPFiJvN1 /(aDFiJvN1+NearZeroN1);
rPDFiAdN1 = aPFiAdN1 /(aDFiAdN1+NearZeroN1);
rNDFiJvN1 = aNFiJvN1 /(aDFiJvN1+NearZeroN1);
rNDFiAdN1 = aNFiAdN1 /(aDFiAdN1+NearZeroN1);
tDReprFishN1 = IF (FALSE EQ InclSeasonN1) THEN ((1/DaysInYearN1)*fReprFishN1) * aDFiAdN1 ELSEIF (DayN1 GE cDayReprFishN1 AND DayN1 LT cDayReprFishN1 + 1.0) THEN fReprFishN1 * aDFiAdN1 * PerDayN1 ELSE 0.0 ENDIF;
tDAgeFishN1 = IF (FALSE EQ InclSeasonN1) THEN ((1/DaysInYearN1)*fAgeFishN1) * aDFiJvN1 ELSEIF (DayN1 GE 364.0) THEN fAgeFishN1 * aDFiJvN1 *PerDayN1 ELSE 0.0 ENDIF;
aDTotZooN1 = IF (aInclStratN1 EQ FALSE) THEN oDZooEpiN1 * uDepthWEpiN1 ELSE oDZooEpiN1 * uDepthWEpiN1 + oDZooHypN1 * uDepthWHypN1 ENDIF;
aPTotZooN1 = IF (aInclStratN1 EQ FALSE) THEN oPZooEpiN1 * uDepthWEpiN1 ELSE oPZooEpiN1 * uDepthWEpiN1 + oPZooHypN1 * uDepthWHypN1 ENDIF;
aNTotZooN1 = IF (aInclStratN1 EQ FALSE) THEN oNZooEpiN1 * uDepthWEpiN1 ELSE oNZooEpiN1 * uDepthWEpiN1 + oNZooHypN1 * uDepthWHypN1 ENDIF;
aDSatFiJvN1 = aDTotZooN1 * aDTotZooN1 /(hDZooFiJvN1 * hDZooFiJvN1 + aDTotZooN1 * aDTotZooN1);
tDEnvFiJvN1 = MAX(0.0,ukDIncrFiJvN1 /(cDCarrFishN1 - aDFiAdN1) * aDFiJvN1*aDFiJvN1);
tDAssFiJvN1 = aDSatFiJvN1 *(kDAssFiJvN1 * uFunTmFishN1 * aDFiJvN1 - tDEnvFiJvN1);
tDConsFiJvN1 = tDAssFiJvN1 / fDAssFiJvN1;
tDEgesFiJvN1 = tDConsFiJvN1 - tDAssFiJvN1;
tDRespFiJvN1 = (cPDFishRefN1 / rPDFiJvN1) * kDRespFiJvN1 * uFunTmFishN1 * aDFiJvN1;
tDMortFiJvN1 = kMortFiJvN1 * aDFiJvN1 +(1.0 - aDSatFiJvN1) * tDEnvFiJvN1;
tDMigrFiJvN1 = kMigrFishN1 *(cDFiJvInN1 - aDFiJvN1);
tDEnvFiAdN1 = MAX(0.0,ukDIncrFiAdN1 /(cDCarrFishN1 - aDFiJvN1) * aDFiAdN1*aDFiAdN1);
tDAssFiAdN1 = aDSatFiAdN1 *(kDAssFiAdN1 * uFunTmFishN1 * aDFiAdN1 - tDEnvFiAdN1);
tDConsFiAdN1 = tDAssFiAdN1 / fDAssFiAdN1;
tDEgesFiAdN1 = tDConsFiAdN1 - tDAssFiAdN1;
tDRespFiAdN1 = (cPDFishRefN1 / rPDFiAdN1) * kDRespFiAdN1 * uFunTmFishN1 * aDFiAdN1;
tDMortFiAdN1 = kMortFiAdN1 * aDFiAdN1 +(1.0 - aDSatFiAdN1) * tDEnvFiAdN1;
tDHarvFishN1 = ukHarvFishN1 * aDFiAdN1;
tDMigrFiAdN1 = kMigrFishN1 *(cDFiAdInN1 - aDFiAdN1);
tDMortFiJvBotN1 = fDBoneN1 * tDMortFiJvN1;
tDMortFiJvDetN1 = tDMortFiJvN1 - tDMortFiJvBotN1;
tDMortFiAdBotN1 = fDBoneN1 * tDMortFiAdN1;
tDMortFiAdDetN1 = tDMortFiAdN1 - tDMortFiAdBotN1;
tPReprFishN1 = rPDFiAdN1 * tDReprFishN1;
tPAgeFishN1 = rPDFiJvN1 * tDAgeFishN1;
tPMigrFiJvN1 = kMigrFishN1 *(cPDFishRefN1 * cDFiJvInN1 - aPFiJvN1);
tPConsFiJvN1 = rPDZooEpiN1 * tDConsFiJvN1;
afPAssFiJvN1 = MIN(1.0,cPDFishRefN1 / rPDZooEpiN1 * fDAssFiJvN1);
tPAssFiJvN1 = afPAssFiJvN1 * tPConsFiJvN1;
tPEgesFiJvN1 = tPConsFiJvN1 - tPAssFiJvN1;
tPExcrFiJvN1 = (rPDFiJvN1 / cPDFishRefN1) * kDRespFiJvN1 * uFunTmFishN1 * aPFiJvN1;
tPMortFiJvN1 = rPDFiJvN1 * tDMortFiJvN1;
tPMigrFiAdN1 = kMigrFishN1 *(cPDFishRefN1 * cDFiAdInN1 - aPFiAdN1);
tPConsFiAdN1 = rPDBentN1 * tDConsFiAdN1;
tPAssFiAdN1 = afPAssFiAdN1 * tPConsFiAdN1;
tPEgesFiAdN1 = tPConsFiAdN1 - tPAssFiAdN1;
tPExcrFiAdN1 = (rPDFiAdN1 / cPDFishRefN1) * kDRespFiAdN1 * uFunTmFishN1 * aPFiAdN1;
tPMortFiAdN1 = rPDFiAdN1 * tDMortFiAdN1;
tPHarvFishN1 = rPDFiAdN1 * tDHarvFishN1;
tPMortFiJvBotN1 = fPBoneN1 * tPMortFiJvN1;
tPMortFiJvPO4N1 = fDissMortFishN1 *(tPMortFiJvN1 - tPMortFiJvBotN1);
tPMortFiJvDetN1 = tPMortFiJvN1 - tPMortFiJvBotN1 - tPMortFiJvPO4N1;
tPMortFiAdBotN1 = fPBoneN1 * tPMortFiAdN1;
tPMortFiAdPO4N1 = fDissMortFishN1 *(tPMortFiAdN1 - tPMortFiAdBotN1);
tPMortFiAdDetN1 = tPMortFiAdN1 - tPMortFiAdBotN1 - tPMortFiAdPO4N1;
tPEgesFiJvPO4N1 = fDissEgesFishN1 * tPEgesFiJvN1;
tPEgesFiJvDetN1 = tPEgesFiJvN1 - tPEgesFiJvPO4N1;
tPEgesFiAdPO4N1 = fDissEgesFishN1 * tPEgesFiAdN1;
tPEgesFiAdDetN1 = tPEgesFiAdN1 - tPEgesFiAdPO4N1;
tNReprFishN1 = rNDFiAdN1 * tDReprFishN1;
tNAgeFishN1 = rNDFiJvN1 * tDAgeFishN1;
tNMigrFiJvN1 = kMigrFishN1 *(cNDFishRefN1 * cDFiJvInN1 - aNFiJvN1);
tNConsFiJvN1 = rNDZooEpiN1 * tDConsFiJvN1;
afNAssFiJvN1 = MIN(1.0,cNDFishRefN1 / rNDZooEpiN1 * fDAssFiJvN1);
tNAssFiJvN1 = afNAssFiJvN1 * tNConsFiJvN1;
tNEgesFiJvN1 = tNConsFiJvN1 - tNAssFiJvN1;
tNExcrFiJvN1 = (rNDFiJvN1 / cNDFishRefN1) * kDRespFiJvN1 * uFunTmFishN1 * aNFiJvN1;
tNMortFiJvN1 = rNDFiJvN1 * tDMortFiJvN1;
tNMigrFiAdN1 = kMigrFishN1 *(cNDFishRefN1 * cDFiAdInN1 - aNFiAdN1);
tNConsFiAdN1 = rNDBentN1 * tDConsFiAdN1;
tNAssFiAdN1 = afNAssFiAdN1 * tNConsFiAdN1;
tNEgesFiAdN1 = tNConsFiAdN1 - tNAssFiAdN1;
tNExcrFiAdN1 = (rNDFiAdN1 / cNDFishRefN1) * kDRespFiAdN1 * uFunTmFishN1 * aNFiAdN1;
tNMortFiAdN1 = rNDFiAdN1 * tDMortFiAdN1;
tNHarvFishN1 = rNDFiAdN1 * tDHarvFishN1;
tNMortFiAdBotN1 = fDBoneN1 * tNMortFiAdN1;
tNMortFiAdNH4N1 = fDissMortFishN1 *(tNMortFiAdN1 - tNMortFiAdBotN1);
tNMortFiAdDetN1 = tNMortFiAdN1 - tNMortFiAdBotN1 - tNMortFiAdNH4N1;
tNMortFiJvBotN1 = fDBoneN1 * tNMortFiJvN1;
tNMortFiJvNH4N1 = fDissMortFishN1 *(tNMortFiJvN1 - tNMortFiJvBotN1);
tNMortFiJvDetN1 = tNMortFiJvN1 - tNMortFiJvBotN1 - tNMortFiJvNH4N1;
tNEgesFiJvNH4N1 = fDissEgesFishN1 * tNEgesFiJvN1;
tNEgesFiJvDetN1 = tNEgesFiJvN1 - tNEgesFiJvNH4N1;
tDMigrPiscN1 = kMigrPiscN1 *(cDPiscInN1 - aDPiscN1);
aDFishN1 = aDFiJvN1 + aDFiAdN1;
aDSatPiscN1 = aDFishN1*aDFishN1 /(hDFishPiscN1*hDFishPiscN1 + aDFishN1*aDFishN1);
tDEnvPiscN1 = MAX(0.0,akDIncrPiscN1 / aDCarrPiscN1 * aDPiscN1*aDPiscN1);
tDAssPiscN1 = aDSatPiscN1 *(kDAssPiscN1 * aFunVegPiscN1 * uFunTmPiscN1 * aDPiscN1 - tDEnvPiscN1);
tDConsPiscN1 = tDAssPiscN1 / fDAssPiscN1;
tDEgesPiscN1 = tDConsPiscN1 - tDAssPiscN1;
tDConsFiJvPiscN1 = aDFiJvN1 / aDFishN1 * tDConsPiscN1;
tDConsFiAdPiscN1 = tDConsPiscN1 - tDConsFiJvPiscN1;
tDMortPiscN1 = kMortPiscN1 * aDPiscN1 +(1.0 - aDSatPiscN1) * tDEnvPiscN1;
tDMortPiscBotN1 = fDBoneN1 * tDMortPiscN1;
tDMortPiscDetN1 = tDMortPiscN1 - tDMortPiscBotN1;
tDHarvPiscN1 = ukHarvPiscN1 * aDPiscN1;
aPPiscN1 = cPDPiscN1 * aDPiscN1;
tPConsFiJvPiscN1 = rPDFiJvN1 * tDConsFiJvPiscN1;
tPConsFiAdPiscN1 = rPDFiAdN1 * tDConsFiAdPiscN1;
tPConsPiscN1 = tPConsFiJvPiscN1 + tPConsFiAdPiscN1;
rPDFoodPiscN1 = tPConsPiscN1 / tDConsPiscN1;
aNPiscN1 = cNDPiscN1 * aDPiscN1;
tNConsFiJvPiscN1 = rNDFiJvN1 * tDConsFiJvPiscN1;
tNConsFiAdPiscN1 = rNDFiAdN1 * tDConsFiAdPiscN1;
tNConsPiscN1 = tNConsFiJvPiscN1 + tNConsFiAdPiscN1;
rNDFoodPiscN1 = tNConsPiscN1 / tDConsPiscN1;
tDConsPiscNutN1 = (tDAssPiscN1 / fDAssPiscN1) * MAX (1.0, cNDPiscN1 / rNDFoodPiscN1 * fDAssPiscN1, cPDPiscN1 / rPDFoodPiscN1 * fDAssPiscN1);
tDEgesPiscNutN1 = tDConsPiscNutN1 - tDAssPiscN1;
tDConsFiJvPiscNutN1 = aDFiJvN1 / aDFishN1 * tDConsPiscNutN1;
tDConsFiAdPiscNutN1 = tDConsPiscNutN1 - tDConsFiJvPiscNutN1;
tPConsFiJvPiscNutN1 = rPDFiJvN1 * tDConsFiJvPiscNutN1;
tPConsFiAdPiscNutN1 = rPDFiAdN1 * tDConsFiAdPiscNutN1;
tPConsPiscNutN1 = tPConsFiJvPiscNutN1 + tPConsFiAdPiscNutN1;
tNConsFiJvPiscNutN1 = rNDFiJvN1 * tDConsFiJvPiscNutN1;
tNConsFiAdPiscNutN1 = rNDFiAdN1 * tDConsFiAdPiscNutN1;
tNConsPiscNutN1 = tNConsFiJvPiscNutN1 + tNConsFiAdPiscNutN1;
afPAssPiscN1 = MIN(1.0, ((cPDPiscN1 / rPDFoodPiscN1 * fDAssPiscN1) / (tDConsPiscNutN1 / tDConsPiscN1 )) );
tPAssPiscN1 = afPAssPiscN1 * tPConsPiscNutN1;
tPEgesPiscN1 = tPConsPiscNutN1 - tPAssPiscN1;
tPEgesPiscPO4N1 = fDissEgesPiscN1 * tPEgesPiscN1;
tPEgesPiscDetN1 = tPEgesPiscN1 - tPEgesPiscPO4N1;
tDRespPiscN1 = kDRespPiscN1 * uFunTmPiscN1 * aDPiscN1;
tPExcrPiscN1 = cPDPiscN1 * tDRespPiscN1;
tPMortPiscN1 = cPDPiscN1 * tDMortPiscN1;
tPMortPiscBotN1 = fPBoneN1 * tPMortPiscN1;
tPMortPiscPO4N1 = fDissMortPiscN1 *(tPMortPiscN1 - tPMortPiscBotN1);
tPMortPiscDetN1 = tPMortPiscN1 - tPMortPiscBotN1 - tPMortPiscPO4N1;
tPMigrPiscN1 = kMigrPiscN1 *(cPDPiscN1 * cDPiscInN1 - aPPiscN1);
tPHarvPiscN1 = cPDPiscN1 * tDHarvPiscN1;
afNAssPiscN1 = MIN(1.0, ((cNDPiscN1 / rNDFoodPiscN1 * fDAssPiscN1) / (tDConsPiscNutN1 / tDConsPiscN1 )) );
tNAssPiscN1 = afNAssPiscN1 * tNConsPiscNutN1;
tNEgesPiscN1 = tNConsPiscNutN1 - tNAssPiscN1;
tNEgesPiscNH4N1 = fDissEgesPiscN1 * tNEgesPiscN1;
tNEgesPiscDetN1 = tNEgesPiscN1 - tNEgesPiscNH4N1;
tNExcrPiscN1 = cNDPiscN1 * tDRespPiscN1;
tNMortPiscN1 = cNDPiscN1 * tDMortPiscN1;
tNMortPiscBotN1 = fDBoneN1 * tNMortPiscN1;
tNMortPiscNH4N1 = fDissMortPiscN1 *(tNMortPiscN1 - tNMortPiscBotN1);
tNMortPiscDetN1 = tNMortPiscN1 - tNMortPiscBotN1 - tNMortPiscNH4N1;
tNMigrPiscN1 = kMigrPiscN1 *(cNDPiscN1 * cDPiscInN1 - aNPiscN1);
tNHarvPiscN1 = cNDPiscN1 * tDHarvPiscN1;
tDWebBentN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tDMigrBentN1 + tDAssBentN1 - tDConsFiAdN1 - tDRespBentN1 - tDMortBentN1 ENDIF;
tPWebBentN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tPMigrBentN1 + tPAssBentN1 - tPConsFiAdN1 - tPExcrBentN1 - tPMortBentN1 ENDIF;
tNWebBentN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tNMigrBentN1 + tNAssBentN1 - tNConsFiAdN1 - tNExcrBentN1 - tNMortBentN1 ENDIF;
tDWebFiJvN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tDMigrFiJvN1 + tDReprFishN1 - tDAgeFishN1 + tDAssFiJvN1 - tDRespFiJvN1 - tDMortFiJvN1 - tDConsFiJvPiscNutN1 ENDIF;
tPWebFiJvN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tPMigrFiJvN1 + tPReprFishN1 - tPAgeFishN1 + tPAssFiJvN1 - tPExcrFiJvN1 - tPMortFiJvN1 - tPConsFiJvPiscNutN1 ENDIF;
tNWebFiJvN1 =IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tNMigrFiJvN1 + tNReprFishN1 - tNAgeFishN1 + tNAssFiJvN1 - tNExcrFiJvN1 - tNMortFiJvN1 - tNConsFiJvPiscNutN1 ENDIF;
tDWebFiAdN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tDMigrFiAdN1 + tDAssFiAdN1 - tDRespFiAdN1 - tDMortFiAdN1 - tDReprFishN1 + tDAgeFishN1 - tDConsFiAdPiscNutN1 - tDHarvFishN1 ENDIF;
tPWebFiAdN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tPMigrFiAdN1 + tPAssFiAdN1 - tPExcrFiAdN1 - tPMortFiAdN1 - tPReprFishN1 + tPAgeFishN1 - tPConsFiAdPiscNutN1 - tPHarvFishN1 ENDIF;
tNWebFiAdN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tNMigrFiAdN1 + tNAssFiAdN1 - tNExcrFiAdN1 - tNMortFiAdN1 - tNReprFishN1 + tNAgeFishN1 - tNConsFiAdPiscNutN1 - tNHarvFishN1 ENDIF;
tDWebPiscN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tDMigrPiscN1 + tDAssPiscN1 - tDRespPiscN1 - tDMortPiscN1 - tDHarvPiscN1 ENDIF;
wDWebZooHypN1 = IF (FALSE EQ InclWebN1 OR aInclStratN1 EQ FALSE) THEN 0.0 ELSE wDAssZooHypN1 - wDRespZooHypN1 - wDMortZooHypN1 - tDConsFiJvN1 * (( aDTotZooN1 - oDZooEpiN1 * uDepthWEpiN1) / (aDTotZooN1 + NearZeroN1)) / uDepthWHypN1 ENDIF;
wDWebDetWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsDetZooHypN1 + wDEgesZooHypN1 + wDMortZooHypN1 +(tDEgesFiJvN1 * uFiJvEgesHypN1 + tDEgesFiAdN1 * uFiAdEgesHypN1 + tDMortFiJvDetN1 * uFiJvMortHypN1 + tDMortFiAdDetN1 * uFiAdMortHypN1 + tDEgesPiscNutN1 * uPiscEgesHypN1 + tDMortPiscDetN1 * uPiscMortHypN1) / uDepthWHypN1 ENDIF;
wDWebDiatWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsDiatZooHypN1 ENDIF;
wDWebGrenWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsGrenZooHypN1 ENDIF;
wDWebBlueWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsBlueZooHypN1 ENDIF;
wDWebZooEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wDAssZooEpiN1 - wDRespZooEpiN1 - wDMortZooEpiN1 - tDConsFiJvN1 * (oDZooEpiN1 * uDepthWEpiN1 / (aDTotZooN1 + NearZeroN1) ) / uDepthWEpiN1 ENDIF;
wDWebDetWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsDetZooEpiN1 + wDEgesZooEpiN1 + wDMortZooEpiN1 +(tDEgesFiJvN1 * ( 1.0 - uFiJvEgesHypN1 ) + tDEgesFiAdN1 * ( 1.0 - uFiAdEgesHypN1 ) + tDMortFiJvDetN1 * ( 1.0 - uFiJvMortHypN1 ) + tDMortFiAdDetN1 * ( 1.0 - uFiAdMortHypN1 ) + tDEgesPiscNutN1 * ( 1.0 - uPiscEgesHypN1 ) + tDMortPiscDetN1 * ( 1.0 - uPiscMortHypN1)) / uDepthWEpiN1 ENDIF;
wDWebDiatWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsDiatZooEpiN1 ENDIF;
wDWebGrenWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsGrenZooEpiN1 ENDIF;
wDWebBlueWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDConsBlueZooEpiN1 ENDIF;
tDWebBlueSurfN1 = IF (InclWebN1 EQ FALSE OR InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE - tDConsBlueZooSurfN1 ENDIF;
tDWebTotTN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wDRespZooEpiN1 * uDepthWEpiN1 - wDRespZooHypN1 * uDepthWHypN1 + tDMigrFiJvN1 + tDMigrFiAdN1 + tDMigrPiscN1 + tDMigrBentN1 - tDRespFiJvN1 - tDRespFiAdN1 - tDRespPiscN1 - tDRespBentN1 - tDMortFiJvBotN1 - tDMortFiAdBotN1- tDMortPiscBotN1 - tDHarvFishN1 - tDHarvPiscN1 ENDIF;
wPWebZooHypN1 = IF (FALSE EQ InclWebN1 OR aInclStratN1 EQ FALSE) THEN 0.0 ELSE wPAssZooHypN1 - wPExcrZooHypN1 - wPMortZooHypN1 - tPConsFiJvN1 * (( aPTotZooN1 - oPZooEpiN1 * uDepthWEpiN1 ) / (aPTotZooN1 + NearZeroN1) ) / uDepthWHypN1 ENDIF;
wPWebPO4WHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wPExcrZooHypN1 + wPEgesZooPO4HypN1 + wPMortZooPO4HypN1 +(tPExcrFiJvN1 *uFiJvExcrHypN1 + tPExcrFiAdN1 * uFiAdExcrHypN1 + tPEgesFiJvPO4N1 * uFiJvEgesHypN1 + tPEgesFiAdPO4N1 * uFiAdEgesHypN1 + tPMortFiJvPO4N1 * uFiJvMortHypN1 + tPMortFiAdPO4N1 * uFiAdMortHypN1+ tPExcrPiscN1 * uPiscExcrHypN1 + tPEgesPiscPO4N1 * uPiscEgesHypN1 + tPMortPiscPO4N1 * uPiscMortHypN1 ) / uDepthWHypN1 ENDIF;
wPWebDetWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsDetZooHypN1 + wPEgesZooDetHypN1 + wPMortZooDetHypN1 +(tPEgesFiJvDetN1 * uFiJvEgesHypN1 + tPEgesFiAdDetN1 * uFiAdEgesHypN1+ tPMortFiJvDetN1 * uFiJvMortHypN1 + tPMortFiAdDetN1 * uFiAdMortHypN1+ tPEgesPiscDetN1 * uPiscEgesHypN1+ tPMortPiscDetN1 * uPiscMortHypN1) / uDepthWHypN1 ENDIF;
wPWebDiatWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsDiatZooHypN1 ENDIF;
wPWebGrenWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsGrenZooHypN1 ENDIF;
wPWebBlueWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsBlueZooHypN1 ENDIF;
wPWebZooEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wPAssZooEpiN1 - wPExcrZooEpiN1 - wPMortZooEpiN1 - tPConsFiJvN1 * (oPZooEpiN1 * uDepthWEpiN1 / (aPTotZooN1 + NearZeroN1)) / uDepthWEpiN1 ENDIF;
wPWebPO4WEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wPExcrZooEpiN1 + wPEgesZooPO4EpiN1 + wPMortZooPO4EpiN1 +(tPExcrFiJvN1 * ( 1.0 -uFiJvExcrHypN1 ) + tPExcrFiAdN1 * ( 1.0 - uFiAdExcrHypN1 )+ tPEgesFiJvPO4N1 * ( 1.0 - uFiJvEgesHypN1 ) + tPEgesFiAdPO4N1 * ( 1.0 - uFiAdEgesHypN1 ) + tPMortFiJvPO4N1 * ( 1.0 - uFiJvMortHypN1 ) + tPMortFiAdPO4N1 * ( 1.0 - uFiAdMortHypN1 )+ tPExcrPiscN1 * ( 1.0 - uPiscExcrHypN1 ) + tPEgesPiscPO4N1 * ( 1.0 - uPiscEgesHypN1 ) + tPMortPiscPO4N1 * ( 1.0 - uPiscMortHypN1)) / uDepthWEpiN1 ENDIF;
wPWebDetWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsDetZooEpiN1 + wPEgesZooDetEpiN1 + wPMortZooDetEpiN1 +(tPEgesFiJvDetN1 * ( 1.0 - uFiJvEgesHypN1 ) + tPEgesFiAdDetN1 * ( 1.0 - uFiAdEgesHypN1 )+ tPMortFiJvDetN1 * ( 1.0 - uFiJvMortHypN1 ) + tPMortFiAdDetN1 * ( 1.0 - uFiAdMortHypN1 )+ tPEgesPiscDetN1 * ( 1.0 - uPiscEgesHypN1 )+ tPMortPiscDetN1 * ( 1.0 - uPiscMortHypN1 )) / uDepthWEpiN1 ENDIF;
wPWebDiatWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsDiatZooEpiN1 ENDIF;
wPWebGrenWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsGrenZooEpiN1 ENDIF;
wPWebBlueWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wPConsBlueZooEpiN1 ENDIF;
tPWebBlueSurfN1 = IF (InclWebN1 EQ FALSE OR InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE - tPConsBlueZooSurfN1 ENDIF;
tPWebTotTN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tPMigrFiJvN1 + tPMigrFiAdN1 + tPMigrPiscN1 + tPMigrBentN1 - tPMortFiJvBotN1 - tPMortFiAdBotN1- tPMortPiscBotN1 - tPHarvFishN1 - tPHarvPiscN1 ENDIF;
tNEgesFiAdNH4N1 = fDissEgesFishN1 * tNEgesFiAdN1;
tNEgesFiAdDetN1 = tNEgesFiAdN1 - tNEgesFiAdNH4N1;
wNWebNO3WHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE 0.0 ENDIF;
wNWebNO3WEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE 0.0 ENDIF;
wNWebZooHypN1 = IF (FALSE EQ InclWebN1 OR aInclStratN1 EQ FALSE) THEN 0.0 ELSE wNAssZooHypN1 - wNExcrZooHypN1 - wNMortZooHypN1 - tNConsFiJvN1 * (( aNTotZooN1 -oNZooEpiN1 * uDepthWEpiN1 ) / (aNTotZooN1 + NearZeroN1) ) / uDepthWHypN1 ENDIF;
wNWebNH4WHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wNExcrZooHypN1 + wNEgesZooNH4HypN1 + wNMortZooNH4HypN1 +(tNExcrFiJvN1 * uFiJvExcrHypN1 + tNExcrFiAdN1 * uFiAdExcrHypN1 + tNEgesFiJvNH4N1 * uFiJvEgesHypN1+ tNEgesFiAdNH4N1 * uFiAdEgesHypN1 + tNMortFiAdNH4N1 *uFiAdMortHypN1+ tNMortFiJvNH4N1*uFiJvMortHypN1 + tNExcrPiscN1 *uPiscExcrHypN1 + tNEgesPiscNH4N1 *uPiscEgesHypN1 + tNMortPiscNH4N1 *uPiscMortHypN1) / uDepthWHypN1 ENDIF;
wNWebDetWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsDetZooHypN1 + wNEgesZooDetHypN1 + wNMortZooDetHypN1 +(tNEgesFiJvDetN1 * uFiJvEgesHypN1 +tNEgesFiAdDetN1 * uFiAdEgesHypN1+ tNMortFiJvDetN1 * uFiJvMortHypN1 + tNMortFiAdDetN1 * uFiAdMortHypN1 + tNEgesPiscDetN1 * uPiscEgesHypN1 + tNMortPiscDetN1 * uPiscMortHypN1) / uDepthWHypN1 ENDIF;
wNWebDiatWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsDiatZooHypN1 ENDIF;
wNWebGrenWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsGrenZooHypN1 ENDIF;
wNWebBlueWHypN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsBlueZooHypN1 ENDIF;
wNWebZooEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wNAssZooEpiN1 - wNExcrZooEpiN1 - wNMortZooEpiN1 - tNConsFiJvN1 * (oNZooEpiN1 * uDepthWEpiN1 / (aNTotZooN1 + NearZeroN1) ) / uDepthWEpiN1 ENDIF;
wNWebNH4WEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wNExcrZooEpiN1 + wNEgesZooNH4EpiN1 + wNMortZooNH4EpiN1 +(tNExcrFiJvN1 * ( 1.0 - uFiJvExcrHypN1) + tNExcrFiAdN1 * ( 1.0 - uFiAdExcrHypN1) + tNEgesFiJvNH4N1 * ( 1.0 - uFiJvEgesHypN1 ) + tNEgesFiAdNH4N1 * ( 1.0 - uFiAdEgesHypN1 ) + tNMortFiAdNH4N1 * ( 1.0 -uFiAdMortHypN1 ) + tNMortFiJvNH4N1* ( 1.0 -uFiJvMortHypN1) + tNExcrPiscN1 * ( 1.0 -uPiscExcrHypN1 ) + tNEgesPiscNH4N1 * ( 1.0 -uPiscEgesHypN1 ) + tNMortPiscNH4N1 * ( 1.0 -uPiscMortHypN1)) / uDepthWEpiN1 ENDIF;
wNWebDetWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsDetZooEpiN1 + wNEgesZooDetEpiN1 + wNMortZooDetEpiN1 +(tNEgesFiJvDetN1 * ( 1.0 - uFiJvEgesHypN1 ) +tNEgesFiAdDetN1 * ( 1.0 - uFiAdEgesHypN1 ) + tNMortFiJvDetN1 * ( 1.0 - uFiJvMortHypN1 ) + tNMortFiAdDetN1 * ( 1.0 - uFiAdMortHypN1 ) + tNEgesPiscDetN1 * ( 1.0 - uPiscEgesHypN1 ) + tNMortPiscDetN1 * ( 1.0 - uPiscMortHypN1 )) / uDepthWEpiN1 ENDIF;
wNWebDiatWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsDiatZooEpiN1 ENDIF;
wNWebGrenWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsGrenZooEpiN1 ENDIF;
wNWebBlueWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE - wNConsBlueZooEpiN1 ENDIF;
tNWebBlueSurfN1 = IF (InclWebN1 EQ FALSE OR InclSurfN1 EQ FALSE OR aDBlueSurfN1 LT cDBlueSurfMinN1) THEN 0.0 ELSE - tNConsBlueZooSurfN1 ENDIF;
tNWebTotTN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE tNMigrFiJvN1 + tNMigrFiAdN1 + tNMigrPiscN1 + tNMigrBentN1 - tNMortFiJvBotN1- tNMortFiAdBotN1 - tNMortPiscBotN1 - tNHarvFishN1 - tNHarvPiscN1 ENDIF;
wSiWebDetWEpiN1 = IF (FALSE EQ InclWebN1) THEN 0.0 ELSE wSiConsDiatZooEpiN1 ENDIF;
aPrefAveEpiN1 = (cPrefDiatN1 * oDDiatWEpiN1 + cPrefGrenN1 * oDGrenWEpiN1 + cPrefBlueN1 * oDBlueWEpiN1 + cPrefDetN1 * oDDetWEpiN1) / oDOMWEpiN1;
wDConsZoo2EpiN1 = aFiltEpiN1 * aPrefAveEpiN1 * oDOMWEpiN1 * oDZooEpiN1;
aDConsZooSpEpiN1 = wDConsZooEpiN1 / oDZooEpiN1;
aDAssZooSpEpiN1 = wDAssZooEpiN1 / oDZooEpiN1;
aDGrazSpEpiN1 = wDConsZooEpiN1 / oDOMWEpiN1;
aPConsZooSpEpiN1 = wPConsZooEpiN1 / oPZooEpiN1;
aPGrazSpEpiN1 = wPConsZooEpiN1 / oPOMWEpiN1;
aNConsZooSpEpiN1 = wNConsZooEpiN1 / oNZooEpiN1;
aNGrazSpEpiN1 = wNConsZooEpiN1 / oNOMWEpiN1;
tDSetTotEpiN1 = tDSetIMEpiN1 + tDSetDetEpiN1 + tDSetPhytEpiN1;
tPSetTotEpiN1 = tPSetAIMEpiN1 + tPSetDetEpiN1 + tPSetPhytEpiN1;
tNSetTotEpiN1 = tNSetDetEpiN1 + tNSetPhytEpiN1;
tDResusTotN1 = tDResusDeadN1 + tDResusPhytTotN1;
tPResusTotN1 = tPResusDetN1 + tPResusAIMN1 + tPResusPhytN1 + tPResusPO4N1;
tNResusTotN1 = tNResusDetN1 + tNResusNH4N1 + tNResusNO3N1 + tNResusPhytN1;
aDepthStartN1 = IF (sTimeN1 EQ bTimeDredN1) THEN uDepthWN1 ELSE aDepthStartN1 ENDIF;
akDredDepthN1 = IF ((sTimeN1 GE bTimeDredN1) AND (sTimeN1 LT bTimeDredN1 + cLengDredN1) AND (aDepthStartN1 LE cDepthRefN1 - cDepthSN1)) THEN (LN(cDepthRefN1 / aDepthStartN1)) / cLengDredN1 ELSE 0.0 ENDIF;
akDredN1 = IF ((sTimeN1 GE bTimeDredN1) AND (sTimeN1 LT bTimeDredN1 + cLengDredN1) AND (aDepthStartN1 LE cDepthRefN1 - cDepthSN1)) THEN (- LN(1.0 - fEffDredN1)) / cLengDredN1 ELSE 0.0 ENDIF;
akDredBentN1 = IF ((sTimeN1 GE bTimeDredN1) AND (sTimeN1 LT bTimeDredN1 + cLengDredN1) AND (aDepthStartN1 LE cDepthRefN1 - cDepthSN1)) THEN (- LN(1.0 - fEffDredBentN1)) / cLengDredN1 ELSE 0.0 ENDIF;
vDredDepthWN1 =IF (aInclStratN1 EQ TRUE) THEN 0.0 ELSE akDredDepthN1 * uDepthWN1 ENDIF;
tDDredDetSN1 = akDredN1 * aDDetSN1;
tPDredDetSN1 = akDredN1 * aPDetSN1;
tNDredDetSN1 = akDredN1 * aNDetSN1;
tSiDredDetSN1 = akDredN1 * aSiDetSN1;
tPDredAIMSN1 = akDredN1 * aPAIMSN1;
tDDredNetSoilN1 = -(tDDredDetSN1 / cRhoOMN1) * bRhoSolidSoilN1;
tDDredNetIMSN1 = (1.0 - fDOrgSoilN1) * tDDredNetSoilN1;
tDDredNetHumSN1 = fDOrgSoilN1 * tDDredNetSoilN1;
tPDredNetHumSN1 = cPDSoilOMN1 * tDDredNetHumSN1;
tNDredNetHumSN1 = cNDSoilOMN1 * tDDredNetHumSN1;
tDDredDiatSN1 = akDredN1 * aDDiatSN1;
tPDredDiatSN1 = akDredN1 * aPDiatSN1;
tNDredDiatSN1 = akDredN1 * aNDiatSN1;
tDDredGrenSN1 = akDredN1 * aDGrenSN1;
tPDredGrenSN1 = akDredN1 * aPGrenSN1;
tNDredGrenSN1 = akDredN1 * aNGrenSN1;
tDDredBlueSN1 = akDredN1 * aDBlueSN1;
tPDredBlueSN1 = akDredN1 * aPBlueSN1;
tNDredBlueSN1 = akDredN1 * aNBlueSN1;
tDDredPhytSN1 = tDDredDiatSN1+tDDredGrenSN1+tDDredBlueSN1;
tPDredPhytSN1 = tPDredDiatSN1+tPDredGrenSN1+tPDredBlueSN1;
tNDredPhytSN1 = tNDredDiatSN1+tNDredGrenSN1+tNDredBlueSN1;
tDDredBentN1 = IF (InclWebN1 EQ TRUE) THEN akDredBentN1 * aDBentN1 ELSE 0.0 ENDIF;
tPDredBentN1 = IF (InclWebN1 EQ TRUE) THEN akDredBentN1 * aPBentN1 ELSE 0.0 ENDIF;
tNDredBentN1 = IF (InclWebN1 EQ TRUE) THEN akDredBentN1 * aNBentN1 ELSE 0.0 ENDIF;
tDDredVegN1 = akDredN1 * aDVegN1;
tPDredVegN1 = akDredN1 * aPVegN1;
tNDredVegN1 = akDredN1 * aNVegN1;
tDDredNetTotN1 = tDDredDetSN1 - tDDredNetSoilN1 + tDDredPhytSN1 + tDDredBentN1 + tDDredVegN1;
tPDredNetTotN1 = tPDredDetSN1 - tPDredNetHumSN1 + tPDredAIMSN1 + tPDredPhytSN1 + tPDredBentN1 + tPDredVegN1;
tNDredNetTotN1 = tNDredDetSN1 - tNDredNetHumSN1 + tNDredPhytSN1 + tNDredBentN1 + tNDredVegN1;
tSiDredTotN1 = tSiDredDetSN1 + cSiDDiatN1 * tDDredDiatSN1;
tDIMSN1 = tDAbioIMSN1;
tDHumSN1 = tDAbioHumSN1;
tDDetSN1 = tDAbioDetSN1 + tDPrimDetSN1 + tDWebDetSN1 + tDBedDetSEpiN1 + tDBedDetSHypN1;
vDeltaSN1 = (tDIMSN1 / cRhoIMN1 +(tDHumSN1 + tDDetSN1) / cRhoOMN1)/(1.0 - bPorSN1);
vDeltaWN1 = IF (ConstDepthN1 EQ TRUE ) THEN 0.0 ELSE - vDeltaSN1 ENDIF;
tDBurIMN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN ((tDHumSN1 + tDDetSN1) +(cRhoOMN1 / cRhoIMN1) * tDIMSN1) / ((aDHumSN1 + aDDetSN1) / aDIMSN1 + cRhoOMN1 / cRhoIMN1) ELSE ((tDHumSN1 + tDDetSN1) +(cRhoOMN1 / cRhoIMN1) * tDIMSN1) / (fDOrgSoilN1 /(1.0 - fDOrgSoilN1) + cRhoOMN1 / cRhoIMN1) ENDIF;
tDBurOMN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN (aDHumSN1 + aDDetSN1) / aDIMSN1 * tDBurIMN1 ELSE fDOrgSoilN1 /(1.0 - fDOrgSoilN1) * tDBurIMN1 ENDIF;
tDBurDetN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN aDDetSN1 /(aDHumSN1 + aDDetSN1) * tDBurOMN1 ELSE 0.0 ENDIF;
tDBurHumN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN tDBurOMN1 - tDBurDetN1 ELSE tDBurOMN1 ENDIF;
tDBurTotN1 =IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN1 GE 0.0) THEN tDBurIMN1 + tDBurOMN1 ELSE tDBurIMN1 + tDBurOMN1 ENDIF;
tPBurHumN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN rPDHumSN1 * tDBurHumN1 ELSE cPDSoilOMN1 * tDBurHumN1 ENDIF;
tPBurDetN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN1 GE 0.0) THEN rPDDetSN1 * tDBurDetN1 ELSE 0.0 ENDIF;
tPBurAIMN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN aPAIMSN1 / aDIMSN1 * tDBurIMN1 ELSE 0.0 ENDIF;
tPBurPO4N1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN aPO4SN1 *(vDeltaSN1 / cDepthSN1) ELSE cPO4GroundN1 *(bPorSN1 * vDeltaSN1) ENDIF;
tPBurTotN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN tPBurDetN1 + tPBurHumN1 + tPBurAIMN1 + tPBurPO4N1 ELSE tPBurHumN1 + tPBurAIMN1 + tPBurPO4N1 ENDIF;
tNBurHumN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN rNDHumSN1 * tDBurHumN1 ELSE cNDSoilOMN1 * tDBurHumN1 ENDIF;
tNBurDetN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN rNDDetSN1 * tDBurDetN1 ELSE 0.0 ENDIF;
tNBurNH4N1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN aNH4SN1 *(vDeltaSN1 / cDepthSN1) ELSE cNH4GroundN1 *(bPorSN1 * vDeltaSN1) ENDIF;
tNBurNO3N1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN aNO3SN1 *(vDeltaSN1 / cDepthSN1) ELSE cNO3GroundN1 *(bPorSN1 * vDeltaSN1) ENDIF;
tNBurTotN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN tNBurDetN1 + tNBurHumN1 + tNBurNH4N1 + tNBurNO3N1 ELSE tNBurHumN1 + tNBurNH4N1 + tNBurNO3N1 ENDIF;
tSiBurDetN1 = IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN rSiDDetSN1 * tDBurDetN1 ELSE 0.0 ENDIF;
tSiBurTotN1 =IF (InclBurN1 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN1 GE 0.0) THEN tSiBurDetN1 ELSE 0.0 ENDIF;
aRelDeltaWEpiN1 = IF ( aInclStratN1 EQ TRUE ) THEN (vDeltaWN1 ) / uDepthWEpiN1 ELSE (vDeltaWN1 + vDredDepthWN1) / uDepthWEpiN1 ENDIF;
aRelDeltaWHypN1 = IF ( aInclStratN1 EQ FALSE ) THEN 0.0 ELSE (vDeltaWN1 + vDredDepthWN1) / uDepthWHypN1 ENDIF ;
aPFishN1 = aPFiJvN1 + aPFiAdN1;
aNFishN1 = aNFiJvN1 + aNFiAdN1;
aDRelTotTN1 = uDepthWHypN1 * aRelDeltaWHypN1 * ( oDDetWHypN1 + oDIMWHypN1 + oDDiatWHypN1 + oDGrenWHypN1 + oDBlueWHypN1 + oDZooHypN1 ) + fMarshN1 * uDepthWMN1 * aRelDeltaWMN1 * ( oDDetWMN1 + oDIMWMN1 + oDDiatWMN1 + oDGrenWMN1 + oDBlueWMN1 + oDZooMN1) + uDepthWEpiN1 * aRelDeltaWEpiN1 * (oDDetWEpiN1 + oDIMWEpiN1 + oDDiatWEpiN1 + oDGrenWEpiN1 + oDBlueWEpiN1 + oDZooEpiN1 );
aNRelTotTN1 = uDepthWHypN1 * aRelDeltaWHypN1 * ( oNH4WHypN1 + oNO3WHypN1 + oNDetWHypN1 + oNDiatWHypN1 + oNGrenWHypN1 + oNBlueWHypN1 + oNZooHypN1 ) + fMarshN1 * uDepthWMN1 * aRelDeltaWMN1 * ( oNH4WMN1 + oNO3WMN1 + oNDetWMN1 + oNDiatWMN1 + oNGrenWMN1 + oNBlueWMN1 + oNZooMN1 ) + uDepthWEpiN1 * aRelDeltaWEpiN1 * ( oNH4WEpiN1 + oNO3WEpiN1 + oNDetWEpiN1 + oNDiatWEpiN1 + oNGrenWEpiN1 + oNBlueWEpiN1 + oNZooEpiN1 );
aPRelTotTN1 = uDepthWHypN1 * aRelDeltaWHypN1 * ( oPO4WHypN1 + oPAIMWHypN1 + oPDetWHypN1 + oPDiatWHypN1 + oPGrenWHypN1 + oPBlueWHypN1 + oPZooHypN1 ) + fMarshN1 * uDepthWMN1 * aRelDeltaWMN1 * (oPO4WMN1 + oPAIMWMN1 + oPDetWMN1 + oPDiatWMN1 + oPGrenWMN1 + oPBlueWMN1 + oPZooMN1 ) + uDepthWEpiN1 * aRelDeltaWEpiN1 * (oPO4WEpiN1 + oPAIMWEpiN1 + oPDetWEpiN1 + oPDiatWEpiN1 + oPGrenWEpiN1 + oPBlueWEpiN1 + oPZooEpiN1 );
aSiRelTotTN1 = uDepthWHypN1 * aRelDeltaWHypN1 * ( oSiO2WHypN1 + oSiDetWHypN1 + cSiDDiatN1*oDDiatWHypN1) + fMarshN1 * uDepthWMN1 * aRelDeltaWMN1 * ( oSiO2WMN1 + oSiDetWMN1 + cSiDDiatN1*oDDiatWMN1) + uDepthWEpiN1 * aRelDeltaWEpiN1 * ( oSiO2WEpiN1 + oSiDetWEpiN1 + cSiDDiatN1*oDDiatWEpiN1);
aO2RelTotTN1 = uDepthWHypN1 * aRelDeltaWHypN1* oO2WHypN1 + fMarshN1 * uDepthWMN1 * aRelDeltaWMN1 * oO2WMN1 + uDepthWEpiN1 * aRelDeltaWEpiN1 * oO2WEpiN1 ;
aDTotTHypN1 = IF (aInclStratN1 EQ TRUE) THEN (oDIMWHypN1+oDDetWHypN1+oDDiatWHypN1+oDGrenWHypN1+oDBlueWHypN1+oDZooHypN1) * uDepthWHypN1 ELSE 0.0 ENDIF;
aNTotTHypN1 = IF (aInclStratN1 EQ TRUE) THEN (oNH4WHypN1+oNO3WHypN1+oNDetWHypN1+oNDiatWHypN1+oNGrenWHypN1+oNBlueWHypN1 +oNZooHypN1)*uDepthWHypN1 ELSE 0.0 ENDIF;
aPTotTHypN1 = IF (aInclStratN1 EQ TRUE) THEN (oPO4WHypN1+oPDetWHypN1+oPDiatWHypN1+oPGrenWHypN1+oPBlueWHypN1 +oPZooHypN1+oPAIMWHypN1) * uDepthWHypN1 ELSE 0.0 ENDIF;
aSiTotTHypN1 = IF (aInclStratN1 EQ TRUE) THEN (oSiO2WHypN1 + oSiDetWHypN1 + cSiDDiatN1*oDDiatWHypN1) *uDepthWHypN1 ELSE 0.0 ENDIF;
aO2TotTHypN1 = IF (aInclStratN1 EQ TRUE) THEN (oO2WHypN1 ) *uDepthWHypN1 ELSE 0.0 ENDIF;
aDTotTN1 = aDTotTHypN1 + (oDIMWEpiN1+oDDetWEpiN1+oDDiatWEpiN1+oDGrenWEpiN1+oDBlueWEpiN1+oDZooEpiN1) * uDepthWEpiN1 +aDFishN1+aDPiscN1+aDVegN1 +aDIMSN1+aDHumSN1+aDDetSN1+aDDiatSN1+aDGrenSN1+aDBlueSN1+aDBentN1 + aDTotMN1 + aDBlueSurfN1;
aNTotTN1 = aNTotTHypN1+ (oNH4WEpiN1+oNO3WEpiN1+oNDetWEpiN1+oNDiatWEpiN1+oNGrenWEpiN1+oNBlueWEpiN1 +oNZooEpiN1)*uDepthWEpiN1 +aNFishN1+aNPiscN1+aNVegN1 +aNH4SN1+aNO3SN1+aNDetSN1+aNHumSN1+aNDiatSN1+aNGrenSN1+aNBlueSN1 +aNBentN1 + aNTotMN1 + aNBlueSurfN1;
aPTotTN1 = aPTotTHypN1 + (oPO4WEpiN1+oPDetWEpiN1+oPDiatWEpiN1+oPGrenWEpiN1+oPBlueWEpiN1 +oPZooEpiN1+oPAIMWEpiN1) * uDepthWEpiN1 +aPFishN1+aPPiscN1+aPVegN1 +aPO4SN1+aPDetSN1+aPHumSN1+aPDiatSN1+aPGrenSN1+aPBlueSN1 +aPAIMSN1+aPBentN1 + aPTotMN1 +aPBlueSurfN1;
aSiTotTN1 = aSiTotTHypN1 + (oSiO2WEpiN1 + oSiDetWEpiN1 + cSiDDiatN1*oDDiatWEpiN1) *uDepthWEpiN1 + aSiDetSN1 + cSiDDiatN1*aDDiatSN1 + aSiTotMN1;
aO2TotTN1 = aO2TotTHypN1 + ( oO2WEpiN1) *uDepthWEpiN1 + aO2TotMN1;
tDBedTotTN1 = IF InclVegN1 EQ TRUE THEN tDMigrVegN1 + tDProdVegHypN1+ tDProdVegEpiN1 - tDRespVegN1 - tDManVegN1 - tDAssVegBirdN1 ELSE 0.0 ENDIF;
tPBedTotTN1 = IF InclVegN1 EQ TRUE THEN tPMigrVegN1 - tPManVegN1 - tPAssVegBirdN1 ELSE 0.0 ENDIF;
tNBedTotTN1 = IF InclVegN1 EQ TRUE THEN tNMigrVegN1 - tNManVegN1 - tNAssVegBirdN1 ELSE 0.0 ENDIF ;
aDErrorN1 = aDTotTN1 - aDExtTotTN1;
aNErrorN1 = aNTotTN1 - aNExtTotTN1;
aPErrorN1 = aPTotTN1 - aPExtTotTN1;
aSiErrorN1 = aSiTotTN1 - aSiExtTotTN1;
aO2ErrorN1 = aO2TotTN1 - aO2ExtTotTN1;
aDepthErrorN1 = sDepthWN1 - aDepthExtTotTN1;
cCheckVegHeightN1 = IF ( aVegWinN1 EQ 1 AND  uVegHeightN1 LT MIN (cVegHeightWinN1, uDepthWN1) ) THEN 1.0 ELSEIF ( aVegWinN1 EQ 1 AND  uVegHeightN1 GT MIN (cVegHeightWinN1, uDepthWN1) ) THEN 2.0 ELSEIF ( aVegWinN1 EQ 0 AND  uVegHeightN1 LT MIN (cVegHeightN1, uDepthWN1) ) THEN  3.0 ELSEIF ( aVegWinN1 EQ 0 AND  uVegHeightN1 GT MIN (cVegHeightN1, uDepthWN1) ) THEN 4.0 ELSE 0.0 ENDIF;
sTimeN2 = time + DayStartN2;
DaysInYearN2 = DaysPerYearN2* 1;
aInclStratN2 =IF ( InclStratN2 EQ FALSE ) THEN 0.0 ELSE 1.0 ENDIF;
uDepthMixMeasN2 =IF ( calcMixDepthN2 EQ TRUE ) THEN cAMixN2 * POW ( cFetchN2 , (cBMixN2) ) ELSEIF (ReadMixDepthN2 EQ TRUE) THEN mMixDepthN2 ELSE cMixDepthN2 ENDIF;
uDepthWN2= IF sDepthWN2 GT (cMinDepthHypEpiN2 + cMinDepthHypEpiN2) THEN sDepthWN2 ELSE (cMinDepthHypEpiN2 + cMinDepthHypEpiN2) ENDIF;
uDepthWHypN2 =IF ( ( aInclStratN2 EQ TRUE ) AND ((uDepthWN2 - sMixDepthWN2 ) GE cMinDepthHypEpiN2 ) ) THEN uDepthWN2 - sMixDepthWN2  ELSE cMinDepthHypEpiN2 ENDIF;
uDepthWEpiN2 =IF( ( aInclStratN2 EQ TRUE ) AND ( sMixDepthWN2 GE cMinDepthHypEpiN2 ) AND ( uDepthWN2 GE sMixDepthWN2 ) ) THEN sMixDepthWN2 ELSEIF ( ( aInclStratN2 EQ TRUE ) AND ( (sMixDepthWN2 LE cMinDepthHypEpiN2 ) OR (uDepthWN2 LE cMinDepthHypEpiN2 ) ) ) THEN cMinDepthHypEpiN2 ELSEIF ( aInclStratN2 EQ FALSE) THEN uDepthWN2 ELSE uDepthWN2 - uDepthWHypN2 ENDIF;
MassHypN2 = IF CalcMassN2 EQ TRUE THEN uDepthWHypN2 ELSE 1.0 ENDIF;
MassEpiN2 = IF CalcMassN2 EQ TRUE THEN uDepthWEpiN2 ELSE 1.0 ENDIF;
MassWMN2 = IF CalcMassN2 EQ TRUE THEN sDepthWMN2 ELSE 1.0 ENDIF;
oNH4WHypN2= IF sNH4WHypN2 GT NearZeroN2 THEN sNH4WHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNO3WHypN2= IF sNO3WHypN2 GT NearZeroN2 THEN sNO3WHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPO4WHypN2= IF sPO4WHypN2 GT NearZeroN2 THEN sPO4WHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPAIMWHypN2= IF sPAIMWHypN2 GT NearZeroN2 THEN sPAIMWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oSiO2WHypN2= IF sSiO2WHypN2 GT NearZeroN2 THEN sSiO2WHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oO2WHypN2= IF sO2WHypN2 GT NearZeroN2 THEN sO2WHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDDetWHypN2= IF sDDetWHypN2 GT NearZeroN2 THEN sDDetWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNDetWHypN2= IF sNDetWHypN2 GT NearZeroN2 THEN sNDetWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPDetWHypN2= IF sPDetWHypN2 GT NearZeroN2 THEN sPDetWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oSiDetWHypN2= IF sSiDetWHypN2 GT NearZeroN2 THEN sSiDetWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDIMWHypN2= IF sDIMWHypN2 GT NearZeroN2 THEN sDIMWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDDiatWHypN2= IF sDDiatWHypN2 GT NearZeroN2 THEN sDDiatWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNDiatWHypN2= IF sNDiatWHypN2 GT NearZeroN2 THEN sNDiatWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPDiatWHypN2= IF sPDiatWHypN2 GT NearZeroN2 THEN sPDiatWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDGrenWHypN2= IF sDGrenWHypN2 GT NearZeroN2 THEN sDGrenWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNGrenWHypN2= IF sNGrenWHypN2 GT NearZeroN2 THEN sNGrenWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPGrenWHypN2= IF sPGrenWHypN2 GT NearZeroN2 THEN sPGrenWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDBlueWHypN2= IF sDBlueWHypN2 GT NearZeroN2 THEN sDBlueWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNBlueWHypN2= IF sNBlueWHypN2 GT NearZeroN2 THEN sNBlueWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPBlueWHypN2= IF sPBlueWHypN2 GT NearZeroN2 THEN sPBlueWHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oDZooHypN2= IF sDZooHypN2 GT NearZeroN2 THEN sDZooHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oNZooHypN2= IF sNZooHypN2 GT NearZeroN2 THEN sNZooHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
oPZooHypN2= IF sPZooHypN2 GT NearZeroN2 THEN sPZooHypN2 / MassHypN2 ELSE NearZeroN2 ENDIF;
aDFiAdN2= IF sDFiAdN2 GT NearZeroN2 THEN sDFiAdN2 ELSE NearZeroN2 ENDIF;
aDFiJvN2= IF sDFiJvN2 GT NearZeroN2 THEN sDFiJvN2 ELSE NearZeroN2 ENDIF;
aNFiAdN2= IF sNFiAdN2 GT NearZeroN2 THEN sNFiAdN2 ELSE NearZeroN2 ENDIF;
aNFiJvN2= IF sNFiJvN2 GT NearZeroN2 THEN sNFiJvN2 ELSE NearZeroN2 ENDIF;
aPFiAdN2= IF sPFiAdN2 GT NearZeroN2 THEN sPFiAdN2 ELSE NearZeroN2 ENDIF;
aPFiJvN2= IF sPFiJvN2 GT NearZeroN2 THEN sPFiJvN2 ELSE NearZeroN2 ENDIF;
aDPiscN2= IF sDPiscN2 GT NearZeroN2 THEN sDPiscN2 ELSE NearZeroN2 ENDIF;
aNH4SN2= IF sNH4SN2 GT NearZeroN2 THEN sNH4SN2 ELSE NearZeroN2 ENDIF;
aNO3SN2= IF sNO3SN2 GT NearZeroN2 THEN sNO3SN2 ELSE NearZeroN2 ENDIF;
aPO4SN2= IF sPO4SN2 GT NearZeroN2 THEN sPO4SN2 ELSE NearZeroN2 ENDIF;
aPAIMSN2= IF sPAIMSN2 GT NearZeroN2 THEN sPAIMSN2 ELSE NearZeroN2 ENDIF;
aDDetSN2= IF sDDetSN2 GT NearZeroN2 THEN sDDetSN2 ELSE NearZeroN2 ENDIF;
aNDetSN2= IF sNDetSN2 GT NearZeroN2 THEN sNDetSN2 ELSE NearZeroN2 ENDIF;
aPDetSN2= IF sPDetSN2 GT NearZeroN2 THEN sPDetSN2 ELSE NearZeroN2 ENDIF;
aSiDetSN2= IF sSiDetSN2 GT NearZeroN2 THEN sSiDetSN2 ELSE NearZeroN2 ENDIF;
aDHumSN2= IF sDHumSN2 GT NearZeroN2 THEN sDHumSN2 ELSE NearZeroN2 ENDIF;
aNHumSN2= IF sNHumSN2 GT NearZeroN2 THEN sNHumSN2 ELSE NearZeroN2 ENDIF;
aPHumSN2= IF sPHumSN2 GT NearZeroN2 THEN sPHumSN2 ELSE NearZeroN2 ENDIF;
aDIMSN2= IF sDIMSN2 GT NearZeroN2 THEN sDIMSN2 ELSE NearZeroN2 ENDIF;
aDDiatSN2= IF sDDiatSN2 GT NearZeroN2 THEN sDDiatSN2 ELSE NearZeroN2 ENDIF;
aNDiatSN2= IF sNDiatSN2 GT NearZeroN2 THEN sNDiatSN2 ELSE NearZeroN2 ENDIF;
aPDiatSN2= IF sPDiatSN2 GT NearZeroN2 THEN sPDiatSN2 ELSE NearZeroN2 ENDIF;
aDGrenSN2= IF sDGrenSN2 GT NearZeroN2 THEN sDGrenSN2 ELSE NearZeroN2 ENDIF;
aNGrenSN2= IF sNGrenSN2 GT NearZeroN2 THEN sNGrenSN2 ELSE NearZeroN2 ENDIF;
aPGrenSN2= IF sPGrenSN2 GT NearZeroN2 THEN sPGrenSN2 ELSE NearZeroN2 ENDIF;
aDBlueSN2= IF sDBlueSN2 GT NearZeroN2 THEN sDBlueSN2 ELSE NearZeroN2 ENDIF;
aNBlueSN2= IF sNBlueSN2 GT NearZeroN2 THEN sNBlueSN2 ELSE NearZeroN2 ENDIF;
aPBlueSN2= IF sPBlueSN2 GT NearZeroN2 THEN sPBlueSN2 ELSE NearZeroN2 ENDIF;
aDVegN2= IF sDVegN2 GT NearZeroN2 THEN sDVegN2 ELSE NearZeroN2 ENDIF;
aNVegN2= IF sNVegN2 GT NearZeroN2 THEN sNVegN2 ELSE NearZeroN2 ENDIF;
aPVegN2= IF sPVegN2 GT NearZeroN2 THEN sPVegN2 ELSE NearZeroN2 ENDIF;
aVegHeightN2= IF sVegHeightN2 GT NearZeroN2 THEN sVegHeightN2 ELSE NearZeroN2 ENDIF;
aDBentN2= IF sDBentN2 GT NearZeroN2 THEN sDBentN2 ELSE NearZeroN2 ENDIF;
aNBentN2= IF sNBentN2 GT NearZeroN2 THEN sNBentN2 ELSE NearZeroN2 ENDIF;
aPBentN2= IF sPBentN2 GT NearZeroN2 THEN sPBentN2 ELSE NearZeroN2 ENDIF;
uDepthWMN2= IF sDepthWMN2 GT NearZeroN2 THEN sDepthWMN2 ELSE NearZeroN2 ENDIF;
oNH4WMN2= IF sNH4WMN2 GT NearZeroN2 THEN sNH4WMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNO3WMN2= IF sNO3WMN2 GT NearZeroN2 THEN sNO3WMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPO4WMN2= IF sPO4WMN2 GT NearZeroN2 THEN sPO4WMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPAIMWMN2= IF sPAIMWMN2 GT NearZeroN2 THEN sPAIMWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oSiO2WMN2= IF sSiO2WMN2 GT NearZeroN2 THEN sSiO2WMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oO2WMN2= IF sO2WMN2 GT NearZeroN2 THEN sO2WMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDDetWMN2= IF sDDetWMN2 GT NearZeroN2 THEN sDDetWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNDetWMN2= IF sNDetWMN2 GT NearZeroN2 THEN sNDetWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPDetWMN2= IF sPDetWMN2 GT NearZeroN2 THEN sPDetWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oSiDetWMN2= IF sSiDetWMN2 GT NearZeroN2 THEN sSiDetWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDIMWMN2= IF sDIMWMN2 GT NearZeroN2 THEN sDIMWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDDiatWMN2= IF sDDiatWMN2 GT NearZeroN2 THEN sDDiatWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNDiatWMN2= IF sNDiatWMN2 GT NearZeroN2 THEN sNDiatWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPDiatWMN2= IF sPDiatWMN2 GT NearZeroN2 THEN sPDiatWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDGrenWMN2= IF sDGrenWMN2 GT NearZeroN2 THEN sDGrenWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNGrenWMN2= IF sNGrenWMN2 GT NearZeroN2 THEN sNGrenWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPGrenWMN2= IF sPGrenWMN2 GT NearZeroN2 THEN sPGrenWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDBlueWMN2= IF sDBlueWMN2 GT NearZeroN2 THEN sDBlueWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNBlueWMN2= IF sNBlueWMN2 GT NearZeroN2 THEN sNBlueWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPBlueWMN2= IF sPBlueWMN2 GT NearZeroN2 THEN sPBlueWMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oDZooMN2= IF sDZooMN2 GT NearZeroN2 THEN sDZooMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oNZooMN2= IF sNZooMN2 GT NearZeroN2 THEN sNZooMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
oPZooMN2= IF sPZooMN2 GT NearZeroN2 THEN sPZooMN2 / MassWMN2 ELSE NearZeroN2 ENDIF;
aNH4SMN2= IF sNH4SMN2 GT NearZeroN2 THEN sNH4SMN2 ELSE NearZeroN2 ENDIF;
aNO3SMN2= IF sNO3SMN2 GT NearZeroN2 THEN sNO3SMN2 ELSE NearZeroN2 ENDIF;
aPO4SMN2= IF sPO4SMN2 GT NearZeroN2 THEN sPO4SMN2 ELSE NearZeroN2 ENDIF;
aPAIMSMN2= IF sPAIMSMN2 GT NearZeroN2 THEN sPAIMSMN2 ELSE NearZeroN2 ENDIF;
aDDetSMN2= IF sDDetSMN2 GT NearZeroN2 THEN sDDetSMN2 ELSE NearZeroN2 ENDIF;
aNDetSMN2= IF sNDetSMN2 GT NearZeroN2 THEN sNDetSMN2 ELSE NearZeroN2 ENDIF;
aPDetSMN2= IF sPDetSMN2 GT NearZeroN2 THEN sPDetSMN2 ELSE NearZeroN2 ENDIF;
aSiDetSMN2= IF sSiDetSMN2 GT NearZeroN2 THEN sSiDetSMN2 ELSE NearZeroN2 ENDIF;
aDHumSMN2= IF sDHumSMN2 GT NearZeroN2 THEN sDHumSMN2 ELSE NearZeroN2 ENDIF;
aNHumSMN2= IF sNHumSMN2 GT NearZeroN2 THEN sNHumSMN2 ELSE NearZeroN2 ENDIF;
aPHumSMN2= IF sPHumSMN2 GT NearZeroN2 THEN sPHumSMN2 ELSE NearZeroN2 ENDIF;
aDIMSMN2= IF sDIMSMN2 GT NearZeroN2 THEN sDIMSMN2 ELSE NearZeroN2 ENDIF;
aDRootPhraN2= IF sDRootPhraN2 GT NearZeroN2 THEN sDRootPhraN2 ELSE NearZeroN2 ENDIF;
aDShootPhraN2= IF sDShootPhraN2 GT NearZeroN2 THEN sDShootPhraN2 ELSE NearZeroN2 ENDIF;
aNRootPhraN2= IF sNRootPhraN2 GT NearZeroN2 THEN sNRootPhraN2 ELSE NearZeroN2 ENDIF;
aNShootPhraN2= IF sNShootPhraN2 GT NearZeroN2 THEN sNShootPhraN2 ELSE NearZeroN2 ENDIF;
aPRootPhraN2= IF sPRootPhraN2 GT NearZeroN2 THEN sPRootPhraN2 ELSE NearZeroN2 ENDIF;
aPShootPhraN2= IF sPShootPhraN2 GT NearZeroN2 THEN sPShootPhraN2 ELSE NearZeroN2 ENDIF;
oNH4WEpiN2= IF sNH4WEpiN2 GT NearZeroN2 THEN sNH4WEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNO3WEpiN2= IF sNO3WEpiN2 GT NearZeroN2 THEN sNO3WEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPO4WEpiN2= IF sPO4WEpiN2 GT NearZeroN2 THEN sPO4WEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPAIMWEpiN2= IF sPAIMWEpiN2 GT NearZeroN2 THEN sPAIMWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oSiO2WEpiN2= IF sSiO2WEpiN2 GT NearZeroN2 THEN sSiO2WEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oO2WEpiN2= IF sO2WEpiN2 GT NearZeroN2 THEN sO2WEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDDetWEpiN2= IF sDDetWEpiN2 GT NearZeroN2 THEN sDDetWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNDetWEpiN2= IF sNDetWEpiN2 GT NearZeroN2 THEN sNDetWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPDetWEpiN2= IF sPDetWEpiN2 GT NearZeroN2 THEN sPDetWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oSiDetWEpiN2= IF sSiDetWEpiN2 GT NearZeroN2 THEN sSiDetWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDIMWEpiN2= IF sDIMWEpiN2 GT NearZeroN2 THEN sDIMWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDDiatWEpiN2= IF sDDiatWEpiN2 GT NearZeroN2 THEN sDDiatWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNDiatWEpiN2= IF sNDiatWEpiN2 GT NearZeroN2 THEN sNDiatWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPDiatWEpiN2= IF sPDiatWEpiN2 GT NearZeroN2 THEN sPDiatWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDGrenWEpiN2= IF sDGrenWEpiN2 GT NearZeroN2 THEN sDGrenWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNGrenWEpiN2= IF sNGrenWEpiN2 GT NearZeroN2 THEN sNGrenWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPGrenWEpiN2= IF sPGrenWEpiN2 GT NearZeroN2 THEN sPGrenWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDBlueWEpiN2= IF sDBlueWEpiN2 GT NearZeroN2 THEN sDBlueWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNBlueWEpiN2= IF sNBlueWEpiN2 GT NearZeroN2 THEN sNBlueWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPBlueWEpiN2= IF sPBlueWEpiN2 GT NearZeroN2 THEN sPBlueWEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oDZooEpiN2= IF sDZooEpiN2 GT NearZeroN2 THEN sDZooEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oNZooEpiN2= IF sNZooEpiN2 GT NearZeroN2 THEN sNZooEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
oPZooEpiN2= IF sPZooEpiN2 GT NearZeroN2 THEN sPZooEpiN2 / MassEpiN2 ELSE NearZeroN2 ENDIF;
aDBlueSurfN2= IF sDBlueSurfN2 GT NearZeroN2 THEN sDBlueSurfN2 ELSE NearZeroN2 ENDIF;
aNBlueSurfN2= IF sNBlueSurfN2 GT NearZeroN2 THEN sNBlueSurfN2  ELSE NearZeroN2 ENDIF;
aPBlueSurfN2= IF sPBlueSurfN2 GT NearZeroN2 THEN sPBlueSurfN2  ELSE NearZeroN2 ENDIF;
aDExtTotTN2= sDExtTotTN2;
aNExtTotTN2= sNExtTotTN2 ;
aPExtTotTN2=  sPExtTotTN2 ;
aSiExtTotTN2= sSiExtTotTN2;
aO2ExtTotTN2=sO2ExtTotTN2 ;
aDepthExtTotTN2=sDepthExtTotTN2 ;
aDDetWEpiN2= IF sDDetWEpiN2 GT NearZeroN2 THEN sDDetWEpiN2 ELSE NearZeroN2 ENDIF;
aNDetWEpiN2= IF sNDetWEpiN2 GT NearZeroN2 THEN sNDetWEpiN2  ELSE NearZeroN2 ENDIF;
aPDetWEpiN2= IF sPDetWEpiN2 GT NearZeroN2 THEN sPDetWEpiN2  ELSE NearZeroN2 ENDIF;
aSiDetWEpiN2= IF sSiDetWEpiN2 GT NearZeroN2 THEN sSiDetWEpiN2 ELSE NearZeroN2 ENDIF;
aDIMWEpiN2= IF sDIMWEpiN2 GT NearZeroN2 THEN aDIMWEpiN2  ELSE NearZeroN2 ENDIF;
aDDiatWEpiN2= IF sDDiatWEpiN2 GT NearZeroN2 THEN sDDiatWEpiN2 ELSE NearZeroN2 ENDIF;
aNDiatWEpiN2= IF sNDiatWEpiN2 GT NearZeroN2 THEN sNDiatWEpiN2  ELSE NearZeroN2 ENDIF;
aPDiatWEpiN2= IF sPDiatWEpiN2 GT NearZeroN2 THEN sPDiatWEpiN2  ELSE NearZeroN2 ENDIF;
aDGrenWEpiN2= IF sDGrenWEpiN2 GT NearZeroN2 THEN sDGrenWEpiN2 ELSE NearZeroN2 ENDIF;
aNGrenWEpiN2= IF sNGrenWEpiN2 GT NearZeroN2 THEN sNGrenWEpiN2 ELSE NearZeroN2 ENDIF;
aPGrenWEpiN2= IF sPGrenWEpiN2 GT NearZeroN2 THEN sPGrenWEpiN2 ELSE NearZeroN2 ENDIF;
aDBlueWEpiN2= IF sDBlueWEpiN2 GT NearZeroN2 THEN sDBlueWEpiN2 ELSE NearZeroN2 ENDIF;
aNBlueWEpiN2= IF sNBlueWEpiN2 GT NearZeroN2 THEN sNBlueWEpiN2  ELSE NearZeroN2 ENDIF;
aPBlueWEpiN2= IF sPBlueWEpiN2 GT NearZeroN2 THEN sPBlueWEpiN2 ELSE NearZeroN2 ENDIF;
aDBlueWHypN2= IF sDBlueWEpiN2 GT NearZeroN2 THEN sDBlueWEpiN2 ELSE NearZeroN2 ENDIF;
TimeYearsN2 = sTimeN2 / DaysPerYearN2;
DayN2 = sTimeN2 - FLOOR(TimeYearsN2) * DaysPerYearN2;
YearsN2 = YearZeroN2 + TimeYearsN2;
aVegEHeightN2 =   POW ( cVegHPar1N2*aDVegN2 , cVegHPar2N2 ) ;
uVegHeightN2 =  IF ( UseVegHeightN2 EQ FALSE AND  aVegHeightN2 LT uDepthWN2 ) THEN aVegHeightN2 ELSEIF ( UseVegHeightN2 EQ FALSE ) THEN ( uDepthWN2 ) ELSE MIN ( aVegHeightN2 , uDepthWN2 , aVegEHeightN2 ) ENDIF;
uVegHeightHypN2 = IF ( aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uVegHeightN2 GT uDepthWHypN2 ) THEN uDepthWHypN2 ELSE uVegHeightN2 ENDIF;
uVegHeightEpiN2 = IF ( aInclStratN2 EQ FALSE AND uVegHeightN2 LT uDepthWEpiN2 ) THEN uVegHeightN2 ELSEIF ( aInclStratN2 EQ FALSE AND uVegHeightN2 GE uDepthWEpiN2 ) THEN uDepthWEpiN2 ELSEIF (uVegHeightN2 GT uDepthWHypN2 ) THEN uVegHeightN2 -uDepthWHypN2 ELSE 0.0 ENDIF;
aDepth2VegHypN2 = IF ( aInclStratN2 EQ TRUE AND fDepth2VegN2 GE 1 ) THEN uDepthWHypN2  ELSEIF ( aInclStratN2 EQ TRUE AND fDepth2VegN2 LT 1 ) THEN MAX (0.0, uVegHeightN2 - uDepthWEpiN2 ) ELSE 0.0 ENDIF;
aDepth1VegHypN2 = IF ( aInclStratN2 EQ TRUE AND fDepth2VegN2 GE 1 ) THEN uDepthWHypN2 - uVegHeightHypN2  ELSE 0.0 ENDIF;
aDepth2VegEpiN2 = IF (fDepth2VegN2 GE 1 ) THEN uDepthWEpiN2 ELSE uDepthWEpiN2 - uVegHeightEpiN2 ENDIF;
aDepth1VegEpiN2 = IF (fDepth2VegN2 GE 1 ) THEN uDepthWEpiN2 - uVegHeightEpiN2  ELSE 0.0 ENDIF;
uVegHeightLightN2 = cVegLN2 *LN( 1.0 + uVegHeightN2 );
uVegHeightLightSumN2 = cVegLN2 *LN( 1.0 + MAX (uVegHeightN2, MIN (uDepthWN2, cVegHeightN2) ) );
uVegHeightLightEpiN2 = IF (  uVegHeightLightN2 GT uVegHeightEpiN2 ) THEN uVegHeightEpiN2 ELSE uVegHeightLightN2 ENDIF;
uVegHeightLightHypN2 =  uVegHeightLightN2 - uVegHeightLightEpiN2  ;
uDVegHypN2 = uVegHeightHypN2 / uVegHeightN2 * aDVegN2;
uDVegEpiN2 = uVegHeightEpiN2 / uVegHeightN2 * aDVegN2;
uVegShadeN2 = IF ( ReadVegShadeN2  EQ  TRUE) THEN mVegShadeN2 ELSE fVegShadeN2 ENDIF;
aExtPhytHypN2 = cExtSpDiatN2 * oDDiatWHypN2 + cExtSpGrenN2 * oDGrenWHypN2 + cExtSpBlueN2 * oDBlueWHypN2;
aExtDetHypN2 = cExtSpDetN2 * oDDetWHypN2;
aExtIMHypN2 = cExtSpIMN2 * oDIMWHypN2;
aExtCoefOpenHypN2 = cExtWatN2 + aExtIMHypN2 + aExtDetHypN2 + aExtPhytHypN2;
aExtPhytEpiN2 = cExtSpDiatN2 * oDDiatWEpiN2 + cExtSpGrenN2 * oDGrenWEpiN2 + cExtSpBlueN2 * oDBlueWEpiN2;
aExtDetEpiN2 = cExtSpDetN2 * oDDetWEpiN2;
aExtIMEpiN2 = cExtSpIMN2 * oDIMWEpiN2;
aExtCoefOpenEpiN2 = cExtWatN2 + aExtIMEpiN2 + aExtDetEpiN2 + aExtPhytEpiN2;
aExtSurfN2 = cExtSpBlueN2 * aDBlueSurfN2;
aTmEpiN2 =  cTmAveEpiN2 - cTmVarEpiN2 * COS(2.0*PiN2*(sTimeN2 + TenDaysN2 - cTimeLagN2) / DaysInYearN2) ;
aTmHypN2 =  cTmAveHypN2 - cTmVarHypN2 * COS(2.0*PiN2*(sTimeN2 + TenDaysN2 - cTimeLagN2) / DaysInYearN2) ;
uTmEpiN2 = IF (FALSE EQ InclSeasonN2) THEN cTmAveEpiN2 ELSEIF (ReadTempN2 EQ TRUE) THEN mTempEpiN2 ELSEIF ( aTmEpiN2 GT 0.0  ) THEN aTmEpiN2 ELSE  0.0 ENDIF;
uTmHypN2 = IF (FALSE EQ InclSeasonN2) THEN cTmAveHypN2 ELSEIF (ReadTempN2 EQ TRUE) THEN mTempHypN2 ELSEIF ( aTmHypN2 GT 0.0  ) THEN aTmHypN2 ELSE  0.0 ENDIF;
uTmBotN2 = IF (aInclStratN2 EQ TRUE ) THEN uTmHypN2 ELSE uTmEpiN2 ENDIF;
uTmSurfN2 = uTmEpiN2;
uLATN2= cLATN2*2*PiN2/360;
uSolDecAngN2= IF(InclLatN2 EQ TRUE) THEN cPhiRN2*COS(2*PiN2*(DayN2-cDayRN2)/DaysInYearN2) ELSE 0.0 ENDIF;
uSunRiseN2 = HoursInDayN2/(2*PiN2)*ACOS((SIN(uLATN2)* SIN(uSolDecAngN2))/(COS(uLATN2)*COS(uSolDecAngN2))) ;
uSunSetN2=HoursInDayN2-uSunRiseN2;
uSunHoursN2=uSunSetN2-uSunRiseN2;
uSunPathN2= IF(InclLatN2 EQ TRUE) THEN SIN(uLATN2)*SIN( uSolDecAngN2 )*( uSunSetN2-uSunRiseN2)- COS(uLATN2) * COS (uSolDecAngN2) * HoursInDayN2 / (2*PiN2) * ( SIN (2*PiN2*uSunSetN2/HoursInDayN2 ) -SIN(2*PiN2*uSunRiseN2 /HoursInDayN2 )) ELSE 0.0 ENDIF;
uTransN2=IF((InclLatN2 EQ TRUE) AND (ConstTransN2 EQ FALSE)) THEN (0.6-0.2*(uSunPathN2/(uSunSetN2 - uSunRiseN2)))*(1-0.4*fCloudHN2) *(1-0.7* fCloudMN2) *(1-0.4*fCloudLN2)ELSEIF ((InclLatN2 EQ TRUE) AND (ConstTransN2 EQ TRUE)) THEN cTransN2 ELSE 0.0 ENDIF;
ufDayN2 = IF (FALSE EQ InclSeasonN2) THEN cfDayAveN2 ELSEIF (InclLatN2 EQ TRUE) THEN (uSunSetN2 -uSunRiseN2 )/ HoursInDayN2 ELSE cfDayAveN2 - cfDayVarN2 * COS( 2.0 *PiN2*(sTimeN2+TenDaysN2) / DaysInYearN2) ENDIF;
uLDayN2 = IF (FALSE EQ InclSeasonN2) THEN cLDayAveN2 ELSEIF (ReadLOutN2 EQ TRUE) THEN 0.0 ELSEIF (InclLatN2 EQ TRUE) THEN cSolarN2*uTransN2*uSunPathN2 * SecsPerDayN2 /HoursInDayN2 ELSE cLDayAveN2 - cLDayVarN2 * COS(2.0*PiN2*(sTimeN2+TenDaysN2) / DaysInYearN2) ENDIF;
uLOutN2 = IF (FALSE EQ InclSeasonN2) THEN uLDayN2 / SecsPerDayN2 / ufDayN2 ELSEIF (ReadLOutN2 EQ TRUE) THEN mLOutN2 / ufDayN2 ELSE uLDayN2 / SecsPerDayN2 / ufDayN2 ENDIF;
uLPARSurfN2 = fPARN2 * (1.0 - fReflN2) * uLOutN2;
aLPARBotSurfN2 = IF (InclSurfN2 EQ TRUE) THEN uLPARSurfN2 * EXP(- aExtSurfN2) ELSE uLPARSurfN2 ENDIF;
aLPARBotEpiOpenN2 = aLPARBotSurfN2 * EXP(- aExtCoefOpenEpiN2 * uDepthWEpiN2);
aLPARBotHypOpenN2 = aLPARBotEpiOpenN2 * EXP(- aExtCoefOpenHypN2 * uDepthWHypN2);
aLPAR1VegEpiN2 = aLPARBotSurfN2 * EXP(- aExtCoefOpenEpiN2 * aDepth1VegEpiN2) * ( 1 - uVegShadeN2 );
aLPAR1VegHypN2 = aLPAR1VegEpiN2 * EXP(- aExtCoefOpenHypN2 * aDepth1VegHypN2);
aLPARVegLightN2 =  IF  ( aInclStratN2 EQ TRUE AND  uVegHeightN2 LE uDepthWHypN2 ) THEN aLPAR1VegHypN2 *   EXP(- aExtCoefOpenHypN2 * uVegHeightLightEpiN2) ELSE aLPAR1VegEpiN2 *  EXP(- aExtCoefOpenEpiN2 * uVegHeightLightEpiN2)  *  EXP(- aExtCoefOpenHypN2 * uVegHeightLightEpiN2) ENDIF;
uTmVegAveN2 = ( uVegHeightHypN2 * uTmHypN2 + uVegHeightEpiN2 * uTmEpiN2 ) / uVegHeightN2;
uFunTmVegN2 = EXP(-0.5/(cSigTmVegN2*cSigTmVegN2) *((uTmVegAveN2-cTmOptVegN2)*(uTmVegAveN2-cTmOptVegN2) - (cTmRefN2-cTmOptVegN2)*(cTmRefN2-cTmOptVegN2)));
uFunTmProdVegN2 = IF ( UseExpVegN2 EQ TRUE ) THEN uFunTmVegN2 ELSE POW ( cQ10ProdVegN2 , (0.1 * (uTmVegAveN2 - cTmRefN2))) ENDIF;
uhLVegN2 = hLRefVegN2 * uFunTmProdVegN2;
aLPIVegN2 = IF ( aInclStratN2 EQ TRUE AND  uVegHeightN2 GT uDepthWHypN2 ) THEN cPMaxN2*(aLPAR1VegEpiN2- aLPARVegLightN2 + uhLVegN2*LN((1.0 +aLPARVegLightN2/ uhLVegN2)  /(1.0 +aLPAR1VegEpiN2  / uhLVegN2) + NearZeroN2  ) )ELSEIF  ( aInclStratN2 EQ TRUE AND  uVegHeightN2 LE uDepthWHypN2 ) THEN cPMaxN2*( aLPAR1VegHypN2- aLPARVegLightN2 + uhLVegN2* LN((1.0 +aLPARVegLightN2/ uhLVegN2)  / (1.0 +aLPAR1VegHypN2  / uhLVegN2) ) ) ELSE cPMaxN2 * (aLPAR1VegEpiN2- aLPARVegLightN2 + uhLVegN2*LN((1.0 +aLPARVegLightN2/ uhLVegN2)  /(1.0 +aLPAR1VegEpiN2  / uhLVegN2) + NearZeroN2  ) )ENDIF;
aSpringN2 =  IF ( cLATN2 LT 0 AND DayN2 GE 265 AND DayN2 LE 356 ) THEN 1 ELSEIF ( cLATN2 GT 0 AND DayN2 GE 80 AND DayN2 LE 173) THEN 1 ELSEIF ( cLATN2 EQ 0) THEN 1 ELSE 0 ENDIF;
aTimeWinVegN2 =  IF ( sTimeN2 LT StartTimeN2 + 1.0 ) THEN -999 ELSEIF ( UsePhotVegN2 EQ FALSE  AND  ( uTmBotN2 GE cTmInitVegN2 )  AND aSpringN2 EQ 1 ) THEN sTimeN2  ELSEIF (UsePhotVegN2 EQ TRUE  AND  uSunHoursN2 GE cPhotInitVegN2   AND aSpringN2 EQ 1 ) THEN sTimeN2 ELSEIF (( aLPIVegN2 / uVegHeightLightN2 )LE cLAlloVegN2 ) THEN aTimeWinVegN2 ELSEIF (FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeWinVegN2 + 0.3) GT 1 AND FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeWinVegN2 + 0.3) LT cVegWinLenN2 ) THEN aTimeWinVegN2 ELSE sTimeN2 ENDIF ;
aTimeInitVegN2 =  IF ( sTimeN2 LT StartTimeN2 + 1.0 ) THEN -999 ELSEIF ( FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeWinVegN2 + 0.3) GT 1 ) THEN sTimeN2 ELSEIF ( UsePhotVegN2 EQ FALSE  AND  uTmBotN2 GE cTmInitVegN2 ) THEN aTimeInitVegN2 ELSEIF ( UsePhotVegN2 EQ TRUE  AND    uSunHoursN2 GE cPhotInitVegN2  ) THEN aTimeInitVegN2 ELSEIF (UsePhotVegN2 EQ FALSE  AND  uTmBotN2 LT cTmInitVegN2 AND ( ( aLPIVegN2 / uVegHeightLightN2 ) GE cLAlloVegN2 ) AND FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeInitVegN2 + 0.3) GT 1) THEN aTimeInitVegN2 ELSEIF (UsePhotVegN2 EQ TRUE  AND   uSunHoursN2 LT cPhotInitVegN2 AND ( ( aLPIVegN2 / uVegHeightLightN2 ) GE cLAlloVegN2 ) AND FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeInitVegN2 + 0.3) GT 1) THEN aTimeInitVegN2 ELSEIF (FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeInitVegN2 + 0.3) GT 1 AND FLOOR ( sTimeN2+ 0.3 ) - FLOOR (aTimeInitVegN2 + 0.3) LT cVegInitLenN2 ) THEN aTimeInitVegN2 ELSE sTimeN2 ENDIF ;
aTimeWinVegCorN2 = IF ( UseLWinVegN2 LE NearZeroN2 ) THEN FLOOR (TimeYearsN2 - 1) + cDayWinVegN2  ELSE aTimeWinVegN2 ENDIF;
aDayInitVegN2 = IF (DayN2 LT 1.0 OR sTimeN2 LT StartTimeN2 + 1.0) THEN 367 ELSEIF (uTmBotN2 GE cTmInitVegN2 AND aDayInitVegN2 GT 366) THEN DayN2 ELSE aDayInitVegN2 ENDIF;
aTimeInitVegCorN2 = IF (UsePhotVegN2 LE NearZeroN2 AND UseLWinVegN2 LE NearZeroN2 ) THEN  (TimeYearsN2 - 1)  + aDayInitVegN2  ELSE aTimeInitVegN2 ENDIF;
aVegSumN2 =  IF ( FLOOR ( aTimeInitVegCorN2 + 0.3) LT FLOOR (  sTimeN2 + 0.3 ) AND FLOOR ( aTimeWinVegCorN2 + 0.3 ) EQ FLOOR (  sTimeN2  + 0.3 ) ) THEN 1 ELSE 0 ENDIF;
aVegWinN2 =  1 - aVegSumN2;
aDaysVegSumN2 = ( FLOOR ( sTimeN2+ 0.3) - FLOOR (aTimeInitVegCorN2 + 0.3) ) * aVegSumN2;
aDaysVegWinN2 = ( FLOOR ( sTimeN2 + 0.3) - FLOOR ( aTimeWinVegCorN2  + 0.3 )  ) * aVegWinN2;
bfRootVegN2 = IF (FALSE EQ InclSeasonN2) THEN fRootVegSumN2 ELSEIF (aVegWinN2 EQ TRUE AND aDaysVegWinN2 GT cLengAlloN2) THEN fRootVegWinN2 ELSEIF (aVegSumN2 EQ TRUE AND aDaysVegSumN2 LE cLengAlloN2) THEN 0.5*(fRootVegWinN2 + fRootVegSumN2) + 0.5*(fRootVegWinN2 - fRootVegSumN2) * COS ( PiN2 /cLengAlloN2 * ( sTimeN2 - aTimeInitVegCorN2 )) ELSEIF ( aVegWinN2 EQ TRUE AND aDaysVegWinN2 EQ 0) THEN fRootVegWinN2 ELSEIF ( aVegWinN2 EQ TRUE) THEN 0.5*( fRootVegWinN2 + fRootVegSumN2) - 0.5*( fRootVegWinN2 - fRootVegSumN2) * COS ( PiN2 / cLengAlloN2 * ( sTimeN2 - aTimeWinVegCorN2 )) ELSE fRootVegSumN2 ENDIF;
bfShootVegN2 = 1.0 - bfRootVegN2;
aDShootVegN2 = bfShootVegN2 * aDVegN2;
aDEmergVegN2 = fEmergVegN2 * aDShootVegN2;
aDFloatVegN2 = IF  ( aDepth1VegEpiN2 LT 0.005 ) THEN fFloatVegN2 * aDShootVegN2 ELSE 0 ENDIF;
bfSubVegN2 = 1.0 - fFloatVegN2 - fEmergVegN2;
aDSubVegN2 = bfSubVegN2 * aDShootVegN2;
aExtVegHypN2 = cExtSpVegN2 * aDSubVegN2 / uDepthWHypN2 * (uVegHeightHypN2 /uDepthWN2 );
aExtCoefHypN2 = aExtCoefOpenHypN2 + aExtVegHypN2;
aExtVegEpiN2 = cExtSpVegN2 * aDSubVegN2 / uDepthWEpiN2 * (uVegHeightEpiN2 /uDepthWN2 ) ;
aExtCoefEpiN2 = aExtCoefOpenEpiN2 + aExtVegEpiN2;
aLPARBotEpiN2 = aLPARBotSurfN2 * EXP(- aExtCoefEpiN2 * uDepthWEpiN2);
uLPARSurfHypN2 = IF ( aInclStratN2 EQ TRUE ) THEN aLPARBotEpiN2 ELSE 0.0 ENDIF;
aLPAR2VegEpiN2 = aLPAR1VegEpiN2 * EXP(- aExtCoefEpiN2 * (aDepth2VegEpiN2 - aDepth1VegEpiN2));
aLPAR2VegHypN2 = aLPAR1VegHypN2 * EXP(- aExtCoefHypN2 * (aDepth2VegHypN2 - aDepth1VegHypN2));
uVWindN2 = IF (ReadVWindN2 EQ TRUE)THEN mVWindN2 ELSE cVWindN2 ENDIF;
aStratN2 = IF (ReadStratN2 EQ TRUE) THEN mStratN2 ELSEIF ((uTmEpiN2 -uTmHypN2) GT  cStratTmN2 OR (uTmHypN2 -uTmEpiN2) GT  cStratTmN2) THEN 1.0  ELSE 0.0 ENDIF;
uQInSeasonN2 = IF (FALSE EQ UseSeasonLoadN2) THEN 0.0 ELSEIF (DayN2 LT cDayApril1N2 - 0.5*cLengChangeN2) THEN cQInWinN2 ELSEIF (DayN2 LT cDayApril1N2 + 0.5*cLengChangeN2) THEN 0.5*(cQInWinN2 + cQInSumN2) + 0.5*(cQInWinN2 - cQInSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayApril1N2)) ELSEIF (DayN2 LT cDayOct1N2 - 0.5*cLengChangeN2) THEN cQInSumN2 ELSEIF (DayN2 LT cDayOct1N2 + 0.5*cLengChangeN2) THEN 0.5*(cQInWinN2 + cQInSumN2) - 0.5*(cQInWinN2 - cQInSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayOct1N2)) ELSE cQInWinN2 ENDIF;
uQEvSinusN2 = cQEvAveN2 - cQEvVarN2 * COS(2.0*PiN2 * (sTimeN2 + TenDaysN2 - cTimeLagN2) / DaysInYearN2);
aQEvN2 = IF (10 *uTmEpiN2 /cHeatN2) LE NearZeroN2 THEN 16 * 2*ufDayN2 * 1 / 30 * POW ( NearZeroN2 , (cAlphaN2) ) ELSE 16 * 2*ufDayN2 * 1 / 30 * POW ( 10 *uTmEpiN2 /cHeatN2 , (cAlphaN2) ) ENDIF;
uQEvN2 = IF (FALSE EQ InclSeasonN2) THEN cQEvAveN2 ELSEIF (ReadQEvN2 EQ TRUE) THEN mQEvN2 ELSEIF (calcQEvN2 EQ TRUE ) THEN aQEvN2 ELSE uQEvSinusN2 ENDIF;
uDepthDifMeasN2 = IF ( ReadDepthWN2 EQ TRUE ) THEN mDepthWN2 - uDepthWN2 ELSE 0.0 ENDIF;
uQInCorN2 = IF (uDepthDifMeasN2 GE 0) THEN uDepthDifMeasN2 * cMaxWOutN2 * mmPermN2 ELSE 0.0 ENDIF;
uQOutCorN2 = IF (uDepthDifMeasN2 LT 0) THEN -1 * uDepthDifMeasN2 * cMaxWOutN2 * mmPermN2 ELSE 0.0 ENDIF;
uQInEpiN2 = IF ((ReadQInN2 EQ TRUE) OR (ReadTranFracN2 EQ TRUE)) THEN mQInEpiN2 + uQInCorN2 ELSEIF (UseSeasonLoadN2 EQ TRUE) THEN uQInSeasonN2 + uQInCorN2 ELSE cQInEpiN2 + uQInCorN2 ENDIF;
uQInHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF ((ReadQInN2 EQ TRUE) OR (ReadTranFracN2 EQ TRUE)) THEN mQInHypN2 ELSE 0.0 ENDIF;
aQInTotN2 = uQInEpiN2 + uQInHypN2;
uQPrecN2 = IF (ReadQPrecN2 EQ TRUE) THEN mQPrecN2 ELSE 0 ENDIF;
uQInSeepN2 = IF (ReadQGroundN2 EQ TRUE) THEN mQInSeepN2 ELSE cQInSeepN2 ENDIF;
uQOutInfN2 = IF (ReadQGroundN2 EQ TRUE) THEN mQOutInfN2 ELSE cQOutInfN2 ENDIF;
uQOutPotN2 = uQPrecN2 + uQInEpiN2 - uQInCorN2 + uQInHypN2 + uQInSeepN2 - uQEvN2 - uQOutCorN2 - uQOutInfN2;
aMaxQOutEpiN2 = IF ( uDepthWEpiN2 LE cMinDepthHypEpiN2 ) THEN 0.0 ELSE uDepthWEpiN2 * mmPermN2 * cMaxWOutN2 ENDIF;
aMaxQOutHypN2 = IF (aInclStratN2 EQ TRUE) AND ( uDepthWHypN2 GT cMinDepthHypEpiN2 ) THEN (uDepthWHypN2 - cMinDepthHypEpiN2) * mmPermN2 * cMaxWOutN2 ELSE 0.0 ENDIF;
uQOutEpiN2 = IF (ReadQOutN2 EQ TRUE) THEN MIN(mQOutEpiN2, aMaxQOutEpiN2) ELSE MIN(aMaxQOutEpiN2, MAX(0.0, uQOutPotN2)) ENDIF;
uQOutHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadQOutN2 EQ TRUE) THEN MIN(mQOutHypN2, aMaxQOutHypN2) ELSE MIN(aMaxQOutHypN2, MAX(0.0, (uQOutPotN2 - uQOutEpiN2))) ENDIF;
ukOutEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uQOutEpiN2 / mmPermN2 / uDepthWEpiN2 ENDIF;
ukOutHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uQOutHypN2 / mmPermN2 / uDepthWHypN2 ENDIF;
uTauWatEpiN2 = IF (aInclStratN2 EQ FALSE) THEN 1.0 / ((uQInEpiN2 + uQPrecN2 + uQInSeepN2) / mmPermN2 / uDepthWEpiN2 +NearZeroN2) ELSE 1.0 / (( uQInEpiN2 + uQPrecN2 ) / mmPermN2 / uDepthWEpiN2 +NearZeroN2) ENDIF;
uTauWatHypN2 = IF (aInclStratN2 EQ FALSE )THEN -9999 ELSE 1.0 / ((uQInHypN2 + uQInSeepN2 ) / mmPermN2 / uDepthWHypN2 +NearZeroN2) ENDIF;
uTauWatN2 = 1.0 / ((uQPrecN2 + uQInEpiN2 + uQInHypN2 + uQInSeepN2 ) / mmPermN2 / uDepthWN2 +NearZeroN2);
uTauSubstHypN2 = 1.0 / (ukOutHypN2+NearZeroN2);
uFiJvMortHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiJvMortHypN2 ELSE 0.0 ENDIF;
uFiJvEgesHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiJvEgesHypN2 ELSE 0.0 ENDIF;
uFiJvExcrHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiJvExcrHypN2 ELSE 0.0 ENDIF;
uFiAdMortHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiAdMortHypN2 ELSE 0.0 ENDIF;
uFiAdEgesHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiAdEgesHypN2 ELSE 0.0 ENDIF;
uFiAdExcrHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fFiAdExcrHypN2 ELSE 0.0 ENDIF;
uPiscMortHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fPiscMortHypN2 ELSE 0.0 ENDIF;
uPiscEgesHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fPiscEgesHypN2 ELSE 0.0 ENDIF;
uPiscExcrHypN2 = IF (aInclStratN2 EQ TRUE ) THEN fPiscExcrHypN2 ELSE 0.0 ENDIF;
vTranDepthWN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN (uQInEpiN2 + uQInHypN2 + uQPrecN2 + uQInSeepN2 - uQEvN2 - uQOutInfN2 - uQOutHypN2 - uQOutEpiN2 - uQOutCorN2) / mmPermN2 ELSE ((uQInEpiN2 + uQInHypN2 + uQPrecN2 + uQInSeepN2 - uQEvN2 - uQOutInfN2 - uQOutHypN2 - uQOutEpiN2 - uQOutCorN2) / mmPermN2) / (1.0 + fMarshN2) ENDIF;
vTranHypEpiWN2 = IF (InclStratN2 EQ FALSE) THEN 0.0 ELSEIF ( uDepthWN2 -uDepthMixMeasN2 LT cMinDepthHypEpiN2 ) THEN ( uDepthWN2 - cMinDepthHypEpiN2 -uDepthWEpiN2 ) * kExchWN2 ELSEIF ( uDepthMixMeasN2 LT cMinDepthHypEpiN2 ) THEN ( cMinDepthHypEpiN2 -uDepthWEpiN2 ) * kExchWN2 ELSE ( uDepthMixMeasN2 -uDepthWEpiN2 ) * kExchWN2 ENDIF;
vDeltaWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2 ) THEN (uQInHypN2 + uQInSeepN2 - uQOutInfN2 - uQOutHypN2) / mmPermN2 ELSE (uQInHypN2 + uQInSeepN2 - uQOutInfN2 - uQOutHypN2) / mmPermN2 / (1.0 + fMarshN2 ) ENDIF;
vDeltaWEpiN2 = IF (aInclStratN2 EQ FALSE) AND (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2 ) THEN (uQInEpiN2 + uQPrecN2 + uQInSeepN2 - uQEvN2 - uQOutEpiN2 - uQOutInfN2 - uQOutCorN2) / mmPermN2 ELSEIF (aInclStratN2 EQ TRUE) AND (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2 ) THEN (uQInEpiN2 + uQPrecN2 - uQEvN2 - uQOutEpiN2 - uQOutCorN2) / mmPermN2 ELSEIF (aInclStratN2 EQ FALSE) AND (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2 ) THEN (uQInEpiN2 + uQPrecN2 + uQInSeepN2 - uQEvN2 - uQOutEpiN2 - uQOutInfN2 - uQOutCorN2) / mmPermN2 / (1.0 + fMarshN2 ) ELSE (uQInEpiN2 + uQPrecN2 - uQEvN2 - uQOutEpiN2 - uQOutCorN2) / mmPermN2 / (1.0 + fMarshN2 ) ENDIF;
afVolHypEpiN2= IF (aInclStratN2 EQ TRUE AND uDepthWHypN2 GT NearZeroN2) THEN  uDepthWHypN2 / uDepthWEpiN2 ELSE 0.0 ENDIF;
wDAdvIMWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDIMWHypN2 ELSE vTranHypEpiWN2 * oDIMWEpiN2 ENDIF;
wPAdvPO4WN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPO4WHypN2 ELSE vTranHypEpiWN2 * oPO4WEpiN2 ENDIF;
wPAdvAIMWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPAIMWHypN2 ELSE vTranHypEpiWN2 * oPAIMWEpiN2 ENDIF;
wNAdvNH4WN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNH4WHypN2 ELSE vTranHypEpiWN2 * oNH4WEpiN2 ENDIF;
wNAdvNO3WN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNO3WHypN2 ELSE vTranHypEpiWN2 * oNO3WEpiN2 ENDIF;
wSiAdvSiO2WN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oSiO2WHypN2 ELSE vTranHypEpiWN2 * oSiO2WEpiN2 ENDIF;
wO2AdvWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oO2WHypN2 ELSE vTranHypEpiWN2 * oO2WEpiN2 ENDIF;
wDAdvDetWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDDetWHypN2 ELSE vTranHypEpiWN2 * oDDetWEpiN2 ENDIF;
wPAdvDetWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPDetWHypN2 ELSE vTranHypEpiWN2 * oPDetWEpiN2 ENDIF;
wNAdvDetWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNDetWHypN2 ELSE vTranHypEpiWN2 * oNDetWEpiN2 ENDIF;
wSiAdvDetWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oSiDetWHypN2 ELSE vTranHypEpiWN2 * oSiDetWEpiN2 ENDIF;
wDAdvDiatWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDDiatWHypN2 ELSE vTranHypEpiWN2 * oDDiatWEpiN2 ENDIF;
wPAdvDiatWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPDiatWHypN2 ELSE vTranHypEpiWN2 * oPDiatWEpiN2 ENDIF;
wNAdvDiatWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNDiatWHypN2 ELSE vTranHypEpiWN2 * oNDiatWEpiN2 ENDIF;
wSiAdvDiatWN2 = vTranHypEpiWN2 * cSiDDiatN2;
wDAdvGrenWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDGrenWHypN2 ELSE vTranHypEpiWN2 * oDGrenWEpiN2 ENDIF;
wPAdvGrenWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPGrenWHypN2 ELSE vTranHypEpiWN2 * oPGrenWEpiN2 ENDIF;
wNAdvGrenWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNGrenWHypN2 ELSE vTranHypEpiWN2 * oNGrenWEpiN2 ENDIF;
wDAdvBlueWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDBlueWHypN2 ELSE vTranHypEpiWN2 * oDBlueWEpiN2 ENDIF;
wPAdvBlueWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPBlueWHypN2 ELSE vTranHypEpiWN2 * oPBlueWEpiN2 ENDIF;
wNAdvBlueWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNBlueWHypN2 ELSE vTranHypEpiWN2 * oNBlueWEpiN2 ENDIF;
wDAdvZooWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oDZooHypN2 ELSE vTranHypEpiWN2 * oDZooEpiN2 ENDIF;
wPAdvZooWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oPZooHypN2 ELSE vTranHypEpiWN2 * oPZooEpiN2 ENDIF;
wNAdvZooWN2 = IF ( vTranHypEpiWN2 GT 0.0) THEN vTranHypEpiWN2 * oNZooHypN2 ELSE vTranHypEpiWN2 * oNZooEpiN2 ENDIF;
wDAdvIMWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDIMWEpiN2 ELSE vTranDepthWN2 *  oDIMWMN2 ENDIF;
wPAdvPO4WMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPO4WEpiN2 ELSE vTranDepthWN2 *  oPO4WMN2 ENDIF;
wPAdvAIMWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPAIMWEpiN2 ELSE vTranDepthWN2 *  oPAIMWMN2 ENDIF;
wNAdvNH4WMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNH4WEpiN2 ELSE vTranDepthWN2 *  oNH4WMN2 ENDIF;
wNAdvNO3WMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNO3WEpiN2 ELSE vTranDepthWN2 *  oNO3WMN2 ENDIF;
wSiAdvSiO2WMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oSiO2WEpiN2 ELSE vTranDepthWN2 *  oSiO2WMN2 ENDIF;
wO2AdvWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oO2WEpiN2 ELSE vTranDepthWN2 *  oO2WMN2 ENDIF;
wDAdvDetWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDDetWEpiN2 ELSE vTranDepthWN2 *  oDDetWMN2 ENDIF;
wPAdvDetWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPDetWEpiN2 ELSE vTranDepthWN2 *  oPDetWMN2 ENDIF;
wNAdvDetWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNDetWEpiN2 ELSE vTranDepthWN2 *  oNDetWMN2 ENDIF;
wSiAdvDetWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oSiDetWEpiN2 ELSE vTranDepthWN2 *  oSiDetWMN2 ENDIF;
wDAdvDiatWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDDiatWEpiN2 ELSE vTranDepthWN2 *  oDDiatWMN2 ENDIF;
wPAdvDiatWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPDiatWEpiN2 ELSE vTranDepthWN2 *  oPDiatWMN2 ENDIF;
wNAdvDiatWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNDiatWEpiN2 ELSE vTranDepthWN2 *  oNDiatWMN2 ENDIF;
wDAdvGrenWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDGrenWEpiN2 ELSE vTranDepthWN2 *  oDGrenWMN2 ENDIF;
wPAdvGrenWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPGrenWEpiN2 ELSE vTranDepthWN2 *  oPGrenWMN2 ENDIF;
wNAdvGrenWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNGrenWEpiN2 ELSE vTranDepthWN2 *  oNGrenWMN2 ENDIF;
wDAdvBlueWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDBlueWEpiN2 ELSE vTranDepthWN2 *  oDBlueWMN2 ENDIF;
wPAdvBlueWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPBlueWEpiN2 ELSE vTranDepthWN2 *  oPBlueWMN2 ENDIF;
wNAdvBlueWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNBlueWEpiN2 ELSE vTranDepthWN2 *  oNBlueWMN2 ENDIF;
wDAdvZooWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oDZooEpiN2 ELSE vTranDepthWN2 *  oDZooMN2 ENDIF;
wPAdvZooWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oPZooEpiN2 ELSE vTranDepthWN2 *  oPZooMN2 ENDIF;
wNAdvZooWMN2= IF (InclMarshN2 EQ FALSE OR fMarshN2 LT NearZeroN2) THEN 0.0 ELSEIF ( vTranDepthWN2 GT 0.0) THEN vTranDepthWN2 * oNZooEpiN2 ELSE vTranDepthWN2 *  oNZooMN2 ENDIF;
uExchMaxWN2 =   IF ( aInclStratN2 EQ TRUE) THEN kExchMaxWN2 /( aStratN2* fMetaN2 * uDepthWN2 + cDepthMetaMinN2 ) ELSE 0.0 ENDIF;
akExchWHypN2= IF (aInclStratN2 EQ TRUE AND uDepthWHypN2 GT NearZeroN2) THEN  ( uExchMaxWN2 ) / uDepthWHypN2 ELSE 0.0 ENDIF;
akExchWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 * afVolHypEpiN2 ELSE 0.0 ENDIF;
wDExchIMWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDIMWHypN2 - oDIMWEpiN2) ELSE 0.0 ENDIF;
wPExchPO4WHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPO4WHypN2 - oPO4WEpiN2) ELSE 0.0 ENDIF;
wPExchAIMWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPAIMWHypN2 - oPAIMWEpiN2) ELSE 0.0 ENDIF;
wNExchNH4WHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNH4WHypN2 - oNH4WEpiN2) ELSE 0.0 ENDIF;
wNExchNO3WHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNO3WHypN2 - oNO3WEpiN2) ELSE 0.0 ENDIF;
wSiExchSiO2WHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oSiO2WHypN2 - oSiO2WEpiN2) ELSE 0.0 ENDIF;
wO2ExchWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oO2WHypN2 - oO2WEpiN2) ELSE 0.0 ENDIF;
wDExchDetWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDDetWHypN2 - oDDetWEpiN2) ELSE 0.0 ENDIF;
wPExchDetWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPDetWHypN2 - oPDetWEpiN2) ELSE 0.0 ENDIF;
wNExchDetWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNDetWHypN2 - oNDetWEpiN2) ELSE 0.0 ENDIF;
wSiExchDetWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oSiDetWHypN2 - oSiDetWEpiN2) ELSE 0.0 ENDIF;
wDExchDiatWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDDiatWHypN2 - oDDiatWEpiN2) ELSE 0.0 ENDIF;
wPExchDiatWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPDiatWHypN2 - oPDiatWEpiN2) ELSE 0.0 ENDIF;
wNExchDiatWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNDiatWHypN2 - oNDiatWEpiN2) ELSE 0.0 ENDIF;
wSiExchDiatWHypN2= IF (aInclStratN2 EQ TRUE ) THEN cSiDDiatN2 * wDExchDiatWHypN2 ELSE 0.0 ENDIF;
wDExchGrenWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDGrenWHypN2 - oDGrenWEpiN2) ELSE 0.0 ENDIF;
wPExchGrenWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPGrenWHypN2 - oPGrenWEpiN2) ELSE 0.0 ENDIF;
wNExchGrenWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNGrenWHypN2 - oNGrenWEpiN2) ELSE 0.0 ENDIF;
wDExchBlueWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDBlueWHypN2 - oDBlueWEpiN2) ELSE 0.0 ENDIF;
wPExchBlueWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPBlueWHypN2 - oPBlueWEpiN2) ELSE 0.0 ENDIF;
wNExchBlueWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNBlueWHypN2 - oNBlueWEpiN2) ELSE 0.0 ENDIF;
wDExchZooWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oDZooHypN2 - oDZooEpiN2) ELSE 0.0 ENDIF;
wPExchZooWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oPZooHypN2 - oPZooEpiN2) ELSE 0.0 ENDIF;
wNExchZooWHypN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWHypN2 *(oNZooHypN2 - oNZooEpiN2) ELSE 0.0 ENDIF;
wDExchIMWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDIMWHypN2 - oDIMWEpiN2) ELSE 0.0 ENDIF;
wPExchPO4WEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPO4WHypN2 - oPO4WEpiN2) ELSE 0.0 ENDIF;
wPExchAIMWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPAIMWHypN2 - oPAIMWEpiN2) ELSE 0.0 ENDIF;
wNExchNH4WEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNH4WHypN2 - oNH4WEpiN2) ELSE 0.0 ENDIF;
wNExchNO3WEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNO3WHypN2 - oNO3WEpiN2) ELSE 0.0 ENDIF;
wSiExchSiO2WEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oSiO2WHypN2 - oSiO2WEpiN2) ELSE 0.0 ENDIF;
wO2ExchWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oO2WHypN2 - oO2WEpiN2) ELSE 0.0 ENDIF;
wDExchDetWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDDetWHypN2 - oDDetWEpiN2) ELSE 0.0 ENDIF;
wPExchDetWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPDetWHypN2 - oPDetWEpiN2) ELSE 0.0 ENDIF;
wNExchDetWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNDetWHypN2 - oNDetWEpiN2) ELSE 0.0 ENDIF;
wSiExchDetWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oSiDetWHypN2 - oSiDetWEpiN2) ELSE 0.0 ENDIF;
wDExchDiatWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDDiatWHypN2 - oDDiatWEpiN2) ELSE 0.0 ENDIF;
wPExchDiatWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPDiatWHypN2 - oPDiatWEpiN2) ELSE 0.0 ENDIF;
wNExchDiatWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNDiatWHypN2 - oNDiatWEpiN2) ELSE 0.0 ENDIF;
wSiExchDiatWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN cSiDDiatN2 * wDExchDiatWEpiN2 ELSE 0.0 ENDIF;
wDExchGrenWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDGrenWHypN2 - oDGrenWEpiN2) ELSE 0.0 ENDIF;
wPExchGrenWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPGrenWHypN2 - oPGrenWEpiN2) ELSE 0.0 ENDIF;
wNExchGrenWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNGrenWHypN2 - oNGrenWEpiN2) ELSE 0.0 ENDIF;
wDExchBlueWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDBlueWHypN2 - oDBlueWEpiN2) ELSE 0.0 ENDIF;
wPExchBlueWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPBlueWHypN2 - oPBlueWEpiN2) ELSE 0.0 ENDIF;
wNExchBlueWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNBlueWHypN2 - oNBlueWEpiN2) ELSE 0.0 ENDIF;
wDExchZooWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oDZooHypN2 - oDZooEpiN2) ELSE 0.0 ENDIF;
wPExchZooWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oPZooHypN2 - oPZooEpiN2) ELSE 0.0 ENDIF;
wNExchZooWEpiN2= IF (aInclStratN2 EQ TRUE ) THEN akExchWEpiN2 *(oNZooHypN2 - oNZooEpiN2) ELSE 0.0 ENDIF;
akExchMHypN2 = 0.0;
akExchLHypN2 = 0.0;
oDPhytWHypN2 = oDDiatWHypN2 + oDGrenWHypN2 + oDBlueWHypN2;
oPPhytWHypN2 = oPDiatWHypN2 + oPGrenWHypN2 + oPBlueWHypN2;
oNPhytWHypN2 = oNDiatWHypN2 + oNGrenWHypN2 + oNBlueWHypN2;
aDPhytSN2 = aDDiatSN2 + aDGrenSN2 + aDBlueSN2 ;
aPPhytSN2 = aPDiatSN2 + aPGrenSN2 + aPBlueSN2 ;
aNPhytSN2 = aNDiatSN2 + aNGrenSN2 + aNBlueSN2;
oDPhytWEpiN2 = oDDiatWEpiN2 + oDGrenWEpiN2 + oDBlueWEpiN2;
oDOMWEpiN2 = oDDetWEpiN2 + oDPhytWEpiN2;
oDOMWHypN2 = oDDetWHypN2 + oDPhytWHypN2;
oTDOMWN2 = oDOMWEpiN2 + oDOMWHypN2;
oDSestWHypN2 = oDOMWHypN2 + oDIMWHypN2;
oPOMWHypN2 = oPPhytWHypN2 + oPDetWHypN2;
oPSestWHypN2 = oPPhytWHypN2 + oPDetWHypN2 + oPAIMWHypN2;
oPInorgWHypN2 = oPO4WHypN2 + oPAIMWHypN2;
oPTotWHypN2 = oPSestWHypN2 + oPO4WHypN2;
oNDissWEpiN2 = oNO3WEpiN2 + oNH4WEpiN2;
oNDissWHypN2 = oNO3WHypN2 + oNH4WHypN2;
oNOMWHypN2 = oNPhytWHypN2 + oNDetWHypN2;
oNSestWHypN2 = oNOMWHypN2;
oNkjWHypN2 = oNSestWHypN2 + oNH4WHypN2;
oNTotWHypN2 = oNkjWHypN2 + oNO3WHypN2;
bPorSN2 = (1.0 - fDTotS0N2) * (fDOrgS0N2 * cRhoOMN2 + (1 - fDOrgS0N2) * cRhoIMN2) / cRhoWatN2 / ( fDTotS0N2 + (1.0 - fDTotS0N2) * (fDOrgS0N2 * cRhoOMN2 + (1 - fDOrgS0N2) * cRhoIMN2) / cRhoWatN2 );
bPorCorSN2 = IF POW(bPorSN2 , (bPorSN2 + 1.0)) LE NearZeroN2 THEN 1 ELSE POW(bPorSN2 , (bPorSN2 + 1.0)) ENDIF;
aDTotSN2 = aDIMSN2 + aDHumSN2 + aDDetSN2;
aRhoTotSN2 = aDTotSN2 / cDepthSN2;
aRhoSolidSN2 = (aDIMSN2 * cRhoIMN2 + (aDHumSN2 + aDDetSN2) * cRhoOMN2) / aDTotSN2;
afDTotSN2 = 1.0 / (1.0 + bPorSN2/(1.0-bPorSN2) * cRhoWatN2 / aRhoSolidSN2);
afDOrgSN2 = (aDHumSN2 + aDDetSN2) / aDTotSN2;
afDetSN2 = aDDetSN2 / (aDHumSN2 + aDDetSN2);
afDetTotSN2 = aDDetSN2 / (aDIMSN2 + aDHumSN2 + aDDetSN2);
aPInorgSN2 = aPO4SN2 + aPAIMSN2;
aPTotAvailSN2 = aPDetSN2 + aPInorgSN2 + aPPhytSN2;
aPTotSN2 = aPTotAvailSN2 + aPHumSN2;
afPInorgSN2 = aPInorgSN2 / aDTotSN2;
afPTotSN2 = aPTotSN2 / aDTotSN2;
afPO4SN2 = aPO4SN2 / (aPTotAvailSN2 + NearZeroN2);
oPO4SN2 = aPO4SN2 / cDepthSN2 / bPorSN2;
aNDissSN2 = aNH4SN2 + aNO3SN2;
aNkjAvailSN2 = aNDetSN2 + aNPhytSN2 + aNH4SN2;
aNkjSN2 = aNkjAvailSN2 + aNHumSN2;
aNTotAvailSN2 = aNkjAvailSN2 + aNO3SN2;
aNTotSN2 = aNkjSN2 + aNO3SN2;
afNInorgSN2 = aNDissSN2 / aDTotSN2;
afNTotSN2 = aNTotSN2 / aDTotSN2;
oNO3SN2 = aNO3SN2 / cDepthSN2 / bPorSN2;
oNH4SN2 = aNH4SN2 / cDepthSN2 / bPorSN2;
oNDissSN2 = aNDissSN2 / cDepthSN2 / bPorSN2;
rPDIMWHypN2 = oPAIMWHypN2 / oDIMWHypN2;
rPDIMSN2 = aPAIMSN2 / aDIMSN2;
rPDDetWHypN2 = oPDetWHypN2 / (oDDetWHypN2+NearZeroN2);
rNDDetWHypN2 = oNDetWHypN2 / (oDDetWHypN2+NearZeroN2);
rSiDDetWHypN2 = oSiDetWHypN2 / (oDDetWHypN2+NearZeroN2);
rPDHumSN2 = aPHumSN2 / (aDHumSN2+NearZeroN2);
rNDHumSN2 = aNHumSN2 / (aDHumSN2+NearZeroN2);
rPDDetSN2 = aPDetSN2 / (aDDetSN2+NearZeroN2);
rNDDetSN2 = aNDetSN2 / (aDDetSN2+NearZeroN2);
rSiDDetSN2 = aSiDetSN2 / (aDDetSN2+NearZeroN2);
oDPhytWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oDDiatWMN2 + oDGrenWMN2 + oDBlueWMN2 ELSE 0.0 ENDIF;
oPPhytWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPDiatWMN2 + oPGrenWMN2 + oPBlueWMN2 ELSE 0.0 ENDIF;
oNPhytWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNDiatWMN2 + oNGrenWMN2 + oNBlueWMN2 ELSE 0.0 ENDIF;
oSiDiatWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cSiDDiatN2 * oDDiatWMN2 ELSE 0.0 ENDIF;
oDOMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oDDetWMN2 + oDPhytWMN2 ELSE 0.0 ENDIF;
oDSestWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oDOMWMN2 + oDIMWMN2 ELSE 0.0 ENDIF;
oPOMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPPhytWMN2 + oPDetWMN2 ELSE 0.0 ENDIF;
oPSestWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPPhytWMN2 + oPDetWMN2 + oPAIMWMN2 ELSE 0.0 ENDIF;
oPInorgWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPO4WMN2 + oPAIMWMN2 ELSE 0.0 ENDIF;
oPTotWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPSestWMN2 + oPO4WMN2 ELSE 0.0 ENDIF;
oNDissWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNO3WMN2 + oNH4WMN2 ELSE 0.0 ENDIF;
oNOMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNPhytWMN2 + oNDetWMN2 ELSE 0.0 ENDIF;
oNSestWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNOMWMN2 ELSE 0.0 ENDIF;
oNkjWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNSestWMN2 + oNH4WMN2 ELSE 0.0 ENDIF;
oNTotWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNkjWMN2 + oNO3WMN2 ELSE 0.0 ENDIF;
bPorSMN2 = (1.0 - fDTotSM0N2) * (fDOrgSM0N2 * cRhoOMN2 +(1 - fDOrgSM0N2) * cRhoIMN2) / cRhoWatN2 /(fDTotSM0N2 + (1.0 - fDTotSM0N2) * (fDOrgSM0N2 * cRhoOMN2 +(1 - fDOrgSM0N2) * cRhoIMN2) / cRhoWatN2);
bPorCorSMN2 = IF POW ( bPorSMN2 , (bPorSMN2 + 1.0)) LE NearZeroN2 THEN 1 ELSE POW ( bPorSMN2 , (bPorSMN2 + 1.0)) ENDIF;
aDTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDIMSMN2 + aDHumSMN2 + aDDetSMN2 ELSE 0.0 ENDIF;
aRhoTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDTotSMN2 / cDepthSMN2 ELSE 0.0 ENDIF;
aRhoSolidSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (aDIMSMN2 * cRhoIMN2 +(aDHumSMN2 + aDDetSMN2) * cRhoOMN2) / aDTotSMN2 ELSE 0.0 ENDIF;
afDTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN 1.0 /(1.0 + bPorSMN2/(1.0-bPorSMN2) * cRhoWatN2 / aRhoSolidSMN2) ELSE 0.0 ENDIF;
afDOrgSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (aDHumSMN2 + aDDetSMN2) / aDTotSMN2 ELSE 0.0 ENDIF;
afDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDDetSMN2 /(aDHumSMN2 + aDDetSMN2) ELSE 0.0 ENDIF;
afDetTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDDetSMN2 /(aDIMSMN2 + aDHumSMN2 + aDDetSMN2) ELSE 0.0 ENDIF;
aPInorgSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPO4SMN2 + aPAIMSMN2 ELSE 0.0 ENDIF;
aPTotAvailSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPDetSMN2 + aPInorgSMN2 ELSE 0.0 ENDIF;
aPTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPTotAvailSMN2 + aPHumSMN2 ELSE 0.0 ENDIF;
afPInorgSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPInorgSMN2 / aDTotSMN2 ELSE 0.0 ENDIF;
afPTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPTotSMN2 / aDTotSMN2 ELSE 0.0 ENDIF;
afPO4SMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPO4SMN2 /(aPTotAvailSMN2 + NearZeroN2) ELSE 0.0 ENDIF;
oPO4SMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPO4SMN2 / cDepthSMN2 / bPorSMN2 ELSE 0.0 ENDIF;
aNDissSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNH4SMN2 + aNO3SMN2 ELSE 0.0 ENDIF;
aNkjAvailSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNDetSMN2 + aNH4SMN2 ELSE 0.0 ENDIF;
aNkjSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNkjAvailSMN2 + aNHumSMN2 ELSE 0.0 ENDIF;
aNTotAvailSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNkjAvailSMN2 + aNO3SMN2 ELSE 0.0 ENDIF;
aNTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNkjSMN2 + aNO3SMN2 ELSE 0.0 ENDIF;
afNInorgSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNDissSMN2 / aDTotSMN2 ELSE 0.0 ENDIF;
afNTotSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNTotSMN2 / aDTotSMN2 ELSE 0.0 ENDIF;
oNO3SMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNO3SMN2 / cDepthSMN2 / bPorSMN2 ELSE 0.0 ENDIF;
oNH4SMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNH4SMN2 / cDepthSMN2 / bPorSMN2 ELSE 0.0 ENDIF;
oNDissSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNDissSMN2 / cDepthSMN2 / bPorSMN2 ELSE 0.0 ENDIF;
rPDIMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPAIMWMN2 / oDIMWMN2 ELSE 0.0 ENDIF;
rPDIMSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPAIMSMN2 / aDIMSMN2 ELSE 0.0 ENDIF;
rPDDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oPDetWMN2 /(oDDetWMN2+NearZeroN2) ELSE 0.0 ENDIF;
rNDDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNDetWMN2 /(oDDetWMN2+NearZeroN2) ELSE 0.0 ENDIF;
rSiDDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oSiDetWMN2 /(oDDetWMN2+NearZeroN2) ELSE 0.0 ENDIF;
rPDHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPHumSMN2 /(aDHumSMN2+NearZeroN2) ELSE 0.0 ENDIF;
rNDHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNHumSMN2 /(aDHumSMN2+NearZeroN2) ELSE 0.0 ENDIF;
rPDDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPDetSMN2 /(aDDetSMN2+NearZeroN2) ELSE 0.0 ENDIF;
rNDDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNDetSMN2 /(aDDetSMN2+NearZeroN2) ELSE 0.0 ENDIF;
rSiDDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aSiDetSMN2 /(aDDetSMN2+NearZeroN2) ELSE 0.0 ENDIF;
aDTotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ((oDIMWMN2 + oDDetWMN2 + oDPhytWMN2 + oDZooMN2) * uDepthWMN2 + aDIMSMN2 + aDHumSMN2 + aDDetSMN2 + aDShootPhraN2 + aDRootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
aPTotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ((oPO4WMN2 + oPDetWMN2 + oPAIMWMN2 + oPPhytWMN2 + oPZooMN2) * uDepthWMN2 + aPO4SMN2 + aPHumSMN2 + aPDetSMN2 + aPAIMSMN2 + aPShootPhraN2 + aPRootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
aNTotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ((oNH4WMN2 + oNO3WMN2 + oNDetWMN2 + oNPhytWMN2 + oNZooMN2) * uDepthWMN2 + aNH4SMN2 + aNO3SMN2 + aNHumSMN2 + aNDetSMN2 + aNShootPhraN2 + aNRootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
aSiTotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ((oSiO2WMN2 + oSiDetWMN2 + oSiDiatWMN2) * uDepthWMN2 + aSiDetSMN2) * fMarshN2 ELSE 0.0 ENDIF;
aO2TotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ((oO2WMN2) * uDepthWMN2 ) * fMarshN2 ELSE 0.0 ENDIF;
uPLoadSeasonEpiN2 = IF (FALSE EQ UseSeasonLoadN2) THEN 0.0 ELSEIF (DayN2 LT cDayApril1N2 - 0.5*cLengChangeN2) THEN cPLoadWinN2 ELSEIF (DayN2 LT cDayApril1N2 + 0.5*cLengChangeN2) THEN 0.5*(cPLoadWinN2 + cPLoadSumN2) + 0.5*(cPLoadWinN2 - cPLoadSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayApril1N2)) ELSEIF (DayN2 LT cDayOct1N2 - 0.5*cLengChangeN2) THEN cPLoadSumN2 ELSEIF (DayN2 LT cDayOct1N2 + 0.5*cLengChangeN2) THEN 0.5*(cPLoadWinN2 + cPLoadSumN2) - 0.5*(cPLoadWinN2 - cPLoadSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayOct1N2)) ELSE cPLoadWinN2 ENDIF;
uPLoadEpiN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mPLoadPO4EpiN2 + mPLoadAIMEpiN2 + mPLoadDiatEpiN2 + mPLoadGrenEpiN2 + mPLoadBlueEpiN2 + mPLoadDetEpiN2) ELSEIF (ReadPLoadN2 EQ TRUE AND ReadNutFracN2 EQ TRUE) THEN mPLoadPO4EpiN2 + mPLoadOrgEpiN2 ELSEIF (ReadPLoadN2 EQ TRUE AND FALSE EQ ReadNutFracN2) THEN mPLoadEpiN2 * mPLoadEpiMultN2 ELSEIF (UsePulseLoadN2 EQ TRUE) THEN 0.0 ELSEIF (UseSeasonLoadN2 EQ TRUE) THEN uPLoadSeasonEpiN2 ELSE cPLoadN2 ENDIF;
uPLoadPO4EpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadPO4EpiN2 ELSEIF (ReadPLoadN2 EQ FALSE) THEN fPO4InN2 * uPLoadEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN mPLoadPO4EpiN2 ELSE fPO4InN2 * uPLoadEpiN2 ENDIF;
uPLoadOrgEpiN2 = IF (FALSE EQ ReadPLoadN2) THEN (1.0 - fPO4InN2) * uPLoadEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN mPLoadOrgEpiN2 ELSE (1.0 - fPO4InN2) * uPLoadEpiN2 ENDIF;
uPLoadPhytTotEpiN2 = IF (FALSE EQ InclSeasonN2) THEN (((fPhytInSumN2 + fPhytInWinN2)/2)*uPLoadOrgEpiN2) ELSEIF (ReadPLoadPhytN2 EQ TRUE) THEN mPLoadPhytTotEpiN2 ELSE ((fPhytInSumN2+fPhytInWinN2)/2.0 - (fPhytInSumN2-fPhytInWinN2)/2.0 * COS(2.0*PiN2 * (sTimeN2 + TenDaysN2 - cTimeLagN2) / DaysInYearN2)) * uPLoadOrgEpiN2 ENDIF;
uPLoadDetEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadDetEpiN2 ELSE uPLoadOrgEpiN2 - uPLoadPhytTotEpiN2 ENDIF;
uPLoadAIMEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadAIMEpiN2 ELSE 0.0 ENDIF;
uPBackLoadHypN2 = IF (FALSE EQ aInclStratN2) THEN 0.0 ELSE cPBackLoadN2 ENDIF;
uPTotInEpiN2 = uPLoadEpiN2 / (uQInEpiN2 / mmPermN2 + NearZeroN2);
uNLoadSeasonEpiN2 = IF (FALSE EQ UseSeasonLoadN2) THEN 0.0 ELSEIF (DayN2 LT cDayApril1N2 - 0.5*cLengChangeN2) THEN cNLoadWinN2 ELSEIF (DayN2 LT cDayApril1N2 + 0.5*cLengChangeN2) THEN 0.5*(cNLoadWinN2 + cNLoadSumN2) + 0.5*(cNLoadWinN2 - cNLoadSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayApril1N2)) ELSEIF (DayN2 LT cDayOct1N2 - 0.5*cLengChangeN2) THEN cNLoadSumN2 ELSEIF (DayN2 LT cDayOct1N2 + 0.5*cLengChangeN2) THEN 0.5*(cNLoadWinN2 + cNLoadSumN2) - 0.5*(cNLoadWinN2 - cNLoadSumN2) * COS(PiN2/cLengChangeN2 * (DayN2 - cDayOct1N2)) ELSE cNLoadWinN2 ENDIF;
uNLoadPhytTotEpiN2 = IF (ReadNutFracN2 EQ FALSE) THEN (cNPPhytInN2 * uPLoadPhytTotEpiN2) ELSE  mNLoadPhytTotEpiN2 ENDIF ;
uNLoadEpiN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mNLoadNH4EpiN2 + mNLoadNO3EpiN2 + mNLoadGrenEpiN2 + mNLoadDiatEpiN2 + mNLoadBlueEpiN2 + mNLoadDetEpiN2) ELSEIF (ReadNLoadN2 EQ TRUE AND ReadNutFracN2 EQ TRUE) THEN mNLoadNH4EpiN2 + mNLoadNO3EpiN2 + mNLoadOrgEpiN2 ELSEIF (ReadNLoadN2 EQ TRUE AND ReadNutFracN2 EQ FALSE) THEN mNLoadEpiN2 ELSEIF (UsePulseLoadN2 EQ TRUE) THEN 0.0 ELSEIF (ReadPLoadN2 EQ TRUE) THEN cNPLoadMeasN2 * uPLoadEpiN2 ELSEIF (UseSeasonLoadN2 EQ TRUE) THEN uNLoadSeasonEpiN2 ELSE cNLoadN2 ENDIF;
uNLoadDetEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadDetEpiN2 ELSEIF (ReadNLoadN2 EQ FALSE ) THEN MIN(cNPDetInN2 * uPLoadDetEpiN2, uNLoadEpiN2 - uNLoadPhytTotEpiN2) ELSEIF (ReadNutFracN2 EQ TRUE) THEN mNLoadOrgEpiN2 - mNLoadPhytTotEpiN2 ELSE MIN(cNPDetInN2 * uPLoadDetEpiN2, uNLoadEpiN2 - uNLoadPhytTotEpiN2) ENDIF;
uNLoadOrgEpiN2 = IF (FALSE EQ ReadNLoadN2) THEN uNLoadPhytTotEpiN2 + uNLoadDetEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN mNLoadOrgEpiN2 ELSE uNLoadPhytTotEpiN2 + uNLoadDetEpiN2 ENDIF;
uNLoadDissEpiN2 = IF (FALSE EQ ReadNLoadN2) THEN uNLoadEpiN2 - uNLoadOrgEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN 0.0 ELSE uNLoadEpiN2 - uNLoadOrgEpiN2 ENDIF;
uNLoadNH4EpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadNH4EpiN2 ELSEIF (ReadNLoadN2 EQ FALSE) THEN fNH4DissInN2 * uNLoadDissEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN mNLoadNH4EpiN2 ELSE fNH4DissInN2 * uNLoadDissEpiN2 ENDIF;
uNLoadNO3EpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadNO3EpiN2 ELSEIF (ReadNLoadN2 EQ FALSE) THEN (1.0 - fNH4DissInN2) * uNLoadDissEpiN2 ELSEIF (ReadNutFracN2 EQ TRUE) THEN mNLoadNO3EpiN2 ELSE (1.0 - fNH4DissInN2) * uNLoadDissEpiN2 ENDIF;
uNBackLoadHypN2 = IF (FALSE EQ aInclStratN2) THEN 0.0 ELSE cNBackLoadN2 ENDIF;
uNTotInEpiN2 = uNLoadEpiN2 / (uQInEpiN2 / mmPermN2 + NearZeroN2);
uDLoadDetEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mDLoadDetEpiN2 ELSEIF (ReadDLoadDetN2 EQ TRUE) THEN mDLoadDetEpiN2 ELSE uNLoadDetEpiN2 / cNDDetInN2 ENDIF;
uDLoadPhytTotEpiN2 = uNLoadPhytTotEpiN2 / cNDPhytInN2;
uDLoadIMEpiN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadIMEpiN2 ELSEIF (ReadDLoadIMN2 EQ TRUE) THEN mDLoadIMEpiN2 ELSE cDIMInN2 * uQInEpiN2 / mmPermN2 ENDIF;
uDLoadEpiN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mDLoadIMEpiN2 + mDLoadDetEpiN2 + mDLoadDiatEpiN2 + mDLoadGrenEpiN2 + mDLoadBlueEpiN2) ELSE uDLoadIMEpiN2 + uDLoadDetEpiN2 + uDLoadPhytTotEpiN2 ENDIF;
uDLoadDiatEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mDLoadDiatEpiN2 ELSE fDiatPhytInN2 * uDLoadPhytTotEpiN2 ENDIF;
uPLoadDiatEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadDiatEpiN2 ELSE fDiatPhytInN2 * uPLoadPhytTotEpiN2 ENDIF;
uNLoadDiatEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadDiatEpiN2 ELSE fDiatPhytInN2 * uNLoadPhytTotEpiN2 ENDIF;
uDLoadGrenEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mDLoadGrenEpiN2 ELSE fGrenPhytInN2 * uDLoadPhytTotEpiN2 ENDIF;
uPLoadGrenEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadGrenEpiN2 ELSE fGrenPhytInN2 * uPLoadPhytTotEpiN2 ENDIF;
uNLoadGrenEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadGrenEpiN2 ELSE fGrenPhytInN2 * uNLoadPhytTotEpiN2 ENDIF;
uDLoadBlueEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mDLoadBlueEpiN2 ELSE fBluePhytInN2 * uDLoadPhytTotEpiN2 ENDIF;
uPLoadBlueEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadBlueEpiN2 ELSE fBluePhytInN2 * uPLoadPhytTotEpiN2 ENDIF;
uNLoadBlueEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadBlueEpiN2 ELSE fBluePhytInN2 * uNLoadPhytTotEpiN2 ENDIF;
uDLoadZooEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mDLoadZooEpiN2 ELSE cDZooInN2 * uQInEpiN2 / mmPermN2 ENDIF;
uPLoadZooEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mPLoadZooEpiN2 ELSE cDZooInN2 * cPDZooRefN2 * uQInEpiN2 / mmPermN2 ENDIF;
uNLoadZooEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mNLoadZooEpiN2 ELSE cDZooInN2 * cNDZooRefN2 * uQInEpiN2 / mmPermN2 ENDIF;
uSiLoadSiO2EpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mSiLoadSiO2EpiN2 ELSE cSiO2InN2 * uQInEpiN2 / mmPermN2 ENDIF;
uSiLoadDetEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mSiLoadDetEpiN2 ELSE cSiDDetInN2 * uDLoadDetEpiN2 ENDIF;
uSiLoadDiatEpiN2 = cSiDDiatN2 * uDLoadDiatEpiN2;
uSiLoadEpiN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2EpiN2 + uSiLoadDetEpiN2 + uSiLoadDiatEpiN2 ENDIF;
uDLoadBlueSurfN2= IF (ReadTranFracN2 EQ TRUE) THEN mDLoadBlueSurfN2 ELSE 0.0 ENDIF;
uPLoadBlueSurfN2= IF (ReadTranFracN2 EQ TRUE) THEN mPLoadBlueSurfN2 ELSE 0.0 ENDIF;
uNLoadBlueSurfN2= IF (ReadTranFracN2 EQ TRUE) THEN mNLoadBlueSurfN2 ELSE 0.0 ENDIF;
uNLoadNH4HypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadNH4HypN2 ELSE 0 ENDIF;
uNLoadNO3HypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadNO3HypN2 ELSE 0 ENDIF;
uPLoadPO4HypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadPO4HypN2 ELSE 0 ENDIF;
uPLoadAIMHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadAIMHypN2 ELSE 0 ENDIF;
uSiLoadSiO2HypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mSiLoadSiO2HypN2 ELSE 0 ENDIF;
uO2LoadHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mO2LoadHypN2 ELSE cO2InN2 * uQInHypN2 / mmPermN2 ENDIF;
uDLoadDetHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadDetHypN2 ELSE 0 ENDIF;
uNLoadDetHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadDetHypN2 ELSE 0 ENDIF;
uPLoadDetHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadDetHypN2 ELSE 0 ENDIF;
uSiLoadDetHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mSiLoadDetHypN2 ELSE 0 ENDIF;
uDLoadIMHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadIMHypN2 ELSE 0 ENDIF;
uDLoadDiatHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadDiatHypN2 ELSE 0 ENDIF;
uNLoadDiatHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadDiatHypN2 ELSE 0 ENDIF;
uPLoadDiatHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadDiatHypN2 ELSE 0 ENDIF;
uSiLoadDiatHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN cSiDDiatN2 * uDLoadDiatHypN2 ELSE 0 ENDIF;
uDLoadGrenHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadGrenHypN2 ELSE 0 ENDIF;
uNLoadGrenHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadGrenHypN2 ELSE 0 ENDIF;
uPLoadGrenHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadGrenHypN2 ELSE 0 ENDIF;
uDLoadBlueHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadBlueHypN2 ELSE 0 ENDIF;
uNLoadBlueHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadBlueHypN2 ELSE 0 ENDIF;
uPLoadBlueHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadBlueHypN2 ELSE 0 ENDIF;
uDLoadZooHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mDLoadZooHypN2 ELSE 0 ENDIF;
uNLoadZooHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mNLoadZooHypN2 ELSE 0 ENDIF;
uPLoadZooHypN2= IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN mPLoadZooHypN2 ELSE 0 ENDIF;
uDLoadHypN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mDLoadIMHypN2 + mDLoadDetHypN2 + mDLoadDiatHypN2 + mDLoadGrenHypN2 + mDLoadBlueHypN2) ELSE 0.0 ENDIF;
uNLoadHypN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mNLoadNH4HypN2 + mNLoadNO3HypN2 + mNLoadGrenHypN2 + mNLoadDiatHypN2 + mNLoadBlueHypN2 + mNLoadDetHypN2) ELSE 0.0 ENDIF;
uPLoadHypN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN2 EQ TRUE) THEN (mPLoadPO4HypN2 + mPLoadAIMHypN2 + mPLoadDiatHypN2 + mPLoadGrenHypN2 + mPLoadBlueHypN2 + mPLoadDetHypN2) ELSE 0.0 ENDIF;
uSiLoadHypN2 = IF (InclTranN2 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2HypN2 + uSiLoadDetHypN2 + uSiLoadDiatHypN2 ENDIF;
wDDilIMHypN2 = ukOutHypN2 * oDIMWHypN2;
wDDilDetHypN2 = ukOutHypN2 * oDDetWHypN2;
wDDilGrenHypN2 = ukOutHypN2 * oDGrenWHypN2;
wDDilBlueHypN2 = ukOutHypN2 * oDBlueWHypN2;
wDDilDiatHypN2 = ukOutHypN2 * oDDiatWHypN2;
wDDilZooHypN2 = ukOutHypN2 * oDZooHypN2;
wPDilZooHypN2 = ukOutHypN2 * oPZooHypN2;
wNDilZooHypN2 = ukOutHypN2 * oNZooHypN2;
wPDilPO4HypN2 = ukOutHypN2 * oPO4WHypN2;
wPDilDetHypN2 = ukOutHypN2*oPDetWHypN2;
wPDilAIMHypN2 = ukOutHypN2 * oPAIMWHypN2;
wNDilNH4HypN2 = ukOutHypN2 * oNH4WHypN2;
wNDilNO3HypN2 = ukOutHypN2 * oNO3WHypN2;
wNDilDetHypN2 = ukOutHypN2 * oNDetWHypN2;
wO2OutflHypN2 = ukOutHypN2 * oO2WHypN2;
wPDilDiatHypN2 = ukOutHypN2 * oPDiatWHypN2;
wNDilDiatHypN2 = ukOutHypN2 * oNDiatWHypN2;
wPDilGrenHypN2 = ukOutHypN2 * oPGrenWHypN2;
wNDilGrenHypN2 = ukOutHypN2 * oNGrenWHypN2;
wPDilBlueHypN2 = ukOutHypN2 * oPBlueWHypN2;
wNDilBlueHypN2 = ukOutHypN2 * oNBlueWHypN2;
wSiDilSiO2HypN2 = ukOutHypN2 * oSiO2WHypN2;
wSiDilDetHypN2 = ukOutHypN2 * oSiDetWHypN2;
wSiDilDiatHypN2 = cSiDDiatN2 * wDDilDiatHypN2;
wDDilPhytHypN2 = wDDilDiatHypN2 + wDDilGrenHypN2 + wDDilBlueHypN2;
wPDilPhytHypN2 = wPDilDiatHypN2 + wPDilGrenHypN2 + wPDilBlueHypN2;
wNDilPhytHypN2 = wNDilDiatHypN2 + wNDilGrenHypN2 + wNDilBlueHypN2;
wSiDilTotHypN2 = wSiDilDetHypN2 + wSiDilSiO2HypN2 + wSiDilDiatHypN2;
wDOutflTotHypN2 = ukOutHypN2 * oDSestWHypN2;
wPOutflTotHypN2 = ukOutHypN2 * oPTotWHypN2;
wNOutflTotHypN2 = ukOutHypN2 * oNTotWHypN2;
wSiOutflTotHypN2 = ukOutHypN2 * (oSiO2WHypN2 + oSiDetWHypN2 + cSiDDiatN2 * oDDiatWHypN2);
tSiTranTotTHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadHypN2 - wSiDilTotHypN2 * uDepthWHypN2 ENDIF;
wDDilTotHypN2 = wDDilIMHypN2 + wDDilDetHypN2 + wDDilPhytHypN2;
wPDilTotHypN2 = wPDilDetHypN2 + wPDilPO4HypN2 + wPDilAIMHypN2 + wPDilPhytHypN2;
wNDilTotHypN2 = wNDilDetHypN2 + wNDilNO3HypN2 + wNDilNH4HypN2 + wNDilPhytHypN2;
tDTranTotTHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadHypN2 - wDDilTotHypN2 * uDepthWHypN2 ENDIF;
tPTranTotTHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadHypN2 - wPDilTotHypN2 * uDepthWHypN2 ENDIF;
tNTranTotTHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadHypN2 - wNDilTotHypN2 * uDepthWHypN2 ENDIF;
uDLoadTotTWN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadEpiN2 + uDLoadHypN2 ENDIF;
uPLoadTotTWN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadEpiN2 + uPLoadHypN2 ENDIF;
uNLoadTotTWN2 =  IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadEpiN2 + uNLoadHypN2 ENDIF;
uSiLoadTotTWN2 =  IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadEpiN2 + uSiLoadHypN2 ENDIF;
wDExchIMMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDIMWHypN2 - oDIMWMN2) ELSE 0.0 ENDIF;
wPExchPO4MHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPO4WHypN2 - oPO4WMN2) ELSE 0.0 ENDIF;
wPExchAIMMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPAIMWHypN2 - oPAIMWMN2) ELSE 0.0 ENDIF;
wNExchNH4MHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNH4WHypN2 - oNH4WMN2) ELSE 0.0 ENDIF;
wNExchNO3MHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNO3WHypN2 - oNO3WMN2) ELSE 0.0 ENDIF;
wSiExchSiO2MHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oSiO2WHypN2 - oSiO2WMN2) ELSE 0.0 ENDIF;
wO2ExchMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oO2WHypN2 - oO2WMN2) ELSE 0.0 ENDIF;
wDExchDetMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDDetWHypN2 - oDDetWMN2) ELSE 0.0 ENDIF;
wPExchDetMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPDetWHypN2 - oPDetWMN2) ELSE 0.0 ENDIF;
wNExchDetMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNDetWHypN2 - oNDetWMN2) ELSE 0.0 ENDIF;
wSiExchDetMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oSiDetWHypN2 - oSiDetWMN2) ELSE 0.0 ENDIF;
wDExchDiatMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDDiatWHypN2 - oDDiatWMN2) ELSE 0.0 ENDIF;
wPExchDiatMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPDiatWHypN2 - oPDiatWMN2) ELSE 0.0 ENDIF;
wNExchDiatMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNDiatWHypN2 - oNDiatWMN2) ELSE 0.0 ENDIF;
wSiExchDiatMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cSiDDiatN2 * wDExchDiatMHypN2 ELSE 0.0 ENDIF;
wDExchGrenMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDGrenWHypN2 - oDGrenWMN2) ELSE 0.0 ENDIF;
wPExchGrenMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPGrenWHypN2 - oPGrenWMN2) ELSE 0.0 ENDIF;
wNExchGrenMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNGrenWHypN2 - oNGrenWMN2) ELSE 0.0 ENDIF;
wDExchBlueMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDBlueWHypN2 - oDBlueWMN2) ELSE 0.0 ENDIF;
wPExchBlueMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPBlueWHypN2 - oPBlueWMN2) ELSE 0.0 ENDIF;
wNExchBlueMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNBlueWHypN2 - oNBlueWMN2) ELSE 0.0 ENDIF;
wDExchZooMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oDZooHypN2 - oDZooMN2) ELSE 0.0 ENDIF;
wPExchZooMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oPZooHypN2 - oPZooMN2) ELSE 0.0 ENDIF;
wNExchZooMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMHypN2 *(oNZooHypN2 - oNZooMN2) ELSE 0.0 ENDIF;
wDExchIMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDIMWHypN2 - oDIMWMN2) ELSE 0.0 ENDIF;
wPExchPO4HypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPO4WHypN2 - oPO4WMN2) ELSE 0.0 ENDIF;
wPExchAIMHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPAIMWHypN2 - oPAIMWMN2) ELSE 0.0 ENDIF;
wNExchNH4HypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNH4WHypN2 - oNH4WMN2) ELSE 0.0 ENDIF;
wNExchNO3HypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNO3WHypN2 - oNO3WMN2) ELSE 0.0 ENDIF;
wSiExchSiO2HypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oSiO2WHypN2 - oSiO2WMN2) ELSE 0.0 ENDIF;
wO2ExchHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oO2WHypN2 - oO2WMN2) ELSE 0.0 ENDIF;
wDExchDetHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDDetWHypN2 - oDDetWMN2) ELSE 0.0 ENDIF;
wPExchDetHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPDetWHypN2 - oPDetWMN2) ELSE 0.0 ENDIF;
wNExchDetHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNDetWHypN2 - oNDetWMN2) ELSE 0.0 ENDIF;
wSiExchDetHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oSiDetWHypN2 - oSiDetWMN2) ELSE 0.0 ENDIF;
wDExchDiatHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDDiatWHypN2 - oDDiatWMN2) ELSE 0.0 ENDIF;
wPExchDiatHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPDiatWHypN2 - oPDiatWMN2) ELSE 0.0 ENDIF;
wNExchDiatHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNDiatWHypN2 - oNDiatWMN2) ELSE 0.0 ENDIF;
wSiExchDiatHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cSiDDiatN2 * wDExchDiatHypN2 ELSE 0.0 ENDIF;
wDExchGrenHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDGrenWHypN2 - oDGrenWMN2) ELSE 0.0 ENDIF;
wPExchGrenHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPGrenWHypN2 - oPGrenWMN2) ELSE 0.0 ENDIF;
wNExchGrenHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNGrenWHypN2 - oNGrenWMN2) ELSE 0.0 ENDIF;
wDExchBlueHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDBlueWHypN2 - oDBlueWMN2) ELSE 0.0 ENDIF;
wPExchBlueHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPBlueWHypN2 - oPBlueWMN2) ELSE 0.0 ENDIF;
wNExchBlueHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNBlueWHypN2 - oNBlueWMN2) ELSE 0.0 ENDIF;
wDExchZooHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oDZooHypN2 - oDZooMN2) ELSE 0.0 ENDIF;
wPExchZooHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oPZooHypN2 - oPZooMN2) ELSE 0.0 ENDIF;
wNExchZooHypN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLHypN2 *(oNZooHypN2 - oNZooMN2) ELSE 0.0 ENDIF;
tInfSiO2WHypN2 =  IF (InclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oSiO2WHypN2 ELSE 0.0 ENDIF;
tInfO2WHypN2 =  IF (InclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oO2WHypN2 ELSE 0.0 ENDIF;
tPInfPO4WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oPO4WHypN2 ELSE 0.0 ENDIF;
tNInfNH4WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNH4WHypN2 ELSE 0.0 ENDIF;
tNInfNO3WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNO3WHypN2 ELSE 0.0 ENDIF;
tPInfPO4SN2 = IF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oPO4SN2 ELSE 0.0 ENDIF;
tNInfNH4SN2 = IF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNH4SN2 ELSE 0.0 ENDIF;
tNInfNO3SN2 = IF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNO3SN2 ELSE 0.0 ENDIF;
tSeepSiO2WHypN2 =  IF (InclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WHypN2 =  IF (InclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oPO4SN2 ELSE 0.0 ENDIF;
tNSeepNH4WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNH4SN2 ELSE 0.0 ENDIF;
tNSeepNO3WHypN2 = IF (aInclStratN2 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNO3SN2 ELSE 0.0 ENDIF;
tPSeepPO4SN2 = IF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cPO4GroundN2 ELSE 0.0 ENDIF;
tNSeepNH4SN2 = IF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cNH4GroundN2 ELSE 0.0 ENDIF;
tNSeepNO3SN2 = IF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cNO3GroundN2 ELSE 0.0 ENDIF;
tNH4LoadSN2 = fNH4LoadSN2 * cNLoadSN2;
tNO3LoadSN2 = cNLoadSN2 - tNH4LoadSN2;
uDErosIMN2 = (1.0 - fDOrgSoilN2) * cDErosTotN2;
uDErosIMSN2 = fSedErosIMN2 * uDErosIMN2;
uDErosIMWN2 = uDErosIMN2 - uDErosIMSN2;
uDErosOMN2 = fDOrgSoilN2 * cDErosTotN2;
uPErosOMN2 = cPDSoilOMN2 * uDErosOMN2;
uNErosOMN2 = cNDSoilOMN2 * uDErosOMN2;
uO2SatEpiN2 = 14.652 - 0.41022 * uTmEpiN2 + 0.007991 * uTmEpiN2*uTmEpiN2 - 0.000077774 * uTmEpiN2*uTmEpiN2*uTmEpiN2;
uO2SatHypN2 = 14.652 - 0.41022 * uTmHypN2 + 0.007991 * uTmHypN2*uTmHypN2- 0.000077774 *uTmHypN2*uTmHypN2*uTmHypN2;
kAerN2 = IF POW ( uVWindN2 , (0.5))  LE NearZeroN2 THEN 1 ELSE cAerRootN2 * POW ( uVWindN2 , (0.5)) + cAerLinN2 * uVWindN2 + cAerSquareN2 * uVWindN2*uVWindN2 ENDIF;
uFunTmAerEpiN2 = IF  POW ( cThetaAerN2 , (uTmEpiN2-cTmRefN2)) LE NearZeroN2 THEN 1 ELSE POW ( cThetaAerN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
uFunTmAerHypN2 = IF POW ( cThetaAerN2 , (uTmHypN2-cTmRefN2)) LE NearZeroN2 THEN 1 ELSE POW ( cThetaAerN2 , (uTmHypN2-cTmRefN2)) ENDIF;
aFunFloatAerN2 =  MAX( 0.0, 1.0 -  ( kFloatAerN2 * aDFloatVegN2 ) );
aFunBlueSurfAerN2 = MAX(0.0, 1.0 - (kBlueSurfAerN2 * aDBlueSurfN2));
tO2BubHypN2 = IF (uO2SatHypN2 LT oO2WHypN2 ) THEN kBubN2 * uFunTmAerHypN2 * (uO2SatHypN2 - oO2WHypN2) ELSE 0 ENDIF;
uFunTmFishN2 = IF (InclWebN2 EQ TRUE) THEN EXP( -0.5/(cSigTmFishN2*cSigTmFishN2) * (( MAX (uTmEpiN2, uTmHypN2 * aInclStratN2) - cTmOptFishN2)*( MAX (uTmEpiN2, uTmHypN2 * aInclStratN2) - cTmOptFishN2) - (cTmRefN2 - cTmOptFishN2)*(cTmRefN2 - cTmOptFishN2))) ELSE 0.0 ENDIF;
tDTurbFishN2 = IF (InclWebN2 EQ TRUE) THEN (kTurbFishN2 * uFunTmFishN2 * aDFiAdN2) ELSE 0.0 ENDIF;
aFunVegResusN2 = MAX(1.0 - kVegResusN2 * aDVegN2, NearZeroN2);
aFunDimSuspN2 = IF (uTmEpiN2 GE 0.1) OR  POW(((cFetchN2 +NearZeroN2)/ cFetchRefN2) , (0.5)) LE NearZeroN2 THEN cSuspRefN2 * ((cSuspMinN2 + cSuspMaxN2 / (1.0 + EXP(cSuspSlopeN2 * (uDepthWN2 - hDepthSuspN2)))) * POW(((cFetchN2 +NearZeroN2)/ cFetchRefN2) , (0.5))) ELSE 0.0 ENDIF;
tDResusTauDeadN2 = IF POW(aFunDimSuspN2 +NearZeroN2 , (0.5)) LE NearZeroN2 THEN MIN(aFunDimSuspN2, POW( 1  , (0.5))) * POW(fLutumN2 / fLutumRefN2 , (0.5)) * bPorSN2 ELSE MIN(aFunDimSuspN2, POW(aFunDimSuspN2 +NearZeroN2 , (0.5))) * POW(fLutumN2 / fLutumRefN2 , (0.5)) * bPorSN2 ENDIF;
tDResusBareDeadN2 = tDResusTauDeadN2 + tDTurbFishN2;
tDResusDeadN2 = tDResusBareDeadN2 * aFunVegResusN2;
tDResusIMN2 = fLutumN2 * aDIMSN2 / (fLutumN2 * aDIMSN2 + aDDetSN2) * tDResusDeadN2;
tDResusDetN2 = aDDetSN2 / (fLutumN2 * aDIMSN2 + aDDetSN2) * tDResusDeadN2;
akResusPhytRefN2 = kResusPhytMaxN2 * (1.0 - EXP(cResusPhytExpN2 * tDResusDeadN2));
tDResusPhytTotN2 = akResusPhytRefN2 * aDPhytSN2;
tPResusDetN2 = rPDDetSN2 * tDResusDetN2;
tPResusPO4N2 = aPO4SN2 / aDDetSN2 * tDResusDetN2;
tPResusAIMN2 = aPAIMSN2 / aDIMSN2 * tDResusIMN2;
tNResusNO3N2 = aNO3SN2 / aDDetSN2 * tDResusDetN2;
tNResusNH4N2 = aNH4SN2 / aDDetSN2 * tDResusDetN2;
tNResusDetN2 = rNDDetSN2 * tDResusDetN2;
tSiResusDetN2 = rSiDDetSN2 * tDResusDetN2;
aFunTauSetOMHypN2 = IF POW(aFunDimSuspN2 +NearZeroN2 , (0.5)) LT NearZeroN2 THEN 1 ELSE MIN(1.0 / POW(aFunDimSuspN2 +NearZeroN2 , (0.5)), 1.0) ENDIF;
aFunTauSetIMHypN2 = aFunTauSetOMHypN2;
uFunTmSetEpiN2 = IF POW ( cThetaSetN2 , (uTmEpiN2-cTmRefN2)) LT NearZeroN2 THEN 1 ELSE POW ( cThetaSetN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
uFunTmSetHypN2 = IF POW(cThetaSetN2 , (uTmHypN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE POW(cThetaSetN2 , (uTmHypN2-cTmRefN2)) ENDIF;
uCorVSetIMHypN2 = IF POW((fLutumRefN2/fLutumN2) , (0.5))  LT NearZeroN2 THEN 1 ELSE aFunTauSetIMHypN2 * POW((fLutumRefN2/fLutumN2) , (0.5)) * uFunTmSetHypN2 * (cVSetIMN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) ENDIF;
tDSetIMHypN2 = uCorVSetIMHypN2 * oDIMWHypN2;
tPSetAIMHypN2 = oPAIMWHypN2 / oDIMWHypN2 * tDSetIMHypN2;
uCorVSetDetHypN2 = (cVSetDetN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMHypN2 * uFunTmSetHypN2;
tDSetDetHypN2 = uCorVSetDetHypN2 * oDDetWHypN2;
tPSetDetHypN2 = uCorVSetDetHypN2 * oPDetWHypN2;
tNSetDetHypN2 = uCorVSetDetHypN2 * oNDetWHypN2;
tSiSetDetHypN2 = uCorVSetDetHypN2 * oSiDetWHypN2;
kPMinDetWN2 = kDMinDetWN2;
kNMinDetWN2 = kDMinDetWN2;
kSiMinDetWN2 = kDMinDetWN2;
uFunTmMinWEpiN2 =  IF POW(cThetaMinWN2 , (uTmEpiN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE POW(cThetaMinWN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
uFunTmMinWHypN2 = IF POW(cThetaMinWN2 , (uTmEpiN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE  POW(cThetaMinWN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
wDMinDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kDMinDetWN2 * uFunTmMinWHypN2 * oDDetWHypN2 ENDIF;
wPMinDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kPMinDetWN2 * uFunTmMinWHypN2 * oPDetWHypN2 ENDIF;
wNMinDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kNMinDetWN2 * uFunTmMinWHypN2 * oNDetWHypN2 ENDIF;
wSiMinDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kSiMinDetWN2 * uFunTmMinWHypN2 * oSiDetWHypN2 ENDIF;
aCorO2BODHypN2 = oO2WHypN2 / (hO2BODN2 + oO2WHypN2);
wO2MinDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE molO2molCN2 * cCPerDWN2 * aCorO2BODHypN2 * wDMinDetWHypN2 ENDIF;
wDDenitWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE oNO3WHypN2*oNO3WHypN2 / (hNO3DenitN2*hNO3DenitN2 + oNO3WHypN2*oNO3WHypN2) * (1.0 - aCorO2BODHypN2) * wDMinDetWHypN2 ENDIF;
wNDenitWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE NO3PerCN2 * molNmolCN2 * cCPerDWN2 * wDDenitWHypN2 ENDIF;
uFunTmNitrHypN2 = IF   POW(cThetaNitrN2 , (uTmHypN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE POW(cThetaNitrN2 , (uTmHypN2-cTmRefN2)) ENDIF;
uFunTmNitrEpiN2 =  IF POW(cThetaNitrN2 , (uTmEpiN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE POW(cThetaNitrN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
uFunTmNitrSN2 = IF POW(cThetaNitrN2 , (uTmEpiN2-cTmRefN2))  LT NearZeroN2 THEN 1 ELSE POW(cThetaNitrN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
aCorO2NitrWHypN2 = oO2WHypN2*oO2WHypN2 / (hO2NitrN2*hO2NitrN2 + oO2WHypN2*oO2WHypN2);
wNNitrWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kNitrWN2 * uFunTmNitrHypN2 * aCorO2NitrWHypN2 * oNH4WHypN2 ENDIF;
wO2NitrWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE O2PerNH4N2 * molO2molNN2 * wNNitrWHypN2 ENDIF;
kPMinDetSN2 = kDMinDetSN2;
kNMinDetSN2 = kDMinDetSN2;
kSiMinDetSN2 = kDMinDetSN2;
uFunTmMinSN2 = IF POW(cThetaMinSN2 , (uTmBotN2-cTmRefN2)) LT NearZeroN2 THEN 1 ELSE  POW(cThetaMinSN2 , (uTmBotN2-cTmRefN2)) ENDIF;
tDMinDetSN2 = kDMinDetSN2 * uFunTmMinSN2 * aDDetSN2;
tPMinDetSN2 = kPMinDetSN2 * uFunTmMinSN2 * aPDetSN2;
tNMinDetSN2 = kNMinDetSN2 * uFunTmMinSN2 * aNDetSN2;
tSiMinDetSN2 = kSiMinDetSN2 * uFunTmMinSN2 * aSiDetSN2;
uFunTmDifN2 = IF POW(cThetaDifN2 , (uTmEpiN2-cTmRefN2)) LT NearZeroN2 THEN 1 ELSE POW(cThetaDifN2 , (uTmEpiN2-cTmRefN2)) ENDIF;
akO2DifCorN2 = kO2DifN2 * uFunTmDifN2 * cTurbDifO2N2 * bPorCorSN2;
tSODN2 = (molO2molCN2 * cCPerDWN2 * (1.0 - fRefrDetSN2) * tDMinDetSN2 + O2PerNH4N2 * molO2molNN2 * kNitrSN2 * uFunTmNitrSN2 * aNH4SN2) / cDepthSN2;
aDepthDifN2 = fDepthDifSN2 * cDepthSN2;
tPDifPO4HypN2 = IF ( aInclStratN2 EQ TRUE ) THEN kPDifPO4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oPO4SN2 - oPO4WHypN2 ) / aDepthDifN2 ELSE 0.0 ENDIF ;
tNDifNO3HypN2 = IF ( aInclStratN2 EQ TRUE ) THEN kNDifNO3N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oNO3SN2 - oNO3WHypN2 ) / aDepthDifN2 ELSE 0.0 ENDIF ;
tNDifNH4HypN2 = IF ( aInclStratN2 EQ TRUE ) THEN kNDifNH4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oNH4SN2 - oNH4WHypN2 ) / aDepthDifN2 ELSE 0.0 ENDIF ;
tO2DifHypN2 = IF ( aInclStratN2 EQ TRUE ) THEN kO2DifN2 / aDepthDifN2 * uFunTmDifN2 * cTurbDifO2N2 * bPorCorSN2 * oO2WHypN2 ELSE 0.0 ENDIF ;
tPDifGroundPO4N2 = 0.0;
tNDifGroundNO3N2 = 0.0;
tNDifGroundNH4N2 = 0.0;
aPAdsMaxWHypN2 = cRelPAdsDN2 + aCorO2BODHypN2 * cRelPAdsFeN2 * fFeDIMN2 + cRelPAdsAlN2 * fAlDIMN2;
aKPAdsWHypN2 = (1.0 - fRedMaxN2 * (1.0-aCorO2BODHypN2)) * cKPAdsOxN2;
aPIsoAdsWHypN2 = aPAdsMaxWHypN2 * aKPAdsWHypN2 * oPO4WHypN2 / (1.0 + aKPAdsWHypN2 * oPO4WHypN2);
aPEqIMWHypN2 = aPIsoAdsWHypN2 * oDIMWHypN2;
wPSorpIMWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kPSorpN2 * (aPEqIMWHypN2 - oPAIMWHypN2) ENDIF;
tPChemPO4N2 = MAX( 0.0, kPChemPO4N2 * (oPO4SN2 - coPO4MaxN2) );
uQEvPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN uQEvN2 ELSE 0.0 ENDIF;
tPEvPO4WMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN uQEvPhraN2 / mmPermN2 * oPO4WMN2 ELSE 0.0 ENDIF;
tNEvNH4WMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN uQEvPhraN2 / mmPermN2 * oNH4WMN2 ELSE 0.0 ENDIF;
tNEvNO3WMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN uQEvPhraN2 / mmPermN2 * oNO3WMN2 ELSE 0.0 ENDIF;
tInfSiO2WMN2 = IF ((InclMarshN2 EQ FALSE) OR (fMarshN2 LE NearZeroN2)) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oSiO2WMN2 ELSE 0.0 ENDIF;
tInfO2WMN2 = IF ((InclMarshN2 EQ FALSE) OR (fMarshN2 LE NearZeroN2)) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oO2WMN2 ELSE 0.0 ENDIF;
tPInfPO4WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oPO4WMN2 ELSE 0.0 ENDIF;
tNInfNH4WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNH4WMN2 ELSE 0.0 ENDIF;
tNInfNO3WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNO3WMN2 ELSE 0.0 ENDIF;
tPInfPO4SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oPO4SMN2 ELSE 0.0 ENDIF;
tNInfNH4SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNH4SMN2 ELSE 0.0 ENDIF;
tNInfNO3SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNO3SMN2 ELSE 0.0 ENDIF;
tSeepSiO2WMN2 = IF ((InclMarshN2 EQ FALSE) OR (fMarshN2 LT NearZeroN2)) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WMN2 = IF ((InclMarshN2 EQ FALSE) OR (fMarshN2 LT NearZeroN2)) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oPO4SMN2 ELSE 0.0 ENDIF;
tNSeepNH4WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNH4SMN2 ELSE 0.0 ENDIF;
tNSeepNO3WMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNO3SMN2 ELSE 0.0 ENDIF;
tPSeepPO4SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cPO4GroundN2 ELSE 0.0 ENDIF;
tNSeepNH4SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cNH4GroundN2 ELSE 0.0 ENDIF;
tNSeepNO3SMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * cNO3GroundN2 ELSE 0.0 ENDIF;
tO2AerMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kAerN2 * uFunTmAerEpiN2 *(uO2SatEpiN2 - oO2WMN2) ELSE 0.0 ENDIF;
tDSetIMMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetIMN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oDIMWMN2 ELSE 0.0 ENDIF;
tPSetAIMMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetIMN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oPAIMWMN2 ELSE 0.0 ENDIF;
tDSetDetMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDetN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oDDetWMN2 ELSE 0.0 ENDIF;
tPSetDetMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDetN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oPDetWMN2 ELSE 0.0 ENDIF;
tNSetDetMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDetN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oNDetWMN2 ELSE 0.0 ENDIF;
tSiSetDetMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDetN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oSiDetWMN2 ELSE 0.0 ENDIF;
tDSetDiatMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ( cVSetDiatN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oDDiatWMN2 ELSE 0.0 ENDIF;
tPSetDiatMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDiatN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oPDiatWMN2 ELSE 0.0 ENDIF;
tNSetDiatMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ( cVSetDiatN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oNDiatWMN2 ELSE 0.0 ENDIF;
tSiSetDiatMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetDiatN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oSiDiatWMN2 ELSE 0.0 ENDIF;
tDSetGrenMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetGrenN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oDGrenWMN2 ELSE 0.0 ENDIF;
tPSetGrenMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetGrenN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oPGrenWMN2 ELSE 0.0 ENDIF;
tNSetGrenMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetGrenN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oNGrenWMN2 ELSE 0.0 ENDIF;
tDSetBlueMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2 * oDBlueWMN2 ELSE 0.0 ENDIF;
tPSetBlueMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2)* uFunTmSetEpiN2* oPBlueWMN2 ELSE 0.0 ENDIF;
tNSetBlueMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * uFunTmSetEpiN2* oNBlueWMN2 ELSE 0.0 ENDIF;
tDSetPhytMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDSetDiatMN2 + tDSetGrenMN2 + tDSetBlueMN2 ELSE 0.0 ENDIF;
tPSetPhytMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tPSetDiatMN2 + tPSetGrenMN2 + tPSetBlueMN2 ELSE 0.0 ENDIF;
tNSetPhytMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tNSetDiatMN2 + tNSetGrenMN2 + tNSetBlueMN2 ELSE 0.0 ENDIF;
tDSetTotMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDSetIMMN2 + tDSetDetMN2 + tDSetPhytMN2 ELSE 0.0 ENDIF;
wDMinDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMinDetWN2 * uFunTmMinWEpiN2 * oDDetWMN2 ELSE 0.0 ENDIF;
wPMinDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kPMinDetWN2 * uFunTmMinWEpiN2 * oPDetWMN2 ELSE 0.0 ENDIF;
wNMinDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kNMinDetWN2 * uFunTmMinWEpiN2 * oNDetWMN2 ELSE 0.0 ENDIF;
wSiMinDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kSiMinDetWN2 * uFunTmMinWEpiN2 * oSiDetWMN2 ELSE 0.0 ENDIF;
aCorO2BODMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oO2WMN2 /(hO2BODN2 + oO2WMN2) ELSE 0.0 ENDIF;
wO2MinDetWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN molO2molCN2 * cCPerDWN2 * aCorO2BODMN2 * wDMinDetWMN2 ELSE 0.0 ENDIF;
wDDenitWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNO3WMN2*oNO3WMN2 /(hNO3DenitN2*hNO3DenitN2 + oNO3WMN2*oNO3WMN2) *(1.0 - aCorO2BODMN2) * wDMinDetWMN2 ELSE 0.0 ENDIF;
wNDenitWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN NO3PerCN2 * molNmolCN2 * cCPerDWN2 * wDDenitWMN2 ELSE 0.0 ENDIF;
aCorO2NitrWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oO2WMN2 * oO2WMN2 /(hO2NitrN2 * hO2NitrN2 + oO2WMN2 * oO2WMN2) ELSE 0.0 ENDIF;
wNNitrWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kNitrWN2 * uFunTmNitrEpiN2 * aCorO2NitrWMN2 * oNH4WMN2 ELSE 0.0 ENDIF;
wO2NitrWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN O2PerNH4N2 * molO2molNN2 * wNNitrWMN2 ELSE 0.0 ENDIF;
tDMinDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMinDetSN2 * uFunTmMinSN2 * aDDetSMN2 ELSE 0.0 ENDIF;
tPMinDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kPMinDetSN2 * uFunTmMinSN2 * aPDetSMN2 ELSE 0.0 ENDIF;
tNMinDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kNMinDetSN2 * uFunTmMinSN2 * aNDetSMN2 ELSE 0.0 ENDIF;
tSiMinDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kSiMinDetSN2 * uFunTmMinSN2 * aSiDetSMN2 ELSE 0.0 ENDIF;
akO2DifCorMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kO2DifN2 * uFunTmDifN2 * cTurbDifO2N2 * bPorCorSMN2 ELSE 0.0 ENDIF;
tSODMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN(molO2molCN2 * cCPerDWN2 *(1.0 - fRefrDetSN2) * tDMinDetSMN2 + O2PerNH4N2 * molO2molNN2 * kNitrSN2 * uFunTmNitrEpiN2 * aNH4SMN2) / cDepthSMN2 ELSE 0.0 ENDIF;
aDepthOxySedMN2 = IF (InclMarshN2 EQ FALSE OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF POW((2.0 * oO2WMN2 * akO2DifCorMN2 / tSODMN2) , (0.5)) LE NearZeroN2 THEN 1 ELSE POW((2.0 * oO2WMN2 * akO2DifCorMN2 / tSODMN2) , (0.5)) ENDIF ;
afOxySedMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDepthOxySedMN2 / cDepthSMN2 ELSE 0.0 ENDIF;
tDMinOxyDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN afOxySedMN2 *(1.0 - fRefrDetSN2) * tDMinDetSMN2 ELSE 0.0 ENDIF;
tO2MinDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN molO2molCN2 * cCPerDWN2 * tDMinOxyDetSMN2 ELSE 0.0 ENDIF;
tDDenitSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN oNO3SMN2*oNO3SMN2 /(hNO3DenitN2*hNO3DenitN2 + oNO3SMN2*oNO3SMN2) *(1.0 - afOxySedMN2) *(1.0 - fRefrDetSN2) * tDMinDetSMN2 ELSE 0.0 ENDIF;
tNDenitSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN NO3PerCN2 * molNmolCN2 * cCPerDWN2 * tDDenitSMN2 ELSE 0.0 ENDIF;
tNNitrSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN afOxySedMN2 * kNitrSN2 * uFunTmNitrEpiN2 * aNH4SMN2 ELSE 0.0 ENDIF;
tO2NitrSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN O2PerNH4N2 * molO2molNN2 * tNNitrSMN2 ELSE 0.0 ENDIF;
tDMinHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMinHumN2 * uFunTmMinSN2 * afOxySedMN2 * aDHumSMN2 ELSE 0.0 ENDIF;
tPMinHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMinHumN2 * uFunTmMinSN2 * afOxySedMN2 * aPHumSMN2 ELSE 0.0 ENDIF;
tNMinHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMinHumN2 * uFunTmMinSN2 * afOxySedMN2 * aNHumSMN2 ELSE 0.0 ENDIF;
aDepthDifMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN fDepthDifSN2 * cDepthSMN2 ELSE 0.0 ENDIF;
tPDifPO4MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kPDifPO4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSMN2 * (oPO4SMN2 - oPO4WMN2) / aDepthDifMN2 ELSE 0.0 ENDIF;
tNDifNO3MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kNDifNO3N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSMN2 * (oNO3SMN2 - oNO3WMN2) / aDepthDifMN2 ELSE 0.0 ENDIF;
tNDifNH4MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kNDifNH4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSMN2 * (oNH4SMN2 - oNH4WMN2) / aDepthDifMN2 ELSE 0.0 ENDIF;
tO2DifMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kO2DifN2 / aDepthDifMN2 * uFunTmDifN2 * cTurbDifO2N2 * bPorCorSMN2 * oO2WMN2 ELSE 0.0 ENDIF;
tPDifGroundPO4MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNO3MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNH4MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN 0.0 ELSE 0.0 ENDIF;
aPAdsMaxWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cRelPAdsDN2 + aCorO2BODMN2 * cRelPAdsFeN2 * fFeDIMN2 + cRelPAdsAlN2 * fAlDIMN2 ELSE 0.0 ENDIF;
aKPAdsWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN(1.0 - fRedMaxN2 *(1.0-aCorO2BODMN2)) * cKPAdsOxN2 ELSE 0.0 ENDIF;
aPIsoAdsWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPAdsMaxWMN2 * aKPAdsWMN2 * oPO4WMN2 /(1.0 + aKPAdsWMN2 * oPO4WMN2) ELSE 0.0 ENDIF;
aPEqIMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPIsoAdsWMN2 * oDIMWMN2 ELSE 0.0 ENDIF;
wPSorpIMWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kPSorpN2 *(aPEqIMWMN2 - oPAIMWMN2) ELSE 0.0 ENDIF;
aPAdsMaxSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cRelPAdsDN2 + afOxySedMN2 * cRelPAdsFeN2 * fFeDIMN2 + cRelPAdsAlN2 * fAlDIMN2 ELSE 0.0 ENDIF;
aKPAdsSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN(1.0 - fRedMaxN2 *(1.0-afOxySedMN2)) * cKPAdsOxN2 ELSE 0.0 ENDIF;
aPIsoAdsSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPAdsMaxSMN2 * aKPAdsSMN2 * oPO4SMN2 /(1.0 + aKPAdsSMN2 * oPO4SMN2) ELSE 0.0 ENDIF;
aPEqIMSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPIsoAdsSMN2 * aDIMSMN2 ELSE 0.0 ENDIF;
tPSorpIMSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kPSorpN2 *(aPEqIMSMN2 - aPAIMSMN2) ELSE 0.0 ENDIF;
tPChemPO4MN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN MAX(0.0,kPChemPO4N2 *(oPO4SMN2 - coPO4MaxN2)) ELSE 0.0 ENDIF;
aDRootVegN2 = bfRootVegN2 * aDVegN2;
bfSubVegEpiN2 = bfSubVegN2 * ( uVegHeightEpiN2 / uDepthWN2 );
bfSubVegHypN2 = bfSubVegN2 * ( uVegHeightHypN2 / uDepthWN2 );
afCovSurfVegN2 = MIN(1.0, MAX(aDFloatVegN2 / (cDLayerVegN2 + NearZeroN2), aDEmergVegN2 / (fEmergVegN2 * cDCarrVegN2 + NearZeroN2) ) ) ;
afCovEmergVegN2 = MIN(1.0, PerCentN2 * cCovSpVegN2 * aDEmergVegN2);
aCovVegN2 = MIN(100.0, cCovSpVegN2 * aDShootVegN2);
aLPARBotHypN2 = uLPARSurfHypN2 * EXP(- aExtCoefHypN2 * uDepthWHypN2);
rPDVegN2 = aPVegN2 / (aDVegN2+NearZeroN2);
rNDVegN2 = aNVegN2 / (aDVegN2+NearZeroN2);
tDMigrVegN2 = kMigrVegN2 * (cDVegInN2 - aDVegN2);
tPMigrVegN2 = kMigrVegN2 * (cPDVeg0N2* cDVegInN2 - aPVegN2);
tNMigrVegN2 = kMigrVegN2 * (cNDVeg0N2* cDVegInN2 - aNVegN2);
uFunTmRespVegN2 = IF ( UseExpVegN2 GT NearZeroN2 ) THEN uFunTmVegN2 ELSE POW(cQ10RespVegN2 , (0.1 * (uTmVegAveN2 - cTmRefN2))) ENDIF;
afPUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN 0.0 ELSEIF (bfRootVegN2 LE NearZeroN2) THEN 0.0 ELSEIF (fFloatVegN2 + bfSubVegN2 LE NearZeroN2) THEN 1.0 ELSEIF (aInclStratN2 EQ TRUE AND ((oPO4SN2+NearZeroN2) / (oPO4WHypN2+NearZeroN2)) GT NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(((oPO4SN2+NearZeroN2) / (oPO4WHypN2+NearZeroN2)) , fSedUptVegExpN2)) ELSEIF (aInclStratN2 EQ TRUE AND ((oPO4SN2+NearZeroN2) / (oPO4WHypN2+NearZeroN2)) LE NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW( NearZeroN2 , fSedUptVegExpN2)) ELSEIF (((oPO4SN2+NearZeroN2) / (oPO4WEpiN2+NearZeroN2)) LE NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW (NearZeroN2 , fSedUptVegExpN2)) ELSE fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(((oPO4SN2+NearZeroN2) / (oPO4WEpiN2+NearZeroN2)) , fSedUptVegExpN2)) ENDIF;
afNUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN 0.0 ELSEIF (bfRootVegN2 LE NearZeroN2) THEN 0.0 ELSEIF (fFloatVegN2 + bfSubVegN2 LE NearZeroN2) THEN 1.0 ELSEIF ( aInclStratN2 EQ TRUE AND ((oNDissSN2+NearZeroN2) / (oNDissWHypN2+NearZeroN2)) GT NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(((oNDissSN2+NearZeroN2) / (oNDissWHypN2+NearZeroN2)) , fSedUptVegExpN2)) ELSEIF ( aInclStratN2 EQ TRUE AND ((oNDissSN2+NearZeroN2) / (oNDissWHypN2+NearZeroN2)) LE NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(NearZeroN2 , fSedUptVegExpN2)) ELSEIF ( ((oNDissSN2+NearZeroN2) / (oNDissWEpiN2+NearZeroN2)) LE NearZeroN2 ) THEN fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(NearZeroN2 , fSedUptVegExpN2)) ELSE fSedUptVegMaxN2 / (1.0 + fSedUptVegCoefN2 * POW(((oNDissSN2+NearZeroN2) / (oNDissWEpiN2+NearZeroN2)) , fSedUptVegExpN2)) ENDIF;
aVPUptMaxCrVegN2 = IF (FALSE EQ UseEmpUptN2) THEN MAX( 0.0, cVPUptMaxVegN2 * uFunTmProdVegN2 * (cPDVegMaxN2-rPDVegN2) / (cPDVegMaxN2-cPDVegMinN2) ) ELSE MAX( 0.0, cVPUptMaxVegN2 * uFunTmProdVegN2 * (cPDVegMaxN2-rPDVegN2) / (cPDVegMaxN2-cPDVegMinN2) ) ENDIF;
aVPUptVegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN oPO4WHypN2 * aVPUptMaxCrVegN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4WHypN2) ELSE 0.0 ENDIF;
aVPUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN oPO4SN2 * aVPUptMaxCrVegN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4SN2) ELSE 0.0 ENDIF;
aVPUptVegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN oPO4WEpiN2 * aVPUptMaxCrVegN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4WEpiN2) ELSE 0.0 ENDIF;
tPUptVegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN aVPUptVegWEpiN2 * (aDSubVegN2 + aDFloatVegN2) ELSE (1.0 - afPUptVegSN2) * aVPUptMaxCrVegN2 * oPO4WEpiN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4WEpiN2) * uDVegEpiN2 ENDIF;
tPUptVegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN aVPUptVegWHypN2 * (aDSubVegN2 + aDFloatVegN2) ELSE (1.0 - afPUptVegSN2) * aVPUptMaxCrVegN2 * oPO4WHypN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4WHypN2) * uDVegHypN2 ENDIF;
tPUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN aVPUptVegSN2 * aDRootVegN2 ELSE afPUptVegSN2 * aVPUptMaxCrVegN2 * oPO4SN2 / (aVPUptMaxCrVegN2 / cAffPUptVegN2 + oPO4SN2) * aDVegN2 ENDIF;
tPUptVegEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN tPUptVegWEpiN2 + tPUptVegSN2 * uDVegEpiN2 / aDVegN2 ELSEIF (aInclStratN2 EQ FALSE AND FALSE EQ UseEmpUptN2) THEN tPUptVegWEpiN2 + tPUptVegSN2 ELSE tPUptVegWEpiN2 + tPUptVegSN2 ENDIF;
tPUptVegHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN2) THEN tPUptVegWHypN2 + tPUptVegSN2 * uDVegHypN2 / aDVegN2 ELSE tPUptVegWHypN2 + tPUptVegSN2 * uDVegHypN2 / aDVegN2 ENDIF ;
aVNUptMaxCrVegN2 = IF (FALSE EQ UseEmpUptN2) THEN MAX( 0.0, cVNUptMaxVegN2 * uFunTmProdVegN2 * (cNDVegMaxN2 - rNDVegN2) / (cNDVegMaxN2 - cNDVegMinN2)) ELSE MAX( 0.0, cVNUptMaxVegN2 * uFunTmProdVegN2 * (cNDVegMaxN2 - rNDVegN2) / (cNDVegMaxN2 - cNDVegMinN2)) ENDIF;
ahNUptVegN2 = IF (FALSE EQ UseEmpUptN2) THEN aVNUptMaxCrVegN2 / cAffNUptVegN2 ELSE aVNUptMaxCrVegN2 / cAffNUptVegN2 ENDIF;
aVNUptVegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN oNDissWEpiN2 * aVNUptMaxCrVegN2 / (ahNUptVegN2 + oNDissWEpiN2) ELSE 0.0 ENDIF;
aVNUptVegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN oNDissWHypN2 * aVNUptMaxCrVegN2 / (ahNUptVegN2 + oNDissWHypN2) ELSE 0.0 ENDIF;
afNH4UptVegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN oNH4WEpiN2 * oNO3WEpiN2 / ((ahNUptVegN2 + oNH4WEpiN2) * (ahNUptVegN2 + oNO3WEpiN2 + NearZeroN2)) + oNH4WEpiN2 * ahNUptVegN2 / ((oNH4WEpiN2 + oNO3WEpiN2 + NearZeroN2) * (ahNUptVegN2 + oNO3WEpiN2 + NearZeroN2)) ELSE oNH4WEpiN2 * oNO3WEpiN2 / ((ahNUptVegN2 + oNH4WEpiN2) * (ahNUptVegN2 + oNO3WEpiN2 + NearZeroN2)) + oNH4WEpiN2 * ahNUptVegN2 / ((oNH4WEpiN2 + oNO3WEpiN2 + NearZeroN2) * (ahNUptVegN2 + oNO3WEpiN2 + NearZeroN2)) ENDIF;
afNH4UptVegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN oNH4WHypN2 * oNO3WHypN2 / ((ahNUptVegN2 + oNH4WHypN2) * (ahNUptVegN2 + oNO3WHypN2 + NearZeroN2)) + oNH4WHypN2 * ahNUptVegN2 / ((oNH4WHypN2 + oNO3WHypN2 + NearZeroN2) * (ahNUptVegN2 + oNO3WHypN2 + NearZeroN2)) ELSE oNH4WHypN2 * oNO3WHypN2 / ((ahNUptVegN2 + oNH4WHypN2) * (ahNUptVegN2 + oNO3WHypN2 + NearZeroN2)) + oNH4WHypN2 * ahNUptVegN2 / ((oNH4WHypN2 + oNO3WHypN2 + NearZeroN2) * (ahNUptVegN2 + oNO3WHypN2 + NearZeroN2)) ENDIF;
tNUptVegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN aVNUptVegWEpiN2 * (aDSubVegN2 + aDFloatVegN2) ELSE (1.0 - afNUptVegSN2) * aVNUptMaxCrVegN2 * oNDissWEpiN2 / (aVNUptMaxCrVegN2 / cAffNUptVegN2 + oNDissWEpiN2) * uDVegEpiN2 ENDIF;
tNUptVegWHypN2 = IF (FALSE EQ aInclStratN2) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN2) THEN aVNUptVegWHypN2 * (aDSubVegN2 + aDFloatVegN2) ELSE (1.0 - afNUptVegSN2) * aVNUptMaxCrVegN2 * oNDissWHypN2 / (aVNUptMaxCrVegN2 / cAffNUptVegN2 + oNDissWHypN2) * uDVegHypN2 ENDIF;
tNUptNH4VegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN afNH4UptVegWEpiN2 * tNUptVegWEpiN2 ELSE afNH4UptVegWEpiN2 * tNUptVegWEpiN2 ENDIF;
tNUptNO3VegWEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN tNUptVegWEpiN2 - tNUptNH4VegWEpiN2 ELSE tNUptVegWEpiN2 - tNUptNH4VegWEpiN2 ENDIF;
tNUptNH4VegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN afNH4UptVegWHypN2 * tNUptVegWHypN2 ELSE afNH4UptVegWHypN2 * tNUptVegWHypN2 ENDIF;
tNUptNO3VegWHypN2 = IF (FALSE EQ UseEmpUptN2) THEN tNUptVegWHypN2 - tNUptNH4VegWHypN2 ELSE tNUptVegWHypN2 - tNUptNH4VegWHypN2 ENDIF;
aVNUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN oNDissSN2 * aVNUptMaxCrVegN2 / (ahNUptVegN2 + oNDissSN2) ELSE 0.0 ENDIF;
tNUptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN aVNUptVegSN2 * aDRootVegN2 ELSE afNUptVegSN2 * aVNUptMaxCrVegN2 * oNDissSN2 / (aVNUptMaxCrVegN2 / cAffNUptVegN2 + oNDissSN2) * aDVegN2 ENDIF;
afNH4UptVegSN2 = IF (FALSE EQ UseEmpUptN2) THEN oNH4SN2 * oNO3SN2 / ((ahNUptVegN2 + oNH4SN2 +NearZeroN2) * (ahNUptVegN2 + oNO3SN2 +NearZeroN2)) + oNH4SN2 * ahNUptVegN2 / ((oNH4SN2 + oNO3SN2+NearZeroN2) * (ahNUptVegN2 + oNO3SN2+NearZeroN2)) ELSE oNH4SN2 * oNO3SN2 / ((ahNUptVegN2 + oNH4SN2 +NearZeroN2) * (ahNUptVegN2 + oNO3SN2 +NearZeroN2)) + oNH4SN2 * ahNUptVegN2 / ((oNH4SN2 + oNO3SN2+NearZeroN2) * (ahNUptVegN2 + oNO3SN2+NearZeroN2)) ENDIF;
tNUptNH4VegSN2 = IF (FALSE EQ UseEmpUptN2) THEN afNH4UptVegSN2 * tNUptVegSN2 ELSE afNH4UptVegSN2 * tNUptVegSN2 ENDIF;
tNUptVegSEpiN2 = IF (FALSE EQ UseEmpUptN2) THEN aVNUptVegSN2 * aDRootVegN2 ELSE afNUptVegSN2 * aVNUptMaxCrVegN2 * oNDissSN2 / (aVNUptMaxCrVegN2 / cAffNUptVegN2 + oNDissSN2) * aDVegN2 ENDIF;
tNUptNO3VegSN2 = IF (FALSE EQ UseEmpUptN2) THEN tNUptVegSN2 - tNUptNH4VegSN2 ELSE tNUptVegSN2 - tNUptNH4VegSN2 ENDIF;
tNUptVegN2 =tNUptVegWEpiN2 + tNUptVegWHypN2 + tNUptVegSN2;
aLLimShootVegEpiN2 = fEmergVegN2 + fFloatVegN2 * (1.0 - afCovEmergVegN2) + bfSubVegEpiN2 * (1.0 - afCovSurfVegN2) * 1.0 / (aExtCoefEpiN2 * uDepthWEpiN2) * LN( (1.0 + aLPAR1VegEpiN2 / uhLVegN2) / (1.0 + aLPAR2VegEpiN2 / uhLVegN2));
aLLimShootVegHypN2 = fEmergVegN2 + fFloatVegN2 * (1.0 - afCovEmergVegN2) + bfSubVegHypN2 * (1.0 - afCovSurfVegN2) * 1.0 / (aExtCoefHypN2 * uDepthWHypN2) * LN( (1.0 + aLPAR1VegHypN2 / uhLVegN2) / (1.0 + aLPAR2VegHypN2 / uhLVegN2));
aMuTmLVegHypN2 = ufDayN2 * bfShootVegN2 * aLLimShootVegHypN2 * uFunTmProdVegN2 * cMuMaxVegN2;
aPLimVegN2 = MAX(0.0, (1.0 - cPDVegMinN2 / rPDVegN2) * cPDVegMaxN2 / (cPDVegMaxN2 - cPDVegMinN2) );
aNLimVegN2 = MAX(0.0, (1.0 - cNDVegMinN2 / rNDVegN2) * cNDVegMaxN2 / (cNDVegMaxN2 - cNDVegMinN2) );
aNutLimVegN2 = MIN( aPLimVegN2, aNLimVegN2);
aMuVegHypN2 = aMuTmLVegHypN2 * aNutLimVegN2;
bkMortVegN2 = IF (FALSE EQ InclSeasonN2) THEN kMortVegSumN2 ELSEIF (aVegWinN2 EQ TRUE AND aDaysVegWinN2 LE cLengMortN2 AND aDaysVegWinN2 GT 0) THEN - LN(fWinVegN2) / cLengMortN2 ELSE kMortVegSumN2 ENDIF;
akDIncrVegHypN2 = aMuTmLVegHypN2 - kDRespVegN2 * uFunTmRespVegN2 - bkMortVegN2;
tDEnvVegHypN2 = MAX(0.0, akDIncrVegHypN2 / (cDCarrVegN2+NearZeroN2) * aDVegN2*aDVegN2);
tDEnvProdVegHypN2 = aMuVegHypN2 / cMuMaxVegN2 * tDEnvVegHypN2;
tDProdVegHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE MAX(0.0, aMuVegHypN2 * uDVegHypN2 - tDEnvProdVegHypN2) ENDIF;
tDProdSubVegHypN2 = bfSubVegHypN2 * tDProdVegHypN2;
tDRespVegN2 = kDRespVegN2 * uFunTmRespVegN2 * aDVegN2;
tDEnvMortVegHypN2 = tDEnvVegHypN2 - tDEnvProdVegHypN2;
tDMortVegHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE bkMortVegN2 * uDVegHypN2 + tDEnvMortVegHypN2 ENDIF;
tDMortVegWHypN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tDMortVegHypN2;
tDGrazVegBirdN2 = IF ( (sTimeN2 GE cYearStartBirdsN2 * DaysPerYearN2) AND (DayN2 GE cDayStartBirdsN2) AND (DayN2 LE cDayEndBirdsN2) ) THEN cPrefVegBirdN2 * aDVegN2 / (hDVegBirdN2 + aDVegN2) * cBirdsPerhaN2 / m2PerhaN2 * cDGrazPerBirdN2 ELSE 0.0 ENDIF;
bkManVegN2 = IF ((DayN2 GE cDayManVeg1N2 AND DayN2 LT cDayManVeg1N2 + cLengManN2) OR (DayN2 GE cDayManVeg2N2 AND DayN2 LT cDayManVeg2N2 + cLengManN2)) THEN -LN(1.0 - fManVegN2) / cLengManN2 ELSE 0.0 ENDIF;
tDManVegN2 = bkManVegN2 * aDVegN2;
tPManVegN2 = rPDVegN2 * tDManVegN2;
tNManVegN2 = rNDVegN2 * tDManVegN2;
tO2ProdVegHypN2 = molO2molCN2 * cCPerDWN2 * tDProdVegHypN2;
tO2RespVegWHypN2 = molO2molCN2 * cCPerDWN2 * bfSubVegHypN2 * tDRespVegN2 * aCorO2BODHypN2;
aDepthOxySedN2 = IF(aInclStratN2 EQ TRUE AND (2.0 * oO2WHypN2 * akO2DifCorN2 / tSODN2) GT NearZeroN2 ) THEN POW((2.0 * oO2WHypN2 * akO2DifCorN2 / tSODN2) , (0.5)) ELSEIF ( aInclStratN2 EQ TRUE AND (2.0 * oO2WHypN2 * akO2DifCorN2 / tSODN2) LE NearZeroN2 ) THEN POW ( NearZeroN2 , (0.5)) ELSEIF ( aInclStratN2 EQ TRUE AND ( 2.0 * oO2WEpiN2 * akO2DifCorN2 / tSODN2 ) LE NearZeroN2 ) THEN POW ( NearZeroN2 , (0.5)) ELSE POW ( ( 2.0 * oO2WEpiN2 * akO2DifCorN2 / tSODN2 ) , (0.5)) ENDIF;
afOxySedN2 = aDepthOxySedN2 / cDepthSN2;
tO2RespVegSN2 = molO2molCN2 * cCPerDWN2 * bfRootVegN2 * tDRespVegN2 * afOxySedN2;
tO2ProdVegSHypN2 = MIN (tO2RespVegSN2, tO2ProdVegHypN2);
tO2ProdVegWHypN2 = MIN( tO2ProdVegHypN2 - tO2ProdVegSHypN2, bfSubVegN2 * tO2ProdVegHypN2);
tO2UptNO3VegWHypN2 = O2PerNO3N2 * molO2molNN2 * bfSubVegN2 * tNUptNO3VegWHypN2;
tO2UptNO3VegSN2 = O2PerNO3N2 * molO2molNN2 * tNUptNO3VegSN2;
tPExcrVegN2 = (rPDVegN2 *2.0)/ (cPDVegMaxN2 + rPDVegN2) * rPDVegN2 * tDRespVegN2;
tPExcrVegSN2 = bfRootVegN2 * tPExcrVegN2;
tPExcrVegWN2 = tPExcrVegN2 - tPExcrVegSN2;
tPMortVegHypN2 = rPDVegN2 * tDMortVegHypN2;
tPMortVegPO4HypN2 = fDissMortVegN2 * tPMortVegHypN2;
tPMortVegPO4SHypN2 = bfRootVegN2 * tPMortVegPO4HypN2;
tPMortVegPO4WHypN2 = tPMortVegPO4HypN2 - tPMortVegPO4SHypN2;
tPMortVegDetHypN2 = tPMortVegHypN2 - tPMortVegPO4HypN2;
tPMortVegDetWHypN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tPMortVegDetHypN2;
tPMortVegDetSHypN2 = tPMortVegDetHypN2 - tPMortVegDetWHypN2;
tPGrazVegBirdN2 = rPDVegN2 * tDGrazVegBirdN2;
tNExcrVegN2 = (2.0 * rNDVegN2) / (cNDVegMaxN2 + rNDVegN2) * rNDVegN2 * tDRespVegN2;
tNExcrVegSN2 = bfRootVegN2 * tNExcrVegN2;
tNExcrVegWN2 = tNExcrVegN2 - tNExcrVegSN2;
tNMortVegHypN2 = rNDVegN2 * tDMortVegHypN2;
tNMortVegNH4HypN2 = fDissMortVegN2 * tNMortVegHypN2;
tNMortVegNH4SHypN2 = IF (aInclStratN2 EQ TRUE ) THEN bfRootVegN2 * tNMortVegNH4HypN2 ELSE 0.0 ENDIF;
tNMortVegNH4WHypN2 = tNMortVegNH4HypN2 - tNMortVegNH4SHypN2;
tNMortVegDetHypN2 = tNMortVegHypN2 - tNMortVegNH4HypN2;
tNMortVegDetWHypN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tNMortVegDetHypN2;
tNMortVegDetSHypN2 = tNMortVegDetHypN2 - tNMortVegDetWHypN2;
tNGrazVegBirdN2 = rNDVegN2 * tDGrazVegBirdN2;
tDAssVegBirdN2 = fDAssBirdN2 * tDGrazVegBirdN2;
tDEgesBirdN2 = tDGrazVegBirdN2 - tDAssVegBirdN2;
tPAssVegBirdN2 = fDAssBirdN2 * tPGrazVegBirdN2;
tPEgesBirdN2 = tPGrazVegBirdN2 - tPAssVegBirdN2;
tPEgesBirdPO4N2 = fDissEgesBirdN2 * tPEgesBirdN2;
tPEgesBirdDetN2 = tPEgesBirdN2 - tPEgesBirdPO4N2;
tNAssVegBirdN2 = fDAssBirdN2 * tNGrazVegBirdN2;
tNEgesBirdN2 = tNGrazVegBirdN2 - tNAssVegBirdN2;
tNEgesBirdNH4N2 = fDissEgesBirdN2 * tNEgesBirdN2;
tNEgesBirdDetN2 = tNEgesBirdN2 - tNEgesBirdNH4N2;
wDBedDetWHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE) THEN (tDMortVegWHypN2) / uDepthWHypN2 ELSE 0.0 ENDIF;
aMuTmLVegEpiN2 = ufDayN2 * bfShootVegN2 * aLLimShootVegEpiN2 * uFunTmProdVegN2 * cMuMaxVegN2;
akDIncrVegEpiN2 = aMuTmLVegEpiN2 - kDRespVegN2 * uFunTmRespVegN2 - bkMortVegN2;
tDEnvVegEpiN2 = MAX(0.0, akDIncrVegEpiN2 / (cDCarrVegN2+NearZeroN2) * aDVegN2*aDVegN2);
aMuVegEpiN2 = aMuTmLVegEpiN2 * aNutLimVegN2;
tDEnvProdVegEpiN2 = aMuVegEpiN2 / cMuMaxVegN2 * tDEnvVegEpiN2;
tDProdVegEpiN2 = MAX(0.0, aMuVegEpiN2 * uDVegEpiN2 - tDEnvProdVegEpiN2);
tDEnvMortVegEpiN2 = tDEnvVegEpiN2 - tDEnvProdVegEpiN2;
tDMortVegEpiN2 = bkMortVegN2 * uDVegEpiN2 + tDEnvMortVegEpiN2;
tNMortVegEpiN2 = rNDVegN2 * tDMortVegEpiN2;
tNMortVegNH4EpiN2 = fDissMortVegN2 * tNMortVegEpiN2;
tNMortVegNH4SEpiN2 = bfRootVegN2 * tNMortVegNH4EpiN2;
wPBedPO4WHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE ) THEN (- tPUptVegWHypN2 + tPExcrVegWN2 * uVegHeightHypN2 / uVegHeightN2 + tPMortVegPO4WHypN2 ) /uDepthWHypN2 ELSE 0.0 ENDIF;
wPBedDetWHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE) THEN (tPMortVegDetWHypN2 ) / uDepthWHypN2 ELSE 0.0 ENDIF;
wNBedNH4WHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE ) THEN (- tNUptNH4VegWHypN2 + tNExcrVegWN2 * (uVegHeightHypN2 /uVegHeightN2 ) + tNMortVegNH4WHypN2 ) / uDepthWHypN2 ELSE 0.0 ENDIF;
wNBedNO3WHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE) THEN - tNUptNO3VegWHypN2 / uDepthWHypN2 ELSE 0.0 ENDIF;
wNBedDetWHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE) THEN (tNMortVegDetWHypN2 ) / uDepthWHypN2 ELSE 0.0 ENDIF;
tDMortVegSHypN2 = tDMortVegHypN2 - tDMortVegWHypN2;
tDBedDetSHypN2 = IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE ) THEN tDMortVegSHypN2 ELSE 0.0 ENDIF;
tO2BedWHypN2 =IF (aInclStratN2 EQ TRUE AND InclVegN2 EQ TRUE ) THEN tO2ProdVegWHypN2 - tO2RespVegWHypN2 + tO2UptNO3VegWHypN2 ELSE 0.0 ENDIF;
UseLossN2 = IF (InclWebN2 EQ TRUE) THEN 0.0 ELSE 1.0 ENDIF;
uFunTmLossHypN2 = EXP(-0.5/(cSigTmLossN2*cSigTmLossN2) *((uTmHypN2-cTmOptLossN2)*(uTmHypN2-cTmOptLossN2) -(cTmRefN2-cTmOptLossN2)*(cTmRefN2-cTmOptLossN2)));
uFunTmLossEpiN2 = EXP(-0.5/(cSigTmLossN2*cSigTmLossN2) *((uTmEpiN2-cTmOptLossN2)*(uTmEpiN2-cTmOptLossN2) -(cTmRefN2-cTmOptLossN2)*(cTmRefN2-cTmOptLossN2)));
rPDBlueWHypN2 = oPBlueWHypN2 /(oDBlueWHypN2+NearZeroN2);
rNDBlueWHypN2 = oNBlueWHypN2 /(oDBlueWHypN2+NearZeroN2);
rPDBlueSN2 = aPBlueSN2 /(aDBlueSN2+NearZeroN2);
rNDBlueSN2 = aNBlueSN2 /(aDBlueSN2+NearZeroN2);
uFunTmBlueHypN2 = EXP(-0.5/(cSigTmBlueN2*cSigTmBlueN2) *((uTmHypN2-cTmOptBlueN2)*(uTmHypN2-cTmOptBlueN2) - (cTmRefN2-cTmOptBlueN2)*(cTmRefN2-cTmOptBlueN2)));
uFunTmProdBlueHypN2 = uFunTmBlueHypN2;
uFunTmRespBlueHypN2 = uFunTmBlueHypN2;
uFunTmBlueEpiN2 = EXP(-0.5/(cSigTmBlueN2*cSigTmBlueN2) *((uTmEpiN2-cTmOptBlueN2)*(uTmEpiN2-cTmOptBlueN2) - (cTmRefN2-cTmOptBlueN2)*(cTmRefN2-cTmOptBlueN2)));
uFunTmProdBlueEpiN2 = uFunTmBlueEpiN2;
uFunTmRespBlueEpiN2 = uFunTmBlueEpiN2;
uFunTmBlueSN2 = EXP(-0.5/(cSigTmBlueN2*cSigTmBlueN2) *((uTmBotN2-cTmOptBlueN2)*(uTmBotN2-cTmOptBlueN2) - (cTmRefN2-cTmOptBlueN2)*(cTmRefN2-cTmOptBlueN2)));
uFunTmRespBlueSN2 = uFunTmBlueSN2;
uFunTmBlueSurfN2 = EXP(-0.5/(cSigTmBlueN2*cSigTmBlueN2) *((uTmSurfN2-cTmOptBlueN2)*(uTmSurfN2-cTmOptBlueN2) - (cTmRefN2-cTmOptBlueN2)*(cTmRefN2-cTmOptBlueN2)));
uFunTmProdBlueSurfN2 = uFunTmBlueSurfN2;
uFunTmRespBlueSurfN2 = uFunTmBlueSurfN2;
aLPARAveSurfN2 = MAX(0.0,(uLPARSurfN2 - aLPARBotSurfN2)/aExtSurfN2);
aLPARAveEpiN2 = (aLPARBotSurfN2 - aLPARBotEpiN2)/ (aExtCoefOpenEpiN2 * uDepthWEpiN2);
aLPARAveHypN2 = (aLPARBotEpiOpenN2 -aLPARBotHypN2)/ (aExtCoefOpenHypN2 * uDepthWEpiN2);
aAuxNfixLSurfN2 = cAlphNfixN2 * aLPARAveSurfN2 ;
aAuxNfixLEpiN2 = cAlphNfixN2 * aLPARAveEpiN2;
aAuxNfixLHypN2 = cAlphNfixN2 * aLPARAveHypN2;
rNfixBlueSurfN2 = cNfixMaxBlueN2 - cNfixMaxBlueN2 * EXP(- aAuxNfixLSurfN2) + cNfixDarkBlueN2;
rNfixBlueEpiN2 = cNfixMaxBlueN2 - cNfixMaxBlueN2 * EXP(- aAuxNfixLEpiN2) + cNfixDarkBlueN2;
rNfixBlueHypN2 = cNfixMaxBlueN2 - cNfixMaxBlueN2 * EXP(- aAuxNfixLHypN2) + cNfixDarkBlueN2;
aVPUptMaxCrBlueHypN2 = MAX(0.0,cVPUptMaxBlueN2 * uFunTmProdBlueHypN2 *(cPDBlueMaxN2 - rPDBlueWHypN2) /(cPDBlueMaxN2 - cPDBlueMinN2));
aVPUptBlueHypN2 = oPO4WHypN2 * aVPUptMaxCrBlueHypN2 /(aVPUptMaxCrBlueHypN2 / cAffPUptBlueN2 + oPO4WHypN2);
wPUptBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVPUptBlueHypN2 * oDBlueWHypN2 ENDIF;
aVNUptMaxCrBlueHypN2 = MAX(0.0,cVNUptMaxBlueN2 * uFunTmProdBlueHypN2 * (cNDBlueMaxN2 - rNDBlueWHypN2) /(cNDBlueMaxN2 - cNDBlueMinN2));
ahNUptBlueHypN2 = aVNUptMaxCrBlueHypN2 / cAffNUptBlueN2;
aVNUptBlueHypN2 = oNDissWHypN2 * aVNUptMaxCrBlueHypN2 /(ahNUptBlueHypN2 + oNDissWHypN2);
wNUptBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVNUptBlueHypN2 * oDBlueWHypN2 ENDIF;
tNUptBlueHypN2 = wNUptBlueHypN2 * uDepthWHypN2;
afNH4UptBlueHypN2 = oNH4WHypN2 * oNO3WHypN2 /((ahNUptBlueHypN2 + oNH4WHypN2) *(ahNUptBlueHypN2 + oNO3WHypN2)) + oNH4WHypN2 * ahNUptBlueHypN2 /((oNH4WHypN2 + oNO3WHypN2) *(ahNUptBlueHypN2 + oNO3WHypN2));
uMuMaxTmBlueHypN2 = cMuMaxBlueN2 * uFunTmProdBlueHypN2;
uMuMaxTmBlueEpiN2 = cMuMaxBlueN2 * uFunTmProdBlueEpiN2;
aPLimBlueHypN2 = MAX(0.0,(1.0 - cPDBlueMinN2 / rPDBlueWHypN2) * cPDBlueMaxN2 /(cPDBlueMaxN2 - cPDBlueMinN2));
aNLimBlueHypN2 = MAX(0.0,(1.0 - cNDBlueMinN2 / rNDBlueWHypN2) * cNDBlueMaxN2 /(cNDBlueMaxN2 - cNDBlueMinN2));
aSiLimBlueHypN2 = oSiO2WHypN2 /(hSiAssBlueN2 + oSiO2WHypN2);
aLLimBlueHypN2 = UseSteeleBlueN2 *(EXP(1.0) /(aExtCoefHypN2 * uDepthWHypN2) *(EXP(- aLPARBotHypN2 /(cLOptRefBlueN2 * uFunTmProdBlueHypN2)) - EXP(- uLPARSurfHypN2 /(cLOptRefBlueN2 * uFunTmProdBlueHypN2)))) +(1.0 - UseSteeleBlueN2) *(1.0 /(aExtCoefHypN2 * uDepthWHypN2) * LN((1.0 + uLPARSurfHypN2 / (hLRefBlueN2 * uFunTmProdBlueHypN2)) / (1.0 + aLPARBotHypN2 /(hLRefBlueN2 * uFunTmProdBlueHypN2))));
aMuTmLBlueHypN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimBlueHypN2 * uMuMaxTmBlueHypN2;
aNutLimBlueHypN2 = MIN(aPLimBlueHypN2,(MIN(aNLimBlueHypN2,aSiLimBlueHypN2)));
aMuBlueHypN2 = aNutLimBlueHypN2 * aMuTmLBlueHypN2;
wDAssBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aMuBlueHypN2*oDBlueWHypN2 ENDIF;
rChDBlueHypN2 = cChDBlueMaxN2 -(cChDBlueMaxN2 - cChDBlueMinN2) * aLLimBlueHypN2;
oChlaBlueHypN2 = mgPergN2 * rChDBlueHypN2 * oDBlueWHypN2;
aChlaBlueHypN2 = mgPergN2 * rChDBlueHypN2 * aDBlueWHypN2;
aExtChBlueHypN2 = cExtSpBlueN2 / rChDBlueHypN2;
aNfixBlueHypN2  = rNfixBlueHypN2 *aChlaBlueHypN2 /ugPergN2;
tNUptBlueAirHypN2 = IF (InclNfixN2 EQ FALSE) THEN 0.0 ELSE aNfixBlueHypN2 ENDIF;
tNUptBlueWHypN2 = IF (InclNfixN2 EQ FALSE) THEN tNUptBlueHypN2 ELSE tNUptBlueHypN2 - tNUptBlueAirHypN2 ENDIF;
wNUptBlueWHypN2 = tNUptBlueWHypN2 / uDepthWHypN2;
ukDRespTmBlueHypN2 = kDRespBlueN2 * uFunTmRespBlueHypN2;
wNUptNH4BlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE afNH4UptBlueHypN2 * wNUptBlueWHypN2 ENDIF;
wNUptNO3BlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptBlueWHypN2 - wNUptNH4BlueHypN2 ENDIF;
ukDRespTmBlueEpiN2 = kDRespBlueN2 * uFunTmRespBlueEpiN2;
ukDRespTmBlueSN2 = kDRespBlueN2 * uFunTmRespBlueSN2;
wDRespBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukDRespTmBlueHypN2 * oDBlueWHypN2 ENDIF;
ukDRespTmBlueSurfN2 = kDRespBlueN2 * uFunTmRespBlueSurfN2;
ukLossTmBlueHypN2 = UseLossN2 * kLossBlueN2 * uFunTmLossHypN2;
ukLossTmBlueEpiN2 = UseLossN2 * kLossBlueN2 * uFunTmLossEpiN2;
wDLossBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukLossTmBlueHypN2 * oDBlueWHypN2 ENDIF;
wDMortBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortBlueWN2 * oDBlueWHypN2 ENDIF;
uCorVSetBlueHypN2 = (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMHypN2 * uFunTmSetHypN2;
tDResusBlueN2 = aDBlueSN2 /(aDPhytSN2+NearZeroN2) * tDResusPhytTotN2;
tDRespBlueSN2 = ukDRespTmBlueSN2 * aDBlueSN2;
tDMortBlueSN2 = kMortBlueSN2 * aDBlueSN2;
ukDDecBlueHypN2 = ukDRespTmBlueHypN2 + ukLossTmBlueHypN2 + kMortBlueWN2 +(uCorVSetBlueHypN2 * uFunTmSetHypN2) / uDepthWHypN2;
wPExcrBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (rPDBlueWHypN2 * 2.0 )/(cPDBlueMaxN2 + rPDBlueWHypN2) * rPDBlueWHypN2 * wDRespBlueWHypN2 ENDIF;
wPLossBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN2 * wDLossBlueHypN2 ENDIF;
wPMortBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortBlueWN2 * oPBlueWHypN2 ENDIF;
tPResusBlueN2 = rPDBlueSN2 * tDResusBlueN2;
tPExcrBlueSN2 = (rPDBlueSN2 *2.0)/(cPDBlueMaxN2 + rPDBlueSN2) * rPDBlueSN2 * tDRespBlueSN2;
tPMortBlueSN2 = kMortBlueSN2 * aPBlueSN2;
wNExcrBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (rNDBlueWHypN2 *2.0)/(cNDBlueMaxN2 + rNDBlueWHypN2) * rNDBlueWHypN2 * wDRespBlueWHypN2 ENDIF;
wNLossBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN2 * wDLossBlueHypN2 ENDIF;
wNMortBlueWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortBlueWN2 * oNBlueWHypN2 ENDIF;
tNResusBlueN2 = rNDBlueSN2 * tDResusBlueN2;
tNExcrBlueSN2 = (2.0 * rNDBlueSN2) /(cNDBlueMaxN2 + rNDBlueSN2) * rNDBlueSN2 * tDRespBlueSN2;
tNMortBlueSN2 = kMortBlueSN2 * aNBlueSN2;
aFunTauSetOMEpiN2 = MIN(1.0 / POW(aFunDimSuspN2 +NearZeroN2 , (0.5)), 1.0);
aFunTauSetIMEpiN2 = aFunTauSetOMEpiN2;
uCorVSetBlueEpiN2 = (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMEpiN2 * uFunTmSetEpiN2;
rNDGrenWHypN2 = oNGrenWHypN2 /(oDGrenWHypN2+NearZeroN2);
rPDGrenSN2 = aPGrenSN2 /(aDGrenSN2+NearZeroN2);
rNDGrenSN2 = aNGrenSN2 /(aDGrenSN2+NearZeroN2);
uFunTmGrenHypN2 = EXP(-0.5/(cSigTmGrenN2*cSigTmGrenN2) *((uTmHypN2-cTmOptGrenN2)*(uTmHypN2-cTmOptGrenN2) - (cTmRefN2-cTmOptGrenN2)*(cTmRefN2-cTmOptGrenN2)));
uFunTmGrenEpiN2 = EXP(-0.5/(cSigTmGrenN2*cSigTmGrenN2) *((uTmEpiN2-cTmOptGrenN2)*(uTmEpiN2-cTmOptGrenN2) - (cTmRefN2-cTmOptGrenN2)*(cTmRefN2-cTmOptGrenN2)));
uFunTmGrenSN2 = EXP(-0.5/(cSigTmGrenN2*cSigTmGrenN2) *((uTmBotN2-cTmOptGrenN2)*(uTmBotN2-cTmOptGrenN2) - (cTmRefN2-cTmOptGrenN2)*(cTmRefN2-cTmOptGrenN2)));
uFunTmProdGrenHypN2 = uFunTmGrenHypN2;
uFunTmRespGrenHypN2 = uFunTmGrenHypN2;
uFunTmProdGrenEpiN2 = uFunTmGrenEpiN2;
uFunTmRespGrenEpiN2 = uFunTmGrenEpiN2;
uFunTmRespGrenSN2 = uFunTmGrenSN2;
aVNUptMaxCrGrenHypN2 = MAX(0.0,cVNUptMaxGrenN2 * uFunTmProdGrenHypN2 * (cNDGrenMaxN2 - rNDGrenWHypN2) /(cNDGrenMaxN2 - cNDGrenMinN2));
ahNUptGrenHypN2 = aVNUptMaxCrGrenHypN2 / cAffNUptGrenN2;
aVNUptGrenHypN2 = oNDissWHypN2 * aVNUptMaxCrGrenHypN2 /(ahNUptGrenHypN2 + oNDissWHypN2);
wNUptGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVNUptGrenHypN2 * oDGrenWHypN2 ENDIF;
afNH4UptGrenHypN2 = oNH4WHypN2 * oNO3WHypN2 /((ahNUptGrenHypN2 + oNH4WHypN2) *(ahNUptGrenHypN2 + oNO3WHypN2)) + oNH4WHypN2 * ahNUptGrenHypN2 /((oNH4WHypN2 + oNO3WHypN2) *(ahNUptGrenHypN2 + oNO3WHypN2));
wNUptNH4GrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE afNH4UptGrenHypN2 * wNUptGrenHypN2 ENDIF;
wNUptNO3GrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN2 - wNUptNH4GrenHypN2 ENDIF;
uMuMaxTmGrenHypN2 = cMuMaxGrenN2 * uFunTmProdGrenHypN2;
uMuMaxTmGrenEpiN2 = cMuMaxGrenN2 * uFunTmProdGrenEpiN2;
aNLimGrenHypN2 = MAX(0.0,(1.0 - cNDGrenMinN2 / rNDGrenWHypN2) * cNDGrenMaxN2 /(cNDGrenMaxN2 - cNDGrenMinN2));
aSiLimGrenHypN2 = oSiO2WHypN2 /(hSiAssGrenN2 + oSiO2WHypN2);
aLLimGrenHypN2 = UseSteeleGrenN2 *(EXP(1.0) /(aExtCoefHypN2 * uDepthWHypN2) *(EXP(- aLPARBotHypN2 /(cLOptRefGrenN2 * uFunTmProdGrenHypN2)) - EXP(- uLPARSurfHypN2 /(cLOptRefGrenN2 * uFunTmProdGrenHypN2)))) +(1.0 - UseSteeleGrenN2) *(1.0 /(aExtCoefHypN2 * uDepthWHypN2) * LN((1.0 + uLPARSurfHypN2 / (hLRefGrenN2 * uFunTmProdGrenHypN2)) / (1.0 + aLPARBotHypN2 /(hLRefGrenN2 * uFunTmProdGrenHypN2))));
aMuTmLGrenHypN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimGrenHypN2 * uMuMaxTmGrenHypN2;
rChDGrenHypN2 = cChDGrenMaxN2 -(cChDGrenMaxN2 - cChDGrenMinN2) * aLLimGrenHypN2;
oChlaGrenHypN2 = mgPergN2 * rChDGrenHypN2 * oDGrenWHypN2;
aExtChGrenHypN2 = cExtSpGrenN2 / rChDGrenHypN2;
ukDRespTmGrenHypN2 = kDRespGrenN2 * uFunTmRespGrenHypN2;
ukDRespTmGrenEpiN2 = kDRespGrenN2 * uFunTmRespGrenEpiN2;
ukDRespTmGrenSN2 = kDRespGrenN2 * uFunTmRespGrenSN2;
wDRespGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukDRespTmGrenHypN2 * oDGrenWHypN2 ENDIF;
ukLossTmGrenHypN2 = UseLossN2 * kLossGrenN2 * uFunTmLossHypN2;
ukLossTmGrenEpiN2 = UseLossN2 * kLossGrenN2 * uFunTmLossEpiN2;
wDLossGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukLossTmGrenHypN2 * oDGrenWHypN2 ENDIF;
wDMortGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortGrenWN2 * oDGrenWHypN2 ENDIF;
uCorVSetGrenHypN2 = (cVSetGrenN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMHypN2 * uFunTmSetHypN2;
tDSetGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE uCorVSetGrenHypN2 * oDGrenWHypN2 ENDIF;
tDResusGrenN2 = aDGrenSN2 /(aDPhytSN2+NearZeroN2) * tDResusPhytTotN2;
tDRespGrenSN2 = ukDRespTmGrenSN2 * aDGrenSN2;
tDMortGrenSN2 = kMortGrenSN2 * aDGrenSN2;
ukDDecGrenHypN2 = ukDRespTmGrenHypN2 + ukLossTmGrenHypN2 + kMortGrenWN2 +(uCorVSetGrenHypN2 * uFunTmSetHypN2) / uDepthWHypN2;
wPMortGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortGrenWN2 * oPGrenWHypN2 ENDIF;
tPResusGrenN2 = rPDGrenSN2 * tDResusGrenN2;
tPExcrGrenSN2 = (2.0 * rPDGrenSN2) /(cPDGrenMaxN2 + rPDGrenSN2) * rPDGrenSN2 * tDRespGrenSN2;
tPMortGrenSN2 = kMortGrenSN2 * aPGrenSN2;
wNExcrGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDGrenWHypN2) /(cNDGrenMaxN2 + rNDGrenWHypN2) * rNDGrenWHypN2 * wDRespGrenWHypN2 ENDIF;
wNLossGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN2 * wDLossGrenHypN2 ENDIF;
wNMortGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortGrenWN2 * oNGrenWHypN2 ENDIF;
tNSetGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN2 * tDSetGrenHypN2 ENDIF;
tNResusGrenN2 = rNDGrenSN2 * tDResusGrenN2;
tNExcrGrenSN2 = (2.0 * rNDGrenSN2) /(cNDGrenMaxN2 + rNDGrenSN2) * rNDGrenSN2 * tDRespGrenSN2;
tNMortGrenSN2 = kMortGrenSN2 * aNGrenSN2;
uCorVSetGrenEpiN2 = (cVSetGrenN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMEpiN2 * uFunTmSetEpiN2;
tDSetGrenEpiN2 = uCorVSetGrenEpiN2 * oDGrenWEpiN2;
rNDGrenWEpiN2 = oNGrenWEpiN2 /(oDGrenWEpiN2+NearZeroN2);
tNSetGrenEpiN2 = rNDGrenWEpiN2 * tDSetGrenEpiN2;
rPDGrenWEpiN2 = oPGrenWEpiN2 /(oDGrenWEpiN2+NearZeroN2);
tPSetGrenEpiN2 = rPDGrenWEpiN2 * tDSetGrenEpiN2;
wNPrimGrenWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN2 - wNExcrGrenWHypN2 - wNLossGrenHypN2 - wNMortGrenWHypN2 -(tNSetGrenHypN2 -tNSetGrenEpiN2 - tNResusGrenN2) / uDepthWHypN2 ENDIF;
rPDDiatWHypN2 = oPDiatWHypN2 /(oDDiatWHypN2+NearZeroN2);
rNDDiatWHypN2 = oNDiatWHypN2 /(oDDiatWHypN2+NearZeroN2);
rPDDiatSN2 = aPDiatSN2 /(aDDiatSN2+NearZeroN2);
uFunTmDiatHypN2 = EXP(-0.5/(cSigTmDiatN2*cSigTmDiatN2) *((uTmHypN2-cTmOptDiatN2)*(uTmHypN2-cTmOptDiatN2) - (cTmRefN2-cTmOptDiatN2)*(cTmRefN2-cTmOptDiatN2)));
rNDDiatSN2 = aNDiatSN2 /(aDDiatSN2+NearZeroN2);
uFunTmDiatEpiN2 = EXP(-0.5/(cSigTmDiatN2*cSigTmDiatN2) *((uTmEpiN2-cTmOptDiatN2)*(uTmEpiN2-cTmOptDiatN2) - (cTmRefN2-cTmOptDiatN2)*(cTmRefN2-cTmOptDiatN2)));
uFunTmDiatSN2 = EXP(-0.5/(cSigTmDiatN2*cSigTmDiatN2) *((uTmBotN2-cTmOptDiatN2)*(uTmBotN2-cTmOptDiatN2) - (cTmRefN2-cTmOptDiatN2)*(cTmRefN2-cTmOptDiatN2)));
uFunTmProdDiatHypN2 = uFunTmDiatHypN2;
uFunTmRespDiatHypN2 = uFunTmDiatHypN2;
uFunTmProdDiatEpiN2 = uFunTmDiatEpiN2;
uFunTmRespDiatEpiN2 = uFunTmDiatEpiN2;
uFunTmRespDiatSN2 = uFunTmDiatSN2;
aVPUptMaxCrDiatHypN2 = MAX(0.0,cVPUptMaxDiatN2 * uFunTmProdDiatHypN2 *(cPDDiatMaxN2 - rPDDiatWHypN2) /(cPDDiatMaxN2 - cPDDiatMinN2));
aVPUptDiatHypN2 = oPO4WHypN2 * aVPUptMaxCrDiatHypN2 /(aVPUptMaxCrDiatHypN2 / cAffPUptDiatN2 + oPO4WHypN2);
wPUptDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVPUptDiatHypN2 * oDDiatWHypN2 ENDIF;
aVNUptMaxCrDiatHypN2 = MAX(0.0,cVNUptMaxDiatN2 * uFunTmProdDiatHypN2 * (cNDDiatMaxN2 - rNDDiatWHypN2) /(cNDDiatMaxN2 - cNDDiatMinN2));
ahNUptDiatHypN2 = aVNUptMaxCrDiatHypN2 / cAffNUptDiatN2;
aVNUptDiatHypN2 = oNDissWHypN2 * aVNUptMaxCrDiatHypN2 /(ahNUptDiatHypN2 + oNDissWHypN2);
wNUptDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVNUptDiatHypN2 * oDDiatWHypN2 ENDIF;
afNH4UptDiatHypN2 = oNH4WHypN2 * oNO3WHypN2 /((ahNUptDiatHypN2 + oNH4WHypN2) *(ahNUptDiatHypN2 + oNO3WHypN2)) + oNH4WHypN2 * ahNUptDiatHypN2 /((oNH4WHypN2 + oNO3WHypN2) *(ahNUptDiatHypN2 + oNO3WHypN2));
wNUptNH4DiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE afNH4UptDiatHypN2 * wNUptDiatHypN2 ENDIF;
wNUptNO3DiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN2 - wNUptNH4DiatHypN2 ENDIF;
uMuMaxTmDiatHypN2 = cMuMaxDiatN2 * uFunTmProdDiatHypN2;
uMuMaxTmDiatEpiN2 = cMuMaxDiatN2 * uFunTmProdDiatEpiN2;
aPLimDiatHypN2 = MAX(0.0,(1.0 - cPDDiatMinN2 / rPDDiatWHypN2) * cPDDiatMaxN2 /(cPDDiatMaxN2 - cPDDiatMinN2));
aNLimDiatHypN2 = MAX(0.0,(1.0 - cNDDiatMinN2 / rNDDiatWHypN2) * cNDDiatMaxN2 /(cNDDiatMaxN2 - cNDDiatMinN2));
aSiLimDiatHypN2 = oSiO2WHypN2 /(hSiAssDiatN2 + oSiO2WHypN2);
aLLimDiatHypN2 = UseSteeleDiatN2 *(EXP(1.0) /(aExtCoefHypN2 * uDepthWHypN2) *(EXP(- aLPARBotHypN2 /(cLOptRefDiatN2 * uFunTmProdDiatHypN2)) - EXP(- uLPARSurfHypN2 /(cLOptRefDiatN2 * uFunTmProdDiatHypN2)))) +(1.0 - UseSteeleDiatN2) *(1.0 /(aExtCoefHypN2 * uDepthWHypN2) * LN((1.0 + uLPARSurfHypN2 / (hLRefDiatN2 * uFunTmProdDiatHypN2)) / (1.0 + aLPARBotHypN2 /(hLRefDiatN2 * uFunTmProdDiatHypN2))));
aMuTmLDiatHypN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimDiatHypN2 * uMuMaxTmDiatHypN2;
aNutLimDiatHypN2 = MIN(aPLimDiatHypN2,(MIN(aNLimDiatHypN2,aSiLimDiatHypN2)));
aMuDiatHypN2 = aNutLimDiatHypN2 * aMuTmLDiatHypN2;
wDAssDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aMuDiatHypN2*oDDiatWHypN2 ENDIF;
rChDDiatHypN2 = cChDDiatMaxN2 -(cChDDiatMaxN2 - cChDDiatMinN2) * aLLimDiatHypN2;
oChlaDiatHypN2 = mgPergN2 * rChDDiatHypN2 * oDDiatWHypN2;
aExtChDiatHypN2 = cExtSpDiatN2 / rChDDiatHypN2;
ukDRespTmDiatHypN2 = kDRespDiatN2 * uFunTmRespDiatHypN2;
ukDRespTmDiatEpiN2 = kDRespDiatN2 * uFunTmRespDiatEpiN2;
ukDRespTmDiatSN2 = kDRespDiatN2 * uFunTmRespDiatSN2;
wDRespDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukDRespTmDiatHypN2 * oDDiatWHypN2 ENDIF;
ukLossTmDiatHypN2 = UseLossN2 * kLossDiatN2 * uFunTmLossHypN2;
ukLossTmDiatEpiN2 = UseLossN2 * kLossDiatN2 * uFunTmLossEpiN2;
wDLossDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE ukLossTmDiatHypN2 * oDDiatWHypN2 ENDIF;
wDMortDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortDiatWN2 * oDDiatWHypN2 ENDIF;
uCorVSetDiatHypN2 = (cVSetDiatN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMHypN2 * uFunTmSetHypN2;
tDSetDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE uCorVSetDiatHypN2 * oDDiatWHypN2 ENDIF;
tDResusDiatN2 = aDDiatSN2 /(aDPhytSN2+NearZeroN2) * tDResusPhytTotN2;
tDRespDiatSN2 = ukDRespTmDiatSN2 * aDDiatSN2;
tDMortDiatSN2 = kMortDiatSN2 * aDDiatSN2;
ukDDecDiatHypN2 = ukDRespTmDiatHypN2 + ukLossTmDiatHypN2 + kMortDiatWN2 +(uCorVSetDiatHypN2 * uFunTmSetHypN2) / uDepthWHypN2;
wPExcrDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (2.0 * rPDDiatWHypN2) /(cPDDiatMaxN2 + rPDDiatWHypN2) * rPDDiatWHypN2 * wDRespDiatWHypN2 ENDIF;
wPLossDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN2 * wDLossDiatHypN2 ENDIF;
wPMortDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortDiatWN2 * oPDiatWHypN2 ENDIF;
tPSetDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN2 * tDSetDiatHypN2 ENDIF;
tPResusDiatN2 = rPDDiatSN2 * tDResusDiatN2;
tPExcrDiatSN2 = (2.0 * rPDDiatSN2) /(cPDDiatMaxN2 + rPDDiatSN2) * rPDDiatSN2 * tDRespDiatSN2;
tPMortDiatSN2 = kMortDiatSN2 * aPDiatSN2;
wNExcrDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDDiatWHypN2) /(cNDDiatMaxN2 + rNDDiatWHypN2) * rNDDiatWHypN2 * wDRespDiatWHypN2 ENDIF;
wNLossDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN2 * wDLossDiatHypN2 ENDIF;
wNMortDiatWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortDiatWN2 * oNDiatWHypN2 ENDIF;
tNSetDiatHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN2 * tDSetDiatHypN2 ENDIF;
tNResusDiatN2 = rNDDiatSN2 * tDResusDiatN2;
tNExcrDiatSN2 = (2.0 * rNDDiatSN2) /(cNDDiatMaxN2 + rNDDiatSN2) * rNDDiatSN2 * tDRespDiatSN2;
tNMortDiatSN2 = kMortDiatSN2 * aNDiatSN2;
uCorVSetDiatEpiN2 = (cVSetDiatN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2)  * aFunTauSetOMEpiN2 * uFunTmSetEpiN2;
tDSetDiatEpiN2 = uCorVSetDiatEpiN2 * oDDiatWEpiN2;
rPDDiatWEpiN2 = oPDiatWEpiN2 /(oDDiatWEpiN2+NearZeroN2);
tPSetDiatEpiN2 = rPDDiatWEpiN2 * tDSetDiatEpiN2;
rNDDiatWEpiN2 = oNDiatWEpiN2 /(oDDiatWEpiN2+NearZeroN2);
tNSetDiatEpiN2 = rNDDiatWEpiN2 * tDSetDiatEpiN2;
wDPrimDiatWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wDAssDiatHypN2 - wDRespDiatWHypN2 - wDLossDiatHypN2 - wDMortDiatWHypN2 -(tDSetDiatHypN2 - tDSetDiatEpiN2 - tDResusDiatN2) / uDepthWHypN2 ENDIF;
wPPrimDiatWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wPUptDiatHypN2 - wPExcrDiatWHypN2 - wPLossDiatHypN2 - wPMortDiatWHypN2 -(tPSetDiatHypN2 -tPSetDiatEpiN2 - tPResusDiatN2) / uDepthWHypN2 ENDIF;
wNPrimDiatWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN2 - wNExcrDiatWHypN2 - wNLossDiatHypN2 - wNMortDiatWHypN2 -(tNSetDiatHypN2 - tNSetDiatEpiN2 - tNResusDiatN2) / uDepthWHypN2 ENDIF;
oChlaHypN2 = oChlaDiatHypN2 + oChlaGrenHypN2 + oChlaBlueHypN2;
wDRespPhytWHypN2 = wDRespDiatWHypN2 + wDRespGrenWHypN2 + wDRespBlueWHypN2;
wDMortPhytWHypN2 = wDMortDiatWHypN2 + wDMortGrenWHypN2 + wDMortBlueWHypN2;
wDLossPhytHypN2 = wDLossDiatHypN2 + wDLossGrenHypN2 + wDLossBlueHypN2;
wPMortPhytWHypN2 = wPMortDiatWHypN2 + wPMortGrenWHypN2 + wPMortBlueWHypN2;
tPResusPhytN2 = tPResusDiatN2 + tPResusGrenN2 + tPResusBlueN2;
wNUptPhytHypN2 = wNUptDiatHypN2 + wNUptGrenHypN2 + wNUptBlueHypN2;
wNUptNH4PhytHypN2 = wNUptNH4DiatHypN2 + wNUptNH4GrenHypN2 + wNUptNH4BlueHypN2;
wNUptNO3PhytHypN2 = wNUptNO3DiatHypN2 + wNUptNO3GrenHypN2 + wNUptNO3BlueHypN2;
wNExcrPhytWHypN2 = wNExcrDiatWHypN2 + wNExcrGrenWHypN2 + wNExcrBlueWHypN2;
wNMortPhytWHypN2 = wNMortDiatWHypN2 + wNMortGrenWHypN2 + wNMortBlueWHypN2;
tNResusPhytN2 = tNResusDiatN2 + tNResusGrenN2 + tNResusBlueN2;
wNLossPhytHypN2 = wNLossDiatHypN2 + wNLossGrenHypN2 + wNLossBlueHypN2;
tDRespPhytSN2 = tDRespDiatSN2 + tDRespGrenSN2 + tDRespBlueSN2;
tDMortPhytSN2 = tDMortDiatSN2 + tDMortGrenSN2 + tDMortBlueSN2;
tPExcrPhytSN2 = tPExcrDiatSN2 + tPExcrGrenSN2 + tPExcrBlueSN2;
tPMortPhytSN2 = tPMortDiatSN2 + tPMortGrenSN2 + tPMortBlueSN2;
tNExcrPhytSN2 = tNExcrDiatSN2 + tNExcrGrenSN2 + tNExcrBlueSN2;
tNMortPhytSN2 = tNMortDiatSN2 + tNMortGrenSN2 + tNMortBlueSN2;
wSiUptDiatHypN2 = cSiDDiatN2 * wDAssDiatHypN2;
wSiExcrDiatWHypN2 = cSiDDiatN2 * wDRespDiatWHypN2 ;
wSiLossDiatHypN2 = cSiDDiatN2 * wDLossDiatHypN2;
wSiMortDiatWHypN2 = cSiDDiatN2 * wDMortDiatWHypN2;
tSiSetDiatHypN2 = cSiDDiatN2 * tDSetDiatHypN2;
tSiResusDiatN2 = cSiDDiatN2 * tDResusDiatN2 ;
rCyDBlueHypN2 = cCyDBlueMaxN2 -(cCyDBlueMaxN2 - cCyDBlueMinN2) * aLLimBlueHypN2;
oCyanHypN2 = rCyDBlueHypN2 * oDBlueWHypN2 * mgPergN2;
fDDiatHypN2 = oDDiatWHypN2 /(oDDiatWHypN2 + oDGrenWHypN2 + oDBlueWHypN2 + NearZeroN2);
wDPrimDetWHypN2 = wDMortPhytWHypN2 + wDLossPhytHypN2;
wO2RespPhytWHypN2 = molO2molCN2 * cCPerDWN2 * wDRespPhytWHypN2 * aCorO2BODHypN2;
wO2UptNO3PhytHypN2 = O2PerNO3N2 * molO2molNN2 * wNUptNO3PhytHypN2;
wPMortPhytPO4WHypN2 = fDissMortPhytN2 * wPMortPhytWHypN2;
wPMortPhytDetWHypN2 = wPMortPhytWHypN2 - wPMortPhytPO4WHypN2;
tPMortPhytPO4SN2 = fDissMortPhytN2 * tPMortPhytSN2;
tPMortPhytDetSN2 = tPMortPhytSN2 - tPMortPhytPO4SN2;
tPPrimPO4SN2 = tPExcrPhytSN2 + tPMortPhytPO4SN2;
tPPrimTotTN2 = 0.0;
wNMortPhytNH4WHypN2 = fDissMortPhytN2 * wNMortPhytWHypN2;
wNMortPhytDetWHypN2 = wNMortPhytWHypN2 - wNMortPhytNH4WHypN2;
wNLossPhytNH4HypN2 = fDissLossN2 * wNLossPhytHypN2;
wNLossPhytDetHypN2 = wNLossPhytHypN2 - wNLossPhytNH4HypN2;
wNPrimNH4WHypN2 = - wNUptNH4PhytHypN2 + wNExcrPhytWHypN2 + wNLossPhytNH4HypN2 + wNMortPhytNH4WHypN2;
wNPrimNO3WHypN2 = - wNUptNO3PhytHypN2;
wNPrimDetWHypN2 = wNLossPhytDetHypN2 + wNMortPhytDetWHypN2;
tNMortPhytNH4SN2 = fDissMortPhytN2 * tNMortPhytSN2;
tNMortPhytDetSN2 = tNMortPhytSN2 - tNMortPhytNH4SN2;
tNPrimNH4SN2 = tNExcrPhytSN2 + tNMortPhytNH4SN2;
tNPrimNO3SN2 = 0.0;
tNPrimTotTN2 = 0.0;
tSiExcrDiatSN2 = cSiDDiatN2 * tDRespDiatSN2 ;
tSiMortDiatSN2 = cSiDDiatN2 * tDMortDiatSN2;
wSiPrimSiO2WHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wSiExcrDiatWHypN2 - wSiUptDiatHypN2 + tSiExcrDiatSN2 / uDepthWHypN2 ENDIF;
wSiPrimDetWHypN2 = wSiMortDiatWHypN2 + wSiLossDiatHypN2;
tSiPrimTotTN2 = 0.0;
aPACoefEpiN2 = cPACoefMinN2 +(cPACoefMaxN2 - cPACoefMinN2) * hPACoefN2 / (hPACoefN2 + oDOMWEpiN2);
aPACoefHypN2 = cPACoefMinN2 +(cPACoefMaxN2 - cPACoefMinN2) * hPACoefN2 / (hPACoefN2 + oDOMWHypN2);
bSecchiMaxEpiN2 = uDepthWEpiN2;
aSecchiEpiN2 = MIN(bSecchiMaxEpiN2,aPACoefEpiN2 / aExtCoefOpenEpiN2);
aTransparencyEpiN2 = aSecchiEpiN2 / uDepthWEpiN2;
bSecchiMaxHypN2 = uDepthWHypN2 + cSecchiPlusN2;
aSecchiHypN2 = IF ( aInclStratN2 EQ TRUE AND uDepthWEpiN2 LE aPACoefEpiN2 / aExtCoefOpenEpiN2 ) THEN MIN(bSecchiMaxHypN2,aPACoefHypN2 / aExtCoefOpenHypN2 - aSecchiEpiN2) ELSEIF ( aInclStratN2 EQ TRUE AND uDepthWEpiN2 GT aPACoefEpiN2 / aExtCoefOpenEpiN2) THEN 0.0 ELSE MIN(bSecchiMaxHypN2,aPACoefHypN2 / aExtCoefOpenHypN2) ENDIF;
aSecchiTN2 = IF ( aInclStratN2 EQ TRUE ) THEN aSecchiEpiN2 +aSecchiHypN2 ELSE aSecchiEpiN2 ENDIF;
aTransparencyHypN2 = aSecchiHypN2 / uDepthWHypN2;
aTransparencyTN2 = IF ( aInclStratN2 EQ TRUE ) THEN aSecchiTN2 / uDepthWN2 ELSE aSecchiTN2 / uDepthWHypN2 ENDIF;
aDepthEuphHypN2 = cEuphN2 * aSecchiHypN2;
aRelDepthEuphHypN2 = aDepthEuphHypN2 / uDepthWHypN2;
aChlaHHypN2 = oChlaHypN2 * uDepthWHypN2;
aCovPhytWHypN2 = cCovSpPhytN2 *(oDPhytWHypN2 * uDepthWHypN2);
rExtChPhytHypN2 = aExtPhytHypN2 /(oChlaHypN2 / mgPergN2 + NearZeroN2);
uFunTmZooHypN2 = EXP(-0.5/(cSigTmZooN2*cSigTmZooN2) *((uTmHypN2-cTmOptZooN2)*(uTmHypN2-cTmOptZooN2) -(cTmRefN2-cTmOptZooN2)*(cTmRefN2-cTmOptZooN2)));
uFunTmZooEpiN2 = EXP(-0.5/(cSigTmZooN2*cSigTmZooN2) *((uTmEpiN2-cTmOptZooN2)*(uTmEpiN2-cTmOptZooN2) -(cTmRefN2-cTmOptZooN2)*(cTmRefN2-cTmOptZooN2)));
rPDZooHypN2 = oPZooHypN2 /(oDZooHypN2+NearZeroN2);
rNDZooHypN2 = oNZooHypN2/(oDZooHypN2+NearZeroN2);
oDFoodZooHypN2 = cPrefDiatN2 * oDDiatWHypN2 + cPrefGrenN2 * oDGrenWHypN2 + cPrefBlueN2 * oDBlueWHypN2 + cPrefDetN2 * oDDetWHypN2;
aFiltHypN2 = cFiltMaxN2 * uFunTmZooHypN2 * hFiltN2 /(hFiltN2 + oDOMWHypN2);
ukDAssTmZooHypN2 = fDAssZooN2 * cFiltMaxN2 * uFunTmZooHypN2 * hFiltN2;
ukDAssTmZooEpiN2 = fDAssZooN2 * cFiltMaxN2 * uFunTmZooEpiN2 * hFiltN2;
aDSatZooHypN2 = oDFoodZooHypN2 /(hFiltN2 + oDOMWHypN2);
ukDRespTmZooHypN2 = kDRespZooN2 * uFunTmZooHypN2;
ukDRespTmZooEpiN2 = kDRespZooN2 * uFunTmZooEpiN2;
ukDIncrZooHypN2 = ukDAssTmZooHypN2 - ukDRespTmZooHypN2 - kMortZooN2;
ukDIncrZooEpiN2 = ukDAssTmZooEpiN2 - ukDRespTmZooEpiN2 - kMortZooN2;
wDEnvZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE MAX(0.0,ukDIncrZooHypN2 / cDCarrZooN2 * oDZooHypN2*oDZooHypN2) ENDIF;
wDAssZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aDSatZooHypN2 *(ukDAssTmZooHypN2 * oDZooHypN2 - wDEnvZooHypN2) ENDIF;
wDConsZooHypN2 = wDAssZooHypN2 / fDAssZooN2;
wDConsDetZooHypN2 = cPrefDetN2*oDDetWHypN2 / oDFoodZooHypN2 * wDConsZooHypN2;
wDConsDiatZooHypN2 = cPrefDiatN2*oDDiatWHypN2 / oDFoodZooHypN2 * wDConsZooHypN2;
wDConsGrenZooHypN2 = cPrefGrenN2*oDGrenWHypN2 / oDFoodZooHypN2 * wDConsZooHypN2;
wDConsBlueZooHypN2 = cPrefBlueN2*oDBlueWHypN2 / oDFoodZooHypN2 * wDConsZooHypN2;
wDConsPhytZooHypN2 = wDConsDiatZooHypN2 + wDConsGrenZooHypN2 + wDConsBlueZooHypN2;
wDEgesZooHypN2 = wDConsZooHypN2 - wDAssZooHypN2;
aCorDRespZooHypN2 = MAX(cPDZooRefN2 / rPDZooHypN2,cNDZooRefN2 / rNDZooHypN2);
wDRespZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aCorDRespZooHypN2 * ukDRespTmZooHypN2 * oDZooHypN2 ENDIF;
wDMortZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kMortZooN2 * oDZooHypN2 +(1.0 - aDSatZooHypN2) * wDEnvZooHypN2 ENDIF;
oPFoodZooHypN2 = cPrefDiatN2*oPDiatWHypN2 + cPrefGrenN2*oPGrenWHypN2 + cPrefBlueN2*oPBlueWHypN2 + cPrefDetN2 * oPDetWHypN2;
rPDFoodZooHypN2 = oPFoodZooHypN2 /(oDFoodZooHypN2+NearZeroN2);
wPConsDiatZooHypN2 = rPDDiatWHypN2 * wDConsDiatZooHypN2;
wPConsBlueZooHypN2 = rPDBlueWHypN2 * wDConsBlueZooHypN2;
wPConsDetZooHypN2 = rPDDetWHypN2 * wDConsDetZooHypN2;
afPAssZooHypN2 = MIN(1.0,cPDZooRefN2 / rPDFoodZooHypN2 * fDAssZooN2);
akPExcrZooHypN2 = rPDZooHypN2 / cPDZooRefN2 * kDRespZooN2 * uFunTmZooHypN2;
wPExcrZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE akPExcrZooHypN2*oPZooHypN2 ENDIF;
wPMortZooHypN2 = rPDZooHypN2 * wDMortZooHypN2;
wPMortZooPO4HypN2 = fDissMortZooN2 * wPMortZooHypN2;
wPMortZooDetHypN2 = wPMortZooHypN2 - wPMortZooPO4HypN2;
oNFoodZooHypN2 = cPrefDiatN2*oNDiatWHypN2 + cPrefGrenN2*oNGrenWHypN2 + cPrefBlueN2*oNBlueWHypN2 + cPrefDetN2*oNDetWHypN2;
rNDFoodZooHypN2 = oNFoodZooHypN2 /(oDFoodZooHypN2+NearZeroN2);
wNConsDiatZooHypN2 = rNDDiatWHypN2*wDConsDiatZooHypN2;
wNConsGrenZooHypN2 = rNDGrenWHypN2*wDConsGrenZooHypN2;
wNConsBlueZooHypN2 = rNDBlueWHypN2*wDConsBlueZooHypN2;
wNConsPhytZooHypN2 = wNConsDiatZooHypN2 + wNConsGrenZooHypN2 + wNConsBlueZooHypN2;
wNConsDetZooHypN2 = rNDDetWHypN2*wDConsDetZooHypN2;
wNConsZooHypN2 = wNConsPhytZooHypN2 + wNConsDetZooHypN2;
afNAssZooHypN2 = MIN(1.0,cNDZooRefN2 / rNDFoodZooHypN2 * fDAssZooN2);
wNAssZooHypN2 = afNAssZooHypN2*wNConsZooHypN2;
wNEgesZooHypN2 = wNConsZooHypN2 - wNAssZooHypN2;
wNEgesZooNH4HypN2 = fDissEgesZooN2*wNEgesZooHypN2;
wNEgesZooDetHypN2 = wNEgesZooHypN2 - wNEgesZooNH4HypN2;
kNExcrZooHypN2 = rNDZooHypN2 / cNDZooRefN2 * kDRespZooN2 * uFunTmZooHypN2;
wNExcrZooHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE kNExcrZooHypN2*oNZooHypN2 ENDIF;
wNMortZooHypN2 = rNDZooHypN2*wDMortZooHypN2;
wNMortZooNH4HypN2 = fDissMortZooN2*wNMortZooHypN2;
wNMortZooDetHypN2 = wNMortZooHypN2 - wNMortZooNH4HypN2;
wSiConsDiatZooHypN2 = cSiDDiatN2 * wDConsDiatZooHypN2;
uFunTmBentN2 = EXP(-0.5/(cSigTmBentN2*cSigTmBentN2) *((uTmBotN2-cTmOptBentN2)*(uTmBotN2-cTmOptBentN2) - (cTmRefN2-cTmOptBentN2)*(cTmRefN2-cTmOptBentN2)));
aDFoodBentN2 = aDDetSN2 + aDPhytSN2;
rPDBentN2 = aPBentN2 /(aDBentN2+NearZeroN2);
rNDBentN2 = aNBentN2 /(aDBentN2+NearZeroN2);
tDMigrBentN2 = kMigrBentN2 *(cDBentInN2 - aDBentN2);
aDSatBentN2 = aDFoodBentN2 /(hDFoodBentN2 + aDFoodBentN2);
ukDIncrBentN2 = (kDAssBentN2 - kDRespBentN2) * uFunTmBentN2 - kMortBentN2;
tDEnvBentN2 = MAX(0.0,ukDIncrBentN2 / cDCarrBentN2 * aDBentN2*aDBentN2);
tDAssBentN2 = aDSatBentN2 *(kDAssBentN2 * uFunTmBentN2 * aDBentN2 - tDEnvBentN2);
aDAssBentSpN2 = tDAssBentN2 / aDBentN2;
tDConsBentN2 = tDAssBentN2 / fDAssBentN2;
tDConsDetBentN2 = aDDetSN2 / aDFoodBentN2 * tDConsBentN2;
tDConsDiatBentN2 = aDDiatSN2 / aDFoodBentN2 * tDConsBentN2;
tDConsGrenBentN2 = aDGrenSN2 / aDFoodBentN2 * tDConsBentN2;
tDConsBlueBentN2 = aDBlueSN2 / aDFoodBentN2 * tDConsBentN2;
tDConsPhytBentN2 = tDConsDiatBentN2 + tDConsGrenBentN2 + tDConsBlueBentN2;
tDEgesBentN2 = tDConsBentN2 - tDAssBentN2;
tDRespBentN2 = (cPDBentRefN2 / rPDBentN2) * kDRespBentN2 * uFunTmBentN2 * aDBentN2;
tDMortBentN2 = kMortBentN2*aDBentN2 +(1.0 - aDSatBentN2) * tDEnvBentN2;
aPFoodBentN2 = aPDetSN2 + aPPhytSN2;
rPDFoodBentN2 = aPFoodBentN2 /(aDFoodBentN2+NearZeroN2);
tPConsDetBentN2 = rPDDetSN2 * tDConsDetBentN2;
tPConsDiatBentN2 = rPDDiatSN2 * tDConsDiatBentN2;
tPConsGrenBentN2 = rPDGrenSN2 * tDConsGrenBentN2;
tPConsBlueBentN2 = rPDBlueSN2 * tDConsBlueBentN2;
tPConsPhytBentN2 = tPConsDiatBentN2 + tPConsGrenBentN2 + tPConsBlueBentN2;
tPConsBentN2 = tPConsDetBentN2 + tPConsPhytBentN2;
afPAssBentN2 = MIN(1.0,cPDBentRefN2 / rPDFoodBentN2 * fDAssBentN2);
tPAssBentN2 = afPAssBentN2 * tPConsBentN2;
tPEgesBentN2 = tPConsBentN2 - tPAssBentN2;
tPEgesBentPO4N2 = fDissEgesBentN2 * tPEgesBentN2;
tPEgesBentDetN2 = (1.0 - fDissEgesBentN2) * tPEgesBentN2;
tPExcrBentN2 = (rPDBentN2 / cPDBentRefN2) * kDRespBentN2 * uFunTmBentN2 * aPBentN2;
tPMortBentN2 = rPDBentN2 * tDMortBentN2;
tPMortBentPO4N2 = fDissMortBentN2 * tPMortBentN2;
tPMortBentDetN2 = (1.0-fDissMortBentN2)*tPMortBentN2;
tPMigrBentN2 = kMigrBentN2 *(cPDBentRefN2*cDBentInN2 - aPBentN2);
aNFoodBentN2 = aNDetSN2 + aNPhytSN2;
rNDFoodBentN2 = aNFoodBentN2 /(aDFoodBentN2+NearZeroN2);
tNMigrBentN2 = kMigrBentN2 *(cNDBentRefN2*cDBentInN2 - aNBentN2);
tNConsDetBentN2 = rNDDetSN2 * tDConsDetBentN2;
tNConsDiatBentN2 = rNDDiatSN2 * tDConsDiatBentN2;
tNConsGrenBentN2 = rNDGrenSN2 * tDConsGrenBentN2;
tNConsBlueBentN2 = rNDBlueSN2 * tDConsBlueBentN2;
tNConsPhytBentN2 = tNConsDiatBentN2 + tNConsGrenBentN2 + tNConsBlueBentN2;
tNConsBentN2 = tNConsDetBentN2 + tNConsPhytBentN2;
afNAssBentN2 = MIN(1.0,cNDBentRefN2 / rNDFoodBentN2 * fDAssBentN2);
tNAssBentN2 = afNAssBentN2 * tNConsBentN2;
tNEgesBentN2 = tNConsBentN2 - tNAssBentN2;
tNEgesBentNH4N2 = fDissEgesBentN2 * tNEgesBentN2;
tNEgesBentDetN2 = (1.0 - fDissEgesBentN2) * tNEgesBentN2;
tNExcrBentN2 = (rNDBentN2 / cNDBentRefN2) * kDRespBentN2 * uFunTmBentN2 * aNBentN2;
tNMortBentN2 = rNDBentN2 * tDMortBentN2;
tNMortBentNH4N2 = fDissMortBentN2*tNMortBentN2;
tNMortBentDetN2 = (1.0-fDissMortBentN2)*tNMortBentN2;
tSiConsDiatBentN2 = cSiDDiatN2 * tDConsDiatBentN2;
aFunVegFishN2 = MAX(0.0,1.0 - cRelVegFishN2 * aCovVegN2);
ukDIncrFiJvN2 = (kDAssFiJvN2 - kDRespFiJvN2) * uFunTmFishN2 - kMortFiJvN2;
aDSatFiAdN2 = (aFunVegFishN2 * aDBentN2) *(aFunVegFishN2 * aDBentN2) /(hDBentFiAdN2 * hDBentFiAdN2 + (aFunVegFishN2 * aDBentN2) *(aFunVegFishN2 * aDBentN2));
ukDIncrFiAdN2 = (kDAssFiAdN2 - kDRespFiAdN2) * uFunTmFishN2 - kMortFiAdN2;
ukHarvFishN2 = IF (COS(2.0 * PiN2 * sTimeN2 / DaysInYearN2) GT 0.1) THEN kHarvFishWinN2 ELSE kHarvFishSumN2 ENDIF;
afPAssFiAdN2 = MIN(1.0,cPDFishRefN2 / rPDBentN2 * fDAssFiAdN2);
afNAssFiAdN2 = MIN(1.0,cNDFishRefN2 / rNDBentN2 * fDAssFiAdN2);
uFunTmPiscN2 = EXP(-0.5 /(cSigTmPiscN2*cSigTmPiscN2) *((uTmEpiN2 - cTmOptPiscN2)*(uTmEpiN2 - cTmOptPiscN2) - (cTmRefN2 - cTmOptPiscN2)*(cTmRefN2 - cTmOptPiscN2)));
aDCarrPiscN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN MAX(cDCarrPiscMinN2,MIN(cDCarrPiscMaxN2,cDCarrPiscBareN2)) ELSEIF (aDShootPhraN2 LT cDPhraMinPiscN2) THEN cDCarrPiscMinN2 ELSEIF (aCovVegN2 LT cCovVegMinN2) THEN MAX(cDCarrPiscMinN2,MIN(cDCarrPiscMaxN2,fMarshN2 *(1.0/PerCentN2) * cRelPhraPiscN2)) ELSE MAX(cDCarrPiscMinN2,MIN(cDCarrPiscMaxN2,fMarshN2 *(1.0/PerCentN2) *(cRelPhraPiscN2 + cRelVegPiscN2))) ENDIF;
aFunVegPiscN2 = aDSubVegN2 /(hDVegPiscN2 + aDSubVegN2 + NearZeroN2);
akDIncrPiscN2 = (kDAssPiscN2 * aFunVegPiscN2 - kDRespPiscN2) * uFunTmPiscN2 - kMortPiscN2;
ukHarvPiscN2 = IF (COS(2.0*PiN2 * sTimeN2 / DaysInYearN2) GT 0.1) THEN kHarvPiscWinN2 ELSE kHarvPiscSumN2 ENDIF;
tDWebDetSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tDConsDetBentN2 + tDEgesBentN2 + tDMortBentN2 ENDIF;
tDWebDiatSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tDConsDiatBentN2 ENDIF;
tDWebGrenSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tDConsGrenBentN2 ENDIF;
tDWebBlueSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tDConsBlueBentN2 ENDIF;
tDWebPhytSN2 = tDWebDiatSN2 + tDWebGrenSN2 + tDWebBlueSN2;
tPWebPO4SN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tPExcrBentN2 + tPEgesBentPO4N2 + tPMortBentPO4N2 ENDIF;
tPWebDetSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tPConsDetBentN2 + tPEgesBentDetN2 + tPMortBentDetN2 ENDIF;
tPWebDiatSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tPConsDiatBentN2 ENDIF;
tPWebGrenSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tPConsGrenBentN2 ENDIF;
tPWebBlueSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tPConsBlueBentN2 ENDIF;
tPWebPhytSN2 = tPWebDiatSN2 + tPWebGrenSN2 + tPWebBlueSN2;
tNWebNH4SN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tNExcrBentN2 + tNEgesBentNH4N2 + tNMortBentNH4N2 ENDIF;
tNWebNO3SN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE 0.0 ENDIF;
tNWebDetSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tNConsDetBentN2 + tNEgesBentDetN2 + tNMortBentDetN2 ENDIF;
tNWebDiatSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tNConsDiatBentN2 ENDIF;
tNWebGrenSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tNConsGrenBentN2 ENDIF;
tNWebBlueSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - tNConsBlueBentN2 ENDIF;
tNWebPhytSN2 = tNWebDiatSN2 + tNWebGrenSN2 + tNWebBlueSN2;
wSiWebSiO2WN2 = 0.0;
wSiWebDetWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wSiConsDiatZooHypN2 ENDIF;
tSiWebDetSN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tSiConsDiatBentN2 ENDIF;
tSiWebTotTN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE 0.0 ENDIF;
aPrefAveHypN2 = (cPrefDiatN2 * oDDiatWHypN2 + cPrefGrenN2 * oDGrenWHypN2 + cPrefBlueN2 * oDBlueWHypN2 + cPrefDetN2 * oDDetWHypN2) / oDOMWHypN2;
wDConsZoo2HypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aFiltHypN2 * aPrefAveHypN2 * oDOMWHypN2 * oDZooHypN2 ENDIF;
aDConsZooSpHypN2 = wDConsZooHypN2 / oDZooHypN2;
aDAssZooSpHypN2 = wDAssZooHypN2 / oDZooHypN2;
aDGrazSpHypN2 = wDConsZooHypN2 / oDOMWHypN2;
aNConsZooSpHypN2 = wNConsZooHypN2 / oNZooHypN2;
aNGrazSpHypN2 = wNConsZooHypN2 / oNOMWHypN2;
afDShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDShootPhraN2 /(aDRootPhraN2 + aDShootPhraN2) ELSE 0.0 ENDIF;
rDSRPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDShootPhraN2/aDRootPhraN2 ELSE 0.0 ENDIF;
rPDShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPShootPhraN2/aDShootPhraN2 ELSE 0.0 ENDIF;
rNDShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNShootPhraN2/aDShootPhraN2 ELSE 0.0 ENDIF;
rPDRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aPRootPhraN2/aDRootPhraN2 ELSE 0.0 ENDIF;
rNDRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNRootPhraN2/aDRootPhraN2 ELSE 0.0 ENDIF;
aLengShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aDShootPhraN2 / cDStemPhraN2 / cDensStemPhraN2 ELSE 0.0 ENDIF;
bDayInitPhraN2 = IF (DayN2 LT 1.0 OR sTimeN2 LT StartTimeN2 + 1.0) THEN 367 ELSEIF (uTmEpiN2 GE cTmInitPhraN2 AND bDayInitPhraN2 GT 366) THEN DayN2 ELSE bDayInitPhraN2 ENDIF;
aDAllPhraN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (DayN2 LT bDayInitPhraN2) THEN 0.0 ELSEIF (DayN2 LE bDayInitPhraN2 + 1.0 / kDAllPhraN2) THEN fDAllPhraN2 * aDRootPhraN2 ELSE 0.0 ENDIF;
tDAllPhraN2 = IF (FALSE EQ InclSeasonN2) THEN 0.0 ELSEIF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (DayN2 LT bDayInitPhraN2) THEN 0.0 ELSEIF (DayN2 LE bDayInitPhraN2 + 1.0 / kDAllPhraN2) THEN kDAllPhraN2 * aDAllPhraN2 ELSE 0.0 ENDIF;
tNTransPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rNDRootPhraN2 * tDAllPhraN2 ELSE 0.0 ENDIF;
tPTransPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rPDRootPhraN2 * tDAllPhraN2 ELSE 0.0 ENDIF;
aVNUptPhraMaxCrN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN MAX(0.0,cVNUptPhraMaxN2 * POW(cQ10ProdPhraN2 , (0.1 *(uTmEpiN2 - cTmRefN2))) *(cNDPhraMaxN2 - rNDRootPhraN2) /(cNDPhraMaxN2 - cNDPhraMinN2)) ELSE 0.0 ENDIF;
ahNUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVNUptPhraMaxCrN2 / cAffNUptPhraN2 ELSE 0.0 ENDIF;
aVNUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVNUptPhraMaxCrN2 * oNDissSMN2 /(ahNUptPhraSN2 + oNDissSMN2) ELSE 0.0 ENDIF;
tNUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVNUptPhraSN2 * aDRootPhraN2 ELSE 0.0 ENDIF;
tNUptNH4PhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aNH4SMN2 / aNDissSMN2 * tNUptPhraSN2 ELSE 0.0 ENDIF;
tNUptNO3PhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tNUptPhraSN2 - tNUptNH4PhraSN2 ELSE 0.0 ENDIF;
tNUptShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN afDShootPhraN2 * tNUptPhraSN2 ELSE 0.0 ENDIF;
tNUptRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tNUptPhraSN2 - tNUptShootPhraN2 ELSE 0.0 ENDIF;
aVPUptPhraMaxCrN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN MAX(0.0,cVPUptPhraMaxN2 * POW(cQ10ProdPhraN2 , (0.1 *(uTmEpiN2 - cTmRefN2))) *(cPDPhraMaxN2 - rPDRootPhraN2) /(cPDPhraMaxN2 - cPDPhraMinN2)) ELSE 0.0 ENDIF;
ahPUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVPUptPhraMaxCrN2 / cAffPUptPhraN2 ELSE 0.0 ENDIF;
aVPUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVPUptPhraMaxCrN2 * oPO4SMN2 /(ahPUptPhraSN2 + oPO4SMN2) ELSE 0.0 ENDIF;
tPUptPhraSN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aVPUptPhraSN2 * aDRootPhraN2 ELSE 0.0 ENDIF;
tPUptShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN afDShootPhraN2 * tPUptPhraSN2 ELSE 0.0 ENDIF;
tPUptRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tPUptPhraSN2 - tPUptShootPhraN2 ELSE 0.0 ENDIF;
uFunTmProdPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN POW(cQ10ProdPhraN2 , (0.1 *(uTmEpiN2 - cTmRefN2))) ELSE 0.0 ENDIF;
ukDRespTmPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDRespPhraN2 * POW(cQ10RespPhraN2 , (0.1 *(uTmEpiN2 - cTmRefN2))) ELSE 0.0 ENDIF;
aMuPhotPhraN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (aLengShootPhraN2 GE uDepthWMN2) THEN cMuPhraMaxN2 * uFunTmProdPhraN2 * ufDayN2 ELSE 0.0 ENDIF;
aNLimProdPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (1.0 - cNDPhraMinN2 / rNDRootPhraN2) * cNDPhraMaxN2 /(cNDPhraMaxN2 - cNDPhraMinN2) ELSE 0.0 ENDIF;
aPLimProdPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (1.0 - cPDPhraMinN2 / rPDRootPhraN2) * cPDPhraMaxN2 /(cPDPhraMaxN2 - cPDPhraMinN2) ELSE 0.0 ENDIF;
aNutLimPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN MIN(aNLimProdPhraN2,aPLimProdPhraN2) ELSE 0.0 ENDIF;
aMuPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aMuPhotPhraN2 * aNutLimPhraN2 ELSE 0.0 ENDIF;
akDIncrPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aMuPhotPhraN2 - ukDRespTmPhraN2 - kDMortShootPhraN2 ELSE 0.0 ENDIF;
tDDensPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN MAX(0.0,akDIncrPhraN2 / cDShootPhraMaxN2 * aDShootPhraN2 * aDShootPhraN2) ELSE 0.0 ENDIF;
tDDensProdPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aMuPhraN2 / cMuPhraMaxN2 * tDDensPhraN2 ELSE 0.0 ENDIF;
tDProdPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN aMuPhraN2 * aDShootPhraN2 - tDDensProdPhraN2 ELSE 0.0 ENDIF;
tDProdShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN afDShootPhraN2 * tDProdPhraN2 ELSE 0.0 ENDIF;
tDProdRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDProdPhraN2 - tDProdShootPhraN2 ELSE 0.0 ENDIF;
tDRespShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ukDRespTmPhraN2 * aDShootPhraN2 ELSE 0.0 ENDIF;
tDRespRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN ukDRespTmPhraN2 * aDRootPhraN2 ELSE 0.0 ENDIF;
tO2RespRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN molO2molCN2 * cCPerDWN2 * tDRespRootPhraN2 * afOxySedMN2 ELSE 0.0 ENDIF;
tO2FlowPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tO2RespRootPhraN2 ELSE 0.0 ENDIF;
bDayRealPhraN2 = IF (DayN2 LT 180.0) THEN 367 ELSEIF (ufDayN2 LE fDayWinN2 AND bDayRealPhraN2 GT 366) THEN DayN2 ELSE bDayRealPhraN2 ENDIF;
aDRealPhraN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (DayN2 LT bDayRealPhraN2) THEN 0.0 ELSEIF (DayN2 LE bDayRealPhraN2 + 1.0 / kDRealPhraN2) THEN fDRealPhraN2 * aDShootPhraN2 ELSE 0.0 ENDIF;
tDRealPhraN2 = IF (FALSE EQ InclSeasonN2) THEN 0.0 ELSEIF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (DayN2 LT bDayRealPhraN2) THEN 0.0 ELSEIF (DayN2 LE bDayRealPhraN2 + 1.0 / kDRealPhraN2) THEN kDRealPhraN2 * aDRealPhraN2 ELSE 0.0 ENDIF;
tNRetrPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rNDShootPhraN2 * tDRealPhraN2 ELSE 0.0 ENDIF;
tPRetrPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rPDShootPhraN2 * tDRealPhraN2 ELSE 0.0 ENDIF;
tDMortShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMortShootPhraN2 * aDShootPhraN2 ELSE 0.0 ENDIF;
tNMortShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rNDShootPhraN2 * tDMortShootPhraN2 ELSE 0.0 ENDIF;
tPMortShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rPDShootPhraN2 * tDMortShootPhraN2 ELSE 0.0 ENDIF;
tDMortRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kDMortRootPhraN2 * aDRootPhraN2 ELSE 0.0 ENDIF;
tNMortRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rNDRootPhraN2 * tDMortRootPhraN2 ELSE 0.0 ENDIF;
tPMortRootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN rPDRootPhraN2 * tDMortRootPhraN2 ELSE 0.0 ENDIF;
tDManShootPhraN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 GT NearZeroN2) THEN 0.0 ELSEIF ((DayN2 GE cDayManPhraN2) AND (DayN2 LT cDayManPhraN2 + 1.0)) THEN fManPhraN2 * aDShootPhraN2 ELSE 0.0 ENDIF;
tNManShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDManShootPhraN2 * rNDShootPhraN2 ELSE 0.0 ENDIF;
tPManShootPhraN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDManShootPhraN2 * rPDShootPhraN2 ELSE 0.0 ENDIF;
tDIMSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDSetIMMN2 ELSE 0.0 ENDIF;
tDHumSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN fRefrDetSN2 * tDMinDetSMN2 - tDMinHumSMN2 ELSE 0.0 ENDIF;
tDDetSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN tDSetDetMN2 - tDMinDetSMN2 + tDSetPhytMN2 + tDMortRootPhraN2 ELSE 0.0 ENDIF;
vDeltaSMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (tDIMSMN2 / cRhoIMN2 +(tDHumSMN2 + tDDetSMN2) / cRhoOMN2)/(1.0 - bPorSN2) ELSE 0.0 ENDIF;
tDBurIMMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN ((tDHumSMN2 + tDDetSMN2) +(cRhoOMN2 / cRhoIMN2) * tDIMSMN2) / ((aDHumSMN2 + aDDetSMN2) / aDIMSMN2 + cRhoOMN2 / cRhoIMN2) ELSE ((tDHumSMN2 + tDDetSMN2) +(cRhoOMN2 / cRhoIMN2) * tDIMSMN2) / (fDOrgSoilN2 /(1.0 - fDOrgSoilN2) + cRhoOMN2 / cRhoIMN2) ENDIF;
tDBurOMMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN (aDHumSMN2 + aDDetSMN2) / aDIMSMN2 * tDBurIMMN2 ELSE fDOrgSoilN2 /(1.0 - fDOrgSoilN2) * tDBurIMMN2 ENDIF;
tDBurDetMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN aDDetSMN2 /(aDHumSMN2 + aDDetSMN2) * tDBurOMMN2 ELSE 0.0 ENDIF;
tDBurHumMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN tDBurOMMN2 - tDBurDetMN2 ELSE tDBurOMMN2 ENDIF;
tDBurTotMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN tDBurIMMN2 + tDBurOMMN2 ELSE tDBurIMMN2 + tDBurOMMN2 ENDIF;
tPBurHumMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN rPDHumSMN2 * tDBurHumMN2 ELSE cPDSoilOMN2 * tDBurHumMN2 ENDIF;
tPBurDetMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN rPDDetSMN2 * tDBurDetMN2 ELSE 0.0 ENDIF;
tPBurAIMMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN aPAIMSMN2 / aDIMSMN2 * tDBurIMMN2 ELSE 0.0 ENDIF;
tPBurPO4MN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN aPO4SMN2 *(vDeltaSMN2 / cDepthSMN2) ELSE cPO4GroundN2 *(bPorSMN2 * vDeltaSMN2) ENDIF;
tPBurTotMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN tPBurDetMN2 + tPBurHumMN2 + tPBurAIMMN2 + tPBurPO4MN2 ELSE tPBurHumMN2 + tPBurAIMMN2 + tPBurPO4MN2 ENDIF;
tNBurHumMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN rNDHumSMN2 * tDBurHumMN2 ELSE cNDSoilOMN2 * tDBurHumMN2 ENDIF;
tNBurDetMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN rNDDetSMN2 * tDBurDetMN2 ELSE 0.0 ENDIF;
tNBurNH4MN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN aNH4SMN2 *(vDeltaSMN2 / cDepthSMN2) ELSE cNH4GroundN2 *(bPorSMN2 * vDeltaSMN2) ENDIF;
tNBurNO3MN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN aNO3SMN2 *(vDeltaSMN2 / cDepthSMN2) ELSE cNO3GroundN2 *(bPorSMN2 * vDeltaSMN2) ENDIF;
tNBurTotMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN tNBurDetMN2 + tNBurHumMN2 + tNBurNH4MN2 + tNBurNO3MN2 ELSE tNBurHumMN2 + tNBurNH4MN2 + tNBurNO3MN2 ENDIF;
tSiBurDetMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN rSiDDetSMN2 * tDBurDetMN2 ELSE 0.0 ENDIF;
tSiBurTotMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (vDeltaSMN2 GE 0.0) THEN tSiBurDetMN2 ELSE 0.0 ENDIF;
vDeltaWMN2 = IF (FALSE EQ InclMarshN2 OR fMarshN2 LE NearZeroN2) THEN 0.0 ELSEIF (ConstDepthN2 EQ TRUE) THEN 0.0 ELSE - vDeltaSMN2 ENDIF;
aRelDeltaWMN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN vDeltaWMN2 / uDepthWMN2 ELSE 0.0 ENDIF;
bTimeDredN2 = IF (sTimeN2 GE cDredStartN2 * DaysPerYearN2) THEN (FLOOR(TimeYearsN2/cDredIntervalN2) * cDredIntervalN2) * DaysPerYearN2 ELSE -9999.999 ENDIF;
bRhoSolidSoilN2 = fDOrgSoilN2 * cRhoOMN2 +(1.0 - fDOrgSoilN2) * cRhoIMN2;
tDMarsTotTN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (- tDBurTotMN2 - wDMinDetWMN2 * uDepthWMN2 -(1.0 - fRefrDetSN2) * tDMinDetSMN2 - tDMinHumSMN2 + tDProdPhraN2 - tDRespShootPhraN2 - tDRespRootPhraN2 - tDManShootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
tPMarsTotTN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (- tPInfPO4SMN2 + tPSeepPO4SMN2 - tPDifGroundPO4MN2 - tPBurTotMN2 - tPChemPO4MN2 - tPManShootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
tNMarsTotTN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN (- tNInfNH4SMN2 + tNSeepNH4SMN2 - tNInfNO3SMN2 + tNSeepNO3SMN2 - tNDifGroundNO3MN2 - tNDifGroundNH4MN2 - tNBurTotMN2 - wNDenitWMN2 * uDepthWMN2 - tNDenitSMN2 - tNManShootPhraN2) * fMarshN2 ELSE 0.0 ENDIF;
tSiMarsTotTN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN - tSiBurDetMN2 * fMarshN2 - tInfSiO2WMN2 + tSeepSiO2WMN2 ELSE 0.0 ENDIF;
uTauSubstEpiN2 = 1.0 / (ukOutEpiN2+NearZeroN2);
akExchMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN kExchMaxMN2 * hfMarshN2 /(hfMarshN2 + fMarshN2)  ELSE 0.0 ENDIF;
afVolMarshEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN fMarshN2 * uDepthWMN2 / uDepthWEpiN2 ELSE 0.0 ENDIF;
akExchLEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 * afVolMarshEpiN2 ELSE 0.0 ENDIF;
oPPhytWEpiN2 = oPDiatWEpiN2 + oPGrenWEpiN2 + oPBlueWEpiN2;
oNPhytWEpiN2 = oNDiatWEpiN2 + oNGrenWEpiN2 + oNBlueWEpiN2;
oDSestWEpiN2 = oDOMWEpiN2 + oDIMWEpiN2;
oPOMWEpiN2 = oPPhytWEpiN2 + oPDetWEpiN2;
oPSestWEpiN2 = oPPhytWEpiN2 + oPDetWEpiN2 + oPAIMWEpiN2;
oPInorgWEpiN2 = oPO4WEpiN2 + oPAIMWEpiN2;
oPTotWEpiN2 = oPSestWEpiN2 + oPO4WEpiN2;
oNOMWEpiN2 = oNPhytWEpiN2 + oNDetWEpiN2;
oNSestWEpiN2 = oNOMWEpiN2;
oNkjWEpiN2 = oNSestWEpiN2 + oNH4WEpiN2;
oNTotWEpiN2 = oNkjWEpiN2 + oNO3WEpiN2;
rPDIMWEpiN2 = oPAIMWEpiN2 / oDIMWEpiN2;
rPDDetWEpiN2 = oPDetWEpiN2 / (oDDetWEpiN2+NearZeroN2);
rNDDetWEpiN2 = oNDetWEpiN2 / (oDDetWEpiN2+NearZeroN2);
rSiDDetWEpiN2 = oSiDetWEpiN2 / (oDDetWEpiN2+NearZeroN2);
wDDilIMEpiN2 = ukOutEpiN2 * oDIMWEpiN2;
wDDilDetEpiN2 = ukOutEpiN2 * oDDetWEpiN2;
wDDilDiatEpiN2 = ukOutEpiN2 * oDDiatWEpiN2;
wDDilGrenEpiN2 = ukOutEpiN2 * oDGrenWEpiN2;
wDDilBlueEpiN2 = ukOutEpiN2 * oDBlueWEpiN2;
wDDilPhytEpiN2 = wDDilDiatEpiN2 + wDDilGrenEpiN2 + wDDilBlueEpiN2;
wDDilZooEpiN2 = ukOutEpiN2 * oDZooEpiN2;
wPDilZooEpiN2 = ukOutEpiN2 * oPZooEpiN2;
wNDilZooEpiN2 = ukOutEpiN2 * oNZooEpiN2;
wPDilPO4EpiN2 = ukOutEpiN2 * oPO4WEpiN2;
wPDilDetEpiN2 = ukOutEpiN2*oPDetWEpiN2;
wPDilAIMEpiN2 = ukOutEpiN2 * oPAIMWEpiN2;
wNDilNH4EpiN2 = ukOutEpiN2 * oNH4WEpiN2;
wNDilNO3EpiN2 = ukOutEpiN2 * oNO3WEpiN2;
wNDilDetEpiN2 = ukOutEpiN2 * oNDetWEpiN2;
uO2LoadEpiN2 = IF (ReadTranFracN2 EQ TRUE) THEN mO2LoadEpiN2 ELSE cO2InN2 * uQInEpiN2 / mmPermN2 ENDIF;
wO2OutflEpiN2 = ukOutEpiN2 * oO2WEpiN2;
wPDilDiatEpiN2 = ukOutEpiN2 * oPDiatWEpiN2;
wNDilDiatEpiN2 = ukOutEpiN2 * oNDiatWEpiN2;
wPDilGrenEpiN2 = ukOutEpiN2 * oPGrenWEpiN2;
wNDilGrenEpiN2 = ukOutEpiN2 * oNGrenWEpiN2;
wPDilBlueEpiN2 = ukOutEpiN2 * oPBlueWEpiN2;
wNDilBlueEpiN2 = ukOutEpiN2 * oNBlueWEpiN2;
wPDilPhytEpiN2 = wPDilDiatEpiN2 + wPDilGrenEpiN2 + wPDilBlueEpiN2;
wNDilPhytEpiN2 = wNDilDiatEpiN2 + wNDilGrenEpiN2 + wNDilBlueEpiN2;
wDOutflTotEpiN2 = ukOutEpiN2 * oDSestWEpiN2;
wPOutflTotEpiN2 = ukOutEpiN2 * oPTotWEpiN2;
wNOutflTotEpiN2 = ukOutEpiN2 * oNTotWEpiN2;
wSiDilSiO2EpiN2 = ukOutEpiN2 * oSiO2WEpiN2;
wSiDilDetEpiN2 = ukOutEpiN2 * oSiDetWEpiN2;
wSiDilDiatEpiN2 = cSiDDiatN2 * wDDilDiatEpiN2;
wSiOutflTotEpiN2 = ukOutEpiN2 * (oSiO2WEpiN2 + oSiDetWEpiN2 + cSiDDiatN2 * oDDiatWEpiN2);
wDDilTotEpiN2 = wDDilIMEpiN2 + wDDilDetEpiN2 + wDDilPhytEpiN2;
wPDilTotEpiN2 = wPDilDetEpiN2 + wPDilPO4EpiN2 + wPDilAIMEpiN2 + wPDilPhytEpiN2;
wNDilTotEpiN2 = wNDilDetEpiN2 + wNDilNO3EpiN2 + wNDilNH4EpiN2 + wNDilPhytEpiN2;
wSiDilTotEpiN2 = wSiDilDetEpiN2 + wSiDilSiO2EpiN2 + wSiDilDiatEpiN2;
tSiTranTotTEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadEpiN2 - wSiDilTotEpiN2 * uDepthWEpiN2 ENDIF;
tDTranTotTEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadEpiN2 - wDDilTotEpiN2 * uDepthWEpiN2 ENDIF;
tPTranTotTEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadEpiN2 - wPDilTotEpiN2 * uDepthWEpiN2 ENDIF;
tNTranTotTEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadEpiN2 - wNDilTotEpiN2 * uDepthWEpiN2 ENDIF;
wDExchIMMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDIMWEpiN2 - oDIMWMN2) ELSE 0.0 ENDIF;
wPExchPO4MEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPO4WEpiN2 - oPO4WMN2) ELSE 0.0 ENDIF;
wPExchAIMMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPAIMWEpiN2 - oPAIMWMN2) ELSE 0.0 ENDIF;
wNExchNH4MEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNH4WEpiN2 - oNH4WMN2) ELSE 0.0 ENDIF;
wNExchNO3MEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNO3WEpiN2 - oNO3WMN2) ELSE 0.0 ENDIF;
wSiExchSiO2MEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oSiO2WEpiN2 - oSiO2WMN2) ELSE 0.0 ENDIF;
wO2ExchMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oO2WEpiN2 - oO2WMN2) ELSE 0.0 ENDIF;
wDExchDetMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDDetWEpiN2 - oDDetWMN2) ELSE 0.0 ENDIF;
wPExchDetMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPDetWEpiN2 - oPDetWMN2) ELSE 0.0 ENDIF;
wNExchDetMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNDetWEpiN2 - oNDetWMN2) ELSE 0.0 ENDIF;
wSiExchDetMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oSiDetWEpiN2 - oSiDetWMN2) ELSE 0.0 ENDIF;
wDExchDiatMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDDiatWEpiN2 - oDDiatWMN2) ELSE 0.0 ENDIF;
wPExchDiatMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPDiatWEpiN2 - oPDiatWMN2) ELSE 0.0 ENDIF;
wNExchDiatMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNDiatWEpiN2 - oNDiatWMN2) ELSE 0.0 ENDIF;
wSiExchDiatMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cSiDDiatN2 * wDExchDiatMEpiN2 ELSE 0.0 ENDIF;
wDExchGrenMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDGrenWEpiN2 - oDGrenWMN2) ELSE 0.0 ENDIF;
wPExchGrenMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPGrenWEpiN2 - oPGrenWMN2) ELSE 0.0 ENDIF;
wNExchGrenMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNGrenWEpiN2 - oNGrenWMN2) ELSE 0.0 ENDIF;
wDExchBlueMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDBlueWEpiN2 - oDBlueWMN2) ELSE 0.0 ENDIF;
wPExchBlueMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPBlueWEpiN2 - oPBlueWMN2) ELSE 0.0 ENDIF;
wNExchBlueMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNBlueWEpiN2 - oNBlueWMN2) ELSE 0.0 ENDIF;
wDExchZooMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oDZooEpiN2 - oDZooMN2) ELSE 0.0 ENDIF;
wPExchZooMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oPZooEpiN2 - oPZooMN2) ELSE 0.0 ENDIF;
wNExchZooMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchMEpiN2 *(oNZooEpiN2 - oNZooMN2) ELSE 0.0 ENDIF;
wDExchIMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDIMWEpiN2 - oDIMWMN2) ELSE 0.0 ENDIF;
wPExchPO4EpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPO4WEpiN2 - oPO4WMN2) ELSE 0.0 ENDIF;
wPExchAIMEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPAIMWEpiN2 - oPAIMWMN2) ELSE 0.0 ENDIF;
wNExchNH4EpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNH4WEpiN2 - oNH4WMN2) ELSE 0.0 ENDIF;
wNExchNO3EpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNO3WEpiN2 - oNO3WMN2) ELSE 0.0 ENDIF;
wSiExchSiO2EpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oSiO2WEpiN2 - oSiO2WMN2) ELSE 0.0 ENDIF;
wO2ExchEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oO2WEpiN2 - oO2WMN2) ELSE 0.0 ENDIF;
wDExchDetEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDDetWEpiN2 - oDDetWMN2) ELSE 0.0 ENDIF;
wPExchDetEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPDetWEpiN2 - oPDetWMN2) ELSE 0.0 ENDIF;
wNExchDetEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNDetWEpiN2 - oNDetWMN2) ELSE 0.0 ENDIF;
wSiExchDetEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oSiDetWEpiN2 - oSiDetWMN2) ELSE 0.0 ENDIF;
wDExchDiatEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDDiatWEpiN2 - oDDiatWMN2) ELSE 0.0 ENDIF;
wPExchDiatEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPDiatWEpiN2 - oPDiatWMN2) ELSE 0.0 ENDIF;
wNExchDiatEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNDiatWEpiN2 - oNDiatWMN2) ELSE 0.0 ENDIF;
wSiExchDiatEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN cSiDDiatN2 * wDExchDiatEpiN2 ELSE 0.0 ENDIF;
wDExchGrenEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDGrenWEpiN2 - oDGrenWMN2) ELSE 0.0 ENDIF;
wPExchGrenEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPGrenWEpiN2 - oPGrenWMN2) ELSE 0.0 ENDIF;
wNExchGrenEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNGrenWEpiN2 - oNGrenWMN2) ELSE 0.0 ENDIF;
wDExchBlueEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDBlueWEpiN2 - oDBlueWMN2) ELSE 0.0 ENDIF;
wPExchBlueEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPBlueWEpiN2 - oPBlueWMN2) ELSE 0.0 ENDIF;
wNExchBlueEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNBlueWEpiN2 - oNBlueWMN2) ELSE 0.0 ENDIF;
wDExchZooEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oDZooEpiN2 - oDZooMN2) ELSE 0.0 ENDIF;
wPExchZooEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oPZooEpiN2 - oPZooMN2) ELSE 0.0 ENDIF;
wNExchZooEpiN2 = IF (InclMarshN2 EQ TRUE AND fMarshN2 GT NearZeroN2) THEN akExchLEpiN2 *(oNZooEpiN2 - oNZooMN2) ELSE 0.0 ENDIF;
tInfSiO2WEpiN2 =IF (InclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oSiO2WEpiN2 ELSE 0.0 ENDIF;
tInfO2WEpiN2 =IF (InclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oO2WEpiN2 ELSE 0.0 ENDIF;
tPInfPO4WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oPO4WEpiN2 ELSE 0.0 ENDIF;
tNInfNH4WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNH4WEpiN2 ELSE 0.0 ENDIF;
tNInfNO3WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN2 GE 0.0) THEN uQOutInfN2 / mmPermN2 * oNO3WEpiN2 ELSE 0.0 ENDIF;
tSeepSiO2WEpiN2 =IF (InclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WEpiN2 =IF (InclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oPO4SN2 ELSE 0.0 ENDIF;
tNSeepNH4WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNH4SN2 ELSE 0.0 ENDIF;
tNSeepNO3WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN2 GE 0.0) THEN uQInSeepN2 / mmPermN2 * oNO3SN2 ELSE 0.0 ENDIF;
tSiAbioTotTN2 = - fRefrDetSN2 * tSiMinDetSN2 - tInfSiO2WHypN2 - tInfSiO2WEpiN2 + tSeepSiO2WHypN2 + tSeepSiO2WEpiN2;
tO2AerEpiN2 = kAerN2 * uFunTmAerEpiN2 * (uO2SatEpiN2 - oO2WEpiN2) * aFunFloatAerN2 * aFunBlueSurfAerN2;
tDTurbFishIMN2 = fLutumN2 * aDIMSN2 / (fLutumN2 * aDIMSN2 + aDDetSN2) * tDTurbFishN2;
uCorVSetIMEpiN2 = (aFunTauSetIMEpiN2+ uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * POW((fLutumRefN2/fLutumN2) , (0.5)) * uFunTmSetEpiN2 * cVSetIMN2;
tDSetIMEpiN2 = uCorVSetIMEpiN2 * oDIMWEpiN2;
tPSetAIMEpiN2 = oPAIMWEpiN2 / oDIMWEpiN2 * tDSetIMEpiN2;
uCorVSetDetEpiN2 = (cVSetDetN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMEpiN2 * uFunTmSetEpiN2;
tDSetDetEpiN2 = uCorVSetDetEpiN2 * oDDetWEpiN2;
tPSetDetEpiN2 = uCorVSetDetEpiN2 * oPDetWEpiN2;
tNSetDetEpiN2 = uCorVSetDetEpiN2 * oNDetWEpiN2;
tSiSetDetEpiN2 = uCorVSetDetEpiN2 * oSiDetWEpiN2;
wDMinDetWEpiN2 = kDMinDetWN2 * uFunTmMinWEpiN2 * oDDetWEpiN2;
wPMinDetWEpiN2 = kPMinDetWN2 * uFunTmMinWEpiN2 * oPDetWEpiN2;
wNMinDetWEpiN2 = kNMinDetWN2 * uFunTmMinWEpiN2 * oNDetWEpiN2;
wSiMinDetWEpiN2 = kSiMinDetWN2 * uFunTmMinWEpiN2 * oSiDetWEpiN2;
aCorO2BODEpiN2 = oO2WEpiN2 / (hO2BODN2 + oO2WEpiN2);
wO2MinDetWEpiN2 = molO2molCN2 * cCPerDWN2 * aCorO2BODEpiN2 * wDMinDetWEpiN2;
wDDenitWEpiN2 = oNO3WEpiN2*oNO3WEpiN2 / (hNO3DenitN2*hNO3DenitN2 + oNO3WEpiN2*oNO3WEpiN2) * (1.0 - aCorO2BODEpiN2) * wDMinDetWEpiN2;
wNDenitWEpiN2 = NO3PerCN2 * molNmolCN2 * cCPerDWN2 * wDDenitWEpiN2;
aCorO2NitrWEpiN2 = oO2WEpiN2*oO2WEpiN2 / (hO2NitrN2*hO2NitrN2 + oO2WEpiN2*oO2WEpiN2);
wNNitrWEpiN2 = kNitrWN2 * uFunTmNitrEpiN2 * aCorO2NitrWEpiN2 * oNH4WEpiN2;
wO2NitrWEpiN2 = O2PerNH4N2 * molO2molNN2 * wNNitrWEpiN2;
tDMinOxyDetSN2 = afOxySedN2 * (1.0 - fRefrDetSN2) * tDMinDetSN2;
tO2MinDetSN2 = molO2molCN2 * cCPerDWN2 * tDMinOxyDetSN2;
tDDenitSN2 = oNO3SN2*oNO3SN2 / (hNO3DenitN2*hNO3DenitN2 + oNO3SN2*oNO3SN2) * (1.0 - afOxySedN2) * (1.0 - fRefrDetSN2) * tDMinDetSN2;
tNDenitSN2 = NO3PerCN2 * molNmolCN2 * cCPerDWN2 * tDDenitSN2;
tNNitrSN2 = afOxySedN2 * kNitrSN2 * uFunTmNitrSN2 * aNH4SN2;
tO2NitrSN2 = O2PerNH4N2 * molO2molNN2 * tNNitrSN2;
tDMinHumSN2 = kDMinHumN2 * uFunTmMinSN2 * afOxySedN2 * aDHumSN2;
tPMinHumSN2 = kDMinHumN2 * uFunTmMinSN2 * afOxySedN2 * aPHumSN2;
tNMinHumSN2 = kDMinHumN2 * uFunTmMinSN2 * afOxySedN2 * aNHumSN2;
tPDifPO4EpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN 0.0 ELSE kPDifPO4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oPO4SN2 - oPO4WEpiN2 ) / aDepthDifN2 ENDIF;
tNDifNO3EpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN 0.0 ELSE kNDifNO3N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oNO3SN2 - oNO3WEpiN2 ) / aDepthDifN2 ENDIF;
tNDifNH4EpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN 0.0 ELSE kNDifNH4N2 * uFunTmDifN2 * cTurbDifNutN2 * bPorCorSN2 * (oNH4SN2 - oNH4WEpiN2 ) / aDepthDifN2 ENDIF;
tO2DifEpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN 0.0 ELSE kO2DifN2 / aDepthDifN2 * uFunTmDifN2 * cTurbDifO2N2 * bPorCorSN2 * oO2WEpiN2 ENDIF;
aPAdsMaxWEpiN2 = cRelPAdsDN2 + aCorO2BODEpiN2 * cRelPAdsFeN2 * fFeDIMN2 + cRelPAdsAlN2 * fAlDIMN2;
aKPAdsWEpiN2 = (1.0 - fRedMaxN2 * (1.0-aCorO2BODEpiN2)) * cKPAdsOxN2;
aPIsoAdsWEpiN2 = aPAdsMaxWEpiN2 * aKPAdsWEpiN2 * oPO4WEpiN2 / (1.0 + aKPAdsWEpiN2 * oPO4WEpiN2);
aPEqIMWEpiN2 = aPIsoAdsWEpiN2 * oDIMWEpiN2;
wPSorpIMWEpiN2 = kPSorpN2 * (aPEqIMWEpiN2 - oPAIMWEpiN2);
aPAdsMaxSN2 = cRelPAdsDN2 + afOxySedN2 * cRelPAdsFeN2 * fFeDIMN2 + cRelPAdsAlN2 * fAlDIMN2;
aKPAdsSN2 = (1.0 - fRedMaxN2 * (1.0-afOxySedN2)) * cKPAdsOxN2;
aPIsoAdsSN2 = aPAdsMaxSN2 * aKPAdsSN2 * oPO4SN2 / (1.0 + aKPAdsSN2 * oPO4SN2);
aPEqIMSN2 = aPIsoAdsSN2 * aDIMSN2;
tPSorpIMSN2 = kPSorpN2 * (aPEqIMSN2 - aPAIMSN2);
wO2AbioWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE tO2BubHypN2 / uDepthWHypN2 - wO2MinDetWHypN2 - wO2NitrWHypN2 - (tO2MinDetSN2 + tO2NitrSN2) / uDepthWHypN2 - (tInfO2WHypN2 / uDepthWHypN2) + (tSeepO2WHypN2 / uDepthWHypN2) ENDIF;
wPAbioDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE - wPMinDetWHypN2 - (tPSetDetHypN2 - tPSetDetEpiN2 - tPResusDetN2) / uDepthWHypN2 ENDIF;
wPAbioPO4WHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wPMinDetWHypN2 - wPSorpIMWHypN2 - (tPInfPO4WHypN2 / uDepthWHypN2) + ((tPSeepPO4WHypN2 + tPDifPO4HypN2 + tPResusPO4N2) / uDepthWHypN2) ENDIF;
wPAbioAIMWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (- tPSetAIMHypN2 +tPSetAIMEpiN2 + tPResusAIMN2) / uDepthWHypN2 + wPSorpIMWHypN2 ENDIF;
tPAbioTotTN2 = uPErosOMN2 - tPChemPO4N2 - tPInfPO4SN2 + tPSeepPO4SN2 - tPDifGroundPO4N2;
wNAbioNH4WHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNMinDetWHypN2 - wNNitrWHypN2 - (tNInfNH4WHypN2 / uDepthWHypN2) + ((tNSeepNH4WHypN2 + tNDifNH4HypN2 + tNResusNH4N2) / uDepthWHypN2) ENDIF;
wNAbioNO3WHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNNitrWHypN2 - wNDenitWHypN2 + ((tNDifNO3HypN2 + tNResusNO3N2 - tNInfNO3WHypN2 + tNSeepNO3WHypN2) / uDepthWHypN2) ENDIF;
wNAbioDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE - wNMinDetWHypN2 - (tNSetDetHypN2 -tNSetDetEpiN2 - tNResusDetN2 ) / uDepthWHypN2 ENDIF;
wSiAbioSiO2WHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wSiMinDetWHypN2 + (1.0 - fRefrDetSN2) * tSiMinDetSN2 / uDepthWHypN2 - tInfSiO2WHypN2 / uDepthWHypN2 + tSeepSiO2WHypN2 / uDepthWHypN2 ENDIF;
wSiAbioDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE - wSiMinDetWHypN2 - (tSiSetDetHypN2 -tSiSetDetEpiN2 - tSiResusDetN2) / uDepthWHypN2 ENDIF;
wDAbioDetWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (- tDSetDetHypN2 + tDSetDetEpiN2 + tDResusDetN2 ) / uDepthWHypN2 - wDMinDetWHypN2 ENDIF;
wDAbioIMWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (uDErosIMWN2 * fHypErosIMN2 - tDSetIMHypN2+ tDSetIMEpiN2 + tDResusIMN2) / uDepthWHypN2 ENDIF;
wDAbioIMWEpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN (uDErosIMWN2 * (1- fHypErosIMN2) - tDSetIMEpiN2 ) / uDepthWEpiN2 ELSE (uDErosIMWN2 * (1- fHypErosIMN2) - tDSetIMEpiN2 + tDResusIMN2) / uDepthWEpiN2 ENDIF;
wDAbioDetWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN (- tDSetDetEpiN2 ) / uDepthWEpiN2 - wDMinDetWEpiN2 ELSE (- tDSetDetEpiN2 + tDResusDetN2 ) / uDepthWEpiN2 - wDMinDetWEpiN2 ENDIF;
tDAbioIMSN2 = IF ( aInclStratN2 EQ TRUE ) THEN uDErosIMSN2 + tDSetIMHypN2 - tDResusIMN2 ELSE uDErosIMSN2 + tDSetIMEpiN2 - tDResusIMN2 ENDIF ;
tDAbioDetSN2 = IF ( aInclStratN2 EQ TRUE ) THEN tDSetDetHypN2 - tDResusDetN2 - tDMinDetSN2 ELSE tDSetDetEpiN2 - tDResusDetN2 - tDMinDetSN2 ENDIF ;
tDAbioHumSN2 = uDErosOMN2 + fRefrDetSN2 * tDMinDetSN2 - tDMinHumSN2;
tDAbioTotTN2 = cDErosTotN2 - wDMinDetWEpiN2 * uDepthWEpiN2 - wDMinDetWHypN2 * uDepthWHypN2 - (1.0 - fRefrDetSN2) * tDMinDetSN2 - tDMinHumSN2;
wO2AbioWEpiN2 = IF (aInclStratN2 EQ FALSE) THEN tO2AerEpiN2 / uDepthWEpiN2 - wO2MinDetWEpiN2 - wO2NitrWEpiN2 - (tO2MinDetSN2 + tO2NitrSN2) / uDepthWEpiN2 - tInfO2WEpiN2/uDepthWEpiN2 + tSeepO2WEpiN2/uDepthWEpiN2 ELSE tO2AerEpiN2 / uDepthWEpiN2 - wO2MinDetWEpiN2 - wO2NitrWEpiN2 ENDIF;
wO2AbioMN2 = tO2AerMN2 / uDepthWMN2 - wO2MinDetWMN2 - wO2NitrWMN2 - (tO2MinDetSMN2 + tO2NitrSMN2) / uDepthWMN2  - tInfO2WMN2 /uDepthWMN2  + tSeepO2WMN2 /uDepthWMN2 ;
wPAbioDetWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN - wPMinDetWEpiN2 - (tPSetDetEpiN2 ) / uDepthWEpiN2 ELSE - wPMinDetWEpiN2 - (tPSetDetEpiN2 - tPResusDetN2) / uDepthWEpiN2 ENDIF;
wPAbioPO4WEpiN2 =IF (aInclStratN2 EQ TRUE ) THEN wPMinDetWEpiN2 - wPSorpIMWEpiN2 + (tPDifPO4EpiN2 / uDepthWEpiN2) ELSE wPMinDetWEpiN2 - wPSorpIMWEpiN2 + ((tPSeepPO4WEpiN2 - tPInfPO4WEpiN2 + tPDifPO4EpiN2 + tPResusPO4N2) / uDepthWEpiN2) ENDIF;
wPAbioAIMWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN (- tPSetAIMEpiN2 ) / uDepthWEpiN2 + wPSorpIMWEpiN2 ELSE (- tPSetAIMEpiN2 + tPResusAIMN2 ) / uDepthWEpiN2 + wPSorpIMWEpiN2 ENDIF;
tPAbioDetSN2 = IF ( aInclStratN2 EQ TRUE ) THEN - tPMinDetSN2 + tPSetDetHypN2 - tPResusDetN2 ELSE - tPMinDetSN2 + tPSetDetEpiN2 - tPResusDetN2 ENDIF ;
tPAbioHumSN2 = uPErosOMN2 + fRefrDetSN2 * tPMinDetSN2 - tPMinHumSN2;
tPAbioPO4SN2 = IF ( aInclStratN2 EQ TRUE ) THEN tPInfPO4WHypN2 - tPSeepPO4WHypN2 - tPInfPO4SN2 + tPSeepPO4SN2 + (1.0-fRefrDetSN2) * tPMinDetSN2 + tPMinHumSN2 - tPSorpIMSN2 - tPResusPO4N2 - tPDifPO4HypN2 - tPDifGroundPO4N2 - tPChemPO4N2 ELSE tPInfPO4WEpiN2 - tPSeepPO4WEpiN2 - tPInfPO4SN2 + tPSeepPO4SN2 + (1.0-fRefrDetSN2) * tPMinDetSN2 + tPMinHumSN2 - tPSorpIMSN2 - tPResusPO4N2 - tPDifPO4EpiN2 - tPDifGroundPO4N2 - tPChemPO4N2 ENDIF;
tPAbioAIMSN2 = IF ( aInclStratN2 EQ TRUE ) THEN tPSetAIMHypN2 - tPResusAIMN2 + tPSorpIMSN2 ELSE tPSetAIMEpiN2 - tPResusAIMN2 + tPSorpIMSN2 ENDIF;
wNAbioNH4WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wNMinDetWEpiN2 - wNNitrWEpiN2 + (tNDifNH4EpiN2 / uDepthWEpiN2) ELSE wNMinDetWEpiN2 - wNNitrWEpiN2 + ((tNSeepNH4WEpiN2 - tNInfNH4WEpiN2 + tNDifNH4EpiN2 + tNResusNH4N2) / uDepthWEpiN2) ENDIF;
wNAbioNO3WEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wNNitrWEpiN2 - wNDenitWEpiN2 + (tNDifNO3EpiN2 / uDepthWEpiN2) ELSE wNNitrWEpiN2 - wNDenitWEpiN2 + ((tNDifNO3EpiN2 + tNResusNO3N2 - tNInfNO3WEpiN2 + tNSeepNO3WEpiN2) / uDepthWEpiN2) ENDIF;
wNAbioDetWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN - wNMinDetWEpiN2 - (tNSetDetEpiN2) / uDepthWEpiN2 ELSE - wNMinDetWEpiN2 - (tNSetDetEpiN2 - tNResusDetN2 ) / uDepthWEpiN2 ENDIF;
tNAbioNH4SN2 = IF ( aInclStratN2 EQ TRUE ) THEN tNInfNH4WHypN2 - tNSeepNH4WHypN2 - tNInfNH4SN2 + tNSeepNH4SN2 + (1.0-fRefrDetSN2) * tNMinDetSN2 + tNMinHumSN2 - tNResusNH4N2 - tNDifNH4HypN2 - tNDifGroundNH4N2 - tNNitrSN2 ELSE tNInfNH4WEpiN2 - tNSeepNH4WEpiN2 - tNInfNH4SN2 + tNSeepNH4SN2 + (1.0-fRefrDetSN2) * tNMinDetSN2 + tNMinHumSN2 - tNResusNH4N2 - tNDifNH4EpiN2 - tNDifGroundNH4N2 - tNNitrSN2 ENDIF;
tNAbioNO3SN2 = IF ( aInclStratN2 EQ TRUE ) THEN tNInfNO3WHypN2 - tNSeepNO3WHypN2 - tNInfNO3SN2 + tNSeepNO3SN2 + tNNitrSN2 - tNDenitSN2 - tNResusNO3N2 - tNDifNO3HypN2 - tNDifGroundNO3N2 ELSE tNInfNO3WEpiN2 - tNSeepNO3WEpiN2 - tNInfNO3SN2 + tNSeepNO3SN2 + tNNitrSN2 - tNDenitSN2 - tNResusNO3N2 - tNDifNO3EpiN2 - tNDifGroundNO3N2 ENDIF;
tNAbioDetSN2 = IF ( aInclStratN2 EQ TRUE ) THEN - tNMinDetSN2 + tNSetDetHypN2 - tNResusDetN2 ELSE - tNMinDetSN2 + tNSetDetEpiN2 - tNResusDetN2 ENDIF ;
tNAbioHumSN2 = uNErosOMN2 + fRefrDetSN2 * tNMinDetSN2 - tNMinHumSN2;
tNAbioTotTN2 = uNErosOMN2 - tNDenitSN2 - wNDenitWEpiN2 * uDepthWEpiN2 - wNDenitWHypN2 * uDepthWHypN2 - tNInfNH4SN2 - tNInfNO3SN2 + tNSeepNH4SN2 + tNSeepNO3SN2 - tNDifGroundNO3N2 - tNDifGroundNH4N2;
wSiAbioSiO2WEpiN2 = IF (aInclStratN2 EQ FALSE ) THEN wSiMinDetWEpiN2 + (1.0 - fRefrDetSN2) * tSiMinDetSN2 / uDepthWEpiN2 - tInfSiO2WEpiN2 / uDepthWEpiN2 + tSeepSiO2WEpiN2 / uDepthWEpiN2 ELSE wSiMinDetWEpiN2 ENDIF;
wSiAbioDetWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN - wSiMinDetWEpiN2 - (tSiSetDetEpiN2 ) / uDepthWEpiN2 ELSE - wSiMinDetWEpiN2 - (tSiSetDetEpiN2 - tSiResusDetN2) / uDepthWEpiN2 ENDIF;
tSiAbioDetSN2 = IF ( aInclStratN2 EQ TRUE ) THEN - tSiMinDetSN2 + tSiSetDetHypN2 - tSiResusDetN2 ELSE - tSiMinDetSN2 + tSiSetDetEpiN2 - tSiResusDetN2 ENDIF;
tDProdSubVegEpiN2 = bfSubVegEpiN2 * tDProdVegEpiN2;
tDMortVegWEpiN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tDMortVegEpiN2;
tDMortVegSEpiN2 = tDMortVegEpiN2 - tDMortVegWEpiN2;
tDBedVegN2 = IF InclVegN2 EQ TRUE THEN tDMigrVegN2 + tDProdVegEpiN2 + tDProdVegHypN2- tDRespVegN2 - tDMortVegEpiN2 - tDMortVegHypN2 - tDGrazVegBirdN2 - tDManVegN2 ELSE 0.0 ENDIF;
tO2ProdVegEpiN2 = molO2molCN2 * cCPerDWN2 * tDProdVegEpiN2;
tO2RespVegWEpiN2 = molO2molCN2 * cCPerDWN2 * bfSubVegEpiN2 * tDRespVegN2 * aCorO2BODEpiN2;
tO2ProdVegSEpiN2 = MIN (tO2RespVegSN2, tO2ProdVegEpiN2);
tO2ProdVegWEpiN2 = MIN ( tO2ProdVegEpiN2 - tO2ProdVegSEpiN2, bfSubVegN2 * tO2ProdVegEpiN2) ;
tO2BedSN2 = tO2ProdVegSHypN2 + tO2ProdVegSEpiN2 - tO2RespVegSN2 + tO2UptNO3VegSN2;
tO2UptNO3VegWEpiN2 = O2PerNO3N2 * molO2molNN2 * bfSubVegN2 * tNUptNO3VegWEpiN2;
tPMortVegEpiN2 = rPDVegN2 * tDMortVegEpiN2;
tPMortVegPO4EpiN2 = fDissMortVegN2 * tPMortVegEpiN2;
tPMortVegPO4SEpiN2 = bfRootVegN2 * tPMortVegPO4EpiN2;
tPMortVegPO4WEpiN2 = tPMortVegPO4EpiN2 - tPMortVegPO4SEpiN2;
tPMortVegDetEpiN2 = tPMortVegEpiN2 - tPMortVegPO4EpiN2;
tPMortVegDetWEpiN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tPMortVegDetEpiN2;
tPMortVegDetSEpiN2 = tPMortVegDetEpiN2 - tPMortVegDetWEpiN2;
tPBedVegN2 = IF InclVegN2 EQ TRUE THEN tPMigrVegN2 + tPUptVegEpiN2 + tPUptVegHypN2 - tPExcrVegN2 - tPMortVegEpiN2 - tPMortVegHypN2 - tPGrazVegBirdN2 - tPManVegN2 ELSE 0.0 ENDIF;
tNMortVegNH4WEpiN2 = tNMortVegNH4EpiN2 - tNMortVegNH4SEpiN2;
tNMortVegDetEpiN2 = tNMortVegEpiN2 - tNMortVegNH4EpiN2;
tNMortVegDetWEpiN2 = fDetWMortVegN2 * (1.0 - bfRootVegN2) * tNMortVegDetEpiN2;
tNMortVegDetSEpiN2 = tNMortVegDetEpiN2 - tNMortVegDetWEpiN2;
tNBedVegN2 = IF InclVegN2 EQ TRUE THEN tNMigrVegN2 + tNUptVegN2 - tNExcrVegN2 - tNMortVegEpiN2 - tNMortVegHypN2 - tNGrazVegBirdN2 - tNManVegN2 ELSE 0.0 ENDIF;
wDBedDetWEpiN2 = IF (InclVegN2 EQ TRUE) THEN (tDMortVegWEpiN2 + tDEgesBirdN2) / uDepthWEpiN2 ELSE 0.0 ENDIF;
tDBedDetSEpiN2 = IF ( InclVegN2 EQ TRUE) THEN tDMortVegSEpiN2 ELSE 0.0 ENDIF;
wPBedPO4WEpiN2 = IF (InclVegN2 EQ FALSE) THEN 0.0 ELSE (- tPUptVegWEpiN2 + tPExcrVegWN2 * uVegHeightEpiN2 / uVegHeightN2 + tPMortVegPO4WEpiN2 + tPEgesBirdPO4N2) /uDepthWEpiN2 ENDIF;
wPBedDetWEpiN2 = IF (InclVegN2 EQ TRUE) THEN (tPMortVegDetWEpiN2 + tPEgesBirdDetN2) / uDepthWEpiN2 ELSE 0.0 ENDIF;
tPBedPO4SN2 = IF ( InclVegN2 EQ TRUE) THEN - tPUptVegSN2 + tPExcrVegSN2 + tPMortVegPO4SEpiN2 + tPMortVegPO4SHypN2 ELSE 0.0 ENDIF;
tPBedDetSN2 = IF (InclVegN2 EQ TRUE) THEN tPMortVegDetSEpiN2 + tPMortVegDetSHypN2 ELSE 0.0 ENDIF;
wNBedNH4WEpiN2 = IF ( InclVegN2 EQ TRUE ) THEN (- tNUptNH4VegWEpiN2 + tNExcrVegWN2 * (uVegHeightEpiN2 /uVegHeightN2 ) + tNMortVegNH4WEpiN2 + tNEgesBirdNH4N2) / uDepthWEpiN2 ELSE 0.0 ENDIF;
wNBedNO3WEpiN2 = IF ( InclVegN2 EQ TRUE) THEN - tNUptNO3VegWEpiN2 / uDepthWEpiN2 ELSE 0.0 ENDIF;
wNBedDetWEpiN2 = IF (InclVegN2 EQ TRUE) THEN (tNMortVegDetWEpiN2 + tNEgesBirdDetN2) / uDepthWEpiN2 ELSE 0.0 ENDIF;
tNBedNH4SN2 = IF ( InclVegN2 EQ TRUE) THEN - tNUptNH4VegSN2 + tNExcrVegSN2 + tNMortVegNH4SEpiN2 + tNMortVegNH4SHypN2 ELSE 0.0 ENDIF;
tNBedNO3SN2 = IF ( InclVegN2 EQ TRUE ) THEN - tNUptNO3VegSN2 ELSE 0.0 ENDIF;
tNBedDetSN2 = IF ( InclVegN2 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN2 EQ TRUE) THEN tNMortVegDetSEpiN2 + tNMortVegDetSHypN2 ELSE tNMortVegDetSEpiN2 ENDIF;
tO2BedWEpiN2 = IF ( InclVegN2 EQ TRUE ) THEN tO2ProdVegWEpiN2 - tO2RespVegWEpiN2 + tO2UptNO3VegWEpiN2 ELSE 0.0 ENDIF;
rPDBlueWEpiN2 = oPBlueWEpiN2 /(oDBlueWEpiN2+NearZeroN2);
aVPUptMaxCrBlueEpiN2 = MAX(0.0,cVPUptMaxBlueN2 * uFunTmProdBlueEpiN2 *(cPDBlueMaxN2 - rPDBlueWEpiN2) /(cPDBlueMaxN2 - cPDBlueMinN2));
aVPUptBlueEpiN2 = oPO4WEpiN2 * aVPUptMaxCrBlueEpiN2 /(aVPUptMaxCrBlueEpiN2 / cAffPUptBlueN2 + oPO4WEpiN2);
wPUptBlueEpiN2 = aVPUptBlueEpiN2 * oDBlueWEpiN2;
rNDBlueWEpiN2 = oNBlueWEpiN2 /(oDBlueWEpiN2+NearZeroN2);
aVNUptMaxCrBlueEpiN2 = MAX(0.0,cVNUptMaxBlueN2 * uFunTmProdBlueEpiN2 * (cNDBlueMaxN2 - rNDBlueWEpiN2) /(cNDBlueMaxN2 - cNDBlueMinN2));
ahNUptBlueEpiN2 = aVNUptMaxCrBlueEpiN2 / cAffNUptBlueN2;
aVNUptBlueEpiN2 = oNDissWEpiN2 * aVNUptMaxCrBlueEpiN2 /(ahNUptBlueEpiN2 + oNDissWEpiN2);
wNUptBlueEpiN2 = aVNUptBlueEpiN2 * oDBlueWEpiN2;
tNUptBlueEpiN2 = wNUptBlueEpiN2 * uDepthWEpiN2;
aLLimBlueEpiN2 = UseSteeleBlueN2 *(EXP(1.0) /(aExtCoefEpiN2 * uDepthWEpiN2) *(EXP(- aLPARBotEpiN2 /(cLOptRefBlueN2 * uFunTmProdBlueEpiN2)) - EXP(- aLPARBotSurfN2 /(cLOptRefBlueN2 * uFunTmProdBlueEpiN2)))) +(1.0 - UseSteeleBlueN2) *(1.0 /(aExtCoefEpiN2 * uDepthWEpiN2) * LN((1.0 + aLPARBotSurfN2 / (hLRefBlueN2 * uFunTmProdBlueEpiN2)) / (1.0 + aLPARBotEpiN2 /(hLRefBlueN2 * uFunTmProdBlueEpiN2))));
rChDBlueEpiN2 = cChDBlueMaxN2 -(cChDBlueMaxN2 - cChDBlueMinN2) * aLLimBlueEpiN2;
aChlaBlueEpiN2 = mgPergN2 * rChDBlueEpiN2 * aDBlueWEpiN2;
aNfixBlueEpiN2 = rNfixBlueEpiN2 *aChlaBlueEpiN2 /ugPergN2;
afNH4UptBlueEpiN2 = oNH4WEpiN2 * oNO3WEpiN2 /((ahNUptBlueEpiN2 + oNH4WEpiN2) *(ahNUptBlueEpiN2 + oNO3WEpiN2)) + oNH4WEpiN2 * ahNUptBlueEpiN2 /((oNH4WEpiN2 + oNO3WEpiN2) *(ahNUptBlueEpiN2 + oNO3WEpiN2));
tNUptBlueAirEpiN2 = IF (InclNfixN2 EQ FALSE) THEN 0.0 ELSE aNfixBlueEpiN2 ENDIF;
tNUptBlueWEpiN2 = IF (InclNfixN2 EQ FALSE) THEN tNUptBlueEpiN2 ELSE tNUptBlueEpiN2 - tNUptBlueAirEpiN2 ENDIF;
wNUptBlueWEpiN2 = tNUptBlueWEpiN2 / uDepthWEpiN2;
wNUptNH4BlueEpiN2 = afNH4UptBlueEpiN2 * wNUptBlueWEpiN2;
wNUptNO3BlueEpiN2 = wNUptBlueWEpiN2 - wNUptNH4BlueEpiN2;
aPLimBlueEpiN2 = MAX(0.0,(1.0 - cPDBlueMinN2 / rPDBlueWEpiN2) * cPDBlueMaxN2 /(cPDBlueMaxN2 - cPDBlueMinN2));
aNLimBlueEpiN2 = MAX(0.0,(1.0 - cNDBlueMinN2 / rNDBlueWEpiN2) * cNDBlueMaxN2 /(cNDBlueMaxN2 - cNDBlueMinN2));
aSiLimBlueEpiN2 = oSiO2WEpiN2 /(hSiAssBlueN2 + oSiO2WEpiN2);
aMuTmLBlueEpiN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimBlueEpiN2 * uMuMaxTmBlueEpiN2;
aNutLimBlueEpiN2 = MIN(aPLimBlueEpiN2 , (MIN(aNLimBlueEpiN2,aSiLimBlueEpiN2)));
aMuBlueEpiN2 = aNutLimBlueEpiN2 * aMuTmLBlueEpiN2;
wDAssBlueEpiN2 = aMuBlueEpiN2*oDBlueWEpiN2;
oChlaBlueEpiN2 = mgPergN2 * rChDBlueEpiN2 * oDBlueWEpiN2;
aLLimBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN -9999 ELSE MAX(0.0,UseSteeleBlueN2 *(EXP(1.0) /(aExtSurfN2) *(EXP(- aLPARBotSurfN2/(cLOptRefBlueN2 *  uFunTmProdBlueSurfN2)) - EXP(- uLPARSurfN2 /(cLOptRefBlueN2 *  uFunTmProdBlueSurfN2)))) +(1.0 - UseSteeleBlueN2) *(1.0 /(aExtSurfN2) * LN((1.0 + uLPARSurfN2 / (hLRefBlueN2 * uFunTmProdBlueSurfN2)) / (1.0 + aLPARBotSurfN2 /(hLRefBlueN2 * uFunTmProdBlueSurfN2))))) ENDIF;
aRepLLimBlueN2 = (aLLimBlueSurfN2* aDBlueSurfN2 + aLLimBlueEpiN2* aDBlueWEpiN2) / (aDBlueSurfN2 + aDBlueWEpiN2);
rChDBlueSurfN2 = cChDBlueMaxN2 -(cChDBlueMaxN2 - cChDBlueMinN2) * aLLimBlueSurfN2;
aChlaBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE mgPergN2 * rChDBlueSurfN2 * aDBlueSurfN2 ENDIF;
oChlaBlueWN2 = IF ( aInclStratN2 EQ TRUE ) THEN (oChlaBlueEpiN2 * uDepthWEpiN2 + oChlaBlueHypN2 * uDepthWHypN2) / uDepthWN2 ELSE (oChlaBlueEpiN2 * uDepthWEpiN2) / uDepthWN2 ENDIF;
oChlaBlueN2 = IF ( aInclStratN2 EQ TRUE ) THEN (oChlaBlueEpiN2 * uDepthWEpiN2 + oChlaBlueHypN2 * uDepthWHypN2 + aChlaBlueSurfN2) / uDepthWN2 ELSE (oChlaBlueEpiN2 * uDepthWEpiN2 + aChlaBlueSurfN2 ) / uDepthWN2 ENDIF;
aChlaLimFloBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE (1.0 - (POW ((aChlaBlueSurfN2 / cDepthSurfN2) , (-cStepPowN2))) / ((POW (cChlaThrBlueN2 , (-cStepPowN2))) + (POW ((aChlaBlueSurfN2 / cDepthSurfN2) , (-cStepPowN2))))) ENDIF;
aChlaLimFloBlueEpiN2 = IF (InclSurfN2 EQ FALSE  OR aDBlueWEpiN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE (1.0 - (POW (oChlaBlueEpiN2 , (-cStepPowN2))) / ((POW (cChlaThrBlueN2 , (-cStepPowN2))) + (POW (oChlaBlueEpiN2 , (-cStepPowN2))))) ENDIF;
aChlaLimFloBlueHypN2 = IF (aInclStratN2 EQ FALSE OR aDBlueWHypN2 LT cDBlueSurfMinN2) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (oChlaBlueHypN2 , (-cStepPowN2))) / ((POW (cChlaThrBlueN2 , (-cStepPowN2))) + (POW (oChlaBlueHypN2 , (-cStepPowN2))))) ENDIF;
aVWLimFloBlueN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uVWindN2 , cStepPowN2)) / ((POW (cVWindThrBlueN2 , cStepPowN2)) + (POW (uVWindN2 , cStepPowN2)))) ENDIF;
aTmLimFloBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE (1.0 - (POW (uTmSurfN2 , (-cStepPowN2))) / ((POW (cTmThrBlueN2 , (-cStepPowN2))) + (POW (uTmSurfN2 , (-cStepPowN2))))) ENDIF;
aTmLimFloBlueEpiN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE (1.0 - (POW (uTmEpiN2 , (-cStepPowN2))) / ((POW (cTmThrBlueN2 , (-cStepPowN2))) + (POW (uTmEpiN2 , (-cStepPowN2))))) ENDIF;
aTmLimFloBlueHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uTmHypN2 , (-cStepPowN2))) / ((POW (cTmThrBlueN2 , (-cStepPowN2))) + (POW (uTmHypN2 , (-cStepPowN2))))) ENDIF;
aTrigFloBlueSurfN2 =  aVWLimFloBlueN2 * aTmLimFloBlueSurfN2 * aChlaLimFloBlueSurfN2;
aTrigFloBlueEpiN2 =  aVWLimFloBlueN2 * aTmLimFloBlueEpiN2 * aChlaLimFloBlueEpiN2;
aTrigFloBlueHypN2 =   aTmLimFloBlueHypN2 * aChlaLimFloBlueHypN2;
uVFloBlueSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE aTrigFloBlueSurfN2 * cVFloMaxBlueWN2 ENDIF;
uVFloBlueEpiN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueEpiN2 * cVFloMaxBlueWN2 ENDIF;
uVFloBlueHypN2 =  IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueHypN2 * cVFloMaxBlueWN2 ENDIF;
uVBlueHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE) THEN  - uCorVSetBlueHypN2 ELSE  uVFloBlueHypN2 - uCorVSetBlueHypN2  ENDIF;
tDSetBlueHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN2 LT 0.0) THEN - uVBlueHypN2 * oDBlueWHypN2 ELSE 0.0 ENDIF;
tPSetBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN2 * tDSetBlueHypN2 ENDIF;
tNSetBlueHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN2 * tDSetBlueHypN2 ENDIF;
tDFloBlueHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN2 GE 0.0) THEN uVBlueHypN2 * oDBlueWHypN2 ELSE 0.0 ENDIF;
tPFloBlueHypN2 =  tDFloBlueHypN2  * rPDBlueWHypN2;
tNFloBlueHypN2 =  tDFloBlueHypN2  * rNDBlueWHypN2;
uVBlueEpiN2 = IF (InclSurfN2 EQ TRUE) THEN uVFloBlueEpiN2 - uCorVSetBlueEpiN2 ELSE - uCorVSetBlueEpiN2 ENDIF;
tDSetBlueEpiN2 = IF (uVBlueEpiN2 LT 0.0) THEN - uVBlueEpiN2 * oDBlueWEpiN2 ELSE 0.0 ENDIF;
tDFloBlueEpiN2 = IF (uVBlueEpiN2 GE 0.0) THEN uVBlueEpiN2 * oDBlueWEpiN2 ELSE 0.0 ENDIF;
tNSetBlueEpiN2 = rNDBlueWEpiN2 * tDSetBlueEpiN2;
tNFloBlueEpiN2 =  tDFloBlueEpiN2  * rNDBlueWEpiN2;
tPSetBlueEpiN2 = rPDBlueWEpiN2 * tDSetBlueEpiN2;
tPFloBlueEpiN2 =  tDFloBlueEpiN2  * rPDBlueWEpiN2;
aFunTauSetOMSurfN2 =MIN(1.0 / POW(aFunDimSuspN2 +NearZeroN2 , (0.5)), 1.0);
uFunTmSetSurfN2 = POW(cThetaSetN2 , (uTmSurfN2-cTmRefN2));
uCorVSetBlueSurfN2 = (cVSetBlueN2 + uQOutInfN2 /mmPermN2 - uQInSeepN2 / mmPermN2) * aFunTauSetOMSurfN2 * uFunTmSetSurfN2;
uVBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN - uCorVSetBlueSurfN2 ELSE uVFloBlueSurfN2 - uCorVSetBlueSurfN2 ENDIF;
tDSetBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSEIF (uVBlueSurfN2 LT 0.0) THEN aDBlueSurfN2  / cDepthSurfN2 * (- uVBlueSurfN2) ELSE 0.0 ENDIF;
rNDBlueSurfN2 = aNBlueSurfN2 / (aDBlueSurfN2 + NearZeroN2);
tNSetBlueSurfN2 = rNDBlueSurfN2 * tDSetBlueSurfN2;
rPDBlueSurfN2 = aPBlueSurfN2 / (aDBlueSurfN2 + NearZeroN2);
tPSetBlueSurfN2 = rPDBlueSurfN2 * tDSetBlueSurfN2;
rPDGrenWHypN2 = oPGrenWHypN2 /(oDGrenWHypN2+NearZeroN2);
aVPUptMaxCrGrenHypN2 = MAX(0.0,cVPUptMaxGrenN2 * uFunTmProdGrenHypN2 *(cPDGrenMaxN2 - rPDGrenWHypN2) /(cPDGrenMaxN2 - cPDGrenMinN2));
aVPUptGrenHypN2 = oPO4WHypN2 * aVPUptMaxCrGrenHypN2 /(aVPUptMaxCrGrenHypN2 / cAffPUptGrenN2 + oPO4WHypN2);
wPUptGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aVPUptGrenHypN2 * oDGrenWHypN2 ENDIF;
wPUptPhytHypN2 = wPUptDiatHypN2 + wPUptGrenHypN2 + wPUptBlueHypN2;
wPExcrGrenWHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE (2.0 *rPDGrenWHypN2) /(cPDGrenMaxN2 + rPDGrenWHypN2) * rPDGrenWHypN2 * wDRespGrenWHypN2 ENDIF;
wPExcrPhytWHypN2 = wPExcrDiatWHypN2 + wPExcrGrenWHypN2 + wPExcrBlueWHypN2;
aPLimGrenHypN2 = MAX(0.0,(1.0 - cPDGrenMinN2 / rPDGrenWHypN2) * cPDGrenMaxN2 /(cPDGrenMaxN2 - cPDGrenMinN2));
aNutLimGrenHypN2 = MIN(aPLimGrenHypN2,(MIN(aNLimGrenHypN2,aSiLimGrenHypN2)));
aMuGrenHypN2 = aNutLimGrenHypN2 * aMuTmLGrenHypN2;
wDAssGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE aMuGrenHypN2*oDGrenWHypN2 ENDIF;
wDPrimGrenWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wDAssGrenHypN2 - wDRespGrenWHypN2 - wDLossGrenHypN2 - wDMortGrenWHypN2 -(tDSetGrenHypN2 -tDSetGrenEpiN2 - tDResusGrenN2) / uDepthWHypN2 ENDIF;
wDAssPhytHypN2 = wDAssDiatHypN2 + wDAssGrenHypN2 + wDAssBlueHypN2;
wO2ProdPhytHypN2 = molO2molCN2 * cCPerDWN2 * wDAssPhytHypN2;
wO2PrimWHypN2 = wO2ProdPhytHypN2 - wO2RespPhytWHypN2 + wO2UptNO3PhytHypN2;
wPLossGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN2 * wDLossGrenHypN2 ENDIF;
wPLossPhytHypN2 = wPLossDiatHypN2 + wPLossGrenHypN2 + wPLossBlueHypN2;
wPLossPhytPO4HypN2 = fDissLossN2 * wPLossPhytHypN2;
wPLossPhytDetHypN2 = wPLossPhytHypN2 - wPLossPhytPO4HypN2;
wPPrimDetWHypN2 = wPLossPhytDetHypN2 + wPMortPhytDetWHypN2;
wPPrimPO4WHypN2 = - wPUptPhytHypN2 + wPExcrPhytWHypN2 + wPLossPhytPO4HypN2 + wPMortPhytPO4WHypN2;
tPSetGrenHypN2 =IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN2 * tDSetGrenHypN2 ENDIF;
wPPrimGrenWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wPUptGrenHypN2 - wPExcrGrenWHypN2 - wPLossGrenHypN2 - wPMortGrenWHypN2 -(tPSetGrenHypN2 -tPSetGrenEpiN2 - tPResusGrenN2) / uDepthWHypN2 ENDIF;
wPConsGrenZooHypN2 = rPDGrenWHypN2 * wDConsGrenZooHypN2;
wPConsPhytZooHypN2 = wPConsDiatZooHypN2 + wPConsGrenZooHypN2 + wPConsBlueZooHypN2;
wPConsZooHypN2 = wPConsPhytZooHypN2 + wPConsDetZooHypN2;
wPAssZooHypN2 = afPAssZooHypN2 * wPConsZooHypN2;
wPEgesZooHypN2 = wPConsZooHypN2 - wPAssZooHypN2;
wPEgesZooPO4HypN2 = fDissEgesZooN2*wPEgesZooHypN2;
wPEgesZooDetHypN2 = wPEgesZooHypN2 - wPEgesZooPO4HypN2;
aPConsZooSpHypN2 = wPConsZooHypN2 / oPZooHypN2;
aPGrazSpHypN2 = wPConsZooHypN2 / oPOMWHypN2;
wDPrimBlueWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wDAssBlueHypN2 - wDRespBlueWHypN2 - wDLossBlueHypN2 - wDMortBlueWHypN2 + (tDResusBlueN2 + tDSetBlueEpiN2 - tDSetBlueHypN2 - tDFloBlueHypN2) / uDepthWHypN2 ENDIF;
wPPrimBlueWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wPUptBlueHypN2 - wPExcrBlueWHypN2 - wPLossBlueHypN2 - wPMortBlueWHypN2+ (tPResusBlueN2 + tPSetBlueEpiN2 - tPSetBlueHypN2 - tPFloBlueHypN2) / uDepthWHypN2 ENDIF;
wNPrimBlueWHypN2 = IF (aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNUptBlueHypN2 - wNExcrBlueWHypN2 - wNLossBlueHypN2 - wNMortBlueWHypN2+ (tNResusBlueN2 + tNSetBlueEpiN2 - tNSetBlueHypN2 - tNFloBlueHypN2) / uDepthWHypN2 ENDIF;
tDSetPhytHypN2 = tDSetDiatHypN2 + tDSetGrenHypN2 + tDSetBlueHypN2;
wDPrimPhytWHypN2 = wDPrimDiatWHypN2 + wDPrimGrenWHypN2 + wDPrimBlueWHypN2;
tPSetPhytHypN2 = tPSetDiatHypN2 + tPSetGrenHypN2 + tPSetBlueHypN2;
wPPrimPhytWHypN2 = wPPrimDiatWHypN2 + wPPrimGrenWHypN2 + wPPrimBlueWHypN2;
tNSetPhytHypN2 = tNSetDiatHypN2 + tNSetGrenHypN2 + tNSetBlueHypN2;
wNPrimPhytWHypN2 = wNPrimDiatWHypN2 + wNPrimGrenWHypN2 + wNPrimBlueWHypN2;
tDSetTotHypN2 = tDSetIMHypN2 + tDSetDetHypN2 + tDSetPhytHypN2;
tPSetTotHypN2 = tPSetAIMHypN2 + tPSetDetHypN2 + tPSetPhytHypN2;
tNSetTotHypN2 = tNSetDetHypN2 + tNSetPhytHypN2;
aLLimGrenEpiN2 = UseSteeleGrenN2 *(EXP(1.0) /(aExtCoefEpiN2 * uDepthWEpiN2) *(EXP(- aLPARBotEpiN2 /(cLOptRefGrenN2 * uFunTmProdGrenEpiN2)) - EXP(- aLPARBotSurfN2 /(cLOptRefGrenN2 * uFunTmProdGrenEpiN2)))) +(1.0 - UseSteeleGrenN2) *(1.0 /(aExtCoefEpiN2 * uDepthWEpiN2) * LN((1.0 + aLPARBotSurfN2 / (hLRefGrenN2 * uFunTmProdGrenEpiN2)) / (1.0 + aLPARBotEpiN2 /(hLRefGrenN2 * uFunTmProdGrenEpiN2))));
rChDGrenEpiN2 = cChDGrenMaxN2 -(cChDGrenMaxN2 - cChDGrenMinN2) * aLLimGrenEpiN2;
oChlaGrenEpiN2 = mgPergN2 * rChDGrenEpiN2 * oDGrenWEpiN2;
aLLimDiatEpiN2 = UseSteeleDiatN2 *(EXP(1.0) /(aExtCoefEpiN2 * uDepthWEpiN2) *(EXP(- aLPARBotEpiN2 /(cLOptRefDiatN2 * uFunTmProdDiatEpiN2)) - EXP(- aLPARBotSurfN2 /(cLOptRefDiatN2 * uFunTmProdDiatEpiN2)))) +(1.0 - UseSteeleDiatN2) *(1.0 /(aExtCoefEpiN2 * uDepthWEpiN2) * LN((1.0 + aLPARBotSurfN2 / (hLRefDiatN2 * uFunTmProdDiatEpiN2)) / (1.0 + aLPARBotEpiN2 /(hLRefDiatN2 * uFunTmProdDiatEpiN2))));
rChDDiatEpiN2 = cChDDiatMaxN2 -(cChDDiatMaxN2 - cChDDiatMinN2) * aLLimDiatEpiN2;
oChlaDiatEpiN2 = mgPergN2 * rChDDiatEpiN2 * oDDiatWEpiN2;
oChlaEpiN2 = oChlaDiatEpiN2 + oChlaGrenEpiN2 + oChlaBlueEpiN2;
wDRespBlueWEpiN2 = ukDRespTmBlueEpiN2 * oDBlueWEpiN2;
wDLossBlueEpiN2 = ukLossTmBlueEpiN2 * oDBlueWEpiN2;
wDMortBlueWEpiN2 = kMortBlueWN2 * oDBlueWEpiN2;
ukDDecBlueEpiN2 = ukDRespTmBlueEpiN2 + ukLossTmBlueEpiN2 + kMortBlueWN2 +(uCorVSetBlueEpiN2 * uFunTmSetEpiN2) / uDepthWEpiN2;
wPExcrBlueWEpiN2 = (rPDBlueWEpiN2 * 2.0 )/(cPDBlueMaxN2 + rPDBlueWEpiN2) * rPDBlueWEpiN2 * wDRespBlueWEpiN2 ;
wPLossBlueEpiN2 = rPDBlueWEpiN2 * wDLossBlueEpiN2;
wPMortBlueWEpiN2 = kMortBlueWN2 * oPBlueWEpiN2;
wNExcrBlueWEpiN2 = (rNDBlueWEpiN2 *2.0)/(cNDBlueMaxN2 + rNDBlueWEpiN2) * rNDBlueWEpiN2 * wDRespBlueWEpiN2 ;
wNLossBlueEpiN2 = rNDBlueWEpiN2 * wDLossBlueEpiN2;
wNMortBlueWEpiN2 = kMortBlueWN2 * oNBlueWEpiN2;
wDPrimBlueWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wDAssBlueEpiN2 - wDRespBlueWEpiN2 - wDLossBlueEpiN2 - wDMortBlueWEpiN2 + (tDSetBlueSurfN2-tDFloBlueEpiN2 + tDFloBlueHypN2- tDSetBlueEpiN2 ) / uDepthWEpiN2 ELSE wDAssBlueEpiN2 - wDRespBlueWEpiN2 - wDLossBlueEpiN2 - wDMortBlueWEpiN2 + (tDResusBlueN2 + tDSetBlueSurfN2 - tDSetBlueEpiN2 -  tDFloBlueEpiN2) / uDepthWEpiN2 ENDIF;
wPPrimBlueWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wPUptBlueEpiN2 - wPExcrBlueWEpiN2 - wPLossBlueEpiN2 - wPMortBlueWEpiN2+ (tPSetBlueSurfN2-tPFloBlueEpiN2 + tPFloBlueHypN2- tPSetBlueEpiN2 ) / uDepthWEpiN2 ELSE wPUptBlueEpiN2 - wPExcrBlueWEpiN2 - wPLossBlueEpiN2 - wPMortBlueWEpiN2+ (tPResusBlueN2 + tPSetBlueSurfN2 - tPSetBlueEpiN2 -  tPFloBlueEpiN2) / uDepthWEpiN2 ENDIF;
wNPrimBlueWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wNUptBlueEpiN2 - wNExcrBlueWEpiN2 - wNLossBlueEpiN2 - wNMortBlueWEpiN2 + (tNSetBlueSurfN2-tNFloBlueEpiN2 + tNFloBlueHypN2- tNSetBlueEpiN2 ) / uDepthWEpiN2 ELSE wNUptBlueEpiN2 - wNExcrBlueWEpiN2 - wNLossBlueEpiN2 - wNMortBlueWEpiN2+ (tNResusBlueN2 + tNSetBlueSurfN2 - tNSetBlueEpiN2 -  tNFloBlueEpiN2) / uDepthWEpiN2 ENDIF;
ukDilSurfN2 = ukOutEpiN2;
tDDilBlueSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE ukDilSurfN2 * aDBlueSurfN2 ENDIF;
tNDilBlueSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE ukDilSurfN2 * aNBlueSurfN2 ENDIF;
tPDilBlueSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE ukDilSurfN2 * aPBlueSurfN2 ENDIF;
tDTranBlueSurfN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE uDLoadBlueSurfN2 - tDDilBlueSurfN2 ENDIF;
tPTranBlueSurfN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE uPLoadBlueSurfN2 - tPDilBlueSurfN2 ENDIF;
tNTranBlueSurfN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSEIF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE uNLoadBlueSurfN2 - tNDilBlueSurfN2 ENDIF;
uMuMaxTmBlueSurfN2 = cMuMaxBlueN2 * uFunTmProdBlueSurfN2;
aMuTmLBlueSurfN2 = ufDayN2 * aLLimBlueSurfN2 * uMuMaxTmBlueSurfN2;
aPLimBlueSurfN2 = MAX(0.0,(1.0 - cPDBlueMinN2 / rPDBlueSurfN2) * cPDBlueMaxN2 /(cPDBlueMaxN2 - cPDBlueMinN2));
aNLimBlueSurfN2 = MAX(0.0,(1.0 - cNDBlueMinN2 / rNDBlueSurfN2) * cNDBlueMaxN2 /(cNDBlueMaxN2 - cNDBlueMinN2));
aSiLimBlueSurfN2 = oSiO2WEpiN2 /(hSiAssBlueN2 + oSiO2WEpiN2);
aNutLimBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN -9999 ELSE MIN(aPLimBlueSurfN2,MIN(aNLimBlueSurfN2,aSiLimBlueSurfN2)) ENDIF;
aRepPLimBlueN2 = (aPLimBlueSurfN2* aDBlueSurfN2 + aPLimBlueEpiN2* aDBlueWEpiN2) / (aDBlueSurfN2 + aDBlueWEpiN2);
aRepNLimBlueN2 = (aNLimBlueSurfN2* aDBlueSurfN2 + aNLimBlueEpiN2* aDBlueWEpiN2) / (aDBlueSurfN2 + aDBlueWEpiN2);
aRepNutLimBlueN2 = (aNutLimBlueSurfN2* aDBlueSurfN2 + aNutLimBlueEpiN2* aDBlueWEpiN2) / (aDBlueSurfN2 + aDBlueWEpiN2);
aMuBlueSurfN2 = aNutLimBlueSurfN2 * aMuTmLBlueSurfN2;
tDAssBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE aMuBlueSurfN2 * aDBlueSurfN2 ENDIF;
aVNUptMaxCrBlueSurfN2 = MAX(0.0,cVNUptMaxBlueN2 * uFunTmProdBlueSurfN2 * (cNDBlueMaxN2 - rNDBlueSurfN2) /(cNDBlueMaxN2 - cNDBlueMinN2));
aVPUptMaxCrBlueSurfN2 = MAX(0.0,cVPUptMaxBlueN2 * uFunTmProdBlueSurfN2 *(cPDBlueMaxN2 - rPDBlueSurfN2) /(cPDBlueMaxN2 - cPDBlueMinN2));
ahNUptBlueSurfN2 = aVNUptMaxCrBlueSurfN2 / cAffNUptBlueN2;
aVNUptBlueSurfN2 = oNDissWEpiN2 * aVNUptMaxCrBlueSurfN2 /(ahNUptBlueSurfN2 + oNDissWEpiN2);
aVPUptBlueSurfN2 = oPO4WEpiN2 * aVPUptMaxCrBlueSurfN2 /(aVPUptMaxCrBlueSurfN2 / cAffPUptBlueN2 + oPO4WEpiN2);
tNUptBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE aVNUptBlueSurfN2 * aDBlueSurfN2 ENDIF;
aNfixBlueSurfN2 = rNfixBlueSurfN2 *aChlaBlueSurfN2 /ugPergN2;
tNUptBlueAirSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSEIF (InclNfixN2 EQ FALSE) THEN 0.0 ELSE aNfixBlueSurfN2 ENDIF;
tNUptBlueWSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSEIF (InclNfixN2 EQ FALSE) THEN tNUptBlueSurfN2 ELSE tNUptBlueSurfN2 - tNUptBlueAirSurfN2 ENDIF;
afNH4UptBlueSurfN2 = oNH4WEpiN2 * oNO3WEpiN2 /((ahNUptBlueSurfN2 + oNH4WEpiN2) *(ahNUptBlueSurfN2 + oNO3WEpiN2)) + oNH4WEpiN2 * ahNUptBlueSurfN2 /((oNH4WEpiN2 + oNO3WEpiN2) *(ahNUptBlueSurfN2 + oNO3WEpiN2));
tNUptNH4BlueSurfN2 = afNH4UptBlueSurfN2 * tNUptBlueWSurfN2;
tNUptNO3BlueSurfN2 = tNUptBlueWSurfN2 - tNUptNH4BlueSurfN2;
tPUptBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE aVPUptBlueSurfN2 * aDBlueSurfN2 ENDIF;
tDRespBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE ukDRespTmBlueSurfN2 *aDBlueSurfN2 ENDIF;
tNExcrBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE (rNDBlueSurfN2 * 2.0 )/(cNDBlueMaxN2 + rNDBlueSurfN2) * rNDBlueSurfN2 * tDRespBlueSurfN2 ENDIF;
tPExcrBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE (rPDBlueSurfN2 * 2.0 )/(cPDBlueMaxN2 + rPDBlueSurfN2) * rPDBlueSurfN2 * tDRespBlueSurfN2 ENDIF;
tDMortBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE kMortBlueWN2 * aDBlueSurfN2 ENDIF;
tNMortBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE kMortBlueWN2 * aNBlueSurfN2 ENDIF;
wNMortBlueNH4WSurfN2 = fDissMortPhytN2 * tNMortBlueSurfN2 / uDepthWEpiN2;
wNMortBlueDetSurfN2 = ( 1 -fDissMortPhytN2) * tNMortBlueSurfN2 / uDepthWEpiN2;
tPMortBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE kMortBlueWN2 * aPBlueSurfN2 ENDIF;
uFunTmLossSurfN2 = EXP(-0.5/(cSigTmLossN2*cSigTmLossN2) *((uTmSurfN2-cTmOptLossN2)*(uTmSurfN2-cTmOptLossN2) -(cTmRefN2-cTmOptLossN2)*(cTmRefN2-cTmOptLossN2)));
ukLossTmBlueSurfN2 = UseLossN2 * kLossBlueN2 * uFunTmLossSurfN2;
tDLossBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE ukLossTmBlueSurfN2 * aDBlueSurfN2 ENDIF;
tPLossBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE rPDBlueSurfN2 * tDLossBlueSurfN2 ENDIF;
tNLossBlueSurfN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE rNDBlueSurfN2 * tDLossBlueSurfN2 ENDIF;
tDPrimBlueSurfN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE tDAssBlueSurfN2 - tDRespBlueSurfN2 + tDFloBlueEpiN2 - tDSetBlueSurfN2- tDMortBlueSurfN2 ENDIF;
tNPrimBlueSurfN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE tNUptBlueSurfN2 - tNExcrBlueSurfN2  + tNFloBlueEpiN2 - tNSetBlueSurfN2 - tNMortBlueSurfN2 ENDIF;
tPPrimBlueSurfN2 = IF (InclSurfN2 EQ FALSE) THEN 0.0 ELSE tPUptBlueSurfN2 - tPExcrBlueSurfN2 + tPFloBlueEpiN2 - tPSetBlueSurfN2- tPMortBlueSurfN2 ENDIF;
tDPrimBlueSN2 = IF ( aInclStratN2 EQ FALSE) THEN tDSetBlueEpiN2 - tDResusBlueN2 - tDMortBlueSN2 - tDRespBlueSN2 ELSE tDSetBlueHypN2 - tDResusBlueN2 - tDMortBlueSN2 - tDRespBlueSN2 ENDIF;
tPPrimBlueSN2 = IF ( aInclStratN2 EQ FALSE) THEN tPSetBlueEpiN2 - tPResusBlueN2 - tPMortBlueSN2 - tPExcrBlueSN2 ELSE tPSetBlueHypN2 - tPResusBlueN2 - tPMortBlueSN2 - tPExcrBlueSN2 ENDIF;
tNPrimBlueSN2 = IF (aInclStratN2 EQ FALSE) THEN tNSetBlueEpiN2 - tNResusBlueN2 - tNMortBlueSN2 - tNExcrBlueSN2 ELSE tNSetBlueHypN2 - tNResusBlueN2 - tNMortBlueSN2 - tNExcrBlueSN2 ENDIF;
aVPUptMaxCrGrenEpiN2 = MAX(0.0,cVPUptMaxGrenN2 * uFunTmProdGrenEpiN2 *(cPDGrenMaxN2 - rPDGrenWEpiN2) /(cPDGrenMaxN2 - cPDGrenMinN2));
aVPUptGrenEpiN2 = oPO4WEpiN2 * aVPUptMaxCrGrenEpiN2 /(aVPUptMaxCrGrenEpiN2 / cAffPUptGrenN2 + oPO4WEpiN2);
wPUptGrenEpiN2 = aVPUptGrenEpiN2 * oDGrenWEpiN2;
aVNUptMaxCrGrenEpiN2 = MAX(0.0,cVNUptMaxGrenN2 * uFunTmProdGrenEpiN2 * (cNDGrenMaxN2 - rNDGrenWEpiN2) /(cNDGrenMaxN2 - cNDGrenMinN2));
ahNUptGrenEpiN2 = aVNUptMaxCrGrenEpiN2 / cAffNUptGrenN2;
aVNUptGrenEpiN2 = oNDissWEpiN2 * aVNUptMaxCrGrenEpiN2 /(ahNUptGrenEpiN2 + oNDissWEpiN2);
wNUptGrenEpiN2 = aVNUptGrenEpiN2 * oDGrenWEpiN2;
afNH4UptGrenEpiN2 = oNH4WEpiN2 * oNO3WEpiN2 /((ahNUptGrenEpiN2 + oNH4WEpiN2) *(ahNUptGrenEpiN2 + oNO3WEpiN2)) + oNH4WEpiN2 * ahNUptGrenEpiN2 /((oNH4WEpiN2 + oNO3WEpiN2) *(ahNUptGrenEpiN2 + oNO3WEpiN2));
wNUptNH4GrenEpiN2 = afNH4UptGrenEpiN2 * wNUptGrenEpiN2;
wNUptNO3GrenEpiN2 = wNUptGrenEpiN2 - wNUptNH4GrenEpiN2;
aPLimGrenEpiN2 = MAX(0.0,(1.0 - cPDGrenMinN2 / rPDGrenWEpiN2) * cPDGrenMaxN2 /(cPDGrenMaxN2 - cPDGrenMinN2));
aNLimGrenEpiN2 = MAX(0.0,(1.0 - cNDGrenMinN2 / rNDGrenWEpiN2) * cNDGrenMaxN2 /(cNDGrenMaxN2 - cNDGrenMinN2));
aSiLimGrenEpiN2 = oSiO2WEpiN2 /(hSiAssGrenN2 + oSiO2WEpiN2);
aMuTmLGrenEpiN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimGrenEpiN2 * uMuMaxTmGrenEpiN2;
aNutLimGrenEpiN2 = MIN(aPLimGrenEpiN2 , (MIN(aNLimGrenEpiN2,aSiLimGrenEpiN2)));
aMuGrenEpiN2 = aNutLimGrenEpiN2 * aMuTmLGrenEpiN2;
wDAssGrenEpiN2 = aMuGrenEpiN2*oDGrenWEpiN2;
aExtChGrenEpiN2 = cExtSpGrenN2 / rChDGrenEpiN2;
wDRespGrenWEpiN2 = ukDRespTmGrenEpiN2 * oDGrenWEpiN2;
wDLossGrenEpiN2 = ukLossTmGrenEpiN2 * oDGrenWEpiN2;
wDMortGrenWEpiN2 = kMortGrenWN2 * oDGrenWEpiN2;
ukDDecGrenEpiN2 = ukDRespTmGrenEpiN2 + ukLossTmGrenEpiN2 + kMortGrenWN2 +(uCorVSetGrenEpiN2 * uFunTmSetEpiN2) / uDepthWEpiN2;
wPExcrGrenWEpiN2 = (2.0 *rPDGrenWEpiN2) /(cPDGrenMaxN2 + rPDGrenWEpiN2) * rPDGrenWEpiN2 * wDRespGrenWEpiN2 ;
wPLossGrenEpiN2 = rPDGrenWEpiN2 * wDLossGrenEpiN2;
wPMortGrenWEpiN2 = kMortGrenWN2 * oPGrenWEpiN2;
wNExcrGrenWEpiN2 = (2.0 * rNDGrenWEpiN2) /(cNDGrenMaxN2 + rNDGrenWEpiN2) * rNDGrenWEpiN2 * wDRespGrenWEpiN2;
wNLossGrenEpiN2 = rNDGrenWEpiN2 * wDLossGrenEpiN2;
wNMortGrenWEpiN2 = kMortGrenWN2 * oNGrenWEpiN2;
wDPrimGrenWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wDAssGrenEpiN2 - wDRespGrenWEpiN2 - wDLossGrenEpiN2 - wDMortGrenWEpiN2 -(tDSetGrenEpiN2 ) / uDepthWEpiN2 ELSE wDAssGrenEpiN2 - wDRespGrenWEpiN2 - wDLossGrenEpiN2 - wDMortGrenWEpiN2 -(tDSetGrenEpiN2 - tDResusGrenN2) / uDepthWEpiN2 ENDIF;
wPPrimGrenWEpiN2 =IF (aInclStratN2 EQ TRUE ) THEN wPUptGrenEpiN2 - wPExcrGrenWEpiN2 - wPLossGrenEpiN2 - wPMortGrenWEpiN2 -(tPSetGrenEpiN2 ) / uDepthWEpiN2 ELSE wPUptGrenEpiN2 - wPExcrGrenWEpiN2 - wPLossGrenEpiN2 - wPMortGrenWEpiN2 -(tPSetGrenEpiN2 - tPResusGrenN2) / uDepthWEpiN2 ENDIF;
wNPrimGrenWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wNUptGrenEpiN2 - wNExcrGrenWEpiN2 - wNLossGrenEpiN2 - wNMortGrenWEpiN2 -(tNSetGrenEpiN2 ) / uDepthWEpiN2 ELSE wNUptGrenEpiN2 - wNExcrGrenWEpiN2 - wNLossGrenEpiN2 - wNMortGrenWEpiN2 -(tNSetGrenEpiN2 - tNResusGrenN2) / uDepthWEpiN2 ENDIF;
tDPrimGrenSN2 = IF ( aInclStratN2 EQ FALSE) THEN tDSetGrenEpiN2 - tDResusGrenN2 - tDMortGrenSN2 - tDRespGrenSN2 ELSE tDSetGrenHypN2 - tDResusGrenN2 - tDMortGrenSN2 - tDRespGrenSN2 ENDIF;
tPPrimGrenSN2 = IF ( aInclStratN2 EQ FALSE) THEN tPSetGrenEpiN2 - tPResusGrenN2 - tPMortGrenSN2 - tPExcrGrenSN2 ELSE tPSetGrenHypN2 - tPResusGrenN2 - tPMortGrenSN2 - tPExcrGrenSN2 ENDIF;
tNPrimGrenSN2 = IF ( aInclStratN2 EQ FALSE) THEN tNSetGrenEpiN2 - tNResusGrenN2 - tNMortGrenSN2 - tNExcrGrenSN2 ELSE tNSetGrenHypN2 - tNResusGrenN2 - tNMortGrenSN2 - tNExcrGrenSN2 ENDIF;
aVPUptMaxCrDiatEpiN2 = MAX(0.0,cVPUptMaxDiatN2 * uFunTmProdDiatEpiN2 *(cPDDiatMaxN2 - rPDDiatWEpiN2) /(cPDDiatMaxN2 - cPDDiatMinN2));
aVPUptDiatEpiN2 = oPO4WEpiN2 * aVPUptMaxCrDiatEpiN2 /(aVPUptMaxCrDiatEpiN2 / cAffPUptDiatN2 + oPO4WEpiN2);
wPUptDiatEpiN2 = aVPUptDiatEpiN2 * oDDiatWEpiN2;
aVNUptMaxCrDiatEpiN2 = MAX(0.0,cVNUptMaxDiatN2 * uFunTmProdDiatEpiN2 * (cNDDiatMaxN2 - rNDDiatWEpiN2) /(cNDDiatMaxN2 - cNDDiatMinN2));
ahNUptDiatEpiN2 = aVNUptMaxCrDiatEpiN2 / cAffNUptDiatN2;
aVNUptDiatEpiN2 = oNDissWEpiN2 * aVNUptMaxCrDiatEpiN2 /(ahNUptDiatEpiN2 + oNDissWEpiN2);
wNUptDiatEpiN2 = aVNUptDiatEpiN2 * oDDiatWEpiN2;
afNH4UptDiatEpiN2 = oNH4WEpiN2 * oNO3WEpiN2 /((ahNUptDiatEpiN2 + oNH4WEpiN2) *(ahNUptDiatEpiN2 + oNO3WEpiN2)) + oNH4WEpiN2 * ahNUptDiatEpiN2 /((oNH4WEpiN2 + oNO3WEpiN2) *(ahNUptDiatEpiN2 + oNO3WEpiN2));
wNUptNH4DiatEpiN2 = afNH4UptDiatEpiN2 * wNUptDiatEpiN2;
wNUptNO3DiatEpiN2 = wNUptDiatEpiN2 - wNUptNH4DiatEpiN2;
aPLimDiatEpiN2 = MAX(0.0,(1.0 - cPDDiatMinN2 / rPDDiatWEpiN2) * cPDDiatMaxN2 /(cPDDiatMaxN2 - cPDDiatMinN2));
aNLimDiatEpiN2 = MAX(0.0,(1.0 - cNDDiatMinN2 / rNDDiatWEpiN2) * cNDDiatMaxN2 /(cNDDiatMaxN2 - cNDDiatMinN2));
aSiLimDiatEpiN2 = oSiO2WEpiN2 /(hSiAssDiatN2 + oSiO2WEpiN2);
aMuTmLDiatEpiN2 = ufDayN2 *(1.0 - afCovSurfVegN2) * aLLimDiatEpiN2 * uMuMaxTmDiatEpiN2;
aNutLimDiatEpiN2 = MIN(aPLimDiatEpiN2 , (MIN(aNLimDiatEpiN2,aSiLimDiatEpiN2)));
aMuDiatEpiN2 = aNutLimDiatEpiN2 * aMuTmLDiatEpiN2;
wDAssDiatEpiN2 = aMuDiatEpiN2*oDDiatWEpiN2;
aExtChDiatEpiN2 = cExtSpDiatN2 / rChDDiatEpiN2;
wDRespDiatWEpiN2 = ukDRespTmDiatEpiN2 * oDDiatWEpiN2;
wDLossDiatEpiN2 = ukLossTmDiatEpiN2 * oDDiatWEpiN2;
wDMortDiatWEpiN2 = kMortDiatWN2 * oDDiatWEpiN2;
ukDDecDiatEpiN2 = ukDRespTmDiatEpiN2 + ukLossTmDiatEpiN2 + kMortDiatWN2 +(uCorVSetDiatEpiN2 * uFunTmSetEpiN2) / uDepthWEpiN2;
wPExcrDiatWEpiN2 = (2.0 * rPDDiatWEpiN2) /(cPDDiatMaxN2 + rPDDiatWEpiN2) * rPDDiatWEpiN2 * wDRespDiatWEpiN2 ;
wPLossDiatEpiN2 = rPDDiatWEpiN2 * wDLossDiatEpiN2;
wPMortDiatWEpiN2 = kMortDiatWN2 * oPDiatWEpiN2;
wNExcrDiatWEpiN2 = (2.0 * rNDDiatWEpiN2) /(cNDDiatMaxN2 + rNDDiatWEpiN2) * rNDDiatWEpiN2 * wDRespDiatWEpiN2 ;
wNLossDiatEpiN2 = rNDDiatWEpiN2 * wDLossDiatEpiN2;
wNMortDiatWEpiN2 = kMortDiatWN2 * oNDiatWEpiN2;
wDPrimDiatWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wDAssDiatEpiN2 - wDRespDiatWEpiN2 - wDLossDiatEpiN2 - wDMortDiatWEpiN2 -(tDSetDiatEpiN2 ) / uDepthWEpiN2 ELSE wDAssDiatEpiN2 - wDRespDiatWEpiN2 - wDLossDiatEpiN2 - wDMortDiatWEpiN2 -(tDSetDiatEpiN2 - tDResusDiatN2) / uDepthWEpiN2 ENDIF;
wPPrimDiatWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wPUptDiatEpiN2 - wPExcrDiatWEpiN2 - wPLossDiatEpiN2 - wPMortDiatWEpiN2 -(tPSetDiatEpiN2 ) / uDepthWEpiN2 ELSE wPUptDiatEpiN2 - wPExcrDiatWEpiN2 - wPLossDiatEpiN2 - wPMortDiatWEpiN2 -(tPSetDiatEpiN2 - tPResusDiatN2) / uDepthWEpiN2 ENDIF;
wNPrimDiatWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wNUptDiatEpiN2 - wNExcrDiatWEpiN2 - wNLossDiatEpiN2 - wNMortDiatWEpiN2 -(tNSetDiatEpiN2 ) / uDepthWEpiN2 ELSE wNUptDiatEpiN2 - wNExcrDiatWEpiN2 - wNLossDiatEpiN2 - wNMortDiatWEpiN2 -(tNSetDiatEpiN2 - tNResusDiatN2) / uDepthWEpiN2 ENDIF;
tDPrimDiatSN2 = IF ( aInclStratN2 EQ FALSE) THEN tDSetDiatEpiN2 - tDResusDiatN2 - tDMortDiatSN2 - tDRespDiatSN2 ELSE tDSetDiatHypN2 - tDResusDiatN2 - tDMortDiatSN2 - tDRespDiatSN2 ENDIF;
tPPrimDiatSN2 = IF ( aInclStratN2 EQ FALSE) THEN tPSetDiatEpiN2 - tPResusDiatN2 - tPMortDiatSN2 - tPExcrDiatSN2 ELSE tPSetDiatHypN2 - tPResusDiatN2 - tPMortDiatSN2 - tPExcrDiatSN2 ENDIF;
tNPrimDiatSN2 = IF ( aInclStratN2 EQ FALSE) THEN tNSetDiatEpiN2 - tNResusDiatN2 - tNMortDiatSN2 - tNExcrDiatSN2 ELSE tNSetDiatHypN2 - tNResusDiatN2 - tNMortDiatSN2 - tNExcrDiatSN2 ENDIF;
oChlaN2 = IF ( aInclStratN2 EQ TRUE ) THEN (oChlaEpiN2 * uDepthWEpiN2 + oChlaHypN2 * uDepthWHypN2 + aChlaBlueSurfN2) / uDepthWN2 ELSE (oChlaEpiN2 * uDepthWEpiN2+ aChlaBlueSurfN2 ) / uDepthWN2 ENDIF;
oChlaWN2 = IF ( aInclStratN2 EQ TRUE ) THEN (oChlaEpiN2 * uDepthWEpiN2 + oChlaHypN2 * uDepthWHypN2) / uDepthWN2 ELSE (oChlaEpiN2 * uDepthWEpiN2) / uDepthWN2 ENDIF;
aChlaHN2 = oChlaN2 * uDepthWN2;
aLPIEpiN2 =  (aLPARBotSurfN2- aLPARBotEpiOpenN2 + uhLVegN2* LN((1.0 +aLPARBotEpiOpenN2/ uhLVegN2)  /(1.0 + aLPARBotSurfN2  / uhLVegN2) + NearZeroN2  ) ) / uDepthWEpiN2;
aLPIHypN2 =  (aLPARBotEpiN2- aLPARBotHypOpenN2 + uhLVegN2* LN((1.0 +aLPARBotHypOpenN2/ uhLVegN2)  /(1.0 + aLPARBotEpiN2  / uhLVegN2) + NearZeroN2  ) ) / uDepthWHypN2;
aLPIMeasEpiN2 =  (aLPARBotSurfN2- aLPARBotEpiN2 ) /aExtCoefEpiN2;
aLPIMeasHypN2 =  (aLPARBotEpiN2- aLPARBotHypN2) / aExtCoefHypN2;
aLMeasEpiN2 = aLPARBotSurfN2 * EXP(- aExtCoefOpenEpiN2 *cDepthMeasoChlN2);
aLMeasHypN2 = aLPARBotEpiN2 * EXP(- aExtCoefOpenHypN2 * (cDepthMeasoChlN2 -  uDepthWEpiN2));
aLPAREuphoN2 = PerCentN2 * uLPARSurfN2;
aDepthEuphWN2 = IF (aLPAREuphoN2 GT aLPARBotSurfN2) THEN  0.0 ELSEIF (aLPAREuphoN2 GE aLPARBotEpiOpenN2) THEN - LN(aLPAREuphoN2/aLPARBotSurfN2) / aExtCoefEpiN2 ELSE uDepthWEpiN2 - LN(aLPAREuphoN2/aLPARBotEpiOpenN2) / aExtCoefOpenHypN2 ENDIF;
oChlaMeasEpiN2 = IF (cDepthMeasoChlN2 LT aDepthEuphWN2) THEN aLMeasEpiN2/ aLPIMeasEpiN2 *oChlaEpiN2 * uDepthWEpiN2 ELSE oChlaEpiN2 ENDIF;
oChlaMeasHypN2 = IF (cDepthMeasoChlN2 LT aDepthEuphWN2) THEN  aLMeasHypN2/ aLPIMeasHypN2 *oChlaHypN2* uDepthWHypN2  ELSE oChlaHypN2 ENDIF;
oChlaMeasWN2 = IF (cDepthMeasoChlN2 LT uDepthWEpiN2) THEN oChlaMeasEpiN2 ELSE oChlaMeasHypN2 ENDIF;
wDAssPhytEpiN2 = wDAssDiatEpiN2 + wDAssGrenEpiN2 + wDAssBlueEpiN2;
wDRespPhytWEpiN2 = wDRespDiatWEpiN2 + wDRespGrenWEpiN2 + wDRespBlueWEpiN2;
wDMortPhytWEpiN2 = wDMortDiatWEpiN2 + wDMortGrenWEpiN2 + wDMortBlueWEpiN2;
tDSetPhytEpiN2 = tDSetDiatEpiN2 + tDSetGrenEpiN2 + tDSetBlueEpiN2;
wDLossPhytEpiN2 = wDLossDiatEpiN2 + wDLossGrenEpiN2 + wDLossBlueEpiN2 + tDLossBlueSurfN2 / uDepthWEpiN2;
wDPrimPhytWEpiN2 = wDPrimDiatWEpiN2 + wDPrimGrenWEpiN2 + wDPrimBlueWEpiN2;
wPUptPhytEpiN2 = wPUptDiatEpiN2 + wPUptGrenEpiN2 + wPUptBlueEpiN2;
wPExcrPhytWEpiN2 = wPExcrDiatWEpiN2 + wPExcrGrenWEpiN2 + wPExcrBlueWEpiN2;
wPMortPhytWEpiN2 = wPMortDiatWEpiN2 + wPMortGrenWEpiN2 + wPMortBlueWEpiN2;
tPSetPhytEpiN2 = tPSetDiatEpiN2 + tPSetGrenEpiN2 + tPSetBlueEpiN2;
wPLossPhytEpiN2 = wPLossDiatEpiN2 + wPLossGrenEpiN2 + wPLossBlueEpiN2 + tPLossBlueSurfN2 / uDepthWEpiN2;
wPPrimPhytWEpiN2 = wPPrimDiatWEpiN2 + wPPrimGrenWEpiN2 + wPPrimBlueWEpiN2;
wNUptPhytEpiN2 = wNUptDiatEpiN2 + wNUptGrenEpiN2 + wNUptBlueEpiN2;
wNUptNH4PhytEpiN2 = wNUptNH4DiatEpiN2 + wNUptNH4GrenEpiN2 + wNUptNH4BlueEpiN2;
wNUptNO3PhytEpiN2 = wNUptNO3DiatEpiN2 + wNUptNO3GrenEpiN2 + wNUptNO3BlueEpiN2;
wNExcrPhytWEpiN2 = wNExcrDiatWEpiN2 + wNExcrGrenWEpiN2 + wNExcrBlueWEpiN2;
wNMortPhytWEpiN2 = wNMortDiatWEpiN2 + wNMortGrenWEpiN2 + wNMortBlueWEpiN2;
tNSetPhytEpiN2 = tNSetDiatEpiN2 + tNSetGrenEpiN2 + tNSetBlueEpiN2;
wNLossPhytEpiN2 = wNLossDiatEpiN2 + wNLossGrenEpiN2 + wNLossBlueEpiN2 + tNLossBlueSurfN2 / uDepthWEpiN2;
wNPrimPhytWEpiN2 = wNPrimDiatWEpiN2 + wNPrimGrenWEpiN2 + wNPrimBlueWEpiN2;
tDPrimPhytSN2 = tDPrimDiatSN2 + tDPrimGrenSN2 + tDPrimBlueSN2;
tPPrimPhytSN2 = tPPrimDiatSN2 + tPPrimGrenSN2 + tPPrimBlueSN2;
tNPrimPhytSN2 = tNPrimDiatSN2 + tNPrimGrenSN2 + tNPrimBlueSN2;
wSiUptDiatEpiN2 = cSiDDiatN2 * wDAssDiatEpiN2;
wSiExcrDiatWEpiN2 = cSiDDiatN2 * wDRespDiatWEpiN2 ;
wSiLossDiatEpiN2 = cSiDDiatN2 * wDLossDiatEpiN2;
wSiMortDiatWEpiN2 = cSiDDiatN2 * wDMortDiatWEpiN2;
tSiSetDiatEpiN2 = cSiDDiatN2 * tDSetDiatEpiN2;
wSiPrimDiatWHypN2 = IF (aInclStratN2 EQ TRUE ) THEN wSiUptDiatHypN2 - tSiSetDiatHypN2 / uDepthWHypN2 - wSiExcrDiatWHypN2 - wSiMortDiatWHypN2 - wSiLossDiatHypN2 ELSE 0.0 ENDIF;
wSiPrimDiatWEpiN2 = IF (aInclStratN2 EQ TRUE ) THEN wSiUptDiatEpiN2 - tSiSetDiatEpiN2 / uDepthWEpiN2 - wSiExcrDiatWEpiN2 - wSiMortDiatWEpiN2 - wSiLossDiatEpiN2 ELSE wSiUptDiatEpiN2 - tSiSetDiatEpiN2 / uDepthWEpiN2 - wSiExcrDiatWEpiN2 - wSiMortDiatWEpiN2 - wSiLossDiatEpiN2 + tSiResusDiatN2 / uDepthWEpiN2 ENDIF;
rCyDBlueEpiN2 = cCyDBlueMaxN2 -(cCyDBlueMaxN2 - cCyDBlueMinN2) * aLLimBlueEpiN2;
oCyanEpiN2 = rCyDBlueEpiN2 * oDBlueWEpiN2 * mgPergN2;
fDDiatEpiN2 = oDDiatWEpiN2 /(oDDiatWEpiN2 + oDGrenWEpiN2 + oDBlueWEpiN2 + NearZeroN2);
wDPrimDetWEpiN2 = IF (InclSurfN2 EQ TRUE) THEN wDMortPhytWEpiN2 + wDLossPhytEpiN2 + tDMortBlueSurfN2 / uDepthWEpiN2 ELSE wDMortPhytWEpiN2 + wDLossPhytEpiN2 ENDIF;
tDPrimDetSN2 = tDMortPhytSN2;
tDPrimTotSurfN2 = IF (InclSurfN2 EQ TRUE) THEN tDAssBlueSurfN2 - tDRespBlueSurfN2 ELSE 0.0 ENDIF;
tDPrimTotTN2 = IF (aInclStratN2 EQ FALSE ) THEN(wDAssPhytEpiN2 - wDRespPhytWEpiN2) * uDepthWEpiN2 - tDRespPhytSN2 + tDPrimTotSurfN2 ELSE (wDAssPhytEpiN2 - wDRespPhytWEpiN2) * uDepthWEpiN2 + (wDAssPhytHypN2 - wDRespPhytWHypN2) * uDepthWHypN2 - tDRespPhytSN2 + tDPrimTotSurfN2 ENDIF;
wO2ProdPhytEpiN2 = molO2molCN2 * cCPerDWN2 * wDAssPhytEpiN2;
wO2RespPhytWEpiN2 = molO2molCN2 * cCPerDWN2 * wDRespPhytWEpiN2 * aCorO2BODEpiN2;
wO2UptNO3PhytEpiN2 = O2PerNO3N2 * molO2molNN2 * wNUptNO3PhytEpiN2;
wO2PrimWEpiN2 = wO2ProdPhytEpiN2 - wO2RespPhytWEpiN2 + wO2UptNO3PhytEpiN2;
tO2RespPhytSN2 = molO2molCN2 * cCPerDWN2 * tDRespPhytSN2 * afOxySedN2;
tO2PrimSN2 = tO2RespPhytSN2;
tO2PrimSHypN2 = IF aInclStratN2 EQ TRUE THEN tO2PrimSN2 / uDepthWHypN2 ELSE 0.0 ENDIF;
tO2PrimSEpiN2 = IF aInclStratN2 EQ FALSE THEN tO2PrimSN2 / uDepthWEpiN2 ELSE 0.0 ENDIF;
wPMortBluePO4WSurfN2 = fDissMortPhytN2 * tPMortBlueSurfN2 / uDepthWEpiN2;
wPMortBlueDetSurfN2 = ( 1 -fDissMortPhytN2) * tPMortBlueSurfN2 / uDepthWEpiN2;
wPMortPhytPO4WEpiN2 = fDissMortPhytN2 * wPMortPhytWEpiN2;
wPMortPhytDetWEpiN2 = wPMortPhytWEpiN2 - wPMortPhytPO4WEpiN2 + wPMortBlueDetSurfN2;
wPLossPhytPO4EpiN2 = fDissLossN2 * wPLossPhytEpiN2;
wPLossPhytDetEpiN2 = wPLossPhytEpiN2 - wPLossPhytPO4EpiN2;
wPPrimPO4WEpiN2 = - wPUptPhytEpiN2 + wPExcrPhytWEpiN2 + wPLossPhytPO4EpiN2 + wPMortPhytPO4WEpiN2 - tPUptBlueSurfN2 / uDepthWEpiN2 + tPExcrBlueSurfN2 / uDepthWEpiN2 + wPMortBluePO4WSurfN2;
wPPrimDetWEpiN2 = wPLossPhytDetEpiN2 + wPMortPhytDetWEpiN2;
tPPrimDetSN2 = tPMortPhytDetSN2 ;
wNMortPhytNH4WEpiN2 = fDissMortPhytN2 * wNMortPhytWEpiN2;
wNMortPhytDetWEpiN2 = wNMortPhytWEpiN2 - wNMortPhytNH4WEpiN2+ wNMortBlueDetSurfN2;
wNLossPhytNH4EpiN2 = fDissLossN2 * wNLossPhytEpiN2;
wNLossPhytDetEpiN2 = wNLossPhytEpiN2 - wNLossPhytNH4EpiN2;
wNPrimNH4WEpiN2 = - wNUptNH4PhytEpiN2 + wNExcrPhytWEpiN2 + wNLossPhytNH4EpiN2 + wNMortPhytNH4WEpiN2- tNUptNH4BlueSurfN2 / uDepthWEpiN2 + tNExcrBlueSurfN2 / uDepthWEpiN2 + wNMortBlueNH4WSurfN2;
wNPrimNO3WEpiN2 = - wNUptNO3PhytEpiN2 - tNUptNO3BlueSurfN2 / uDepthWEpiN2;
wNPrimDetWEpiN2 = wNLossPhytDetEpiN2 + wNMortPhytDetWEpiN2;
tNPrimDetSN2 = tNMortPhytDetSN2 ;
wSiPrimSiO2WEpiN2 = IF (aInclStratN2 EQ FALSE) THEN wSiExcrDiatWEpiN2 - wSiUptDiatEpiN2 + tSiExcrDiatSN2 / uDepthWEpiN2 ELSE wSiExcrDiatWEpiN2 - wSiUptDiatEpiN2 ENDIF;
wSiPrimDetWEpiN2 = wSiMortDiatWEpiN2 + wSiLossDiatEpiN2;
tSiPrimDiatSN2 = IF (aInclStratN2 EQ FALSE) THEN tSiSetDiatEpiN2 - tSiResusDiatN2 - tSiExcrDiatSN2 - tSiMortDiatSN2 ELSE tSiSetDiatHypN2 - tSiResusDiatN2 - tSiExcrDiatSN2 - tSiMortDiatSN2 ENDIF;
tSiPrimDetSN2 = tSiMortDiatSN2 ;
aDepthEuphEpiN2 = cEuphN2 * aSecchiEpiN2;
aRelDepthEuphEpiN2 = aDepthEuphEpiN2 / uDepthWEpiN2;
aChlaHEpiN2 = oChlaEpiN2 * uDepthWEpiN2;
aCovPhytWEpiN2 = cCovSpPhytN2 *(oDPhytWEpiN2 * uDepthWEpiN2);
rExtChPhytEpiN2 = aExtPhytEpiN2 /(oChlaEpiN2 / mgPergN2 + NearZeroN2);
rPDZooEpiN2 = oPZooEpiN2 /(oDZooEpiN2+NearZeroN2);
rNDZooEpiN2 = oNZooEpiN2/(oDZooEpiN2+NearZeroN2);
aDFoodZooEpiN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN cPrefDiatN2 * aDDiatWEpiN2 + cPrefGrenN2 * aDGrenWEpiN2 + cPrefBlueN2 * aDBlueWEpiN2 + cPrefDetN2 * aDDetWEpiN2 ELSE cPrefDiatN2 * aDDiatWEpiN2 + cPrefGrenN2 * aDGrenWEpiN2 + cPrefBlueN2 * aDBlueWEpiN2 + cPrefBlueSurfN2 * aDBlueSurfN2 + cPrefDetN2 * aDDetWEpiN2 ENDIF;
oDFoodZooEpiN2 = aDFoodZooEpiN2 / uDepthWEpiN2;
aFiltEpiN2 = cFiltMaxN2 * uFunTmZooEpiN2 * hFiltN2 /(hFiltN2 + oDOMWEpiN2);
aDSatZooEpiN2 = oDFoodZooEpiN2 /(hFiltN2 + oDOMWEpiN2);
wDEnvZooEpiN2 = MAX(0.0,ukDIncrZooEpiN2 / cDCarrZooN2 * oDZooEpiN2*oDZooEpiN2);
wDAssZooEpiN2 = aDSatZooEpiN2 *(ukDAssTmZooEpiN2 * oDZooEpiN2 - wDEnvZooEpiN2);
wDConsZooEpiN2 = wDAssZooEpiN2 / fDAssZooN2;
wDConsDetZooEpiN2 = cPrefDetN2*oDDetWEpiN2 / oDFoodZooEpiN2 * wDConsZooEpiN2;
wDConsDiatZooEpiN2 = cPrefDiatN2*oDDiatWEpiN2 / oDFoodZooEpiN2 * wDConsZooEpiN2;
wDConsGrenZooEpiN2 = cPrefGrenN2*oDGrenWEpiN2 / oDFoodZooEpiN2 * wDConsZooEpiN2;
wDConsBlueZooEpiN2 = cPrefBlueN2*oDBlueWEpiN2 / oDFoodZooEpiN2 * wDConsZooEpiN2;
wDConsBlueZooSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE cPrefBlueSurfN2 *aDBlueSurfN2 / aDFoodZooEpiN2 * wDConsZooEpiN2 ENDIF;
tDConsBlueZooSurfN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE wDConsBlueZooSurfN2 *uDepthWEpiN2 ENDIF;
wDConsPhytZooEpiN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN wDConsDiatZooEpiN2 + wDConsGrenZooEpiN2 + wDConsBlueZooEpiN2 ELSE wDConsDiatZooEpiN2 + wDConsGrenZooEpiN2 + wDConsBlueZooEpiN2 + wDConsBlueZooSurfN2 ENDIF;
wDEgesZooEpiN2 = wDConsZooEpiN2 - wDAssZooEpiN2;
aCorDRespZooEpiN2 = MAX(cPDZooRefN2 / rPDZooEpiN2,cNDZooRefN2 / rNDZooEpiN2);
wDRespZooEpiN2 = aCorDRespZooEpiN2 * ukDRespTmZooEpiN2 * oDZooEpiN2;
wDMortZooEpiN2 = kMortZooN2 * oDZooEpiN2 +(1.0 - aDSatZooEpiN2) * wDEnvZooEpiN2;
aPFoodZooEpiN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN cPrefDiatN2*aPDiatWEpiN2 + cPrefGrenN2*aPGrenWEpiN2 + cPrefBlueN2 * aPBlueWEpiN2  + cPrefDetN2 * aPDetWEpiN2 ELSE cPrefDiatN2*aPDiatWEpiN2 + cPrefGrenN2*aPGrenWEpiN2 + cPrefBlueN2*aPBlueWEpiN2 + cPrefBlueSurfN2 *aPBlueSurfN2 + cPrefDetN2 * aPDetWEpiN2 ENDIF;
oPFoodZooEpiN2 = aPFoodZooEpiN2 / MassEpiN2;
rPDFoodZooEpiN2 = oPFoodZooEpiN2 /(oDFoodZooEpiN2+NearZeroN2);
wPConsDiatZooEpiN2 = rPDDiatWEpiN2 * wDConsDiatZooEpiN2;
wPConsGrenZooEpiN2 = rPDGrenWEpiN2 * wDConsGrenZooEpiN2;
wPConsBlueZooEpiN2 = rPDBlueWEpiN2 * wDConsBlueZooEpiN2;
wPConsBlueZooSurfN2 = rPDBlueSurfN2 * wDConsBlueZooSurfN2;
tPConsBlueZooSurfN2 = wPConsBlueZooSurfN2 *uDepthWEpiN2;
wPConsPhytZooEpiN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN wPConsDiatZooEpiN2 + wPConsGrenZooEpiN2 + wPConsBlueZooEpiN2 ELSE wPConsDiatZooEpiN2 + wPConsGrenZooEpiN2 + wPConsBlueZooEpiN2 + wPConsBlueZooSurfN2 ENDIF;
wPConsDetZooEpiN2 = rPDDetWEpiN2 * wDConsDetZooEpiN2;
wPConsZooEpiN2 = wPConsPhytZooEpiN2 + wPConsDetZooEpiN2;
afPAssZooEpiN2 = MIN(1.0,cPDZooRefN2 / rPDFoodZooEpiN2 * fDAssZooN2);
wPAssZooEpiN2 = afPAssZooEpiN2 * wPConsZooEpiN2;
wPEgesZooEpiN2 = wPConsZooEpiN2 - wPAssZooEpiN2;
wPEgesZooPO4EpiN2 = fDissEgesZooN2*wPEgesZooEpiN2;
wPEgesZooDetEpiN2 = wPEgesZooEpiN2 - wPEgesZooPO4EpiN2;
akPExcrZooEpiN2 = rPDZooEpiN2 / cPDZooRefN2 * kDRespZooN2 * uFunTmZooEpiN2;
wPExcrZooEpiN2 = akPExcrZooEpiN2*oPZooEpiN2 ;
wPMortZooEpiN2 = rPDZooEpiN2 * wDMortZooEpiN2;
wPMortZooPO4EpiN2 = fDissMortZooN2 * wPMortZooEpiN2;
wPMortZooDetEpiN2 = wPMortZooEpiN2 - wPMortZooPO4EpiN2;
aNFoodZooEpiN2 =  IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN cPrefDiatN2*aNDiatWEpiN2 + cPrefGrenN2*aNGrenWEpiN2 + cPrefBlueN2*aNBlueWEpiN2 + cPrefDetN2 * aNDetWEpiN2 ELSE cPrefDiatN2*aNDiatWEpiN2 + cPrefGrenN2*aNGrenWEpiN2 + cPrefBlueN2*aNBlueWEpiN2 + cPrefBlueSurfN2*aNBlueSurfN2 + cPrefDetN2 * aNDetWEpiN2 ENDIF;
oNFoodZooEpiN2 = aNFoodZooEpiN2 / MassEpiN2;
rNDFoodZooEpiN2 = oNFoodZooEpiN2 /(oDFoodZooEpiN2+NearZeroN2);
wNConsDiatZooEpiN2 = rNDDiatWEpiN2*wDConsDiatZooEpiN2;
wNConsGrenZooEpiN2 = rNDGrenWEpiN2*wDConsGrenZooEpiN2;
wNConsBlueZooEpiN2 = rNDBlueWEpiN2*wDConsBlueZooEpiN2;
wNConsBlueZooSurfN2 = rNDBlueSurfN2 * wDConsBlueZooSurfN2;
tNConsBlueZooSurfN2 = wNConsBlueZooSurfN2 *uDepthWEpiN2;
wNConsPhytZooEpiN2 = IF (InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN  wNConsDiatZooEpiN2 + wNConsGrenZooEpiN2 + wNConsBlueZooEpiN2 ELSE wNConsDiatZooEpiN2 + wNConsGrenZooEpiN2 + wNConsBlueZooEpiN2 + wNConsBlueZooSurfN2 ENDIF;
wNConsDetZooEpiN2 = rNDDetWEpiN2*wDConsDetZooEpiN2;
wNConsZooEpiN2 = wNConsPhytZooEpiN2 + wNConsDetZooEpiN2;
afNAssZooEpiN2 = MIN(1.0,cNDZooRefN2 / rNDFoodZooEpiN2 * fDAssZooN2);
wNAssZooEpiN2 = afNAssZooEpiN2*wNConsZooEpiN2;
wNEgesZooEpiN2 = wNConsZooEpiN2 - wNAssZooEpiN2;
wNEgesZooNH4EpiN2 = fDissEgesZooN2*wNEgesZooEpiN2;
wNEgesZooDetEpiN2 = wNEgesZooEpiN2 - wNEgesZooNH4EpiN2;
kNExcrZooEpiN2 = rNDZooEpiN2 / cNDZooRefN2 * kDRespZooN2 * uFunTmZooEpiN2;
wNExcrZooEpiN2 = kNExcrZooEpiN2*oNZooEpiN2 ;
wNMortZooEpiN2 = rNDZooEpiN2*wDMortZooEpiN2;
wNMortZooNH4EpiN2 = fDissMortZooN2*wNMortZooEpiN2;
wNMortZooDetEpiN2 = wNMortZooEpiN2 - wNMortZooNH4EpiN2;
wSiConsDiatZooEpiN2 = cSiDDiatN2 * wDConsDiatZooEpiN2;
rPDFiJvN2 = aPFiJvN2 /(aDFiJvN2+NearZeroN2);
rPDFiAdN2 = aPFiAdN2 /(aDFiAdN2+NearZeroN2);
rNDFiJvN2 = aNFiJvN2 /(aDFiJvN2+NearZeroN2);
rNDFiAdN2 = aNFiAdN2 /(aDFiAdN2+NearZeroN2);
tDReprFishN2 = IF (FALSE EQ InclSeasonN2) THEN ((1/DaysInYearN2)*fReprFishN2) * aDFiAdN2 ELSEIF (DayN2 GE cDayReprFishN2 AND DayN2 LT cDayReprFishN2 + 1.0) THEN fReprFishN2 * aDFiAdN2 * PerDayN2 ELSE 0.0 ENDIF;
tDAgeFishN2 = IF (FALSE EQ InclSeasonN2) THEN ((1/DaysInYearN2)*fAgeFishN2) * aDFiJvN2 ELSEIF (DayN2 GE 364.0) THEN fAgeFishN2 * aDFiJvN2 *PerDayN2 ELSE 0.0 ENDIF;
aDTotZooN2 = IF (aInclStratN2 EQ FALSE) THEN oDZooEpiN2 * uDepthWEpiN2 ELSE oDZooEpiN2 * uDepthWEpiN2 + oDZooHypN2 * uDepthWHypN2 ENDIF;
aPTotZooN2 = IF (aInclStratN2 EQ FALSE) THEN oPZooEpiN2 * uDepthWEpiN2 ELSE oPZooEpiN2 * uDepthWEpiN2 + oPZooHypN2 * uDepthWHypN2 ENDIF;
aNTotZooN2 = IF (aInclStratN2 EQ FALSE) THEN oNZooEpiN2 * uDepthWEpiN2 ELSE oNZooEpiN2 * uDepthWEpiN2 + oNZooHypN2 * uDepthWHypN2 ENDIF;
aDSatFiJvN2 = aDTotZooN2 * aDTotZooN2 /(hDZooFiJvN2 * hDZooFiJvN2 + aDTotZooN2 * aDTotZooN2);
tDEnvFiJvN2 = MAX(0.0,ukDIncrFiJvN2 /(cDCarrFishN2 - aDFiAdN2) * aDFiJvN2*aDFiJvN2);
tDAssFiJvN2 = aDSatFiJvN2 *(kDAssFiJvN2 * uFunTmFishN2 * aDFiJvN2 - tDEnvFiJvN2);
tDConsFiJvN2 = tDAssFiJvN2 / fDAssFiJvN2;
tDEgesFiJvN2 = tDConsFiJvN2 - tDAssFiJvN2;
tDRespFiJvN2 = (cPDFishRefN2 / rPDFiJvN2) * kDRespFiJvN2 * uFunTmFishN2 * aDFiJvN2;
tDMortFiJvN2 = kMortFiJvN2 * aDFiJvN2 +(1.0 - aDSatFiJvN2) * tDEnvFiJvN2;
tDMigrFiJvN2 = kMigrFishN2 *(cDFiJvInN2 - aDFiJvN2);
tDEnvFiAdN2 = MAX(0.0,ukDIncrFiAdN2 /(cDCarrFishN2 - aDFiJvN2) * aDFiAdN2*aDFiAdN2);
tDAssFiAdN2 = aDSatFiAdN2 *(kDAssFiAdN2 * uFunTmFishN2 * aDFiAdN2 - tDEnvFiAdN2);
tDConsFiAdN2 = tDAssFiAdN2 / fDAssFiAdN2;
tDEgesFiAdN2 = tDConsFiAdN2 - tDAssFiAdN2;
tDRespFiAdN2 = (cPDFishRefN2 / rPDFiAdN2) * kDRespFiAdN2 * uFunTmFishN2 * aDFiAdN2;
tDMortFiAdN2 = kMortFiAdN2 * aDFiAdN2 +(1.0 - aDSatFiAdN2) * tDEnvFiAdN2;
tDHarvFishN2 = ukHarvFishN2 * aDFiAdN2;
tDMigrFiAdN2 = kMigrFishN2 *(cDFiAdInN2 - aDFiAdN2);
tDMortFiJvBotN2 = fDBoneN2 * tDMortFiJvN2;
tDMortFiJvDetN2 = tDMortFiJvN2 - tDMortFiJvBotN2;
tDMortFiAdBotN2 = fDBoneN2 * tDMortFiAdN2;
tDMortFiAdDetN2 = tDMortFiAdN2 - tDMortFiAdBotN2;
tPReprFishN2 = rPDFiAdN2 * tDReprFishN2;
tPAgeFishN2 = rPDFiJvN2 * tDAgeFishN2;
tPMigrFiJvN2 = kMigrFishN2 *(cPDFishRefN2 * cDFiJvInN2 - aPFiJvN2);
tPConsFiJvN2 = rPDZooEpiN2 * tDConsFiJvN2;
afPAssFiJvN2 = MIN(1.0,cPDFishRefN2 / rPDZooEpiN2 * fDAssFiJvN2);
tPAssFiJvN2 = afPAssFiJvN2 * tPConsFiJvN2;
tPEgesFiJvN2 = tPConsFiJvN2 - tPAssFiJvN2;
tPExcrFiJvN2 = (rPDFiJvN2 / cPDFishRefN2) * kDRespFiJvN2 * uFunTmFishN2 * aPFiJvN2;
tPMortFiJvN2 = rPDFiJvN2 * tDMortFiJvN2;
tPMigrFiAdN2 = kMigrFishN2 *(cPDFishRefN2 * cDFiAdInN2 - aPFiAdN2);
tPConsFiAdN2 = rPDBentN2 * tDConsFiAdN2;
tPAssFiAdN2 = afPAssFiAdN2 * tPConsFiAdN2;
tPEgesFiAdN2 = tPConsFiAdN2 - tPAssFiAdN2;
tPExcrFiAdN2 = (rPDFiAdN2 / cPDFishRefN2) * kDRespFiAdN2 * uFunTmFishN2 * aPFiAdN2;
tPMortFiAdN2 = rPDFiAdN2 * tDMortFiAdN2;
tPHarvFishN2 = rPDFiAdN2 * tDHarvFishN2;
tPMortFiJvBotN2 = fPBoneN2 * tPMortFiJvN2;
tPMortFiJvPO4N2 = fDissMortFishN2 *(tPMortFiJvN2 - tPMortFiJvBotN2);
tPMortFiJvDetN2 = tPMortFiJvN2 - tPMortFiJvBotN2 - tPMortFiJvPO4N2;
tPMortFiAdBotN2 = fPBoneN2 * tPMortFiAdN2;
tPMortFiAdPO4N2 = fDissMortFishN2 *(tPMortFiAdN2 - tPMortFiAdBotN2);
tPMortFiAdDetN2 = tPMortFiAdN2 - tPMortFiAdBotN2 - tPMortFiAdPO4N2;
tPEgesFiJvPO4N2 = fDissEgesFishN2 * tPEgesFiJvN2;
tPEgesFiJvDetN2 = tPEgesFiJvN2 - tPEgesFiJvPO4N2;
tPEgesFiAdPO4N2 = fDissEgesFishN2 * tPEgesFiAdN2;
tPEgesFiAdDetN2 = tPEgesFiAdN2 - tPEgesFiAdPO4N2;
tNReprFishN2 = rNDFiAdN2 * tDReprFishN2;
tNAgeFishN2 = rNDFiJvN2 * tDAgeFishN2;
tNMigrFiJvN2 = kMigrFishN2 *(cNDFishRefN2 * cDFiJvInN2 - aNFiJvN2);
tNConsFiJvN2 = rNDZooEpiN2 * tDConsFiJvN2;
afNAssFiJvN2 = MIN(1.0,cNDFishRefN2 / rNDZooEpiN2 * fDAssFiJvN2);
tNAssFiJvN2 = afNAssFiJvN2 * tNConsFiJvN2;
tNEgesFiJvN2 = tNConsFiJvN2 - tNAssFiJvN2;
tNExcrFiJvN2 = (rNDFiJvN2 / cNDFishRefN2) * kDRespFiJvN2 * uFunTmFishN2 * aNFiJvN2;
tNMortFiJvN2 = rNDFiJvN2 * tDMortFiJvN2;
tNMigrFiAdN2 = kMigrFishN2 *(cNDFishRefN2 * cDFiAdInN2 - aNFiAdN2);
tNConsFiAdN2 = rNDBentN2 * tDConsFiAdN2;
tNAssFiAdN2 = afNAssFiAdN2 * tNConsFiAdN2;
tNEgesFiAdN2 = tNConsFiAdN2 - tNAssFiAdN2;
tNExcrFiAdN2 = (rNDFiAdN2 / cNDFishRefN2) * kDRespFiAdN2 * uFunTmFishN2 * aNFiAdN2;
tNMortFiAdN2 = rNDFiAdN2 * tDMortFiAdN2;
tNHarvFishN2 = rNDFiAdN2 * tDHarvFishN2;
tNMortFiAdBotN2 = fDBoneN2 * tNMortFiAdN2;
tNMortFiAdNH4N2 = fDissMortFishN2 *(tNMortFiAdN2 - tNMortFiAdBotN2);
tNMortFiAdDetN2 = tNMortFiAdN2 - tNMortFiAdBotN2 - tNMortFiAdNH4N2;
tNMortFiJvBotN2 = fDBoneN2 * tNMortFiJvN2;
tNMortFiJvNH4N2 = fDissMortFishN2 *(tNMortFiJvN2 - tNMortFiJvBotN2);
tNMortFiJvDetN2 = tNMortFiJvN2 - tNMortFiJvBotN2 - tNMortFiJvNH4N2;
tNEgesFiJvNH4N2 = fDissEgesFishN2 * tNEgesFiJvN2;
tNEgesFiJvDetN2 = tNEgesFiJvN2 - tNEgesFiJvNH4N2;
tDMigrPiscN2 = kMigrPiscN2 *(cDPiscInN2 - aDPiscN2);
aDFishN2 = aDFiJvN2 + aDFiAdN2;
aDSatPiscN2 = aDFishN2*aDFishN2 /(hDFishPiscN2*hDFishPiscN2 + aDFishN2*aDFishN2);
tDEnvPiscN2 = MAX(0.0,akDIncrPiscN2 / aDCarrPiscN2 * aDPiscN2*aDPiscN2);
tDAssPiscN2 = aDSatPiscN2 *(kDAssPiscN2 * aFunVegPiscN2 * uFunTmPiscN2 * aDPiscN2 - tDEnvPiscN2);
tDConsPiscN2 = tDAssPiscN2 / fDAssPiscN2;
tDEgesPiscN2 = tDConsPiscN2 - tDAssPiscN2;
tDConsFiJvPiscN2 = aDFiJvN2 / aDFishN2 * tDConsPiscN2;
tDConsFiAdPiscN2 = tDConsPiscN2 - tDConsFiJvPiscN2;
tDMortPiscN2 = kMortPiscN2 * aDPiscN2 +(1.0 - aDSatPiscN2) * tDEnvPiscN2;
tDMortPiscBotN2 = fDBoneN2 * tDMortPiscN2;
tDMortPiscDetN2 = tDMortPiscN2 - tDMortPiscBotN2;
tDHarvPiscN2 = ukHarvPiscN2 * aDPiscN2;
aPPiscN2 = cPDPiscN2 * aDPiscN2;
tPConsFiJvPiscN2 = rPDFiJvN2 * tDConsFiJvPiscN2;
tPConsFiAdPiscN2 = rPDFiAdN2 * tDConsFiAdPiscN2;
tPConsPiscN2 = tPConsFiJvPiscN2 + tPConsFiAdPiscN2;
rPDFoodPiscN2 = tPConsPiscN2 / tDConsPiscN2;
aNPiscN2 = cNDPiscN2 * aDPiscN2;
tNConsFiJvPiscN2 = rNDFiJvN2 * tDConsFiJvPiscN2;
tNConsFiAdPiscN2 = rNDFiAdN2 * tDConsFiAdPiscN2;
tNConsPiscN2 = tNConsFiJvPiscN2 + tNConsFiAdPiscN2;
rNDFoodPiscN2 = tNConsPiscN2 / tDConsPiscN2;
tDConsPiscNutN2 = (tDAssPiscN2 / fDAssPiscN2) * MAX (1.0, cNDPiscN2 / rNDFoodPiscN2 * fDAssPiscN2, cPDPiscN2 / rPDFoodPiscN2 * fDAssPiscN2);
tDEgesPiscNutN2 = tDConsPiscNutN2 - tDAssPiscN2;
tDConsFiJvPiscNutN2 = aDFiJvN2 / aDFishN2 * tDConsPiscNutN2;
tDConsFiAdPiscNutN2 = tDConsPiscNutN2 - tDConsFiJvPiscNutN2;
tPConsFiJvPiscNutN2 = rPDFiJvN2 * tDConsFiJvPiscNutN2;
tPConsFiAdPiscNutN2 = rPDFiAdN2 * tDConsFiAdPiscNutN2;
tPConsPiscNutN2 = tPConsFiJvPiscNutN2 + tPConsFiAdPiscNutN2;
tNConsFiJvPiscNutN2 = rNDFiJvN2 * tDConsFiJvPiscNutN2;
tNConsFiAdPiscNutN2 = rNDFiAdN2 * tDConsFiAdPiscNutN2;
tNConsPiscNutN2 = tNConsFiJvPiscNutN2 + tNConsFiAdPiscNutN2;
afPAssPiscN2 = MIN(1.0, ((cPDPiscN2 / rPDFoodPiscN2 * fDAssPiscN2) / (tDConsPiscNutN2 / tDConsPiscN2 )) );
tPAssPiscN2 = afPAssPiscN2 * tPConsPiscNutN2;
tPEgesPiscN2 = tPConsPiscNutN2 - tPAssPiscN2;
tPEgesPiscPO4N2 = fDissEgesPiscN2 * tPEgesPiscN2;
tPEgesPiscDetN2 = tPEgesPiscN2 - tPEgesPiscPO4N2;
tDRespPiscN2 = kDRespPiscN2 * uFunTmPiscN2 * aDPiscN2;
tPExcrPiscN2 = cPDPiscN2 * tDRespPiscN2;
tPMortPiscN2 = cPDPiscN2 * tDMortPiscN2;
tPMortPiscBotN2 = fPBoneN2 * tPMortPiscN2;
tPMortPiscPO4N2 = fDissMortPiscN2 *(tPMortPiscN2 - tPMortPiscBotN2);
tPMortPiscDetN2 = tPMortPiscN2 - tPMortPiscBotN2 - tPMortPiscPO4N2;
tPMigrPiscN2 = kMigrPiscN2 *(cPDPiscN2 * cDPiscInN2 - aPPiscN2);
tPHarvPiscN2 = cPDPiscN2 * tDHarvPiscN2;
afNAssPiscN2 = MIN(1.0, ((cNDPiscN2 / rNDFoodPiscN2 * fDAssPiscN2) / (tDConsPiscNutN2 / tDConsPiscN2 )) );
tNAssPiscN2 = afNAssPiscN2 * tNConsPiscNutN2;
tNEgesPiscN2 = tNConsPiscNutN2 - tNAssPiscN2;
tNEgesPiscNH4N2 = fDissEgesPiscN2 * tNEgesPiscN2;
tNEgesPiscDetN2 = tNEgesPiscN2 - tNEgesPiscNH4N2;
tNExcrPiscN2 = cNDPiscN2 * tDRespPiscN2;
tNMortPiscN2 = cNDPiscN2 * tDMortPiscN2;
tNMortPiscBotN2 = fDBoneN2 * tNMortPiscN2;
tNMortPiscNH4N2 = fDissMortPiscN2 *(tNMortPiscN2 - tNMortPiscBotN2);
tNMortPiscDetN2 = tNMortPiscN2 - tNMortPiscBotN2 - tNMortPiscNH4N2;
tNMigrPiscN2 = kMigrPiscN2 *(cNDPiscN2 * cDPiscInN2 - aNPiscN2);
tNHarvPiscN2 = cNDPiscN2 * tDHarvPiscN2;
tDWebBentN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tDMigrBentN2 + tDAssBentN2 - tDConsFiAdN2 - tDRespBentN2 - tDMortBentN2 ENDIF;
tPWebBentN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tPMigrBentN2 + tPAssBentN2 - tPConsFiAdN2 - tPExcrBentN2 - tPMortBentN2 ENDIF;
tNWebBentN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tNMigrBentN2 + tNAssBentN2 - tNConsFiAdN2 - tNExcrBentN2 - tNMortBentN2 ENDIF;
tDWebFiJvN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tDMigrFiJvN2 + tDReprFishN2 - tDAgeFishN2 + tDAssFiJvN2 - tDRespFiJvN2 - tDMortFiJvN2 - tDConsFiJvPiscNutN2 ENDIF;
tPWebFiJvN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tPMigrFiJvN2 + tPReprFishN2 - tPAgeFishN2 + tPAssFiJvN2 - tPExcrFiJvN2 - tPMortFiJvN2 - tPConsFiJvPiscNutN2 ENDIF;
tNWebFiJvN2 =IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tNMigrFiJvN2 + tNReprFishN2 - tNAgeFishN2 + tNAssFiJvN2 - tNExcrFiJvN2 - tNMortFiJvN2 - tNConsFiJvPiscNutN2 ENDIF;
tDWebFiAdN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tDMigrFiAdN2 + tDAssFiAdN2 - tDRespFiAdN2 - tDMortFiAdN2 - tDReprFishN2 + tDAgeFishN2 - tDConsFiAdPiscNutN2 - tDHarvFishN2 ENDIF;
tPWebFiAdN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tPMigrFiAdN2 + tPAssFiAdN2 - tPExcrFiAdN2 - tPMortFiAdN2 - tPReprFishN2 + tPAgeFishN2 - tPConsFiAdPiscNutN2 - tPHarvFishN2 ENDIF;
tNWebFiAdN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tNMigrFiAdN2 + tNAssFiAdN2 - tNExcrFiAdN2 - tNMortFiAdN2 - tNReprFishN2 + tNAgeFishN2 - tNConsFiAdPiscNutN2 - tNHarvFishN2 ENDIF;
tDWebPiscN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tDMigrPiscN2 + tDAssPiscN2 - tDRespPiscN2 - tDMortPiscN2 - tDHarvPiscN2 ENDIF;
wDWebZooHypN2 = IF (FALSE EQ InclWebN2 OR aInclStratN2 EQ FALSE) THEN 0.0 ELSE wDAssZooHypN2 - wDRespZooHypN2 - wDMortZooHypN2 - tDConsFiJvN2 * (( aDTotZooN2 - oDZooEpiN2 * uDepthWEpiN2) / (aDTotZooN2 + NearZeroN2)) / uDepthWHypN2 ENDIF;
wDWebDetWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsDetZooHypN2 + wDEgesZooHypN2 + wDMortZooHypN2 +(tDEgesFiJvN2 * uFiJvEgesHypN2 + tDEgesFiAdN2 * uFiAdEgesHypN2 + tDMortFiJvDetN2 * uFiJvMortHypN2 + tDMortFiAdDetN2 * uFiAdMortHypN2 + tDEgesPiscNutN2 * uPiscEgesHypN2 + tDMortPiscDetN2 * uPiscMortHypN2) / uDepthWHypN2 ENDIF;
wDWebDiatWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsDiatZooHypN2 ENDIF;
wDWebGrenWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsGrenZooHypN2 ENDIF;
wDWebBlueWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsBlueZooHypN2 ENDIF;
wDWebZooEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wDAssZooEpiN2 - wDRespZooEpiN2 - wDMortZooEpiN2 - tDConsFiJvN2 * (oDZooEpiN2 * uDepthWEpiN2 / (aDTotZooN2 + NearZeroN2) ) / uDepthWEpiN2 ENDIF;
wDWebDetWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsDetZooEpiN2 + wDEgesZooEpiN2 + wDMortZooEpiN2 +(tDEgesFiJvN2 * ( 1.0 - uFiJvEgesHypN2 ) + tDEgesFiAdN2 * ( 1.0 - uFiAdEgesHypN2 ) + tDMortFiJvDetN2 * ( 1.0 - uFiJvMortHypN2 ) + tDMortFiAdDetN2 * ( 1.0 - uFiAdMortHypN2 ) + tDEgesPiscNutN2 * ( 1.0 - uPiscEgesHypN2 ) + tDMortPiscDetN2 * ( 1.0 - uPiscMortHypN2)) / uDepthWEpiN2 ENDIF;
wDWebDiatWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsDiatZooEpiN2 ENDIF;
wDWebGrenWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsGrenZooEpiN2 ENDIF;
wDWebBlueWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDConsBlueZooEpiN2 ENDIF;
tDWebBlueSurfN2 = IF (InclWebN2 EQ FALSE OR InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE - tDConsBlueZooSurfN2 ENDIF;
tDWebTotTN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wDRespZooEpiN2 * uDepthWEpiN2 - wDRespZooHypN2 * uDepthWHypN2 + tDMigrFiJvN2 + tDMigrFiAdN2 + tDMigrPiscN2 + tDMigrBentN2 - tDRespFiJvN2 - tDRespFiAdN2 - tDRespPiscN2 - tDRespBentN2 - tDMortFiJvBotN2 - tDMortFiAdBotN2- tDMortPiscBotN2 - tDHarvFishN2 - tDHarvPiscN2 ENDIF;
wPWebZooHypN2 = IF (FALSE EQ InclWebN2 OR aInclStratN2 EQ FALSE) THEN 0.0 ELSE wPAssZooHypN2 - wPExcrZooHypN2 - wPMortZooHypN2 - tPConsFiJvN2 * (( aPTotZooN2 - oPZooEpiN2 * uDepthWEpiN2 ) / (aPTotZooN2 + NearZeroN2) ) / uDepthWHypN2 ENDIF;
wPWebPO4WHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wPExcrZooHypN2 + wPEgesZooPO4HypN2 + wPMortZooPO4HypN2 +(tPExcrFiJvN2 *uFiJvExcrHypN2 + tPExcrFiAdN2 * uFiAdExcrHypN2 + tPEgesFiJvPO4N2 * uFiJvEgesHypN2 + tPEgesFiAdPO4N2 * uFiAdEgesHypN2 + tPMortFiJvPO4N2 * uFiJvMortHypN2 + tPMortFiAdPO4N2 * uFiAdMortHypN2+ tPExcrPiscN2 * uPiscExcrHypN2 + tPEgesPiscPO4N2 * uPiscEgesHypN2 + tPMortPiscPO4N2 * uPiscMortHypN2 ) / uDepthWHypN2 ENDIF;
wPWebDetWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsDetZooHypN2 + wPEgesZooDetHypN2 + wPMortZooDetHypN2 +(tPEgesFiJvDetN2 * uFiJvEgesHypN2 + tPEgesFiAdDetN2 * uFiAdEgesHypN2+ tPMortFiJvDetN2 * uFiJvMortHypN2 + tPMortFiAdDetN2 * uFiAdMortHypN2+ tPEgesPiscDetN2 * uPiscEgesHypN2+ tPMortPiscDetN2 * uPiscMortHypN2) / uDepthWHypN2 ENDIF;
wPWebDiatWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsDiatZooHypN2 ENDIF;
wPWebGrenWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsGrenZooHypN2 ENDIF;
wPWebBlueWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsBlueZooHypN2 ENDIF;
wPWebZooEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wPAssZooEpiN2 - wPExcrZooEpiN2 - wPMortZooEpiN2 - tPConsFiJvN2 * (oPZooEpiN2 * uDepthWEpiN2 / (aPTotZooN2 + NearZeroN2)) / uDepthWEpiN2 ENDIF;
wPWebPO4WEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wPExcrZooEpiN2 + wPEgesZooPO4EpiN2 + wPMortZooPO4EpiN2 +(tPExcrFiJvN2 * ( 1.0 -uFiJvExcrHypN2 ) + tPExcrFiAdN2 * ( 1.0 - uFiAdExcrHypN2 )+ tPEgesFiJvPO4N2 * ( 1.0 - uFiJvEgesHypN2 ) + tPEgesFiAdPO4N2 * ( 1.0 - uFiAdEgesHypN2 ) + tPMortFiJvPO4N2 * ( 1.0 - uFiJvMortHypN2 ) + tPMortFiAdPO4N2 * ( 1.0 - uFiAdMortHypN2 )+ tPExcrPiscN2 * ( 1.0 - uPiscExcrHypN2 ) + tPEgesPiscPO4N2 * ( 1.0 - uPiscEgesHypN2 ) + tPMortPiscPO4N2 * ( 1.0 - uPiscMortHypN2)) / uDepthWEpiN2 ENDIF;
wPWebDetWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsDetZooEpiN2 + wPEgesZooDetEpiN2 + wPMortZooDetEpiN2 +(tPEgesFiJvDetN2 * ( 1.0 - uFiJvEgesHypN2 ) + tPEgesFiAdDetN2 * ( 1.0 - uFiAdEgesHypN2 )+ tPMortFiJvDetN2 * ( 1.0 - uFiJvMortHypN2 ) + tPMortFiAdDetN2 * ( 1.0 - uFiAdMortHypN2 )+ tPEgesPiscDetN2 * ( 1.0 - uPiscEgesHypN2 )+ tPMortPiscDetN2 * ( 1.0 - uPiscMortHypN2 )) / uDepthWEpiN2 ENDIF;
wPWebDiatWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsDiatZooEpiN2 ENDIF;
wPWebGrenWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsGrenZooEpiN2 ENDIF;
wPWebBlueWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wPConsBlueZooEpiN2 ENDIF;
tPWebBlueSurfN2 = IF (InclWebN2 EQ FALSE OR InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE - tPConsBlueZooSurfN2 ENDIF;
tPWebTotTN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tPMigrFiJvN2 + tPMigrFiAdN2 + tPMigrPiscN2 + tPMigrBentN2 - tPMortFiJvBotN2 - tPMortFiAdBotN2- tPMortPiscBotN2 - tPHarvFishN2 - tPHarvPiscN2 ENDIF;
tNEgesFiAdNH4N2 = fDissEgesFishN2 * tNEgesFiAdN2;
tNEgesFiAdDetN2 = tNEgesFiAdN2 - tNEgesFiAdNH4N2;
wNWebNO3WHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE 0.0 ENDIF;
wNWebNO3WEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE 0.0 ENDIF;
wNWebZooHypN2 = IF (FALSE EQ InclWebN2 OR aInclStratN2 EQ FALSE) THEN 0.0 ELSE wNAssZooHypN2 - wNExcrZooHypN2 - wNMortZooHypN2 - tNConsFiJvN2 * (( aNTotZooN2 -oNZooEpiN2 * uDepthWEpiN2 ) / (aNTotZooN2 + NearZeroN2) ) / uDepthWHypN2 ENDIF;
wNWebNH4WHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wNExcrZooHypN2 + wNEgesZooNH4HypN2 + wNMortZooNH4HypN2 +(tNExcrFiJvN2 * uFiJvExcrHypN2 + tNExcrFiAdN2 * uFiAdExcrHypN2 + tNEgesFiJvNH4N2 * uFiJvEgesHypN2+ tNEgesFiAdNH4N2 * uFiAdEgesHypN2 + tNMortFiAdNH4N2 *uFiAdMortHypN2+ tNMortFiJvNH4N2*uFiJvMortHypN2 + tNExcrPiscN2 *uPiscExcrHypN2 + tNEgesPiscNH4N2 *uPiscEgesHypN2 + tNMortPiscNH4N2 *uPiscMortHypN2) / uDepthWHypN2 ENDIF;
wNWebDetWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsDetZooHypN2 + wNEgesZooDetHypN2 + wNMortZooDetHypN2 +(tNEgesFiJvDetN2 * uFiJvEgesHypN2 +tNEgesFiAdDetN2 * uFiAdEgesHypN2+ tNMortFiJvDetN2 * uFiJvMortHypN2 + tNMortFiAdDetN2 * uFiAdMortHypN2 + tNEgesPiscDetN2 * uPiscEgesHypN2 + tNMortPiscDetN2 * uPiscMortHypN2) / uDepthWHypN2 ENDIF;
wNWebDiatWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsDiatZooHypN2 ENDIF;
wNWebGrenWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsGrenZooHypN2 ENDIF;
wNWebBlueWHypN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsBlueZooHypN2 ENDIF;
wNWebZooEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wNAssZooEpiN2 - wNExcrZooEpiN2 - wNMortZooEpiN2 - tNConsFiJvN2 * (oNZooEpiN2 * uDepthWEpiN2 / (aNTotZooN2 + NearZeroN2) ) / uDepthWEpiN2 ENDIF;
wNWebNH4WEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wNExcrZooEpiN2 + wNEgesZooNH4EpiN2 + wNMortZooNH4EpiN2 +(tNExcrFiJvN2 * ( 1.0 - uFiJvExcrHypN2) + tNExcrFiAdN2 * ( 1.0 - uFiAdExcrHypN2) + tNEgesFiJvNH4N2 * ( 1.0 - uFiJvEgesHypN2 ) + tNEgesFiAdNH4N2 * ( 1.0 - uFiAdEgesHypN2 ) + tNMortFiAdNH4N2 * ( 1.0 -uFiAdMortHypN2 ) + tNMortFiJvNH4N2* ( 1.0 -uFiJvMortHypN2) + tNExcrPiscN2 * ( 1.0 -uPiscExcrHypN2 ) + tNEgesPiscNH4N2 * ( 1.0 -uPiscEgesHypN2 ) + tNMortPiscNH4N2 * ( 1.0 -uPiscMortHypN2)) / uDepthWEpiN2 ENDIF;
wNWebDetWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsDetZooEpiN2 + wNEgesZooDetEpiN2 + wNMortZooDetEpiN2 +(tNEgesFiJvDetN2 * ( 1.0 - uFiJvEgesHypN2 ) +tNEgesFiAdDetN2 * ( 1.0 - uFiAdEgesHypN2 ) + tNMortFiJvDetN2 * ( 1.0 - uFiJvMortHypN2 ) + tNMortFiAdDetN2 * ( 1.0 - uFiAdMortHypN2 ) + tNEgesPiscDetN2 * ( 1.0 - uPiscEgesHypN2 ) + tNMortPiscDetN2 * ( 1.0 - uPiscMortHypN2 )) / uDepthWEpiN2 ENDIF;
wNWebDiatWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsDiatZooEpiN2 ENDIF;
wNWebGrenWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsGrenZooEpiN2 ENDIF;
wNWebBlueWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE - wNConsBlueZooEpiN2 ENDIF;
tNWebBlueSurfN2 = IF (InclWebN2 EQ FALSE OR InclSurfN2 EQ FALSE OR aDBlueSurfN2 LT cDBlueSurfMinN2) THEN 0.0 ELSE - tNConsBlueZooSurfN2 ENDIF;
tNWebTotTN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE tNMigrFiJvN2 + tNMigrFiAdN2 + tNMigrPiscN2 + tNMigrBentN2 - tNMortFiJvBotN2- tNMortFiAdBotN2 - tNMortPiscBotN2 - tNHarvFishN2 - tNHarvPiscN2 ENDIF;
wSiWebDetWEpiN2 = IF (FALSE EQ InclWebN2) THEN 0.0 ELSE wSiConsDiatZooEpiN2 ENDIF;
aPrefAveEpiN2 = (cPrefDiatN2 * oDDiatWEpiN2 + cPrefGrenN2 * oDGrenWEpiN2 + cPrefBlueN2 * oDBlueWEpiN2 + cPrefDetN2 * oDDetWEpiN2) / oDOMWEpiN2;
wDConsZoo2EpiN2 = aFiltEpiN2 * aPrefAveEpiN2 * oDOMWEpiN2 * oDZooEpiN2;
aDConsZooSpEpiN2 = wDConsZooEpiN2 / oDZooEpiN2;
aDAssZooSpEpiN2 = wDAssZooEpiN2 / oDZooEpiN2;
aDGrazSpEpiN2 = wDConsZooEpiN2 / oDOMWEpiN2;
aPConsZooSpEpiN2 = wPConsZooEpiN2 / oPZooEpiN2;
aPGrazSpEpiN2 = wPConsZooEpiN2 / oPOMWEpiN2;
aNConsZooSpEpiN2 = wNConsZooEpiN2 / oNZooEpiN2;
aNGrazSpEpiN2 = wNConsZooEpiN2 / oNOMWEpiN2;
tDSetTotEpiN2 = tDSetIMEpiN2 + tDSetDetEpiN2 + tDSetPhytEpiN2;
tPSetTotEpiN2 = tPSetAIMEpiN2 + tPSetDetEpiN2 + tPSetPhytEpiN2;
tNSetTotEpiN2 = tNSetDetEpiN2 + tNSetPhytEpiN2;
tDResusTotN2 = tDResusDeadN2 + tDResusPhytTotN2;
tPResusTotN2 = tPResusDetN2 + tPResusAIMN2 + tPResusPhytN2 + tPResusPO4N2;
tNResusTotN2 = tNResusDetN2 + tNResusNH4N2 + tNResusNO3N2 + tNResusPhytN2;
aDepthStartN2 = IF (sTimeN2 EQ bTimeDredN2) THEN uDepthWN2 ELSE aDepthStartN2 ENDIF;
akDredDepthN2 = IF ((sTimeN2 GE bTimeDredN2) AND (sTimeN2 LT bTimeDredN2 + cLengDredN2) AND (aDepthStartN2 LE cDepthRefN2 - cDepthSN2)) THEN (LN(cDepthRefN2 / aDepthStartN2)) / cLengDredN2 ELSE 0.0 ENDIF;
akDredN2 = IF ((sTimeN2 GE bTimeDredN2) AND (sTimeN2 LT bTimeDredN2 + cLengDredN2) AND (aDepthStartN2 LE cDepthRefN2 - cDepthSN2)) THEN (- LN(1.0 - fEffDredN2)) / cLengDredN2 ELSE 0.0 ENDIF;
akDredBentN2 = IF ((sTimeN2 GE bTimeDredN2) AND (sTimeN2 LT bTimeDredN2 + cLengDredN2) AND (aDepthStartN2 LE cDepthRefN2 - cDepthSN2)) THEN (- LN(1.0 - fEffDredBentN2)) / cLengDredN2 ELSE 0.0 ENDIF;
vDredDepthWN2 =IF (aInclStratN2 EQ TRUE) THEN 0.0 ELSE akDredDepthN2 * uDepthWN2 ENDIF;
tDDredDetSN2 = akDredN2 * aDDetSN2;
tPDredDetSN2 = akDredN2 * aPDetSN2;
tNDredDetSN2 = akDredN2 * aNDetSN2;
tSiDredDetSN2 = akDredN2 * aSiDetSN2;
tPDredAIMSN2 = akDredN2 * aPAIMSN2;
tDDredNetSoilN2 = -(tDDredDetSN2 / cRhoOMN2) * bRhoSolidSoilN2;
tDDredNetIMSN2 = (1.0 - fDOrgSoilN2) * tDDredNetSoilN2;
tDDredNetHumSN2 = fDOrgSoilN2 * tDDredNetSoilN2;
tPDredNetHumSN2 = cPDSoilOMN2 * tDDredNetHumSN2;
tNDredNetHumSN2 = cNDSoilOMN2 * tDDredNetHumSN2;
tDDredDiatSN2 = akDredN2 * aDDiatSN2;
tPDredDiatSN2 = akDredN2 * aPDiatSN2;
tNDredDiatSN2 = akDredN2 * aNDiatSN2;
tDDredGrenSN2 = akDredN2 * aDGrenSN2;
tPDredGrenSN2 = akDredN2 * aPGrenSN2;
tNDredGrenSN2 = akDredN2 * aNGrenSN2;
tDDredBlueSN2 = akDredN2 * aDBlueSN2;
tPDredBlueSN2 = akDredN2 * aPBlueSN2;
tNDredBlueSN2 = akDredN2 * aNBlueSN2;
tDDredPhytSN2 = tDDredDiatSN2+tDDredGrenSN2+tDDredBlueSN2;
tPDredPhytSN2 = tPDredDiatSN2+tPDredGrenSN2+tPDredBlueSN2;
tNDredPhytSN2 = tNDredDiatSN2+tNDredGrenSN2+tNDredBlueSN2;
tDDredBentN2 = IF (InclWebN2 EQ TRUE) THEN akDredBentN2 * aDBentN2 ELSE 0.0 ENDIF;
tPDredBentN2 = IF (InclWebN2 EQ TRUE) THEN akDredBentN2 * aPBentN2 ELSE 0.0 ENDIF;
tNDredBentN2 = IF (InclWebN2 EQ TRUE) THEN akDredBentN2 * aNBentN2 ELSE 0.0 ENDIF;
tDDredVegN2 = akDredN2 * aDVegN2;
tPDredVegN2 = akDredN2 * aPVegN2;
tNDredVegN2 = akDredN2 * aNVegN2;
tDDredNetTotN2 = tDDredDetSN2 - tDDredNetSoilN2 + tDDredPhytSN2 + tDDredBentN2 + tDDredVegN2;
tPDredNetTotN2 = tPDredDetSN2 - tPDredNetHumSN2 + tPDredAIMSN2 + tPDredPhytSN2 + tPDredBentN2 + tPDredVegN2;
tNDredNetTotN2 = tNDredDetSN2 - tNDredNetHumSN2 + tNDredPhytSN2 + tNDredBentN2 + tNDredVegN2;
tSiDredTotN2 = tSiDredDetSN2 + cSiDDiatN2 * tDDredDiatSN2;
tDIMSN2 = tDAbioIMSN2;
tDHumSN2 = tDAbioHumSN2;
tDDetSN2 = tDAbioDetSN2 + tDPrimDetSN2 + tDWebDetSN2 + tDBedDetSEpiN2 + tDBedDetSHypN2;
vDeltaSN2 = (tDIMSN2 / cRhoIMN2 +(tDHumSN2 + tDDetSN2) / cRhoOMN2)/(1.0 - bPorSN2);
vDeltaWN2 = IF (ConstDepthN2 EQ TRUE ) THEN 0.0 ELSE - vDeltaSN2 ENDIF;
tDBurIMN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN ((tDHumSN2 + tDDetSN2) +(cRhoOMN2 / cRhoIMN2) * tDIMSN2) / ((aDHumSN2 + aDDetSN2) / aDIMSN2 + cRhoOMN2 / cRhoIMN2) ELSE ((tDHumSN2 + tDDetSN2) +(cRhoOMN2 / cRhoIMN2) * tDIMSN2) / (fDOrgSoilN2 /(1.0 - fDOrgSoilN2) + cRhoOMN2 / cRhoIMN2) ENDIF;
tDBurOMN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN (aDHumSN2 + aDDetSN2) / aDIMSN2 * tDBurIMN2 ELSE fDOrgSoilN2 /(1.0 - fDOrgSoilN2) * tDBurIMN2 ENDIF;
tDBurDetN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN aDDetSN2 /(aDHumSN2 + aDDetSN2) * tDBurOMN2 ELSE 0.0 ENDIF;
tDBurHumN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN tDBurOMN2 - tDBurDetN2 ELSE tDBurOMN2 ENDIF;
tDBurTotN2 =IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN2 GE 0.0) THEN tDBurIMN2 + tDBurOMN2 ELSE tDBurIMN2 + tDBurOMN2 ENDIF;
tPBurHumN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN rPDHumSN2 * tDBurHumN2 ELSE cPDSoilOMN2 * tDBurHumN2 ENDIF;
tPBurDetN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN2 GE 0.0) THEN rPDDetSN2 * tDBurDetN2 ELSE 0.0 ENDIF;
tPBurAIMN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN aPAIMSN2 / aDIMSN2 * tDBurIMN2 ELSE 0.0 ENDIF;
tPBurPO4N2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN aPO4SN2 *(vDeltaSN2 / cDepthSN2) ELSE cPO4GroundN2 *(bPorSN2 * vDeltaSN2) ENDIF;
tPBurTotN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN tPBurDetN2 + tPBurHumN2 + tPBurAIMN2 + tPBurPO4N2 ELSE tPBurHumN2 + tPBurAIMN2 + tPBurPO4N2 ENDIF;
tNBurHumN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN rNDHumSN2 * tDBurHumN2 ELSE cNDSoilOMN2 * tDBurHumN2 ENDIF;
tNBurDetN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN rNDDetSN2 * tDBurDetN2 ELSE 0.0 ENDIF;
tNBurNH4N2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN aNH4SN2 *(vDeltaSN2 / cDepthSN2) ELSE cNH4GroundN2 *(bPorSN2 * vDeltaSN2) ENDIF;
tNBurNO3N2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN aNO3SN2 *(vDeltaSN2 / cDepthSN2) ELSE cNO3GroundN2 *(bPorSN2 * vDeltaSN2) ENDIF;
tNBurTotN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN tNBurDetN2 + tNBurHumN2 + tNBurNH4N2 + tNBurNO3N2 ELSE tNBurHumN2 + tNBurNH4N2 + tNBurNO3N2 ENDIF;
tSiBurDetN2 = IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN rSiDDetSN2 * tDBurDetN2 ELSE 0.0 ENDIF;
tSiBurTotN2 =IF (InclBurN2 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN2 GE 0.0) THEN tSiBurDetN2 ELSE 0.0 ENDIF;
aRelDeltaWEpiN2 = IF ( aInclStratN2 EQ TRUE ) THEN (vDeltaWN2 ) / uDepthWEpiN2 ELSE (vDeltaWN2 + vDredDepthWN2) / uDepthWEpiN2 ENDIF;
aRelDeltaWHypN2 = IF ( aInclStratN2 EQ FALSE ) THEN 0.0 ELSE (vDeltaWN2 + vDredDepthWN2) / uDepthWHypN2 ENDIF ;
aPFishN2 = aPFiJvN2 + aPFiAdN2;
aNFishN2 = aNFiJvN2 + aNFiAdN2;
aDRelTotTN2 = uDepthWHypN2 * aRelDeltaWHypN2 * ( oDDetWHypN2 + oDIMWHypN2 + oDDiatWHypN2 + oDGrenWHypN2 + oDBlueWHypN2 + oDZooHypN2 ) + fMarshN2 * uDepthWMN2 * aRelDeltaWMN2 * ( oDDetWMN2 + oDIMWMN2 + oDDiatWMN2 + oDGrenWMN2 + oDBlueWMN2 + oDZooMN2) + uDepthWEpiN2 * aRelDeltaWEpiN2 * (oDDetWEpiN2 + oDIMWEpiN2 + oDDiatWEpiN2 + oDGrenWEpiN2 + oDBlueWEpiN2 + oDZooEpiN2 );
aNRelTotTN2 = uDepthWHypN2 * aRelDeltaWHypN2 * ( oNH4WHypN2 + oNO3WHypN2 + oNDetWHypN2 + oNDiatWHypN2 + oNGrenWHypN2 + oNBlueWHypN2 + oNZooHypN2 ) + fMarshN2 * uDepthWMN2 * aRelDeltaWMN2 * ( oNH4WMN2 + oNO3WMN2 + oNDetWMN2 + oNDiatWMN2 + oNGrenWMN2 + oNBlueWMN2 + oNZooMN2 ) + uDepthWEpiN2 * aRelDeltaWEpiN2 * ( oNH4WEpiN2 + oNO3WEpiN2 + oNDetWEpiN2 + oNDiatWEpiN2 + oNGrenWEpiN2 + oNBlueWEpiN2 + oNZooEpiN2 );
aPRelTotTN2 = uDepthWHypN2 * aRelDeltaWHypN2 * ( oPO4WHypN2 + oPAIMWHypN2 + oPDetWHypN2 + oPDiatWHypN2 + oPGrenWHypN2 + oPBlueWHypN2 + oPZooHypN2 ) + fMarshN2 * uDepthWMN2 * aRelDeltaWMN2 * (oPO4WMN2 + oPAIMWMN2 + oPDetWMN2 + oPDiatWMN2 + oPGrenWMN2 + oPBlueWMN2 + oPZooMN2 ) + uDepthWEpiN2 * aRelDeltaWEpiN2 * (oPO4WEpiN2 + oPAIMWEpiN2 + oPDetWEpiN2 + oPDiatWEpiN2 + oPGrenWEpiN2 + oPBlueWEpiN2 + oPZooEpiN2 );
aSiRelTotTN2 = uDepthWHypN2 * aRelDeltaWHypN2 * ( oSiO2WHypN2 + oSiDetWHypN2 + cSiDDiatN2*oDDiatWHypN2) + fMarshN2 * uDepthWMN2 * aRelDeltaWMN2 * ( oSiO2WMN2 + oSiDetWMN2 + cSiDDiatN2*oDDiatWMN2) + uDepthWEpiN2 * aRelDeltaWEpiN2 * ( oSiO2WEpiN2 + oSiDetWEpiN2 + cSiDDiatN2*oDDiatWEpiN2);
aO2RelTotTN2 = uDepthWHypN2 * aRelDeltaWHypN2* oO2WHypN2 + fMarshN2 * uDepthWMN2 * aRelDeltaWMN2 * oO2WMN2 + uDepthWEpiN2 * aRelDeltaWEpiN2 * oO2WEpiN2 ;
aDTotTHypN2 = IF (aInclStratN2 EQ TRUE) THEN (oDIMWHypN2+oDDetWHypN2+oDDiatWHypN2+oDGrenWHypN2+oDBlueWHypN2+oDZooHypN2) * uDepthWHypN2 ELSE 0.0 ENDIF;
aNTotTHypN2 = IF (aInclStratN2 EQ TRUE) THEN (oNH4WHypN2+oNO3WHypN2+oNDetWHypN2+oNDiatWHypN2+oNGrenWHypN2+oNBlueWHypN2 +oNZooHypN2)*uDepthWHypN2 ELSE 0.0 ENDIF;
aPTotTHypN2 = IF (aInclStratN2 EQ TRUE) THEN (oPO4WHypN2+oPDetWHypN2+oPDiatWHypN2+oPGrenWHypN2+oPBlueWHypN2 +oPZooHypN2+oPAIMWHypN2) * uDepthWHypN2 ELSE 0.0 ENDIF;
aSiTotTHypN2 = IF (aInclStratN2 EQ TRUE) THEN (oSiO2WHypN2 + oSiDetWHypN2 + cSiDDiatN2*oDDiatWHypN2) *uDepthWHypN2 ELSE 0.0 ENDIF;
aO2TotTHypN2 = IF (aInclStratN2 EQ TRUE) THEN (oO2WHypN2 ) *uDepthWHypN2 ELSE 0.0 ENDIF;
aDTotTN2 = aDTotTHypN2 + (oDIMWEpiN2+oDDetWEpiN2+oDDiatWEpiN2+oDGrenWEpiN2+oDBlueWEpiN2+oDZooEpiN2) * uDepthWEpiN2 +aDFishN2+aDPiscN2+aDVegN2 +aDIMSN2+aDHumSN2+aDDetSN2+aDDiatSN2+aDGrenSN2+aDBlueSN2+aDBentN2 + aDTotMN2 + aDBlueSurfN2;
aNTotTN2 = aNTotTHypN2+ (oNH4WEpiN2+oNO3WEpiN2+oNDetWEpiN2+oNDiatWEpiN2+oNGrenWEpiN2+oNBlueWEpiN2 +oNZooEpiN2)*uDepthWEpiN2 +aNFishN2+aNPiscN2+aNVegN2 +aNH4SN2+aNO3SN2+aNDetSN2+aNHumSN2+aNDiatSN2+aNGrenSN2+aNBlueSN2 +aNBentN2 + aNTotMN2 + aNBlueSurfN2;
aPTotTN2 = aPTotTHypN2 + (oPO4WEpiN2+oPDetWEpiN2+oPDiatWEpiN2+oPGrenWEpiN2+oPBlueWEpiN2 +oPZooEpiN2+oPAIMWEpiN2) * uDepthWEpiN2 +aPFishN2+aPPiscN2+aPVegN2 +aPO4SN2+aPDetSN2+aPHumSN2+aPDiatSN2+aPGrenSN2+aPBlueSN2 +aPAIMSN2+aPBentN2 + aPTotMN2 +aPBlueSurfN2;
aSiTotTN2 = aSiTotTHypN2 + (oSiO2WEpiN2 + oSiDetWEpiN2 + cSiDDiatN2*oDDiatWEpiN2) *uDepthWEpiN2 + aSiDetSN2 + cSiDDiatN2*aDDiatSN2 + aSiTotMN2;
aO2TotTN2 = aO2TotTHypN2 + ( oO2WEpiN2) *uDepthWEpiN2 + aO2TotMN2;
tDBedTotTN2 = IF InclVegN2 EQ TRUE THEN tDMigrVegN2 + tDProdVegHypN2+ tDProdVegEpiN2 - tDRespVegN2 - tDManVegN2 - tDAssVegBirdN2 ELSE 0.0 ENDIF;
tPBedTotTN2 = IF InclVegN2 EQ TRUE THEN tPMigrVegN2 - tPManVegN2 - tPAssVegBirdN2 ELSE 0.0 ENDIF;
tNBedTotTN2 = IF InclVegN2 EQ TRUE THEN tNMigrVegN2 - tNManVegN2 - tNAssVegBirdN2 ELSE 0.0 ENDIF ;
aDErrorN2 = aDTotTN2 - aDExtTotTN2;
aNErrorN2 = aNTotTN2 - aNExtTotTN2;
aPErrorN2 = aPTotTN2 - aPExtTotTN2;
aSiErrorN2 = aSiTotTN2 - aSiExtTotTN2;
aO2ErrorN2 = aO2TotTN2 - aO2ExtTotTN2;
aDepthErrorN2 = sDepthWN2 - aDepthExtTotTN2;
cCheckVegHeightN2 = IF ( aVegWinN2 EQ 1 AND  uVegHeightN2 LT MIN (cVegHeightWinN2, uDepthWN2) ) THEN 1.0 ELSEIF ( aVegWinN2 EQ 1 AND  uVegHeightN2 GT MIN (cVegHeightWinN2, uDepthWN2) ) THEN 2.0 ELSEIF ( aVegWinN2 EQ 0 AND  uVegHeightN2 LT MIN (cVegHeightN2, uDepthWN2) ) THEN  3.0 ELSEIF ( aVegWinN2 EQ 0 AND  uVegHeightN2 GT MIN (cVegHeightN2, uDepthWN2) ) THEN 4.0 ELSE 0.0 ENDIF;
sTimeN3 = time + DayStartN3;
DaysInYearN3 = DaysPerYearN3* 1;
aInclStratN3 =IF ( InclStratN3 EQ FALSE ) THEN 0.0 ELSE 1.0 ENDIF;
uDepthMixMeasN3 =IF ( calcMixDepthN3 EQ TRUE ) THEN cAMixN3 * POW ( cFetchN3 , (cBMixN3) ) ELSEIF (ReadMixDepthN3 EQ TRUE) THEN mMixDepthN3 ELSE cMixDepthN3 ENDIF;
uDepthWN3= IF sDepthWN3 GT (cMinDepthHypEpiN3 + cMinDepthHypEpiN3) THEN sDepthWN3 ELSE (cMinDepthHypEpiN3 + cMinDepthHypEpiN3) ENDIF;
uDepthWHypN3 =IF ( ( aInclStratN3 EQ TRUE ) AND ((uDepthWN3 - sMixDepthWN3 ) GE cMinDepthHypEpiN3 ) ) THEN uDepthWN3 - sMixDepthWN3  ELSE cMinDepthHypEpiN3 ENDIF;
uDepthWEpiN3 =IF( ( aInclStratN3 EQ TRUE ) AND ( sMixDepthWN3 GE cMinDepthHypEpiN3 ) AND ( uDepthWN3 GE sMixDepthWN3 ) ) THEN sMixDepthWN3 ELSEIF ( ( aInclStratN3 EQ TRUE ) AND ( (sMixDepthWN3 LE cMinDepthHypEpiN3 ) OR (uDepthWN3 LE cMinDepthHypEpiN3 ) ) ) THEN cMinDepthHypEpiN3 ELSEIF ( aInclStratN3 EQ FALSE) THEN uDepthWN3 ELSE uDepthWN3 - uDepthWHypN3 ENDIF;
MassHypN3 = IF CalcMassN3 EQ TRUE THEN uDepthWHypN3 ELSE 1.0 ENDIF;
MassEpiN3 = IF CalcMassN3 EQ TRUE THEN uDepthWEpiN3 ELSE 1.0 ENDIF;
MassWMN3 = IF CalcMassN3 EQ TRUE THEN sDepthWMN3 ELSE 1.0 ENDIF;
oNH4WHypN3= IF sNH4WHypN3 GT NearZeroN3 THEN sNH4WHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNO3WHypN3= IF sNO3WHypN3 GT NearZeroN3 THEN sNO3WHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPO4WHypN3= IF sPO4WHypN3 GT NearZeroN3 THEN sPO4WHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPAIMWHypN3= IF sPAIMWHypN3 GT NearZeroN3 THEN sPAIMWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oSiO2WHypN3= IF sSiO2WHypN3 GT NearZeroN3 THEN sSiO2WHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oO2WHypN3= IF sO2WHypN3 GT NearZeroN3 THEN sO2WHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDDetWHypN3= IF sDDetWHypN3 GT NearZeroN3 THEN sDDetWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNDetWHypN3= IF sNDetWHypN3 GT NearZeroN3 THEN sNDetWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPDetWHypN3= IF sPDetWHypN3 GT NearZeroN3 THEN sPDetWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oSiDetWHypN3= IF sSiDetWHypN3 GT NearZeroN3 THEN sSiDetWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDIMWHypN3= IF sDIMWHypN3 GT NearZeroN3 THEN sDIMWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDDiatWHypN3= IF sDDiatWHypN3 GT NearZeroN3 THEN sDDiatWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNDiatWHypN3= IF sNDiatWHypN3 GT NearZeroN3 THEN sNDiatWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPDiatWHypN3= IF sPDiatWHypN3 GT NearZeroN3 THEN sPDiatWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDGrenWHypN3= IF sDGrenWHypN3 GT NearZeroN3 THEN sDGrenWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNGrenWHypN3= IF sNGrenWHypN3 GT NearZeroN3 THEN sNGrenWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPGrenWHypN3= IF sPGrenWHypN3 GT NearZeroN3 THEN sPGrenWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDBlueWHypN3= IF sDBlueWHypN3 GT NearZeroN3 THEN sDBlueWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNBlueWHypN3= IF sNBlueWHypN3 GT NearZeroN3 THEN sNBlueWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPBlueWHypN3= IF sPBlueWHypN3 GT NearZeroN3 THEN sPBlueWHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oDZooHypN3= IF sDZooHypN3 GT NearZeroN3 THEN sDZooHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oNZooHypN3= IF sNZooHypN3 GT NearZeroN3 THEN sNZooHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
oPZooHypN3= IF sPZooHypN3 GT NearZeroN3 THEN sPZooHypN3 / MassHypN3 ELSE NearZeroN3 ENDIF;
aDFiAdN3= IF sDFiAdN3 GT NearZeroN3 THEN sDFiAdN3 ELSE NearZeroN3 ENDIF;
aDFiJvN3= IF sDFiJvN3 GT NearZeroN3 THEN sDFiJvN3 ELSE NearZeroN3 ENDIF;
aNFiAdN3= IF sNFiAdN3 GT NearZeroN3 THEN sNFiAdN3 ELSE NearZeroN3 ENDIF;
aNFiJvN3= IF sNFiJvN3 GT NearZeroN3 THEN sNFiJvN3 ELSE NearZeroN3 ENDIF;
aPFiAdN3= IF sPFiAdN3 GT NearZeroN3 THEN sPFiAdN3 ELSE NearZeroN3 ENDIF;
aPFiJvN3= IF sPFiJvN3 GT NearZeroN3 THEN sPFiJvN3 ELSE NearZeroN3 ENDIF;
aDPiscN3= IF sDPiscN3 GT NearZeroN3 THEN sDPiscN3 ELSE NearZeroN3 ENDIF;
aNH4SN3= IF sNH4SN3 GT NearZeroN3 THEN sNH4SN3 ELSE NearZeroN3 ENDIF;
aNO3SN3= IF sNO3SN3 GT NearZeroN3 THEN sNO3SN3 ELSE NearZeroN3 ENDIF;
aPO4SN3= IF sPO4SN3 GT NearZeroN3 THEN sPO4SN3 ELSE NearZeroN3 ENDIF;
aPAIMSN3= IF sPAIMSN3 GT NearZeroN3 THEN sPAIMSN3 ELSE NearZeroN3 ENDIF;
aDDetSN3= IF sDDetSN3 GT NearZeroN3 THEN sDDetSN3 ELSE NearZeroN3 ENDIF;
aNDetSN3= IF sNDetSN3 GT NearZeroN3 THEN sNDetSN3 ELSE NearZeroN3 ENDIF;
aPDetSN3= IF sPDetSN3 GT NearZeroN3 THEN sPDetSN3 ELSE NearZeroN3 ENDIF;
aSiDetSN3= IF sSiDetSN3 GT NearZeroN3 THEN sSiDetSN3 ELSE NearZeroN3 ENDIF;
aDHumSN3= IF sDHumSN3 GT NearZeroN3 THEN sDHumSN3 ELSE NearZeroN3 ENDIF;
aNHumSN3= IF sNHumSN3 GT NearZeroN3 THEN sNHumSN3 ELSE NearZeroN3 ENDIF;
aPHumSN3= IF sPHumSN3 GT NearZeroN3 THEN sPHumSN3 ELSE NearZeroN3 ENDIF;
aDIMSN3= IF sDIMSN3 GT NearZeroN3 THEN sDIMSN3 ELSE NearZeroN3 ENDIF;
aDDiatSN3= IF sDDiatSN3 GT NearZeroN3 THEN sDDiatSN3 ELSE NearZeroN3 ENDIF;
aNDiatSN3= IF sNDiatSN3 GT NearZeroN3 THEN sNDiatSN3 ELSE NearZeroN3 ENDIF;
aPDiatSN3= IF sPDiatSN3 GT NearZeroN3 THEN sPDiatSN3 ELSE NearZeroN3 ENDIF;
aDGrenSN3= IF sDGrenSN3 GT NearZeroN3 THEN sDGrenSN3 ELSE NearZeroN3 ENDIF;
aNGrenSN3= IF sNGrenSN3 GT NearZeroN3 THEN sNGrenSN3 ELSE NearZeroN3 ENDIF;
aPGrenSN3= IF sPGrenSN3 GT NearZeroN3 THEN sPGrenSN3 ELSE NearZeroN3 ENDIF;
aDBlueSN3= IF sDBlueSN3 GT NearZeroN3 THEN sDBlueSN3 ELSE NearZeroN3 ENDIF;
aNBlueSN3= IF sNBlueSN3 GT NearZeroN3 THEN sNBlueSN3 ELSE NearZeroN3 ENDIF;
aPBlueSN3= IF sPBlueSN3 GT NearZeroN3 THEN sPBlueSN3 ELSE NearZeroN3 ENDIF;
aDVegN3= IF sDVegN3 GT NearZeroN3 THEN sDVegN3 ELSE NearZeroN3 ENDIF;
aNVegN3= IF sNVegN3 GT NearZeroN3 THEN sNVegN3 ELSE NearZeroN3 ENDIF;
aPVegN3= IF sPVegN3 GT NearZeroN3 THEN sPVegN3 ELSE NearZeroN3 ENDIF;
aVegHeightN3= IF sVegHeightN3 GT NearZeroN3 THEN sVegHeightN3 ELSE NearZeroN3 ENDIF;
aDBentN3= IF sDBentN3 GT NearZeroN3 THEN sDBentN3 ELSE NearZeroN3 ENDIF;
aNBentN3= IF sNBentN3 GT NearZeroN3 THEN sNBentN3 ELSE NearZeroN3 ENDIF;
aPBentN3= IF sPBentN3 GT NearZeroN3 THEN sPBentN3 ELSE NearZeroN3 ENDIF;
uDepthWMN3= IF sDepthWMN3 GT NearZeroN3 THEN sDepthWMN3 ELSE NearZeroN3 ENDIF;
oNH4WMN3= IF sNH4WMN3 GT NearZeroN3 THEN sNH4WMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNO3WMN3= IF sNO3WMN3 GT NearZeroN3 THEN sNO3WMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPO4WMN3= IF sPO4WMN3 GT NearZeroN3 THEN sPO4WMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPAIMWMN3= IF sPAIMWMN3 GT NearZeroN3 THEN sPAIMWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oSiO2WMN3= IF sSiO2WMN3 GT NearZeroN3 THEN sSiO2WMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oO2WMN3= IF sO2WMN3 GT NearZeroN3 THEN sO2WMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDDetWMN3= IF sDDetWMN3 GT NearZeroN3 THEN sDDetWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNDetWMN3= IF sNDetWMN3 GT NearZeroN3 THEN sNDetWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPDetWMN3= IF sPDetWMN3 GT NearZeroN3 THEN sPDetWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oSiDetWMN3= IF sSiDetWMN3 GT NearZeroN3 THEN sSiDetWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDIMWMN3= IF sDIMWMN3 GT NearZeroN3 THEN sDIMWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDDiatWMN3= IF sDDiatWMN3 GT NearZeroN3 THEN sDDiatWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNDiatWMN3= IF sNDiatWMN3 GT NearZeroN3 THEN sNDiatWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPDiatWMN3= IF sPDiatWMN3 GT NearZeroN3 THEN sPDiatWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDGrenWMN3= IF sDGrenWMN3 GT NearZeroN3 THEN sDGrenWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNGrenWMN3= IF sNGrenWMN3 GT NearZeroN3 THEN sNGrenWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPGrenWMN3= IF sPGrenWMN3 GT NearZeroN3 THEN sPGrenWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDBlueWMN3= IF sDBlueWMN3 GT NearZeroN3 THEN sDBlueWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNBlueWMN3= IF sNBlueWMN3 GT NearZeroN3 THEN sNBlueWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPBlueWMN3= IF sPBlueWMN3 GT NearZeroN3 THEN sPBlueWMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oDZooMN3= IF sDZooMN3 GT NearZeroN3 THEN sDZooMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oNZooMN3= IF sNZooMN3 GT NearZeroN3 THEN sNZooMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
oPZooMN3= IF sPZooMN3 GT NearZeroN3 THEN sPZooMN3 / MassWMN3 ELSE NearZeroN3 ENDIF;
aNH4SMN3= IF sNH4SMN3 GT NearZeroN3 THEN sNH4SMN3 ELSE NearZeroN3 ENDIF;
aNO3SMN3= IF sNO3SMN3 GT NearZeroN3 THEN sNO3SMN3 ELSE NearZeroN3 ENDIF;
aPO4SMN3= IF sPO4SMN3 GT NearZeroN3 THEN sPO4SMN3 ELSE NearZeroN3 ENDIF;
aPAIMSMN3= IF sPAIMSMN3 GT NearZeroN3 THEN sPAIMSMN3 ELSE NearZeroN3 ENDIF;
aDDetSMN3= IF sDDetSMN3 GT NearZeroN3 THEN sDDetSMN3 ELSE NearZeroN3 ENDIF;
aNDetSMN3= IF sNDetSMN3 GT NearZeroN3 THEN sNDetSMN3 ELSE NearZeroN3 ENDIF;
aPDetSMN3= IF sPDetSMN3 GT NearZeroN3 THEN sPDetSMN3 ELSE NearZeroN3 ENDIF;
aSiDetSMN3= IF sSiDetSMN3 GT NearZeroN3 THEN sSiDetSMN3 ELSE NearZeroN3 ENDIF;
aDHumSMN3= IF sDHumSMN3 GT NearZeroN3 THEN sDHumSMN3 ELSE NearZeroN3 ENDIF;
aNHumSMN3= IF sNHumSMN3 GT NearZeroN3 THEN sNHumSMN3 ELSE NearZeroN3 ENDIF;
aPHumSMN3= IF sPHumSMN3 GT NearZeroN3 THEN sPHumSMN3 ELSE NearZeroN3 ENDIF;
aDIMSMN3= IF sDIMSMN3 GT NearZeroN3 THEN sDIMSMN3 ELSE NearZeroN3 ENDIF;
aDRootPhraN3= IF sDRootPhraN3 GT NearZeroN3 THEN sDRootPhraN3 ELSE NearZeroN3 ENDIF;
aDShootPhraN3= IF sDShootPhraN3 GT NearZeroN3 THEN sDShootPhraN3 ELSE NearZeroN3 ENDIF;
aNRootPhraN3= IF sNRootPhraN3 GT NearZeroN3 THEN sNRootPhraN3 ELSE NearZeroN3 ENDIF;
aNShootPhraN3= IF sNShootPhraN3 GT NearZeroN3 THEN sNShootPhraN3 ELSE NearZeroN3 ENDIF;
aPRootPhraN3= IF sPRootPhraN3 GT NearZeroN3 THEN sPRootPhraN3 ELSE NearZeroN3 ENDIF;
aPShootPhraN3= IF sPShootPhraN3 GT NearZeroN3 THEN sPShootPhraN3 ELSE NearZeroN3 ENDIF;
oNH4WEpiN3= IF sNH4WEpiN3 GT NearZeroN3 THEN sNH4WEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNO3WEpiN3= IF sNO3WEpiN3 GT NearZeroN3 THEN sNO3WEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPO4WEpiN3= IF sPO4WEpiN3 GT NearZeroN3 THEN sPO4WEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPAIMWEpiN3= IF sPAIMWEpiN3 GT NearZeroN3 THEN sPAIMWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oSiO2WEpiN3= IF sSiO2WEpiN3 GT NearZeroN3 THEN sSiO2WEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oO2WEpiN3= IF sO2WEpiN3 GT NearZeroN3 THEN sO2WEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDDetWEpiN3= IF sDDetWEpiN3 GT NearZeroN3 THEN sDDetWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNDetWEpiN3= IF sNDetWEpiN3 GT NearZeroN3 THEN sNDetWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPDetWEpiN3= IF sPDetWEpiN3 GT NearZeroN3 THEN sPDetWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oSiDetWEpiN3= IF sSiDetWEpiN3 GT NearZeroN3 THEN sSiDetWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDIMWEpiN3= IF sDIMWEpiN3 GT NearZeroN3 THEN sDIMWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDDiatWEpiN3= IF sDDiatWEpiN3 GT NearZeroN3 THEN sDDiatWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNDiatWEpiN3= IF sNDiatWEpiN3 GT NearZeroN3 THEN sNDiatWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPDiatWEpiN3= IF sPDiatWEpiN3 GT NearZeroN3 THEN sPDiatWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDGrenWEpiN3= IF sDGrenWEpiN3 GT NearZeroN3 THEN sDGrenWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNGrenWEpiN3= IF sNGrenWEpiN3 GT NearZeroN3 THEN sNGrenWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPGrenWEpiN3= IF sPGrenWEpiN3 GT NearZeroN3 THEN sPGrenWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDBlueWEpiN3= IF sDBlueWEpiN3 GT NearZeroN3 THEN sDBlueWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNBlueWEpiN3= IF sNBlueWEpiN3 GT NearZeroN3 THEN sNBlueWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPBlueWEpiN3= IF sPBlueWEpiN3 GT NearZeroN3 THEN sPBlueWEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oDZooEpiN3= IF sDZooEpiN3 GT NearZeroN3 THEN sDZooEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oNZooEpiN3= IF sNZooEpiN3 GT NearZeroN3 THEN sNZooEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
oPZooEpiN3= IF sPZooEpiN3 GT NearZeroN3 THEN sPZooEpiN3 / MassEpiN3 ELSE NearZeroN3 ENDIF;
aDBlueSurfN3= IF sDBlueSurfN3 GT NearZeroN3 THEN sDBlueSurfN3 ELSE NearZeroN3 ENDIF;
aNBlueSurfN3= IF sNBlueSurfN3 GT NearZeroN3 THEN sNBlueSurfN3  ELSE NearZeroN3 ENDIF;
aPBlueSurfN3= IF sPBlueSurfN3 GT NearZeroN3 THEN sPBlueSurfN3  ELSE NearZeroN3 ENDIF;
aDExtTotTN3= sDExtTotTN3;
aNExtTotTN3= sNExtTotTN3 ;
aPExtTotTN3=  sPExtTotTN3 ;
aSiExtTotTN3= sSiExtTotTN3;
aO2ExtTotTN3=sO2ExtTotTN3 ;
aDepthExtTotTN3=sDepthExtTotTN3 ;
aDDetWEpiN3= IF sDDetWEpiN3 GT NearZeroN3 THEN sDDetWEpiN3 ELSE NearZeroN3 ENDIF;
aNDetWEpiN3= IF sNDetWEpiN3 GT NearZeroN3 THEN sNDetWEpiN3  ELSE NearZeroN3 ENDIF;
aPDetWEpiN3= IF sPDetWEpiN3 GT NearZeroN3 THEN sPDetWEpiN3  ELSE NearZeroN3 ENDIF;
aSiDetWEpiN3= IF sSiDetWEpiN3 GT NearZeroN3 THEN sSiDetWEpiN3 ELSE NearZeroN3 ENDIF;
aDIMWEpiN3= IF sDIMWEpiN3 GT NearZeroN3 THEN aDIMWEpiN3  ELSE NearZeroN3 ENDIF;
aDDiatWEpiN3= IF sDDiatWEpiN3 GT NearZeroN3 THEN sDDiatWEpiN3 ELSE NearZeroN3 ENDIF;
aNDiatWEpiN3= IF sNDiatWEpiN3 GT NearZeroN3 THEN sNDiatWEpiN3  ELSE NearZeroN3 ENDIF;
aPDiatWEpiN3= IF sPDiatWEpiN3 GT NearZeroN3 THEN sPDiatWEpiN3  ELSE NearZeroN3 ENDIF;
aDGrenWEpiN3= IF sDGrenWEpiN3 GT NearZeroN3 THEN sDGrenWEpiN3 ELSE NearZeroN3 ENDIF;
aNGrenWEpiN3= IF sNGrenWEpiN3 GT NearZeroN3 THEN sNGrenWEpiN3 ELSE NearZeroN3 ENDIF;
aPGrenWEpiN3= IF sPGrenWEpiN3 GT NearZeroN3 THEN sPGrenWEpiN3 ELSE NearZeroN3 ENDIF;
aDBlueWEpiN3= IF sDBlueWEpiN3 GT NearZeroN3 THEN sDBlueWEpiN3 ELSE NearZeroN3 ENDIF;
aNBlueWEpiN3= IF sNBlueWEpiN3 GT NearZeroN3 THEN sNBlueWEpiN3  ELSE NearZeroN3 ENDIF;
aPBlueWEpiN3= IF sPBlueWEpiN3 GT NearZeroN3 THEN sPBlueWEpiN3 ELSE NearZeroN3 ENDIF;
aDBlueWHypN3= IF sDBlueWEpiN3 GT NearZeroN3 THEN sDBlueWEpiN3 ELSE NearZeroN3 ENDIF;
TimeYearsN3 = sTimeN3 / DaysPerYearN3;
DayN3 = sTimeN3 - FLOOR(TimeYearsN3) * DaysPerYearN3;
YearsN3 = YearZeroN3 + TimeYearsN3;
aVegEHeightN3 =   POW ( cVegHPar1N3*aDVegN3 , cVegHPar2N3 ) ;
uVegHeightN3 =  IF ( UseVegHeightN3 EQ FALSE AND  aVegHeightN3 LT uDepthWN3 ) THEN aVegHeightN3 ELSEIF ( UseVegHeightN3 EQ FALSE ) THEN ( uDepthWN3 ) ELSE MIN ( aVegHeightN3 , uDepthWN3 , aVegEHeightN3 ) ENDIF;
uVegHeightHypN3 = IF ( aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uVegHeightN3 GT uDepthWHypN3 ) THEN uDepthWHypN3 ELSE uVegHeightN3 ENDIF;
uVegHeightEpiN3 = IF ( aInclStratN3 EQ FALSE AND uVegHeightN3 LT uDepthWEpiN3 ) THEN uVegHeightN3 ELSEIF ( aInclStratN3 EQ FALSE AND uVegHeightN3 GE uDepthWEpiN3 ) THEN uDepthWEpiN3 ELSEIF (uVegHeightN3 GT uDepthWHypN3 ) THEN uVegHeightN3 -uDepthWHypN3 ELSE 0.0 ENDIF;
aDepth2VegHypN3 = IF ( aInclStratN3 EQ TRUE AND fDepth2VegN3 GE 1 ) THEN uDepthWHypN3  ELSEIF ( aInclStratN3 EQ TRUE AND fDepth2VegN3 LT 1 ) THEN MAX (0.0, uVegHeightN3 - uDepthWEpiN3 ) ELSE 0.0 ENDIF;
aDepth1VegHypN3 = IF ( aInclStratN3 EQ TRUE AND fDepth2VegN3 GE 1 ) THEN uDepthWHypN3 - uVegHeightHypN3  ELSE 0.0 ENDIF;
aDepth2VegEpiN3 = IF (fDepth2VegN3 GE 1 ) THEN uDepthWEpiN3 ELSE uDepthWEpiN3 - uVegHeightEpiN3 ENDIF;
aDepth1VegEpiN3 = IF (fDepth2VegN3 GE 1 ) THEN uDepthWEpiN3 - uVegHeightEpiN3  ELSE 0.0 ENDIF;
uVegHeightLightN3 = cVegLN3 *LN( 1.0 + uVegHeightN3 );
uVegHeightLightSumN3 = cVegLN3 *LN( 1.0 + MAX (uVegHeightN3, MIN (uDepthWN3, cVegHeightN3) ) );
uVegHeightLightEpiN3 = IF (  uVegHeightLightN3 GT uVegHeightEpiN3 ) THEN uVegHeightEpiN3 ELSE uVegHeightLightN3 ENDIF;
uVegHeightLightHypN3 =  uVegHeightLightN3 - uVegHeightLightEpiN3  ;
uDVegHypN3 = uVegHeightHypN3 / uVegHeightN3 * aDVegN3;
uDVegEpiN3 = uVegHeightEpiN3 / uVegHeightN3 * aDVegN3;
uVegShadeN3 = IF ( ReadVegShadeN3  EQ  TRUE) THEN mVegShadeN3 ELSE fVegShadeN3 ENDIF;
aExtPhytHypN3 = cExtSpDiatN3 * oDDiatWHypN3 + cExtSpGrenN3 * oDGrenWHypN3 + cExtSpBlueN3 * oDBlueWHypN3;
aExtDetHypN3 = cExtSpDetN3 * oDDetWHypN3;
aExtIMHypN3 = cExtSpIMN3 * oDIMWHypN3;
aExtCoefOpenHypN3 = cExtWatN3 + aExtIMHypN3 + aExtDetHypN3 + aExtPhytHypN3;
aExtPhytEpiN3 = cExtSpDiatN3 * oDDiatWEpiN3 + cExtSpGrenN3 * oDGrenWEpiN3 + cExtSpBlueN3 * oDBlueWEpiN3;
aExtDetEpiN3 = cExtSpDetN3 * oDDetWEpiN3;
aExtIMEpiN3 = cExtSpIMN3 * oDIMWEpiN3;
aExtCoefOpenEpiN3 = cExtWatN3 + aExtIMEpiN3 + aExtDetEpiN3 + aExtPhytEpiN3;
aExtSurfN3 = cExtSpBlueN3 * aDBlueSurfN3;
aTmEpiN3 =  cTmAveEpiN3 - cTmVarEpiN3 * COS(2.0*PiN3*(sTimeN3 + TenDaysN3 - cTimeLagN3) / DaysInYearN3) ;
aTmHypN3 =  cTmAveHypN3 - cTmVarHypN3 * COS(2.0*PiN3*(sTimeN3 + TenDaysN3 - cTimeLagN3) / DaysInYearN3) ;
uTmEpiN3 = IF (FALSE EQ InclSeasonN3) THEN cTmAveEpiN3 ELSEIF (ReadTempN3 EQ TRUE) THEN mTempEpiN3 ELSEIF ( aTmEpiN3 GT 0.0  ) THEN aTmEpiN3 ELSE  0.0 ENDIF;
uTmHypN3 = IF (FALSE EQ InclSeasonN3) THEN cTmAveHypN3 ELSEIF (ReadTempN3 EQ TRUE) THEN mTempHypN3 ELSEIF ( aTmHypN3 GT 0.0  ) THEN aTmHypN3 ELSE  0.0 ENDIF;
uTmBotN3 = IF (aInclStratN3 EQ TRUE ) THEN uTmHypN3 ELSE uTmEpiN3 ENDIF;
uTmSurfN3 = uTmEpiN3;
uLATN3= cLATN3*2*PiN3/360;
uSolDecAngN3= IF(InclLatN3 EQ TRUE) THEN cPhiRN3*COS(2*PiN3*(DayN3-cDayRN3)/DaysInYearN3) ELSE 0.0 ENDIF;
uSunRiseN3 = HoursInDayN3/(2*PiN3)*ACOS((SIN(uLATN3)* SIN(uSolDecAngN3))/(COS(uLATN3)*COS(uSolDecAngN3))) ;
uSunSetN3=HoursInDayN3-uSunRiseN3;
uSunHoursN3=uSunSetN3-uSunRiseN3;
uSunPathN3= IF(InclLatN3 EQ TRUE) THEN SIN(uLATN3)*SIN( uSolDecAngN3 )*( uSunSetN3-uSunRiseN3)- COS(uLATN3) * COS (uSolDecAngN3) * HoursInDayN3 / (2*PiN3) * ( SIN (2*PiN3*uSunSetN3/HoursInDayN3 ) -SIN(2*PiN3*uSunRiseN3 /HoursInDayN3 )) ELSE 0.0 ENDIF;
uTransN3=IF((InclLatN3 EQ TRUE) AND (ConstTransN3 EQ FALSE)) THEN (0.6-0.2*(uSunPathN3/(uSunSetN3 - uSunRiseN3)))*(1-0.4*fCloudHN3) *(1-0.7* fCloudMN3) *(1-0.4*fCloudLN3)ELSEIF ((InclLatN3 EQ TRUE) AND (ConstTransN3 EQ TRUE)) THEN cTransN3 ELSE 0.0 ENDIF;
ufDayN3 = IF (FALSE EQ InclSeasonN3) THEN cfDayAveN3 ELSEIF (InclLatN3 EQ TRUE) THEN (uSunSetN3 -uSunRiseN3 )/ HoursInDayN3 ELSE cfDayAveN3 - cfDayVarN3 * COS( 2.0 *PiN3*(sTimeN3+TenDaysN3) / DaysInYearN3) ENDIF;
uLDayN3 = IF (FALSE EQ InclSeasonN3) THEN cLDayAveN3 ELSEIF (ReadLOutN3 EQ TRUE) THEN 0.0 ELSEIF (InclLatN3 EQ TRUE) THEN cSolarN3*uTransN3*uSunPathN3 * SecsPerDayN3 /HoursInDayN3 ELSE cLDayAveN3 - cLDayVarN3 * COS(2.0*PiN3*(sTimeN3+TenDaysN3) / DaysInYearN3) ENDIF;
uLOutN3 = IF (FALSE EQ InclSeasonN3) THEN uLDayN3 / SecsPerDayN3 / ufDayN3 ELSEIF (ReadLOutN3 EQ TRUE) THEN mLOutN3 / ufDayN3 ELSE uLDayN3 / SecsPerDayN3 / ufDayN3 ENDIF;
uLPARSurfN3 = fPARN3 * (1.0 - fReflN3) * uLOutN3;
aLPARBotSurfN3 = IF (InclSurfN3 EQ TRUE) THEN uLPARSurfN3 * EXP(- aExtSurfN3) ELSE uLPARSurfN3 ENDIF;
aLPARBotEpiOpenN3 = aLPARBotSurfN3 * EXP(- aExtCoefOpenEpiN3 * uDepthWEpiN3);
aLPARBotHypOpenN3 = aLPARBotEpiOpenN3 * EXP(- aExtCoefOpenHypN3 * uDepthWHypN3);
aLPAR1VegEpiN3 = aLPARBotSurfN3 * EXP(- aExtCoefOpenEpiN3 * aDepth1VegEpiN3) * ( 1 - uVegShadeN3 );
aLPAR1VegHypN3 = aLPAR1VegEpiN3 * EXP(- aExtCoefOpenHypN3 * aDepth1VegHypN3);
aLPARVegLightN3 =  IF  ( aInclStratN3 EQ TRUE AND  uVegHeightN3 LE uDepthWHypN3 ) THEN aLPAR1VegHypN3 *   EXP(- aExtCoefOpenHypN3 * uVegHeightLightEpiN3) ELSE aLPAR1VegEpiN3 *  EXP(- aExtCoefOpenEpiN3 * uVegHeightLightEpiN3)  *  EXP(- aExtCoefOpenHypN3 * uVegHeightLightEpiN3) ENDIF;
uTmVegAveN3 = ( uVegHeightHypN3 * uTmHypN3 + uVegHeightEpiN3 * uTmEpiN3 ) / uVegHeightN3;
uFunTmVegN3 = EXP(-0.5/(cSigTmVegN3*cSigTmVegN3) *((uTmVegAveN3-cTmOptVegN3)*(uTmVegAveN3-cTmOptVegN3) - (cTmRefN3-cTmOptVegN3)*(cTmRefN3-cTmOptVegN3)));
uFunTmProdVegN3 = IF ( UseExpVegN3 EQ TRUE ) THEN uFunTmVegN3 ELSE POW ( cQ10ProdVegN3 , (0.1 * (uTmVegAveN3 - cTmRefN3))) ENDIF;
uhLVegN3 = hLRefVegN3 * uFunTmProdVegN3;
aLPIVegN3 = IF ( aInclStratN3 EQ TRUE AND  uVegHeightN3 GT uDepthWHypN3 ) THEN cPMaxN3*(aLPAR1VegEpiN3- aLPARVegLightN3 + uhLVegN3*LN((1.0 +aLPARVegLightN3/ uhLVegN3)  /(1.0 +aLPAR1VegEpiN3  / uhLVegN3) + NearZeroN3  ) )ELSEIF  ( aInclStratN3 EQ TRUE AND  uVegHeightN3 LE uDepthWHypN3 ) THEN cPMaxN3*( aLPAR1VegHypN3- aLPARVegLightN3 + uhLVegN3* LN((1.0 +aLPARVegLightN3/ uhLVegN3)  / (1.0 +aLPAR1VegHypN3  / uhLVegN3) ) ) ELSE cPMaxN3 * (aLPAR1VegEpiN3- aLPARVegLightN3 + uhLVegN3*LN((1.0 +aLPARVegLightN3/ uhLVegN3)  /(1.0 +aLPAR1VegEpiN3  / uhLVegN3) + NearZeroN3  ) )ENDIF;
aSpringN3 =  IF ( cLATN3 LT 0 AND DayN3 GE 265 AND DayN3 LE 356 ) THEN 1 ELSEIF ( cLATN3 GT 0 AND DayN3 GE 80 AND DayN3 LE 173) THEN 1 ELSEIF ( cLATN3 EQ 0) THEN 1 ELSE 0 ENDIF;
aTimeWinVegN3 =  IF ( sTimeN3 LT StartTimeN3 + 1.0 ) THEN -999 ELSEIF ( UsePhotVegN3 EQ FALSE  AND  ( uTmBotN3 GE cTmInitVegN3 )  AND aSpringN3 EQ 1 ) THEN sTimeN3  ELSEIF (UsePhotVegN3 EQ TRUE  AND  uSunHoursN3 GE cPhotInitVegN3   AND aSpringN3 EQ 1 ) THEN sTimeN3 ELSEIF (( aLPIVegN3 / uVegHeightLightN3 )LE cLAlloVegN3 ) THEN aTimeWinVegN3 ELSEIF (FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeWinVegN3 + 0.3) GT 1 AND FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeWinVegN3 + 0.3) LT cVegWinLenN3 ) THEN aTimeWinVegN3 ELSE sTimeN3 ENDIF ;
aTimeInitVegN3 =  IF ( sTimeN3 LT StartTimeN3 + 1.0 ) THEN -999 ELSEIF ( FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeWinVegN3 + 0.3) GT 1 ) THEN sTimeN3 ELSEIF ( UsePhotVegN3 EQ FALSE  AND  uTmBotN3 GE cTmInitVegN3 ) THEN aTimeInitVegN3 ELSEIF ( UsePhotVegN3 EQ TRUE  AND    uSunHoursN3 GE cPhotInitVegN3  ) THEN aTimeInitVegN3 ELSEIF (UsePhotVegN3 EQ FALSE  AND  uTmBotN3 LT cTmInitVegN3 AND ( ( aLPIVegN3 / uVegHeightLightN3 ) GE cLAlloVegN3 ) AND FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeInitVegN3 + 0.3) GT 1) THEN aTimeInitVegN3 ELSEIF (UsePhotVegN3 EQ TRUE  AND   uSunHoursN3 LT cPhotInitVegN3 AND ( ( aLPIVegN3 / uVegHeightLightN3 ) GE cLAlloVegN3 ) AND FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeInitVegN3 + 0.3) GT 1) THEN aTimeInitVegN3 ELSEIF (FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeInitVegN3 + 0.3) GT 1 AND FLOOR ( sTimeN3+ 0.3 ) - FLOOR (aTimeInitVegN3 + 0.3) LT cVegInitLenN3 ) THEN aTimeInitVegN3 ELSE sTimeN3 ENDIF ;
aTimeWinVegCorN3 = IF ( UseLWinVegN3 LE NearZeroN3 ) THEN FLOOR (TimeYearsN3 - 1) + cDayWinVegN3  ELSE aTimeWinVegN3 ENDIF;
aDayInitVegN3 = IF (DayN3 LT 1.0 OR sTimeN3 LT StartTimeN3 + 1.0) THEN 367 ELSEIF (uTmBotN3 GE cTmInitVegN3 AND aDayInitVegN3 GT 366) THEN DayN3 ELSE aDayInitVegN3 ENDIF;
aTimeInitVegCorN3 = IF (UsePhotVegN3 LE NearZeroN3 AND UseLWinVegN3 LE NearZeroN3 ) THEN  (TimeYearsN3 - 1)  + aDayInitVegN3  ELSE aTimeInitVegN3 ENDIF;
aVegSumN3 =  IF ( FLOOR ( aTimeInitVegCorN3 + 0.3) LT FLOOR (  sTimeN3 + 0.3 ) AND FLOOR ( aTimeWinVegCorN3 + 0.3 ) EQ FLOOR (  sTimeN3  + 0.3 ) ) THEN 1 ELSE 0 ENDIF;
aVegWinN3 =  1 - aVegSumN3;
aDaysVegSumN3 = ( FLOOR ( sTimeN3+ 0.3) - FLOOR (aTimeInitVegCorN3 + 0.3) ) * aVegSumN3;
aDaysVegWinN3 = ( FLOOR ( sTimeN3 + 0.3) - FLOOR ( aTimeWinVegCorN3  + 0.3 )  ) * aVegWinN3;
bfRootVegN3 = IF (FALSE EQ InclSeasonN3) THEN fRootVegSumN3 ELSEIF (aVegWinN3 EQ TRUE AND aDaysVegWinN3 GT cLengAlloN3) THEN fRootVegWinN3 ELSEIF (aVegSumN3 EQ TRUE AND aDaysVegSumN3 LE cLengAlloN3) THEN 0.5*(fRootVegWinN3 + fRootVegSumN3) + 0.5*(fRootVegWinN3 - fRootVegSumN3) * COS ( PiN3 /cLengAlloN3 * ( sTimeN3 - aTimeInitVegCorN3 )) ELSEIF ( aVegWinN3 EQ TRUE AND aDaysVegWinN3 EQ 0) THEN fRootVegWinN3 ELSEIF ( aVegWinN3 EQ TRUE) THEN 0.5*( fRootVegWinN3 + fRootVegSumN3) - 0.5*( fRootVegWinN3 - fRootVegSumN3) * COS ( PiN3 / cLengAlloN3 * ( sTimeN3 - aTimeWinVegCorN3 )) ELSE fRootVegSumN3 ENDIF;
bfShootVegN3 = 1.0 - bfRootVegN3;
aDShootVegN3 = bfShootVegN3 * aDVegN3;
aDEmergVegN3 = fEmergVegN3 * aDShootVegN3;
aDFloatVegN3 = IF  ( aDepth1VegEpiN3 LT 0.005 ) THEN fFloatVegN3 * aDShootVegN3 ELSE 0 ENDIF;
bfSubVegN3 = 1.0 - fFloatVegN3 - fEmergVegN3;
aDSubVegN3 = bfSubVegN3 * aDShootVegN3;
aExtVegHypN3 = cExtSpVegN3 * aDSubVegN3 / uDepthWHypN3 * (uVegHeightHypN3 /uDepthWN3 );
aExtCoefHypN3 = aExtCoefOpenHypN3 + aExtVegHypN3;
aExtVegEpiN3 = cExtSpVegN3 * aDSubVegN3 / uDepthWEpiN3 * (uVegHeightEpiN3 /uDepthWN3 ) ;
aExtCoefEpiN3 = aExtCoefOpenEpiN3 + aExtVegEpiN3;
aLPARBotEpiN3 = aLPARBotSurfN3 * EXP(- aExtCoefEpiN3 * uDepthWEpiN3);
uLPARSurfHypN3 = IF ( aInclStratN3 EQ TRUE ) THEN aLPARBotEpiN3 ELSE 0.0 ENDIF;
aLPAR2VegEpiN3 = aLPAR1VegEpiN3 * EXP(- aExtCoefEpiN3 * (aDepth2VegEpiN3 - aDepth1VegEpiN3));
aLPAR2VegHypN3 = aLPAR1VegHypN3 * EXP(- aExtCoefHypN3 * (aDepth2VegHypN3 - aDepth1VegHypN3));
uVWindN3 = IF (ReadVWindN3 EQ TRUE)THEN mVWindN3 ELSE cVWindN3 ENDIF;
aStratN3 = IF (ReadStratN3 EQ TRUE) THEN mStratN3 ELSEIF ((uTmEpiN3 -uTmHypN3) GT  cStratTmN3 OR (uTmHypN3 -uTmEpiN3) GT  cStratTmN3) THEN 1.0  ELSE 0.0 ENDIF;
uQInSeasonN3 = IF (FALSE EQ UseSeasonLoadN3) THEN 0.0 ELSEIF (DayN3 LT cDayApril1N3 - 0.5*cLengChangeN3) THEN cQInWinN3 ELSEIF (DayN3 LT cDayApril1N3 + 0.5*cLengChangeN3) THEN 0.5*(cQInWinN3 + cQInSumN3) + 0.5*(cQInWinN3 - cQInSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayApril1N3)) ELSEIF (DayN3 LT cDayOct1N3 - 0.5*cLengChangeN3) THEN cQInSumN3 ELSEIF (DayN3 LT cDayOct1N3 + 0.5*cLengChangeN3) THEN 0.5*(cQInWinN3 + cQInSumN3) - 0.5*(cQInWinN3 - cQInSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayOct1N3)) ELSE cQInWinN3 ENDIF;
uQEvSinusN3 = cQEvAveN3 - cQEvVarN3 * COS(2.0*PiN3 * (sTimeN3 + TenDaysN3 - cTimeLagN3) / DaysInYearN3);
aQEvN3 = IF (10 *uTmEpiN3 /cHeatN3) LE NearZeroN3 THEN 16 * 2*ufDayN3 * 1 / 30 * POW ( NearZeroN3 , (cAlphaN3) ) ELSE 16 * 2*ufDayN3 * 1 / 30 * POW ( 10 *uTmEpiN3 /cHeatN3 , (cAlphaN3) ) ENDIF;
uQEvN3 = IF (FALSE EQ InclSeasonN3) THEN cQEvAveN3 ELSEIF (ReadQEvN3 EQ TRUE) THEN mQEvN3 ELSEIF (calcQEvN3 EQ TRUE ) THEN aQEvN3 ELSE uQEvSinusN3 ENDIF;
uDepthDifMeasN3 = IF ( ReadDepthWN3 EQ TRUE ) THEN mDepthWN3 - uDepthWN3 ELSE 0.0 ENDIF;
uQInCorN3 = IF (uDepthDifMeasN3 GE 0) THEN uDepthDifMeasN3 * cMaxWOutN3 * mmPermN3 ELSE 0.0 ENDIF;
uQOutCorN3 = IF (uDepthDifMeasN3 LT 0) THEN -1 * uDepthDifMeasN3 * cMaxWOutN3 * mmPermN3 ELSE 0.0 ENDIF;
uQInEpiN3 = IF ((ReadQInN3 EQ TRUE) OR (ReadTranFracN3 EQ TRUE)) THEN mQInEpiN3 + uQInCorN3 ELSEIF (UseSeasonLoadN3 EQ TRUE) THEN uQInSeasonN3 + uQInCorN3 ELSE cQInEpiN3 + uQInCorN3 ENDIF;
uQInHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF ((ReadQInN3 EQ TRUE) OR (ReadTranFracN3 EQ TRUE)) THEN mQInHypN3 ELSE 0.0 ENDIF;
aQInTotN3 = uQInEpiN3 + uQInHypN3;
uQPrecN3 = IF (ReadQPrecN3 EQ TRUE) THEN mQPrecN3 ELSE 0 ENDIF;
uQInSeepN3 = IF (ReadQGroundN3 EQ TRUE) THEN mQInSeepN3 ELSE cQInSeepN3 ENDIF;
uQOutInfN3 = IF (ReadQGroundN3 EQ TRUE) THEN mQOutInfN3 ELSE cQOutInfN3 ENDIF;
uQOutPotN3 = uQPrecN3 + uQInEpiN3 - uQInCorN3 + uQInHypN3 + uQInSeepN3 - uQEvN3 - uQOutCorN3 - uQOutInfN3;
aMaxQOutEpiN3 = IF ( uDepthWEpiN3 LE cMinDepthHypEpiN3 ) THEN 0.0 ELSE uDepthWEpiN3 * mmPermN3 * cMaxWOutN3 ENDIF;
aMaxQOutHypN3 = IF (aInclStratN3 EQ TRUE) AND ( uDepthWHypN3 GT cMinDepthHypEpiN3 ) THEN (uDepthWHypN3 - cMinDepthHypEpiN3) * mmPermN3 * cMaxWOutN3 ELSE 0.0 ENDIF;
uQOutEpiN3 = IF (ReadQOutN3 EQ TRUE) THEN MIN(mQOutEpiN3, aMaxQOutEpiN3) ELSE MIN(aMaxQOutEpiN3, MAX(0.0, uQOutPotN3)) ENDIF;
uQOutHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadQOutN3 EQ TRUE) THEN MIN(mQOutHypN3, aMaxQOutHypN3) ELSE MIN(aMaxQOutHypN3, MAX(0.0, (uQOutPotN3 - uQOutEpiN3))) ENDIF;
ukOutEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uQOutEpiN3 / mmPermN3 / uDepthWEpiN3 ENDIF;
ukOutHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uQOutHypN3 / mmPermN3 / uDepthWHypN3 ENDIF;
uTauWatEpiN3 = IF (aInclStratN3 EQ FALSE) THEN 1.0 / ((uQInEpiN3 + uQPrecN3 + uQInSeepN3) / mmPermN3 / uDepthWEpiN3 +NearZeroN3) ELSE 1.0 / (( uQInEpiN3 + uQPrecN3 ) / mmPermN3 / uDepthWEpiN3 +NearZeroN3) ENDIF;
uTauWatHypN3 = IF (aInclStratN3 EQ FALSE )THEN -9999 ELSE 1.0 / ((uQInHypN3 + uQInSeepN3 ) / mmPermN3 / uDepthWHypN3 +NearZeroN3) ENDIF;
uTauWatN3 = 1.0 / ((uQPrecN3 + uQInEpiN3 + uQInHypN3 + uQInSeepN3 ) / mmPermN3 / uDepthWN3 +NearZeroN3);
uTauSubstHypN3 = 1.0 / (ukOutHypN3+NearZeroN3);
uFiJvMortHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiJvMortHypN3 ELSE 0.0 ENDIF;
uFiJvEgesHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiJvEgesHypN3 ELSE 0.0 ENDIF;
uFiJvExcrHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiJvExcrHypN3 ELSE 0.0 ENDIF;
uFiAdMortHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiAdMortHypN3 ELSE 0.0 ENDIF;
uFiAdEgesHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiAdEgesHypN3 ELSE 0.0 ENDIF;
uFiAdExcrHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fFiAdExcrHypN3 ELSE 0.0 ENDIF;
uPiscMortHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fPiscMortHypN3 ELSE 0.0 ENDIF;
uPiscEgesHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fPiscEgesHypN3 ELSE 0.0 ENDIF;
uPiscExcrHypN3 = IF (aInclStratN3 EQ TRUE ) THEN fPiscExcrHypN3 ELSE 0.0 ENDIF;
vTranDepthWN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN (uQInEpiN3 + uQInHypN3 + uQPrecN3 + uQInSeepN3 - uQEvN3 - uQOutInfN3 - uQOutHypN3 - uQOutEpiN3 - uQOutCorN3) / mmPermN3 ELSE ((uQInEpiN3 + uQInHypN3 + uQPrecN3 + uQInSeepN3 - uQEvN3 - uQOutInfN3 - uQOutHypN3 - uQOutEpiN3 - uQOutCorN3) / mmPermN3) / (1.0 + fMarshN3) ENDIF;
vTranHypEpiWN3 = IF (InclStratN3 EQ FALSE) THEN 0.0 ELSEIF ( uDepthWN3 -uDepthMixMeasN3 LT cMinDepthHypEpiN3 ) THEN ( uDepthWN3 - cMinDepthHypEpiN3 -uDepthWEpiN3 ) * kExchWN3 ELSEIF ( uDepthMixMeasN3 LT cMinDepthHypEpiN3 ) THEN ( cMinDepthHypEpiN3 -uDepthWEpiN3 ) * kExchWN3 ELSE ( uDepthMixMeasN3 -uDepthWEpiN3 ) * kExchWN3 ENDIF;
vDeltaWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3 ) THEN (uQInHypN3 + uQInSeepN3 - uQOutInfN3 - uQOutHypN3) / mmPermN3 ELSE (uQInHypN3 + uQInSeepN3 - uQOutInfN3 - uQOutHypN3) / mmPermN3 / (1.0 + fMarshN3 ) ENDIF;
vDeltaWEpiN3 = IF (aInclStratN3 EQ FALSE) AND (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3 ) THEN (uQInEpiN3 + uQPrecN3 + uQInSeepN3 - uQEvN3 - uQOutEpiN3 - uQOutInfN3 - uQOutCorN3) / mmPermN3 ELSEIF (aInclStratN3 EQ TRUE) AND (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3 ) THEN (uQInEpiN3 + uQPrecN3 - uQEvN3 - uQOutEpiN3 - uQOutCorN3) / mmPermN3 ELSEIF (aInclStratN3 EQ FALSE) AND (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3 ) THEN (uQInEpiN3 + uQPrecN3 + uQInSeepN3 - uQEvN3 - uQOutEpiN3 - uQOutInfN3 - uQOutCorN3) / mmPermN3 / (1.0 + fMarshN3 ) ELSE (uQInEpiN3 + uQPrecN3 - uQEvN3 - uQOutEpiN3 - uQOutCorN3) / mmPermN3 / (1.0 + fMarshN3 ) ENDIF;
afVolHypEpiN3= IF (aInclStratN3 EQ TRUE AND uDepthWHypN3 GT NearZeroN3) THEN  uDepthWHypN3 / uDepthWEpiN3 ELSE 0.0 ENDIF;
wDAdvIMWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDIMWHypN3 ELSE vTranHypEpiWN3 * oDIMWEpiN3 ENDIF;
wPAdvPO4WN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPO4WHypN3 ELSE vTranHypEpiWN3 * oPO4WEpiN3 ENDIF;
wPAdvAIMWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPAIMWHypN3 ELSE vTranHypEpiWN3 * oPAIMWEpiN3 ENDIF;
wNAdvNH4WN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNH4WHypN3 ELSE vTranHypEpiWN3 * oNH4WEpiN3 ENDIF;
wNAdvNO3WN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNO3WHypN3 ELSE vTranHypEpiWN3 * oNO3WEpiN3 ENDIF;
wSiAdvSiO2WN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oSiO2WHypN3 ELSE vTranHypEpiWN3 * oSiO2WEpiN3 ENDIF;
wO2AdvWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oO2WHypN3 ELSE vTranHypEpiWN3 * oO2WEpiN3 ENDIF;
wDAdvDetWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDDetWHypN3 ELSE vTranHypEpiWN3 * oDDetWEpiN3 ENDIF;
wPAdvDetWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPDetWHypN3 ELSE vTranHypEpiWN3 * oPDetWEpiN3 ENDIF;
wNAdvDetWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNDetWHypN3 ELSE vTranHypEpiWN3 * oNDetWEpiN3 ENDIF;
wSiAdvDetWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oSiDetWHypN3 ELSE vTranHypEpiWN3 * oSiDetWEpiN3 ENDIF;
wDAdvDiatWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDDiatWHypN3 ELSE vTranHypEpiWN3 * oDDiatWEpiN3 ENDIF;
wPAdvDiatWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPDiatWHypN3 ELSE vTranHypEpiWN3 * oPDiatWEpiN3 ENDIF;
wNAdvDiatWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNDiatWHypN3 ELSE vTranHypEpiWN3 * oNDiatWEpiN3 ENDIF;
wSiAdvDiatWN3 = vTranHypEpiWN3 * cSiDDiatN3;
wDAdvGrenWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDGrenWHypN3 ELSE vTranHypEpiWN3 * oDGrenWEpiN3 ENDIF;
wPAdvGrenWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPGrenWHypN3 ELSE vTranHypEpiWN3 * oPGrenWEpiN3 ENDIF;
wNAdvGrenWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNGrenWHypN3 ELSE vTranHypEpiWN3 * oNGrenWEpiN3 ENDIF;
wDAdvBlueWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDBlueWHypN3 ELSE vTranHypEpiWN3 * oDBlueWEpiN3 ENDIF;
wPAdvBlueWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPBlueWHypN3 ELSE vTranHypEpiWN3 * oPBlueWEpiN3 ENDIF;
wNAdvBlueWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNBlueWHypN3 ELSE vTranHypEpiWN3 * oNBlueWEpiN3 ENDIF;
wDAdvZooWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oDZooHypN3 ELSE vTranHypEpiWN3 * oDZooEpiN3 ENDIF;
wPAdvZooWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oPZooHypN3 ELSE vTranHypEpiWN3 * oPZooEpiN3 ENDIF;
wNAdvZooWN3 = IF ( vTranHypEpiWN3 GT 0.0) THEN vTranHypEpiWN3 * oNZooHypN3 ELSE vTranHypEpiWN3 * oNZooEpiN3 ENDIF;
wDAdvIMWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDIMWEpiN3 ELSE vTranDepthWN3 *  oDIMWMN3 ENDIF;
wPAdvPO4WMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPO4WEpiN3 ELSE vTranDepthWN3 *  oPO4WMN3 ENDIF;
wPAdvAIMWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPAIMWEpiN3 ELSE vTranDepthWN3 *  oPAIMWMN3 ENDIF;
wNAdvNH4WMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNH4WEpiN3 ELSE vTranDepthWN3 *  oNH4WMN3 ENDIF;
wNAdvNO3WMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNO3WEpiN3 ELSE vTranDepthWN3 *  oNO3WMN3 ENDIF;
wSiAdvSiO2WMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oSiO2WEpiN3 ELSE vTranDepthWN3 *  oSiO2WMN3 ENDIF;
wO2AdvWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oO2WEpiN3 ELSE vTranDepthWN3 *  oO2WMN3 ENDIF;
wDAdvDetWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDDetWEpiN3 ELSE vTranDepthWN3 *  oDDetWMN3 ENDIF;
wPAdvDetWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPDetWEpiN3 ELSE vTranDepthWN3 *  oPDetWMN3 ENDIF;
wNAdvDetWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNDetWEpiN3 ELSE vTranDepthWN3 *  oNDetWMN3 ENDIF;
wSiAdvDetWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oSiDetWEpiN3 ELSE vTranDepthWN3 *  oSiDetWMN3 ENDIF;
wDAdvDiatWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDDiatWEpiN3 ELSE vTranDepthWN3 *  oDDiatWMN3 ENDIF;
wPAdvDiatWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPDiatWEpiN3 ELSE vTranDepthWN3 *  oPDiatWMN3 ENDIF;
wNAdvDiatWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNDiatWEpiN3 ELSE vTranDepthWN3 *  oNDiatWMN3 ENDIF;
wDAdvGrenWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDGrenWEpiN3 ELSE vTranDepthWN3 *  oDGrenWMN3 ENDIF;
wPAdvGrenWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPGrenWEpiN3 ELSE vTranDepthWN3 *  oPGrenWMN3 ENDIF;
wNAdvGrenWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNGrenWEpiN3 ELSE vTranDepthWN3 *  oNGrenWMN3 ENDIF;
wDAdvBlueWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDBlueWEpiN3 ELSE vTranDepthWN3 *  oDBlueWMN3 ENDIF;
wPAdvBlueWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPBlueWEpiN3 ELSE vTranDepthWN3 *  oPBlueWMN3 ENDIF;
wNAdvBlueWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNBlueWEpiN3 ELSE vTranDepthWN3 *  oNBlueWMN3 ENDIF;
wDAdvZooWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oDZooEpiN3 ELSE vTranDepthWN3 *  oDZooMN3 ENDIF;
wPAdvZooWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oPZooEpiN3 ELSE vTranDepthWN3 *  oPZooMN3 ENDIF;
wNAdvZooWMN3= IF (InclMarshN3 EQ FALSE OR fMarshN3 LT NearZeroN3) THEN 0.0 ELSEIF ( vTranDepthWN3 GT 0.0) THEN vTranDepthWN3 * oNZooEpiN3 ELSE vTranDepthWN3 *  oNZooMN3 ENDIF;
uExchMaxWN3 =   IF ( aInclStratN3 EQ TRUE) THEN kExchMaxWN3 /( aStratN3* fMetaN3 * uDepthWN3 + cDepthMetaMinN3 ) ELSE 0.0 ENDIF;
akExchWHypN3= IF (aInclStratN3 EQ TRUE AND uDepthWHypN3 GT NearZeroN3) THEN  ( uExchMaxWN3 ) / uDepthWHypN3 ELSE 0.0 ENDIF;
akExchWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 * afVolHypEpiN3 ELSE 0.0 ENDIF;
wDExchIMWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDIMWHypN3 - oDIMWEpiN3) ELSE 0.0 ENDIF;
wPExchPO4WHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPO4WHypN3 - oPO4WEpiN3) ELSE 0.0 ENDIF;
wPExchAIMWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPAIMWHypN3 - oPAIMWEpiN3) ELSE 0.0 ENDIF;
wNExchNH4WHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNH4WHypN3 - oNH4WEpiN3) ELSE 0.0 ENDIF;
wNExchNO3WHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNO3WHypN3 - oNO3WEpiN3) ELSE 0.0 ENDIF;
wSiExchSiO2WHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oSiO2WHypN3 - oSiO2WEpiN3) ELSE 0.0 ENDIF;
wO2ExchWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oO2WHypN3 - oO2WEpiN3) ELSE 0.0 ENDIF;
wDExchDetWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDDetWHypN3 - oDDetWEpiN3) ELSE 0.0 ENDIF;
wPExchDetWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPDetWHypN3 - oPDetWEpiN3) ELSE 0.0 ENDIF;
wNExchDetWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNDetWHypN3 - oNDetWEpiN3) ELSE 0.0 ENDIF;
wSiExchDetWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oSiDetWHypN3 - oSiDetWEpiN3) ELSE 0.0 ENDIF;
wDExchDiatWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDDiatWHypN3 - oDDiatWEpiN3) ELSE 0.0 ENDIF;
wPExchDiatWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPDiatWHypN3 - oPDiatWEpiN3) ELSE 0.0 ENDIF;
wNExchDiatWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNDiatWHypN3 - oNDiatWEpiN3) ELSE 0.0 ENDIF;
wSiExchDiatWHypN3= IF (aInclStratN3 EQ TRUE ) THEN cSiDDiatN3 * wDExchDiatWHypN3 ELSE 0.0 ENDIF;
wDExchGrenWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDGrenWHypN3 - oDGrenWEpiN3) ELSE 0.0 ENDIF;
wPExchGrenWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPGrenWHypN3 - oPGrenWEpiN3) ELSE 0.0 ENDIF;
wNExchGrenWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNGrenWHypN3 - oNGrenWEpiN3) ELSE 0.0 ENDIF;
wDExchBlueWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDBlueWHypN3 - oDBlueWEpiN3) ELSE 0.0 ENDIF;
wPExchBlueWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPBlueWHypN3 - oPBlueWEpiN3) ELSE 0.0 ENDIF;
wNExchBlueWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNBlueWHypN3 - oNBlueWEpiN3) ELSE 0.0 ENDIF;
wDExchZooWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oDZooHypN3 - oDZooEpiN3) ELSE 0.0 ENDIF;
wPExchZooWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oPZooHypN3 - oPZooEpiN3) ELSE 0.0 ENDIF;
wNExchZooWHypN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWHypN3 *(oNZooHypN3 - oNZooEpiN3) ELSE 0.0 ENDIF;
wDExchIMWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDIMWHypN3 - oDIMWEpiN3) ELSE 0.0 ENDIF;
wPExchPO4WEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPO4WHypN3 - oPO4WEpiN3) ELSE 0.0 ENDIF;
wPExchAIMWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPAIMWHypN3 - oPAIMWEpiN3) ELSE 0.0 ENDIF;
wNExchNH4WEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNH4WHypN3 - oNH4WEpiN3) ELSE 0.0 ENDIF;
wNExchNO3WEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNO3WHypN3 - oNO3WEpiN3) ELSE 0.0 ENDIF;
wSiExchSiO2WEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oSiO2WHypN3 - oSiO2WEpiN3) ELSE 0.0 ENDIF;
wO2ExchWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oO2WHypN3 - oO2WEpiN3) ELSE 0.0 ENDIF;
wDExchDetWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDDetWHypN3 - oDDetWEpiN3) ELSE 0.0 ENDIF;
wPExchDetWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPDetWHypN3 - oPDetWEpiN3) ELSE 0.0 ENDIF;
wNExchDetWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNDetWHypN3 - oNDetWEpiN3) ELSE 0.0 ENDIF;
wSiExchDetWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oSiDetWHypN3 - oSiDetWEpiN3) ELSE 0.0 ENDIF;
wDExchDiatWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDDiatWHypN3 - oDDiatWEpiN3) ELSE 0.0 ENDIF;
wPExchDiatWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPDiatWHypN3 - oPDiatWEpiN3) ELSE 0.0 ENDIF;
wNExchDiatWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNDiatWHypN3 - oNDiatWEpiN3) ELSE 0.0 ENDIF;
wSiExchDiatWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN cSiDDiatN3 * wDExchDiatWEpiN3 ELSE 0.0 ENDIF;
wDExchGrenWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDGrenWHypN3 - oDGrenWEpiN3) ELSE 0.0 ENDIF;
wPExchGrenWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPGrenWHypN3 - oPGrenWEpiN3) ELSE 0.0 ENDIF;
wNExchGrenWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNGrenWHypN3 - oNGrenWEpiN3) ELSE 0.0 ENDIF;
wDExchBlueWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDBlueWHypN3 - oDBlueWEpiN3) ELSE 0.0 ENDIF;
wPExchBlueWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPBlueWHypN3 - oPBlueWEpiN3) ELSE 0.0 ENDIF;
wNExchBlueWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNBlueWHypN3 - oNBlueWEpiN3) ELSE 0.0 ENDIF;
wDExchZooWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oDZooHypN3 - oDZooEpiN3) ELSE 0.0 ENDIF;
wPExchZooWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oPZooHypN3 - oPZooEpiN3) ELSE 0.0 ENDIF;
wNExchZooWEpiN3= IF (aInclStratN3 EQ TRUE ) THEN akExchWEpiN3 *(oNZooHypN3 - oNZooEpiN3) ELSE 0.0 ENDIF;
akExchMHypN3 = 0.0;
akExchLHypN3 = 0.0;
oDPhytWHypN3 = oDDiatWHypN3 + oDGrenWHypN3 + oDBlueWHypN3;
oPPhytWHypN3 = oPDiatWHypN3 + oPGrenWHypN3 + oPBlueWHypN3;
oNPhytWHypN3 = oNDiatWHypN3 + oNGrenWHypN3 + oNBlueWHypN3;
aDPhytSN3 = aDDiatSN3 + aDGrenSN3 + aDBlueSN3 ;
aPPhytSN3 = aPDiatSN3 + aPGrenSN3 + aPBlueSN3 ;
aNPhytSN3 = aNDiatSN3 + aNGrenSN3 + aNBlueSN3;
oDPhytWEpiN3 = oDDiatWEpiN3 + oDGrenWEpiN3 + oDBlueWEpiN3;
oDOMWEpiN3 = oDDetWEpiN3 + oDPhytWEpiN3;
oDOMWHypN3 = oDDetWHypN3 + oDPhytWHypN3;
oTDOMWN3 = oDOMWEpiN3 + oDOMWHypN3;
oDSestWHypN3 = oDOMWHypN3 + oDIMWHypN3;
oPOMWHypN3 = oPPhytWHypN3 + oPDetWHypN3;
oPSestWHypN3 = oPPhytWHypN3 + oPDetWHypN3 + oPAIMWHypN3;
oPInorgWHypN3 = oPO4WHypN3 + oPAIMWHypN3;
oPTotWHypN3 = oPSestWHypN3 + oPO4WHypN3;
oNDissWEpiN3 = oNO3WEpiN3 + oNH4WEpiN3;
oNDissWHypN3 = oNO3WHypN3 + oNH4WHypN3;
oNOMWHypN3 = oNPhytWHypN3 + oNDetWHypN3;
oNSestWHypN3 = oNOMWHypN3;
oNkjWHypN3 = oNSestWHypN3 + oNH4WHypN3;
oNTotWHypN3 = oNkjWHypN3 + oNO3WHypN3;
bPorSN3 = (1.0 - fDTotS0N3) * (fDOrgS0N3 * cRhoOMN3 + (1 - fDOrgS0N3) * cRhoIMN3) / cRhoWatN3 / ( fDTotS0N3 + (1.0 - fDTotS0N3) * (fDOrgS0N3 * cRhoOMN3 + (1 - fDOrgS0N3) * cRhoIMN3) / cRhoWatN3 );
bPorCorSN3 = IF POW(bPorSN3 , (bPorSN3 + 1.0)) LE NearZeroN3 THEN 1 ELSE POW(bPorSN3 , (bPorSN3 + 1.0)) ENDIF;
aDTotSN3 = aDIMSN3 + aDHumSN3 + aDDetSN3;
aRhoTotSN3 = aDTotSN3 / cDepthSN3;
aRhoSolidSN3 = (aDIMSN3 * cRhoIMN3 + (aDHumSN3 + aDDetSN3) * cRhoOMN3) / aDTotSN3;
afDTotSN3 = 1.0 / (1.0 + bPorSN3/(1.0-bPorSN3) * cRhoWatN3 / aRhoSolidSN3);
afDOrgSN3 = (aDHumSN3 + aDDetSN3) / aDTotSN3;
afDetSN3 = aDDetSN3 / (aDHumSN3 + aDDetSN3);
afDetTotSN3 = aDDetSN3 / (aDIMSN3 + aDHumSN3 + aDDetSN3);
aPInorgSN3 = aPO4SN3 + aPAIMSN3;
aPTotAvailSN3 = aPDetSN3 + aPInorgSN3 + aPPhytSN3;
aPTotSN3 = aPTotAvailSN3 + aPHumSN3;
afPInorgSN3 = aPInorgSN3 / aDTotSN3;
afPTotSN3 = aPTotSN3 / aDTotSN3;
afPO4SN3 = aPO4SN3 / (aPTotAvailSN3 + NearZeroN3);
oPO4SN3 = aPO4SN3 / cDepthSN3 / bPorSN3;
aNDissSN3 = aNH4SN3 + aNO3SN3;
aNkjAvailSN3 = aNDetSN3 + aNPhytSN3 + aNH4SN3;
aNkjSN3 = aNkjAvailSN3 + aNHumSN3;
aNTotAvailSN3 = aNkjAvailSN3 + aNO3SN3;
aNTotSN3 = aNkjSN3 + aNO3SN3;
afNInorgSN3 = aNDissSN3 / aDTotSN3;
afNTotSN3 = aNTotSN3 / aDTotSN3;
oNO3SN3 = aNO3SN3 / cDepthSN3 / bPorSN3;
oNH4SN3 = aNH4SN3 / cDepthSN3 / bPorSN3;
oNDissSN3 = aNDissSN3 / cDepthSN3 / bPorSN3;
rPDIMWHypN3 = oPAIMWHypN3 / oDIMWHypN3;
rPDIMSN3 = aPAIMSN3 / aDIMSN3;
rPDDetWHypN3 = oPDetWHypN3 / (oDDetWHypN3+NearZeroN3);
rNDDetWHypN3 = oNDetWHypN3 / (oDDetWHypN3+NearZeroN3);
rSiDDetWHypN3 = oSiDetWHypN3 / (oDDetWHypN3+NearZeroN3);
rPDHumSN3 = aPHumSN3 / (aDHumSN3+NearZeroN3);
rNDHumSN3 = aNHumSN3 / (aDHumSN3+NearZeroN3);
rPDDetSN3 = aPDetSN3 / (aDDetSN3+NearZeroN3);
rNDDetSN3 = aNDetSN3 / (aDDetSN3+NearZeroN3);
rSiDDetSN3 = aSiDetSN3 / (aDDetSN3+NearZeroN3);
oDPhytWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oDDiatWMN3 + oDGrenWMN3 + oDBlueWMN3 ELSE 0.0 ENDIF;
oPPhytWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPDiatWMN3 + oPGrenWMN3 + oPBlueWMN3 ELSE 0.0 ENDIF;
oNPhytWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNDiatWMN3 + oNGrenWMN3 + oNBlueWMN3 ELSE 0.0 ENDIF;
oSiDiatWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cSiDDiatN3 * oDDiatWMN3 ELSE 0.0 ENDIF;
oDOMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oDDetWMN3 + oDPhytWMN3 ELSE 0.0 ENDIF;
oDSestWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oDOMWMN3 + oDIMWMN3 ELSE 0.0 ENDIF;
oPOMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPPhytWMN3 + oPDetWMN3 ELSE 0.0 ENDIF;
oPSestWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPPhytWMN3 + oPDetWMN3 + oPAIMWMN3 ELSE 0.0 ENDIF;
oPInorgWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPO4WMN3 + oPAIMWMN3 ELSE 0.0 ENDIF;
oPTotWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPSestWMN3 + oPO4WMN3 ELSE 0.0 ENDIF;
oNDissWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNO3WMN3 + oNH4WMN3 ELSE 0.0 ENDIF;
oNOMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNPhytWMN3 + oNDetWMN3 ELSE 0.0 ENDIF;
oNSestWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNOMWMN3 ELSE 0.0 ENDIF;
oNkjWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNSestWMN3 + oNH4WMN3 ELSE 0.0 ENDIF;
oNTotWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNkjWMN3 + oNO3WMN3 ELSE 0.0 ENDIF;
bPorSMN3 = (1.0 - fDTotSM0N3) * (fDOrgSM0N3 * cRhoOMN3 +(1 - fDOrgSM0N3) * cRhoIMN3) / cRhoWatN3 /(fDTotSM0N3 + (1.0 - fDTotSM0N3) * (fDOrgSM0N3 * cRhoOMN3 +(1 - fDOrgSM0N3) * cRhoIMN3) / cRhoWatN3);
bPorCorSMN3 = IF POW ( bPorSMN3 , (bPorSMN3 + 1.0)) LE NearZeroN3 THEN 1 ELSE POW ( bPorSMN3 , (bPorSMN3 + 1.0)) ENDIF;
aDTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDIMSMN3 + aDHumSMN3 + aDDetSMN3 ELSE 0.0 ENDIF;
aRhoTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDTotSMN3 / cDepthSMN3 ELSE 0.0 ENDIF;
aRhoSolidSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (aDIMSMN3 * cRhoIMN3 +(aDHumSMN3 + aDDetSMN3) * cRhoOMN3) / aDTotSMN3 ELSE 0.0 ENDIF;
afDTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN 1.0 /(1.0 + bPorSMN3/(1.0-bPorSMN3) * cRhoWatN3 / aRhoSolidSMN3) ELSE 0.0 ENDIF;
afDOrgSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (aDHumSMN3 + aDDetSMN3) / aDTotSMN3 ELSE 0.0 ENDIF;
afDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDDetSMN3 /(aDHumSMN3 + aDDetSMN3) ELSE 0.0 ENDIF;
afDetTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDDetSMN3 /(aDIMSMN3 + aDHumSMN3 + aDDetSMN3) ELSE 0.0 ENDIF;
aPInorgSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPO4SMN3 + aPAIMSMN3 ELSE 0.0 ENDIF;
aPTotAvailSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPDetSMN3 + aPInorgSMN3 ELSE 0.0 ENDIF;
aPTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPTotAvailSMN3 + aPHumSMN3 ELSE 0.0 ENDIF;
afPInorgSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPInorgSMN3 / aDTotSMN3 ELSE 0.0 ENDIF;
afPTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPTotSMN3 / aDTotSMN3 ELSE 0.0 ENDIF;
afPO4SMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPO4SMN3 /(aPTotAvailSMN3 + NearZeroN3) ELSE 0.0 ENDIF;
oPO4SMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPO4SMN3 / cDepthSMN3 / bPorSMN3 ELSE 0.0 ENDIF;
aNDissSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNH4SMN3 + aNO3SMN3 ELSE 0.0 ENDIF;
aNkjAvailSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNDetSMN3 + aNH4SMN3 ELSE 0.0 ENDIF;
aNkjSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNkjAvailSMN3 + aNHumSMN3 ELSE 0.0 ENDIF;
aNTotAvailSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNkjAvailSMN3 + aNO3SMN3 ELSE 0.0 ENDIF;
aNTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNkjSMN3 + aNO3SMN3 ELSE 0.0 ENDIF;
afNInorgSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNDissSMN3 / aDTotSMN3 ELSE 0.0 ENDIF;
afNTotSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNTotSMN3 / aDTotSMN3 ELSE 0.0 ENDIF;
oNO3SMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNO3SMN3 / cDepthSMN3 / bPorSMN3 ELSE 0.0 ENDIF;
oNH4SMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNH4SMN3 / cDepthSMN3 / bPorSMN3 ELSE 0.0 ENDIF;
oNDissSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNDissSMN3 / cDepthSMN3 / bPorSMN3 ELSE 0.0 ENDIF;
rPDIMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPAIMWMN3 / oDIMWMN3 ELSE 0.0 ENDIF;
rPDIMSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPAIMSMN3 / aDIMSMN3 ELSE 0.0 ENDIF;
rPDDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oPDetWMN3 /(oDDetWMN3+NearZeroN3) ELSE 0.0 ENDIF;
rNDDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNDetWMN3 /(oDDetWMN3+NearZeroN3) ELSE 0.0 ENDIF;
rSiDDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oSiDetWMN3 /(oDDetWMN3+NearZeroN3) ELSE 0.0 ENDIF;
rPDHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPHumSMN3 /(aDHumSMN3+NearZeroN3) ELSE 0.0 ENDIF;
rNDHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNHumSMN3 /(aDHumSMN3+NearZeroN3) ELSE 0.0 ENDIF;
rPDDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPDetSMN3 /(aDDetSMN3+NearZeroN3) ELSE 0.0 ENDIF;
rNDDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNDetSMN3 /(aDDetSMN3+NearZeroN3) ELSE 0.0 ENDIF;
rSiDDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aSiDetSMN3 /(aDDetSMN3+NearZeroN3) ELSE 0.0 ENDIF;
aDTotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ((oDIMWMN3 + oDDetWMN3 + oDPhytWMN3 + oDZooMN3) * uDepthWMN3 + aDIMSMN3 + aDHumSMN3 + aDDetSMN3 + aDShootPhraN3 + aDRootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
aPTotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ((oPO4WMN3 + oPDetWMN3 + oPAIMWMN3 + oPPhytWMN3 + oPZooMN3) * uDepthWMN3 + aPO4SMN3 + aPHumSMN3 + aPDetSMN3 + aPAIMSMN3 + aPShootPhraN3 + aPRootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
aNTotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ((oNH4WMN3 + oNO3WMN3 + oNDetWMN3 + oNPhytWMN3 + oNZooMN3) * uDepthWMN3 + aNH4SMN3 + aNO3SMN3 + aNHumSMN3 + aNDetSMN3 + aNShootPhraN3 + aNRootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
aSiTotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ((oSiO2WMN3 + oSiDetWMN3 + oSiDiatWMN3) * uDepthWMN3 + aSiDetSMN3) * fMarshN3 ELSE 0.0 ENDIF;
aO2TotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ((oO2WMN3) * uDepthWMN3 ) * fMarshN3 ELSE 0.0 ENDIF;
uPLoadSeasonEpiN3 = IF (FALSE EQ UseSeasonLoadN3) THEN 0.0 ELSEIF (DayN3 LT cDayApril1N3 - 0.5*cLengChangeN3) THEN cPLoadWinN3 ELSEIF (DayN3 LT cDayApril1N3 + 0.5*cLengChangeN3) THEN 0.5*(cPLoadWinN3 + cPLoadSumN3) + 0.5*(cPLoadWinN3 - cPLoadSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayApril1N3)) ELSEIF (DayN3 LT cDayOct1N3 - 0.5*cLengChangeN3) THEN cPLoadSumN3 ELSEIF (DayN3 LT cDayOct1N3 + 0.5*cLengChangeN3) THEN 0.5*(cPLoadWinN3 + cPLoadSumN3) - 0.5*(cPLoadWinN3 - cPLoadSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayOct1N3)) ELSE cPLoadWinN3 ENDIF;
uPLoadEpiN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mPLoadPO4EpiN3 + mPLoadAIMEpiN3 + mPLoadDiatEpiN3 + mPLoadGrenEpiN3 + mPLoadBlueEpiN3 + mPLoadDetEpiN3) ELSEIF (ReadPLoadN3 EQ TRUE AND ReadNutFracN3 EQ TRUE) THEN mPLoadPO4EpiN3 + mPLoadOrgEpiN3 ELSEIF (ReadPLoadN3 EQ TRUE AND FALSE EQ ReadNutFracN3) THEN mPLoadEpiN3 * mPLoadEpiMultN3 ELSEIF (UsePulseLoadN3 EQ TRUE) THEN 0.0 ELSEIF (UseSeasonLoadN3 EQ TRUE) THEN uPLoadSeasonEpiN3 ELSE cPLoadN3 ENDIF;
uPLoadPO4EpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadPO4EpiN3 ELSEIF (ReadPLoadN3 EQ FALSE) THEN fPO4InN3 * uPLoadEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN mPLoadPO4EpiN3 ELSE fPO4InN3 * uPLoadEpiN3 ENDIF;
uPLoadOrgEpiN3 = IF (FALSE EQ ReadPLoadN3) THEN (1.0 - fPO4InN3) * uPLoadEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN mPLoadOrgEpiN3 ELSE (1.0 - fPO4InN3) * uPLoadEpiN3 ENDIF;
uPLoadPhytTotEpiN3 = IF (FALSE EQ InclSeasonN3) THEN (((fPhytInSumN3 + fPhytInWinN3)/2)*uPLoadOrgEpiN3) ELSEIF (ReadPLoadPhytN3 EQ TRUE) THEN mPLoadPhytTotEpiN3 ELSE ((fPhytInSumN3+fPhytInWinN3)/2.0 - (fPhytInSumN3-fPhytInWinN3)/2.0 * COS(2.0*PiN3 * (sTimeN3 + TenDaysN3 - cTimeLagN3) / DaysInYearN3)) * uPLoadOrgEpiN3 ENDIF;
uPLoadDetEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadDetEpiN3 ELSE uPLoadOrgEpiN3 - uPLoadPhytTotEpiN3 ENDIF;
uPLoadAIMEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadAIMEpiN3 ELSE 0.0 ENDIF;
uPBackLoadHypN3 = IF (FALSE EQ aInclStratN3) THEN 0.0 ELSE cPBackLoadN3 ENDIF;
uPTotInEpiN3 = uPLoadEpiN3 / (uQInEpiN3 / mmPermN3 + NearZeroN3);
uNLoadSeasonEpiN3 = IF (FALSE EQ UseSeasonLoadN3) THEN 0.0 ELSEIF (DayN3 LT cDayApril1N3 - 0.5*cLengChangeN3) THEN cNLoadWinN3 ELSEIF (DayN3 LT cDayApril1N3 + 0.5*cLengChangeN3) THEN 0.5*(cNLoadWinN3 + cNLoadSumN3) + 0.5*(cNLoadWinN3 - cNLoadSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayApril1N3)) ELSEIF (DayN3 LT cDayOct1N3 - 0.5*cLengChangeN3) THEN cNLoadSumN3 ELSEIF (DayN3 LT cDayOct1N3 + 0.5*cLengChangeN3) THEN 0.5*(cNLoadWinN3 + cNLoadSumN3) - 0.5*(cNLoadWinN3 - cNLoadSumN3) * COS(PiN3/cLengChangeN3 * (DayN3 - cDayOct1N3)) ELSE cNLoadWinN3 ENDIF;
uNLoadPhytTotEpiN3 = IF (ReadNutFracN3 EQ FALSE) THEN (cNPPhytInN3 * uPLoadPhytTotEpiN3) ELSE  mNLoadPhytTotEpiN3 ENDIF ;
uNLoadEpiN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mNLoadNH4EpiN3 + mNLoadNO3EpiN3 + mNLoadGrenEpiN3 + mNLoadDiatEpiN3 + mNLoadBlueEpiN3 + mNLoadDetEpiN3) ELSEIF (ReadNLoadN3 EQ TRUE AND ReadNutFracN3 EQ TRUE) THEN mNLoadNH4EpiN3 + mNLoadNO3EpiN3 + mNLoadOrgEpiN3 ELSEIF (ReadNLoadN3 EQ TRUE AND ReadNutFracN3 EQ FALSE) THEN mNLoadEpiN3 ELSEIF (UsePulseLoadN3 EQ TRUE) THEN 0.0 ELSEIF (ReadPLoadN3 EQ TRUE) THEN cNPLoadMeasN3 * uPLoadEpiN3 ELSEIF (UseSeasonLoadN3 EQ TRUE) THEN uNLoadSeasonEpiN3 ELSE cNLoadN3 ENDIF;
uNLoadDetEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadDetEpiN3 ELSEIF (ReadNLoadN3 EQ FALSE ) THEN MIN(cNPDetInN3 * uPLoadDetEpiN3, uNLoadEpiN3 - uNLoadPhytTotEpiN3) ELSEIF (ReadNutFracN3 EQ TRUE) THEN mNLoadOrgEpiN3 - mNLoadPhytTotEpiN3 ELSE MIN(cNPDetInN3 * uPLoadDetEpiN3, uNLoadEpiN3 - uNLoadPhytTotEpiN3) ENDIF;
uNLoadOrgEpiN3 = IF (FALSE EQ ReadNLoadN3) THEN uNLoadPhytTotEpiN3 + uNLoadDetEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN mNLoadOrgEpiN3 ELSE uNLoadPhytTotEpiN3 + uNLoadDetEpiN3 ENDIF;
uNLoadDissEpiN3 = IF (FALSE EQ ReadNLoadN3) THEN uNLoadEpiN3 - uNLoadOrgEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN 0.0 ELSE uNLoadEpiN3 - uNLoadOrgEpiN3 ENDIF;
uNLoadNH4EpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadNH4EpiN3 ELSEIF (ReadNLoadN3 EQ FALSE) THEN fNH4DissInN3 * uNLoadDissEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN mNLoadNH4EpiN3 ELSE fNH4DissInN3 * uNLoadDissEpiN3 ENDIF;
uNLoadNO3EpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadNO3EpiN3 ELSEIF (ReadNLoadN3 EQ FALSE) THEN (1.0 - fNH4DissInN3) * uNLoadDissEpiN3 ELSEIF (ReadNutFracN3 EQ TRUE) THEN mNLoadNO3EpiN3 ELSE (1.0 - fNH4DissInN3) * uNLoadDissEpiN3 ENDIF;
uNBackLoadHypN3 = IF (FALSE EQ aInclStratN3) THEN 0.0 ELSE cNBackLoadN3 ENDIF;
uNTotInEpiN3 = uNLoadEpiN3 / (uQInEpiN3 / mmPermN3 + NearZeroN3);
uDLoadDetEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mDLoadDetEpiN3 ELSEIF (ReadDLoadDetN3 EQ TRUE) THEN mDLoadDetEpiN3 ELSE uNLoadDetEpiN3 / cNDDetInN3 ENDIF;
uDLoadPhytTotEpiN3 = uNLoadPhytTotEpiN3 / cNDPhytInN3;
uDLoadIMEpiN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadIMEpiN3 ELSEIF (ReadDLoadIMN3 EQ TRUE) THEN mDLoadIMEpiN3 ELSE cDIMInN3 * uQInEpiN3 / mmPermN3 ENDIF;
uDLoadEpiN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mDLoadIMEpiN3 + mDLoadDetEpiN3 + mDLoadDiatEpiN3 + mDLoadGrenEpiN3 + mDLoadBlueEpiN3) ELSE uDLoadIMEpiN3 + uDLoadDetEpiN3 + uDLoadPhytTotEpiN3 ENDIF;
uDLoadDiatEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mDLoadDiatEpiN3 ELSE fDiatPhytInN3 * uDLoadPhytTotEpiN3 ENDIF;
uPLoadDiatEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadDiatEpiN3 ELSE fDiatPhytInN3 * uPLoadPhytTotEpiN3 ENDIF;
uNLoadDiatEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadDiatEpiN3 ELSE fDiatPhytInN3 * uNLoadPhytTotEpiN3 ENDIF;
uDLoadGrenEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mDLoadGrenEpiN3 ELSE fGrenPhytInN3 * uDLoadPhytTotEpiN3 ENDIF;
uPLoadGrenEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadGrenEpiN3 ELSE fGrenPhytInN3 * uPLoadPhytTotEpiN3 ENDIF;
uNLoadGrenEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadGrenEpiN3 ELSE fGrenPhytInN3 * uNLoadPhytTotEpiN3 ENDIF;
uDLoadBlueEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mDLoadBlueEpiN3 ELSE fBluePhytInN3 * uDLoadPhytTotEpiN3 ENDIF;
uPLoadBlueEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadBlueEpiN3 ELSE fBluePhytInN3 * uPLoadPhytTotEpiN3 ENDIF;
uNLoadBlueEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadBlueEpiN3 ELSE fBluePhytInN3 * uNLoadPhytTotEpiN3 ENDIF;
uDLoadZooEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mDLoadZooEpiN3 ELSE cDZooInN3 * uQInEpiN3 / mmPermN3 ENDIF;
uPLoadZooEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mPLoadZooEpiN3 ELSE cDZooInN3 * cPDZooRefN3 * uQInEpiN3 / mmPermN3 ENDIF;
uNLoadZooEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mNLoadZooEpiN3 ELSE cDZooInN3 * cNDZooRefN3 * uQInEpiN3 / mmPermN3 ENDIF;
uSiLoadSiO2EpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mSiLoadSiO2EpiN3 ELSE cSiO2InN3 * uQInEpiN3 / mmPermN3 ENDIF;
uSiLoadDetEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mSiLoadDetEpiN3 ELSE cSiDDetInN3 * uDLoadDetEpiN3 ENDIF;
uSiLoadDiatEpiN3 = cSiDDiatN3 * uDLoadDiatEpiN3;
uSiLoadEpiN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2EpiN3 + uSiLoadDetEpiN3 + uSiLoadDiatEpiN3 ENDIF;
uDLoadBlueSurfN3= IF (ReadTranFracN3 EQ TRUE) THEN mDLoadBlueSurfN3 ELSE 0.0 ENDIF;
uPLoadBlueSurfN3= IF (ReadTranFracN3 EQ TRUE) THEN mPLoadBlueSurfN3 ELSE 0.0 ENDIF;
uNLoadBlueSurfN3= IF (ReadTranFracN3 EQ TRUE) THEN mNLoadBlueSurfN3 ELSE 0.0 ENDIF;
uNLoadNH4HypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadNH4HypN3 ELSE 0 ENDIF;
uNLoadNO3HypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadNO3HypN3 ELSE 0 ENDIF;
uPLoadPO4HypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadPO4HypN3 ELSE 0 ENDIF;
uPLoadAIMHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadAIMHypN3 ELSE 0 ENDIF;
uSiLoadSiO2HypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mSiLoadSiO2HypN3 ELSE 0 ENDIF;
uO2LoadHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mO2LoadHypN3 ELSE cO2InN3 * uQInHypN3 / mmPermN3 ENDIF;
uDLoadDetHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadDetHypN3 ELSE 0 ENDIF;
uNLoadDetHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadDetHypN3 ELSE 0 ENDIF;
uPLoadDetHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadDetHypN3 ELSE 0 ENDIF;
uSiLoadDetHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mSiLoadDetHypN3 ELSE 0 ENDIF;
uDLoadIMHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadIMHypN3 ELSE 0 ENDIF;
uDLoadDiatHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadDiatHypN3 ELSE 0 ENDIF;
uNLoadDiatHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadDiatHypN3 ELSE 0 ENDIF;
uPLoadDiatHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadDiatHypN3 ELSE 0 ENDIF;
uSiLoadDiatHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN cSiDDiatN3 * uDLoadDiatHypN3 ELSE 0 ENDIF;
uDLoadGrenHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadGrenHypN3 ELSE 0 ENDIF;
uNLoadGrenHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadGrenHypN3 ELSE 0 ENDIF;
uPLoadGrenHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadGrenHypN3 ELSE 0 ENDIF;
uDLoadBlueHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadBlueHypN3 ELSE 0 ENDIF;
uNLoadBlueHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadBlueHypN3 ELSE 0 ENDIF;
uPLoadBlueHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadBlueHypN3 ELSE 0 ENDIF;
uDLoadZooHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mDLoadZooHypN3 ELSE 0 ENDIF;
uNLoadZooHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mNLoadZooHypN3 ELSE 0 ENDIF;
uPLoadZooHypN3= IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN mPLoadZooHypN3 ELSE 0 ENDIF;
uDLoadHypN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mDLoadIMHypN3 + mDLoadDetHypN3 + mDLoadDiatHypN3 + mDLoadGrenHypN3 + mDLoadBlueHypN3) ELSE 0.0 ENDIF;
uNLoadHypN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mNLoadNH4HypN3 + mNLoadNO3HypN3 + mNLoadGrenHypN3 + mNLoadDiatHypN3 + mNLoadBlueHypN3 + mNLoadDetHypN3) ELSE 0.0 ENDIF;
uPLoadHypN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN3 EQ TRUE) THEN (mPLoadPO4HypN3 + mPLoadAIMHypN3 + mPLoadDiatHypN3 + mPLoadGrenHypN3 + mPLoadBlueHypN3 + mPLoadDetHypN3) ELSE 0.0 ENDIF;
uSiLoadHypN3 = IF (InclTranN3 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2HypN3 + uSiLoadDetHypN3 + uSiLoadDiatHypN3 ENDIF;
wDDilIMHypN3 = ukOutHypN3 * oDIMWHypN3;
wDDilDetHypN3 = ukOutHypN3 * oDDetWHypN3;
wDDilGrenHypN3 = ukOutHypN3 * oDGrenWHypN3;
wDDilBlueHypN3 = ukOutHypN3 * oDBlueWHypN3;
wDDilDiatHypN3 = ukOutHypN3 * oDDiatWHypN3;
wDDilZooHypN3 = ukOutHypN3 * oDZooHypN3;
wPDilZooHypN3 = ukOutHypN3 * oPZooHypN3;
wNDilZooHypN3 = ukOutHypN3 * oNZooHypN3;
wPDilPO4HypN3 = ukOutHypN3 * oPO4WHypN3;
wPDilDetHypN3 = ukOutHypN3*oPDetWHypN3;
wPDilAIMHypN3 = ukOutHypN3 * oPAIMWHypN3;
wNDilNH4HypN3 = ukOutHypN3 * oNH4WHypN3;
wNDilNO3HypN3 = ukOutHypN3 * oNO3WHypN3;
wNDilDetHypN3 = ukOutHypN3 * oNDetWHypN3;
wO2OutflHypN3 = ukOutHypN3 * oO2WHypN3;
wPDilDiatHypN3 = ukOutHypN3 * oPDiatWHypN3;
wNDilDiatHypN3 = ukOutHypN3 * oNDiatWHypN3;
wPDilGrenHypN3 = ukOutHypN3 * oPGrenWHypN3;
wNDilGrenHypN3 = ukOutHypN3 * oNGrenWHypN3;
wPDilBlueHypN3 = ukOutHypN3 * oPBlueWHypN3;
wNDilBlueHypN3 = ukOutHypN3 * oNBlueWHypN3;
wSiDilSiO2HypN3 = ukOutHypN3 * oSiO2WHypN3;
wSiDilDetHypN3 = ukOutHypN3 * oSiDetWHypN3;
wSiDilDiatHypN3 = cSiDDiatN3 * wDDilDiatHypN3;
wDDilPhytHypN3 = wDDilDiatHypN3 + wDDilGrenHypN3 + wDDilBlueHypN3;
wPDilPhytHypN3 = wPDilDiatHypN3 + wPDilGrenHypN3 + wPDilBlueHypN3;
wNDilPhytHypN3 = wNDilDiatHypN3 + wNDilGrenHypN3 + wNDilBlueHypN3;
wSiDilTotHypN3 = wSiDilDetHypN3 + wSiDilSiO2HypN3 + wSiDilDiatHypN3;
wDOutflTotHypN3 = ukOutHypN3 * oDSestWHypN3;
wPOutflTotHypN3 = ukOutHypN3 * oPTotWHypN3;
wNOutflTotHypN3 = ukOutHypN3 * oNTotWHypN3;
wSiOutflTotHypN3 = ukOutHypN3 * (oSiO2WHypN3 + oSiDetWHypN3 + cSiDDiatN3 * oDDiatWHypN3);
tSiTranTotTHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadHypN3 - wSiDilTotHypN3 * uDepthWHypN3 ENDIF;
wDDilTotHypN3 = wDDilIMHypN3 + wDDilDetHypN3 + wDDilPhytHypN3;
wPDilTotHypN3 = wPDilDetHypN3 + wPDilPO4HypN3 + wPDilAIMHypN3 + wPDilPhytHypN3;
wNDilTotHypN3 = wNDilDetHypN3 + wNDilNO3HypN3 + wNDilNH4HypN3 + wNDilPhytHypN3;
tDTranTotTHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadHypN3 - wDDilTotHypN3 * uDepthWHypN3 ENDIF;
tPTranTotTHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadHypN3 - wPDilTotHypN3 * uDepthWHypN3 ENDIF;
tNTranTotTHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadHypN3 - wNDilTotHypN3 * uDepthWHypN3 ENDIF;
uDLoadTotTWN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadEpiN3 + uDLoadHypN3 ENDIF;
uPLoadTotTWN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadEpiN3 + uPLoadHypN3 ENDIF;
uNLoadTotTWN3 =  IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadEpiN3 + uNLoadHypN3 ENDIF;
uSiLoadTotTWN3 =  IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadEpiN3 + uSiLoadHypN3 ENDIF;
wDExchIMMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDIMWHypN3 - oDIMWMN3) ELSE 0.0 ENDIF;
wPExchPO4MHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPO4WHypN3 - oPO4WMN3) ELSE 0.0 ENDIF;
wPExchAIMMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPAIMWHypN3 - oPAIMWMN3) ELSE 0.0 ENDIF;
wNExchNH4MHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNH4WHypN3 - oNH4WMN3) ELSE 0.0 ENDIF;
wNExchNO3MHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNO3WHypN3 - oNO3WMN3) ELSE 0.0 ENDIF;
wSiExchSiO2MHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oSiO2WHypN3 - oSiO2WMN3) ELSE 0.0 ENDIF;
wO2ExchMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oO2WHypN3 - oO2WMN3) ELSE 0.0 ENDIF;
wDExchDetMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDDetWHypN3 - oDDetWMN3) ELSE 0.0 ENDIF;
wPExchDetMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPDetWHypN3 - oPDetWMN3) ELSE 0.0 ENDIF;
wNExchDetMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNDetWHypN3 - oNDetWMN3) ELSE 0.0 ENDIF;
wSiExchDetMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oSiDetWHypN3 - oSiDetWMN3) ELSE 0.0 ENDIF;
wDExchDiatMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDDiatWHypN3 - oDDiatWMN3) ELSE 0.0 ENDIF;
wPExchDiatMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPDiatWHypN3 - oPDiatWMN3) ELSE 0.0 ENDIF;
wNExchDiatMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNDiatWHypN3 - oNDiatWMN3) ELSE 0.0 ENDIF;
wSiExchDiatMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cSiDDiatN3 * wDExchDiatMHypN3 ELSE 0.0 ENDIF;
wDExchGrenMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDGrenWHypN3 - oDGrenWMN3) ELSE 0.0 ENDIF;
wPExchGrenMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPGrenWHypN3 - oPGrenWMN3) ELSE 0.0 ENDIF;
wNExchGrenMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNGrenWHypN3 - oNGrenWMN3) ELSE 0.0 ENDIF;
wDExchBlueMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDBlueWHypN3 - oDBlueWMN3) ELSE 0.0 ENDIF;
wPExchBlueMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPBlueWHypN3 - oPBlueWMN3) ELSE 0.0 ENDIF;
wNExchBlueMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNBlueWHypN3 - oNBlueWMN3) ELSE 0.0 ENDIF;
wDExchZooMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oDZooHypN3 - oDZooMN3) ELSE 0.0 ENDIF;
wPExchZooMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oPZooHypN3 - oPZooMN3) ELSE 0.0 ENDIF;
wNExchZooMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMHypN3 *(oNZooHypN3 - oNZooMN3) ELSE 0.0 ENDIF;
wDExchIMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDIMWHypN3 - oDIMWMN3) ELSE 0.0 ENDIF;
wPExchPO4HypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPO4WHypN3 - oPO4WMN3) ELSE 0.0 ENDIF;
wPExchAIMHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPAIMWHypN3 - oPAIMWMN3) ELSE 0.0 ENDIF;
wNExchNH4HypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNH4WHypN3 - oNH4WMN3) ELSE 0.0 ENDIF;
wNExchNO3HypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNO3WHypN3 - oNO3WMN3) ELSE 0.0 ENDIF;
wSiExchSiO2HypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oSiO2WHypN3 - oSiO2WMN3) ELSE 0.0 ENDIF;
wO2ExchHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oO2WHypN3 - oO2WMN3) ELSE 0.0 ENDIF;
wDExchDetHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDDetWHypN3 - oDDetWMN3) ELSE 0.0 ENDIF;
wPExchDetHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPDetWHypN3 - oPDetWMN3) ELSE 0.0 ENDIF;
wNExchDetHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNDetWHypN3 - oNDetWMN3) ELSE 0.0 ENDIF;
wSiExchDetHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oSiDetWHypN3 - oSiDetWMN3) ELSE 0.0 ENDIF;
wDExchDiatHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDDiatWHypN3 - oDDiatWMN3) ELSE 0.0 ENDIF;
wPExchDiatHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPDiatWHypN3 - oPDiatWMN3) ELSE 0.0 ENDIF;
wNExchDiatHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNDiatWHypN3 - oNDiatWMN3) ELSE 0.0 ENDIF;
wSiExchDiatHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cSiDDiatN3 * wDExchDiatHypN3 ELSE 0.0 ENDIF;
wDExchGrenHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDGrenWHypN3 - oDGrenWMN3) ELSE 0.0 ENDIF;
wPExchGrenHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPGrenWHypN3 - oPGrenWMN3) ELSE 0.0 ENDIF;
wNExchGrenHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNGrenWHypN3 - oNGrenWMN3) ELSE 0.0 ENDIF;
wDExchBlueHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDBlueWHypN3 - oDBlueWMN3) ELSE 0.0 ENDIF;
wPExchBlueHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPBlueWHypN3 - oPBlueWMN3) ELSE 0.0 ENDIF;
wNExchBlueHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNBlueWHypN3 - oNBlueWMN3) ELSE 0.0 ENDIF;
wDExchZooHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oDZooHypN3 - oDZooMN3) ELSE 0.0 ENDIF;
wPExchZooHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oPZooHypN3 - oPZooMN3) ELSE 0.0 ENDIF;
wNExchZooHypN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLHypN3 *(oNZooHypN3 - oNZooMN3) ELSE 0.0 ENDIF;
tInfSiO2WHypN3 =  IF (InclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oSiO2WHypN3 ELSE 0.0 ENDIF;
tInfO2WHypN3 =  IF (InclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oO2WHypN3 ELSE 0.0 ENDIF;
tPInfPO4WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oPO4WHypN3 ELSE 0.0 ENDIF;
tNInfNH4WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNH4WHypN3 ELSE 0.0 ENDIF;
tNInfNO3WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNO3WHypN3 ELSE 0.0 ENDIF;
tPInfPO4SN3 = IF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oPO4SN3 ELSE 0.0 ENDIF;
tNInfNH4SN3 = IF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNH4SN3 ELSE 0.0 ENDIF;
tNInfNO3SN3 = IF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNO3SN3 ELSE 0.0 ENDIF;
tSeepSiO2WHypN3 =  IF (InclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WHypN3 =  IF (InclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oPO4SN3 ELSE 0.0 ENDIF;
tNSeepNH4WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNH4SN3 ELSE 0.0 ENDIF;
tNSeepNO3WHypN3 = IF (aInclStratN3 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNO3SN3 ELSE 0.0 ENDIF;
tPSeepPO4SN3 = IF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cPO4GroundN3 ELSE 0.0 ENDIF;
tNSeepNH4SN3 = IF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cNH4GroundN3 ELSE 0.0 ENDIF;
tNSeepNO3SN3 = IF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cNO3GroundN3 ELSE 0.0 ENDIF;
tNH4LoadSN3 = fNH4LoadSN3 * cNLoadSN3;
tNO3LoadSN3 = cNLoadSN3 - tNH4LoadSN3;
uDErosIMN3 = (1.0 - fDOrgSoilN3) * cDErosTotN3;
uDErosIMSN3 = fSedErosIMN3 * uDErosIMN3;
uDErosIMWN3 = uDErosIMN3 - uDErosIMSN3;
uDErosOMN3 = fDOrgSoilN3 * cDErosTotN3;
uPErosOMN3 = cPDSoilOMN3 * uDErosOMN3;
uNErosOMN3 = cNDSoilOMN3 * uDErosOMN3;
uO2SatEpiN3 = 14.652 - 0.41022 * uTmEpiN3 + 0.007991 * uTmEpiN3*uTmEpiN3 - 0.000077774 * uTmEpiN3*uTmEpiN3*uTmEpiN3;
uO2SatHypN3 = 14.652 - 0.41022 * uTmHypN3 + 0.007991 * uTmHypN3*uTmHypN3- 0.000077774 *uTmHypN3*uTmHypN3*uTmHypN3;
kAerN3 = IF POW ( uVWindN3 , (0.5))  LE NearZeroN3 THEN 1 ELSE cAerRootN3 * POW ( uVWindN3 , (0.5)) + cAerLinN3 * uVWindN3 + cAerSquareN3 * uVWindN3*uVWindN3 ENDIF;
uFunTmAerEpiN3 = IF  POW ( cThetaAerN3 , (uTmEpiN3-cTmRefN3)) LE NearZeroN3 THEN 1 ELSE POW ( cThetaAerN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
uFunTmAerHypN3 = IF POW ( cThetaAerN3 , (uTmHypN3-cTmRefN3)) LE NearZeroN3 THEN 1 ELSE POW ( cThetaAerN3 , (uTmHypN3-cTmRefN3)) ENDIF;
aFunFloatAerN3 =  MAX( 0.0, 1.0 -  ( kFloatAerN3 * aDFloatVegN3 ) );
aFunBlueSurfAerN3 = MAX(0.0, 1.0 - (kBlueSurfAerN3 * aDBlueSurfN3));
tO2BubHypN3 = IF (uO2SatHypN3 LT oO2WHypN3 ) THEN kBubN3 * uFunTmAerHypN3 * (uO2SatHypN3 - oO2WHypN3) ELSE 0 ENDIF;
uFunTmFishN3 = IF (InclWebN3 EQ TRUE) THEN EXP( -0.5/(cSigTmFishN3*cSigTmFishN3) * (( MAX (uTmEpiN3, uTmHypN3 * aInclStratN3) - cTmOptFishN3)*( MAX (uTmEpiN3, uTmHypN3 * aInclStratN3) - cTmOptFishN3) - (cTmRefN3 - cTmOptFishN3)*(cTmRefN3 - cTmOptFishN3))) ELSE 0.0 ENDIF;
tDTurbFishN3 = IF (InclWebN3 EQ TRUE) THEN (kTurbFishN3 * uFunTmFishN3 * aDFiAdN3) ELSE 0.0 ENDIF;
aFunVegResusN3 = MAX(1.0 - kVegResusN3 * aDVegN3, NearZeroN3);
aFunDimSuspN3 = IF (uTmEpiN3 GE 0.1) OR  POW(((cFetchN3 +NearZeroN3)/ cFetchRefN3) , (0.5)) LE NearZeroN3 THEN cSuspRefN3 * ((cSuspMinN3 + cSuspMaxN3 / (1.0 + EXP(cSuspSlopeN3 * (uDepthWN3 - hDepthSuspN3)))) * POW(((cFetchN3 +NearZeroN3)/ cFetchRefN3) , (0.5))) ELSE 0.0 ENDIF;
tDResusTauDeadN3 = IF POW(aFunDimSuspN3 +NearZeroN3 , (0.5)) LE NearZeroN3 THEN MIN(aFunDimSuspN3, POW( 1  , (0.5))) * POW(fLutumN3 / fLutumRefN3 , (0.5)) * bPorSN3 ELSE MIN(aFunDimSuspN3, POW(aFunDimSuspN3 +NearZeroN3 , (0.5))) * POW(fLutumN3 / fLutumRefN3 , (0.5)) * bPorSN3 ENDIF;
tDResusBareDeadN3 = tDResusTauDeadN3 + tDTurbFishN3;
tDResusDeadN3 = tDResusBareDeadN3 * aFunVegResusN3;
tDResusIMN3 = fLutumN3 * aDIMSN3 / (fLutumN3 * aDIMSN3 + aDDetSN3) * tDResusDeadN3;
tDResusDetN3 = aDDetSN3 / (fLutumN3 * aDIMSN3 + aDDetSN3) * tDResusDeadN3;
akResusPhytRefN3 = kResusPhytMaxN3 * (1.0 - EXP(cResusPhytExpN3 * tDResusDeadN3));
tDResusPhytTotN3 = akResusPhytRefN3 * aDPhytSN3;
tPResusDetN3 = rPDDetSN3 * tDResusDetN3;
tPResusPO4N3 = aPO4SN3 / aDDetSN3 * tDResusDetN3;
tPResusAIMN3 = aPAIMSN3 / aDIMSN3 * tDResusIMN3;
tNResusNO3N3 = aNO3SN3 / aDDetSN3 * tDResusDetN3;
tNResusNH4N3 = aNH4SN3 / aDDetSN3 * tDResusDetN3;
tNResusDetN3 = rNDDetSN3 * tDResusDetN3;
tSiResusDetN3 = rSiDDetSN3 * tDResusDetN3;
aFunTauSetOMHypN3 = IF POW(aFunDimSuspN3 +NearZeroN3 , (0.5)) LT NearZeroN3 THEN 1 ELSE MIN(1.0 / POW(aFunDimSuspN3 +NearZeroN3 , (0.5)), 1.0) ENDIF;
aFunTauSetIMHypN3 = aFunTauSetOMHypN3;
uFunTmSetEpiN3 = IF POW ( cThetaSetN3 , (uTmEpiN3-cTmRefN3)) LT NearZeroN3 THEN 1 ELSE POW ( cThetaSetN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
uFunTmSetHypN3 = IF POW(cThetaSetN3 , (uTmHypN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE POW(cThetaSetN3 , (uTmHypN3-cTmRefN3)) ENDIF;
uCorVSetIMHypN3 = IF POW((fLutumRefN3/fLutumN3) , (0.5))  LT NearZeroN3 THEN 1 ELSE aFunTauSetIMHypN3 * POW((fLutumRefN3/fLutumN3) , (0.5)) * uFunTmSetHypN3 * (cVSetIMN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) ENDIF;
tDSetIMHypN3 = uCorVSetIMHypN3 * oDIMWHypN3;
tPSetAIMHypN3 = oPAIMWHypN3 / oDIMWHypN3 * tDSetIMHypN3;
uCorVSetDetHypN3 = (cVSetDetN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMHypN3 * uFunTmSetHypN3;
tDSetDetHypN3 = uCorVSetDetHypN3 * oDDetWHypN3;
tPSetDetHypN3 = uCorVSetDetHypN3 * oPDetWHypN3;
tNSetDetHypN3 = uCorVSetDetHypN3 * oNDetWHypN3;
tSiSetDetHypN3 = uCorVSetDetHypN3 * oSiDetWHypN3;
kPMinDetWN3 = kDMinDetWN3;
kNMinDetWN3 = kDMinDetWN3;
kSiMinDetWN3 = kDMinDetWN3;
uFunTmMinWEpiN3 =  IF POW(cThetaMinWN3 , (uTmEpiN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE POW(cThetaMinWN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
uFunTmMinWHypN3 = IF POW(cThetaMinWN3 , (uTmEpiN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE  POW(cThetaMinWN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
wDMinDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kDMinDetWN3 * uFunTmMinWHypN3 * oDDetWHypN3 ENDIF;
wPMinDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kPMinDetWN3 * uFunTmMinWHypN3 * oPDetWHypN3 ENDIF;
wNMinDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kNMinDetWN3 * uFunTmMinWHypN3 * oNDetWHypN3 ENDIF;
wSiMinDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kSiMinDetWN3 * uFunTmMinWHypN3 * oSiDetWHypN3 ENDIF;
aCorO2BODHypN3 = oO2WHypN3 / (hO2BODN3 + oO2WHypN3);
wO2MinDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE molO2molCN3 * cCPerDWN3 * aCorO2BODHypN3 * wDMinDetWHypN3 ENDIF;
wDDenitWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE oNO3WHypN3*oNO3WHypN3 / (hNO3DenitN3*hNO3DenitN3 + oNO3WHypN3*oNO3WHypN3) * (1.0 - aCorO2BODHypN3) * wDMinDetWHypN3 ENDIF;
wNDenitWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE NO3PerCN3 * molNmolCN3 * cCPerDWN3 * wDDenitWHypN3 ENDIF;
uFunTmNitrHypN3 = IF   POW(cThetaNitrN3 , (uTmHypN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE POW(cThetaNitrN3 , (uTmHypN3-cTmRefN3)) ENDIF;
uFunTmNitrEpiN3 =  IF POW(cThetaNitrN3 , (uTmEpiN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE POW(cThetaNitrN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
uFunTmNitrSN3 = IF POW(cThetaNitrN3 , (uTmEpiN3-cTmRefN3))  LT NearZeroN3 THEN 1 ELSE POW(cThetaNitrN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
aCorO2NitrWHypN3 = oO2WHypN3*oO2WHypN3 / (hO2NitrN3*hO2NitrN3 + oO2WHypN3*oO2WHypN3);
wNNitrWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kNitrWN3 * uFunTmNitrHypN3 * aCorO2NitrWHypN3 * oNH4WHypN3 ENDIF;
wO2NitrWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE O2PerNH4N3 * molO2molNN3 * wNNitrWHypN3 ENDIF;
kPMinDetSN3 = kDMinDetSN3;
kNMinDetSN3 = kDMinDetSN3;
kSiMinDetSN3 = kDMinDetSN3;
uFunTmMinSN3 = IF POW(cThetaMinSN3 , (uTmBotN3-cTmRefN3)) LT NearZeroN3 THEN 1 ELSE  POW(cThetaMinSN3 , (uTmBotN3-cTmRefN3)) ENDIF;
tDMinDetSN3 = kDMinDetSN3 * uFunTmMinSN3 * aDDetSN3;
tPMinDetSN3 = kPMinDetSN3 * uFunTmMinSN3 * aPDetSN3;
tNMinDetSN3 = kNMinDetSN3 * uFunTmMinSN3 * aNDetSN3;
tSiMinDetSN3 = kSiMinDetSN3 * uFunTmMinSN3 * aSiDetSN3;
uFunTmDifN3 = IF POW(cThetaDifN3 , (uTmEpiN3-cTmRefN3)) LT NearZeroN3 THEN 1 ELSE POW(cThetaDifN3 , (uTmEpiN3-cTmRefN3)) ENDIF;
akO2DifCorN3 = kO2DifN3 * uFunTmDifN3 * cTurbDifO2N3 * bPorCorSN3;
tSODN3 = (molO2molCN3 * cCPerDWN3 * (1.0 - fRefrDetSN3) * tDMinDetSN3 + O2PerNH4N3 * molO2molNN3 * kNitrSN3 * uFunTmNitrSN3 * aNH4SN3) / cDepthSN3;
aDepthDifN3 = fDepthDifSN3 * cDepthSN3;
tPDifPO4HypN3 = IF ( aInclStratN3 EQ TRUE ) THEN kPDifPO4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oPO4SN3 - oPO4WHypN3 ) / aDepthDifN3 ELSE 0.0 ENDIF ;
tNDifNO3HypN3 = IF ( aInclStratN3 EQ TRUE ) THEN kNDifNO3N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oNO3SN3 - oNO3WHypN3 ) / aDepthDifN3 ELSE 0.0 ENDIF ;
tNDifNH4HypN3 = IF ( aInclStratN3 EQ TRUE ) THEN kNDifNH4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oNH4SN3 - oNH4WHypN3 ) / aDepthDifN3 ELSE 0.0 ENDIF ;
tO2DifHypN3 = IF ( aInclStratN3 EQ TRUE ) THEN kO2DifN3 / aDepthDifN3 * uFunTmDifN3 * cTurbDifO2N3 * bPorCorSN3 * oO2WHypN3 ELSE 0.0 ENDIF ;
tPDifGroundPO4N3 = 0.0;
tNDifGroundNO3N3 = 0.0;
tNDifGroundNH4N3 = 0.0;
aPAdsMaxWHypN3 = cRelPAdsDN3 + aCorO2BODHypN3 * cRelPAdsFeN3 * fFeDIMN3 + cRelPAdsAlN3 * fAlDIMN3;
aKPAdsWHypN3 = (1.0 - fRedMaxN3 * (1.0-aCorO2BODHypN3)) * cKPAdsOxN3;
aPIsoAdsWHypN3 = aPAdsMaxWHypN3 * aKPAdsWHypN3 * oPO4WHypN3 / (1.0 + aKPAdsWHypN3 * oPO4WHypN3);
aPEqIMWHypN3 = aPIsoAdsWHypN3 * oDIMWHypN3;
wPSorpIMWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kPSorpN3 * (aPEqIMWHypN3 - oPAIMWHypN3) ENDIF;
tPChemPO4N3 = MAX( 0.0, kPChemPO4N3 * (oPO4SN3 - coPO4MaxN3) );
uQEvPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN uQEvN3 ELSE 0.0 ENDIF;
tPEvPO4WMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN uQEvPhraN3 / mmPermN3 * oPO4WMN3 ELSE 0.0 ENDIF;
tNEvNH4WMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN uQEvPhraN3 / mmPermN3 * oNH4WMN3 ELSE 0.0 ENDIF;
tNEvNO3WMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN uQEvPhraN3 / mmPermN3 * oNO3WMN3 ELSE 0.0 ENDIF;
tInfSiO2WMN3 = IF ((InclMarshN3 EQ FALSE) OR (fMarshN3 LE NearZeroN3)) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oSiO2WMN3 ELSE 0.0 ENDIF;
tInfO2WMN3 = IF ((InclMarshN3 EQ FALSE) OR (fMarshN3 LE NearZeroN3)) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oO2WMN3 ELSE 0.0 ENDIF;
tPInfPO4WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oPO4WMN3 ELSE 0.0 ENDIF;
tNInfNH4WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNH4WMN3 ELSE 0.0 ENDIF;
tNInfNO3WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNO3WMN3 ELSE 0.0 ENDIF;
tPInfPO4SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oPO4SMN3 ELSE 0.0 ENDIF;
tNInfNH4SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNH4SMN3 ELSE 0.0 ENDIF;
tNInfNO3SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNO3SMN3 ELSE 0.0 ENDIF;
tSeepSiO2WMN3 = IF ((InclMarshN3 EQ FALSE) OR (fMarshN3 LT NearZeroN3)) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WMN3 = IF ((InclMarshN3 EQ FALSE) OR (fMarshN3 LT NearZeroN3)) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oPO4SMN3 ELSE 0.0 ENDIF;
tNSeepNH4WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNH4SMN3 ELSE 0.0 ENDIF;
tNSeepNO3WMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNO3SMN3 ELSE 0.0 ENDIF;
tPSeepPO4SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cPO4GroundN3 ELSE 0.0 ENDIF;
tNSeepNH4SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cNH4GroundN3 ELSE 0.0 ENDIF;
tNSeepNO3SMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * cNO3GroundN3 ELSE 0.0 ENDIF;
tO2AerMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kAerN3 * uFunTmAerEpiN3 *(uO2SatEpiN3 - oO2WMN3) ELSE 0.0 ENDIF;
tDSetIMMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetIMN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oDIMWMN3 ELSE 0.0 ENDIF;
tPSetAIMMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetIMN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oPAIMWMN3 ELSE 0.0 ENDIF;
tDSetDetMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDetN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oDDetWMN3 ELSE 0.0 ENDIF;
tPSetDetMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDetN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oPDetWMN3 ELSE 0.0 ENDIF;
tNSetDetMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDetN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oNDetWMN3 ELSE 0.0 ENDIF;
tSiSetDetMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDetN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oSiDetWMN3 ELSE 0.0 ENDIF;
tDSetDiatMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ( cVSetDiatN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oDDiatWMN3 ELSE 0.0 ENDIF;
tPSetDiatMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDiatN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oPDiatWMN3 ELSE 0.0 ENDIF;
tNSetDiatMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ( cVSetDiatN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oNDiatWMN3 ELSE 0.0 ENDIF;
tSiSetDiatMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetDiatN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oSiDiatWMN3 ELSE 0.0 ENDIF;
tDSetGrenMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetGrenN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oDGrenWMN3 ELSE 0.0 ENDIF;
tPSetGrenMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetGrenN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oPGrenWMN3 ELSE 0.0 ENDIF;
tNSetGrenMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetGrenN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oNGrenWMN3 ELSE 0.0 ENDIF;
tDSetBlueMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3 * oDBlueWMN3 ELSE 0.0 ENDIF;
tPSetBlueMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3)* uFunTmSetEpiN3* oPBlueWMN3 ELSE 0.0 ENDIF;
tNSetBlueMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * uFunTmSetEpiN3* oNBlueWMN3 ELSE 0.0 ENDIF;
tDSetPhytMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDSetDiatMN3 + tDSetGrenMN3 + tDSetBlueMN3 ELSE 0.0 ENDIF;
tPSetPhytMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tPSetDiatMN3 + tPSetGrenMN3 + tPSetBlueMN3 ELSE 0.0 ENDIF;
tNSetPhytMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tNSetDiatMN3 + tNSetGrenMN3 + tNSetBlueMN3 ELSE 0.0 ENDIF;
tDSetTotMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDSetIMMN3 + tDSetDetMN3 + tDSetPhytMN3 ELSE 0.0 ENDIF;
wDMinDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMinDetWN3 * uFunTmMinWEpiN3 * oDDetWMN3 ELSE 0.0 ENDIF;
wPMinDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kPMinDetWN3 * uFunTmMinWEpiN3 * oPDetWMN3 ELSE 0.0 ENDIF;
wNMinDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kNMinDetWN3 * uFunTmMinWEpiN3 * oNDetWMN3 ELSE 0.0 ENDIF;
wSiMinDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kSiMinDetWN3 * uFunTmMinWEpiN3 * oSiDetWMN3 ELSE 0.0 ENDIF;
aCorO2BODMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oO2WMN3 /(hO2BODN3 + oO2WMN3) ELSE 0.0 ENDIF;
wO2MinDetWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN molO2molCN3 * cCPerDWN3 * aCorO2BODMN3 * wDMinDetWMN3 ELSE 0.0 ENDIF;
wDDenitWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNO3WMN3*oNO3WMN3 /(hNO3DenitN3*hNO3DenitN3 + oNO3WMN3*oNO3WMN3) *(1.0 - aCorO2BODMN3) * wDMinDetWMN3 ELSE 0.0 ENDIF;
wNDenitWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN NO3PerCN3 * molNmolCN3 * cCPerDWN3 * wDDenitWMN3 ELSE 0.0 ENDIF;
aCorO2NitrWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oO2WMN3 * oO2WMN3 /(hO2NitrN3 * hO2NitrN3 + oO2WMN3 * oO2WMN3) ELSE 0.0 ENDIF;
wNNitrWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kNitrWN3 * uFunTmNitrEpiN3 * aCorO2NitrWMN3 * oNH4WMN3 ELSE 0.0 ENDIF;
wO2NitrWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN O2PerNH4N3 * molO2molNN3 * wNNitrWMN3 ELSE 0.0 ENDIF;
tDMinDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMinDetSN3 * uFunTmMinSN3 * aDDetSMN3 ELSE 0.0 ENDIF;
tPMinDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kPMinDetSN3 * uFunTmMinSN3 * aPDetSMN3 ELSE 0.0 ENDIF;
tNMinDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kNMinDetSN3 * uFunTmMinSN3 * aNDetSMN3 ELSE 0.0 ENDIF;
tSiMinDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kSiMinDetSN3 * uFunTmMinSN3 * aSiDetSMN3 ELSE 0.0 ENDIF;
akO2DifCorMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kO2DifN3 * uFunTmDifN3 * cTurbDifO2N3 * bPorCorSMN3 ELSE 0.0 ENDIF;
tSODMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN(molO2molCN3 * cCPerDWN3 *(1.0 - fRefrDetSN3) * tDMinDetSMN3 + O2PerNH4N3 * molO2molNN3 * kNitrSN3 * uFunTmNitrEpiN3 * aNH4SMN3) / cDepthSMN3 ELSE 0.0 ENDIF;
aDepthOxySedMN3 = IF (InclMarshN3 EQ FALSE OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF POW((2.0 * oO2WMN3 * akO2DifCorMN3 / tSODMN3) , (0.5)) LE NearZeroN3 THEN 1 ELSE POW((2.0 * oO2WMN3 * akO2DifCorMN3 / tSODMN3) , (0.5)) ENDIF ;
afOxySedMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDepthOxySedMN3 / cDepthSMN3 ELSE 0.0 ENDIF;
tDMinOxyDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN afOxySedMN3 *(1.0 - fRefrDetSN3) * tDMinDetSMN3 ELSE 0.0 ENDIF;
tO2MinDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN molO2molCN3 * cCPerDWN3 * tDMinOxyDetSMN3 ELSE 0.0 ENDIF;
tDDenitSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN oNO3SMN3*oNO3SMN3 /(hNO3DenitN3*hNO3DenitN3 + oNO3SMN3*oNO3SMN3) *(1.0 - afOxySedMN3) *(1.0 - fRefrDetSN3) * tDMinDetSMN3 ELSE 0.0 ENDIF;
tNDenitSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN NO3PerCN3 * molNmolCN3 * cCPerDWN3 * tDDenitSMN3 ELSE 0.0 ENDIF;
tNNitrSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN afOxySedMN3 * kNitrSN3 * uFunTmNitrEpiN3 * aNH4SMN3 ELSE 0.0 ENDIF;
tO2NitrSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN O2PerNH4N3 * molO2molNN3 * tNNitrSMN3 ELSE 0.0 ENDIF;
tDMinHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMinHumN3 * uFunTmMinSN3 * afOxySedMN3 * aDHumSMN3 ELSE 0.0 ENDIF;
tPMinHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMinHumN3 * uFunTmMinSN3 * afOxySedMN3 * aPHumSMN3 ELSE 0.0 ENDIF;
tNMinHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMinHumN3 * uFunTmMinSN3 * afOxySedMN3 * aNHumSMN3 ELSE 0.0 ENDIF;
aDepthDifMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN fDepthDifSN3 * cDepthSMN3 ELSE 0.0 ENDIF;
tPDifPO4MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kPDifPO4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSMN3 * (oPO4SMN3 - oPO4WMN3) / aDepthDifMN3 ELSE 0.0 ENDIF;
tNDifNO3MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kNDifNO3N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSMN3 * (oNO3SMN3 - oNO3WMN3) / aDepthDifMN3 ELSE 0.0 ENDIF;
tNDifNH4MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kNDifNH4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSMN3 * (oNH4SMN3 - oNH4WMN3) / aDepthDifMN3 ELSE 0.0 ENDIF;
tO2DifMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kO2DifN3 / aDepthDifMN3 * uFunTmDifN3 * cTurbDifO2N3 * bPorCorSMN3 * oO2WMN3 ELSE 0.0 ENDIF;
tPDifGroundPO4MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNO3MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNH4MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN 0.0 ELSE 0.0 ENDIF;
aPAdsMaxWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cRelPAdsDN3 + aCorO2BODMN3 * cRelPAdsFeN3 * fFeDIMN3 + cRelPAdsAlN3 * fAlDIMN3 ELSE 0.0 ENDIF;
aKPAdsWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN(1.0 - fRedMaxN3 *(1.0-aCorO2BODMN3)) * cKPAdsOxN3 ELSE 0.0 ENDIF;
aPIsoAdsWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPAdsMaxWMN3 * aKPAdsWMN3 * oPO4WMN3 /(1.0 + aKPAdsWMN3 * oPO4WMN3) ELSE 0.0 ENDIF;
aPEqIMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPIsoAdsWMN3 * oDIMWMN3 ELSE 0.0 ENDIF;
wPSorpIMWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kPSorpN3 *(aPEqIMWMN3 - oPAIMWMN3) ELSE 0.0 ENDIF;
aPAdsMaxSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cRelPAdsDN3 + afOxySedMN3 * cRelPAdsFeN3 * fFeDIMN3 + cRelPAdsAlN3 * fAlDIMN3 ELSE 0.0 ENDIF;
aKPAdsSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN(1.0 - fRedMaxN3 *(1.0-afOxySedMN3)) * cKPAdsOxN3 ELSE 0.0 ENDIF;
aPIsoAdsSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPAdsMaxSMN3 * aKPAdsSMN3 * oPO4SMN3 /(1.0 + aKPAdsSMN3 * oPO4SMN3) ELSE 0.0 ENDIF;
aPEqIMSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPIsoAdsSMN3 * aDIMSMN3 ELSE 0.0 ENDIF;
tPSorpIMSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kPSorpN3 *(aPEqIMSMN3 - aPAIMSMN3) ELSE 0.0 ENDIF;
tPChemPO4MN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN MAX(0.0,kPChemPO4N3 *(oPO4SMN3 - coPO4MaxN3)) ELSE 0.0 ENDIF;
aDRootVegN3 = bfRootVegN3 * aDVegN3;
bfSubVegEpiN3 = bfSubVegN3 * ( uVegHeightEpiN3 / uDepthWN3 );
bfSubVegHypN3 = bfSubVegN3 * ( uVegHeightHypN3 / uDepthWN3 );
afCovSurfVegN3 = MIN(1.0, MAX(aDFloatVegN3 / (cDLayerVegN3 + NearZeroN3), aDEmergVegN3 / (fEmergVegN3 * cDCarrVegN3 + NearZeroN3) ) ) ;
afCovEmergVegN3 = MIN(1.0, PerCentN3 * cCovSpVegN3 * aDEmergVegN3);
aCovVegN3 = MIN(100.0, cCovSpVegN3 * aDShootVegN3);
aLPARBotHypN3 = uLPARSurfHypN3 * EXP(- aExtCoefHypN3 * uDepthWHypN3);
rPDVegN3 = aPVegN3 / (aDVegN3+NearZeroN3);
rNDVegN3 = aNVegN3 / (aDVegN3+NearZeroN3);
tDMigrVegN3 = kMigrVegN3 * (cDVegInN3 - aDVegN3);
tPMigrVegN3 = kMigrVegN3 * (cPDVeg0N3* cDVegInN3 - aPVegN3);
tNMigrVegN3 = kMigrVegN3 * (cNDVeg0N3* cDVegInN3 - aNVegN3);
uFunTmRespVegN3 = IF ( UseExpVegN3 GT NearZeroN3 ) THEN uFunTmVegN3 ELSE POW(cQ10RespVegN3 , (0.1 * (uTmVegAveN3 - cTmRefN3))) ENDIF;
afPUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN 0.0 ELSEIF (bfRootVegN3 LE NearZeroN3) THEN 0.0 ELSEIF (fFloatVegN3 + bfSubVegN3 LE NearZeroN3) THEN 1.0 ELSEIF (aInclStratN3 EQ TRUE AND ((oPO4SN3+NearZeroN3) / (oPO4WHypN3+NearZeroN3)) GT NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(((oPO4SN3+NearZeroN3) / (oPO4WHypN3+NearZeroN3)) , fSedUptVegExpN3)) ELSEIF (aInclStratN3 EQ TRUE AND ((oPO4SN3+NearZeroN3) / (oPO4WHypN3+NearZeroN3)) LE NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW( NearZeroN3 , fSedUptVegExpN3)) ELSEIF (((oPO4SN3+NearZeroN3) / (oPO4WEpiN3+NearZeroN3)) LE NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW (NearZeroN3 , fSedUptVegExpN3)) ELSE fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(((oPO4SN3+NearZeroN3) / (oPO4WEpiN3+NearZeroN3)) , fSedUptVegExpN3)) ENDIF;
afNUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN 0.0 ELSEIF (bfRootVegN3 LE NearZeroN3) THEN 0.0 ELSEIF (fFloatVegN3 + bfSubVegN3 LE NearZeroN3) THEN 1.0 ELSEIF ( aInclStratN3 EQ TRUE AND ((oNDissSN3+NearZeroN3) / (oNDissWHypN3+NearZeroN3)) GT NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(((oNDissSN3+NearZeroN3) / (oNDissWHypN3+NearZeroN3)) , fSedUptVegExpN3)) ELSEIF ( aInclStratN3 EQ TRUE AND ((oNDissSN3+NearZeroN3) / (oNDissWHypN3+NearZeroN3)) LE NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(NearZeroN3 , fSedUptVegExpN3)) ELSEIF ( ((oNDissSN3+NearZeroN3) / (oNDissWEpiN3+NearZeroN3)) LE NearZeroN3 ) THEN fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(NearZeroN3 , fSedUptVegExpN3)) ELSE fSedUptVegMaxN3 / (1.0 + fSedUptVegCoefN3 * POW(((oNDissSN3+NearZeroN3) / (oNDissWEpiN3+NearZeroN3)) , fSedUptVegExpN3)) ENDIF;
aVPUptMaxCrVegN3 = IF (FALSE EQ UseEmpUptN3) THEN MAX( 0.0, cVPUptMaxVegN3 * uFunTmProdVegN3 * (cPDVegMaxN3-rPDVegN3) / (cPDVegMaxN3-cPDVegMinN3) ) ELSE MAX( 0.0, cVPUptMaxVegN3 * uFunTmProdVegN3 * (cPDVegMaxN3-rPDVegN3) / (cPDVegMaxN3-cPDVegMinN3) ) ENDIF;
aVPUptVegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN oPO4WHypN3 * aVPUptMaxCrVegN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4WHypN3) ELSE 0.0 ENDIF;
aVPUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN oPO4SN3 * aVPUptMaxCrVegN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4SN3) ELSE 0.0 ENDIF;
aVPUptVegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN oPO4WEpiN3 * aVPUptMaxCrVegN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4WEpiN3) ELSE 0.0 ENDIF;
tPUptVegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN aVPUptVegWEpiN3 * (aDSubVegN3 + aDFloatVegN3) ELSE (1.0 - afPUptVegSN3) * aVPUptMaxCrVegN3 * oPO4WEpiN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4WEpiN3) * uDVegEpiN3 ENDIF;
tPUptVegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN aVPUptVegWHypN3 * (aDSubVegN3 + aDFloatVegN3) ELSE (1.0 - afPUptVegSN3) * aVPUptMaxCrVegN3 * oPO4WHypN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4WHypN3) * uDVegHypN3 ENDIF;
tPUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN aVPUptVegSN3 * aDRootVegN3 ELSE afPUptVegSN3 * aVPUptMaxCrVegN3 * oPO4SN3 / (aVPUptMaxCrVegN3 / cAffPUptVegN3 + oPO4SN3) * aDVegN3 ENDIF;
tPUptVegEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN tPUptVegWEpiN3 + tPUptVegSN3 * uDVegEpiN3 / aDVegN3 ELSEIF (aInclStratN3 EQ FALSE AND FALSE EQ UseEmpUptN3) THEN tPUptVegWEpiN3 + tPUptVegSN3 ELSE tPUptVegWEpiN3 + tPUptVegSN3 ENDIF;
tPUptVegHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN3) THEN tPUptVegWHypN3 + tPUptVegSN3 * uDVegHypN3 / aDVegN3 ELSE tPUptVegWHypN3 + tPUptVegSN3 * uDVegHypN3 / aDVegN3 ENDIF ;
aVNUptMaxCrVegN3 = IF (FALSE EQ UseEmpUptN3) THEN MAX( 0.0, cVNUptMaxVegN3 * uFunTmProdVegN3 * (cNDVegMaxN3 - rNDVegN3) / (cNDVegMaxN3 - cNDVegMinN3)) ELSE MAX( 0.0, cVNUptMaxVegN3 * uFunTmProdVegN3 * (cNDVegMaxN3 - rNDVegN3) / (cNDVegMaxN3 - cNDVegMinN3)) ENDIF;
ahNUptVegN3 = IF (FALSE EQ UseEmpUptN3) THEN aVNUptMaxCrVegN3 / cAffNUptVegN3 ELSE aVNUptMaxCrVegN3 / cAffNUptVegN3 ENDIF;
aVNUptVegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN oNDissWEpiN3 * aVNUptMaxCrVegN3 / (ahNUptVegN3 + oNDissWEpiN3) ELSE 0.0 ENDIF;
aVNUptVegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN oNDissWHypN3 * aVNUptMaxCrVegN3 / (ahNUptVegN3 + oNDissWHypN3) ELSE 0.0 ENDIF;
afNH4UptVegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN oNH4WEpiN3 * oNO3WEpiN3 / ((ahNUptVegN3 + oNH4WEpiN3) * (ahNUptVegN3 + oNO3WEpiN3 + NearZeroN3)) + oNH4WEpiN3 * ahNUptVegN3 / ((oNH4WEpiN3 + oNO3WEpiN3 + NearZeroN3) * (ahNUptVegN3 + oNO3WEpiN3 + NearZeroN3)) ELSE oNH4WEpiN3 * oNO3WEpiN3 / ((ahNUptVegN3 + oNH4WEpiN3) * (ahNUptVegN3 + oNO3WEpiN3 + NearZeroN3)) + oNH4WEpiN3 * ahNUptVegN3 / ((oNH4WEpiN3 + oNO3WEpiN3 + NearZeroN3) * (ahNUptVegN3 + oNO3WEpiN3 + NearZeroN3)) ENDIF;
afNH4UptVegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN oNH4WHypN3 * oNO3WHypN3 / ((ahNUptVegN3 + oNH4WHypN3) * (ahNUptVegN3 + oNO3WHypN3 + NearZeroN3)) + oNH4WHypN3 * ahNUptVegN3 / ((oNH4WHypN3 + oNO3WHypN3 + NearZeroN3) * (ahNUptVegN3 + oNO3WHypN3 + NearZeroN3)) ELSE oNH4WHypN3 * oNO3WHypN3 / ((ahNUptVegN3 + oNH4WHypN3) * (ahNUptVegN3 + oNO3WHypN3 + NearZeroN3)) + oNH4WHypN3 * ahNUptVegN3 / ((oNH4WHypN3 + oNO3WHypN3 + NearZeroN3) * (ahNUptVegN3 + oNO3WHypN3 + NearZeroN3)) ENDIF;
tNUptVegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN aVNUptVegWEpiN3 * (aDSubVegN3 + aDFloatVegN3) ELSE (1.0 - afNUptVegSN3) * aVNUptMaxCrVegN3 * oNDissWEpiN3 / (aVNUptMaxCrVegN3 / cAffNUptVegN3 + oNDissWEpiN3) * uDVegEpiN3 ENDIF;
tNUptVegWHypN3 = IF (FALSE EQ aInclStratN3) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN3) THEN aVNUptVegWHypN3 * (aDSubVegN3 + aDFloatVegN3) ELSE (1.0 - afNUptVegSN3) * aVNUptMaxCrVegN3 * oNDissWHypN3 / (aVNUptMaxCrVegN3 / cAffNUptVegN3 + oNDissWHypN3) * uDVegHypN3 ENDIF;
tNUptNH4VegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN afNH4UptVegWEpiN3 * tNUptVegWEpiN3 ELSE afNH4UptVegWEpiN3 * tNUptVegWEpiN3 ENDIF;
tNUptNO3VegWEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN tNUptVegWEpiN3 - tNUptNH4VegWEpiN3 ELSE tNUptVegWEpiN3 - tNUptNH4VegWEpiN3 ENDIF;
tNUptNH4VegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN afNH4UptVegWHypN3 * tNUptVegWHypN3 ELSE afNH4UptVegWHypN3 * tNUptVegWHypN3 ENDIF;
tNUptNO3VegWHypN3 = IF (FALSE EQ UseEmpUptN3) THEN tNUptVegWHypN3 - tNUptNH4VegWHypN3 ELSE tNUptVegWHypN3 - tNUptNH4VegWHypN3 ENDIF;
aVNUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN oNDissSN3 * aVNUptMaxCrVegN3 / (ahNUptVegN3 + oNDissSN3) ELSE 0.0 ENDIF;
tNUptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN aVNUptVegSN3 * aDRootVegN3 ELSE afNUptVegSN3 * aVNUptMaxCrVegN3 * oNDissSN3 / (aVNUptMaxCrVegN3 / cAffNUptVegN3 + oNDissSN3) * aDVegN3 ENDIF;
afNH4UptVegSN3 = IF (FALSE EQ UseEmpUptN3) THEN oNH4SN3 * oNO3SN3 / ((ahNUptVegN3 + oNH4SN3 +NearZeroN3) * (ahNUptVegN3 + oNO3SN3 +NearZeroN3)) + oNH4SN3 * ahNUptVegN3 / ((oNH4SN3 + oNO3SN3+NearZeroN3) * (ahNUptVegN3 + oNO3SN3+NearZeroN3)) ELSE oNH4SN3 * oNO3SN3 / ((ahNUptVegN3 + oNH4SN3 +NearZeroN3) * (ahNUptVegN3 + oNO3SN3 +NearZeroN3)) + oNH4SN3 * ahNUptVegN3 / ((oNH4SN3 + oNO3SN3+NearZeroN3) * (ahNUptVegN3 + oNO3SN3+NearZeroN3)) ENDIF;
tNUptNH4VegSN3 = IF (FALSE EQ UseEmpUptN3) THEN afNH4UptVegSN3 * tNUptVegSN3 ELSE afNH4UptVegSN3 * tNUptVegSN3 ENDIF;
tNUptVegSEpiN3 = IF (FALSE EQ UseEmpUptN3) THEN aVNUptVegSN3 * aDRootVegN3 ELSE afNUptVegSN3 * aVNUptMaxCrVegN3 * oNDissSN3 / (aVNUptMaxCrVegN3 / cAffNUptVegN3 + oNDissSN3) * aDVegN3 ENDIF;
tNUptNO3VegSN3 = IF (FALSE EQ UseEmpUptN3) THEN tNUptVegSN3 - tNUptNH4VegSN3 ELSE tNUptVegSN3 - tNUptNH4VegSN3 ENDIF;
tNUptVegN3 =tNUptVegWEpiN3 + tNUptVegWHypN3 + tNUptVegSN3;
aLLimShootVegEpiN3 = fEmergVegN3 + fFloatVegN3 * (1.0 - afCovEmergVegN3) + bfSubVegEpiN3 * (1.0 - afCovSurfVegN3) * 1.0 / (aExtCoefEpiN3 * uDepthWEpiN3) * LN( (1.0 + aLPAR1VegEpiN3 / uhLVegN3) / (1.0 + aLPAR2VegEpiN3 / uhLVegN3));
aLLimShootVegHypN3 = fEmergVegN3 + fFloatVegN3 * (1.0 - afCovEmergVegN3) + bfSubVegHypN3 * (1.0 - afCovSurfVegN3) * 1.0 / (aExtCoefHypN3 * uDepthWHypN3) * LN( (1.0 + aLPAR1VegHypN3 / uhLVegN3) / (1.0 + aLPAR2VegHypN3 / uhLVegN3));
aMuTmLVegHypN3 = ufDayN3 * bfShootVegN3 * aLLimShootVegHypN3 * uFunTmProdVegN3 * cMuMaxVegN3;
aPLimVegN3 = MAX(0.0, (1.0 - cPDVegMinN3 / rPDVegN3) * cPDVegMaxN3 / (cPDVegMaxN3 - cPDVegMinN3) );
aNLimVegN3 = MAX(0.0, (1.0 - cNDVegMinN3 / rNDVegN3) * cNDVegMaxN3 / (cNDVegMaxN3 - cNDVegMinN3) );
aNutLimVegN3 = MIN( aPLimVegN3, aNLimVegN3);
aMuVegHypN3 = aMuTmLVegHypN3 * aNutLimVegN3;
bkMortVegN3 = IF (FALSE EQ InclSeasonN3) THEN kMortVegSumN3 ELSEIF (aVegWinN3 EQ TRUE AND aDaysVegWinN3 LE cLengMortN3 AND aDaysVegWinN3 GT 0) THEN - LN(fWinVegN3) / cLengMortN3 ELSE kMortVegSumN3 ENDIF;
akDIncrVegHypN3 = aMuTmLVegHypN3 - kDRespVegN3 * uFunTmRespVegN3 - bkMortVegN3;
tDEnvVegHypN3 = MAX(0.0, akDIncrVegHypN3 / (cDCarrVegN3+NearZeroN3) * aDVegN3*aDVegN3);
tDEnvProdVegHypN3 = aMuVegHypN3 / cMuMaxVegN3 * tDEnvVegHypN3;
tDProdVegHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE MAX(0.0, aMuVegHypN3 * uDVegHypN3 - tDEnvProdVegHypN3) ENDIF;
tDProdSubVegHypN3 = bfSubVegHypN3 * tDProdVegHypN3;
tDRespVegN3 = kDRespVegN3 * uFunTmRespVegN3 * aDVegN3;
tDEnvMortVegHypN3 = tDEnvVegHypN3 - tDEnvProdVegHypN3;
tDMortVegHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE bkMortVegN3 * uDVegHypN3 + tDEnvMortVegHypN3 ENDIF;
tDMortVegWHypN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tDMortVegHypN3;
tDGrazVegBirdN3 = IF ( (sTimeN3 GE cYearStartBirdsN3 * DaysPerYearN3) AND (DayN3 GE cDayStartBirdsN3) AND (DayN3 LE cDayEndBirdsN3) ) THEN cPrefVegBirdN3 * aDVegN3 / (hDVegBirdN3 + aDVegN3) * cBirdsPerhaN3 / m2PerhaN3 * cDGrazPerBirdN3 ELSE 0.0 ENDIF;
bkManVegN3 = IF ((DayN3 GE cDayManVeg1N3 AND DayN3 LT cDayManVeg1N3 + cLengManN3) OR (DayN3 GE cDayManVeg2N3 AND DayN3 LT cDayManVeg2N3 + cLengManN3)) THEN -LN(1.0 - fManVegN3) / cLengManN3 ELSE 0.0 ENDIF;
tDManVegN3 = bkManVegN3 * aDVegN3;
tPManVegN3 = rPDVegN3 * tDManVegN3;
tNManVegN3 = rNDVegN3 * tDManVegN3;
tO2ProdVegHypN3 = molO2molCN3 * cCPerDWN3 * tDProdVegHypN3;
tO2RespVegWHypN3 = molO2molCN3 * cCPerDWN3 * bfSubVegHypN3 * tDRespVegN3 * aCorO2BODHypN3;
aDepthOxySedN3 = IF(aInclStratN3 EQ TRUE AND (2.0 * oO2WHypN3 * akO2DifCorN3 / tSODN3) GT NearZeroN3 ) THEN POW((2.0 * oO2WHypN3 * akO2DifCorN3 / tSODN3) , (0.5)) ELSEIF ( aInclStratN3 EQ TRUE AND (2.0 * oO2WHypN3 * akO2DifCorN3 / tSODN3) LE NearZeroN3 ) THEN POW ( NearZeroN3 , (0.5)) ELSEIF ( aInclStratN3 EQ TRUE AND ( 2.0 * oO2WEpiN3 * akO2DifCorN3 / tSODN3 ) LE NearZeroN3 ) THEN POW ( NearZeroN3 , (0.5)) ELSE POW ( ( 2.0 * oO2WEpiN3 * akO2DifCorN3 / tSODN3 ) , (0.5)) ENDIF;
afOxySedN3 = aDepthOxySedN3 / cDepthSN3;
tO2RespVegSN3 = molO2molCN3 * cCPerDWN3 * bfRootVegN3 * tDRespVegN3 * afOxySedN3;
tO2ProdVegSHypN3 = MIN (tO2RespVegSN3, tO2ProdVegHypN3);
tO2ProdVegWHypN3 = MIN( tO2ProdVegHypN3 - tO2ProdVegSHypN3, bfSubVegN3 * tO2ProdVegHypN3);
tO2UptNO3VegWHypN3 = O2PerNO3N3 * molO2molNN3 * bfSubVegN3 * tNUptNO3VegWHypN3;
tO2UptNO3VegSN3 = O2PerNO3N3 * molO2molNN3 * tNUptNO3VegSN3;
tPExcrVegN3 = (rPDVegN3 *2.0)/ (cPDVegMaxN3 + rPDVegN3) * rPDVegN3 * tDRespVegN3;
tPExcrVegSN3 = bfRootVegN3 * tPExcrVegN3;
tPExcrVegWN3 = tPExcrVegN3 - tPExcrVegSN3;
tPMortVegHypN3 = rPDVegN3 * tDMortVegHypN3;
tPMortVegPO4HypN3 = fDissMortVegN3 * tPMortVegHypN3;
tPMortVegPO4SHypN3 = bfRootVegN3 * tPMortVegPO4HypN3;
tPMortVegPO4WHypN3 = tPMortVegPO4HypN3 - tPMortVegPO4SHypN3;
tPMortVegDetHypN3 = tPMortVegHypN3 - tPMortVegPO4HypN3;
tPMortVegDetWHypN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tPMortVegDetHypN3;
tPMortVegDetSHypN3 = tPMortVegDetHypN3 - tPMortVegDetWHypN3;
tPGrazVegBirdN3 = rPDVegN3 * tDGrazVegBirdN3;
tNExcrVegN3 = (2.0 * rNDVegN3) / (cNDVegMaxN3 + rNDVegN3) * rNDVegN3 * tDRespVegN3;
tNExcrVegSN3 = bfRootVegN3 * tNExcrVegN3;
tNExcrVegWN3 = tNExcrVegN3 - tNExcrVegSN3;
tNMortVegHypN3 = rNDVegN3 * tDMortVegHypN3;
tNMortVegNH4HypN3 = fDissMortVegN3 * tNMortVegHypN3;
tNMortVegNH4SHypN3 = IF (aInclStratN3 EQ TRUE ) THEN bfRootVegN3 * tNMortVegNH4HypN3 ELSE 0.0 ENDIF;
tNMortVegNH4WHypN3 = tNMortVegNH4HypN3 - tNMortVegNH4SHypN3;
tNMortVegDetHypN3 = tNMortVegHypN3 - tNMortVegNH4HypN3;
tNMortVegDetWHypN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tNMortVegDetHypN3;
tNMortVegDetSHypN3 = tNMortVegDetHypN3 - tNMortVegDetWHypN3;
tNGrazVegBirdN3 = rNDVegN3 * tDGrazVegBirdN3;
tDAssVegBirdN3 = fDAssBirdN3 * tDGrazVegBirdN3;
tDEgesBirdN3 = tDGrazVegBirdN3 - tDAssVegBirdN3;
tPAssVegBirdN3 = fDAssBirdN3 * tPGrazVegBirdN3;
tPEgesBirdN3 = tPGrazVegBirdN3 - tPAssVegBirdN3;
tPEgesBirdPO4N3 = fDissEgesBirdN3 * tPEgesBirdN3;
tPEgesBirdDetN3 = tPEgesBirdN3 - tPEgesBirdPO4N3;
tNAssVegBirdN3 = fDAssBirdN3 * tNGrazVegBirdN3;
tNEgesBirdN3 = tNGrazVegBirdN3 - tNAssVegBirdN3;
tNEgesBirdNH4N3 = fDissEgesBirdN3 * tNEgesBirdN3;
tNEgesBirdDetN3 = tNEgesBirdN3 - tNEgesBirdNH4N3;
wDBedDetWHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE) THEN (tDMortVegWHypN3) / uDepthWHypN3 ELSE 0.0 ENDIF;
aMuTmLVegEpiN3 = ufDayN3 * bfShootVegN3 * aLLimShootVegEpiN3 * uFunTmProdVegN3 * cMuMaxVegN3;
akDIncrVegEpiN3 = aMuTmLVegEpiN3 - kDRespVegN3 * uFunTmRespVegN3 - bkMortVegN3;
tDEnvVegEpiN3 = MAX(0.0, akDIncrVegEpiN3 / (cDCarrVegN3+NearZeroN3) * aDVegN3*aDVegN3);
aMuVegEpiN3 = aMuTmLVegEpiN3 * aNutLimVegN3;
tDEnvProdVegEpiN3 = aMuVegEpiN3 / cMuMaxVegN3 * tDEnvVegEpiN3;
tDProdVegEpiN3 = MAX(0.0, aMuVegEpiN3 * uDVegEpiN3 - tDEnvProdVegEpiN3);
tDEnvMortVegEpiN3 = tDEnvVegEpiN3 - tDEnvProdVegEpiN3;
tDMortVegEpiN3 = bkMortVegN3 * uDVegEpiN3 + tDEnvMortVegEpiN3;
tNMortVegEpiN3 = rNDVegN3 * tDMortVegEpiN3;
tNMortVegNH4EpiN3 = fDissMortVegN3 * tNMortVegEpiN3;
tNMortVegNH4SEpiN3 = bfRootVegN3 * tNMortVegNH4EpiN3;
wPBedPO4WHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE ) THEN (- tPUptVegWHypN3 + tPExcrVegWN3 * uVegHeightHypN3 / uVegHeightN3 + tPMortVegPO4WHypN3 ) /uDepthWHypN3 ELSE 0.0 ENDIF;
wPBedDetWHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE) THEN (tPMortVegDetWHypN3 ) / uDepthWHypN3 ELSE 0.0 ENDIF;
wNBedNH4WHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE ) THEN (- tNUptNH4VegWHypN3 + tNExcrVegWN3 * (uVegHeightHypN3 /uVegHeightN3 ) + tNMortVegNH4WHypN3 ) / uDepthWHypN3 ELSE 0.0 ENDIF;
wNBedNO3WHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE) THEN - tNUptNO3VegWHypN3 / uDepthWHypN3 ELSE 0.0 ENDIF;
wNBedDetWHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE) THEN (tNMortVegDetWHypN3 ) / uDepthWHypN3 ELSE 0.0 ENDIF;
tDMortVegSHypN3 = tDMortVegHypN3 - tDMortVegWHypN3;
tDBedDetSHypN3 = IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE ) THEN tDMortVegSHypN3 ELSE 0.0 ENDIF;
tO2BedWHypN3 =IF (aInclStratN3 EQ TRUE AND InclVegN3 EQ TRUE ) THEN tO2ProdVegWHypN3 - tO2RespVegWHypN3 + tO2UptNO3VegWHypN3 ELSE 0.0 ENDIF;
UseLossN3 = IF (InclWebN3 EQ TRUE) THEN 0.0 ELSE 1.0 ENDIF;
uFunTmLossHypN3 = EXP(-0.5/(cSigTmLossN3*cSigTmLossN3) *((uTmHypN3-cTmOptLossN3)*(uTmHypN3-cTmOptLossN3) -(cTmRefN3-cTmOptLossN3)*(cTmRefN3-cTmOptLossN3)));
uFunTmLossEpiN3 = EXP(-0.5/(cSigTmLossN3*cSigTmLossN3) *((uTmEpiN3-cTmOptLossN3)*(uTmEpiN3-cTmOptLossN3) -(cTmRefN3-cTmOptLossN3)*(cTmRefN3-cTmOptLossN3)));
rPDBlueWHypN3 = oPBlueWHypN3 /(oDBlueWHypN3+NearZeroN3);
rNDBlueWHypN3 = oNBlueWHypN3 /(oDBlueWHypN3+NearZeroN3);
rPDBlueSN3 = aPBlueSN3 /(aDBlueSN3+NearZeroN3);
rNDBlueSN3 = aNBlueSN3 /(aDBlueSN3+NearZeroN3);
uFunTmBlueHypN3 = EXP(-0.5/(cSigTmBlueN3*cSigTmBlueN3) *((uTmHypN3-cTmOptBlueN3)*(uTmHypN3-cTmOptBlueN3) - (cTmRefN3-cTmOptBlueN3)*(cTmRefN3-cTmOptBlueN3)));
uFunTmProdBlueHypN3 = uFunTmBlueHypN3;
uFunTmRespBlueHypN3 = uFunTmBlueHypN3;
uFunTmBlueEpiN3 = EXP(-0.5/(cSigTmBlueN3*cSigTmBlueN3) *((uTmEpiN3-cTmOptBlueN3)*(uTmEpiN3-cTmOptBlueN3) - (cTmRefN3-cTmOptBlueN3)*(cTmRefN3-cTmOptBlueN3)));
uFunTmProdBlueEpiN3 = uFunTmBlueEpiN3;
uFunTmRespBlueEpiN3 = uFunTmBlueEpiN3;
uFunTmBlueSN3 = EXP(-0.5/(cSigTmBlueN3*cSigTmBlueN3) *((uTmBotN3-cTmOptBlueN3)*(uTmBotN3-cTmOptBlueN3) - (cTmRefN3-cTmOptBlueN3)*(cTmRefN3-cTmOptBlueN3)));
uFunTmRespBlueSN3 = uFunTmBlueSN3;
uFunTmBlueSurfN3 = EXP(-0.5/(cSigTmBlueN3*cSigTmBlueN3) *((uTmSurfN3-cTmOptBlueN3)*(uTmSurfN3-cTmOptBlueN3) - (cTmRefN3-cTmOptBlueN3)*(cTmRefN3-cTmOptBlueN3)));
uFunTmProdBlueSurfN3 = uFunTmBlueSurfN3;
uFunTmRespBlueSurfN3 = uFunTmBlueSurfN3;
aLPARAveSurfN3 = MAX(0.0,(uLPARSurfN3 - aLPARBotSurfN3)/aExtSurfN3);
aLPARAveEpiN3 = (aLPARBotSurfN3 - aLPARBotEpiN3)/ (aExtCoefOpenEpiN3 * uDepthWEpiN3);
aLPARAveHypN3 = (aLPARBotEpiOpenN3 -aLPARBotHypN3)/ (aExtCoefOpenHypN3 * uDepthWEpiN3);
aAuxNfixLSurfN3 = cAlphNfixN3 * aLPARAveSurfN3 ;
aAuxNfixLEpiN3 = cAlphNfixN3 * aLPARAveEpiN3;
aAuxNfixLHypN3 = cAlphNfixN3 * aLPARAveHypN3;
rNfixBlueSurfN3 = cNfixMaxBlueN3 - cNfixMaxBlueN3 * EXP(- aAuxNfixLSurfN3) + cNfixDarkBlueN3;
rNfixBlueEpiN3 = cNfixMaxBlueN3 - cNfixMaxBlueN3 * EXP(- aAuxNfixLEpiN3) + cNfixDarkBlueN3;
rNfixBlueHypN3 = cNfixMaxBlueN3 - cNfixMaxBlueN3 * EXP(- aAuxNfixLHypN3) + cNfixDarkBlueN3;
aVPUptMaxCrBlueHypN3 = MAX(0.0,cVPUptMaxBlueN3 * uFunTmProdBlueHypN3 *(cPDBlueMaxN3 - rPDBlueWHypN3) /(cPDBlueMaxN3 - cPDBlueMinN3));
aVPUptBlueHypN3 = oPO4WHypN3 * aVPUptMaxCrBlueHypN3 /(aVPUptMaxCrBlueHypN3 / cAffPUptBlueN3 + oPO4WHypN3);
wPUptBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVPUptBlueHypN3 * oDBlueWHypN3 ENDIF;
aVNUptMaxCrBlueHypN3 = MAX(0.0,cVNUptMaxBlueN3 * uFunTmProdBlueHypN3 * (cNDBlueMaxN3 - rNDBlueWHypN3) /(cNDBlueMaxN3 - cNDBlueMinN3));
ahNUptBlueHypN3 = aVNUptMaxCrBlueHypN3 / cAffNUptBlueN3;
aVNUptBlueHypN3 = oNDissWHypN3 * aVNUptMaxCrBlueHypN3 /(ahNUptBlueHypN3 + oNDissWHypN3);
wNUptBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVNUptBlueHypN3 * oDBlueWHypN3 ENDIF;
tNUptBlueHypN3 = wNUptBlueHypN3 * uDepthWHypN3;
afNH4UptBlueHypN3 = oNH4WHypN3 * oNO3WHypN3 /((ahNUptBlueHypN3 + oNH4WHypN3) *(ahNUptBlueHypN3 + oNO3WHypN3)) + oNH4WHypN3 * ahNUptBlueHypN3 /((oNH4WHypN3 + oNO3WHypN3) *(ahNUptBlueHypN3 + oNO3WHypN3));
uMuMaxTmBlueHypN3 = cMuMaxBlueN3 * uFunTmProdBlueHypN3;
uMuMaxTmBlueEpiN3 = cMuMaxBlueN3 * uFunTmProdBlueEpiN3;
aPLimBlueHypN3 = MAX(0.0,(1.0 - cPDBlueMinN3 / rPDBlueWHypN3) * cPDBlueMaxN3 /(cPDBlueMaxN3 - cPDBlueMinN3));
aNLimBlueHypN3 = MAX(0.0,(1.0 - cNDBlueMinN3 / rNDBlueWHypN3) * cNDBlueMaxN3 /(cNDBlueMaxN3 - cNDBlueMinN3));
aSiLimBlueHypN3 = oSiO2WHypN3 /(hSiAssBlueN3 + oSiO2WHypN3);
aLLimBlueHypN3 = UseSteeleBlueN3 *(EXP(1.0) /(aExtCoefHypN3 * uDepthWHypN3) *(EXP(- aLPARBotHypN3 /(cLOptRefBlueN3 * uFunTmProdBlueHypN3)) - EXP(- uLPARSurfHypN3 /(cLOptRefBlueN3 * uFunTmProdBlueHypN3)))) +(1.0 - UseSteeleBlueN3) *(1.0 /(aExtCoefHypN3 * uDepthWHypN3) * LN((1.0 + uLPARSurfHypN3 / (hLRefBlueN3 * uFunTmProdBlueHypN3)) / (1.0 + aLPARBotHypN3 /(hLRefBlueN3 * uFunTmProdBlueHypN3))));
aMuTmLBlueHypN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimBlueHypN3 * uMuMaxTmBlueHypN3;
aNutLimBlueHypN3 = MIN(aPLimBlueHypN3,(MIN(aNLimBlueHypN3,aSiLimBlueHypN3)));
aMuBlueHypN3 = aNutLimBlueHypN3 * aMuTmLBlueHypN3;
wDAssBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aMuBlueHypN3*oDBlueWHypN3 ENDIF;
rChDBlueHypN3 = cChDBlueMaxN3 -(cChDBlueMaxN3 - cChDBlueMinN3) * aLLimBlueHypN3;
oChlaBlueHypN3 = mgPergN3 * rChDBlueHypN3 * oDBlueWHypN3;
aChlaBlueHypN3 = mgPergN3 * rChDBlueHypN3 * aDBlueWHypN3;
aExtChBlueHypN3 = cExtSpBlueN3 / rChDBlueHypN3;
aNfixBlueHypN3  = rNfixBlueHypN3 *aChlaBlueHypN3 /ugPergN3;
tNUptBlueAirHypN3 = IF (InclNfixN3 EQ FALSE) THEN 0.0 ELSE aNfixBlueHypN3 ENDIF;
tNUptBlueWHypN3 = IF (InclNfixN3 EQ FALSE) THEN tNUptBlueHypN3 ELSE tNUptBlueHypN3 - tNUptBlueAirHypN3 ENDIF;
wNUptBlueWHypN3 = tNUptBlueWHypN3 / uDepthWHypN3;
ukDRespTmBlueHypN3 = kDRespBlueN3 * uFunTmRespBlueHypN3;
wNUptNH4BlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE afNH4UptBlueHypN3 * wNUptBlueWHypN3 ENDIF;
wNUptNO3BlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptBlueWHypN3 - wNUptNH4BlueHypN3 ENDIF;
ukDRespTmBlueEpiN3 = kDRespBlueN3 * uFunTmRespBlueEpiN3;
ukDRespTmBlueSN3 = kDRespBlueN3 * uFunTmRespBlueSN3;
wDRespBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukDRespTmBlueHypN3 * oDBlueWHypN3 ENDIF;
ukDRespTmBlueSurfN3 = kDRespBlueN3 * uFunTmRespBlueSurfN3;
ukLossTmBlueHypN3 = UseLossN3 * kLossBlueN3 * uFunTmLossHypN3;
ukLossTmBlueEpiN3 = UseLossN3 * kLossBlueN3 * uFunTmLossEpiN3;
wDLossBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukLossTmBlueHypN3 * oDBlueWHypN3 ENDIF;
wDMortBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortBlueWN3 * oDBlueWHypN3 ENDIF;
uCorVSetBlueHypN3 = (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMHypN3 * uFunTmSetHypN3;
tDResusBlueN3 = aDBlueSN3 /(aDPhytSN3+NearZeroN3) * tDResusPhytTotN3;
tDRespBlueSN3 = ukDRespTmBlueSN3 * aDBlueSN3;
tDMortBlueSN3 = kMortBlueSN3 * aDBlueSN3;
ukDDecBlueHypN3 = ukDRespTmBlueHypN3 + ukLossTmBlueHypN3 + kMortBlueWN3 +(uCorVSetBlueHypN3 * uFunTmSetHypN3) / uDepthWHypN3;
wPExcrBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (rPDBlueWHypN3 * 2.0 )/(cPDBlueMaxN3 + rPDBlueWHypN3) * rPDBlueWHypN3 * wDRespBlueWHypN3 ENDIF;
wPLossBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN3 * wDLossBlueHypN3 ENDIF;
wPMortBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortBlueWN3 * oPBlueWHypN3 ENDIF;
tPResusBlueN3 = rPDBlueSN3 * tDResusBlueN3;
tPExcrBlueSN3 = (rPDBlueSN3 *2.0)/(cPDBlueMaxN3 + rPDBlueSN3) * rPDBlueSN3 * tDRespBlueSN3;
tPMortBlueSN3 = kMortBlueSN3 * aPBlueSN3;
wNExcrBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (rNDBlueWHypN3 *2.0)/(cNDBlueMaxN3 + rNDBlueWHypN3) * rNDBlueWHypN3 * wDRespBlueWHypN3 ENDIF;
wNLossBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN3 * wDLossBlueHypN3 ENDIF;
wNMortBlueWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortBlueWN3 * oNBlueWHypN3 ENDIF;
tNResusBlueN3 = rNDBlueSN3 * tDResusBlueN3;
tNExcrBlueSN3 = (2.0 * rNDBlueSN3) /(cNDBlueMaxN3 + rNDBlueSN3) * rNDBlueSN3 * tDRespBlueSN3;
tNMortBlueSN3 = kMortBlueSN3 * aNBlueSN3;
aFunTauSetOMEpiN3 = MIN(1.0 / POW(aFunDimSuspN3 +NearZeroN3 , (0.5)), 1.0);
aFunTauSetIMEpiN3 = aFunTauSetOMEpiN3;
uCorVSetBlueEpiN3 = (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMEpiN3 * uFunTmSetEpiN3;
rNDGrenWHypN3 = oNGrenWHypN3 /(oDGrenWHypN3+NearZeroN3);
rPDGrenSN3 = aPGrenSN3 /(aDGrenSN3+NearZeroN3);
rNDGrenSN3 = aNGrenSN3 /(aDGrenSN3+NearZeroN3);
uFunTmGrenHypN3 = EXP(-0.5/(cSigTmGrenN3*cSigTmGrenN3) *((uTmHypN3-cTmOptGrenN3)*(uTmHypN3-cTmOptGrenN3) - (cTmRefN3-cTmOptGrenN3)*(cTmRefN3-cTmOptGrenN3)));
uFunTmGrenEpiN3 = EXP(-0.5/(cSigTmGrenN3*cSigTmGrenN3) *((uTmEpiN3-cTmOptGrenN3)*(uTmEpiN3-cTmOptGrenN3) - (cTmRefN3-cTmOptGrenN3)*(cTmRefN3-cTmOptGrenN3)));
uFunTmGrenSN3 = EXP(-0.5/(cSigTmGrenN3*cSigTmGrenN3) *((uTmBotN3-cTmOptGrenN3)*(uTmBotN3-cTmOptGrenN3) - (cTmRefN3-cTmOptGrenN3)*(cTmRefN3-cTmOptGrenN3)));
uFunTmProdGrenHypN3 = uFunTmGrenHypN3;
uFunTmRespGrenHypN3 = uFunTmGrenHypN3;
uFunTmProdGrenEpiN3 = uFunTmGrenEpiN3;
uFunTmRespGrenEpiN3 = uFunTmGrenEpiN3;
uFunTmRespGrenSN3 = uFunTmGrenSN3;
aVNUptMaxCrGrenHypN3 = MAX(0.0,cVNUptMaxGrenN3 * uFunTmProdGrenHypN3 * (cNDGrenMaxN3 - rNDGrenWHypN3) /(cNDGrenMaxN3 - cNDGrenMinN3));
ahNUptGrenHypN3 = aVNUptMaxCrGrenHypN3 / cAffNUptGrenN3;
aVNUptGrenHypN3 = oNDissWHypN3 * aVNUptMaxCrGrenHypN3 /(ahNUptGrenHypN3 + oNDissWHypN3);
wNUptGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVNUptGrenHypN3 * oDGrenWHypN3 ENDIF;
afNH4UptGrenHypN3 = oNH4WHypN3 * oNO3WHypN3 /((ahNUptGrenHypN3 + oNH4WHypN3) *(ahNUptGrenHypN3 + oNO3WHypN3)) + oNH4WHypN3 * ahNUptGrenHypN3 /((oNH4WHypN3 + oNO3WHypN3) *(ahNUptGrenHypN3 + oNO3WHypN3));
wNUptNH4GrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE afNH4UptGrenHypN3 * wNUptGrenHypN3 ENDIF;
wNUptNO3GrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN3 - wNUptNH4GrenHypN3 ENDIF;
uMuMaxTmGrenHypN3 = cMuMaxGrenN3 * uFunTmProdGrenHypN3;
uMuMaxTmGrenEpiN3 = cMuMaxGrenN3 * uFunTmProdGrenEpiN3;
aNLimGrenHypN3 = MAX(0.0,(1.0 - cNDGrenMinN3 / rNDGrenWHypN3) * cNDGrenMaxN3 /(cNDGrenMaxN3 - cNDGrenMinN3));
aSiLimGrenHypN3 = oSiO2WHypN3 /(hSiAssGrenN3 + oSiO2WHypN3);
aLLimGrenHypN3 = UseSteeleGrenN3 *(EXP(1.0) /(aExtCoefHypN3 * uDepthWHypN3) *(EXP(- aLPARBotHypN3 /(cLOptRefGrenN3 * uFunTmProdGrenHypN3)) - EXP(- uLPARSurfHypN3 /(cLOptRefGrenN3 * uFunTmProdGrenHypN3)))) +(1.0 - UseSteeleGrenN3) *(1.0 /(aExtCoefHypN3 * uDepthWHypN3) * LN((1.0 + uLPARSurfHypN3 / (hLRefGrenN3 * uFunTmProdGrenHypN3)) / (1.0 + aLPARBotHypN3 /(hLRefGrenN3 * uFunTmProdGrenHypN3))));
aMuTmLGrenHypN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimGrenHypN3 * uMuMaxTmGrenHypN3;
rChDGrenHypN3 = cChDGrenMaxN3 -(cChDGrenMaxN3 - cChDGrenMinN3) * aLLimGrenHypN3;
oChlaGrenHypN3 = mgPergN3 * rChDGrenHypN3 * oDGrenWHypN3;
aExtChGrenHypN3 = cExtSpGrenN3 / rChDGrenHypN3;
ukDRespTmGrenHypN3 = kDRespGrenN3 * uFunTmRespGrenHypN3;
ukDRespTmGrenEpiN3 = kDRespGrenN3 * uFunTmRespGrenEpiN3;
ukDRespTmGrenSN3 = kDRespGrenN3 * uFunTmRespGrenSN3;
wDRespGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukDRespTmGrenHypN3 * oDGrenWHypN3 ENDIF;
ukLossTmGrenHypN3 = UseLossN3 * kLossGrenN3 * uFunTmLossHypN3;
ukLossTmGrenEpiN3 = UseLossN3 * kLossGrenN3 * uFunTmLossEpiN3;
wDLossGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukLossTmGrenHypN3 * oDGrenWHypN3 ENDIF;
wDMortGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortGrenWN3 * oDGrenWHypN3 ENDIF;
uCorVSetGrenHypN3 = (cVSetGrenN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMHypN3 * uFunTmSetHypN3;
tDSetGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE uCorVSetGrenHypN3 * oDGrenWHypN3 ENDIF;
tDResusGrenN3 = aDGrenSN3 /(aDPhytSN3+NearZeroN3) * tDResusPhytTotN3;
tDRespGrenSN3 = ukDRespTmGrenSN3 * aDGrenSN3;
tDMortGrenSN3 = kMortGrenSN3 * aDGrenSN3;
ukDDecGrenHypN3 = ukDRespTmGrenHypN3 + ukLossTmGrenHypN3 + kMortGrenWN3 +(uCorVSetGrenHypN3 * uFunTmSetHypN3) / uDepthWHypN3;
wPMortGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortGrenWN3 * oPGrenWHypN3 ENDIF;
tPResusGrenN3 = rPDGrenSN3 * tDResusGrenN3;
tPExcrGrenSN3 = (2.0 * rPDGrenSN3) /(cPDGrenMaxN3 + rPDGrenSN3) * rPDGrenSN3 * tDRespGrenSN3;
tPMortGrenSN3 = kMortGrenSN3 * aPGrenSN3;
wNExcrGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDGrenWHypN3) /(cNDGrenMaxN3 + rNDGrenWHypN3) * rNDGrenWHypN3 * wDRespGrenWHypN3 ENDIF;
wNLossGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN3 * wDLossGrenHypN3 ENDIF;
wNMortGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortGrenWN3 * oNGrenWHypN3 ENDIF;
tNSetGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN3 * tDSetGrenHypN3 ENDIF;
tNResusGrenN3 = rNDGrenSN3 * tDResusGrenN3;
tNExcrGrenSN3 = (2.0 * rNDGrenSN3) /(cNDGrenMaxN3 + rNDGrenSN3) * rNDGrenSN3 * tDRespGrenSN3;
tNMortGrenSN3 = kMortGrenSN3 * aNGrenSN3;
uCorVSetGrenEpiN3 = (cVSetGrenN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMEpiN3 * uFunTmSetEpiN3;
tDSetGrenEpiN3 = uCorVSetGrenEpiN3 * oDGrenWEpiN3;
rNDGrenWEpiN3 = oNGrenWEpiN3 /(oDGrenWEpiN3+NearZeroN3);
tNSetGrenEpiN3 = rNDGrenWEpiN3 * tDSetGrenEpiN3;
rPDGrenWEpiN3 = oPGrenWEpiN3 /(oDGrenWEpiN3+NearZeroN3);
tPSetGrenEpiN3 = rPDGrenWEpiN3 * tDSetGrenEpiN3;
wNPrimGrenWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN3 - wNExcrGrenWHypN3 - wNLossGrenHypN3 - wNMortGrenWHypN3 -(tNSetGrenHypN3 -tNSetGrenEpiN3 - tNResusGrenN3) / uDepthWHypN3 ENDIF;
rPDDiatWHypN3 = oPDiatWHypN3 /(oDDiatWHypN3+NearZeroN3);
rNDDiatWHypN3 = oNDiatWHypN3 /(oDDiatWHypN3+NearZeroN3);
rPDDiatSN3 = aPDiatSN3 /(aDDiatSN3+NearZeroN3);
uFunTmDiatHypN3 = EXP(-0.5/(cSigTmDiatN3*cSigTmDiatN3) *((uTmHypN3-cTmOptDiatN3)*(uTmHypN3-cTmOptDiatN3) - (cTmRefN3-cTmOptDiatN3)*(cTmRefN3-cTmOptDiatN3)));
rNDDiatSN3 = aNDiatSN3 /(aDDiatSN3+NearZeroN3);
uFunTmDiatEpiN3 = EXP(-0.5/(cSigTmDiatN3*cSigTmDiatN3) *((uTmEpiN3-cTmOptDiatN3)*(uTmEpiN3-cTmOptDiatN3) - (cTmRefN3-cTmOptDiatN3)*(cTmRefN3-cTmOptDiatN3)));
uFunTmDiatSN3 = EXP(-0.5/(cSigTmDiatN3*cSigTmDiatN3) *((uTmBotN3-cTmOptDiatN3)*(uTmBotN3-cTmOptDiatN3) - (cTmRefN3-cTmOptDiatN3)*(cTmRefN3-cTmOptDiatN3)));
uFunTmProdDiatHypN3 = uFunTmDiatHypN3;
uFunTmRespDiatHypN3 = uFunTmDiatHypN3;
uFunTmProdDiatEpiN3 = uFunTmDiatEpiN3;
uFunTmRespDiatEpiN3 = uFunTmDiatEpiN3;
uFunTmRespDiatSN3 = uFunTmDiatSN3;
aVPUptMaxCrDiatHypN3 = MAX(0.0,cVPUptMaxDiatN3 * uFunTmProdDiatHypN3 *(cPDDiatMaxN3 - rPDDiatWHypN3) /(cPDDiatMaxN3 - cPDDiatMinN3));
aVPUptDiatHypN3 = oPO4WHypN3 * aVPUptMaxCrDiatHypN3 /(aVPUptMaxCrDiatHypN3 / cAffPUptDiatN3 + oPO4WHypN3);
wPUptDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVPUptDiatHypN3 * oDDiatWHypN3 ENDIF;
aVNUptMaxCrDiatHypN3 = MAX(0.0,cVNUptMaxDiatN3 * uFunTmProdDiatHypN3 * (cNDDiatMaxN3 - rNDDiatWHypN3) /(cNDDiatMaxN3 - cNDDiatMinN3));
ahNUptDiatHypN3 = aVNUptMaxCrDiatHypN3 / cAffNUptDiatN3;
aVNUptDiatHypN3 = oNDissWHypN3 * aVNUptMaxCrDiatHypN3 /(ahNUptDiatHypN3 + oNDissWHypN3);
wNUptDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVNUptDiatHypN3 * oDDiatWHypN3 ENDIF;
afNH4UptDiatHypN3 = oNH4WHypN3 * oNO3WHypN3 /((ahNUptDiatHypN3 + oNH4WHypN3) *(ahNUptDiatHypN3 + oNO3WHypN3)) + oNH4WHypN3 * ahNUptDiatHypN3 /((oNH4WHypN3 + oNO3WHypN3) *(ahNUptDiatHypN3 + oNO3WHypN3));
wNUptNH4DiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE afNH4UptDiatHypN3 * wNUptDiatHypN3 ENDIF;
wNUptNO3DiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN3 - wNUptNH4DiatHypN3 ENDIF;
uMuMaxTmDiatHypN3 = cMuMaxDiatN3 * uFunTmProdDiatHypN3;
uMuMaxTmDiatEpiN3 = cMuMaxDiatN3 * uFunTmProdDiatEpiN3;
aPLimDiatHypN3 = MAX(0.0,(1.0 - cPDDiatMinN3 / rPDDiatWHypN3) * cPDDiatMaxN3 /(cPDDiatMaxN3 - cPDDiatMinN3));
aNLimDiatHypN3 = MAX(0.0,(1.0 - cNDDiatMinN3 / rNDDiatWHypN3) * cNDDiatMaxN3 /(cNDDiatMaxN3 - cNDDiatMinN3));
aSiLimDiatHypN3 = oSiO2WHypN3 /(hSiAssDiatN3 + oSiO2WHypN3);
aLLimDiatHypN3 = UseSteeleDiatN3 *(EXP(1.0) /(aExtCoefHypN3 * uDepthWHypN3) *(EXP(- aLPARBotHypN3 /(cLOptRefDiatN3 * uFunTmProdDiatHypN3)) - EXP(- uLPARSurfHypN3 /(cLOptRefDiatN3 * uFunTmProdDiatHypN3)))) +(1.0 - UseSteeleDiatN3) *(1.0 /(aExtCoefHypN3 * uDepthWHypN3) * LN((1.0 + uLPARSurfHypN3 / (hLRefDiatN3 * uFunTmProdDiatHypN3)) / (1.0 + aLPARBotHypN3 /(hLRefDiatN3 * uFunTmProdDiatHypN3))));
aMuTmLDiatHypN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimDiatHypN3 * uMuMaxTmDiatHypN3;
aNutLimDiatHypN3 = MIN(aPLimDiatHypN3,(MIN(aNLimDiatHypN3,aSiLimDiatHypN3)));
aMuDiatHypN3 = aNutLimDiatHypN3 * aMuTmLDiatHypN3;
wDAssDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aMuDiatHypN3*oDDiatWHypN3 ENDIF;
rChDDiatHypN3 = cChDDiatMaxN3 -(cChDDiatMaxN3 - cChDDiatMinN3) * aLLimDiatHypN3;
oChlaDiatHypN3 = mgPergN3 * rChDDiatHypN3 * oDDiatWHypN3;
aExtChDiatHypN3 = cExtSpDiatN3 / rChDDiatHypN3;
ukDRespTmDiatHypN3 = kDRespDiatN3 * uFunTmRespDiatHypN3;
ukDRespTmDiatEpiN3 = kDRespDiatN3 * uFunTmRespDiatEpiN3;
ukDRespTmDiatSN3 = kDRespDiatN3 * uFunTmRespDiatSN3;
wDRespDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukDRespTmDiatHypN3 * oDDiatWHypN3 ENDIF;
ukLossTmDiatHypN3 = UseLossN3 * kLossDiatN3 * uFunTmLossHypN3;
ukLossTmDiatEpiN3 = UseLossN3 * kLossDiatN3 * uFunTmLossEpiN3;
wDLossDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE ukLossTmDiatHypN3 * oDDiatWHypN3 ENDIF;
wDMortDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortDiatWN3 * oDDiatWHypN3 ENDIF;
uCorVSetDiatHypN3 = (cVSetDiatN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMHypN3 * uFunTmSetHypN3;
tDSetDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE uCorVSetDiatHypN3 * oDDiatWHypN3 ENDIF;
tDResusDiatN3 = aDDiatSN3 /(aDPhytSN3+NearZeroN3) * tDResusPhytTotN3;
tDRespDiatSN3 = ukDRespTmDiatSN3 * aDDiatSN3;
tDMortDiatSN3 = kMortDiatSN3 * aDDiatSN3;
ukDDecDiatHypN3 = ukDRespTmDiatHypN3 + ukLossTmDiatHypN3 + kMortDiatWN3 +(uCorVSetDiatHypN3 * uFunTmSetHypN3) / uDepthWHypN3;
wPExcrDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (2.0 * rPDDiatWHypN3) /(cPDDiatMaxN3 + rPDDiatWHypN3) * rPDDiatWHypN3 * wDRespDiatWHypN3 ENDIF;
wPLossDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN3 * wDLossDiatHypN3 ENDIF;
wPMortDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortDiatWN3 * oPDiatWHypN3 ENDIF;
tPSetDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN3 * tDSetDiatHypN3 ENDIF;
tPResusDiatN3 = rPDDiatSN3 * tDResusDiatN3;
tPExcrDiatSN3 = (2.0 * rPDDiatSN3) /(cPDDiatMaxN3 + rPDDiatSN3) * rPDDiatSN3 * tDRespDiatSN3;
tPMortDiatSN3 = kMortDiatSN3 * aPDiatSN3;
wNExcrDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDDiatWHypN3) /(cNDDiatMaxN3 + rNDDiatWHypN3) * rNDDiatWHypN3 * wDRespDiatWHypN3 ENDIF;
wNLossDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN3 * wDLossDiatHypN3 ENDIF;
wNMortDiatWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortDiatWN3 * oNDiatWHypN3 ENDIF;
tNSetDiatHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN3 * tDSetDiatHypN3 ENDIF;
tNResusDiatN3 = rNDDiatSN3 * tDResusDiatN3;
tNExcrDiatSN3 = (2.0 * rNDDiatSN3) /(cNDDiatMaxN3 + rNDDiatSN3) * rNDDiatSN3 * tDRespDiatSN3;
tNMortDiatSN3 = kMortDiatSN3 * aNDiatSN3;
uCorVSetDiatEpiN3 = (cVSetDiatN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3)  * aFunTauSetOMEpiN3 * uFunTmSetEpiN3;
tDSetDiatEpiN3 = uCorVSetDiatEpiN3 * oDDiatWEpiN3;
rPDDiatWEpiN3 = oPDiatWEpiN3 /(oDDiatWEpiN3+NearZeroN3);
tPSetDiatEpiN3 = rPDDiatWEpiN3 * tDSetDiatEpiN3;
rNDDiatWEpiN3 = oNDiatWEpiN3 /(oDDiatWEpiN3+NearZeroN3);
tNSetDiatEpiN3 = rNDDiatWEpiN3 * tDSetDiatEpiN3;
wDPrimDiatWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wDAssDiatHypN3 - wDRespDiatWHypN3 - wDLossDiatHypN3 - wDMortDiatWHypN3 -(tDSetDiatHypN3 - tDSetDiatEpiN3 - tDResusDiatN3) / uDepthWHypN3 ENDIF;
wPPrimDiatWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wPUptDiatHypN3 - wPExcrDiatWHypN3 - wPLossDiatHypN3 - wPMortDiatWHypN3 -(tPSetDiatHypN3 -tPSetDiatEpiN3 - tPResusDiatN3) / uDepthWHypN3 ENDIF;
wNPrimDiatWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN3 - wNExcrDiatWHypN3 - wNLossDiatHypN3 - wNMortDiatWHypN3 -(tNSetDiatHypN3 - tNSetDiatEpiN3 - tNResusDiatN3) / uDepthWHypN3 ENDIF;
oChlaHypN3 = oChlaDiatHypN3 + oChlaGrenHypN3 + oChlaBlueHypN3;
wDRespPhytWHypN3 = wDRespDiatWHypN3 + wDRespGrenWHypN3 + wDRespBlueWHypN3;
wDMortPhytWHypN3 = wDMortDiatWHypN3 + wDMortGrenWHypN3 + wDMortBlueWHypN3;
wDLossPhytHypN3 = wDLossDiatHypN3 + wDLossGrenHypN3 + wDLossBlueHypN3;
wPMortPhytWHypN3 = wPMortDiatWHypN3 + wPMortGrenWHypN3 + wPMortBlueWHypN3;
tPResusPhytN3 = tPResusDiatN3 + tPResusGrenN3 + tPResusBlueN3;
wNUptPhytHypN3 = wNUptDiatHypN3 + wNUptGrenHypN3 + wNUptBlueHypN3;
wNUptNH4PhytHypN3 = wNUptNH4DiatHypN3 + wNUptNH4GrenHypN3 + wNUptNH4BlueHypN3;
wNUptNO3PhytHypN3 = wNUptNO3DiatHypN3 + wNUptNO3GrenHypN3 + wNUptNO3BlueHypN3;
wNExcrPhytWHypN3 = wNExcrDiatWHypN3 + wNExcrGrenWHypN3 + wNExcrBlueWHypN3;
wNMortPhytWHypN3 = wNMortDiatWHypN3 + wNMortGrenWHypN3 + wNMortBlueWHypN3;
tNResusPhytN3 = tNResusDiatN3 + tNResusGrenN3 + tNResusBlueN3;
wNLossPhytHypN3 = wNLossDiatHypN3 + wNLossGrenHypN3 + wNLossBlueHypN3;
tDRespPhytSN3 = tDRespDiatSN3 + tDRespGrenSN3 + tDRespBlueSN3;
tDMortPhytSN3 = tDMortDiatSN3 + tDMortGrenSN3 + tDMortBlueSN3;
tPExcrPhytSN3 = tPExcrDiatSN3 + tPExcrGrenSN3 + tPExcrBlueSN3;
tPMortPhytSN3 = tPMortDiatSN3 + tPMortGrenSN3 + tPMortBlueSN3;
tNExcrPhytSN3 = tNExcrDiatSN3 + tNExcrGrenSN3 + tNExcrBlueSN3;
tNMortPhytSN3 = tNMortDiatSN3 + tNMortGrenSN3 + tNMortBlueSN3;
wSiUptDiatHypN3 = cSiDDiatN3 * wDAssDiatHypN3;
wSiExcrDiatWHypN3 = cSiDDiatN3 * wDRespDiatWHypN3 ;
wSiLossDiatHypN3 = cSiDDiatN3 * wDLossDiatHypN3;
wSiMortDiatWHypN3 = cSiDDiatN3 * wDMortDiatWHypN3;
tSiSetDiatHypN3 = cSiDDiatN3 * tDSetDiatHypN3;
tSiResusDiatN3 = cSiDDiatN3 * tDResusDiatN3 ;
rCyDBlueHypN3 = cCyDBlueMaxN3 -(cCyDBlueMaxN3 - cCyDBlueMinN3) * aLLimBlueHypN3;
oCyanHypN3 = rCyDBlueHypN3 * oDBlueWHypN3 * mgPergN3;
fDDiatHypN3 = oDDiatWHypN3 /(oDDiatWHypN3 + oDGrenWHypN3 + oDBlueWHypN3 + NearZeroN3);
wDPrimDetWHypN3 = wDMortPhytWHypN3 + wDLossPhytHypN3;
wO2RespPhytWHypN3 = molO2molCN3 * cCPerDWN3 * wDRespPhytWHypN3 * aCorO2BODHypN3;
wO2UptNO3PhytHypN3 = O2PerNO3N3 * molO2molNN3 * wNUptNO3PhytHypN3;
wPMortPhytPO4WHypN3 = fDissMortPhytN3 * wPMortPhytWHypN3;
wPMortPhytDetWHypN3 = wPMortPhytWHypN3 - wPMortPhytPO4WHypN3;
tPMortPhytPO4SN3 = fDissMortPhytN3 * tPMortPhytSN3;
tPMortPhytDetSN3 = tPMortPhytSN3 - tPMortPhytPO4SN3;
tPPrimPO4SN3 = tPExcrPhytSN3 + tPMortPhytPO4SN3;
tPPrimTotTN3 = 0.0;
wNMortPhytNH4WHypN3 = fDissMortPhytN3 * wNMortPhytWHypN3;
wNMortPhytDetWHypN3 = wNMortPhytWHypN3 - wNMortPhytNH4WHypN3;
wNLossPhytNH4HypN3 = fDissLossN3 * wNLossPhytHypN3;
wNLossPhytDetHypN3 = wNLossPhytHypN3 - wNLossPhytNH4HypN3;
wNPrimNH4WHypN3 = - wNUptNH4PhytHypN3 + wNExcrPhytWHypN3 + wNLossPhytNH4HypN3 + wNMortPhytNH4WHypN3;
wNPrimNO3WHypN3 = - wNUptNO3PhytHypN3;
wNPrimDetWHypN3 = wNLossPhytDetHypN3 + wNMortPhytDetWHypN3;
tNMortPhytNH4SN3 = fDissMortPhytN3 * tNMortPhytSN3;
tNMortPhytDetSN3 = tNMortPhytSN3 - tNMortPhytNH4SN3;
tNPrimNH4SN3 = tNExcrPhytSN3 + tNMortPhytNH4SN3;
tNPrimNO3SN3 = 0.0;
tNPrimTotTN3 = 0.0;
tSiExcrDiatSN3 = cSiDDiatN3 * tDRespDiatSN3 ;
tSiMortDiatSN3 = cSiDDiatN3 * tDMortDiatSN3;
wSiPrimSiO2WHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wSiExcrDiatWHypN3 - wSiUptDiatHypN3 + tSiExcrDiatSN3 / uDepthWHypN3 ENDIF;
wSiPrimDetWHypN3 = wSiMortDiatWHypN3 + wSiLossDiatHypN3;
tSiPrimTotTN3 = 0.0;
aPACoefEpiN3 = cPACoefMinN3 +(cPACoefMaxN3 - cPACoefMinN3) * hPACoefN3 / (hPACoefN3 + oDOMWEpiN3);
aPACoefHypN3 = cPACoefMinN3 +(cPACoefMaxN3 - cPACoefMinN3) * hPACoefN3 / (hPACoefN3 + oDOMWHypN3);
bSecchiMaxEpiN3 = uDepthWEpiN3;
aSecchiEpiN3 = MIN(bSecchiMaxEpiN3,aPACoefEpiN3 / aExtCoefOpenEpiN3);
aTransparencyEpiN3 = aSecchiEpiN3 / uDepthWEpiN3;
bSecchiMaxHypN3 = uDepthWHypN3 + cSecchiPlusN3;
aSecchiHypN3 = IF ( aInclStratN3 EQ TRUE AND uDepthWEpiN3 LE aPACoefEpiN3 / aExtCoefOpenEpiN3 ) THEN MIN(bSecchiMaxHypN3,aPACoefHypN3 / aExtCoefOpenHypN3 - aSecchiEpiN3) ELSEIF ( aInclStratN3 EQ TRUE AND uDepthWEpiN3 GT aPACoefEpiN3 / aExtCoefOpenEpiN3) THEN 0.0 ELSE MIN(bSecchiMaxHypN3,aPACoefHypN3 / aExtCoefOpenHypN3) ENDIF;
aSecchiTN3 = IF ( aInclStratN3 EQ TRUE ) THEN aSecchiEpiN3 +aSecchiHypN3 ELSE aSecchiEpiN3 ENDIF;
aTransparencyHypN3 = aSecchiHypN3 / uDepthWHypN3;
aTransparencyTN3 = IF ( aInclStratN3 EQ TRUE ) THEN aSecchiTN3 / uDepthWN3 ELSE aSecchiTN3 / uDepthWHypN3 ENDIF;
aDepthEuphHypN3 = cEuphN3 * aSecchiHypN3;
aRelDepthEuphHypN3 = aDepthEuphHypN3 / uDepthWHypN3;
aChlaHHypN3 = oChlaHypN3 * uDepthWHypN3;
aCovPhytWHypN3 = cCovSpPhytN3 *(oDPhytWHypN3 * uDepthWHypN3);
rExtChPhytHypN3 = aExtPhytHypN3 /(oChlaHypN3 / mgPergN3 + NearZeroN3);
uFunTmZooHypN3 = EXP(-0.5/(cSigTmZooN3*cSigTmZooN3) *((uTmHypN3-cTmOptZooN3)*(uTmHypN3-cTmOptZooN3) -(cTmRefN3-cTmOptZooN3)*(cTmRefN3-cTmOptZooN3)));
uFunTmZooEpiN3 = EXP(-0.5/(cSigTmZooN3*cSigTmZooN3) *((uTmEpiN3-cTmOptZooN3)*(uTmEpiN3-cTmOptZooN3) -(cTmRefN3-cTmOptZooN3)*(cTmRefN3-cTmOptZooN3)));
rPDZooHypN3 = oPZooHypN3 /(oDZooHypN3+NearZeroN3);
rNDZooHypN3 = oNZooHypN3/(oDZooHypN3+NearZeroN3);
oDFoodZooHypN3 = cPrefDiatN3 * oDDiatWHypN3 + cPrefGrenN3 * oDGrenWHypN3 + cPrefBlueN3 * oDBlueWHypN3 + cPrefDetN3 * oDDetWHypN3;
aFiltHypN3 = cFiltMaxN3 * uFunTmZooHypN3 * hFiltN3 /(hFiltN3 + oDOMWHypN3);
ukDAssTmZooHypN3 = fDAssZooN3 * cFiltMaxN3 * uFunTmZooHypN3 * hFiltN3;
ukDAssTmZooEpiN3 = fDAssZooN3 * cFiltMaxN3 * uFunTmZooEpiN3 * hFiltN3;
aDSatZooHypN3 = oDFoodZooHypN3 /(hFiltN3 + oDOMWHypN3);
ukDRespTmZooHypN3 = kDRespZooN3 * uFunTmZooHypN3;
ukDRespTmZooEpiN3 = kDRespZooN3 * uFunTmZooEpiN3;
ukDIncrZooHypN3 = ukDAssTmZooHypN3 - ukDRespTmZooHypN3 - kMortZooN3;
ukDIncrZooEpiN3 = ukDAssTmZooEpiN3 - ukDRespTmZooEpiN3 - kMortZooN3;
wDEnvZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE MAX(0.0,ukDIncrZooHypN3 / cDCarrZooN3 * oDZooHypN3*oDZooHypN3) ENDIF;
wDAssZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aDSatZooHypN3 *(ukDAssTmZooHypN3 * oDZooHypN3 - wDEnvZooHypN3) ENDIF;
wDConsZooHypN3 = wDAssZooHypN3 / fDAssZooN3;
wDConsDetZooHypN3 = cPrefDetN3*oDDetWHypN3 / oDFoodZooHypN3 * wDConsZooHypN3;
wDConsDiatZooHypN3 = cPrefDiatN3*oDDiatWHypN3 / oDFoodZooHypN3 * wDConsZooHypN3;
wDConsGrenZooHypN3 = cPrefGrenN3*oDGrenWHypN3 / oDFoodZooHypN3 * wDConsZooHypN3;
wDConsBlueZooHypN3 = cPrefBlueN3*oDBlueWHypN3 / oDFoodZooHypN3 * wDConsZooHypN3;
wDConsPhytZooHypN3 = wDConsDiatZooHypN3 + wDConsGrenZooHypN3 + wDConsBlueZooHypN3;
wDEgesZooHypN3 = wDConsZooHypN3 - wDAssZooHypN3;
aCorDRespZooHypN3 = MAX(cPDZooRefN3 / rPDZooHypN3,cNDZooRefN3 / rNDZooHypN3);
wDRespZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aCorDRespZooHypN3 * ukDRespTmZooHypN3 * oDZooHypN3 ENDIF;
wDMortZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kMortZooN3 * oDZooHypN3 +(1.0 - aDSatZooHypN3) * wDEnvZooHypN3 ENDIF;
oPFoodZooHypN3 = cPrefDiatN3*oPDiatWHypN3 + cPrefGrenN3*oPGrenWHypN3 + cPrefBlueN3*oPBlueWHypN3 + cPrefDetN3 * oPDetWHypN3;
rPDFoodZooHypN3 = oPFoodZooHypN3 /(oDFoodZooHypN3+NearZeroN3);
wPConsDiatZooHypN3 = rPDDiatWHypN3 * wDConsDiatZooHypN3;
wPConsBlueZooHypN3 = rPDBlueWHypN3 * wDConsBlueZooHypN3;
wPConsDetZooHypN3 = rPDDetWHypN3 * wDConsDetZooHypN3;
afPAssZooHypN3 = MIN(1.0,cPDZooRefN3 / rPDFoodZooHypN3 * fDAssZooN3);
akPExcrZooHypN3 = rPDZooHypN3 / cPDZooRefN3 * kDRespZooN3 * uFunTmZooHypN3;
wPExcrZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE akPExcrZooHypN3*oPZooHypN3 ENDIF;
wPMortZooHypN3 = rPDZooHypN3 * wDMortZooHypN3;
wPMortZooPO4HypN3 = fDissMortZooN3 * wPMortZooHypN3;
wPMortZooDetHypN3 = wPMortZooHypN3 - wPMortZooPO4HypN3;
oNFoodZooHypN3 = cPrefDiatN3*oNDiatWHypN3 + cPrefGrenN3*oNGrenWHypN3 + cPrefBlueN3*oNBlueWHypN3 + cPrefDetN3*oNDetWHypN3;
rNDFoodZooHypN3 = oNFoodZooHypN3 /(oDFoodZooHypN3+NearZeroN3);
wNConsDiatZooHypN3 = rNDDiatWHypN3*wDConsDiatZooHypN3;
wNConsGrenZooHypN3 = rNDGrenWHypN3*wDConsGrenZooHypN3;
wNConsBlueZooHypN3 = rNDBlueWHypN3*wDConsBlueZooHypN3;
wNConsPhytZooHypN3 = wNConsDiatZooHypN3 + wNConsGrenZooHypN3 + wNConsBlueZooHypN3;
wNConsDetZooHypN3 = rNDDetWHypN3*wDConsDetZooHypN3;
wNConsZooHypN3 = wNConsPhytZooHypN3 + wNConsDetZooHypN3;
afNAssZooHypN3 = MIN(1.0,cNDZooRefN3 / rNDFoodZooHypN3 * fDAssZooN3);
wNAssZooHypN3 = afNAssZooHypN3*wNConsZooHypN3;
wNEgesZooHypN3 = wNConsZooHypN3 - wNAssZooHypN3;
wNEgesZooNH4HypN3 = fDissEgesZooN3*wNEgesZooHypN3;
wNEgesZooDetHypN3 = wNEgesZooHypN3 - wNEgesZooNH4HypN3;
kNExcrZooHypN3 = rNDZooHypN3 / cNDZooRefN3 * kDRespZooN3 * uFunTmZooHypN3;
wNExcrZooHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE kNExcrZooHypN3*oNZooHypN3 ENDIF;
wNMortZooHypN3 = rNDZooHypN3*wDMortZooHypN3;
wNMortZooNH4HypN3 = fDissMortZooN3*wNMortZooHypN3;
wNMortZooDetHypN3 = wNMortZooHypN3 - wNMortZooNH4HypN3;
wSiConsDiatZooHypN3 = cSiDDiatN3 * wDConsDiatZooHypN3;
uFunTmBentN3 = EXP(-0.5/(cSigTmBentN3*cSigTmBentN3) *((uTmBotN3-cTmOptBentN3)*(uTmBotN3-cTmOptBentN3) - (cTmRefN3-cTmOptBentN3)*(cTmRefN3-cTmOptBentN3)));
aDFoodBentN3 = aDDetSN3 + aDPhytSN3;
rPDBentN3 = aPBentN3 /(aDBentN3+NearZeroN3);
rNDBentN3 = aNBentN3 /(aDBentN3+NearZeroN3);
tDMigrBentN3 = kMigrBentN3 *(cDBentInN3 - aDBentN3);
aDSatBentN3 = aDFoodBentN3 /(hDFoodBentN3 + aDFoodBentN3);
ukDIncrBentN3 = (kDAssBentN3 - kDRespBentN3) * uFunTmBentN3 - kMortBentN3;
tDEnvBentN3 = MAX(0.0,ukDIncrBentN3 / cDCarrBentN3 * aDBentN3*aDBentN3);
tDAssBentN3 = aDSatBentN3 *(kDAssBentN3 * uFunTmBentN3 * aDBentN3 - tDEnvBentN3);
aDAssBentSpN3 = tDAssBentN3 / aDBentN3;
tDConsBentN3 = tDAssBentN3 / fDAssBentN3;
tDConsDetBentN3 = aDDetSN3 / aDFoodBentN3 * tDConsBentN3;
tDConsDiatBentN3 = aDDiatSN3 / aDFoodBentN3 * tDConsBentN3;
tDConsGrenBentN3 = aDGrenSN3 / aDFoodBentN3 * tDConsBentN3;
tDConsBlueBentN3 = aDBlueSN3 / aDFoodBentN3 * tDConsBentN3;
tDConsPhytBentN3 = tDConsDiatBentN3 + tDConsGrenBentN3 + tDConsBlueBentN3;
tDEgesBentN3 = tDConsBentN3 - tDAssBentN3;
tDRespBentN3 = (cPDBentRefN3 / rPDBentN3) * kDRespBentN3 * uFunTmBentN3 * aDBentN3;
tDMortBentN3 = kMortBentN3*aDBentN3 +(1.0 - aDSatBentN3) * tDEnvBentN3;
aPFoodBentN3 = aPDetSN3 + aPPhytSN3;
rPDFoodBentN3 = aPFoodBentN3 /(aDFoodBentN3+NearZeroN3);
tPConsDetBentN3 = rPDDetSN3 * tDConsDetBentN3;
tPConsDiatBentN3 = rPDDiatSN3 * tDConsDiatBentN3;
tPConsGrenBentN3 = rPDGrenSN3 * tDConsGrenBentN3;
tPConsBlueBentN3 = rPDBlueSN3 * tDConsBlueBentN3;
tPConsPhytBentN3 = tPConsDiatBentN3 + tPConsGrenBentN3 + tPConsBlueBentN3;
tPConsBentN3 = tPConsDetBentN3 + tPConsPhytBentN3;
afPAssBentN3 = MIN(1.0,cPDBentRefN3 / rPDFoodBentN3 * fDAssBentN3);
tPAssBentN3 = afPAssBentN3 * tPConsBentN3;
tPEgesBentN3 = tPConsBentN3 - tPAssBentN3;
tPEgesBentPO4N3 = fDissEgesBentN3 * tPEgesBentN3;
tPEgesBentDetN3 = (1.0 - fDissEgesBentN3) * tPEgesBentN3;
tPExcrBentN3 = (rPDBentN3 / cPDBentRefN3) * kDRespBentN3 * uFunTmBentN3 * aPBentN3;
tPMortBentN3 = rPDBentN3 * tDMortBentN3;
tPMortBentPO4N3 = fDissMortBentN3 * tPMortBentN3;
tPMortBentDetN3 = (1.0-fDissMortBentN3)*tPMortBentN3;
tPMigrBentN3 = kMigrBentN3 *(cPDBentRefN3*cDBentInN3 - aPBentN3);
aNFoodBentN3 = aNDetSN3 + aNPhytSN3;
rNDFoodBentN3 = aNFoodBentN3 /(aDFoodBentN3+NearZeroN3);
tNMigrBentN3 = kMigrBentN3 *(cNDBentRefN3*cDBentInN3 - aNBentN3);
tNConsDetBentN3 = rNDDetSN3 * tDConsDetBentN3;
tNConsDiatBentN3 = rNDDiatSN3 * tDConsDiatBentN3;
tNConsGrenBentN3 = rNDGrenSN3 * tDConsGrenBentN3;
tNConsBlueBentN3 = rNDBlueSN3 * tDConsBlueBentN3;
tNConsPhytBentN3 = tNConsDiatBentN3 + tNConsGrenBentN3 + tNConsBlueBentN3;
tNConsBentN3 = tNConsDetBentN3 + tNConsPhytBentN3;
afNAssBentN3 = MIN(1.0,cNDBentRefN3 / rNDFoodBentN3 * fDAssBentN3);
tNAssBentN3 = afNAssBentN3 * tNConsBentN3;
tNEgesBentN3 = tNConsBentN3 - tNAssBentN3;
tNEgesBentNH4N3 = fDissEgesBentN3 * tNEgesBentN3;
tNEgesBentDetN3 = (1.0 - fDissEgesBentN3) * tNEgesBentN3;
tNExcrBentN3 = (rNDBentN3 / cNDBentRefN3) * kDRespBentN3 * uFunTmBentN3 * aNBentN3;
tNMortBentN3 = rNDBentN3 * tDMortBentN3;
tNMortBentNH4N3 = fDissMortBentN3*tNMortBentN3;
tNMortBentDetN3 = (1.0-fDissMortBentN3)*tNMortBentN3;
tSiConsDiatBentN3 = cSiDDiatN3 * tDConsDiatBentN3;
aFunVegFishN3 = MAX(0.0,1.0 - cRelVegFishN3 * aCovVegN3);
ukDIncrFiJvN3 = (kDAssFiJvN3 - kDRespFiJvN3) * uFunTmFishN3 - kMortFiJvN3;
aDSatFiAdN3 = (aFunVegFishN3 * aDBentN3) *(aFunVegFishN3 * aDBentN3) /(hDBentFiAdN3 * hDBentFiAdN3 + (aFunVegFishN3 * aDBentN3) *(aFunVegFishN3 * aDBentN3));
ukDIncrFiAdN3 = (kDAssFiAdN3 - kDRespFiAdN3) * uFunTmFishN3 - kMortFiAdN3;
ukHarvFishN3 = IF (COS(2.0 * PiN3 * sTimeN3 / DaysInYearN3) GT 0.1) THEN kHarvFishWinN3 ELSE kHarvFishSumN3 ENDIF;
afPAssFiAdN3 = MIN(1.0,cPDFishRefN3 / rPDBentN3 * fDAssFiAdN3);
afNAssFiAdN3 = MIN(1.0,cNDFishRefN3 / rNDBentN3 * fDAssFiAdN3);
uFunTmPiscN3 = EXP(-0.5 /(cSigTmPiscN3*cSigTmPiscN3) *((uTmEpiN3 - cTmOptPiscN3)*(uTmEpiN3 - cTmOptPiscN3) - (cTmRefN3 - cTmOptPiscN3)*(cTmRefN3 - cTmOptPiscN3)));
aDCarrPiscN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN MAX(cDCarrPiscMinN3,MIN(cDCarrPiscMaxN3,cDCarrPiscBareN3)) ELSEIF (aDShootPhraN3 LT cDPhraMinPiscN3) THEN cDCarrPiscMinN3 ELSEIF (aCovVegN3 LT cCovVegMinN3) THEN MAX(cDCarrPiscMinN3,MIN(cDCarrPiscMaxN3,fMarshN3 *(1.0/PerCentN3) * cRelPhraPiscN3)) ELSE MAX(cDCarrPiscMinN3,MIN(cDCarrPiscMaxN3,fMarshN3 *(1.0/PerCentN3) *(cRelPhraPiscN3 + cRelVegPiscN3))) ENDIF;
aFunVegPiscN3 = aDSubVegN3 /(hDVegPiscN3 + aDSubVegN3 + NearZeroN3);
akDIncrPiscN3 = (kDAssPiscN3 * aFunVegPiscN3 - kDRespPiscN3) * uFunTmPiscN3 - kMortPiscN3;
ukHarvPiscN3 = IF (COS(2.0*PiN3 * sTimeN3 / DaysInYearN3) GT 0.1) THEN kHarvPiscWinN3 ELSE kHarvPiscSumN3 ENDIF;
tDWebDetSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tDConsDetBentN3 + tDEgesBentN3 + tDMortBentN3 ENDIF;
tDWebDiatSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tDConsDiatBentN3 ENDIF;
tDWebGrenSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tDConsGrenBentN3 ENDIF;
tDWebBlueSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tDConsBlueBentN3 ENDIF;
tDWebPhytSN3 = tDWebDiatSN3 + tDWebGrenSN3 + tDWebBlueSN3;
tPWebPO4SN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tPExcrBentN3 + tPEgesBentPO4N3 + tPMortBentPO4N3 ENDIF;
tPWebDetSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tPConsDetBentN3 + tPEgesBentDetN3 + tPMortBentDetN3 ENDIF;
tPWebDiatSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tPConsDiatBentN3 ENDIF;
tPWebGrenSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tPConsGrenBentN3 ENDIF;
tPWebBlueSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tPConsBlueBentN3 ENDIF;
tPWebPhytSN3 = tPWebDiatSN3 + tPWebGrenSN3 + tPWebBlueSN3;
tNWebNH4SN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tNExcrBentN3 + tNEgesBentNH4N3 + tNMortBentNH4N3 ENDIF;
tNWebNO3SN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE 0.0 ENDIF;
tNWebDetSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tNConsDetBentN3 + tNEgesBentDetN3 + tNMortBentDetN3 ENDIF;
tNWebDiatSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tNConsDiatBentN3 ENDIF;
tNWebGrenSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tNConsGrenBentN3 ENDIF;
tNWebBlueSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - tNConsBlueBentN3 ENDIF;
tNWebPhytSN3 = tNWebDiatSN3 + tNWebGrenSN3 + tNWebBlueSN3;
wSiWebSiO2WN3 = 0.0;
wSiWebDetWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wSiConsDiatZooHypN3 ENDIF;
tSiWebDetSN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tSiConsDiatBentN3 ENDIF;
tSiWebTotTN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE 0.0 ENDIF;
aPrefAveHypN3 = (cPrefDiatN3 * oDDiatWHypN3 + cPrefGrenN3 * oDGrenWHypN3 + cPrefBlueN3 * oDBlueWHypN3 + cPrefDetN3 * oDDetWHypN3) / oDOMWHypN3;
wDConsZoo2HypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aFiltHypN3 * aPrefAveHypN3 * oDOMWHypN3 * oDZooHypN3 ENDIF;
aDConsZooSpHypN3 = wDConsZooHypN3 / oDZooHypN3;
aDAssZooSpHypN3 = wDAssZooHypN3 / oDZooHypN3;
aDGrazSpHypN3 = wDConsZooHypN3 / oDOMWHypN3;
aNConsZooSpHypN3 = wNConsZooHypN3 / oNZooHypN3;
aNGrazSpHypN3 = wNConsZooHypN3 / oNOMWHypN3;
afDShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDShootPhraN3 /(aDRootPhraN3 + aDShootPhraN3) ELSE 0.0 ENDIF;
rDSRPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDShootPhraN3/aDRootPhraN3 ELSE 0.0 ENDIF;
rPDShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPShootPhraN3/aDShootPhraN3 ELSE 0.0 ENDIF;
rNDShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNShootPhraN3/aDShootPhraN3 ELSE 0.0 ENDIF;
rPDRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aPRootPhraN3/aDRootPhraN3 ELSE 0.0 ENDIF;
rNDRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNRootPhraN3/aDRootPhraN3 ELSE 0.0 ENDIF;
aLengShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aDShootPhraN3 / cDStemPhraN3 / cDensStemPhraN3 ELSE 0.0 ENDIF;
bDayInitPhraN3 = IF (DayN3 LT 1.0 OR sTimeN3 LT StartTimeN3 + 1.0) THEN 367 ELSEIF (uTmEpiN3 GE cTmInitPhraN3 AND bDayInitPhraN3 GT 366) THEN DayN3 ELSE bDayInitPhraN3 ENDIF;
aDAllPhraN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (DayN3 LT bDayInitPhraN3) THEN 0.0 ELSEIF (DayN3 LE bDayInitPhraN3 + 1.0 / kDAllPhraN3) THEN fDAllPhraN3 * aDRootPhraN3 ELSE 0.0 ENDIF;
tDAllPhraN3 = IF (FALSE EQ InclSeasonN3) THEN 0.0 ELSEIF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (DayN3 LT bDayInitPhraN3) THEN 0.0 ELSEIF (DayN3 LE bDayInitPhraN3 + 1.0 / kDAllPhraN3) THEN kDAllPhraN3 * aDAllPhraN3 ELSE 0.0 ENDIF;
tNTransPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rNDRootPhraN3 * tDAllPhraN3 ELSE 0.0 ENDIF;
tPTransPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rPDRootPhraN3 * tDAllPhraN3 ELSE 0.0 ENDIF;
aVNUptPhraMaxCrN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN MAX(0.0,cVNUptPhraMaxN3 * POW(cQ10ProdPhraN3 , (0.1 *(uTmEpiN3 - cTmRefN3))) *(cNDPhraMaxN3 - rNDRootPhraN3) /(cNDPhraMaxN3 - cNDPhraMinN3)) ELSE 0.0 ENDIF;
ahNUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVNUptPhraMaxCrN3 / cAffNUptPhraN3 ELSE 0.0 ENDIF;
aVNUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVNUptPhraMaxCrN3 * oNDissSMN3 /(ahNUptPhraSN3 + oNDissSMN3) ELSE 0.0 ENDIF;
tNUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVNUptPhraSN3 * aDRootPhraN3 ELSE 0.0 ENDIF;
tNUptNH4PhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aNH4SMN3 / aNDissSMN3 * tNUptPhraSN3 ELSE 0.0 ENDIF;
tNUptNO3PhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tNUptPhraSN3 - tNUptNH4PhraSN3 ELSE 0.0 ENDIF;
tNUptShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN afDShootPhraN3 * tNUptPhraSN3 ELSE 0.0 ENDIF;
tNUptRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tNUptPhraSN3 - tNUptShootPhraN3 ELSE 0.0 ENDIF;
aVPUptPhraMaxCrN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN MAX(0.0,cVPUptPhraMaxN3 * POW(cQ10ProdPhraN3 , (0.1 *(uTmEpiN3 - cTmRefN3))) *(cPDPhraMaxN3 - rPDRootPhraN3) /(cPDPhraMaxN3 - cPDPhraMinN3)) ELSE 0.0 ENDIF;
ahPUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVPUptPhraMaxCrN3 / cAffPUptPhraN3 ELSE 0.0 ENDIF;
aVPUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVPUptPhraMaxCrN3 * oPO4SMN3 /(ahPUptPhraSN3 + oPO4SMN3) ELSE 0.0 ENDIF;
tPUptPhraSN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aVPUptPhraSN3 * aDRootPhraN3 ELSE 0.0 ENDIF;
tPUptShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN afDShootPhraN3 * tPUptPhraSN3 ELSE 0.0 ENDIF;
tPUptRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tPUptPhraSN3 - tPUptShootPhraN3 ELSE 0.0 ENDIF;
uFunTmProdPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN POW(cQ10ProdPhraN3 , (0.1 *(uTmEpiN3 - cTmRefN3))) ELSE 0.0 ENDIF;
ukDRespTmPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDRespPhraN3 * POW(cQ10RespPhraN3 , (0.1 *(uTmEpiN3 - cTmRefN3))) ELSE 0.0 ENDIF;
aMuPhotPhraN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (aLengShootPhraN3 GE uDepthWMN3) THEN cMuPhraMaxN3 * uFunTmProdPhraN3 * ufDayN3 ELSE 0.0 ENDIF;
aNLimProdPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (1.0 - cNDPhraMinN3 / rNDRootPhraN3) * cNDPhraMaxN3 /(cNDPhraMaxN3 - cNDPhraMinN3) ELSE 0.0 ENDIF;
aPLimProdPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (1.0 - cPDPhraMinN3 / rPDRootPhraN3) * cPDPhraMaxN3 /(cPDPhraMaxN3 - cPDPhraMinN3) ELSE 0.0 ENDIF;
aNutLimPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN MIN(aNLimProdPhraN3,aPLimProdPhraN3) ELSE 0.0 ENDIF;
aMuPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aMuPhotPhraN3 * aNutLimPhraN3 ELSE 0.0 ENDIF;
akDIncrPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aMuPhotPhraN3 - ukDRespTmPhraN3 - kDMortShootPhraN3 ELSE 0.0 ENDIF;
tDDensPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN MAX(0.0,akDIncrPhraN3 / cDShootPhraMaxN3 * aDShootPhraN3 * aDShootPhraN3) ELSE 0.0 ENDIF;
tDDensProdPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aMuPhraN3 / cMuPhraMaxN3 * tDDensPhraN3 ELSE 0.0 ENDIF;
tDProdPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN aMuPhraN3 * aDShootPhraN3 - tDDensProdPhraN3 ELSE 0.0 ENDIF;
tDProdShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN afDShootPhraN3 * tDProdPhraN3 ELSE 0.0 ENDIF;
tDProdRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDProdPhraN3 - tDProdShootPhraN3 ELSE 0.0 ENDIF;
tDRespShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ukDRespTmPhraN3 * aDShootPhraN3 ELSE 0.0 ENDIF;
tDRespRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN ukDRespTmPhraN3 * aDRootPhraN3 ELSE 0.0 ENDIF;
tO2RespRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN molO2molCN3 * cCPerDWN3 * tDRespRootPhraN3 * afOxySedMN3 ELSE 0.0 ENDIF;
tO2FlowPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tO2RespRootPhraN3 ELSE 0.0 ENDIF;
bDayRealPhraN3 = IF (DayN3 LT 180.0) THEN 367 ELSEIF (ufDayN3 LE fDayWinN3 AND bDayRealPhraN3 GT 366) THEN DayN3 ELSE bDayRealPhraN3 ENDIF;
aDRealPhraN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (DayN3 LT bDayRealPhraN3) THEN 0.0 ELSEIF (DayN3 LE bDayRealPhraN3 + 1.0 / kDRealPhraN3) THEN fDRealPhraN3 * aDShootPhraN3 ELSE 0.0 ENDIF;
tDRealPhraN3 = IF (FALSE EQ InclSeasonN3) THEN 0.0 ELSEIF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (DayN3 LT bDayRealPhraN3) THEN 0.0 ELSEIF (DayN3 LE bDayRealPhraN3 + 1.0 / kDRealPhraN3) THEN kDRealPhraN3 * aDRealPhraN3 ELSE 0.0 ENDIF;
tNRetrPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rNDShootPhraN3 * tDRealPhraN3 ELSE 0.0 ENDIF;
tPRetrPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rPDShootPhraN3 * tDRealPhraN3 ELSE 0.0 ENDIF;
tDMortShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMortShootPhraN3 * aDShootPhraN3 ELSE 0.0 ENDIF;
tNMortShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rNDShootPhraN3 * tDMortShootPhraN3 ELSE 0.0 ENDIF;
tPMortShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rPDShootPhraN3 * tDMortShootPhraN3 ELSE 0.0 ENDIF;
tDMortRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kDMortRootPhraN3 * aDRootPhraN3 ELSE 0.0 ENDIF;
tNMortRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rNDRootPhraN3 * tDMortRootPhraN3 ELSE 0.0 ENDIF;
tPMortRootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN rPDRootPhraN3 * tDMortRootPhraN3 ELSE 0.0 ENDIF;
tDManShootPhraN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 GT NearZeroN3) THEN 0.0 ELSEIF ((DayN3 GE cDayManPhraN3) AND (DayN3 LT cDayManPhraN3 + 1.0)) THEN fManPhraN3 * aDShootPhraN3 ELSE 0.0 ENDIF;
tNManShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDManShootPhraN3 * rNDShootPhraN3 ELSE 0.0 ENDIF;
tPManShootPhraN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDManShootPhraN3 * rPDShootPhraN3 ELSE 0.0 ENDIF;
tDIMSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDSetIMMN3 ELSE 0.0 ENDIF;
tDHumSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN fRefrDetSN3 * tDMinDetSMN3 - tDMinHumSMN3 ELSE 0.0 ENDIF;
tDDetSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN tDSetDetMN3 - tDMinDetSMN3 + tDSetPhytMN3 + tDMortRootPhraN3 ELSE 0.0 ENDIF;
vDeltaSMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (tDIMSMN3 / cRhoIMN3 +(tDHumSMN3 + tDDetSMN3) / cRhoOMN3)/(1.0 - bPorSN3) ELSE 0.0 ENDIF;
tDBurIMMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN ((tDHumSMN3 + tDDetSMN3) +(cRhoOMN3 / cRhoIMN3) * tDIMSMN3) / ((aDHumSMN3 + aDDetSMN3) / aDIMSMN3 + cRhoOMN3 / cRhoIMN3) ELSE ((tDHumSMN3 + tDDetSMN3) +(cRhoOMN3 / cRhoIMN3) * tDIMSMN3) / (fDOrgSoilN3 /(1.0 - fDOrgSoilN3) + cRhoOMN3 / cRhoIMN3) ENDIF;
tDBurOMMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN (aDHumSMN3 + aDDetSMN3) / aDIMSMN3 * tDBurIMMN3 ELSE fDOrgSoilN3 /(1.0 - fDOrgSoilN3) * tDBurIMMN3 ENDIF;
tDBurDetMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN aDDetSMN3 /(aDHumSMN3 + aDDetSMN3) * tDBurOMMN3 ELSE 0.0 ENDIF;
tDBurHumMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN tDBurOMMN3 - tDBurDetMN3 ELSE tDBurOMMN3 ENDIF;
tDBurTotMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN tDBurIMMN3 + tDBurOMMN3 ELSE tDBurIMMN3 + tDBurOMMN3 ENDIF;
tPBurHumMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN rPDHumSMN3 * tDBurHumMN3 ELSE cPDSoilOMN3 * tDBurHumMN3 ENDIF;
tPBurDetMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN rPDDetSMN3 * tDBurDetMN3 ELSE 0.0 ENDIF;
tPBurAIMMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN aPAIMSMN3 / aDIMSMN3 * tDBurIMMN3 ELSE 0.0 ENDIF;
tPBurPO4MN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN aPO4SMN3 *(vDeltaSMN3 / cDepthSMN3) ELSE cPO4GroundN3 *(bPorSMN3 * vDeltaSMN3) ENDIF;
tPBurTotMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN tPBurDetMN3 + tPBurHumMN3 + tPBurAIMMN3 + tPBurPO4MN3 ELSE tPBurHumMN3 + tPBurAIMMN3 + tPBurPO4MN3 ENDIF;
tNBurHumMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN rNDHumSMN3 * tDBurHumMN3 ELSE cNDSoilOMN3 * tDBurHumMN3 ENDIF;
tNBurDetMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN rNDDetSMN3 * tDBurDetMN3 ELSE 0.0 ENDIF;
tNBurNH4MN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN aNH4SMN3 *(vDeltaSMN3 / cDepthSMN3) ELSE cNH4GroundN3 *(bPorSMN3 * vDeltaSMN3) ENDIF;
tNBurNO3MN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN aNO3SMN3 *(vDeltaSMN3 / cDepthSMN3) ELSE cNO3GroundN3 *(bPorSMN3 * vDeltaSMN3) ENDIF;
tNBurTotMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN tNBurDetMN3 + tNBurHumMN3 + tNBurNH4MN3 + tNBurNO3MN3 ELSE tNBurHumMN3 + tNBurNH4MN3 + tNBurNO3MN3 ENDIF;
tSiBurDetMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN rSiDDetSMN3 * tDBurDetMN3 ELSE 0.0 ENDIF;
tSiBurTotMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (vDeltaSMN3 GE 0.0) THEN tSiBurDetMN3 ELSE 0.0 ENDIF;
vDeltaWMN3 = IF (FALSE EQ InclMarshN3 OR fMarshN3 LE NearZeroN3) THEN 0.0 ELSEIF (ConstDepthN3 EQ TRUE) THEN 0.0 ELSE - vDeltaSMN3 ENDIF;
aRelDeltaWMN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN vDeltaWMN3 / uDepthWMN3 ELSE 0.0 ENDIF;
bTimeDredN3 = IF (sTimeN3 GE cDredStartN3 * DaysPerYearN3) THEN (FLOOR(TimeYearsN3/cDredIntervalN3) * cDredIntervalN3) * DaysPerYearN3 ELSE -9999.999 ENDIF;
bRhoSolidSoilN3 = fDOrgSoilN3 * cRhoOMN3 +(1.0 - fDOrgSoilN3) * cRhoIMN3;
tDMarsTotTN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (- tDBurTotMN3 - wDMinDetWMN3 * uDepthWMN3 -(1.0 - fRefrDetSN3) * tDMinDetSMN3 - tDMinHumSMN3 + tDProdPhraN3 - tDRespShootPhraN3 - tDRespRootPhraN3 - tDManShootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
tPMarsTotTN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (- tPInfPO4SMN3 + tPSeepPO4SMN3 - tPDifGroundPO4MN3 - tPBurTotMN3 - tPChemPO4MN3 - tPManShootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
tNMarsTotTN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN (- tNInfNH4SMN3 + tNSeepNH4SMN3 - tNInfNO3SMN3 + tNSeepNO3SMN3 - tNDifGroundNO3MN3 - tNDifGroundNH4MN3 - tNBurTotMN3 - wNDenitWMN3 * uDepthWMN3 - tNDenitSMN3 - tNManShootPhraN3) * fMarshN3 ELSE 0.0 ENDIF;
tSiMarsTotTN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN - tSiBurDetMN3 * fMarshN3 - tInfSiO2WMN3 + tSeepSiO2WMN3 ELSE 0.0 ENDIF;
uTauSubstEpiN3 = 1.0 / (ukOutEpiN3+NearZeroN3);
akExchMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN kExchMaxMN3 * hfMarshN3 /(hfMarshN3 + fMarshN3)  ELSE 0.0 ENDIF;
afVolMarshEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN fMarshN3 * uDepthWMN3 / uDepthWEpiN3 ELSE 0.0 ENDIF;
akExchLEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 * afVolMarshEpiN3 ELSE 0.0 ENDIF;
oPPhytWEpiN3 = oPDiatWEpiN3 + oPGrenWEpiN3 + oPBlueWEpiN3;
oNPhytWEpiN3 = oNDiatWEpiN3 + oNGrenWEpiN3 + oNBlueWEpiN3;
oDSestWEpiN3 = oDOMWEpiN3 + oDIMWEpiN3;
oPOMWEpiN3 = oPPhytWEpiN3 + oPDetWEpiN3;
oPSestWEpiN3 = oPPhytWEpiN3 + oPDetWEpiN3 + oPAIMWEpiN3;
oPInorgWEpiN3 = oPO4WEpiN3 + oPAIMWEpiN3;
oPTotWEpiN3 = oPSestWEpiN3 + oPO4WEpiN3;
oNOMWEpiN3 = oNPhytWEpiN3 + oNDetWEpiN3;
oNSestWEpiN3 = oNOMWEpiN3;
oNkjWEpiN3 = oNSestWEpiN3 + oNH4WEpiN3;
oNTotWEpiN3 = oNkjWEpiN3 + oNO3WEpiN3;
rPDIMWEpiN3 = oPAIMWEpiN3 / oDIMWEpiN3;
rPDDetWEpiN3 = oPDetWEpiN3 / (oDDetWEpiN3+NearZeroN3);
rNDDetWEpiN3 = oNDetWEpiN3 / (oDDetWEpiN3+NearZeroN3);
rSiDDetWEpiN3 = oSiDetWEpiN3 / (oDDetWEpiN3+NearZeroN3);
wDDilIMEpiN3 = ukOutEpiN3 * oDIMWEpiN3;
wDDilDetEpiN3 = ukOutEpiN3 * oDDetWEpiN3;
wDDilDiatEpiN3 = ukOutEpiN3 * oDDiatWEpiN3;
wDDilGrenEpiN3 = ukOutEpiN3 * oDGrenWEpiN3;
wDDilBlueEpiN3 = ukOutEpiN3 * oDBlueWEpiN3;
wDDilPhytEpiN3 = wDDilDiatEpiN3 + wDDilGrenEpiN3 + wDDilBlueEpiN3;
wDDilZooEpiN3 = ukOutEpiN3 * oDZooEpiN3;
wPDilZooEpiN3 = ukOutEpiN3 * oPZooEpiN3;
wNDilZooEpiN3 = ukOutEpiN3 * oNZooEpiN3;
wPDilPO4EpiN3 = ukOutEpiN3 * oPO4WEpiN3;
wPDilDetEpiN3 = ukOutEpiN3*oPDetWEpiN3;
wPDilAIMEpiN3 = ukOutEpiN3 * oPAIMWEpiN3;
wNDilNH4EpiN3 = ukOutEpiN3 * oNH4WEpiN3;
wNDilNO3EpiN3 = ukOutEpiN3 * oNO3WEpiN3;
wNDilDetEpiN3 = ukOutEpiN3 * oNDetWEpiN3;
uO2LoadEpiN3 = IF (ReadTranFracN3 EQ TRUE) THEN mO2LoadEpiN3 ELSE cO2InN3 * uQInEpiN3 / mmPermN3 ENDIF;
wO2OutflEpiN3 = ukOutEpiN3 * oO2WEpiN3;
wPDilDiatEpiN3 = ukOutEpiN3 * oPDiatWEpiN3;
wNDilDiatEpiN3 = ukOutEpiN3 * oNDiatWEpiN3;
wPDilGrenEpiN3 = ukOutEpiN3 * oPGrenWEpiN3;
wNDilGrenEpiN3 = ukOutEpiN3 * oNGrenWEpiN3;
wPDilBlueEpiN3 = ukOutEpiN3 * oPBlueWEpiN3;
wNDilBlueEpiN3 = ukOutEpiN3 * oNBlueWEpiN3;
wPDilPhytEpiN3 = wPDilDiatEpiN3 + wPDilGrenEpiN3 + wPDilBlueEpiN3;
wNDilPhytEpiN3 = wNDilDiatEpiN3 + wNDilGrenEpiN3 + wNDilBlueEpiN3;
wDOutflTotEpiN3 = ukOutEpiN3 * oDSestWEpiN3;
wPOutflTotEpiN3 = ukOutEpiN3 * oPTotWEpiN3;
wNOutflTotEpiN3 = ukOutEpiN3 * oNTotWEpiN3;
wSiDilSiO2EpiN3 = ukOutEpiN3 * oSiO2WEpiN3;
wSiDilDetEpiN3 = ukOutEpiN3 * oSiDetWEpiN3;
wSiDilDiatEpiN3 = cSiDDiatN3 * wDDilDiatEpiN3;
wSiOutflTotEpiN3 = ukOutEpiN3 * (oSiO2WEpiN3 + oSiDetWEpiN3 + cSiDDiatN3 * oDDiatWEpiN3);
wDDilTotEpiN3 = wDDilIMEpiN3 + wDDilDetEpiN3 + wDDilPhytEpiN3;
wPDilTotEpiN3 = wPDilDetEpiN3 + wPDilPO4EpiN3 + wPDilAIMEpiN3 + wPDilPhytEpiN3;
wNDilTotEpiN3 = wNDilDetEpiN3 + wNDilNO3EpiN3 + wNDilNH4EpiN3 + wNDilPhytEpiN3;
wSiDilTotEpiN3 = wSiDilDetEpiN3 + wSiDilSiO2EpiN3 + wSiDilDiatEpiN3;
tSiTranTotTEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadEpiN3 - wSiDilTotEpiN3 * uDepthWEpiN3 ENDIF;
tDTranTotTEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadEpiN3 - wDDilTotEpiN3 * uDepthWEpiN3 ENDIF;
tPTranTotTEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadEpiN3 - wPDilTotEpiN3 * uDepthWEpiN3 ENDIF;
tNTranTotTEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadEpiN3 - wNDilTotEpiN3 * uDepthWEpiN3 ENDIF;
wDExchIMMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDIMWEpiN3 - oDIMWMN3) ELSE 0.0 ENDIF;
wPExchPO4MEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPO4WEpiN3 - oPO4WMN3) ELSE 0.0 ENDIF;
wPExchAIMMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPAIMWEpiN3 - oPAIMWMN3) ELSE 0.0 ENDIF;
wNExchNH4MEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNH4WEpiN3 - oNH4WMN3) ELSE 0.0 ENDIF;
wNExchNO3MEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNO3WEpiN3 - oNO3WMN3) ELSE 0.0 ENDIF;
wSiExchSiO2MEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oSiO2WEpiN3 - oSiO2WMN3) ELSE 0.0 ENDIF;
wO2ExchMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oO2WEpiN3 - oO2WMN3) ELSE 0.0 ENDIF;
wDExchDetMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDDetWEpiN3 - oDDetWMN3) ELSE 0.0 ENDIF;
wPExchDetMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPDetWEpiN3 - oPDetWMN3) ELSE 0.0 ENDIF;
wNExchDetMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNDetWEpiN3 - oNDetWMN3) ELSE 0.0 ENDIF;
wSiExchDetMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oSiDetWEpiN3 - oSiDetWMN3) ELSE 0.0 ENDIF;
wDExchDiatMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDDiatWEpiN3 - oDDiatWMN3) ELSE 0.0 ENDIF;
wPExchDiatMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPDiatWEpiN3 - oPDiatWMN3) ELSE 0.0 ENDIF;
wNExchDiatMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNDiatWEpiN3 - oNDiatWMN3) ELSE 0.0 ENDIF;
wSiExchDiatMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cSiDDiatN3 * wDExchDiatMEpiN3 ELSE 0.0 ENDIF;
wDExchGrenMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDGrenWEpiN3 - oDGrenWMN3) ELSE 0.0 ENDIF;
wPExchGrenMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPGrenWEpiN3 - oPGrenWMN3) ELSE 0.0 ENDIF;
wNExchGrenMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNGrenWEpiN3 - oNGrenWMN3) ELSE 0.0 ENDIF;
wDExchBlueMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDBlueWEpiN3 - oDBlueWMN3) ELSE 0.0 ENDIF;
wPExchBlueMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPBlueWEpiN3 - oPBlueWMN3) ELSE 0.0 ENDIF;
wNExchBlueMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNBlueWEpiN3 - oNBlueWMN3) ELSE 0.0 ENDIF;
wDExchZooMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oDZooEpiN3 - oDZooMN3) ELSE 0.0 ENDIF;
wPExchZooMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oPZooEpiN3 - oPZooMN3) ELSE 0.0 ENDIF;
wNExchZooMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchMEpiN3 *(oNZooEpiN3 - oNZooMN3) ELSE 0.0 ENDIF;
wDExchIMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDIMWEpiN3 - oDIMWMN3) ELSE 0.0 ENDIF;
wPExchPO4EpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPO4WEpiN3 - oPO4WMN3) ELSE 0.0 ENDIF;
wPExchAIMEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPAIMWEpiN3 - oPAIMWMN3) ELSE 0.0 ENDIF;
wNExchNH4EpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNH4WEpiN3 - oNH4WMN3) ELSE 0.0 ENDIF;
wNExchNO3EpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNO3WEpiN3 - oNO3WMN3) ELSE 0.0 ENDIF;
wSiExchSiO2EpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oSiO2WEpiN3 - oSiO2WMN3) ELSE 0.0 ENDIF;
wO2ExchEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oO2WEpiN3 - oO2WMN3) ELSE 0.0 ENDIF;
wDExchDetEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDDetWEpiN3 - oDDetWMN3) ELSE 0.0 ENDIF;
wPExchDetEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPDetWEpiN3 - oPDetWMN3) ELSE 0.0 ENDIF;
wNExchDetEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNDetWEpiN3 - oNDetWMN3) ELSE 0.0 ENDIF;
wSiExchDetEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oSiDetWEpiN3 - oSiDetWMN3) ELSE 0.0 ENDIF;
wDExchDiatEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDDiatWEpiN3 - oDDiatWMN3) ELSE 0.0 ENDIF;
wPExchDiatEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPDiatWEpiN3 - oPDiatWMN3) ELSE 0.0 ENDIF;
wNExchDiatEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNDiatWEpiN3 - oNDiatWMN3) ELSE 0.0 ENDIF;
wSiExchDiatEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN cSiDDiatN3 * wDExchDiatEpiN3 ELSE 0.0 ENDIF;
wDExchGrenEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDGrenWEpiN3 - oDGrenWMN3) ELSE 0.0 ENDIF;
wPExchGrenEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPGrenWEpiN3 - oPGrenWMN3) ELSE 0.0 ENDIF;
wNExchGrenEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNGrenWEpiN3 - oNGrenWMN3) ELSE 0.0 ENDIF;
wDExchBlueEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDBlueWEpiN3 - oDBlueWMN3) ELSE 0.0 ENDIF;
wPExchBlueEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPBlueWEpiN3 - oPBlueWMN3) ELSE 0.0 ENDIF;
wNExchBlueEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNBlueWEpiN3 - oNBlueWMN3) ELSE 0.0 ENDIF;
wDExchZooEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oDZooEpiN3 - oDZooMN3) ELSE 0.0 ENDIF;
wPExchZooEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oPZooEpiN3 - oPZooMN3) ELSE 0.0 ENDIF;
wNExchZooEpiN3 = IF (InclMarshN3 EQ TRUE AND fMarshN3 GT NearZeroN3) THEN akExchLEpiN3 *(oNZooEpiN3 - oNZooMN3) ELSE 0.0 ENDIF;
tInfSiO2WEpiN3 =IF (InclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oSiO2WEpiN3 ELSE 0.0 ENDIF;
tInfO2WEpiN3 =IF (InclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oO2WEpiN3 ELSE 0.0 ENDIF;
tPInfPO4WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oPO4WEpiN3 ELSE 0.0 ENDIF;
tNInfNH4WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNH4WEpiN3 ELSE 0.0 ENDIF;
tNInfNO3WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN3 GE 0.0) THEN uQOutInfN3 / mmPermN3 * oNO3WEpiN3 ELSE 0.0 ENDIF;
tSeepSiO2WEpiN3 =IF (InclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WEpiN3 =IF (InclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oPO4SN3 ELSE 0.0 ENDIF;
tNSeepNH4WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNH4SN3 ELSE 0.0 ENDIF;
tNSeepNO3WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN3 GE 0.0) THEN uQInSeepN3 / mmPermN3 * oNO3SN3 ELSE 0.0 ENDIF;
tSiAbioTotTN3 = - fRefrDetSN3 * tSiMinDetSN3 - tInfSiO2WHypN3 - tInfSiO2WEpiN3 + tSeepSiO2WHypN3 + tSeepSiO2WEpiN3;
tO2AerEpiN3 = kAerN3 * uFunTmAerEpiN3 * (uO2SatEpiN3 - oO2WEpiN3) * aFunFloatAerN3 * aFunBlueSurfAerN3;
tDTurbFishIMN3 = fLutumN3 * aDIMSN3 / (fLutumN3 * aDIMSN3 + aDDetSN3) * tDTurbFishN3;
uCorVSetIMEpiN3 = (aFunTauSetIMEpiN3+ uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * POW((fLutumRefN3/fLutumN3) , (0.5)) * uFunTmSetEpiN3 * cVSetIMN3;
tDSetIMEpiN3 = uCorVSetIMEpiN3 * oDIMWEpiN3;
tPSetAIMEpiN3 = oPAIMWEpiN3 / oDIMWEpiN3 * tDSetIMEpiN3;
uCorVSetDetEpiN3 = (cVSetDetN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMEpiN3 * uFunTmSetEpiN3;
tDSetDetEpiN3 = uCorVSetDetEpiN3 * oDDetWEpiN3;
tPSetDetEpiN3 = uCorVSetDetEpiN3 * oPDetWEpiN3;
tNSetDetEpiN3 = uCorVSetDetEpiN3 * oNDetWEpiN3;
tSiSetDetEpiN3 = uCorVSetDetEpiN3 * oSiDetWEpiN3;
wDMinDetWEpiN3 = kDMinDetWN3 * uFunTmMinWEpiN3 * oDDetWEpiN3;
wPMinDetWEpiN3 = kPMinDetWN3 * uFunTmMinWEpiN3 * oPDetWEpiN3;
wNMinDetWEpiN3 = kNMinDetWN3 * uFunTmMinWEpiN3 * oNDetWEpiN3;
wSiMinDetWEpiN3 = kSiMinDetWN3 * uFunTmMinWEpiN3 * oSiDetWEpiN3;
aCorO2BODEpiN3 = oO2WEpiN3 / (hO2BODN3 + oO2WEpiN3);
wO2MinDetWEpiN3 = molO2molCN3 * cCPerDWN3 * aCorO2BODEpiN3 * wDMinDetWEpiN3;
wDDenitWEpiN3 = oNO3WEpiN3*oNO3WEpiN3 / (hNO3DenitN3*hNO3DenitN3 + oNO3WEpiN3*oNO3WEpiN3) * (1.0 - aCorO2BODEpiN3) * wDMinDetWEpiN3;
wNDenitWEpiN3 = NO3PerCN3 * molNmolCN3 * cCPerDWN3 * wDDenitWEpiN3;
aCorO2NitrWEpiN3 = oO2WEpiN3*oO2WEpiN3 / (hO2NitrN3*hO2NitrN3 + oO2WEpiN3*oO2WEpiN3);
wNNitrWEpiN3 = kNitrWN3 * uFunTmNitrEpiN3 * aCorO2NitrWEpiN3 * oNH4WEpiN3;
wO2NitrWEpiN3 = O2PerNH4N3 * molO2molNN3 * wNNitrWEpiN3;
tDMinOxyDetSN3 = afOxySedN3 * (1.0 - fRefrDetSN3) * tDMinDetSN3;
tO2MinDetSN3 = molO2molCN3 * cCPerDWN3 * tDMinOxyDetSN3;
tDDenitSN3 = oNO3SN3*oNO3SN3 / (hNO3DenitN3*hNO3DenitN3 + oNO3SN3*oNO3SN3) * (1.0 - afOxySedN3) * (1.0 - fRefrDetSN3) * tDMinDetSN3;
tNDenitSN3 = NO3PerCN3 * molNmolCN3 * cCPerDWN3 * tDDenitSN3;
tNNitrSN3 = afOxySedN3 * kNitrSN3 * uFunTmNitrSN3 * aNH4SN3;
tO2NitrSN3 = O2PerNH4N3 * molO2molNN3 * tNNitrSN3;
tDMinHumSN3 = kDMinHumN3 * uFunTmMinSN3 * afOxySedN3 * aDHumSN3;
tPMinHumSN3 = kDMinHumN3 * uFunTmMinSN3 * afOxySedN3 * aPHumSN3;
tNMinHumSN3 = kDMinHumN3 * uFunTmMinSN3 * afOxySedN3 * aNHumSN3;
tPDifPO4EpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN 0.0 ELSE kPDifPO4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oPO4SN3 - oPO4WEpiN3 ) / aDepthDifN3 ENDIF;
tNDifNO3EpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN 0.0 ELSE kNDifNO3N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oNO3SN3 - oNO3WEpiN3 ) / aDepthDifN3 ENDIF;
tNDifNH4EpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN 0.0 ELSE kNDifNH4N3 * uFunTmDifN3 * cTurbDifNutN3 * bPorCorSN3 * (oNH4SN3 - oNH4WEpiN3 ) / aDepthDifN3 ENDIF;
tO2DifEpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN 0.0 ELSE kO2DifN3 / aDepthDifN3 * uFunTmDifN3 * cTurbDifO2N3 * bPorCorSN3 * oO2WEpiN3 ENDIF;
aPAdsMaxWEpiN3 = cRelPAdsDN3 + aCorO2BODEpiN3 * cRelPAdsFeN3 * fFeDIMN3 + cRelPAdsAlN3 * fAlDIMN3;
aKPAdsWEpiN3 = (1.0 - fRedMaxN3 * (1.0-aCorO2BODEpiN3)) * cKPAdsOxN3;
aPIsoAdsWEpiN3 = aPAdsMaxWEpiN3 * aKPAdsWEpiN3 * oPO4WEpiN3 / (1.0 + aKPAdsWEpiN3 * oPO4WEpiN3);
aPEqIMWEpiN3 = aPIsoAdsWEpiN3 * oDIMWEpiN3;
wPSorpIMWEpiN3 = kPSorpN3 * (aPEqIMWEpiN3 - oPAIMWEpiN3);
aPAdsMaxSN3 = cRelPAdsDN3 + afOxySedN3 * cRelPAdsFeN3 * fFeDIMN3 + cRelPAdsAlN3 * fAlDIMN3;
aKPAdsSN3 = (1.0 - fRedMaxN3 * (1.0-afOxySedN3)) * cKPAdsOxN3;
aPIsoAdsSN3 = aPAdsMaxSN3 * aKPAdsSN3 * oPO4SN3 / (1.0 + aKPAdsSN3 * oPO4SN3);
aPEqIMSN3 = aPIsoAdsSN3 * aDIMSN3;
tPSorpIMSN3 = kPSorpN3 * (aPEqIMSN3 - aPAIMSN3);
wO2AbioWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE tO2BubHypN3 / uDepthWHypN3 - wO2MinDetWHypN3 - wO2NitrWHypN3 - (tO2MinDetSN3 + tO2NitrSN3) / uDepthWHypN3 - (tInfO2WHypN3 / uDepthWHypN3) + (tSeepO2WHypN3 / uDepthWHypN3) ENDIF;
wPAbioDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE - wPMinDetWHypN3 - (tPSetDetHypN3 - tPSetDetEpiN3 - tPResusDetN3) / uDepthWHypN3 ENDIF;
wPAbioPO4WHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wPMinDetWHypN3 - wPSorpIMWHypN3 - (tPInfPO4WHypN3 / uDepthWHypN3) + ((tPSeepPO4WHypN3 + tPDifPO4HypN3 + tPResusPO4N3) / uDepthWHypN3) ENDIF;
wPAbioAIMWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (- tPSetAIMHypN3 +tPSetAIMEpiN3 + tPResusAIMN3) / uDepthWHypN3 + wPSorpIMWHypN3 ENDIF;
tPAbioTotTN3 = uPErosOMN3 - tPChemPO4N3 - tPInfPO4SN3 + tPSeepPO4SN3 - tPDifGroundPO4N3;
wNAbioNH4WHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNMinDetWHypN3 - wNNitrWHypN3 - (tNInfNH4WHypN3 / uDepthWHypN3) + ((tNSeepNH4WHypN3 + tNDifNH4HypN3 + tNResusNH4N3) / uDepthWHypN3) ENDIF;
wNAbioNO3WHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNNitrWHypN3 - wNDenitWHypN3 + ((tNDifNO3HypN3 + tNResusNO3N3 - tNInfNO3WHypN3 + tNSeepNO3WHypN3) / uDepthWHypN3) ENDIF;
wNAbioDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE - wNMinDetWHypN3 - (tNSetDetHypN3 -tNSetDetEpiN3 - tNResusDetN3 ) / uDepthWHypN3 ENDIF;
wSiAbioSiO2WHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wSiMinDetWHypN3 + (1.0 - fRefrDetSN3) * tSiMinDetSN3 / uDepthWHypN3 - tInfSiO2WHypN3 / uDepthWHypN3 + tSeepSiO2WHypN3 / uDepthWHypN3 ENDIF;
wSiAbioDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE - wSiMinDetWHypN3 - (tSiSetDetHypN3 -tSiSetDetEpiN3 - tSiResusDetN3) / uDepthWHypN3 ENDIF;
wDAbioDetWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (- tDSetDetHypN3 + tDSetDetEpiN3 + tDResusDetN3 ) / uDepthWHypN3 - wDMinDetWHypN3 ENDIF;
wDAbioIMWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (uDErosIMWN3 * fHypErosIMN3 - tDSetIMHypN3+ tDSetIMEpiN3 + tDResusIMN3) / uDepthWHypN3 ENDIF;
wDAbioIMWEpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN (uDErosIMWN3 * (1- fHypErosIMN3) - tDSetIMEpiN3 ) / uDepthWEpiN3 ELSE (uDErosIMWN3 * (1- fHypErosIMN3) - tDSetIMEpiN3 + tDResusIMN3) / uDepthWEpiN3 ENDIF;
wDAbioDetWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN (- tDSetDetEpiN3 ) / uDepthWEpiN3 - wDMinDetWEpiN3 ELSE (- tDSetDetEpiN3 + tDResusDetN3 ) / uDepthWEpiN3 - wDMinDetWEpiN3 ENDIF;
tDAbioIMSN3 = IF ( aInclStratN3 EQ TRUE ) THEN uDErosIMSN3 + tDSetIMHypN3 - tDResusIMN3 ELSE uDErosIMSN3 + tDSetIMEpiN3 - tDResusIMN3 ENDIF ;
tDAbioDetSN3 = IF ( aInclStratN3 EQ TRUE ) THEN tDSetDetHypN3 - tDResusDetN3 - tDMinDetSN3 ELSE tDSetDetEpiN3 - tDResusDetN3 - tDMinDetSN3 ENDIF ;
tDAbioHumSN3 = uDErosOMN3 + fRefrDetSN3 * tDMinDetSN3 - tDMinHumSN3;
tDAbioTotTN3 = cDErosTotN3 - wDMinDetWEpiN3 * uDepthWEpiN3 - wDMinDetWHypN3 * uDepthWHypN3 - (1.0 - fRefrDetSN3) * tDMinDetSN3 - tDMinHumSN3;
wO2AbioWEpiN3 = IF (aInclStratN3 EQ FALSE) THEN tO2AerEpiN3 / uDepthWEpiN3 - wO2MinDetWEpiN3 - wO2NitrWEpiN3 - (tO2MinDetSN3 + tO2NitrSN3) / uDepthWEpiN3 - tInfO2WEpiN3/uDepthWEpiN3 + tSeepO2WEpiN3/uDepthWEpiN3 ELSE tO2AerEpiN3 / uDepthWEpiN3 - wO2MinDetWEpiN3 - wO2NitrWEpiN3 ENDIF;
wO2AbioMN3 = tO2AerMN3 / uDepthWMN3 - wO2MinDetWMN3 - wO2NitrWMN3 - (tO2MinDetSMN3 + tO2NitrSMN3) / uDepthWMN3  - tInfO2WMN3 /uDepthWMN3  + tSeepO2WMN3 /uDepthWMN3 ;
wPAbioDetWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN - wPMinDetWEpiN3 - (tPSetDetEpiN3 ) / uDepthWEpiN3 ELSE - wPMinDetWEpiN3 - (tPSetDetEpiN3 - tPResusDetN3) / uDepthWEpiN3 ENDIF;
wPAbioPO4WEpiN3 =IF (aInclStratN3 EQ TRUE ) THEN wPMinDetWEpiN3 - wPSorpIMWEpiN3 + (tPDifPO4EpiN3 / uDepthWEpiN3) ELSE wPMinDetWEpiN3 - wPSorpIMWEpiN3 + ((tPSeepPO4WEpiN3 - tPInfPO4WEpiN3 + tPDifPO4EpiN3 + tPResusPO4N3) / uDepthWEpiN3) ENDIF;
wPAbioAIMWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN (- tPSetAIMEpiN3 ) / uDepthWEpiN3 + wPSorpIMWEpiN3 ELSE (- tPSetAIMEpiN3 + tPResusAIMN3 ) / uDepthWEpiN3 + wPSorpIMWEpiN3 ENDIF;
tPAbioDetSN3 = IF ( aInclStratN3 EQ TRUE ) THEN - tPMinDetSN3 + tPSetDetHypN3 - tPResusDetN3 ELSE - tPMinDetSN3 + tPSetDetEpiN3 - tPResusDetN3 ENDIF ;
tPAbioHumSN3 = uPErosOMN3 + fRefrDetSN3 * tPMinDetSN3 - tPMinHumSN3;
tPAbioPO4SN3 = IF ( aInclStratN3 EQ TRUE ) THEN tPInfPO4WHypN3 - tPSeepPO4WHypN3 - tPInfPO4SN3 + tPSeepPO4SN3 + (1.0-fRefrDetSN3) * tPMinDetSN3 + tPMinHumSN3 - tPSorpIMSN3 - tPResusPO4N3 - tPDifPO4HypN3 - tPDifGroundPO4N3 - tPChemPO4N3 ELSE tPInfPO4WEpiN3 - tPSeepPO4WEpiN3 - tPInfPO4SN3 + tPSeepPO4SN3 + (1.0-fRefrDetSN3) * tPMinDetSN3 + tPMinHumSN3 - tPSorpIMSN3 - tPResusPO4N3 - tPDifPO4EpiN3 - tPDifGroundPO4N3 - tPChemPO4N3 ENDIF;
tPAbioAIMSN3 = IF ( aInclStratN3 EQ TRUE ) THEN tPSetAIMHypN3 - tPResusAIMN3 + tPSorpIMSN3 ELSE tPSetAIMEpiN3 - tPResusAIMN3 + tPSorpIMSN3 ENDIF;
wNAbioNH4WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wNMinDetWEpiN3 - wNNitrWEpiN3 + (tNDifNH4EpiN3 / uDepthWEpiN3) ELSE wNMinDetWEpiN3 - wNNitrWEpiN3 + ((tNSeepNH4WEpiN3 - tNInfNH4WEpiN3 + tNDifNH4EpiN3 + tNResusNH4N3) / uDepthWEpiN3) ENDIF;
wNAbioNO3WEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wNNitrWEpiN3 - wNDenitWEpiN3 + (tNDifNO3EpiN3 / uDepthWEpiN3) ELSE wNNitrWEpiN3 - wNDenitWEpiN3 + ((tNDifNO3EpiN3 + tNResusNO3N3 - tNInfNO3WEpiN3 + tNSeepNO3WEpiN3) / uDepthWEpiN3) ENDIF;
wNAbioDetWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN - wNMinDetWEpiN3 - (tNSetDetEpiN3) / uDepthWEpiN3 ELSE - wNMinDetWEpiN3 - (tNSetDetEpiN3 - tNResusDetN3 ) / uDepthWEpiN3 ENDIF;
tNAbioNH4SN3 = IF ( aInclStratN3 EQ TRUE ) THEN tNInfNH4WHypN3 - tNSeepNH4WHypN3 - tNInfNH4SN3 + tNSeepNH4SN3 + (1.0-fRefrDetSN3) * tNMinDetSN3 + tNMinHumSN3 - tNResusNH4N3 - tNDifNH4HypN3 - tNDifGroundNH4N3 - tNNitrSN3 ELSE tNInfNH4WEpiN3 - tNSeepNH4WEpiN3 - tNInfNH4SN3 + tNSeepNH4SN3 + (1.0-fRefrDetSN3) * tNMinDetSN3 + tNMinHumSN3 - tNResusNH4N3 - tNDifNH4EpiN3 - tNDifGroundNH4N3 - tNNitrSN3 ENDIF;
tNAbioNO3SN3 = IF ( aInclStratN3 EQ TRUE ) THEN tNInfNO3WHypN3 - tNSeepNO3WHypN3 - tNInfNO3SN3 + tNSeepNO3SN3 + tNNitrSN3 - tNDenitSN3 - tNResusNO3N3 - tNDifNO3HypN3 - tNDifGroundNO3N3 ELSE tNInfNO3WEpiN3 - tNSeepNO3WEpiN3 - tNInfNO3SN3 + tNSeepNO3SN3 + tNNitrSN3 - tNDenitSN3 - tNResusNO3N3 - tNDifNO3EpiN3 - tNDifGroundNO3N3 ENDIF;
tNAbioDetSN3 = IF ( aInclStratN3 EQ TRUE ) THEN - tNMinDetSN3 + tNSetDetHypN3 - tNResusDetN3 ELSE - tNMinDetSN3 + tNSetDetEpiN3 - tNResusDetN3 ENDIF ;
tNAbioHumSN3 = uNErosOMN3 + fRefrDetSN3 * tNMinDetSN3 - tNMinHumSN3;
tNAbioTotTN3 = uNErosOMN3 - tNDenitSN3 - wNDenitWEpiN3 * uDepthWEpiN3 - wNDenitWHypN3 * uDepthWHypN3 - tNInfNH4SN3 - tNInfNO3SN3 + tNSeepNH4SN3 + tNSeepNO3SN3 - tNDifGroundNO3N3 - tNDifGroundNH4N3;
wSiAbioSiO2WEpiN3 = IF (aInclStratN3 EQ FALSE ) THEN wSiMinDetWEpiN3 + (1.0 - fRefrDetSN3) * tSiMinDetSN3 / uDepthWEpiN3 - tInfSiO2WEpiN3 / uDepthWEpiN3 + tSeepSiO2WEpiN3 / uDepthWEpiN3 ELSE wSiMinDetWEpiN3 ENDIF;
wSiAbioDetWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN - wSiMinDetWEpiN3 - (tSiSetDetEpiN3 ) / uDepthWEpiN3 ELSE - wSiMinDetWEpiN3 - (tSiSetDetEpiN3 - tSiResusDetN3) / uDepthWEpiN3 ENDIF;
tSiAbioDetSN3 = IF ( aInclStratN3 EQ TRUE ) THEN - tSiMinDetSN3 + tSiSetDetHypN3 - tSiResusDetN3 ELSE - tSiMinDetSN3 + tSiSetDetEpiN3 - tSiResusDetN3 ENDIF;
tDProdSubVegEpiN3 = bfSubVegEpiN3 * tDProdVegEpiN3;
tDMortVegWEpiN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tDMortVegEpiN3;
tDMortVegSEpiN3 = tDMortVegEpiN3 - tDMortVegWEpiN3;
tDBedVegN3 = IF InclVegN3 EQ TRUE THEN tDMigrVegN3 + tDProdVegEpiN3 + tDProdVegHypN3- tDRespVegN3 - tDMortVegEpiN3 - tDMortVegHypN3 - tDGrazVegBirdN3 - tDManVegN3 ELSE 0.0 ENDIF;
tO2ProdVegEpiN3 = molO2molCN3 * cCPerDWN3 * tDProdVegEpiN3;
tO2RespVegWEpiN3 = molO2molCN3 * cCPerDWN3 * bfSubVegEpiN3 * tDRespVegN3 * aCorO2BODEpiN3;
tO2ProdVegSEpiN3 = MIN (tO2RespVegSN3, tO2ProdVegEpiN3);
tO2ProdVegWEpiN3 = MIN ( tO2ProdVegEpiN3 - tO2ProdVegSEpiN3, bfSubVegN3 * tO2ProdVegEpiN3) ;
tO2BedSN3 = tO2ProdVegSHypN3 + tO2ProdVegSEpiN3 - tO2RespVegSN3 + tO2UptNO3VegSN3;
tO2UptNO3VegWEpiN3 = O2PerNO3N3 * molO2molNN3 * bfSubVegN3 * tNUptNO3VegWEpiN3;
tPMortVegEpiN3 = rPDVegN3 * tDMortVegEpiN3;
tPMortVegPO4EpiN3 = fDissMortVegN3 * tPMortVegEpiN3;
tPMortVegPO4SEpiN3 = bfRootVegN3 * tPMortVegPO4EpiN3;
tPMortVegPO4WEpiN3 = tPMortVegPO4EpiN3 - tPMortVegPO4SEpiN3;
tPMortVegDetEpiN3 = tPMortVegEpiN3 - tPMortVegPO4EpiN3;
tPMortVegDetWEpiN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tPMortVegDetEpiN3;
tPMortVegDetSEpiN3 = tPMortVegDetEpiN3 - tPMortVegDetWEpiN3;
tPBedVegN3 = IF InclVegN3 EQ TRUE THEN tPMigrVegN3 + tPUptVegEpiN3 + tPUptVegHypN3 - tPExcrVegN3 - tPMortVegEpiN3 - tPMortVegHypN3 - tPGrazVegBirdN3 - tPManVegN3 ELSE 0.0 ENDIF;
tNMortVegNH4WEpiN3 = tNMortVegNH4EpiN3 - tNMortVegNH4SEpiN3;
tNMortVegDetEpiN3 = tNMortVegEpiN3 - tNMortVegNH4EpiN3;
tNMortVegDetWEpiN3 = fDetWMortVegN3 * (1.0 - bfRootVegN3) * tNMortVegDetEpiN3;
tNMortVegDetSEpiN3 = tNMortVegDetEpiN3 - tNMortVegDetWEpiN3;
tNBedVegN3 = IF InclVegN3 EQ TRUE THEN tNMigrVegN3 + tNUptVegN3 - tNExcrVegN3 - tNMortVegEpiN3 - tNMortVegHypN3 - tNGrazVegBirdN3 - tNManVegN3 ELSE 0.0 ENDIF;
wDBedDetWEpiN3 = IF (InclVegN3 EQ TRUE) THEN (tDMortVegWEpiN3 + tDEgesBirdN3) / uDepthWEpiN3 ELSE 0.0 ENDIF;
tDBedDetSEpiN3 = IF ( InclVegN3 EQ TRUE) THEN tDMortVegSEpiN3 ELSE 0.0 ENDIF;
wPBedPO4WEpiN3 = IF (InclVegN3 EQ FALSE) THEN 0.0 ELSE (- tPUptVegWEpiN3 + tPExcrVegWN3 * uVegHeightEpiN3 / uVegHeightN3 + tPMortVegPO4WEpiN3 + tPEgesBirdPO4N3) /uDepthWEpiN3 ENDIF;
wPBedDetWEpiN3 = IF (InclVegN3 EQ TRUE) THEN (tPMortVegDetWEpiN3 + tPEgesBirdDetN3) / uDepthWEpiN3 ELSE 0.0 ENDIF;
tPBedPO4SN3 = IF ( InclVegN3 EQ TRUE) THEN - tPUptVegSN3 + tPExcrVegSN3 + tPMortVegPO4SEpiN3 + tPMortVegPO4SHypN3 ELSE 0.0 ENDIF;
tPBedDetSN3 = IF (InclVegN3 EQ TRUE) THEN tPMortVegDetSEpiN3 + tPMortVegDetSHypN3 ELSE 0.0 ENDIF;
wNBedNH4WEpiN3 = IF ( InclVegN3 EQ TRUE ) THEN (- tNUptNH4VegWEpiN3 + tNExcrVegWN3 * (uVegHeightEpiN3 /uVegHeightN3 ) + tNMortVegNH4WEpiN3 + tNEgesBirdNH4N3) / uDepthWEpiN3 ELSE 0.0 ENDIF;
wNBedNO3WEpiN3 = IF ( InclVegN3 EQ TRUE) THEN - tNUptNO3VegWEpiN3 / uDepthWEpiN3 ELSE 0.0 ENDIF;
wNBedDetWEpiN3 = IF (InclVegN3 EQ TRUE) THEN (tNMortVegDetWEpiN3 + tNEgesBirdDetN3) / uDepthWEpiN3 ELSE 0.0 ENDIF;
tNBedNH4SN3 = IF ( InclVegN3 EQ TRUE) THEN - tNUptNH4VegSN3 + tNExcrVegSN3 + tNMortVegNH4SEpiN3 + tNMortVegNH4SHypN3 ELSE 0.0 ENDIF;
tNBedNO3SN3 = IF ( InclVegN3 EQ TRUE ) THEN - tNUptNO3VegSN3 ELSE 0.0 ENDIF;
tNBedDetSN3 = IF ( InclVegN3 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN3 EQ TRUE) THEN tNMortVegDetSEpiN3 + tNMortVegDetSHypN3 ELSE tNMortVegDetSEpiN3 ENDIF;
tO2BedWEpiN3 = IF ( InclVegN3 EQ TRUE ) THEN tO2ProdVegWEpiN3 - tO2RespVegWEpiN3 + tO2UptNO3VegWEpiN3 ELSE 0.0 ENDIF;
rPDBlueWEpiN3 = oPBlueWEpiN3 /(oDBlueWEpiN3+NearZeroN3);
aVPUptMaxCrBlueEpiN3 = MAX(0.0,cVPUptMaxBlueN3 * uFunTmProdBlueEpiN3 *(cPDBlueMaxN3 - rPDBlueWEpiN3) /(cPDBlueMaxN3 - cPDBlueMinN3));
aVPUptBlueEpiN3 = oPO4WEpiN3 * aVPUptMaxCrBlueEpiN3 /(aVPUptMaxCrBlueEpiN3 / cAffPUptBlueN3 + oPO4WEpiN3);
wPUptBlueEpiN3 = aVPUptBlueEpiN3 * oDBlueWEpiN3;
rNDBlueWEpiN3 = oNBlueWEpiN3 /(oDBlueWEpiN3+NearZeroN3);
aVNUptMaxCrBlueEpiN3 = MAX(0.0,cVNUptMaxBlueN3 * uFunTmProdBlueEpiN3 * (cNDBlueMaxN3 - rNDBlueWEpiN3) /(cNDBlueMaxN3 - cNDBlueMinN3));
ahNUptBlueEpiN3 = aVNUptMaxCrBlueEpiN3 / cAffNUptBlueN3;
aVNUptBlueEpiN3 = oNDissWEpiN3 * aVNUptMaxCrBlueEpiN3 /(ahNUptBlueEpiN3 + oNDissWEpiN3);
wNUptBlueEpiN3 = aVNUptBlueEpiN3 * oDBlueWEpiN3;
tNUptBlueEpiN3 = wNUptBlueEpiN3 * uDepthWEpiN3;
aLLimBlueEpiN3 = UseSteeleBlueN3 *(EXP(1.0) /(aExtCoefEpiN3 * uDepthWEpiN3) *(EXP(- aLPARBotEpiN3 /(cLOptRefBlueN3 * uFunTmProdBlueEpiN3)) - EXP(- aLPARBotSurfN3 /(cLOptRefBlueN3 * uFunTmProdBlueEpiN3)))) +(1.0 - UseSteeleBlueN3) *(1.0 /(aExtCoefEpiN3 * uDepthWEpiN3) * LN((1.0 + aLPARBotSurfN3 / (hLRefBlueN3 * uFunTmProdBlueEpiN3)) / (1.0 + aLPARBotEpiN3 /(hLRefBlueN3 * uFunTmProdBlueEpiN3))));
rChDBlueEpiN3 = cChDBlueMaxN3 -(cChDBlueMaxN3 - cChDBlueMinN3) * aLLimBlueEpiN3;
aChlaBlueEpiN3 = mgPergN3 * rChDBlueEpiN3 * aDBlueWEpiN3;
aNfixBlueEpiN3 = rNfixBlueEpiN3 *aChlaBlueEpiN3 /ugPergN3;
afNH4UptBlueEpiN3 = oNH4WEpiN3 * oNO3WEpiN3 /((ahNUptBlueEpiN3 + oNH4WEpiN3) *(ahNUptBlueEpiN3 + oNO3WEpiN3)) + oNH4WEpiN3 * ahNUptBlueEpiN3 /((oNH4WEpiN3 + oNO3WEpiN3) *(ahNUptBlueEpiN3 + oNO3WEpiN3));
tNUptBlueAirEpiN3 = IF (InclNfixN3 EQ FALSE) THEN 0.0 ELSE aNfixBlueEpiN3 ENDIF;
tNUptBlueWEpiN3 = IF (InclNfixN3 EQ FALSE) THEN tNUptBlueEpiN3 ELSE tNUptBlueEpiN3 - tNUptBlueAirEpiN3 ENDIF;
wNUptBlueWEpiN3 = tNUptBlueWEpiN3 / uDepthWEpiN3;
wNUptNH4BlueEpiN3 = afNH4UptBlueEpiN3 * wNUptBlueWEpiN3;
wNUptNO3BlueEpiN3 = wNUptBlueWEpiN3 - wNUptNH4BlueEpiN3;
aPLimBlueEpiN3 = MAX(0.0,(1.0 - cPDBlueMinN3 / rPDBlueWEpiN3) * cPDBlueMaxN3 /(cPDBlueMaxN3 - cPDBlueMinN3));
aNLimBlueEpiN3 = MAX(0.0,(1.0 - cNDBlueMinN3 / rNDBlueWEpiN3) * cNDBlueMaxN3 /(cNDBlueMaxN3 - cNDBlueMinN3));
aSiLimBlueEpiN3 = oSiO2WEpiN3 /(hSiAssBlueN3 + oSiO2WEpiN3);
aMuTmLBlueEpiN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimBlueEpiN3 * uMuMaxTmBlueEpiN3;
aNutLimBlueEpiN3 = MIN(aPLimBlueEpiN3 , (MIN(aNLimBlueEpiN3,aSiLimBlueEpiN3)));
aMuBlueEpiN3 = aNutLimBlueEpiN3 * aMuTmLBlueEpiN3;
wDAssBlueEpiN3 = aMuBlueEpiN3*oDBlueWEpiN3;
oChlaBlueEpiN3 = mgPergN3 * rChDBlueEpiN3 * oDBlueWEpiN3;
aLLimBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN -9999 ELSE MAX(0.0,UseSteeleBlueN3 *(EXP(1.0) /(aExtSurfN3) *(EXP(- aLPARBotSurfN3/(cLOptRefBlueN3 *  uFunTmProdBlueSurfN3)) - EXP(- uLPARSurfN3 /(cLOptRefBlueN3 *  uFunTmProdBlueSurfN3)))) +(1.0 - UseSteeleBlueN3) *(1.0 /(aExtSurfN3) * LN((1.0 + uLPARSurfN3 / (hLRefBlueN3 * uFunTmProdBlueSurfN3)) / (1.0 + aLPARBotSurfN3 /(hLRefBlueN3 * uFunTmProdBlueSurfN3))))) ENDIF;
aRepLLimBlueN3 = (aLLimBlueSurfN3* aDBlueSurfN3 + aLLimBlueEpiN3* aDBlueWEpiN3) / (aDBlueSurfN3 + aDBlueWEpiN3);
rChDBlueSurfN3 = cChDBlueMaxN3 -(cChDBlueMaxN3 - cChDBlueMinN3) * aLLimBlueSurfN3;
aChlaBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE mgPergN3 * rChDBlueSurfN3 * aDBlueSurfN3 ENDIF;
oChlaBlueWN3 = IF ( aInclStratN3 EQ TRUE ) THEN (oChlaBlueEpiN3 * uDepthWEpiN3 + oChlaBlueHypN3 * uDepthWHypN3) / uDepthWN3 ELSE (oChlaBlueEpiN3 * uDepthWEpiN3) / uDepthWN3 ENDIF;
oChlaBlueN3 = IF ( aInclStratN3 EQ TRUE ) THEN (oChlaBlueEpiN3 * uDepthWEpiN3 + oChlaBlueHypN3 * uDepthWHypN3 + aChlaBlueSurfN3) / uDepthWN3 ELSE (oChlaBlueEpiN3 * uDepthWEpiN3 + aChlaBlueSurfN3 ) / uDepthWN3 ENDIF;
aChlaLimFloBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE (1.0 - (POW ((aChlaBlueSurfN3 / cDepthSurfN3) , (-cStepPowN3))) / ((POW (cChlaThrBlueN3 , (-cStepPowN3))) + (POW ((aChlaBlueSurfN3 / cDepthSurfN3) , (-cStepPowN3))))) ENDIF;
aChlaLimFloBlueEpiN3 = IF (InclSurfN3 EQ FALSE  OR aDBlueWEpiN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE (1.0 - (POW (oChlaBlueEpiN3 , (-cStepPowN3))) / ((POW (cChlaThrBlueN3 , (-cStepPowN3))) + (POW (oChlaBlueEpiN3 , (-cStepPowN3))))) ENDIF;
aChlaLimFloBlueHypN3 = IF (aInclStratN3 EQ FALSE OR aDBlueWHypN3 LT cDBlueSurfMinN3) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (oChlaBlueHypN3 , (-cStepPowN3))) / ((POW (cChlaThrBlueN3 , (-cStepPowN3))) + (POW (oChlaBlueHypN3 , (-cStepPowN3))))) ENDIF;
aVWLimFloBlueN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uVWindN3 , cStepPowN3)) / ((POW (cVWindThrBlueN3 , cStepPowN3)) + (POW (uVWindN3 , cStepPowN3)))) ENDIF;
aTmLimFloBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE (1.0 - (POW (uTmSurfN3 , (-cStepPowN3))) / ((POW (cTmThrBlueN3 , (-cStepPowN3))) + (POW (uTmSurfN3 , (-cStepPowN3))))) ENDIF;
aTmLimFloBlueEpiN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE (1.0 - (POW (uTmEpiN3 , (-cStepPowN3))) / ((POW (cTmThrBlueN3 , (-cStepPowN3))) + (POW (uTmEpiN3 , (-cStepPowN3))))) ENDIF;
aTmLimFloBlueHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uTmHypN3 , (-cStepPowN3))) / ((POW (cTmThrBlueN3 , (-cStepPowN3))) + (POW (uTmHypN3 , (-cStepPowN3))))) ENDIF;
aTrigFloBlueSurfN3 =  aVWLimFloBlueN3 * aTmLimFloBlueSurfN3 * aChlaLimFloBlueSurfN3;
aTrigFloBlueEpiN3 =  aVWLimFloBlueN3 * aTmLimFloBlueEpiN3 * aChlaLimFloBlueEpiN3;
aTrigFloBlueHypN3 =   aTmLimFloBlueHypN3 * aChlaLimFloBlueHypN3;
uVFloBlueSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE aTrigFloBlueSurfN3 * cVFloMaxBlueWN3 ENDIF;
uVFloBlueEpiN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueEpiN3 * cVFloMaxBlueWN3 ENDIF;
uVFloBlueHypN3 =  IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueHypN3 * cVFloMaxBlueWN3 ENDIF;
uVBlueHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE) THEN  - uCorVSetBlueHypN3 ELSE  uVFloBlueHypN3 - uCorVSetBlueHypN3  ENDIF;
tDSetBlueHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN3 LT 0.0) THEN - uVBlueHypN3 * oDBlueWHypN3 ELSE 0.0 ENDIF;
tPSetBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN3 * tDSetBlueHypN3 ENDIF;
tNSetBlueHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN3 * tDSetBlueHypN3 ENDIF;
tDFloBlueHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN3 GE 0.0) THEN uVBlueHypN3 * oDBlueWHypN3 ELSE 0.0 ENDIF;
tPFloBlueHypN3 =  tDFloBlueHypN3  * rPDBlueWHypN3;
tNFloBlueHypN3 =  tDFloBlueHypN3  * rNDBlueWHypN3;
uVBlueEpiN3 = IF (InclSurfN3 EQ TRUE) THEN uVFloBlueEpiN3 - uCorVSetBlueEpiN3 ELSE - uCorVSetBlueEpiN3 ENDIF;
tDSetBlueEpiN3 = IF (uVBlueEpiN3 LT 0.0) THEN - uVBlueEpiN3 * oDBlueWEpiN3 ELSE 0.0 ENDIF;
tDFloBlueEpiN3 = IF (uVBlueEpiN3 GE 0.0) THEN uVBlueEpiN3 * oDBlueWEpiN3 ELSE 0.0 ENDIF;
tNSetBlueEpiN3 = rNDBlueWEpiN3 * tDSetBlueEpiN3;
tNFloBlueEpiN3 =  tDFloBlueEpiN3  * rNDBlueWEpiN3;
tPSetBlueEpiN3 = rPDBlueWEpiN3 * tDSetBlueEpiN3;
tPFloBlueEpiN3 =  tDFloBlueEpiN3  * rPDBlueWEpiN3;
aFunTauSetOMSurfN3 =MIN(1.0 / POW(aFunDimSuspN3 +NearZeroN3 , (0.5)), 1.0);
uFunTmSetSurfN3 = POW(cThetaSetN3 , (uTmSurfN3-cTmRefN3));
uCorVSetBlueSurfN3 = (cVSetBlueN3 + uQOutInfN3 /mmPermN3 - uQInSeepN3 / mmPermN3) * aFunTauSetOMSurfN3 * uFunTmSetSurfN3;
uVBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN - uCorVSetBlueSurfN3 ELSE uVFloBlueSurfN3 - uCorVSetBlueSurfN3 ENDIF;
tDSetBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSEIF (uVBlueSurfN3 LT 0.0) THEN aDBlueSurfN3  / cDepthSurfN3 * (- uVBlueSurfN3) ELSE 0.0 ENDIF;
rNDBlueSurfN3 = aNBlueSurfN3 / (aDBlueSurfN3 + NearZeroN3);
tNSetBlueSurfN3 = rNDBlueSurfN3 * tDSetBlueSurfN3;
rPDBlueSurfN3 = aPBlueSurfN3 / (aDBlueSurfN3 + NearZeroN3);
tPSetBlueSurfN3 = rPDBlueSurfN3 * tDSetBlueSurfN3;
rPDGrenWHypN3 = oPGrenWHypN3 /(oDGrenWHypN3+NearZeroN3);
aVPUptMaxCrGrenHypN3 = MAX(0.0,cVPUptMaxGrenN3 * uFunTmProdGrenHypN3 *(cPDGrenMaxN3 - rPDGrenWHypN3) /(cPDGrenMaxN3 - cPDGrenMinN3));
aVPUptGrenHypN3 = oPO4WHypN3 * aVPUptMaxCrGrenHypN3 /(aVPUptMaxCrGrenHypN3 / cAffPUptGrenN3 + oPO4WHypN3);
wPUptGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aVPUptGrenHypN3 * oDGrenWHypN3 ENDIF;
wPUptPhytHypN3 = wPUptDiatHypN3 + wPUptGrenHypN3 + wPUptBlueHypN3;
wPExcrGrenWHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE (2.0 *rPDGrenWHypN3) /(cPDGrenMaxN3 + rPDGrenWHypN3) * rPDGrenWHypN3 * wDRespGrenWHypN3 ENDIF;
wPExcrPhytWHypN3 = wPExcrDiatWHypN3 + wPExcrGrenWHypN3 + wPExcrBlueWHypN3;
aPLimGrenHypN3 = MAX(0.0,(1.0 - cPDGrenMinN3 / rPDGrenWHypN3) * cPDGrenMaxN3 /(cPDGrenMaxN3 - cPDGrenMinN3));
aNutLimGrenHypN3 = MIN(aPLimGrenHypN3,(MIN(aNLimGrenHypN3,aSiLimGrenHypN3)));
aMuGrenHypN3 = aNutLimGrenHypN3 * aMuTmLGrenHypN3;
wDAssGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE aMuGrenHypN3*oDGrenWHypN3 ENDIF;
wDPrimGrenWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wDAssGrenHypN3 - wDRespGrenWHypN3 - wDLossGrenHypN3 - wDMortGrenWHypN3 -(tDSetGrenHypN3 -tDSetGrenEpiN3 - tDResusGrenN3) / uDepthWHypN3 ENDIF;
wDAssPhytHypN3 = wDAssDiatHypN3 + wDAssGrenHypN3 + wDAssBlueHypN3;
wO2ProdPhytHypN3 = molO2molCN3 * cCPerDWN3 * wDAssPhytHypN3;
wO2PrimWHypN3 = wO2ProdPhytHypN3 - wO2RespPhytWHypN3 + wO2UptNO3PhytHypN3;
wPLossGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN3 * wDLossGrenHypN3 ENDIF;
wPLossPhytHypN3 = wPLossDiatHypN3 + wPLossGrenHypN3 + wPLossBlueHypN3;
wPLossPhytPO4HypN3 = fDissLossN3 * wPLossPhytHypN3;
wPLossPhytDetHypN3 = wPLossPhytHypN3 - wPLossPhytPO4HypN3;
wPPrimDetWHypN3 = wPLossPhytDetHypN3 + wPMortPhytDetWHypN3;
wPPrimPO4WHypN3 = - wPUptPhytHypN3 + wPExcrPhytWHypN3 + wPLossPhytPO4HypN3 + wPMortPhytPO4WHypN3;
tPSetGrenHypN3 =IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN3 * tDSetGrenHypN3 ENDIF;
wPPrimGrenWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wPUptGrenHypN3 - wPExcrGrenWHypN3 - wPLossGrenHypN3 - wPMortGrenWHypN3 -(tPSetGrenHypN3 -tPSetGrenEpiN3 - tPResusGrenN3) / uDepthWHypN3 ENDIF;
wPConsGrenZooHypN3 = rPDGrenWHypN3 * wDConsGrenZooHypN3;
wPConsPhytZooHypN3 = wPConsDiatZooHypN3 + wPConsGrenZooHypN3 + wPConsBlueZooHypN3;
wPConsZooHypN3 = wPConsPhytZooHypN3 + wPConsDetZooHypN3;
wPAssZooHypN3 = afPAssZooHypN3 * wPConsZooHypN3;
wPEgesZooHypN3 = wPConsZooHypN3 - wPAssZooHypN3;
wPEgesZooPO4HypN3 = fDissEgesZooN3*wPEgesZooHypN3;
wPEgesZooDetHypN3 = wPEgesZooHypN3 - wPEgesZooPO4HypN3;
aPConsZooSpHypN3 = wPConsZooHypN3 / oPZooHypN3;
aPGrazSpHypN3 = wPConsZooHypN3 / oPOMWHypN3;
wDPrimBlueWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wDAssBlueHypN3 - wDRespBlueWHypN3 - wDLossBlueHypN3 - wDMortBlueWHypN3 + (tDResusBlueN3 + tDSetBlueEpiN3 - tDSetBlueHypN3 - tDFloBlueHypN3) / uDepthWHypN3 ENDIF;
wPPrimBlueWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wPUptBlueHypN3 - wPExcrBlueWHypN3 - wPLossBlueHypN3 - wPMortBlueWHypN3+ (tPResusBlueN3 + tPSetBlueEpiN3 - tPSetBlueHypN3 - tPFloBlueHypN3) / uDepthWHypN3 ENDIF;
wNPrimBlueWHypN3 = IF (aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNUptBlueHypN3 - wNExcrBlueWHypN3 - wNLossBlueHypN3 - wNMortBlueWHypN3+ (tNResusBlueN3 + tNSetBlueEpiN3 - tNSetBlueHypN3 - tNFloBlueHypN3) / uDepthWHypN3 ENDIF;
tDSetPhytHypN3 = tDSetDiatHypN3 + tDSetGrenHypN3 + tDSetBlueHypN3;
wDPrimPhytWHypN3 = wDPrimDiatWHypN3 + wDPrimGrenWHypN3 + wDPrimBlueWHypN3;
tPSetPhytHypN3 = tPSetDiatHypN3 + tPSetGrenHypN3 + tPSetBlueHypN3;
wPPrimPhytWHypN3 = wPPrimDiatWHypN3 + wPPrimGrenWHypN3 + wPPrimBlueWHypN3;
tNSetPhytHypN3 = tNSetDiatHypN3 + tNSetGrenHypN3 + tNSetBlueHypN3;
wNPrimPhytWHypN3 = wNPrimDiatWHypN3 + wNPrimGrenWHypN3 + wNPrimBlueWHypN3;
tDSetTotHypN3 = tDSetIMHypN3 + tDSetDetHypN3 + tDSetPhytHypN3;
tPSetTotHypN3 = tPSetAIMHypN3 + tPSetDetHypN3 + tPSetPhytHypN3;
tNSetTotHypN3 = tNSetDetHypN3 + tNSetPhytHypN3;
aLLimGrenEpiN3 = UseSteeleGrenN3 *(EXP(1.0) /(aExtCoefEpiN3 * uDepthWEpiN3) *(EXP(- aLPARBotEpiN3 /(cLOptRefGrenN3 * uFunTmProdGrenEpiN3)) - EXP(- aLPARBotSurfN3 /(cLOptRefGrenN3 * uFunTmProdGrenEpiN3)))) +(1.0 - UseSteeleGrenN3) *(1.0 /(aExtCoefEpiN3 * uDepthWEpiN3) * LN((1.0 + aLPARBotSurfN3 / (hLRefGrenN3 * uFunTmProdGrenEpiN3)) / (1.0 + aLPARBotEpiN3 /(hLRefGrenN3 * uFunTmProdGrenEpiN3))));
rChDGrenEpiN3 = cChDGrenMaxN3 -(cChDGrenMaxN3 - cChDGrenMinN3) * aLLimGrenEpiN3;
oChlaGrenEpiN3 = mgPergN3 * rChDGrenEpiN3 * oDGrenWEpiN3;
aLLimDiatEpiN3 = UseSteeleDiatN3 *(EXP(1.0) /(aExtCoefEpiN3 * uDepthWEpiN3) *(EXP(- aLPARBotEpiN3 /(cLOptRefDiatN3 * uFunTmProdDiatEpiN3)) - EXP(- aLPARBotSurfN3 /(cLOptRefDiatN3 * uFunTmProdDiatEpiN3)))) +(1.0 - UseSteeleDiatN3) *(1.0 /(aExtCoefEpiN3 * uDepthWEpiN3) * LN((1.0 + aLPARBotSurfN3 / (hLRefDiatN3 * uFunTmProdDiatEpiN3)) / (1.0 + aLPARBotEpiN3 /(hLRefDiatN3 * uFunTmProdDiatEpiN3))));
rChDDiatEpiN3 = cChDDiatMaxN3 -(cChDDiatMaxN3 - cChDDiatMinN3) * aLLimDiatEpiN3;
oChlaDiatEpiN3 = mgPergN3 * rChDDiatEpiN3 * oDDiatWEpiN3;
oChlaEpiN3 = oChlaDiatEpiN3 + oChlaGrenEpiN3 + oChlaBlueEpiN3;
wDRespBlueWEpiN3 = ukDRespTmBlueEpiN3 * oDBlueWEpiN3;
wDLossBlueEpiN3 = ukLossTmBlueEpiN3 * oDBlueWEpiN3;
wDMortBlueWEpiN3 = kMortBlueWN3 * oDBlueWEpiN3;
ukDDecBlueEpiN3 = ukDRespTmBlueEpiN3 + ukLossTmBlueEpiN3 + kMortBlueWN3 +(uCorVSetBlueEpiN3 * uFunTmSetEpiN3) / uDepthWEpiN3;
wPExcrBlueWEpiN3 = (rPDBlueWEpiN3 * 2.0 )/(cPDBlueMaxN3 + rPDBlueWEpiN3) * rPDBlueWEpiN3 * wDRespBlueWEpiN3 ;
wPLossBlueEpiN3 = rPDBlueWEpiN3 * wDLossBlueEpiN3;
wPMortBlueWEpiN3 = kMortBlueWN3 * oPBlueWEpiN3;
wNExcrBlueWEpiN3 = (rNDBlueWEpiN3 *2.0)/(cNDBlueMaxN3 + rNDBlueWEpiN3) * rNDBlueWEpiN3 * wDRespBlueWEpiN3 ;
wNLossBlueEpiN3 = rNDBlueWEpiN3 * wDLossBlueEpiN3;
wNMortBlueWEpiN3 = kMortBlueWN3 * oNBlueWEpiN3;
wDPrimBlueWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wDAssBlueEpiN3 - wDRespBlueWEpiN3 - wDLossBlueEpiN3 - wDMortBlueWEpiN3 + (tDSetBlueSurfN3-tDFloBlueEpiN3 + tDFloBlueHypN3- tDSetBlueEpiN3 ) / uDepthWEpiN3 ELSE wDAssBlueEpiN3 - wDRespBlueWEpiN3 - wDLossBlueEpiN3 - wDMortBlueWEpiN3 + (tDResusBlueN3 + tDSetBlueSurfN3 - tDSetBlueEpiN3 -  tDFloBlueEpiN3) / uDepthWEpiN3 ENDIF;
wPPrimBlueWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wPUptBlueEpiN3 - wPExcrBlueWEpiN3 - wPLossBlueEpiN3 - wPMortBlueWEpiN3+ (tPSetBlueSurfN3-tPFloBlueEpiN3 + tPFloBlueHypN3- tPSetBlueEpiN3 ) / uDepthWEpiN3 ELSE wPUptBlueEpiN3 - wPExcrBlueWEpiN3 - wPLossBlueEpiN3 - wPMortBlueWEpiN3+ (tPResusBlueN3 + tPSetBlueSurfN3 - tPSetBlueEpiN3 -  tPFloBlueEpiN3) / uDepthWEpiN3 ENDIF;
wNPrimBlueWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wNUptBlueEpiN3 - wNExcrBlueWEpiN3 - wNLossBlueEpiN3 - wNMortBlueWEpiN3 + (tNSetBlueSurfN3-tNFloBlueEpiN3 + tNFloBlueHypN3- tNSetBlueEpiN3 ) / uDepthWEpiN3 ELSE wNUptBlueEpiN3 - wNExcrBlueWEpiN3 - wNLossBlueEpiN3 - wNMortBlueWEpiN3+ (tNResusBlueN3 + tNSetBlueSurfN3 - tNSetBlueEpiN3 -  tNFloBlueEpiN3) / uDepthWEpiN3 ENDIF;
ukDilSurfN3 = ukOutEpiN3;
tDDilBlueSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE ukDilSurfN3 * aDBlueSurfN3 ENDIF;
tNDilBlueSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE ukDilSurfN3 * aNBlueSurfN3 ENDIF;
tPDilBlueSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE ukDilSurfN3 * aPBlueSurfN3 ENDIF;
tDTranBlueSurfN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE uDLoadBlueSurfN3 - tDDilBlueSurfN3 ENDIF;
tPTranBlueSurfN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE uPLoadBlueSurfN3 - tPDilBlueSurfN3 ENDIF;
tNTranBlueSurfN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSEIF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE uNLoadBlueSurfN3 - tNDilBlueSurfN3 ENDIF;
uMuMaxTmBlueSurfN3 = cMuMaxBlueN3 * uFunTmProdBlueSurfN3;
aMuTmLBlueSurfN3 = ufDayN3 * aLLimBlueSurfN3 * uMuMaxTmBlueSurfN3;
aPLimBlueSurfN3 = MAX(0.0,(1.0 - cPDBlueMinN3 / rPDBlueSurfN3) * cPDBlueMaxN3 /(cPDBlueMaxN3 - cPDBlueMinN3));
aNLimBlueSurfN3 = MAX(0.0,(1.0 - cNDBlueMinN3 / rNDBlueSurfN3) * cNDBlueMaxN3 /(cNDBlueMaxN3 - cNDBlueMinN3));
aSiLimBlueSurfN3 = oSiO2WEpiN3 /(hSiAssBlueN3 + oSiO2WEpiN3);
aNutLimBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN -9999 ELSE MIN(aPLimBlueSurfN3,MIN(aNLimBlueSurfN3,aSiLimBlueSurfN3)) ENDIF;
aRepPLimBlueN3 = (aPLimBlueSurfN3* aDBlueSurfN3 + aPLimBlueEpiN3* aDBlueWEpiN3) / (aDBlueSurfN3 + aDBlueWEpiN3);
aRepNLimBlueN3 = (aNLimBlueSurfN3* aDBlueSurfN3 + aNLimBlueEpiN3* aDBlueWEpiN3) / (aDBlueSurfN3 + aDBlueWEpiN3);
aRepNutLimBlueN3 = (aNutLimBlueSurfN3* aDBlueSurfN3 + aNutLimBlueEpiN3* aDBlueWEpiN3) / (aDBlueSurfN3 + aDBlueWEpiN3);
aMuBlueSurfN3 = aNutLimBlueSurfN3 * aMuTmLBlueSurfN3;
tDAssBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE aMuBlueSurfN3 * aDBlueSurfN3 ENDIF;
aVNUptMaxCrBlueSurfN3 = MAX(0.0,cVNUptMaxBlueN3 * uFunTmProdBlueSurfN3 * (cNDBlueMaxN3 - rNDBlueSurfN3) /(cNDBlueMaxN3 - cNDBlueMinN3));
aVPUptMaxCrBlueSurfN3 = MAX(0.0,cVPUptMaxBlueN3 * uFunTmProdBlueSurfN3 *(cPDBlueMaxN3 - rPDBlueSurfN3) /(cPDBlueMaxN3 - cPDBlueMinN3));
ahNUptBlueSurfN3 = aVNUptMaxCrBlueSurfN3 / cAffNUptBlueN3;
aVNUptBlueSurfN3 = oNDissWEpiN3 * aVNUptMaxCrBlueSurfN3 /(ahNUptBlueSurfN3 + oNDissWEpiN3);
aVPUptBlueSurfN3 = oPO4WEpiN3 * aVPUptMaxCrBlueSurfN3 /(aVPUptMaxCrBlueSurfN3 / cAffPUptBlueN3 + oPO4WEpiN3);
tNUptBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE aVNUptBlueSurfN3 * aDBlueSurfN3 ENDIF;
aNfixBlueSurfN3 = rNfixBlueSurfN3 *aChlaBlueSurfN3 /ugPergN3;
tNUptBlueAirSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSEIF (InclNfixN3 EQ FALSE) THEN 0.0 ELSE aNfixBlueSurfN3 ENDIF;
tNUptBlueWSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSEIF (InclNfixN3 EQ FALSE) THEN tNUptBlueSurfN3 ELSE tNUptBlueSurfN3 - tNUptBlueAirSurfN3 ENDIF;
afNH4UptBlueSurfN3 = oNH4WEpiN3 * oNO3WEpiN3 /((ahNUptBlueSurfN3 + oNH4WEpiN3) *(ahNUptBlueSurfN3 + oNO3WEpiN3)) + oNH4WEpiN3 * ahNUptBlueSurfN3 /((oNH4WEpiN3 + oNO3WEpiN3) *(ahNUptBlueSurfN3 + oNO3WEpiN3));
tNUptNH4BlueSurfN3 = afNH4UptBlueSurfN3 * tNUptBlueWSurfN3;
tNUptNO3BlueSurfN3 = tNUptBlueWSurfN3 - tNUptNH4BlueSurfN3;
tPUptBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE aVPUptBlueSurfN3 * aDBlueSurfN3 ENDIF;
tDRespBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE ukDRespTmBlueSurfN3 *aDBlueSurfN3 ENDIF;
tNExcrBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE (rNDBlueSurfN3 * 2.0 )/(cNDBlueMaxN3 + rNDBlueSurfN3) * rNDBlueSurfN3 * tDRespBlueSurfN3 ENDIF;
tPExcrBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE (rPDBlueSurfN3 * 2.0 )/(cPDBlueMaxN3 + rPDBlueSurfN3) * rPDBlueSurfN3 * tDRespBlueSurfN3 ENDIF;
tDMortBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE kMortBlueWN3 * aDBlueSurfN3 ENDIF;
tNMortBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE kMortBlueWN3 * aNBlueSurfN3 ENDIF;
wNMortBlueNH4WSurfN3 = fDissMortPhytN3 * tNMortBlueSurfN3 / uDepthWEpiN3;
wNMortBlueDetSurfN3 = ( 1 -fDissMortPhytN3) * tNMortBlueSurfN3 / uDepthWEpiN3;
tPMortBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE kMortBlueWN3 * aPBlueSurfN3 ENDIF;
uFunTmLossSurfN3 = EXP(-0.5/(cSigTmLossN3*cSigTmLossN3) *((uTmSurfN3-cTmOptLossN3)*(uTmSurfN3-cTmOptLossN3) -(cTmRefN3-cTmOptLossN3)*(cTmRefN3-cTmOptLossN3)));
ukLossTmBlueSurfN3 = UseLossN3 * kLossBlueN3 * uFunTmLossSurfN3;
tDLossBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE ukLossTmBlueSurfN3 * aDBlueSurfN3 ENDIF;
tPLossBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE rPDBlueSurfN3 * tDLossBlueSurfN3 ENDIF;
tNLossBlueSurfN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE rNDBlueSurfN3 * tDLossBlueSurfN3 ENDIF;
tDPrimBlueSurfN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE tDAssBlueSurfN3 - tDRespBlueSurfN3 + tDFloBlueEpiN3 - tDSetBlueSurfN3- tDMortBlueSurfN3 ENDIF;
tNPrimBlueSurfN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE tNUptBlueSurfN3 - tNExcrBlueSurfN3  + tNFloBlueEpiN3 - tNSetBlueSurfN3 - tNMortBlueSurfN3 ENDIF;
tPPrimBlueSurfN3 = IF (InclSurfN3 EQ FALSE) THEN 0.0 ELSE tPUptBlueSurfN3 - tPExcrBlueSurfN3 + tPFloBlueEpiN3 - tPSetBlueSurfN3- tPMortBlueSurfN3 ENDIF;
tDPrimBlueSN3 = IF ( aInclStratN3 EQ FALSE) THEN tDSetBlueEpiN3 - tDResusBlueN3 - tDMortBlueSN3 - tDRespBlueSN3 ELSE tDSetBlueHypN3 - tDResusBlueN3 - tDMortBlueSN3 - tDRespBlueSN3 ENDIF;
tPPrimBlueSN3 = IF ( aInclStratN3 EQ FALSE) THEN tPSetBlueEpiN3 - tPResusBlueN3 - tPMortBlueSN3 - tPExcrBlueSN3 ELSE tPSetBlueHypN3 - tPResusBlueN3 - tPMortBlueSN3 - tPExcrBlueSN3 ENDIF;
tNPrimBlueSN3 = IF (aInclStratN3 EQ FALSE) THEN tNSetBlueEpiN3 - tNResusBlueN3 - tNMortBlueSN3 - tNExcrBlueSN3 ELSE tNSetBlueHypN3 - tNResusBlueN3 - tNMortBlueSN3 - tNExcrBlueSN3 ENDIF;
aVPUptMaxCrGrenEpiN3 = MAX(0.0,cVPUptMaxGrenN3 * uFunTmProdGrenEpiN3 *(cPDGrenMaxN3 - rPDGrenWEpiN3) /(cPDGrenMaxN3 - cPDGrenMinN3));
aVPUptGrenEpiN3 = oPO4WEpiN3 * aVPUptMaxCrGrenEpiN3 /(aVPUptMaxCrGrenEpiN3 / cAffPUptGrenN3 + oPO4WEpiN3);
wPUptGrenEpiN3 = aVPUptGrenEpiN3 * oDGrenWEpiN3;
aVNUptMaxCrGrenEpiN3 = MAX(0.0,cVNUptMaxGrenN3 * uFunTmProdGrenEpiN3 * (cNDGrenMaxN3 - rNDGrenWEpiN3) /(cNDGrenMaxN3 - cNDGrenMinN3));
ahNUptGrenEpiN3 = aVNUptMaxCrGrenEpiN3 / cAffNUptGrenN3;
aVNUptGrenEpiN3 = oNDissWEpiN3 * aVNUptMaxCrGrenEpiN3 /(ahNUptGrenEpiN3 + oNDissWEpiN3);
wNUptGrenEpiN3 = aVNUptGrenEpiN3 * oDGrenWEpiN3;
afNH4UptGrenEpiN3 = oNH4WEpiN3 * oNO3WEpiN3 /((ahNUptGrenEpiN3 + oNH4WEpiN3) *(ahNUptGrenEpiN3 + oNO3WEpiN3)) + oNH4WEpiN3 * ahNUptGrenEpiN3 /((oNH4WEpiN3 + oNO3WEpiN3) *(ahNUptGrenEpiN3 + oNO3WEpiN3));
wNUptNH4GrenEpiN3 = afNH4UptGrenEpiN3 * wNUptGrenEpiN3;
wNUptNO3GrenEpiN3 = wNUptGrenEpiN3 - wNUptNH4GrenEpiN3;
aPLimGrenEpiN3 = MAX(0.0,(1.0 - cPDGrenMinN3 / rPDGrenWEpiN3) * cPDGrenMaxN3 /(cPDGrenMaxN3 - cPDGrenMinN3));
aNLimGrenEpiN3 = MAX(0.0,(1.0 - cNDGrenMinN3 / rNDGrenWEpiN3) * cNDGrenMaxN3 /(cNDGrenMaxN3 - cNDGrenMinN3));
aSiLimGrenEpiN3 = oSiO2WEpiN3 /(hSiAssGrenN3 + oSiO2WEpiN3);
aMuTmLGrenEpiN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimGrenEpiN3 * uMuMaxTmGrenEpiN3;
aNutLimGrenEpiN3 = MIN(aPLimGrenEpiN3 , (MIN(aNLimGrenEpiN3,aSiLimGrenEpiN3)));
aMuGrenEpiN3 = aNutLimGrenEpiN3 * aMuTmLGrenEpiN3;
wDAssGrenEpiN3 = aMuGrenEpiN3*oDGrenWEpiN3;
aExtChGrenEpiN3 = cExtSpGrenN3 / rChDGrenEpiN3;
wDRespGrenWEpiN3 = ukDRespTmGrenEpiN3 * oDGrenWEpiN3;
wDLossGrenEpiN3 = ukLossTmGrenEpiN3 * oDGrenWEpiN3;
wDMortGrenWEpiN3 = kMortGrenWN3 * oDGrenWEpiN3;
ukDDecGrenEpiN3 = ukDRespTmGrenEpiN3 + ukLossTmGrenEpiN3 + kMortGrenWN3 +(uCorVSetGrenEpiN3 * uFunTmSetEpiN3) / uDepthWEpiN3;
wPExcrGrenWEpiN3 = (2.0 *rPDGrenWEpiN3) /(cPDGrenMaxN3 + rPDGrenWEpiN3) * rPDGrenWEpiN3 * wDRespGrenWEpiN3 ;
wPLossGrenEpiN3 = rPDGrenWEpiN3 * wDLossGrenEpiN3;
wPMortGrenWEpiN3 = kMortGrenWN3 * oPGrenWEpiN3;
wNExcrGrenWEpiN3 = (2.0 * rNDGrenWEpiN3) /(cNDGrenMaxN3 + rNDGrenWEpiN3) * rNDGrenWEpiN3 * wDRespGrenWEpiN3;
wNLossGrenEpiN3 = rNDGrenWEpiN3 * wDLossGrenEpiN3;
wNMortGrenWEpiN3 = kMortGrenWN3 * oNGrenWEpiN3;
wDPrimGrenWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wDAssGrenEpiN3 - wDRespGrenWEpiN3 - wDLossGrenEpiN3 - wDMortGrenWEpiN3 -(tDSetGrenEpiN3 ) / uDepthWEpiN3 ELSE wDAssGrenEpiN3 - wDRespGrenWEpiN3 - wDLossGrenEpiN3 - wDMortGrenWEpiN3 -(tDSetGrenEpiN3 - tDResusGrenN3) / uDepthWEpiN3 ENDIF;
wPPrimGrenWEpiN3 =IF (aInclStratN3 EQ TRUE ) THEN wPUptGrenEpiN3 - wPExcrGrenWEpiN3 - wPLossGrenEpiN3 - wPMortGrenWEpiN3 -(tPSetGrenEpiN3 ) / uDepthWEpiN3 ELSE wPUptGrenEpiN3 - wPExcrGrenWEpiN3 - wPLossGrenEpiN3 - wPMortGrenWEpiN3 -(tPSetGrenEpiN3 - tPResusGrenN3) / uDepthWEpiN3 ENDIF;
wNPrimGrenWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wNUptGrenEpiN3 - wNExcrGrenWEpiN3 - wNLossGrenEpiN3 - wNMortGrenWEpiN3 -(tNSetGrenEpiN3 ) / uDepthWEpiN3 ELSE wNUptGrenEpiN3 - wNExcrGrenWEpiN3 - wNLossGrenEpiN3 - wNMortGrenWEpiN3 -(tNSetGrenEpiN3 - tNResusGrenN3) / uDepthWEpiN3 ENDIF;
tDPrimGrenSN3 = IF ( aInclStratN3 EQ FALSE) THEN tDSetGrenEpiN3 - tDResusGrenN3 - tDMortGrenSN3 - tDRespGrenSN3 ELSE tDSetGrenHypN3 - tDResusGrenN3 - tDMortGrenSN3 - tDRespGrenSN3 ENDIF;
tPPrimGrenSN3 = IF ( aInclStratN3 EQ FALSE) THEN tPSetGrenEpiN3 - tPResusGrenN3 - tPMortGrenSN3 - tPExcrGrenSN3 ELSE tPSetGrenHypN3 - tPResusGrenN3 - tPMortGrenSN3 - tPExcrGrenSN3 ENDIF;
tNPrimGrenSN3 = IF ( aInclStratN3 EQ FALSE) THEN tNSetGrenEpiN3 - tNResusGrenN3 - tNMortGrenSN3 - tNExcrGrenSN3 ELSE tNSetGrenHypN3 - tNResusGrenN3 - tNMortGrenSN3 - tNExcrGrenSN3 ENDIF;
aVPUptMaxCrDiatEpiN3 = MAX(0.0,cVPUptMaxDiatN3 * uFunTmProdDiatEpiN3 *(cPDDiatMaxN3 - rPDDiatWEpiN3) /(cPDDiatMaxN3 - cPDDiatMinN3));
aVPUptDiatEpiN3 = oPO4WEpiN3 * aVPUptMaxCrDiatEpiN3 /(aVPUptMaxCrDiatEpiN3 / cAffPUptDiatN3 + oPO4WEpiN3);
wPUptDiatEpiN3 = aVPUptDiatEpiN3 * oDDiatWEpiN3;
aVNUptMaxCrDiatEpiN3 = MAX(0.0,cVNUptMaxDiatN3 * uFunTmProdDiatEpiN3 * (cNDDiatMaxN3 - rNDDiatWEpiN3) /(cNDDiatMaxN3 - cNDDiatMinN3));
ahNUptDiatEpiN3 = aVNUptMaxCrDiatEpiN3 / cAffNUptDiatN3;
aVNUptDiatEpiN3 = oNDissWEpiN3 * aVNUptMaxCrDiatEpiN3 /(ahNUptDiatEpiN3 + oNDissWEpiN3);
wNUptDiatEpiN3 = aVNUptDiatEpiN3 * oDDiatWEpiN3;
afNH4UptDiatEpiN3 = oNH4WEpiN3 * oNO3WEpiN3 /((ahNUptDiatEpiN3 + oNH4WEpiN3) *(ahNUptDiatEpiN3 + oNO3WEpiN3)) + oNH4WEpiN3 * ahNUptDiatEpiN3 /((oNH4WEpiN3 + oNO3WEpiN3) *(ahNUptDiatEpiN3 + oNO3WEpiN3));
wNUptNH4DiatEpiN3 = afNH4UptDiatEpiN3 * wNUptDiatEpiN3;
wNUptNO3DiatEpiN3 = wNUptDiatEpiN3 - wNUptNH4DiatEpiN3;
aPLimDiatEpiN3 = MAX(0.0,(1.0 - cPDDiatMinN3 / rPDDiatWEpiN3) * cPDDiatMaxN3 /(cPDDiatMaxN3 - cPDDiatMinN3));
aNLimDiatEpiN3 = MAX(0.0,(1.0 - cNDDiatMinN3 / rNDDiatWEpiN3) * cNDDiatMaxN3 /(cNDDiatMaxN3 - cNDDiatMinN3));
aSiLimDiatEpiN3 = oSiO2WEpiN3 /(hSiAssDiatN3 + oSiO2WEpiN3);
aMuTmLDiatEpiN3 = ufDayN3 *(1.0 - afCovSurfVegN3) * aLLimDiatEpiN3 * uMuMaxTmDiatEpiN3;
aNutLimDiatEpiN3 = MIN(aPLimDiatEpiN3 , (MIN(aNLimDiatEpiN3,aSiLimDiatEpiN3)));
aMuDiatEpiN3 = aNutLimDiatEpiN3 * aMuTmLDiatEpiN3;
wDAssDiatEpiN3 = aMuDiatEpiN3*oDDiatWEpiN3;
aExtChDiatEpiN3 = cExtSpDiatN3 / rChDDiatEpiN3;
wDRespDiatWEpiN3 = ukDRespTmDiatEpiN3 * oDDiatWEpiN3;
wDLossDiatEpiN3 = ukLossTmDiatEpiN3 * oDDiatWEpiN3;
wDMortDiatWEpiN3 = kMortDiatWN3 * oDDiatWEpiN3;
ukDDecDiatEpiN3 = ukDRespTmDiatEpiN3 + ukLossTmDiatEpiN3 + kMortDiatWN3 +(uCorVSetDiatEpiN3 * uFunTmSetEpiN3) / uDepthWEpiN3;
wPExcrDiatWEpiN3 = (2.0 * rPDDiatWEpiN3) /(cPDDiatMaxN3 + rPDDiatWEpiN3) * rPDDiatWEpiN3 * wDRespDiatWEpiN3 ;
wPLossDiatEpiN3 = rPDDiatWEpiN3 * wDLossDiatEpiN3;
wPMortDiatWEpiN3 = kMortDiatWN3 * oPDiatWEpiN3;
wNExcrDiatWEpiN3 = (2.0 * rNDDiatWEpiN3) /(cNDDiatMaxN3 + rNDDiatWEpiN3) * rNDDiatWEpiN3 * wDRespDiatWEpiN3 ;
wNLossDiatEpiN3 = rNDDiatWEpiN3 * wDLossDiatEpiN3;
wNMortDiatWEpiN3 = kMortDiatWN3 * oNDiatWEpiN3;
wDPrimDiatWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wDAssDiatEpiN3 - wDRespDiatWEpiN3 - wDLossDiatEpiN3 - wDMortDiatWEpiN3 -(tDSetDiatEpiN3 ) / uDepthWEpiN3 ELSE wDAssDiatEpiN3 - wDRespDiatWEpiN3 - wDLossDiatEpiN3 - wDMortDiatWEpiN3 -(tDSetDiatEpiN3 - tDResusDiatN3) / uDepthWEpiN3 ENDIF;
wPPrimDiatWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wPUptDiatEpiN3 - wPExcrDiatWEpiN3 - wPLossDiatEpiN3 - wPMortDiatWEpiN3 -(tPSetDiatEpiN3 ) / uDepthWEpiN3 ELSE wPUptDiatEpiN3 - wPExcrDiatWEpiN3 - wPLossDiatEpiN3 - wPMortDiatWEpiN3 -(tPSetDiatEpiN3 - tPResusDiatN3) / uDepthWEpiN3 ENDIF;
wNPrimDiatWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wNUptDiatEpiN3 - wNExcrDiatWEpiN3 - wNLossDiatEpiN3 - wNMortDiatWEpiN3 -(tNSetDiatEpiN3 ) / uDepthWEpiN3 ELSE wNUptDiatEpiN3 - wNExcrDiatWEpiN3 - wNLossDiatEpiN3 - wNMortDiatWEpiN3 -(tNSetDiatEpiN3 - tNResusDiatN3) / uDepthWEpiN3 ENDIF;
tDPrimDiatSN3 = IF ( aInclStratN3 EQ FALSE) THEN tDSetDiatEpiN3 - tDResusDiatN3 - tDMortDiatSN3 - tDRespDiatSN3 ELSE tDSetDiatHypN3 - tDResusDiatN3 - tDMortDiatSN3 - tDRespDiatSN3 ENDIF;
tPPrimDiatSN3 = IF ( aInclStratN3 EQ FALSE) THEN tPSetDiatEpiN3 - tPResusDiatN3 - tPMortDiatSN3 - tPExcrDiatSN3 ELSE tPSetDiatHypN3 - tPResusDiatN3 - tPMortDiatSN3 - tPExcrDiatSN3 ENDIF;
tNPrimDiatSN3 = IF ( aInclStratN3 EQ FALSE) THEN tNSetDiatEpiN3 - tNResusDiatN3 - tNMortDiatSN3 - tNExcrDiatSN3 ELSE tNSetDiatHypN3 - tNResusDiatN3 - tNMortDiatSN3 - tNExcrDiatSN3 ENDIF;
oChlaN3 = IF ( aInclStratN3 EQ TRUE ) THEN (oChlaEpiN3 * uDepthWEpiN3 + oChlaHypN3 * uDepthWHypN3 + aChlaBlueSurfN3) / uDepthWN3 ELSE (oChlaEpiN3 * uDepthWEpiN3+ aChlaBlueSurfN3 ) / uDepthWN3 ENDIF;
oChlaWN3 = IF ( aInclStratN3 EQ TRUE ) THEN (oChlaEpiN3 * uDepthWEpiN3 + oChlaHypN3 * uDepthWHypN3) / uDepthWN3 ELSE (oChlaEpiN3 * uDepthWEpiN3) / uDepthWN3 ENDIF;
aChlaHN3 = oChlaN3 * uDepthWN3;
aLPIEpiN3 =  (aLPARBotSurfN3- aLPARBotEpiOpenN3 + uhLVegN3* LN((1.0 +aLPARBotEpiOpenN3/ uhLVegN3)  /(1.0 + aLPARBotSurfN3  / uhLVegN3) + NearZeroN3  ) ) / uDepthWEpiN3;
aLPIHypN3 =  (aLPARBotEpiN3- aLPARBotHypOpenN3 + uhLVegN3* LN((1.0 +aLPARBotHypOpenN3/ uhLVegN3)  /(1.0 + aLPARBotEpiN3  / uhLVegN3) + NearZeroN3  ) ) / uDepthWHypN3;
aLPIMeasEpiN3 =  (aLPARBotSurfN3- aLPARBotEpiN3 ) /aExtCoefEpiN3;
aLPIMeasHypN3 =  (aLPARBotEpiN3- aLPARBotHypN3) / aExtCoefHypN3;
aLMeasEpiN3 = aLPARBotSurfN3 * EXP(- aExtCoefOpenEpiN3 *cDepthMeasoChlN3);
aLMeasHypN3 = aLPARBotEpiN3 * EXP(- aExtCoefOpenHypN3 * (cDepthMeasoChlN3 -  uDepthWEpiN3));
aLPAREuphoN3 = PerCentN3 * uLPARSurfN3;
aDepthEuphWN3 = IF (aLPAREuphoN3 GT aLPARBotSurfN3) THEN  0.0 ELSEIF (aLPAREuphoN3 GE aLPARBotEpiOpenN3) THEN - LN(aLPAREuphoN3/aLPARBotSurfN3) / aExtCoefEpiN3 ELSE uDepthWEpiN3 - LN(aLPAREuphoN3/aLPARBotEpiOpenN3) / aExtCoefOpenHypN3 ENDIF;
oChlaMeasEpiN3 = IF (cDepthMeasoChlN3 LT aDepthEuphWN3) THEN aLMeasEpiN3/ aLPIMeasEpiN3 *oChlaEpiN3 * uDepthWEpiN3 ELSE oChlaEpiN3 ENDIF;
oChlaMeasHypN3 = IF (cDepthMeasoChlN3 LT aDepthEuphWN3) THEN  aLMeasHypN3/ aLPIMeasHypN3 *oChlaHypN3* uDepthWHypN3  ELSE oChlaHypN3 ENDIF;
oChlaMeasWN3 = IF (cDepthMeasoChlN3 LT uDepthWEpiN3) THEN oChlaMeasEpiN3 ELSE oChlaMeasHypN3 ENDIF;
wDAssPhytEpiN3 = wDAssDiatEpiN3 + wDAssGrenEpiN3 + wDAssBlueEpiN3;
wDRespPhytWEpiN3 = wDRespDiatWEpiN3 + wDRespGrenWEpiN3 + wDRespBlueWEpiN3;
wDMortPhytWEpiN3 = wDMortDiatWEpiN3 + wDMortGrenWEpiN3 + wDMortBlueWEpiN3;
tDSetPhytEpiN3 = tDSetDiatEpiN3 + tDSetGrenEpiN3 + tDSetBlueEpiN3;
wDLossPhytEpiN3 = wDLossDiatEpiN3 + wDLossGrenEpiN3 + wDLossBlueEpiN3 + tDLossBlueSurfN3 / uDepthWEpiN3;
wDPrimPhytWEpiN3 = wDPrimDiatWEpiN3 + wDPrimGrenWEpiN3 + wDPrimBlueWEpiN3;
wPUptPhytEpiN3 = wPUptDiatEpiN3 + wPUptGrenEpiN3 + wPUptBlueEpiN3;
wPExcrPhytWEpiN3 = wPExcrDiatWEpiN3 + wPExcrGrenWEpiN3 + wPExcrBlueWEpiN3;
wPMortPhytWEpiN3 = wPMortDiatWEpiN3 + wPMortGrenWEpiN3 + wPMortBlueWEpiN3;
tPSetPhytEpiN3 = tPSetDiatEpiN3 + tPSetGrenEpiN3 + tPSetBlueEpiN3;
wPLossPhytEpiN3 = wPLossDiatEpiN3 + wPLossGrenEpiN3 + wPLossBlueEpiN3 + tPLossBlueSurfN3 / uDepthWEpiN3;
wPPrimPhytWEpiN3 = wPPrimDiatWEpiN3 + wPPrimGrenWEpiN3 + wPPrimBlueWEpiN3;
wNUptPhytEpiN3 = wNUptDiatEpiN3 + wNUptGrenEpiN3 + wNUptBlueEpiN3;
wNUptNH4PhytEpiN3 = wNUptNH4DiatEpiN3 + wNUptNH4GrenEpiN3 + wNUptNH4BlueEpiN3;
wNUptNO3PhytEpiN3 = wNUptNO3DiatEpiN3 + wNUptNO3GrenEpiN3 + wNUptNO3BlueEpiN3;
wNExcrPhytWEpiN3 = wNExcrDiatWEpiN3 + wNExcrGrenWEpiN3 + wNExcrBlueWEpiN3;
wNMortPhytWEpiN3 = wNMortDiatWEpiN3 + wNMortGrenWEpiN3 + wNMortBlueWEpiN3;
tNSetPhytEpiN3 = tNSetDiatEpiN3 + tNSetGrenEpiN3 + tNSetBlueEpiN3;
wNLossPhytEpiN3 = wNLossDiatEpiN3 + wNLossGrenEpiN3 + wNLossBlueEpiN3 + tNLossBlueSurfN3 / uDepthWEpiN3;
wNPrimPhytWEpiN3 = wNPrimDiatWEpiN3 + wNPrimGrenWEpiN3 + wNPrimBlueWEpiN3;
tDPrimPhytSN3 = tDPrimDiatSN3 + tDPrimGrenSN3 + tDPrimBlueSN3;
tPPrimPhytSN3 = tPPrimDiatSN3 + tPPrimGrenSN3 + tPPrimBlueSN3;
tNPrimPhytSN3 = tNPrimDiatSN3 + tNPrimGrenSN3 + tNPrimBlueSN3;
wSiUptDiatEpiN3 = cSiDDiatN3 * wDAssDiatEpiN3;
wSiExcrDiatWEpiN3 = cSiDDiatN3 * wDRespDiatWEpiN3 ;
wSiLossDiatEpiN3 = cSiDDiatN3 * wDLossDiatEpiN3;
wSiMortDiatWEpiN3 = cSiDDiatN3 * wDMortDiatWEpiN3;
tSiSetDiatEpiN3 = cSiDDiatN3 * tDSetDiatEpiN3;
wSiPrimDiatWHypN3 = IF (aInclStratN3 EQ TRUE ) THEN wSiUptDiatHypN3 - tSiSetDiatHypN3 / uDepthWHypN3 - wSiExcrDiatWHypN3 - wSiMortDiatWHypN3 - wSiLossDiatHypN3 ELSE 0.0 ENDIF;
wSiPrimDiatWEpiN3 = IF (aInclStratN3 EQ TRUE ) THEN wSiUptDiatEpiN3 - tSiSetDiatEpiN3 / uDepthWEpiN3 - wSiExcrDiatWEpiN3 - wSiMortDiatWEpiN3 - wSiLossDiatEpiN3 ELSE wSiUptDiatEpiN3 - tSiSetDiatEpiN3 / uDepthWEpiN3 - wSiExcrDiatWEpiN3 - wSiMortDiatWEpiN3 - wSiLossDiatEpiN3 + tSiResusDiatN3 / uDepthWEpiN3 ENDIF;
rCyDBlueEpiN3 = cCyDBlueMaxN3 -(cCyDBlueMaxN3 - cCyDBlueMinN3) * aLLimBlueEpiN3;
oCyanEpiN3 = rCyDBlueEpiN3 * oDBlueWEpiN3 * mgPergN3;
fDDiatEpiN3 = oDDiatWEpiN3 /(oDDiatWEpiN3 + oDGrenWEpiN3 + oDBlueWEpiN3 + NearZeroN3);
wDPrimDetWEpiN3 = IF (InclSurfN3 EQ TRUE) THEN wDMortPhytWEpiN3 + wDLossPhytEpiN3 + tDMortBlueSurfN3 / uDepthWEpiN3 ELSE wDMortPhytWEpiN3 + wDLossPhytEpiN3 ENDIF;
tDPrimDetSN3 = tDMortPhytSN3;
tDPrimTotSurfN3 = IF (InclSurfN3 EQ TRUE) THEN tDAssBlueSurfN3 - tDRespBlueSurfN3 ELSE 0.0 ENDIF;
tDPrimTotTN3 = IF (aInclStratN3 EQ FALSE ) THEN(wDAssPhytEpiN3 - wDRespPhytWEpiN3) * uDepthWEpiN3 - tDRespPhytSN3 + tDPrimTotSurfN3 ELSE (wDAssPhytEpiN3 - wDRespPhytWEpiN3) * uDepthWEpiN3 + (wDAssPhytHypN3 - wDRespPhytWHypN3) * uDepthWHypN3 - tDRespPhytSN3 + tDPrimTotSurfN3 ENDIF;
wO2ProdPhytEpiN3 = molO2molCN3 * cCPerDWN3 * wDAssPhytEpiN3;
wO2RespPhytWEpiN3 = molO2molCN3 * cCPerDWN3 * wDRespPhytWEpiN3 * aCorO2BODEpiN3;
wO2UptNO3PhytEpiN3 = O2PerNO3N3 * molO2molNN3 * wNUptNO3PhytEpiN3;
wO2PrimWEpiN3 = wO2ProdPhytEpiN3 - wO2RespPhytWEpiN3 + wO2UptNO3PhytEpiN3;
tO2RespPhytSN3 = molO2molCN3 * cCPerDWN3 * tDRespPhytSN3 * afOxySedN3;
tO2PrimSN3 = tO2RespPhytSN3;
tO2PrimSHypN3 = IF aInclStratN3 EQ TRUE THEN tO2PrimSN3 / uDepthWHypN3 ELSE 0.0 ENDIF;
tO2PrimSEpiN3 = IF aInclStratN3 EQ FALSE THEN tO2PrimSN3 / uDepthWEpiN3 ELSE 0.0 ENDIF;
wPMortBluePO4WSurfN3 = fDissMortPhytN3 * tPMortBlueSurfN3 / uDepthWEpiN3;
wPMortBlueDetSurfN3 = ( 1 -fDissMortPhytN3) * tPMortBlueSurfN3 / uDepthWEpiN3;
wPMortPhytPO4WEpiN3 = fDissMortPhytN3 * wPMortPhytWEpiN3;
wPMortPhytDetWEpiN3 = wPMortPhytWEpiN3 - wPMortPhytPO4WEpiN3 + wPMortBlueDetSurfN3;
wPLossPhytPO4EpiN3 = fDissLossN3 * wPLossPhytEpiN3;
wPLossPhytDetEpiN3 = wPLossPhytEpiN3 - wPLossPhytPO4EpiN3;
wPPrimPO4WEpiN3 = - wPUptPhytEpiN3 + wPExcrPhytWEpiN3 + wPLossPhytPO4EpiN3 + wPMortPhytPO4WEpiN3 - tPUptBlueSurfN3 / uDepthWEpiN3 + tPExcrBlueSurfN3 / uDepthWEpiN3 + wPMortBluePO4WSurfN3;
wPPrimDetWEpiN3 = wPLossPhytDetEpiN3 + wPMortPhytDetWEpiN3;
tPPrimDetSN3 = tPMortPhytDetSN3 ;
wNMortPhytNH4WEpiN3 = fDissMortPhytN3 * wNMortPhytWEpiN3;
wNMortPhytDetWEpiN3 = wNMortPhytWEpiN3 - wNMortPhytNH4WEpiN3+ wNMortBlueDetSurfN3;
wNLossPhytNH4EpiN3 = fDissLossN3 * wNLossPhytEpiN3;
wNLossPhytDetEpiN3 = wNLossPhytEpiN3 - wNLossPhytNH4EpiN3;
wNPrimNH4WEpiN3 = - wNUptNH4PhytEpiN3 + wNExcrPhytWEpiN3 + wNLossPhytNH4EpiN3 + wNMortPhytNH4WEpiN3- tNUptNH4BlueSurfN3 / uDepthWEpiN3 + tNExcrBlueSurfN3 / uDepthWEpiN3 + wNMortBlueNH4WSurfN3;
wNPrimNO3WEpiN3 = - wNUptNO3PhytEpiN3 - tNUptNO3BlueSurfN3 / uDepthWEpiN3;
wNPrimDetWEpiN3 = wNLossPhytDetEpiN3 + wNMortPhytDetWEpiN3;
tNPrimDetSN3 = tNMortPhytDetSN3 ;
wSiPrimSiO2WEpiN3 = IF (aInclStratN3 EQ FALSE) THEN wSiExcrDiatWEpiN3 - wSiUptDiatEpiN3 + tSiExcrDiatSN3 / uDepthWEpiN3 ELSE wSiExcrDiatWEpiN3 - wSiUptDiatEpiN3 ENDIF;
wSiPrimDetWEpiN3 = wSiMortDiatWEpiN3 + wSiLossDiatEpiN3;
tSiPrimDiatSN3 = IF (aInclStratN3 EQ FALSE) THEN tSiSetDiatEpiN3 - tSiResusDiatN3 - tSiExcrDiatSN3 - tSiMortDiatSN3 ELSE tSiSetDiatHypN3 - tSiResusDiatN3 - tSiExcrDiatSN3 - tSiMortDiatSN3 ENDIF;
tSiPrimDetSN3 = tSiMortDiatSN3 ;
aDepthEuphEpiN3 = cEuphN3 * aSecchiEpiN3;
aRelDepthEuphEpiN3 = aDepthEuphEpiN3 / uDepthWEpiN3;
aChlaHEpiN3 = oChlaEpiN3 * uDepthWEpiN3;
aCovPhytWEpiN3 = cCovSpPhytN3 *(oDPhytWEpiN3 * uDepthWEpiN3);
rExtChPhytEpiN3 = aExtPhytEpiN3 /(oChlaEpiN3 / mgPergN3 + NearZeroN3);
rPDZooEpiN3 = oPZooEpiN3 /(oDZooEpiN3+NearZeroN3);
rNDZooEpiN3 = oNZooEpiN3/(oDZooEpiN3+NearZeroN3);
aDFoodZooEpiN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN cPrefDiatN3 * aDDiatWEpiN3 + cPrefGrenN3 * aDGrenWEpiN3 + cPrefBlueN3 * aDBlueWEpiN3 + cPrefDetN3 * aDDetWEpiN3 ELSE cPrefDiatN3 * aDDiatWEpiN3 + cPrefGrenN3 * aDGrenWEpiN3 + cPrefBlueN3 * aDBlueWEpiN3 + cPrefBlueSurfN3 * aDBlueSurfN3 + cPrefDetN3 * aDDetWEpiN3 ENDIF;
oDFoodZooEpiN3 = aDFoodZooEpiN3 / uDepthWEpiN3;
aFiltEpiN3 = cFiltMaxN3 * uFunTmZooEpiN3 * hFiltN3 /(hFiltN3 + oDOMWEpiN3);
aDSatZooEpiN3 = oDFoodZooEpiN3 /(hFiltN3 + oDOMWEpiN3);
wDEnvZooEpiN3 = MAX(0.0,ukDIncrZooEpiN3 / cDCarrZooN3 * oDZooEpiN3*oDZooEpiN3);
wDAssZooEpiN3 = aDSatZooEpiN3 *(ukDAssTmZooEpiN3 * oDZooEpiN3 - wDEnvZooEpiN3);
wDConsZooEpiN3 = wDAssZooEpiN3 / fDAssZooN3;
wDConsDetZooEpiN3 = cPrefDetN3*oDDetWEpiN3 / oDFoodZooEpiN3 * wDConsZooEpiN3;
wDConsDiatZooEpiN3 = cPrefDiatN3*oDDiatWEpiN3 / oDFoodZooEpiN3 * wDConsZooEpiN3;
wDConsGrenZooEpiN3 = cPrefGrenN3*oDGrenWEpiN3 / oDFoodZooEpiN3 * wDConsZooEpiN3;
wDConsBlueZooEpiN3 = cPrefBlueN3*oDBlueWEpiN3 / oDFoodZooEpiN3 * wDConsZooEpiN3;
wDConsBlueZooSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE cPrefBlueSurfN3 *aDBlueSurfN3 / aDFoodZooEpiN3 * wDConsZooEpiN3 ENDIF;
tDConsBlueZooSurfN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE wDConsBlueZooSurfN3 *uDepthWEpiN3 ENDIF;
wDConsPhytZooEpiN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN wDConsDiatZooEpiN3 + wDConsGrenZooEpiN3 + wDConsBlueZooEpiN3 ELSE wDConsDiatZooEpiN3 + wDConsGrenZooEpiN3 + wDConsBlueZooEpiN3 + wDConsBlueZooSurfN3 ENDIF;
wDEgesZooEpiN3 = wDConsZooEpiN3 - wDAssZooEpiN3;
aCorDRespZooEpiN3 = MAX(cPDZooRefN3 / rPDZooEpiN3,cNDZooRefN3 / rNDZooEpiN3);
wDRespZooEpiN3 = aCorDRespZooEpiN3 * ukDRespTmZooEpiN3 * oDZooEpiN3;
wDMortZooEpiN3 = kMortZooN3 * oDZooEpiN3 +(1.0 - aDSatZooEpiN3) * wDEnvZooEpiN3;
aPFoodZooEpiN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN cPrefDiatN3*aPDiatWEpiN3 + cPrefGrenN3*aPGrenWEpiN3 + cPrefBlueN3 * aPBlueWEpiN3  + cPrefDetN3 * aPDetWEpiN3 ELSE cPrefDiatN3*aPDiatWEpiN3 + cPrefGrenN3*aPGrenWEpiN3 + cPrefBlueN3*aPBlueWEpiN3 + cPrefBlueSurfN3 *aPBlueSurfN3 + cPrefDetN3 * aPDetWEpiN3 ENDIF;
oPFoodZooEpiN3 = aPFoodZooEpiN3 / MassEpiN3;
rPDFoodZooEpiN3 = oPFoodZooEpiN3 /(oDFoodZooEpiN3+NearZeroN3);
wPConsDiatZooEpiN3 = rPDDiatWEpiN3 * wDConsDiatZooEpiN3;
wPConsGrenZooEpiN3 = rPDGrenWEpiN3 * wDConsGrenZooEpiN3;
wPConsBlueZooEpiN3 = rPDBlueWEpiN3 * wDConsBlueZooEpiN3;
wPConsBlueZooSurfN3 = rPDBlueSurfN3 * wDConsBlueZooSurfN3;
tPConsBlueZooSurfN3 = wPConsBlueZooSurfN3 *uDepthWEpiN3;
wPConsPhytZooEpiN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN wPConsDiatZooEpiN3 + wPConsGrenZooEpiN3 + wPConsBlueZooEpiN3 ELSE wPConsDiatZooEpiN3 + wPConsGrenZooEpiN3 + wPConsBlueZooEpiN3 + wPConsBlueZooSurfN3 ENDIF;
wPConsDetZooEpiN3 = rPDDetWEpiN3 * wDConsDetZooEpiN3;
wPConsZooEpiN3 = wPConsPhytZooEpiN3 + wPConsDetZooEpiN3;
afPAssZooEpiN3 = MIN(1.0,cPDZooRefN3 / rPDFoodZooEpiN3 * fDAssZooN3);
wPAssZooEpiN3 = afPAssZooEpiN3 * wPConsZooEpiN3;
wPEgesZooEpiN3 = wPConsZooEpiN3 - wPAssZooEpiN3;
wPEgesZooPO4EpiN3 = fDissEgesZooN3*wPEgesZooEpiN3;
wPEgesZooDetEpiN3 = wPEgesZooEpiN3 - wPEgesZooPO4EpiN3;
akPExcrZooEpiN3 = rPDZooEpiN3 / cPDZooRefN3 * kDRespZooN3 * uFunTmZooEpiN3;
wPExcrZooEpiN3 = akPExcrZooEpiN3*oPZooEpiN3 ;
wPMortZooEpiN3 = rPDZooEpiN3 * wDMortZooEpiN3;
wPMortZooPO4EpiN3 = fDissMortZooN3 * wPMortZooEpiN3;
wPMortZooDetEpiN3 = wPMortZooEpiN3 - wPMortZooPO4EpiN3;
aNFoodZooEpiN3 =  IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN cPrefDiatN3*aNDiatWEpiN3 + cPrefGrenN3*aNGrenWEpiN3 + cPrefBlueN3*aNBlueWEpiN3 + cPrefDetN3 * aNDetWEpiN3 ELSE cPrefDiatN3*aNDiatWEpiN3 + cPrefGrenN3*aNGrenWEpiN3 + cPrefBlueN3*aNBlueWEpiN3 + cPrefBlueSurfN3*aNBlueSurfN3 + cPrefDetN3 * aNDetWEpiN3 ENDIF;
oNFoodZooEpiN3 = aNFoodZooEpiN3 / MassEpiN3;
rNDFoodZooEpiN3 = oNFoodZooEpiN3 /(oDFoodZooEpiN3+NearZeroN3);
wNConsDiatZooEpiN3 = rNDDiatWEpiN3*wDConsDiatZooEpiN3;
wNConsGrenZooEpiN3 = rNDGrenWEpiN3*wDConsGrenZooEpiN3;
wNConsBlueZooEpiN3 = rNDBlueWEpiN3*wDConsBlueZooEpiN3;
wNConsBlueZooSurfN3 = rNDBlueSurfN3 * wDConsBlueZooSurfN3;
tNConsBlueZooSurfN3 = wNConsBlueZooSurfN3 *uDepthWEpiN3;
wNConsPhytZooEpiN3 = IF (InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN  wNConsDiatZooEpiN3 + wNConsGrenZooEpiN3 + wNConsBlueZooEpiN3 ELSE wNConsDiatZooEpiN3 + wNConsGrenZooEpiN3 + wNConsBlueZooEpiN3 + wNConsBlueZooSurfN3 ENDIF;
wNConsDetZooEpiN3 = rNDDetWEpiN3*wDConsDetZooEpiN3;
wNConsZooEpiN3 = wNConsPhytZooEpiN3 + wNConsDetZooEpiN3;
afNAssZooEpiN3 = MIN(1.0,cNDZooRefN3 / rNDFoodZooEpiN3 * fDAssZooN3);
wNAssZooEpiN3 = afNAssZooEpiN3*wNConsZooEpiN3;
wNEgesZooEpiN3 = wNConsZooEpiN3 - wNAssZooEpiN3;
wNEgesZooNH4EpiN3 = fDissEgesZooN3*wNEgesZooEpiN3;
wNEgesZooDetEpiN3 = wNEgesZooEpiN3 - wNEgesZooNH4EpiN3;
kNExcrZooEpiN3 = rNDZooEpiN3 / cNDZooRefN3 * kDRespZooN3 * uFunTmZooEpiN3;
wNExcrZooEpiN3 = kNExcrZooEpiN3*oNZooEpiN3 ;
wNMortZooEpiN3 = rNDZooEpiN3*wDMortZooEpiN3;
wNMortZooNH4EpiN3 = fDissMortZooN3*wNMortZooEpiN3;
wNMortZooDetEpiN3 = wNMortZooEpiN3 - wNMortZooNH4EpiN3;
wSiConsDiatZooEpiN3 = cSiDDiatN3 * wDConsDiatZooEpiN3;
rPDFiJvN3 = aPFiJvN3 /(aDFiJvN3+NearZeroN3);
rPDFiAdN3 = aPFiAdN3 /(aDFiAdN3+NearZeroN3);
rNDFiJvN3 = aNFiJvN3 /(aDFiJvN3+NearZeroN3);
rNDFiAdN3 = aNFiAdN3 /(aDFiAdN3+NearZeroN3);
tDReprFishN3 = IF (FALSE EQ InclSeasonN3) THEN ((1/DaysInYearN3)*fReprFishN3) * aDFiAdN3 ELSEIF (DayN3 GE cDayReprFishN3 AND DayN3 LT cDayReprFishN3 + 1.0) THEN fReprFishN3 * aDFiAdN3 * PerDayN3 ELSE 0.0 ENDIF;
tDAgeFishN3 = IF (FALSE EQ InclSeasonN3) THEN ((1/DaysInYearN3)*fAgeFishN3) * aDFiJvN3 ELSEIF (DayN3 GE 364.0) THEN fAgeFishN3 * aDFiJvN3 *PerDayN3 ELSE 0.0 ENDIF;
aDTotZooN3 = IF (aInclStratN3 EQ FALSE) THEN oDZooEpiN3 * uDepthWEpiN3 ELSE oDZooEpiN3 * uDepthWEpiN3 + oDZooHypN3 * uDepthWHypN3 ENDIF;
aPTotZooN3 = IF (aInclStratN3 EQ FALSE) THEN oPZooEpiN3 * uDepthWEpiN3 ELSE oPZooEpiN3 * uDepthWEpiN3 + oPZooHypN3 * uDepthWHypN3 ENDIF;
aNTotZooN3 = IF (aInclStratN3 EQ FALSE) THEN oNZooEpiN3 * uDepthWEpiN3 ELSE oNZooEpiN3 * uDepthWEpiN3 + oNZooHypN3 * uDepthWHypN3 ENDIF;
aDSatFiJvN3 = aDTotZooN3 * aDTotZooN3 /(hDZooFiJvN3 * hDZooFiJvN3 + aDTotZooN3 * aDTotZooN3);
tDEnvFiJvN3 = MAX(0.0,ukDIncrFiJvN3 /(cDCarrFishN3 - aDFiAdN3) * aDFiJvN3*aDFiJvN3);
tDAssFiJvN3 = aDSatFiJvN3 *(kDAssFiJvN3 * uFunTmFishN3 * aDFiJvN3 - tDEnvFiJvN3);
tDConsFiJvN3 = tDAssFiJvN3 / fDAssFiJvN3;
tDEgesFiJvN3 = tDConsFiJvN3 - tDAssFiJvN3;
tDRespFiJvN3 = (cPDFishRefN3 / rPDFiJvN3) * kDRespFiJvN3 * uFunTmFishN3 * aDFiJvN3;
tDMortFiJvN3 = kMortFiJvN3 * aDFiJvN3 +(1.0 - aDSatFiJvN3) * tDEnvFiJvN3;
tDMigrFiJvN3 = kMigrFishN3 *(cDFiJvInN3 - aDFiJvN3);
tDEnvFiAdN3 = MAX(0.0,ukDIncrFiAdN3 /(cDCarrFishN3 - aDFiJvN3) * aDFiAdN3*aDFiAdN3);
tDAssFiAdN3 = aDSatFiAdN3 *(kDAssFiAdN3 * uFunTmFishN3 * aDFiAdN3 - tDEnvFiAdN3);
tDConsFiAdN3 = tDAssFiAdN3 / fDAssFiAdN3;
tDEgesFiAdN3 = tDConsFiAdN3 - tDAssFiAdN3;
tDRespFiAdN3 = (cPDFishRefN3 / rPDFiAdN3) * kDRespFiAdN3 * uFunTmFishN3 * aDFiAdN3;
tDMortFiAdN3 = kMortFiAdN3 * aDFiAdN3 +(1.0 - aDSatFiAdN3) * tDEnvFiAdN3;
tDHarvFishN3 = ukHarvFishN3 * aDFiAdN3;
tDMigrFiAdN3 = kMigrFishN3 *(cDFiAdInN3 - aDFiAdN3);
tDMortFiJvBotN3 = fDBoneN3 * tDMortFiJvN3;
tDMortFiJvDetN3 = tDMortFiJvN3 - tDMortFiJvBotN3;
tDMortFiAdBotN3 = fDBoneN3 * tDMortFiAdN3;
tDMortFiAdDetN3 = tDMortFiAdN3 - tDMortFiAdBotN3;
tPReprFishN3 = rPDFiAdN3 * tDReprFishN3;
tPAgeFishN3 = rPDFiJvN3 * tDAgeFishN3;
tPMigrFiJvN3 = kMigrFishN3 *(cPDFishRefN3 * cDFiJvInN3 - aPFiJvN3);
tPConsFiJvN3 = rPDZooEpiN3 * tDConsFiJvN3;
afPAssFiJvN3 = MIN(1.0,cPDFishRefN3 / rPDZooEpiN3 * fDAssFiJvN3);
tPAssFiJvN3 = afPAssFiJvN3 * tPConsFiJvN3;
tPEgesFiJvN3 = tPConsFiJvN3 - tPAssFiJvN3;
tPExcrFiJvN3 = (rPDFiJvN3 / cPDFishRefN3) * kDRespFiJvN3 * uFunTmFishN3 * aPFiJvN3;
tPMortFiJvN3 = rPDFiJvN3 * tDMortFiJvN3;
tPMigrFiAdN3 = kMigrFishN3 *(cPDFishRefN3 * cDFiAdInN3 - aPFiAdN3);
tPConsFiAdN3 = rPDBentN3 * tDConsFiAdN3;
tPAssFiAdN3 = afPAssFiAdN3 * tPConsFiAdN3;
tPEgesFiAdN3 = tPConsFiAdN3 - tPAssFiAdN3;
tPExcrFiAdN3 = (rPDFiAdN3 / cPDFishRefN3) * kDRespFiAdN3 * uFunTmFishN3 * aPFiAdN3;
tPMortFiAdN3 = rPDFiAdN3 * tDMortFiAdN3;
tPHarvFishN3 = rPDFiAdN3 * tDHarvFishN3;
tPMortFiJvBotN3 = fPBoneN3 * tPMortFiJvN3;
tPMortFiJvPO4N3 = fDissMortFishN3 *(tPMortFiJvN3 - tPMortFiJvBotN3);
tPMortFiJvDetN3 = tPMortFiJvN3 - tPMortFiJvBotN3 - tPMortFiJvPO4N3;
tPMortFiAdBotN3 = fPBoneN3 * tPMortFiAdN3;
tPMortFiAdPO4N3 = fDissMortFishN3 *(tPMortFiAdN3 - tPMortFiAdBotN3);
tPMortFiAdDetN3 = tPMortFiAdN3 - tPMortFiAdBotN3 - tPMortFiAdPO4N3;
tPEgesFiJvPO4N3 = fDissEgesFishN3 * tPEgesFiJvN3;
tPEgesFiJvDetN3 = tPEgesFiJvN3 - tPEgesFiJvPO4N3;
tPEgesFiAdPO4N3 = fDissEgesFishN3 * tPEgesFiAdN3;
tPEgesFiAdDetN3 = tPEgesFiAdN3 - tPEgesFiAdPO4N3;
tNReprFishN3 = rNDFiAdN3 * tDReprFishN3;
tNAgeFishN3 = rNDFiJvN3 * tDAgeFishN3;
tNMigrFiJvN3 = kMigrFishN3 *(cNDFishRefN3 * cDFiJvInN3 - aNFiJvN3);
tNConsFiJvN3 = rNDZooEpiN3 * tDConsFiJvN3;
afNAssFiJvN3 = MIN(1.0,cNDFishRefN3 / rNDZooEpiN3 * fDAssFiJvN3);
tNAssFiJvN3 = afNAssFiJvN3 * tNConsFiJvN3;
tNEgesFiJvN3 = tNConsFiJvN3 - tNAssFiJvN3;
tNExcrFiJvN3 = (rNDFiJvN3 / cNDFishRefN3) * kDRespFiJvN3 * uFunTmFishN3 * aNFiJvN3;
tNMortFiJvN3 = rNDFiJvN3 * tDMortFiJvN3;
tNMigrFiAdN3 = kMigrFishN3 *(cNDFishRefN3 * cDFiAdInN3 - aNFiAdN3);
tNConsFiAdN3 = rNDBentN3 * tDConsFiAdN3;
tNAssFiAdN3 = afNAssFiAdN3 * tNConsFiAdN3;
tNEgesFiAdN3 = tNConsFiAdN3 - tNAssFiAdN3;
tNExcrFiAdN3 = (rNDFiAdN3 / cNDFishRefN3) * kDRespFiAdN3 * uFunTmFishN3 * aNFiAdN3;
tNMortFiAdN3 = rNDFiAdN3 * tDMortFiAdN3;
tNHarvFishN3 = rNDFiAdN3 * tDHarvFishN3;
tNMortFiAdBotN3 = fDBoneN3 * tNMortFiAdN3;
tNMortFiAdNH4N3 = fDissMortFishN3 *(tNMortFiAdN3 - tNMortFiAdBotN3);
tNMortFiAdDetN3 = tNMortFiAdN3 - tNMortFiAdBotN3 - tNMortFiAdNH4N3;
tNMortFiJvBotN3 = fDBoneN3 * tNMortFiJvN3;
tNMortFiJvNH4N3 = fDissMortFishN3 *(tNMortFiJvN3 - tNMortFiJvBotN3);
tNMortFiJvDetN3 = tNMortFiJvN3 - tNMortFiJvBotN3 - tNMortFiJvNH4N3;
tNEgesFiJvNH4N3 = fDissEgesFishN3 * tNEgesFiJvN3;
tNEgesFiJvDetN3 = tNEgesFiJvN3 - tNEgesFiJvNH4N3;
tDMigrPiscN3 = kMigrPiscN3 *(cDPiscInN3 - aDPiscN3);
aDFishN3 = aDFiJvN3 + aDFiAdN3;
aDSatPiscN3 = aDFishN3*aDFishN3 /(hDFishPiscN3*hDFishPiscN3 + aDFishN3*aDFishN3);
tDEnvPiscN3 = MAX(0.0,akDIncrPiscN3 / aDCarrPiscN3 * aDPiscN3*aDPiscN3);
tDAssPiscN3 = aDSatPiscN3 *(kDAssPiscN3 * aFunVegPiscN3 * uFunTmPiscN3 * aDPiscN3 - tDEnvPiscN3);
tDConsPiscN3 = tDAssPiscN3 / fDAssPiscN3;
tDEgesPiscN3 = tDConsPiscN3 - tDAssPiscN3;
tDConsFiJvPiscN3 = aDFiJvN3 / aDFishN3 * tDConsPiscN3;
tDConsFiAdPiscN3 = tDConsPiscN3 - tDConsFiJvPiscN3;
tDMortPiscN3 = kMortPiscN3 * aDPiscN3 +(1.0 - aDSatPiscN3) * tDEnvPiscN3;
tDMortPiscBotN3 = fDBoneN3 * tDMortPiscN3;
tDMortPiscDetN3 = tDMortPiscN3 - tDMortPiscBotN3;
tDHarvPiscN3 = ukHarvPiscN3 * aDPiscN3;
aPPiscN3 = cPDPiscN3 * aDPiscN3;
tPConsFiJvPiscN3 = rPDFiJvN3 * tDConsFiJvPiscN3;
tPConsFiAdPiscN3 = rPDFiAdN3 * tDConsFiAdPiscN3;
tPConsPiscN3 = tPConsFiJvPiscN3 + tPConsFiAdPiscN3;
rPDFoodPiscN3 = tPConsPiscN3 / tDConsPiscN3;
aNPiscN3 = cNDPiscN3 * aDPiscN3;
tNConsFiJvPiscN3 = rNDFiJvN3 * tDConsFiJvPiscN3;
tNConsFiAdPiscN3 = rNDFiAdN3 * tDConsFiAdPiscN3;
tNConsPiscN3 = tNConsFiJvPiscN3 + tNConsFiAdPiscN3;
rNDFoodPiscN3 = tNConsPiscN3 / tDConsPiscN3;
tDConsPiscNutN3 = (tDAssPiscN3 / fDAssPiscN3) * MAX (1.0, cNDPiscN3 / rNDFoodPiscN3 * fDAssPiscN3, cPDPiscN3 / rPDFoodPiscN3 * fDAssPiscN3);
tDEgesPiscNutN3 = tDConsPiscNutN3 - tDAssPiscN3;
tDConsFiJvPiscNutN3 = aDFiJvN3 / aDFishN3 * tDConsPiscNutN3;
tDConsFiAdPiscNutN3 = tDConsPiscNutN3 - tDConsFiJvPiscNutN3;
tPConsFiJvPiscNutN3 = rPDFiJvN3 * tDConsFiJvPiscNutN3;
tPConsFiAdPiscNutN3 = rPDFiAdN3 * tDConsFiAdPiscNutN3;
tPConsPiscNutN3 = tPConsFiJvPiscNutN3 + tPConsFiAdPiscNutN3;
tNConsFiJvPiscNutN3 = rNDFiJvN3 * tDConsFiJvPiscNutN3;
tNConsFiAdPiscNutN3 = rNDFiAdN3 * tDConsFiAdPiscNutN3;
tNConsPiscNutN3 = tNConsFiJvPiscNutN3 + tNConsFiAdPiscNutN3;
afPAssPiscN3 = MIN(1.0, ((cPDPiscN3 / rPDFoodPiscN3 * fDAssPiscN3) / (tDConsPiscNutN3 / tDConsPiscN3 )) );
tPAssPiscN3 = afPAssPiscN3 * tPConsPiscNutN3;
tPEgesPiscN3 = tPConsPiscNutN3 - tPAssPiscN3;
tPEgesPiscPO4N3 = fDissEgesPiscN3 * tPEgesPiscN3;
tPEgesPiscDetN3 = tPEgesPiscN3 - tPEgesPiscPO4N3;
tDRespPiscN3 = kDRespPiscN3 * uFunTmPiscN3 * aDPiscN3;
tPExcrPiscN3 = cPDPiscN3 * tDRespPiscN3;
tPMortPiscN3 = cPDPiscN3 * tDMortPiscN3;
tPMortPiscBotN3 = fPBoneN3 * tPMortPiscN3;
tPMortPiscPO4N3 = fDissMortPiscN3 *(tPMortPiscN3 - tPMortPiscBotN3);
tPMortPiscDetN3 = tPMortPiscN3 - tPMortPiscBotN3 - tPMortPiscPO4N3;
tPMigrPiscN3 = kMigrPiscN3 *(cPDPiscN3 * cDPiscInN3 - aPPiscN3);
tPHarvPiscN3 = cPDPiscN3 * tDHarvPiscN3;
afNAssPiscN3 = MIN(1.0, ((cNDPiscN3 / rNDFoodPiscN3 * fDAssPiscN3) / (tDConsPiscNutN3 / tDConsPiscN3 )) );
tNAssPiscN3 = afNAssPiscN3 * tNConsPiscNutN3;
tNEgesPiscN3 = tNConsPiscNutN3 - tNAssPiscN3;
tNEgesPiscNH4N3 = fDissEgesPiscN3 * tNEgesPiscN3;
tNEgesPiscDetN3 = tNEgesPiscN3 - tNEgesPiscNH4N3;
tNExcrPiscN3 = cNDPiscN3 * tDRespPiscN3;
tNMortPiscN3 = cNDPiscN3 * tDMortPiscN3;
tNMortPiscBotN3 = fDBoneN3 * tNMortPiscN3;
tNMortPiscNH4N3 = fDissMortPiscN3 *(tNMortPiscN3 - tNMortPiscBotN3);
tNMortPiscDetN3 = tNMortPiscN3 - tNMortPiscBotN3 - tNMortPiscNH4N3;
tNMigrPiscN3 = kMigrPiscN3 *(cNDPiscN3 * cDPiscInN3 - aNPiscN3);
tNHarvPiscN3 = cNDPiscN3 * tDHarvPiscN3;
tDWebBentN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tDMigrBentN3 + tDAssBentN3 - tDConsFiAdN3 - tDRespBentN3 - tDMortBentN3 ENDIF;
tPWebBentN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tPMigrBentN3 + tPAssBentN3 - tPConsFiAdN3 - tPExcrBentN3 - tPMortBentN3 ENDIF;
tNWebBentN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tNMigrBentN3 + tNAssBentN3 - tNConsFiAdN3 - tNExcrBentN3 - tNMortBentN3 ENDIF;
tDWebFiJvN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tDMigrFiJvN3 + tDReprFishN3 - tDAgeFishN3 + tDAssFiJvN3 - tDRespFiJvN3 - tDMortFiJvN3 - tDConsFiJvPiscNutN3 ENDIF;
tPWebFiJvN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tPMigrFiJvN3 + tPReprFishN3 - tPAgeFishN3 + tPAssFiJvN3 - tPExcrFiJvN3 - tPMortFiJvN3 - tPConsFiJvPiscNutN3 ENDIF;
tNWebFiJvN3 =IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tNMigrFiJvN3 + tNReprFishN3 - tNAgeFishN3 + tNAssFiJvN3 - tNExcrFiJvN3 - tNMortFiJvN3 - tNConsFiJvPiscNutN3 ENDIF;
tDWebFiAdN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tDMigrFiAdN3 + tDAssFiAdN3 - tDRespFiAdN3 - tDMortFiAdN3 - tDReprFishN3 + tDAgeFishN3 - tDConsFiAdPiscNutN3 - tDHarvFishN3 ENDIF;
tPWebFiAdN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tPMigrFiAdN3 + tPAssFiAdN3 - tPExcrFiAdN3 - tPMortFiAdN3 - tPReprFishN3 + tPAgeFishN3 - tPConsFiAdPiscNutN3 - tPHarvFishN3 ENDIF;
tNWebFiAdN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tNMigrFiAdN3 + tNAssFiAdN3 - tNExcrFiAdN3 - tNMortFiAdN3 - tNReprFishN3 + tNAgeFishN3 - tNConsFiAdPiscNutN3 - tNHarvFishN3 ENDIF;
tDWebPiscN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tDMigrPiscN3 + tDAssPiscN3 - tDRespPiscN3 - tDMortPiscN3 - tDHarvPiscN3 ENDIF;
wDWebZooHypN3 = IF (FALSE EQ InclWebN3 OR aInclStratN3 EQ FALSE) THEN 0.0 ELSE wDAssZooHypN3 - wDRespZooHypN3 - wDMortZooHypN3 - tDConsFiJvN3 * (( aDTotZooN3 - oDZooEpiN3 * uDepthWEpiN3) / (aDTotZooN3 + NearZeroN3)) / uDepthWHypN3 ENDIF;
wDWebDetWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsDetZooHypN3 + wDEgesZooHypN3 + wDMortZooHypN3 +(tDEgesFiJvN3 * uFiJvEgesHypN3 + tDEgesFiAdN3 * uFiAdEgesHypN3 + tDMortFiJvDetN3 * uFiJvMortHypN3 + tDMortFiAdDetN3 * uFiAdMortHypN3 + tDEgesPiscNutN3 * uPiscEgesHypN3 + tDMortPiscDetN3 * uPiscMortHypN3) / uDepthWHypN3 ENDIF;
wDWebDiatWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsDiatZooHypN3 ENDIF;
wDWebGrenWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsGrenZooHypN3 ENDIF;
wDWebBlueWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsBlueZooHypN3 ENDIF;
wDWebZooEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wDAssZooEpiN3 - wDRespZooEpiN3 - wDMortZooEpiN3 - tDConsFiJvN3 * (oDZooEpiN3 * uDepthWEpiN3 / (aDTotZooN3 + NearZeroN3) ) / uDepthWEpiN3 ENDIF;
wDWebDetWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsDetZooEpiN3 + wDEgesZooEpiN3 + wDMortZooEpiN3 +(tDEgesFiJvN3 * ( 1.0 - uFiJvEgesHypN3 ) + tDEgesFiAdN3 * ( 1.0 - uFiAdEgesHypN3 ) + tDMortFiJvDetN3 * ( 1.0 - uFiJvMortHypN3 ) + tDMortFiAdDetN3 * ( 1.0 - uFiAdMortHypN3 ) + tDEgesPiscNutN3 * ( 1.0 - uPiscEgesHypN3 ) + tDMortPiscDetN3 * ( 1.0 - uPiscMortHypN3)) / uDepthWEpiN3 ENDIF;
wDWebDiatWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsDiatZooEpiN3 ENDIF;
wDWebGrenWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsGrenZooEpiN3 ENDIF;
wDWebBlueWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDConsBlueZooEpiN3 ENDIF;
tDWebBlueSurfN3 = IF (InclWebN3 EQ FALSE OR InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE - tDConsBlueZooSurfN3 ENDIF;
tDWebTotTN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wDRespZooEpiN3 * uDepthWEpiN3 - wDRespZooHypN3 * uDepthWHypN3 + tDMigrFiJvN3 + tDMigrFiAdN3 + tDMigrPiscN3 + tDMigrBentN3 - tDRespFiJvN3 - tDRespFiAdN3 - tDRespPiscN3 - tDRespBentN3 - tDMortFiJvBotN3 - tDMortFiAdBotN3- tDMortPiscBotN3 - tDHarvFishN3 - tDHarvPiscN3 ENDIF;
wPWebZooHypN3 = IF (FALSE EQ InclWebN3 OR aInclStratN3 EQ FALSE) THEN 0.0 ELSE wPAssZooHypN3 - wPExcrZooHypN3 - wPMortZooHypN3 - tPConsFiJvN3 * (( aPTotZooN3 - oPZooEpiN3 * uDepthWEpiN3 ) / (aPTotZooN3 + NearZeroN3) ) / uDepthWHypN3 ENDIF;
wPWebPO4WHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wPExcrZooHypN3 + wPEgesZooPO4HypN3 + wPMortZooPO4HypN3 +(tPExcrFiJvN3 *uFiJvExcrHypN3 + tPExcrFiAdN3 * uFiAdExcrHypN3 + tPEgesFiJvPO4N3 * uFiJvEgesHypN3 + tPEgesFiAdPO4N3 * uFiAdEgesHypN3 + tPMortFiJvPO4N3 * uFiJvMortHypN3 + tPMortFiAdPO4N3 * uFiAdMortHypN3+ tPExcrPiscN3 * uPiscExcrHypN3 + tPEgesPiscPO4N3 * uPiscEgesHypN3 + tPMortPiscPO4N3 * uPiscMortHypN3 ) / uDepthWHypN3 ENDIF;
wPWebDetWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsDetZooHypN3 + wPEgesZooDetHypN3 + wPMortZooDetHypN3 +(tPEgesFiJvDetN3 * uFiJvEgesHypN3 + tPEgesFiAdDetN3 * uFiAdEgesHypN3+ tPMortFiJvDetN3 * uFiJvMortHypN3 + tPMortFiAdDetN3 * uFiAdMortHypN3+ tPEgesPiscDetN3 * uPiscEgesHypN3+ tPMortPiscDetN3 * uPiscMortHypN3) / uDepthWHypN3 ENDIF;
wPWebDiatWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsDiatZooHypN3 ENDIF;
wPWebGrenWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsGrenZooHypN3 ENDIF;
wPWebBlueWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsBlueZooHypN3 ENDIF;
wPWebZooEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wPAssZooEpiN3 - wPExcrZooEpiN3 - wPMortZooEpiN3 - tPConsFiJvN3 * (oPZooEpiN3 * uDepthWEpiN3 / (aPTotZooN3 + NearZeroN3)) / uDepthWEpiN3 ENDIF;
wPWebPO4WEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wPExcrZooEpiN3 + wPEgesZooPO4EpiN3 + wPMortZooPO4EpiN3 +(tPExcrFiJvN3 * ( 1.0 -uFiJvExcrHypN3 ) + tPExcrFiAdN3 * ( 1.0 - uFiAdExcrHypN3 )+ tPEgesFiJvPO4N3 * ( 1.0 - uFiJvEgesHypN3 ) + tPEgesFiAdPO4N3 * ( 1.0 - uFiAdEgesHypN3 ) + tPMortFiJvPO4N3 * ( 1.0 - uFiJvMortHypN3 ) + tPMortFiAdPO4N3 * ( 1.0 - uFiAdMortHypN3 )+ tPExcrPiscN3 * ( 1.0 - uPiscExcrHypN3 ) + tPEgesPiscPO4N3 * ( 1.0 - uPiscEgesHypN3 ) + tPMortPiscPO4N3 * ( 1.0 - uPiscMortHypN3)) / uDepthWEpiN3 ENDIF;
wPWebDetWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsDetZooEpiN3 + wPEgesZooDetEpiN3 + wPMortZooDetEpiN3 +(tPEgesFiJvDetN3 * ( 1.0 - uFiJvEgesHypN3 ) + tPEgesFiAdDetN3 * ( 1.0 - uFiAdEgesHypN3 )+ tPMortFiJvDetN3 * ( 1.0 - uFiJvMortHypN3 ) + tPMortFiAdDetN3 * ( 1.0 - uFiAdMortHypN3 )+ tPEgesPiscDetN3 * ( 1.0 - uPiscEgesHypN3 )+ tPMortPiscDetN3 * ( 1.0 - uPiscMortHypN3 )) / uDepthWEpiN3 ENDIF;
wPWebDiatWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsDiatZooEpiN3 ENDIF;
wPWebGrenWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsGrenZooEpiN3 ENDIF;
wPWebBlueWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wPConsBlueZooEpiN3 ENDIF;
tPWebBlueSurfN3 = IF (InclWebN3 EQ FALSE OR InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE - tPConsBlueZooSurfN3 ENDIF;
tPWebTotTN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tPMigrFiJvN3 + tPMigrFiAdN3 + tPMigrPiscN3 + tPMigrBentN3 - tPMortFiJvBotN3 - tPMortFiAdBotN3- tPMortPiscBotN3 - tPHarvFishN3 - tPHarvPiscN3 ENDIF;
tNEgesFiAdNH4N3 = fDissEgesFishN3 * tNEgesFiAdN3;
tNEgesFiAdDetN3 = tNEgesFiAdN3 - tNEgesFiAdNH4N3;
wNWebNO3WHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE 0.0 ENDIF;
wNWebNO3WEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE 0.0 ENDIF;
wNWebZooHypN3 = IF (FALSE EQ InclWebN3 OR aInclStratN3 EQ FALSE) THEN 0.0 ELSE wNAssZooHypN3 - wNExcrZooHypN3 - wNMortZooHypN3 - tNConsFiJvN3 * (( aNTotZooN3 -oNZooEpiN3 * uDepthWEpiN3 ) / (aNTotZooN3 + NearZeroN3) ) / uDepthWHypN3 ENDIF;
wNWebNH4WHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wNExcrZooHypN3 + wNEgesZooNH4HypN3 + wNMortZooNH4HypN3 +(tNExcrFiJvN3 * uFiJvExcrHypN3 + tNExcrFiAdN3 * uFiAdExcrHypN3 + tNEgesFiJvNH4N3 * uFiJvEgesHypN3+ tNEgesFiAdNH4N3 * uFiAdEgesHypN3 + tNMortFiAdNH4N3 *uFiAdMortHypN3+ tNMortFiJvNH4N3*uFiJvMortHypN3 + tNExcrPiscN3 *uPiscExcrHypN3 + tNEgesPiscNH4N3 *uPiscEgesHypN3 + tNMortPiscNH4N3 *uPiscMortHypN3) / uDepthWHypN3 ENDIF;
wNWebDetWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsDetZooHypN3 + wNEgesZooDetHypN3 + wNMortZooDetHypN3 +(tNEgesFiJvDetN3 * uFiJvEgesHypN3 +tNEgesFiAdDetN3 * uFiAdEgesHypN3+ tNMortFiJvDetN3 * uFiJvMortHypN3 + tNMortFiAdDetN3 * uFiAdMortHypN3 + tNEgesPiscDetN3 * uPiscEgesHypN3 + tNMortPiscDetN3 * uPiscMortHypN3) / uDepthWHypN3 ENDIF;
wNWebDiatWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsDiatZooHypN3 ENDIF;
wNWebGrenWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsGrenZooHypN3 ENDIF;
wNWebBlueWHypN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsBlueZooHypN3 ENDIF;
wNWebZooEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wNAssZooEpiN3 - wNExcrZooEpiN3 - wNMortZooEpiN3 - tNConsFiJvN3 * (oNZooEpiN3 * uDepthWEpiN3 / (aNTotZooN3 + NearZeroN3) ) / uDepthWEpiN3 ENDIF;
wNWebNH4WEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wNExcrZooEpiN3 + wNEgesZooNH4EpiN3 + wNMortZooNH4EpiN3 +(tNExcrFiJvN3 * ( 1.0 - uFiJvExcrHypN3) + tNExcrFiAdN3 * ( 1.0 - uFiAdExcrHypN3) + tNEgesFiJvNH4N3 * ( 1.0 - uFiJvEgesHypN3 ) + tNEgesFiAdNH4N3 * ( 1.0 - uFiAdEgesHypN3 ) + tNMortFiAdNH4N3 * ( 1.0 -uFiAdMortHypN3 ) + tNMortFiJvNH4N3* ( 1.0 -uFiJvMortHypN3) + tNExcrPiscN3 * ( 1.0 -uPiscExcrHypN3 ) + tNEgesPiscNH4N3 * ( 1.0 -uPiscEgesHypN3 ) + tNMortPiscNH4N3 * ( 1.0 -uPiscMortHypN3)) / uDepthWEpiN3 ENDIF;
wNWebDetWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsDetZooEpiN3 + wNEgesZooDetEpiN3 + wNMortZooDetEpiN3 +(tNEgesFiJvDetN3 * ( 1.0 - uFiJvEgesHypN3 ) +tNEgesFiAdDetN3 * ( 1.0 - uFiAdEgesHypN3 ) + tNMortFiJvDetN3 * ( 1.0 - uFiJvMortHypN3 ) + tNMortFiAdDetN3 * ( 1.0 - uFiAdMortHypN3 ) + tNEgesPiscDetN3 * ( 1.0 - uPiscEgesHypN3 ) + tNMortPiscDetN3 * ( 1.0 - uPiscMortHypN3 )) / uDepthWEpiN3 ENDIF;
wNWebDiatWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsDiatZooEpiN3 ENDIF;
wNWebGrenWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsGrenZooEpiN3 ENDIF;
wNWebBlueWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE - wNConsBlueZooEpiN3 ENDIF;
tNWebBlueSurfN3 = IF (InclWebN3 EQ FALSE OR InclSurfN3 EQ FALSE OR aDBlueSurfN3 LT cDBlueSurfMinN3) THEN 0.0 ELSE - tNConsBlueZooSurfN3 ENDIF;
tNWebTotTN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE tNMigrFiJvN3 + tNMigrFiAdN3 + tNMigrPiscN3 + tNMigrBentN3 - tNMortFiJvBotN3- tNMortFiAdBotN3 - tNMortPiscBotN3 - tNHarvFishN3 - tNHarvPiscN3 ENDIF;
wSiWebDetWEpiN3 = IF (FALSE EQ InclWebN3) THEN 0.0 ELSE wSiConsDiatZooEpiN3 ENDIF;
aPrefAveEpiN3 = (cPrefDiatN3 * oDDiatWEpiN3 + cPrefGrenN3 * oDGrenWEpiN3 + cPrefBlueN3 * oDBlueWEpiN3 + cPrefDetN3 * oDDetWEpiN3) / oDOMWEpiN3;
wDConsZoo2EpiN3 = aFiltEpiN3 * aPrefAveEpiN3 * oDOMWEpiN3 * oDZooEpiN3;
aDConsZooSpEpiN3 = wDConsZooEpiN3 / oDZooEpiN3;
aDAssZooSpEpiN3 = wDAssZooEpiN3 / oDZooEpiN3;
aDGrazSpEpiN3 = wDConsZooEpiN3 / oDOMWEpiN3;
aPConsZooSpEpiN3 = wPConsZooEpiN3 / oPZooEpiN3;
aPGrazSpEpiN3 = wPConsZooEpiN3 / oPOMWEpiN3;
aNConsZooSpEpiN3 = wNConsZooEpiN3 / oNZooEpiN3;
aNGrazSpEpiN3 = wNConsZooEpiN3 / oNOMWEpiN3;
tDSetTotEpiN3 = tDSetIMEpiN3 + tDSetDetEpiN3 + tDSetPhytEpiN3;
tPSetTotEpiN3 = tPSetAIMEpiN3 + tPSetDetEpiN3 + tPSetPhytEpiN3;
tNSetTotEpiN3 = tNSetDetEpiN3 + tNSetPhytEpiN3;
tDResusTotN3 = tDResusDeadN3 + tDResusPhytTotN3;
tPResusTotN3 = tPResusDetN3 + tPResusAIMN3 + tPResusPhytN3 + tPResusPO4N3;
tNResusTotN3 = tNResusDetN3 + tNResusNH4N3 + tNResusNO3N3 + tNResusPhytN3;
aDepthStartN3 = IF (sTimeN3 EQ bTimeDredN3) THEN uDepthWN3 ELSE aDepthStartN3 ENDIF;
akDredDepthN3 = IF ((sTimeN3 GE bTimeDredN3) AND (sTimeN3 LT bTimeDredN3 + cLengDredN3) AND (aDepthStartN3 LE cDepthRefN3 - cDepthSN3)) THEN (LN(cDepthRefN3 / aDepthStartN3)) / cLengDredN3 ELSE 0.0 ENDIF;
akDredN3 = IF ((sTimeN3 GE bTimeDredN3) AND (sTimeN3 LT bTimeDredN3 + cLengDredN3) AND (aDepthStartN3 LE cDepthRefN3 - cDepthSN3)) THEN (- LN(1.0 - fEffDredN3)) / cLengDredN3 ELSE 0.0 ENDIF;
akDredBentN3 = IF ((sTimeN3 GE bTimeDredN3) AND (sTimeN3 LT bTimeDredN3 + cLengDredN3) AND (aDepthStartN3 LE cDepthRefN3 - cDepthSN3)) THEN (- LN(1.0 - fEffDredBentN3)) / cLengDredN3 ELSE 0.0 ENDIF;
vDredDepthWN3 =IF (aInclStratN3 EQ TRUE) THEN 0.0 ELSE akDredDepthN3 * uDepthWN3 ENDIF;
tDDredDetSN3 = akDredN3 * aDDetSN3;
tPDredDetSN3 = akDredN3 * aPDetSN3;
tNDredDetSN3 = akDredN3 * aNDetSN3;
tSiDredDetSN3 = akDredN3 * aSiDetSN3;
tPDredAIMSN3 = akDredN3 * aPAIMSN3;
tDDredNetSoilN3 = -(tDDredDetSN3 / cRhoOMN3) * bRhoSolidSoilN3;
tDDredNetIMSN3 = (1.0 - fDOrgSoilN3) * tDDredNetSoilN3;
tDDredNetHumSN3 = fDOrgSoilN3 * tDDredNetSoilN3;
tPDredNetHumSN3 = cPDSoilOMN3 * tDDredNetHumSN3;
tNDredNetHumSN3 = cNDSoilOMN3 * tDDredNetHumSN3;
tDDredDiatSN3 = akDredN3 * aDDiatSN3;
tPDredDiatSN3 = akDredN3 * aPDiatSN3;
tNDredDiatSN3 = akDredN3 * aNDiatSN3;
tDDredGrenSN3 = akDredN3 * aDGrenSN3;
tPDredGrenSN3 = akDredN3 * aPGrenSN3;
tNDredGrenSN3 = akDredN3 * aNGrenSN3;
tDDredBlueSN3 = akDredN3 * aDBlueSN3;
tPDredBlueSN3 = akDredN3 * aPBlueSN3;
tNDredBlueSN3 = akDredN3 * aNBlueSN3;
tDDredPhytSN3 = tDDredDiatSN3+tDDredGrenSN3+tDDredBlueSN3;
tPDredPhytSN3 = tPDredDiatSN3+tPDredGrenSN3+tPDredBlueSN3;
tNDredPhytSN3 = tNDredDiatSN3+tNDredGrenSN3+tNDredBlueSN3;
tDDredBentN3 = IF (InclWebN3 EQ TRUE) THEN akDredBentN3 * aDBentN3 ELSE 0.0 ENDIF;
tPDredBentN3 = IF (InclWebN3 EQ TRUE) THEN akDredBentN3 * aPBentN3 ELSE 0.0 ENDIF;
tNDredBentN3 = IF (InclWebN3 EQ TRUE) THEN akDredBentN3 * aNBentN3 ELSE 0.0 ENDIF;
tDDredVegN3 = akDredN3 * aDVegN3;
tPDredVegN3 = akDredN3 * aPVegN3;
tNDredVegN3 = akDredN3 * aNVegN3;
tDDredNetTotN3 = tDDredDetSN3 - tDDredNetSoilN3 + tDDredPhytSN3 + tDDredBentN3 + tDDredVegN3;
tPDredNetTotN3 = tPDredDetSN3 - tPDredNetHumSN3 + tPDredAIMSN3 + tPDredPhytSN3 + tPDredBentN3 + tPDredVegN3;
tNDredNetTotN3 = tNDredDetSN3 - tNDredNetHumSN3 + tNDredPhytSN3 + tNDredBentN3 + tNDredVegN3;
tSiDredTotN3 = tSiDredDetSN3 + cSiDDiatN3 * tDDredDiatSN3;
tDIMSN3 = tDAbioIMSN3;
tDHumSN3 = tDAbioHumSN3;
tDDetSN3 = tDAbioDetSN3 + tDPrimDetSN3 + tDWebDetSN3 + tDBedDetSEpiN3 + tDBedDetSHypN3;
vDeltaSN3 = (tDIMSN3 / cRhoIMN3 +(tDHumSN3 + tDDetSN3) / cRhoOMN3)/(1.0 - bPorSN3);
vDeltaWN3 = IF (ConstDepthN3 EQ TRUE ) THEN 0.0 ELSE - vDeltaSN3 ENDIF;
tDBurIMN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN ((tDHumSN3 + tDDetSN3) +(cRhoOMN3 / cRhoIMN3) * tDIMSN3) / ((aDHumSN3 + aDDetSN3) / aDIMSN3 + cRhoOMN3 / cRhoIMN3) ELSE ((tDHumSN3 + tDDetSN3) +(cRhoOMN3 / cRhoIMN3) * tDIMSN3) / (fDOrgSoilN3 /(1.0 - fDOrgSoilN3) + cRhoOMN3 / cRhoIMN3) ENDIF;
tDBurOMN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN (aDHumSN3 + aDDetSN3) / aDIMSN3 * tDBurIMN3 ELSE fDOrgSoilN3 /(1.0 - fDOrgSoilN3) * tDBurIMN3 ENDIF;
tDBurDetN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN aDDetSN3 /(aDHumSN3 + aDDetSN3) * tDBurOMN3 ELSE 0.0 ENDIF;
tDBurHumN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN tDBurOMN3 - tDBurDetN3 ELSE tDBurOMN3 ENDIF;
tDBurTotN3 =IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN3 GE 0.0) THEN tDBurIMN3 + tDBurOMN3 ELSE tDBurIMN3 + tDBurOMN3 ENDIF;
tPBurHumN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN rPDHumSN3 * tDBurHumN3 ELSE cPDSoilOMN3 * tDBurHumN3 ENDIF;
tPBurDetN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN3 GE 0.0) THEN rPDDetSN3 * tDBurDetN3 ELSE 0.0 ENDIF;
tPBurAIMN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN aPAIMSN3 / aDIMSN3 * tDBurIMN3 ELSE 0.0 ENDIF;
tPBurPO4N3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN aPO4SN3 *(vDeltaSN3 / cDepthSN3) ELSE cPO4GroundN3 *(bPorSN3 * vDeltaSN3) ENDIF;
tPBurTotN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN tPBurDetN3 + tPBurHumN3 + tPBurAIMN3 + tPBurPO4N3 ELSE tPBurHumN3 + tPBurAIMN3 + tPBurPO4N3 ENDIF;
tNBurHumN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN rNDHumSN3 * tDBurHumN3 ELSE cNDSoilOMN3 * tDBurHumN3 ENDIF;
tNBurDetN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN rNDDetSN3 * tDBurDetN3 ELSE 0.0 ENDIF;
tNBurNH4N3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN aNH4SN3 *(vDeltaSN3 / cDepthSN3) ELSE cNH4GroundN3 *(bPorSN3 * vDeltaSN3) ENDIF;
tNBurNO3N3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN aNO3SN3 *(vDeltaSN3 / cDepthSN3) ELSE cNO3GroundN3 *(bPorSN3 * vDeltaSN3) ENDIF;
tNBurTotN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN tNBurDetN3 + tNBurHumN3 + tNBurNH4N3 + tNBurNO3N3 ELSE tNBurHumN3 + tNBurNH4N3 + tNBurNO3N3 ENDIF;
tSiBurDetN3 = IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN rSiDDetSN3 * tDBurDetN3 ELSE 0.0 ENDIF;
tSiBurTotN3 =IF (InclBurN3 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN3 GE 0.0) THEN tSiBurDetN3 ELSE 0.0 ENDIF;
aRelDeltaWEpiN3 = IF ( aInclStratN3 EQ TRUE ) THEN (vDeltaWN3 ) / uDepthWEpiN3 ELSE (vDeltaWN3 + vDredDepthWN3) / uDepthWEpiN3 ENDIF;
aRelDeltaWHypN3 = IF ( aInclStratN3 EQ FALSE ) THEN 0.0 ELSE (vDeltaWN3 + vDredDepthWN3) / uDepthWHypN3 ENDIF ;
aPFishN3 = aPFiJvN3 + aPFiAdN3;
aNFishN3 = aNFiJvN3 + aNFiAdN3;
aDRelTotTN3 = uDepthWHypN3 * aRelDeltaWHypN3 * ( oDDetWHypN3 + oDIMWHypN3 + oDDiatWHypN3 + oDGrenWHypN3 + oDBlueWHypN3 + oDZooHypN3 ) + fMarshN3 * uDepthWMN3 * aRelDeltaWMN3 * ( oDDetWMN3 + oDIMWMN3 + oDDiatWMN3 + oDGrenWMN3 + oDBlueWMN3 + oDZooMN3) + uDepthWEpiN3 * aRelDeltaWEpiN3 * (oDDetWEpiN3 + oDIMWEpiN3 + oDDiatWEpiN3 + oDGrenWEpiN3 + oDBlueWEpiN3 + oDZooEpiN3 );
aNRelTotTN3 = uDepthWHypN3 * aRelDeltaWHypN3 * ( oNH4WHypN3 + oNO3WHypN3 + oNDetWHypN3 + oNDiatWHypN3 + oNGrenWHypN3 + oNBlueWHypN3 + oNZooHypN3 ) + fMarshN3 * uDepthWMN3 * aRelDeltaWMN3 * ( oNH4WMN3 + oNO3WMN3 + oNDetWMN3 + oNDiatWMN3 + oNGrenWMN3 + oNBlueWMN3 + oNZooMN3 ) + uDepthWEpiN3 * aRelDeltaWEpiN3 * ( oNH4WEpiN3 + oNO3WEpiN3 + oNDetWEpiN3 + oNDiatWEpiN3 + oNGrenWEpiN3 + oNBlueWEpiN3 + oNZooEpiN3 );
aPRelTotTN3 = uDepthWHypN3 * aRelDeltaWHypN3 * ( oPO4WHypN3 + oPAIMWHypN3 + oPDetWHypN3 + oPDiatWHypN3 + oPGrenWHypN3 + oPBlueWHypN3 + oPZooHypN3 ) + fMarshN3 * uDepthWMN3 * aRelDeltaWMN3 * (oPO4WMN3 + oPAIMWMN3 + oPDetWMN3 + oPDiatWMN3 + oPGrenWMN3 + oPBlueWMN3 + oPZooMN3 ) + uDepthWEpiN3 * aRelDeltaWEpiN3 * (oPO4WEpiN3 + oPAIMWEpiN3 + oPDetWEpiN3 + oPDiatWEpiN3 + oPGrenWEpiN3 + oPBlueWEpiN3 + oPZooEpiN3 );
aSiRelTotTN3 = uDepthWHypN3 * aRelDeltaWHypN3 * ( oSiO2WHypN3 + oSiDetWHypN3 + cSiDDiatN3*oDDiatWHypN3) + fMarshN3 * uDepthWMN3 * aRelDeltaWMN3 * ( oSiO2WMN3 + oSiDetWMN3 + cSiDDiatN3*oDDiatWMN3) + uDepthWEpiN3 * aRelDeltaWEpiN3 * ( oSiO2WEpiN3 + oSiDetWEpiN3 + cSiDDiatN3*oDDiatWEpiN3);
aO2RelTotTN3 = uDepthWHypN3 * aRelDeltaWHypN3* oO2WHypN3 + fMarshN3 * uDepthWMN3 * aRelDeltaWMN3 * oO2WMN3 + uDepthWEpiN3 * aRelDeltaWEpiN3 * oO2WEpiN3 ;
aDTotTHypN3 = IF (aInclStratN3 EQ TRUE) THEN (oDIMWHypN3+oDDetWHypN3+oDDiatWHypN3+oDGrenWHypN3+oDBlueWHypN3+oDZooHypN3) * uDepthWHypN3 ELSE 0.0 ENDIF;
aNTotTHypN3 = IF (aInclStratN3 EQ TRUE) THEN (oNH4WHypN3+oNO3WHypN3+oNDetWHypN3+oNDiatWHypN3+oNGrenWHypN3+oNBlueWHypN3 +oNZooHypN3)*uDepthWHypN3 ELSE 0.0 ENDIF;
aPTotTHypN3 = IF (aInclStratN3 EQ TRUE) THEN (oPO4WHypN3+oPDetWHypN3+oPDiatWHypN3+oPGrenWHypN3+oPBlueWHypN3 +oPZooHypN3+oPAIMWHypN3) * uDepthWHypN3 ELSE 0.0 ENDIF;
aSiTotTHypN3 = IF (aInclStratN3 EQ TRUE) THEN (oSiO2WHypN3 + oSiDetWHypN3 + cSiDDiatN3*oDDiatWHypN3) *uDepthWHypN3 ELSE 0.0 ENDIF;
aO2TotTHypN3 = IF (aInclStratN3 EQ TRUE) THEN (oO2WHypN3 ) *uDepthWHypN3 ELSE 0.0 ENDIF;
aDTotTN3 = aDTotTHypN3 + (oDIMWEpiN3+oDDetWEpiN3+oDDiatWEpiN3+oDGrenWEpiN3+oDBlueWEpiN3+oDZooEpiN3) * uDepthWEpiN3 +aDFishN3+aDPiscN3+aDVegN3 +aDIMSN3+aDHumSN3+aDDetSN3+aDDiatSN3+aDGrenSN3+aDBlueSN3+aDBentN3 + aDTotMN3 + aDBlueSurfN3;
aNTotTN3 = aNTotTHypN3+ (oNH4WEpiN3+oNO3WEpiN3+oNDetWEpiN3+oNDiatWEpiN3+oNGrenWEpiN3+oNBlueWEpiN3 +oNZooEpiN3)*uDepthWEpiN3 +aNFishN3+aNPiscN3+aNVegN3 +aNH4SN3+aNO3SN3+aNDetSN3+aNHumSN3+aNDiatSN3+aNGrenSN3+aNBlueSN3 +aNBentN3 + aNTotMN3 + aNBlueSurfN3;
aPTotTN3 = aPTotTHypN3 + (oPO4WEpiN3+oPDetWEpiN3+oPDiatWEpiN3+oPGrenWEpiN3+oPBlueWEpiN3 +oPZooEpiN3+oPAIMWEpiN3) * uDepthWEpiN3 +aPFishN3+aPPiscN3+aPVegN3 +aPO4SN3+aPDetSN3+aPHumSN3+aPDiatSN3+aPGrenSN3+aPBlueSN3 +aPAIMSN3+aPBentN3 + aPTotMN3 +aPBlueSurfN3;
aSiTotTN3 = aSiTotTHypN3 + (oSiO2WEpiN3 + oSiDetWEpiN3 + cSiDDiatN3*oDDiatWEpiN3) *uDepthWEpiN3 + aSiDetSN3 + cSiDDiatN3*aDDiatSN3 + aSiTotMN3;
aO2TotTN3 = aO2TotTHypN3 + ( oO2WEpiN3) *uDepthWEpiN3 + aO2TotMN3;
tDBedTotTN3 = IF InclVegN3 EQ TRUE THEN tDMigrVegN3 + tDProdVegHypN3+ tDProdVegEpiN3 - tDRespVegN3 - tDManVegN3 - tDAssVegBirdN3 ELSE 0.0 ENDIF;
tPBedTotTN3 = IF InclVegN3 EQ TRUE THEN tPMigrVegN3 - tPManVegN3 - tPAssVegBirdN3 ELSE 0.0 ENDIF;
tNBedTotTN3 = IF InclVegN3 EQ TRUE THEN tNMigrVegN3 - tNManVegN3 - tNAssVegBirdN3 ELSE 0.0 ENDIF ;
aDErrorN3 = aDTotTN3 - aDExtTotTN3;
aNErrorN3 = aNTotTN3 - aNExtTotTN3;
aPErrorN3 = aPTotTN3 - aPExtTotTN3;
aSiErrorN3 = aSiTotTN3 - aSiExtTotTN3;
aO2ErrorN3 = aO2TotTN3 - aO2ExtTotTN3;
aDepthErrorN3 = sDepthWN3 - aDepthExtTotTN3;
cCheckVegHeightN3 = IF ( aVegWinN3 EQ 1 AND  uVegHeightN3 LT MIN (cVegHeightWinN3, uDepthWN3) ) THEN 1.0 ELSEIF ( aVegWinN3 EQ 1 AND  uVegHeightN3 GT MIN (cVegHeightWinN3, uDepthWN3) ) THEN 2.0 ELSEIF ( aVegWinN3 EQ 0 AND  uVegHeightN3 LT MIN (cVegHeightN3, uDepthWN3) ) THEN  3.0 ELSEIF ( aVegWinN3 EQ 0 AND  uVegHeightN3 GT MIN (cVegHeightN3, uDepthWN3) ) THEN 4.0 ELSE 0.0 ENDIF;
sTimeN4 = time + DayStartN4;
DaysInYearN4 = DaysPerYearN4* 1;
aInclStratN4 =IF ( InclStratN4 EQ FALSE ) THEN 0.0 ELSE 1.0 ENDIF;
uDepthMixMeasN4 =IF ( calcMixDepthN4 EQ TRUE ) THEN cAMixN4 * POW ( cFetchN4 , (cBMixN4) ) ELSEIF (ReadMixDepthN4 EQ TRUE) THEN mMixDepthN4 ELSE cMixDepthN4 ENDIF;
uDepthWN4= IF sDepthWN4 GT (cMinDepthHypEpiN4 + cMinDepthHypEpiN4) THEN sDepthWN4 ELSE (cMinDepthHypEpiN4 + cMinDepthHypEpiN4) ENDIF;
uDepthWHypN4 =IF ( ( aInclStratN4 EQ TRUE ) AND ((uDepthWN4 - sMixDepthWN4 ) GE cMinDepthHypEpiN4 ) ) THEN uDepthWN4 - sMixDepthWN4  ELSE cMinDepthHypEpiN4 ENDIF;
uDepthWEpiN4 =IF( ( aInclStratN4 EQ TRUE ) AND ( sMixDepthWN4 GE cMinDepthHypEpiN4 ) AND ( uDepthWN4 GE sMixDepthWN4 ) ) THEN sMixDepthWN4 ELSEIF ( ( aInclStratN4 EQ TRUE ) AND ( (sMixDepthWN4 LE cMinDepthHypEpiN4 ) OR (uDepthWN4 LE cMinDepthHypEpiN4 ) ) ) THEN cMinDepthHypEpiN4 ELSEIF ( aInclStratN4 EQ FALSE) THEN uDepthWN4 ELSE uDepthWN4 - uDepthWHypN4 ENDIF;
MassHypN4 = IF CalcMassN4 EQ TRUE THEN uDepthWHypN4 ELSE 1.0 ENDIF;
MassEpiN4 = IF CalcMassN4 EQ TRUE THEN uDepthWEpiN4 ELSE 1.0 ENDIF;
MassWMN4 = IF CalcMassN4 EQ TRUE THEN sDepthWMN4 ELSE 1.0 ENDIF;
oNH4WHypN4= IF sNH4WHypN4 GT NearZeroN4 THEN sNH4WHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNO3WHypN4= IF sNO3WHypN4 GT NearZeroN4 THEN sNO3WHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPO4WHypN4= IF sPO4WHypN4 GT NearZeroN4 THEN sPO4WHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPAIMWHypN4= IF sPAIMWHypN4 GT NearZeroN4 THEN sPAIMWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oSiO2WHypN4= IF sSiO2WHypN4 GT NearZeroN4 THEN sSiO2WHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oO2WHypN4= IF sO2WHypN4 GT NearZeroN4 THEN sO2WHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDDetWHypN4= IF sDDetWHypN4 GT NearZeroN4 THEN sDDetWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNDetWHypN4= IF sNDetWHypN4 GT NearZeroN4 THEN sNDetWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPDetWHypN4= IF sPDetWHypN4 GT NearZeroN4 THEN sPDetWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oSiDetWHypN4= IF sSiDetWHypN4 GT NearZeroN4 THEN sSiDetWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDIMWHypN4= IF sDIMWHypN4 GT NearZeroN4 THEN sDIMWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDDiatWHypN4= IF sDDiatWHypN4 GT NearZeroN4 THEN sDDiatWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNDiatWHypN4= IF sNDiatWHypN4 GT NearZeroN4 THEN sNDiatWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPDiatWHypN4= IF sPDiatWHypN4 GT NearZeroN4 THEN sPDiatWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDGrenWHypN4= IF sDGrenWHypN4 GT NearZeroN4 THEN sDGrenWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNGrenWHypN4= IF sNGrenWHypN4 GT NearZeroN4 THEN sNGrenWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPGrenWHypN4= IF sPGrenWHypN4 GT NearZeroN4 THEN sPGrenWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDBlueWHypN4= IF sDBlueWHypN4 GT NearZeroN4 THEN sDBlueWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNBlueWHypN4= IF sNBlueWHypN4 GT NearZeroN4 THEN sNBlueWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPBlueWHypN4= IF sPBlueWHypN4 GT NearZeroN4 THEN sPBlueWHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oDZooHypN4= IF sDZooHypN4 GT NearZeroN4 THEN sDZooHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oNZooHypN4= IF sNZooHypN4 GT NearZeroN4 THEN sNZooHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
oPZooHypN4= IF sPZooHypN4 GT NearZeroN4 THEN sPZooHypN4 / MassHypN4 ELSE NearZeroN4 ENDIF;
aDFiAdN4= IF sDFiAdN4 GT NearZeroN4 THEN sDFiAdN4 ELSE NearZeroN4 ENDIF;
aDFiJvN4= IF sDFiJvN4 GT NearZeroN4 THEN sDFiJvN4 ELSE NearZeroN4 ENDIF;
aNFiAdN4= IF sNFiAdN4 GT NearZeroN4 THEN sNFiAdN4 ELSE NearZeroN4 ENDIF;
aNFiJvN4= IF sNFiJvN4 GT NearZeroN4 THEN sNFiJvN4 ELSE NearZeroN4 ENDIF;
aPFiAdN4= IF sPFiAdN4 GT NearZeroN4 THEN sPFiAdN4 ELSE NearZeroN4 ENDIF;
aPFiJvN4= IF sPFiJvN4 GT NearZeroN4 THEN sPFiJvN4 ELSE NearZeroN4 ENDIF;
aDPiscN4= IF sDPiscN4 GT NearZeroN4 THEN sDPiscN4 ELSE NearZeroN4 ENDIF;
aNH4SN4= IF sNH4SN4 GT NearZeroN4 THEN sNH4SN4 ELSE NearZeroN4 ENDIF;
aNO3SN4= IF sNO3SN4 GT NearZeroN4 THEN sNO3SN4 ELSE NearZeroN4 ENDIF;
aPO4SN4= IF sPO4SN4 GT NearZeroN4 THEN sPO4SN4 ELSE NearZeroN4 ENDIF;
aPAIMSN4= IF sPAIMSN4 GT NearZeroN4 THEN sPAIMSN4 ELSE NearZeroN4 ENDIF;
aDDetSN4= IF sDDetSN4 GT NearZeroN4 THEN sDDetSN4 ELSE NearZeroN4 ENDIF;
aNDetSN4= IF sNDetSN4 GT NearZeroN4 THEN sNDetSN4 ELSE NearZeroN4 ENDIF;
aPDetSN4= IF sPDetSN4 GT NearZeroN4 THEN sPDetSN4 ELSE NearZeroN4 ENDIF;
aSiDetSN4= IF sSiDetSN4 GT NearZeroN4 THEN sSiDetSN4 ELSE NearZeroN4 ENDIF;
aDHumSN4= IF sDHumSN4 GT NearZeroN4 THEN sDHumSN4 ELSE NearZeroN4 ENDIF;
aNHumSN4= IF sNHumSN4 GT NearZeroN4 THEN sNHumSN4 ELSE NearZeroN4 ENDIF;
aPHumSN4= IF sPHumSN4 GT NearZeroN4 THEN sPHumSN4 ELSE NearZeroN4 ENDIF;
aDIMSN4= IF sDIMSN4 GT NearZeroN4 THEN sDIMSN4 ELSE NearZeroN4 ENDIF;
aDDiatSN4= IF sDDiatSN4 GT NearZeroN4 THEN sDDiatSN4 ELSE NearZeroN4 ENDIF;
aNDiatSN4= IF sNDiatSN4 GT NearZeroN4 THEN sNDiatSN4 ELSE NearZeroN4 ENDIF;
aPDiatSN4= IF sPDiatSN4 GT NearZeroN4 THEN sPDiatSN4 ELSE NearZeroN4 ENDIF;
aDGrenSN4= IF sDGrenSN4 GT NearZeroN4 THEN sDGrenSN4 ELSE NearZeroN4 ENDIF;
aNGrenSN4= IF sNGrenSN4 GT NearZeroN4 THEN sNGrenSN4 ELSE NearZeroN4 ENDIF;
aPGrenSN4= IF sPGrenSN4 GT NearZeroN4 THEN sPGrenSN4 ELSE NearZeroN4 ENDIF;
aDBlueSN4= IF sDBlueSN4 GT NearZeroN4 THEN sDBlueSN4 ELSE NearZeroN4 ENDIF;
aNBlueSN4= IF sNBlueSN4 GT NearZeroN4 THEN sNBlueSN4 ELSE NearZeroN4 ENDIF;
aPBlueSN4= IF sPBlueSN4 GT NearZeroN4 THEN sPBlueSN4 ELSE NearZeroN4 ENDIF;
aDVegN4= IF sDVegN4 GT NearZeroN4 THEN sDVegN4 ELSE NearZeroN4 ENDIF;
aNVegN4= IF sNVegN4 GT NearZeroN4 THEN sNVegN4 ELSE NearZeroN4 ENDIF;
aPVegN4= IF sPVegN4 GT NearZeroN4 THEN sPVegN4 ELSE NearZeroN4 ENDIF;
aVegHeightN4= IF sVegHeightN4 GT NearZeroN4 THEN sVegHeightN4 ELSE NearZeroN4 ENDIF;
aDBentN4= IF sDBentN4 GT NearZeroN4 THEN sDBentN4 ELSE NearZeroN4 ENDIF;
aNBentN4= IF sNBentN4 GT NearZeroN4 THEN sNBentN4 ELSE NearZeroN4 ENDIF;
aPBentN4= IF sPBentN4 GT NearZeroN4 THEN sPBentN4 ELSE NearZeroN4 ENDIF;
uDepthWMN4= IF sDepthWMN4 GT NearZeroN4 THEN sDepthWMN4 ELSE NearZeroN4 ENDIF;
oNH4WMN4= IF sNH4WMN4 GT NearZeroN4 THEN sNH4WMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNO3WMN4= IF sNO3WMN4 GT NearZeroN4 THEN sNO3WMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPO4WMN4= IF sPO4WMN4 GT NearZeroN4 THEN sPO4WMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPAIMWMN4= IF sPAIMWMN4 GT NearZeroN4 THEN sPAIMWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oSiO2WMN4= IF sSiO2WMN4 GT NearZeroN4 THEN sSiO2WMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oO2WMN4= IF sO2WMN4 GT NearZeroN4 THEN sO2WMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDDetWMN4= IF sDDetWMN4 GT NearZeroN4 THEN sDDetWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNDetWMN4= IF sNDetWMN4 GT NearZeroN4 THEN sNDetWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPDetWMN4= IF sPDetWMN4 GT NearZeroN4 THEN sPDetWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oSiDetWMN4= IF sSiDetWMN4 GT NearZeroN4 THEN sSiDetWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDIMWMN4= IF sDIMWMN4 GT NearZeroN4 THEN sDIMWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDDiatWMN4= IF sDDiatWMN4 GT NearZeroN4 THEN sDDiatWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNDiatWMN4= IF sNDiatWMN4 GT NearZeroN4 THEN sNDiatWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPDiatWMN4= IF sPDiatWMN4 GT NearZeroN4 THEN sPDiatWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDGrenWMN4= IF sDGrenWMN4 GT NearZeroN4 THEN sDGrenWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNGrenWMN4= IF sNGrenWMN4 GT NearZeroN4 THEN sNGrenWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPGrenWMN4= IF sPGrenWMN4 GT NearZeroN4 THEN sPGrenWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDBlueWMN4= IF sDBlueWMN4 GT NearZeroN4 THEN sDBlueWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNBlueWMN4= IF sNBlueWMN4 GT NearZeroN4 THEN sNBlueWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPBlueWMN4= IF sPBlueWMN4 GT NearZeroN4 THEN sPBlueWMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oDZooMN4= IF sDZooMN4 GT NearZeroN4 THEN sDZooMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oNZooMN4= IF sNZooMN4 GT NearZeroN4 THEN sNZooMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
oPZooMN4= IF sPZooMN4 GT NearZeroN4 THEN sPZooMN4 / MassWMN4 ELSE NearZeroN4 ENDIF;
aNH4SMN4= IF sNH4SMN4 GT NearZeroN4 THEN sNH4SMN4 ELSE NearZeroN4 ENDIF;
aNO3SMN4= IF sNO3SMN4 GT NearZeroN4 THEN sNO3SMN4 ELSE NearZeroN4 ENDIF;
aPO4SMN4= IF sPO4SMN4 GT NearZeroN4 THEN sPO4SMN4 ELSE NearZeroN4 ENDIF;
aPAIMSMN4= IF sPAIMSMN4 GT NearZeroN4 THEN sPAIMSMN4 ELSE NearZeroN4 ENDIF;
aDDetSMN4= IF sDDetSMN4 GT NearZeroN4 THEN sDDetSMN4 ELSE NearZeroN4 ENDIF;
aNDetSMN4= IF sNDetSMN4 GT NearZeroN4 THEN sNDetSMN4 ELSE NearZeroN4 ENDIF;
aPDetSMN4= IF sPDetSMN4 GT NearZeroN4 THEN sPDetSMN4 ELSE NearZeroN4 ENDIF;
aSiDetSMN4= IF sSiDetSMN4 GT NearZeroN4 THEN sSiDetSMN4 ELSE NearZeroN4 ENDIF;
aDHumSMN4= IF sDHumSMN4 GT NearZeroN4 THEN sDHumSMN4 ELSE NearZeroN4 ENDIF;
aNHumSMN4= IF sNHumSMN4 GT NearZeroN4 THEN sNHumSMN4 ELSE NearZeroN4 ENDIF;
aPHumSMN4= IF sPHumSMN4 GT NearZeroN4 THEN sPHumSMN4 ELSE NearZeroN4 ENDIF;
aDIMSMN4= IF sDIMSMN4 GT NearZeroN4 THEN sDIMSMN4 ELSE NearZeroN4 ENDIF;
aDRootPhraN4= IF sDRootPhraN4 GT NearZeroN4 THEN sDRootPhraN4 ELSE NearZeroN4 ENDIF;
aDShootPhraN4= IF sDShootPhraN4 GT NearZeroN4 THEN sDShootPhraN4 ELSE NearZeroN4 ENDIF;
aNRootPhraN4= IF sNRootPhraN4 GT NearZeroN4 THEN sNRootPhraN4 ELSE NearZeroN4 ENDIF;
aNShootPhraN4= IF sNShootPhraN4 GT NearZeroN4 THEN sNShootPhraN4 ELSE NearZeroN4 ENDIF;
aPRootPhraN4= IF sPRootPhraN4 GT NearZeroN4 THEN sPRootPhraN4 ELSE NearZeroN4 ENDIF;
aPShootPhraN4= IF sPShootPhraN4 GT NearZeroN4 THEN sPShootPhraN4 ELSE NearZeroN4 ENDIF;
oNH4WEpiN4= IF sNH4WEpiN4 GT NearZeroN4 THEN sNH4WEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNO3WEpiN4= IF sNO3WEpiN4 GT NearZeroN4 THEN sNO3WEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPO4WEpiN4= IF sPO4WEpiN4 GT NearZeroN4 THEN sPO4WEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPAIMWEpiN4= IF sPAIMWEpiN4 GT NearZeroN4 THEN sPAIMWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oSiO2WEpiN4= IF sSiO2WEpiN4 GT NearZeroN4 THEN sSiO2WEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oO2WEpiN4= IF sO2WEpiN4 GT NearZeroN4 THEN sO2WEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDDetWEpiN4= IF sDDetWEpiN4 GT NearZeroN4 THEN sDDetWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNDetWEpiN4= IF sNDetWEpiN4 GT NearZeroN4 THEN sNDetWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPDetWEpiN4= IF sPDetWEpiN4 GT NearZeroN4 THEN sPDetWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oSiDetWEpiN4= IF sSiDetWEpiN4 GT NearZeroN4 THEN sSiDetWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDIMWEpiN4= IF sDIMWEpiN4 GT NearZeroN4 THEN sDIMWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDDiatWEpiN4= IF sDDiatWEpiN4 GT NearZeroN4 THEN sDDiatWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNDiatWEpiN4= IF sNDiatWEpiN4 GT NearZeroN4 THEN sNDiatWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPDiatWEpiN4= IF sPDiatWEpiN4 GT NearZeroN4 THEN sPDiatWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDGrenWEpiN4= IF sDGrenWEpiN4 GT NearZeroN4 THEN sDGrenWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNGrenWEpiN4= IF sNGrenWEpiN4 GT NearZeroN4 THEN sNGrenWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPGrenWEpiN4= IF sPGrenWEpiN4 GT NearZeroN4 THEN sPGrenWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDBlueWEpiN4= IF sDBlueWEpiN4 GT NearZeroN4 THEN sDBlueWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNBlueWEpiN4= IF sNBlueWEpiN4 GT NearZeroN4 THEN sNBlueWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPBlueWEpiN4= IF sPBlueWEpiN4 GT NearZeroN4 THEN sPBlueWEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oDZooEpiN4= IF sDZooEpiN4 GT NearZeroN4 THEN sDZooEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oNZooEpiN4= IF sNZooEpiN4 GT NearZeroN4 THEN sNZooEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
oPZooEpiN4= IF sPZooEpiN4 GT NearZeroN4 THEN sPZooEpiN4 / MassEpiN4 ELSE NearZeroN4 ENDIF;
aDBlueSurfN4= IF sDBlueSurfN4 GT NearZeroN4 THEN sDBlueSurfN4 ELSE NearZeroN4 ENDIF;
aNBlueSurfN4= IF sNBlueSurfN4 GT NearZeroN4 THEN sNBlueSurfN4  ELSE NearZeroN4 ENDIF;
aPBlueSurfN4= IF sPBlueSurfN4 GT NearZeroN4 THEN sPBlueSurfN4  ELSE NearZeroN4 ENDIF;
aDExtTotTN4= sDExtTotTN4;
aNExtTotTN4= sNExtTotTN4 ;
aPExtTotTN4=  sPExtTotTN4 ;
aSiExtTotTN4= sSiExtTotTN4;
aO2ExtTotTN4=sO2ExtTotTN4 ;
aDepthExtTotTN4=sDepthExtTotTN4 ;
aDDetWEpiN4= IF sDDetWEpiN4 GT NearZeroN4 THEN sDDetWEpiN4 ELSE NearZeroN4 ENDIF;
aNDetWEpiN4= IF sNDetWEpiN4 GT NearZeroN4 THEN sNDetWEpiN4  ELSE NearZeroN4 ENDIF;
aPDetWEpiN4= IF sPDetWEpiN4 GT NearZeroN4 THEN sPDetWEpiN4  ELSE NearZeroN4 ENDIF;
aSiDetWEpiN4= IF sSiDetWEpiN4 GT NearZeroN4 THEN sSiDetWEpiN4 ELSE NearZeroN4 ENDIF;
aDIMWEpiN4= IF sDIMWEpiN4 GT NearZeroN4 THEN aDIMWEpiN4  ELSE NearZeroN4 ENDIF;
aDDiatWEpiN4= IF sDDiatWEpiN4 GT NearZeroN4 THEN sDDiatWEpiN4 ELSE NearZeroN4 ENDIF;
aNDiatWEpiN4= IF sNDiatWEpiN4 GT NearZeroN4 THEN sNDiatWEpiN4  ELSE NearZeroN4 ENDIF;
aPDiatWEpiN4= IF sPDiatWEpiN4 GT NearZeroN4 THEN sPDiatWEpiN4  ELSE NearZeroN4 ENDIF;
aDGrenWEpiN4= IF sDGrenWEpiN4 GT NearZeroN4 THEN sDGrenWEpiN4 ELSE NearZeroN4 ENDIF;
aNGrenWEpiN4= IF sNGrenWEpiN4 GT NearZeroN4 THEN sNGrenWEpiN4 ELSE NearZeroN4 ENDIF;
aPGrenWEpiN4= IF sPGrenWEpiN4 GT NearZeroN4 THEN sPGrenWEpiN4 ELSE NearZeroN4 ENDIF;
aDBlueWEpiN4= IF sDBlueWEpiN4 GT NearZeroN4 THEN sDBlueWEpiN4 ELSE NearZeroN4 ENDIF;
aNBlueWEpiN4= IF sNBlueWEpiN4 GT NearZeroN4 THEN sNBlueWEpiN4  ELSE NearZeroN4 ENDIF;
aPBlueWEpiN4= IF sPBlueWEpiN4 GT NearZeroN4 THEN sPBlueWEpiN4 ELSE NearZeroN4 ENDIF;
aDBlueWHypN4= IF sDBlueWEpiN4 GT NearZeroN4 THEN sDBlueWEpiN4 ELSE NearZeroN4 ENDIF;
TimeYearsN4 = sTimeN4 / DaysPerYearN4;
DayN4 = sTimeN4 - FLOOR(TimeYearsN4) * DaysPerYearN4;
YearsN4 = YearZeroN4 + TimeYearsN4;
aVegEHeightN4 =   POW ( cVegHPar1N4*aDVegN4 , cVegHPar2N4 ) ;
uVegHeightN4 =  IF ( UseVegHeightN4 EQ FALSE AND  aVegHeightN4 LT uDepthWN4 ) THEN aVegHeightN4 ELSEIF ( UseVegHeightN4 EQ FALSE ) THEN ( uDepthWN4 ) ELSE MIN ( aVegHeightN4 , uDepthWN4 , aVegEHeightN4 ) ENDIF;
uVegHeightHypN4 = IF ( aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uVegHeightN4 GT uDepthWHypN4 ) THEN uDepthWHypN4 ELSE uVegHeightN4 ENDIF;
uVegHeightEpiN4 = IF ( aInclStratN4 EQ FALSE AND uVegHeightN4 LT uDepthWEpiN4 ) THEN uVegHeightN4 ELSEIF ( aInclStratN4 EQ FALSE AND uVegHeightN4 GE uDepthWEpiN4 ) THEN uDepthWEpiN4 ELSEIF (uVegHeightN4 GT uDepthWHypN4 ) THEN uVegHeightN4 -uDepthWHypN4 ELSE 0.0 ENDIF;
aDepth2VegHypN4 = IF ( aInclStratN4 EQ TRUE AND fDepth2VegN4 GE 1 ) THEN uDepthWHypN4  ELSEIF ( aInclStratN4 EQ TRUE AND fDepth2VegN4 LT 1 ) THEN MAX (0.0, uVegHeightN4 - uDepthWEpiN4 ) ELSE 0.0 ENDIF;
aDepth1VegHypN4 = IF ( aInclStratN4 EQ TRUE AND fDepth2VegN4 GE 1 ) THEN uDepthWHypN4 - uVegHeightHypN4  ELSE 0.0 ENDIF;
aDepth2VegEpiN4 = IF (fDepth2VegN4 GE 1 ) THEN uDepthWEpiN4 ELSE uDepthWEpiN4 - uVegHeightEpiN4 ENDIF;
aDepth1VegEpiN4 = IF (fDepth2VegN4 GE 1 ) THEN uDepthWEpiN4 - uVegHeightEpiN4  ELSE 0.0 ENDIF;
uVegHeightLightN4 = cVegLN4 *LN( 1.0 + uVegHeightN4 );
uVegHeightLightSumN4 = cVegLN4 *LN( 1.0 + MAX (uVegHeightN4, MIN (uDepthWN4, cVegHeightN4) ) );
uVegHeightLightEpiN4 = IF (  uVegHeightLightN4 GT uVegHeightEpiN4 ) THEN uVegHeightEpiN4 ELSE uVegHeightLightN4 ENDIF;
uVegHeightLightHypN4 =  uVegHeightLightN4 - uVegHeightLightEpiN4  ;
uDVegHypN4 = uVegHeightHypN4 / uVegHeightN4 * aDVegN4;
uDVegEpiN4 = uVegHeightEpiN4 / uVegHeightN4 * aDVegN4;
uVegShadeN4 = IF ( ReadVegShadeN4  EQ  TRUE) THEN mVegShadeN4 ELSE fVegShadeN4 ENDIF;
aExtPhytHypN4 = cExtSpDiatN4 * oDDiatWHypN4 + cExtSpGrenN4 * oDGrenWHypN4 + cExtSpBlueN4 * oDBlueWHypN4;
aExtDetHypN4 = cExtSpDetN4 * oDDetWHypN4;
aExtIMHypN4 = cExtSpIMN4 * oDIMWHypN4;
aExtCoefOpenHypN4 = cExtWatN4 + aExtIMHypN4 + aExtDetHypN4 + aExtPhytHypN4;
aExtPhytEpiN4 = cExtSpDiatN4 * oDDiatWEpiN4 + cExtSpGrenN4 * oDGrenWEpiN4 + cExtSpBlueN4 * oDBlueWEpiN4;
aExtDetEpiN4 = cExtSpDetN4 * oDDetWEpiN4;
aExtIMEpiN4 = cExtSpIMN4 * oDIMWEpiN4;
aExtCoefOpenEpiN4 = cExtWatN4 + aExtIMEpiN4 + aExtDetEpiN4 + aExtPhytEpiN4;
aExtSurfN4 = cExtSpBlueN4 * aDBlueSurfN4;
aTmEpiN4 =  cTmAveEpiN4 - cTmVarEpiN4 * COS(2.0*PiN4*(sTimeN4 + TenDaysN4 - cTimeLagN4) / DaysInYearN4) ;
aTmHypN4 =  cTmAveHypN4 - cTmVarHypN4 * COS(2.0*PiN4*(sTimeN4 + TenDaysN4 - cTimeLagN4) / DaysInYearN4) ;
uTmEpiN4 = IF (FALSE EQ InclSeasonN4) THEN cTmAveEpiN4 ELSEIF (ReadTempN4 EQ TRUE) THEN mTempEpiN4 ELSEIF ( aTmEpiN4 GT 0.0  ) THEN aTmEpiN4 ELSE  0.0 ENDIF;
uTmHypN4 = IF (FALSE EQ InclSeasonN4) THEN cTmAveHypN4 ELSEIF (ReadTempN4 EQ TRUE) THEN mTempHypN4 ELSEIF ( aTmHypN4 GT 0.0  ) THEN aTmHypN4 ELSE  0.0 ENDIF;
uTmBotN4 = IF (aInclStratN4 EQ TRUE ) THEN uTmHypN4 ELSE uTmEpiN4 ENDIF;
uTmSurfN4 = uTmEpiN4;
uLATN4= cLATN4*2*PiN4/360;
uSolDecAngN4= IF(InclLatN4 EQ TRUE) THEN cPhiRN4*COS(2*PiN4*(DayN4-cDayRN4)/DaysInYearN4) ELSE 0.0 ENDIF;
uSunRiseN4 = HoursInDayN4/(2*PiN4)*ACOS((SIN(uLATN4)* SIN(uSolDecAngN4))/(COS(uLATN4)*COS(uSolDecAngN4))) ;
uSunSetN4=HoursInDayN4-uSunRiseN4;
uSunHoursN4=uSunSetN4-uSunRiseN4;
uSunPathN4= IF(InclLatN4 EQ TRUE) THEN SIN(uLATN4)*SIN( uSolDecAngN4 )*( uSunSetN4-uSunRiseN4)- COS(uLATN4) * COS (uSolDecAngN4) * HoursInDayN4 / (2*PiN4) * ( SIN (2*PiN4*uSunSetN4/HoursInDayN4 ) -SIN(2*PiN4*uSunRiseN4 /HoursInDayN4 )) ELSE 0.0 ENDIF;
uTransN4=IF((InclLatN4 EQ TRUE) AND (ConstTransN4 EQ FALSE)) THEN (0.6-0.2*(uSunPathN4/(uSunSetN4 - uSunRiseN4)))*(1-0.4*fCloudHN4) *(1-0.7* fCloudMN4) *(1-0.4*fCloudLN4)ELSEIF ((InclLatN4 EQ TRUE) AND (ConstTransN4 EQ TRUE)) THEN cTransN4 ELSE 0.0 ENDIF;
ufDayN4 = IF (FALSE EQ InclSeasonN4) THEN cfDayAveN4 ELSEIF (InclLatN4 EQ TRUE) THEN (uSunSetN4 -uSunRiseN4 )/ HoursInDayN4 ELSE cfDayAveN4 - cfDayVarN4 * COS( 2.0 *PiN4*(sTimeN4+TenDaysN4) / DaysInYearN4) ENDIF;
uLDayN4 = IF (FALSE EQ InclSeasonN4) THEN cLDayAveN4 ELSEIF (ReadLOutN4 EQ TRUE) THEN 0.0 ELSEIF (InclLatN4 EQ TRUE) THEN cSolarN4*uTransN4*uSunPathN4 * SecsPerDayN4 /HoursInDayN4 ELSE cLDayAveN4 - cLDayVarN4 * COS(2.0*PiN4*(sTimeN4+TenDaysN4) / DaysInYearN4) ENDIF;
uLOutN4 = IF (FALSE EQ InclSeasonN4) THEN uLDayN4 / SecsPerDayN4 / ufDayN4 ELSEIF (ReadLOutN4 EQ TRUE) THEN mLOutN4 / ufDayN4 ELSE uLDayN4 / SecsPerDayN4 / ufDayN4 ENDIF;
uLPARSurfN4 = fPARN4 * (1.0 - fReflN4) * uLOutN4;
aLPARBotSurfN4 = IF (InclSurfN4 EQ TRUE) THEN uLPARSurfN4 * EXP(- aExtSurfN4) ELSE uLPARSurfN4 ENDIF;
aLPARBotEpiOpenN4 = aLPARBotSurfN4 * EXP(- aExtCoefOpenEpiN4 * uDepthWEpiN4);
aLPARBotHypOpenN4 = aLPARBotEpiOpenN4 * EXP(- aExtCoefOpenHypN4 * uDepthWHypN4);
aLPAR1VegEpiN4 = aLPARBotSurfN4 * EXP(- aExtCoefOpenEpiN4 * aDepth1VegEpiN4) * ( 1 - uVegShadeN4 );
aLPAR1VegHypN4 = aLPAR1VegEpiN4 * EXP(- aExtCoefOpenHypN4 * aDepth1VegHypN4);
aLPARVegLightN4 =  IF  ( aInclStratN4 EQ TRUE AND  uVegHeightN4 LE uDepthWHypN4 ) THEN aLPAR1VegHypN4 *   EXP(- aExtCoefOpenHypN4 * uVegHeightLightEpiN4) ELSE aLPAR1VegEpiN4 *  EXP(- aExtCoefOpenEpiN4 * uVegHeightLightEpiN4)  *  EXP(- aExtCoefOpenHypN4 * uVegHeightLightEpiN4) ENDIF;
uTmVegAveN4 = ( uVegHeightHypN4 * uTmHypN4 + uVegHeightEpiN4 * uTmEpiN4 ) / uVegHeightN4;
uFunTmVegN4 = EXP(-0.5/(cSigTmVegN4*cSigTmVegN4) *((uTmVegAveN4-cTmOptVegN4)*(uTmVegAveN4-cTmOptVegN4) - (cTmRefN4-cTmOptVegN4)*(cTmRefN4-cTmOptVegN4)));
uFunTmProdVegN4 = IF ( UseExpVegN4 EQ TRUE ) THEN uFunTmVegN4 ELSE POW ( cQ10ProdVegN4 , (0.1 * (uTmVegAveN4 - cTmRefN4))) ENDIF;
uhLVegN4 = hLRefVegN4 * uFunTmProdVegN4;
aLPIVegN4 = IF ( aInclStratN4 EQ TRUE AND  uVegHeightN4 GT uDepthWHypN4 ) THEN cPMaxN4*(aLPAR1VegEpiN4- aLPARVegLightN4 + uhLVegN4*LN((1.0 +aLPARVegLightN4/ uhLVegN4)  /(1.0 +aLPAR1VegEpiN4  / uhLVegN4) + NearZeroN4  ) )ELSEIF  ( aInclStratN4 EQ TRUE AND  uVegHeightN4 LE uDepthWHypN4 ) THEN cPMaxN4*( aLPAR1VegHypN4- aLPARVegLightN4 + uhLVegN4* LN((1.0 +aLPARVegLightN4/ uhLVegN4)  / (1.0 +aLPAR1VegHypN4  / uhLVegN4) ) ) ELSE cPMaxN4 * (aLPAR1VegEpiN4- aLPARVegLightN4 + uhLVegN4*LN((1.0 +aLPARVegLightN4/ uhLVegN4)  /(1.0 +aLPAR1VegEpiN4  / uhLVegN4) + NearZeroN4  ) )ENDIF;
aSpringN4 =  IF ( cLATN4 LT 0 AND DayN4 GE 265 AND DayN4 LE 356 ) THEN 1 ELSEIF ( cLATN4 GT 0 AND DayN4 GE 80 AND DayN4 LE 173) THEN 1 ELSEIF ( cLATN4 EQ 0) THEN 1 ELSE 0 ENDIF;
aTimeWinVegN4 =  IF ( sTimeN4 LT StartTimeN4 + 1.0 ) THEN -999 ELSEIF ( UsePhotVegN4 EQ FALSE  AND  ( uTmBotN4 GE cTmInitVegN4 )  AND aSpringN4 EQ 1 ) THEN sTimeN4  ELSEIF (UsePhotVegN4 EQ TRUE  AND  uSunHoursN4 GE cPhotInitVegN4   AND aSpringN4 EQ 1 ) THEN sTimeN4 ELSEIF (( aLPIVegN4 / uVegHeightLightN4 )LE cLAlloVegN4 ) THEN aTimeWinVegN4 ELSEIF (FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeWinVegN4 + 0.3) GT 1 AND FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeWinVegN4 + 0.3) LT cVegWinLenN4 ) THEN aTimeWinVegN4 ELSE sTimeN4 ENDIF ;
aTimeInitVegN4 =  IF ( sTimeN4 LT StartTimeN4 + 1.0 ) THEN -999 ELSEIF ( FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeWinVegN4 + 0.3) GT 1 ) THEN sTimeN4 ELSEIF ( UsePhotVegN4 EQ FALSE  AND  uTmBotN4 GE cTmInitVegN4 ) THEN aTimeInitVegN4 ELSEIF ( UsePhotVegN4 EQ TRUE  AND    uSunHoursN4 GE cPhotInitVegN4  ) THEN aTimeInitVegN4 ELSEIF (UsePhotVegN4 EQ FALSE  AND  uTmBotN4 LT cTmInitVegN4 AND ( ( aLPIVegN4 / uVegHeightLightN4 ) GE cLAlloVegN4 ) AND FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeInitVegN4 + 0.3) GT 1) THEN aTimeInitVegN4 ELSEIF (UsePhotVegN4 EQ TRUE  AND   uSunHoursN4 LT cPhotInitVegN4 AND ( ( aLPIVegN4 / uVegHeightLightN4 ) GE cLAlloVegN4 ) AND FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeInitVegN4 + 0.3) GT 1) THEN aTimeInitVegN4 ELSEIF (FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeInitVegN4 + 0.3) GT 1 AND FLOOR ( sTimeN4+ 0.3 ) - FLOOR (aTimeInitVegN4 + 0.3) LT cVegInitLenN4 ) THEN aTimeInitVegN4 ELSE sTimeN4 ENDIF ;
aTimeWinVegCorN4 = IF ( UseLWinVegN4 LE NearZeroN4 ) THEN FLOOR (TimeYearsN4 - 1) + cDayWinVegN4  ELSE aTimeWinVegN4 ENDIF;
aDayInitVegN4 = IF (DayN4 LT 1.0 OR sTimeN4 LT StartTimeN4 + 1.0) THEN 367 ELSEIF (uTmBotN4 GE cTmInitVegN4 AND aDayInitVegN4 GT 366) THEN DayN4 ELSE aDayInitVegN4 ENDIF;
aTimeInitVegCorN4 = IF (UsePhotVegN4 LE NearZeroN4 AND UseLWinVegN4 LE NearZeroN4 ) THEN  (TimeYearsN4 - 1)  + aDayInitVegN4  ELSE aTimeInitVegN4 ENDIF;
aVegSumN4 =  IF ( FLOOR ( aTimeInitVegCorN4 + 0.3) LT FLOOR (  sTimeN4 + 0.3 ) AND FLOOR ( aTimeWinVegCorN4 + 0.3 ) EQ FLOOR (  sTimeN4  + 0.3 ) ) THEN 1 ELSE 0 ENDIF;
aVegWinN4 =  1 - aVegSumN4;
aDaysVegSumN4 = ( FLOOR ( sTimeN4+ 0.3) - FLOOR (aTimeInitVegCorN4 + 0.3) ) * aVegSumN4;
aDaysVegWinN4 = ( FLOOR ( sTimeN4 + 0.3) - FLOOR ( aTimeWinVegCorN4  + 0.3 )  ) * aVegWinN4;
bfRootVegN4 = IF (FALSE EQ InclSeasonN4) THEN fRootVegSumN4 ELSEIF (aVegWinN4 EQ TRUE AND aDaysVegWinN4 GT cLengAlloN4) THEN fRootVegWinN4 ELSEIF (aVegSumN4 EQ TRUE AND aDaysVegSumN4 LE cLengAlloN4) THEN 0.5*(fRootVegWinN4 + fRootVegSumN4) + 0.5*(fRootVegWinN4 - fRootVegSumN4) * COS ( PiN4 /cLengAlloN4 * ( sTimeN4 - aTimeInitVegCorN4 )) ELSEIF ( aVegWinN4 EQ TRUE AND aDaysVegWinN4 EQ 0) THEN fRootVegWinN4 ELSEIF ( aVegWinN4 EQ TRUE) THEN 0.5*( fRootVegWinN4 + fRootVegSumN4) - 0.5*( fRootVegWinN4 - fRootVegSumN4) * COS ( PiN4 / cLengAlloN4 * ( sTimeN4 - aTimeWinVegCorN4 )) ELSE fRootVegSumN4 ENDIF;
bfShootVegN4 = 1.0 - bfRootVegN4;
aDShootVegN4 = bfShootVegN4 * aDVegN4;
aDEmergVegN4 = fEmergVegN4 * aDShootVegN4;
aDFloatVegN4 = IF  ( aDepth1VegEpiN4 LT 0.005 ) THEN fFloatVegN4 * aDShootVegN4 ELSE 0 ENDIF;
bfSubVegN4 = 1.0 - fFloatVegN4 - fEmergVegN4;
aDSubVegN4 = bfSubVegN4 * aDShootVegN4;
aExtVegHypN4 = cExtSpVegN4 * aDSubVegN4 / uDepthWHypN4 * (uVegHeightHypN4 /uDepthWN4 );
aExtCoefHypN4 = aExtCoefOpenHypN4 + aExtVegHypN4;
aExtVegEpiN4 = cExtSpVegN4 * aDSubVegN4 / uDepthWEpiN4 * (uVegHeightEpiN4 /uDepthWN4 ) ;
aExtCoefEpiN4 = aExtCoefOpenEpiN4 + aExtVegEpiN4;
aLPARBotEpiN4 = aLPARBotSurfN4 * EXP(- aExtCoefEpiN4 * uDepthWEpiN4);
uLPARSurfHypN4 = IF ( aInclStratN4 EQ TRUE ) THEN aLPARBotEpiN4 ELSE 0.0 ENDIF;
aLPAR2VegEpiN4 = aLPAR1VegEpiN4 * EXP(- aExtCoefEpiN4 * (aDepth2VegEpiN4 - aDepth1VegEpiN4));
aLPAR2VegHypN4 = aLPAR1VegHypN4 * EXP(- aExtCoefHypN4 * (aDepth2VegHypN4 - aDepth1VegHypN4));
uVWindN4 = IF (ReadVWindN4 EQ TRUE)THEN mVWindN4 ELSE cVWindN4 ENDIF;
aStratN4 = IF (ReadStratN4 EQ TRUE) THEN mStratN4 ELSEIF ((uTmEpiN4 -uTmHypN4) GT  cStratTmN4 OR (uTmHypN4 -uTmEpiN4) GT  cStratTmN4) THEN 1.0  ELSE 0.0 ENDIF;
uQInSeasonN4 = IF (FALSE EQ UseSeasonLoadN4) THEN 0.0 ELSEIF (DayN4 LT cDayApril1N4 - 0.5*cLengChangeN4) THEN cQInWinN4 ELSEIF (DayN4 LT cDayApril1N4 + 0.5*cLengChangeN4) THEN 0.5*(cQInWinN4 + cQInSumN4) + 0.5*(cQInWinN4 - cQInSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayApril1N4)) ELSEIF (DayN4 LT cDayOct1N4 - 0.5*cLengChangeN4) THEN cQInSumN4 ELSEIF (DayN4 LT cDayOct1N4 + 0.5*cLengChangeN4) THEN 0.5*(cQInWinN4 + cQInSumN4) - 0.5*(cQInWinN4 - cQInSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayOct1N4)) ELSE cQInWinN4 ENDIF;
uQEvSinusN4 = cQEvAveN4 - cQEvVarN4 * COS(2.0*PiN4 * (sTimeN4 + TenDaysN4 - cTimeLagN4) / DaysInYearN4);
aQEvN4 = IF (10 *uTmEpiN4 /cHeatN4) LE NearZeroN4 THEN 16 * 2*ufDayN4 * 1 / 30 * POW ( NearZeroN4 , (cAlphaN4) ) ELSE 16 * 2*ufDayN4 * 1 / 30 * POW ( 10 *uTmEpiN4 /cHeatN4 , (cAlphaN4) ) ENDIF;
uQEvN4 = IF (FALSE EQ InclSeasonN4) THEN cQEvAveN4 ELSEIF (ReadQEvN4 EQ TRUE) THEN mQEvN4 ELSEIF (calcQEvN4 EQ TRUE ) THEN aQEvN4 ELSE uQEvSinusN4 ENDIF;
uDepthDifMeasN4 = IF ( ReadDepthWN4 EQ TRUE ) THEN mDepthWN4 - uDepthWN4 ELSE 0.0 ENDIF;
uQInCorN4 = IF (uDepthDifMeasN4 GE 0) THEN uDepthDifMeasN4 * cMaxWOutN4 * mmPermN4 ELSE 0.0 ENDIF;
uQOutCorN4 = IF (uDepthDifMeasN4 LT 0) THEN -1 * uDepthDifMeasN4 * cMaxWOutN4 * mmPermN4 ELSE 0.0 ENDIF;
uQInEpiN4 = IF ((ReadQInN4 EQ TRUE) OR (ReadTranFracN4 EQ TRUE)) THEN mQInEpiN4 + uQInCorN4 ELSEIF (UseSeasonLoadN4 EQ TRUE) THEN uQInSeasonN4 + uQInCorN4 ELSE cQInEpiN4 + uQInCorN4 ENDIF;
uQInHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF ((ReadQInN4 EQ TRUE) OR (ReadTranFracN4 EQ TRUE)) THEN mQInHypN4 ELSE 0.0 ENDIF;
aQInTotN4 = uQInEpiN4 + uQInHypN4;
uQPrecN4 = IF (ReadQPrecN4 EQ TRUE) THEN mQPrecN4 ELSE 0 ENDIF;
uQInSeepN4 = IF (ReadQGroundN4 EQ TRUE) THEN mQInSeepN4 ELSE cQInSeepN4 ENDIF;
uQOutInfN4 = IF (ReadQGroundN4 EQ TRUE) THEN mQOutInfN4 ELSE cQOutInfN4 ENDIF;
uQOutPotN4 = uQPrecN4 + uQInEpiN4 - uQInCorN4 + uQInHypN4 + uQInSeepN4 - uQEvN4 - uQOutCorN4 - uQOutInfN4;
aMaxQOutEpiN4 = IF ( uDepthWEpiN4 LE cMinDepthHypEpiN4 ) THEN 0.0 ELSE uDepthWEpiN4 * mmPermN4 * cMaxWOutN4 ENDIF;
aMaxQOutHypN4 = IF (aInclStratN4 EQ TRUE) AND ( uDepthWHypN4 GT cMinDepthHypEpiN4 ) THEN (uDepthWHypN4 - cMinDepthHypEpiN4) * mmPermN4 * cMaxWOutN4 ELSE 0.0 ENDIF;
uQOutEpiN4 = IF (ReadQOutN4 EQ TRUE) THEN MIN(mQOutEpiN4, aMaxQOutEpiN4) ELSE MIN(aMaxQOutEpiN4, MAX(0.0, uQOutPotN4)) ENDIF;
uQOutHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadQOutN4 EQ TRUE) THEN MIN(mQOutHypN4, aMaxQOutHypN4) ELSE MIN(aMaxQOutHypN4, MAX(0.0, (uQOutPotN4 - uQOutEpiN4))) ENDIF;
ukOutEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uQOutEpiN4 / mmPermN4 / uDepthWEpiN4 ENDIF;
ukOutHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uQOutHypN4 / mmPermN4 / uDepthWHypN4 ENDIF;
uTauWatEpiN4 = IF (aInclStratN4 EQ FALSE) THEN 1.0 / ((uQInEpiN4 + uQPrecN4 + uQInSeepN4) / mmPermN4 / uDepthWEpiN4 +NearZeroN4) ELSE 1.0 / (( uQInEpiN4 + uQPrecN4 ) / mmPermN4 / uDepthWEpiN4 +NearZeroN4) ENDIF;
uTauWatHypN4 = IF (aInclStratN4 EQ FALSE )THEN -9999 ELSE 1.0 / ((uQInHypN4 + uQInSeepN4 ) / mmPermN4 / uDepthWHypN4 +NearZeroN4) ENDIF;
uTauWatN4 = 1.0 / ((uQPrecN4 + uQInEpiN4 + uQInHypN4 + uQInSeepN4 ) / mmPermN4 / uDepthWN4 +NearZeroN4);
uTauSubstHypN4 = 1.0 / (ukOutHypN4+NearZeroN4);
uFiJvMortHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiJvMortHypN4 ELSE 0.0 ENDIF;
uFiJvEgesHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiJvEgesHypN4 ELSE 0.0 ENDIF;
uFiJvExcrHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiJvExcrHypN4 ELSE 0.0 ENDIF;
uFiAdMortHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiAdMortHypN4 ELSE 0.0 ENDIF;
uFiAdEgesHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiAdEgesHypN4 ELSE 0.0 ENDIF;
uFiAdExcrHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fFiAdExcrHypN4 ELSE 0.0 ENDIF;
uPiscMortHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fPiscMortHypN4 ELSE 0.0 ENDIF;
uPiscEgesHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fPiscEgesHypN4 ELSE 0.0 ENDIF;
uPiscExcrHypN4 = IF (aInclStratN4 EQ TRUE ) THEN fPiscExcrHypN4 ELSE 0.0 ENDIF;
vTranDepthWN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN (uQInEpiN4 + uQInHypN4 + uQPrecN4 + uQInSeepN4 - uQEvN4 - uQOutInfN4 - uQOutHypN4 - uQOutEpiN4 - uQOutCorN4) / mmPermN4 ELSE ((uQInEpiN4 + uQInHypN4 + uQPrecN4 + uQInSeepN4 - uQEvN4 - uQOutInfN4 - uQOutHypN4 - uQOutEpiN4 - uQOutCorN4) / mmPermN4) / (1.0 + fMarshN4) ENDIF;
vTranHypEpiWN4 = IF (InclStratN4 EQ FALSE) THEN 0.0 ELSEIF ( uDepthWN4 -uDepthMixMeasN4 LT cMinDepthHypEpiN4 ) THEN ( uDepthWN4 - cMinDepthHypEpiN4 -uDepthWEpiN4 ) * kExchWN4 ELSEIF ( uDepthMixMeasN4 LT cMinDepthHypEpiN4 ) THEN ( cMinDepthHypEpiN4 -uDepthWEpiN4 ) * kExchWN4 ELSE ( uDepthMixMeasN4 -uDepthWEpiN4 ) * kExchWN4 ENDIF;
vDeltaWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4 ) THEN (uQInHypN4 + uQInSeepN4 - uQOutInfN4 - uQOutHypN4) / mmPermN4 ELSE (uQInHypN4 + uQInSeepN4 - uQOutInfN4 - uQOutHypN4) / mmPermN4 / (1.0 + fMarshN4 ) ENDIF;
vDeltaWEpiN4 = IF (aInclStratN4 EQ FALSE) AND (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4 ) THEN (uQInEpiN4 + uQPrecN4 + uQInSeepN4 - uQEvN4 - uQOutEpiN4 - uQOutInfN4 - uQOutCorN4) / mmPermN4 ELSEIF (aInclStratN4 EQ TRUE) AND (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4 ) THEN (uQInEpiN4 + uQPrecN4 - uQEvN4 - uQOutEpiN4 - uQOutCorN4) / mmPermN4 ELSEIF (aInclStratN4 EQ FALSE) AND (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4 ) THEN (uQInEpiN4 + uQPrecN4 + uQInSeepN4 - uQEvN4 - uQOutEpiN4 - uQOutInfN4 - uQOutCorN4) / mmPermN4 / (1.0 + fMarshN4 ) ELSE (uQInEpiN4 + uQPrecN4 - uQEvN4 - uQOutEpiN4 - uQOutCorN4) / mmPermN4 / (1.0 + fMarshN4 ) ENDIF;
afVolHypEpiN4= IF (aInclStratN4 EQ TRUE AND uDepthWHypN4 GT NearZeroN4) THEN  uDepthWHypN4 / uDepthWEpiN4 ELSE 0.0 ENDIF;
wDAdvIMWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDIMWHypN4 ELSE vTranHypEpiWN4 * oDIMWEpiN4 ENDIF;
wPAdvPO4WN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPO4WHypN4 ELSE vTranHypEpiWN4 * oPO4WEpiN4 ENDIF;
wPAdvAIMWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPAIMWHypN4 ELSE vTranHypEpiWN4 * oPAIMWEpiN4 ENDIF;
wNAdvNH4WN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNH4WHypN4 ELSE vTranHypEpiWN4 * oNH4WEpiN4 ENDIF;
wNAdvNO3WN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNO3WHypN4 ELSE vTranHypEpiWN4 * oNO3WEpiN4 ENDIF;
wSiAdvSiO2WN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oSiO2WHypN4 ELSE vTranHypEpiWN4 * oSiO2WEpiN4 ENDIF;
wO2AdvWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oO2WHypN4 ELSE vTranHypEpiWN4 * oO2WEpiN4 ENDIF;
wDAdvDetWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDDetWHypN4 ELSE vTranHypEpiWN4 * oDDetWEpiN4 ENDIF;
wPAdvDetWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPDetWHypN4 ELSE vTranHypEpiWN4 * oPDetWEpiN4 ENDIF;
wNAdvDetWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNDetWHypN4 ELSE vTranHypEpiWN4 * oNDetWEpiN4 ENDIF;
wSiAdvDetWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oSiDetWHypN4 ELSE vTranHypEpiWN4 * oSiDetWEpiN4 ENDIF;
wDAdvDiatWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDDiatWHypN4 ELSE vTranHypEpiWN4 * oDDiatWEpiN4 ENDIF;
wPAdvDiatWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPDiatWHypN4 ELSE vTranHypEpiWN4 * oPDiatWEpiN4 ENDIF;
wNAdvDiatWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNDiatWHypN4 ELSE vTranHypEpiWN4 * oNDiatWEpiN4 ENDIF;
wSiAdvDiatWN4 = vTranHypEpiWN4 * cSiDDiatN4;
wDAdvGrenWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDGrenWHypN4 ELSE vTranHypEpiWN4 * oDGrenWEpiN4 ENDIF;
wPAdvGrenWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPGrenWHypN4 ELSE vTranHypEpiWN4 * oPGrenWEpiN4 ENDIF;
wNAdvGrenWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNGrenWHypN4 ELSE vTranHypEpiWN4 * oNGrenWEpiN4 ENDIF;
wDAdvBlueWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDBlueWHypN4 ELSE vTranHypEpiWN4 * oDBlueWEpiN4 ENDIF;
wPAdvBlueWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPBlueWHypN4 ELSE vTranHypEpiWN4 * oPBlueWEpiN4 ENDIF;
wNAdvBlueWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNBlueWHypN4 ELSE vTranHypEpiWN4 * oNBlueWEpiN4 ENDIF;
wDAdvZooWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oDZooHypN4 ELSE vTranHypEpiWN4 * oDZooEpiN4 ENDIF;
wPAdvZooWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oPZooHypN4 ELSE vTranHypEpiWN4 * oPZooEpiN4 ENDIF;
wNAdvZooWN4 = IF ( vTranHypEpiWN4 GT 0.0) THEN vTranHypEpiWN4 * oNZooHypN4 ELSE vTranHypEpiWN4 * oNZooEpiN4 ENDIF;
wDAdvIMWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDIMWEpiN4 ELSE vTranDepthWN4 *  oDIMWMN4 ENDIF;
wPAdvPO4WMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPO4WEpiN4 ELSE vTranDepthWN4 *  oPO4WMN4 ENDIF;
wPAdvAIMWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPAIMWEpiN4 ELSE vTranDepthWN4 *  oPAIMWMN4 ENDIF;
wNAdvNH4WMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNH4WEpiN4 ELSE vTranDepthWN4 *  oNH4WMN4 ENDIF;
wNAdvNO3WMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNO3WEpiN4 ELSE vTranDepthWN4 *  oNO3WMN4 ENDIF;
wSiAdvSiO2WMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oSiO2WEpiN4 ELSE vTranDepthWN4 *  oSiO2WMN4 ENDIF;
wO2AdvWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oO2WEpiN4 ELSE vTranDepthWN4 *  oO2WMN4 ENDIF;
wDAdvDetWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDDetWEpiN4 ELSE vTranDepthWN4 *  oDDetWMN4 ENDIF;
wPAdvDetWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPDetWEpiN4 ELSE vTranDepthWN4 *  oPDetWMN4 ENDIF;
wNAdvDetWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNDetWEpiN4 ELSE vTranDepthWN4 *  oNDetWMN4 ENDIF;
wSiAdvDetWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oSiDetWEpiN4 ELSE vTranDepthWN4 *  oSiDetWMN4 ENDIF;
wDAdvDiatWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDDiatWEpiN4 ELSE vTranDepthWN4 *  oDDiatWMN4 ENDIF;
wPAdvDiatWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPDiatWEpiN4 ELSE vTranDepthWN4 *  oPDiatWMN4 ENDIF;
wNAdvDiatWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNDiatWEpiN4 ELSE vTranDepthWN4 *  oNDiatWMN4 ENDIF;
wDAdvGrenWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDGrenWEpiN4 ELSE vTranDepthWN4 *  oDGrenWMN4 ENDIF;
wPAdvGrenWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPGrenWEpiN4 ELSE vTranDepthWN4 *  oPGrenWMN4 ENDIF;
wNAdvGrenWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNGrenWEpiN4 ELSE vTranDepthWN4 *  oNGrenWMN4 ENDIF;
wDAdvBlueWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDBlueWEpiN4 ELSE vTranDepthWN4 *  oDBlueWMN4 ENDIF;
wPAdvBlueWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPBlueWEpiN4 ELSE vTranDepthWN4 *  oPBlueWMN4 ENDIF;
wNAdvBlueWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNBlueWEpiN4 ELSE vTranDepthWN4 *  oNBlueWMN4 ENDIF;
wDAdvZooWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oDZooEpiN4 ELSE vTranDepthWN4 *  oDZooMN4 ENDIF;
wPAdvZooWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oPZooEpiN4 ELSE vTranDepthWN4 *  oPZooMN4 ENDIF;
wNAdvZooWMN4= IF (InclMarshN4 EQ FALSE OR fMarshN4 LT NearZeroN4) THEN 0.0 ELSEIF ( vTranDepthWN4 GT 0.0) THEN vTranDepthWN4 * oNZooEpiN4 ELSE vTranDepthWN4 *  oNZooMN4 ENDIF;
uExchMaxWN4 =   IF ( aInclStratN4 EQ TRUE) THEN kExchMaxWN4 /( aStratN4* fMetaN4 * uDepthWN4 + cDepthMetaMinN4 ) ELSE 0.0 ENDIF;
akExchWHypN4= IF (aInclStratN4 EQ TRUE AND uDepthWHypN4 GT NearZeroN4) THEN  ( uExchMaxWN4 ) / uDepthWHypN4 ELSE 0.0 ENDIF;
akExchWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 * afVolHypEpiN4 ELSE 0.0 ENDIF;
wDExchIMWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDIMWHypN4 - oDIMWEpiN4) ELSE 0.0 ENDIF;
wPExchPO4WHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPO4WHypN4 - oPO4WEpiN4) ELSE 0.0 ENDIF;
wPExchAIMWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPAIMWHypN4 - oPAIMWEpiN4) ELSE 0.0 ENDIF;
wNExchNH4WHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNH4WHypN4 - oNH4WEpiN4) ELSE 0.0 ENDIF;
wNExchNO3WHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNO3WHypN4 - oNO3WEpiN4) ELSE 0.0 ENDIF;
wSiExchSiO2WHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oSiO2WHypN4 - oSiO2WEpiN4) ELSE 0.0 ENDIF;
wO2ExchWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oO2WHypN4 - oO2WEpiN4) ELSE 0.0 ENDIF;
wDExchDetWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDDetWHypN4 - oDDetWEpiN4) ELSE 0.0 ENDIF;
wPExchDetWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPDetWHypN4 - oPDetWEpiN4) ELSE 0.0 ENDIF;
wNExchDetWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNDetWHypN4 - oNDetWEpiN4) ELSE 0.0 ENDIF;
wSiExchDetWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oSiDetWHypN4 - oSiDetWEpiN4) ELSE 0.0 ENDIF;
wDExchDiatWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDDiatWHypN4 - oDDiatWEpiN4) ELSE 0.0 ENDIF;
wPExchDiatWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPDiatWHypN4 - oPDiatWEpiN4) ELSE 0.0 ENDIF;
wNExchDiatWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNDiatWHypN4 - oNDiatWEpiN4) ELSE 0.0 ENDIF;
wSiExchDiatWHypN4= IF (aInclStratN4 EQ TRUE ) THEN cSiDDiatN4 * wDExchDiatWHypN4 ELSE 0.0 ENDIF;
wDExchGrenWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDGrenWHypN4 - oDGrenWEpiN4) ELSE 0.0 ENDIF;
wPExchGrenWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPGrenWHypN4 - oPGrenWEpiN4) ELSE 0.0 ENDIF;
wNExchGrenWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNGrenWHypN4 - oNGrenWEpiN4) ELSE 0.0 ENDIF;
wDExchBlueWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDBlueWHypN4 - oDBlueWEpiN4) ELSE 0.0 ENDIF;
wPExchBlueWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPBlueWHypN4 - oPBlueWEpiN4) ELSE 0.0 ENDIF;
wNExchBlueWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNBlueWHypN4 - oNBlueWEpiN4) ELSE 0.0 ENDIF;
wDExchZooWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oDZooHypN4 - oDZooEpiN4) ELSE 0.0 ENDIF;
wPExchZooWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oPZooHypN4 - oPZooEpiN4) ELSE 0.0 ENDIF;
wNExchZooWHypN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWHypN4 *(oNZooHypN4 - oNZooEpiN4) ELSE 0.0 ENDIF;
wDExchIMWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDIMWHypN4 - oDIMWEpiN4) ELSE 0.0 ENDIF;
wPExchPO4WEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPO4WHypN4 - oPO4WEpiN4) ELSE 0.0 ENDIF;
wPExchAIMWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPAIMWHypN4 - oPAIMWEpiN4) ELSE 0.0 ENDIF;
wNExchNH4WEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNH4WHypN4 - oNH4WEpiN4) ELSE 0.0 ENDIF;
wNExchNO3WEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNO3WHypN4 - oNO3WEpiN4) ELSE 0.0 ENDIF;
wSiExchSiO2WEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oSiO2WHypN4 - oSiO2WEpiN4) ELSE 0.0 ENDIF;
wO2ExchWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oO2WHypN4 - oO2WEpiN4) ELSE 0.0 ENDIF;
wDExchDetWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDDetWHypN4 - oDDetWEpiN4) ELSE 0.0 ENDIF;
wPExchDetWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPDetWHypN4 - oPDetWEpiN4) ELSE 0.0 ENDIF;
wNExchDetWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNDetWHypN4 - oNDetWEpiN4) ELSE 0.0 ENDIF;
wSiExchDetWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oSiDetWHypN4 - oSiDetWEpiN4) ELSE 0.0 ENDIF;
wDExchDiatWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDDiatWHypN4 - oDDiatWEpiN4) ELSE 0.0 ENDIF;
wPExchDiatWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPDiatWHypN4 - oPDiatWEpiN4) ELSE 0.0 ENDIF;
wNExchDiatWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNDiatWHypN4 - oNDiatWEpiN4) ELSE 0.0 ENDIF;
wSiExchDiatWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN cSiDDiatN4 * wDExchDiatWEpiN4 ELSE 0.0 ENDIF;
wDExchGrenWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDGrenWHypN4 - oDGrenWEpiN4) ELSE 0.0 ENDIF;
wPExchGrenWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPGrenWHypN4 - oPGrenWEpiN4) ELSE 0.0 ENDIF;
wNExchGrenWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNGrenWHypN4 - oNGrenWEpiN4) ELSE 0.0 ENDIF;
wDExchBlueWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDBlueWHypN4 - oDBlueWEpiN4) ELSE 0.0 ENDIF;
wPExchBlueWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPBlueWHypN4 - oPBlueWEpiN4) ELSE 0.0 ENDIF;
wNExchBlueWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNBlueWHypN4 - oNBlueWEpiN4) ELSE 0.0 ENDIF;
wDExchZooWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oDZooHypN4 - oDZooEpiN4) ELSE 0.0 ENDIF;
wPExchZooWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oPZooHypN4 - oPZooEpiN4) ELSE 0.0 ENDIF;
wNExchZooWEpiN4= IF (aInclStratN4 EQ TRUE ) THEN akExchWEpiN4 *(oNZooHypN4 - oNZooEpiN4) ELSE 0.0 ENDIF;
akExchMHypN4 = 0.0;
akExchLHypN4 = 0.0;
oDPhytWHypN4 = oDDiatWHypN4 + oDGrenWHypN4 + oDBlueWHypN4;
oPPhytWHypN4 = oPDiatWHypN4 + oPGrenWHypN4 + oPBlueWHypN4;
oNPhytWHypN4 = oNDiatWHypN4 + oNGrenWHypN4 + oNBlueWHypN4;
aDPhytSN4 = aDDiatSN4 + aDGrenSN4 + aDBlueSN4 ;
aPPhytSN4 = aPDiatSN4 + aPGrenSN4 + aPBlueSN4 ;
aNPhytSN4 = aNDiatSN4 + aNGrenSN4 + aNBlueSN4;
oDPhytWEpiN4 = oDDiatWEpiN4 + oDGrenWEpiN4 + oDBlueWEpiN4;
oDOMWEpiN4 = oDDetWEpiN4 + oDPhytWEpiN4;
oDOMWHypN4 = oDDetWHypN4 + oDPhytWHypN4;
oTDOMWN4 = oDOMWEpiN4 + oDOMWHypN4;
oDSestWHypN4 = oDOMWHypN4 + oDIMWHypN4;
oPOMWHypN4 = oPPhytWHypN4 + oPDetWHypN4;
oPSestWHypN4 = oPPhytWHypN4 + oPDetWHypN4 + oPAIMWHypN4;
oPInorgWHypN4 = oPO4WHypN4 + oPAIMWHypN4;
oPTotWHypN4 = oPSestWHypN4 + oPO4WHypN4;
oNDissWEpiN4 = oNO3WEpiN4 + oNH4WEpiN4;
oNDissWHypN4 = oNO3WHypN4 + oNH4WHypN4;
oNOMWHypN4 = oNPhytWHypN4 + oNDetWHypN4;
oNSestWHypN4 = oNOMWHypN4;
oNkjWHypN4 = oNSestWHypN4 + oNH4WHypN4;
oNTotWHypN4 = oNkjWHypN4 + oNO3WHypN4;
bPorSN4 = (1.0 - fDTotS0N4) * (fDOrgS0N4 * cRhoOMN4 + (1 - fDOrgS0N4) * cRhoIMN4) / cRhoWatN4 / ( fDTotS0N4 + (1.0 - fDTotS0N4) * (fDOrgS0N4 * cRhoOMN4 + (1 - fDOrgS0N4) * cRhoIMN4) / cRhoWatN4 );
bPorCorSN4 = IF POW(bPorSN4 , (bPorSN4 + 1.0)) LE NearZeroN4 THEN 1 ELSE POW(bPorSN4 , (bPorSN4 + 1.0)) ENDIF;
aDTotSN4 = aDIMSN4 + aDHumSN4 + aDDetSN4;
aRhoTotSN4 = aDTotSN4 / cDepthSN4;
aRhoSolidSN4 = (aDIMSN4 * cRhoIMN4 + (aDHumSN4 + aDDetSN4) * cRhoOMN4) / aDTotSN4;
afDTotSN4 = 1.0 / (1.0 + bPorSN4/(1.0-bPorSN4) * cRhoWatN4 / aRhoSolidSN4);
afDOrgSN4 = (aDHumSN4 + aDDetSN4) / aDTotSN4;
afDetSN4 = aDDetSN4 / (aDHumSN4 + aDDetSN4);
afDetTotSN4 = aDDetSN4 / (aDIMSN4 + aDHumSN4 + aDDetSN4);
aPInorgSN4 = aPO4SN4 + aPAIMSN4;
aPTotAvailSN4 = aPDetSN4 + aPInorgSN4 + aPPhytSN4;
aPTotSN4 = aPTotAvailSN4 + aPHumSN4;
afPInorgSN4 = aPInorgSN4 / aDTotSN4;
afPTotSN4 = aPTotSN4 / aDTotSN4;
afPO4SN4 = aPO4SN4 / (aPTotAvailSN4 + NearZeroN4);
oPO4SN4 = aPO4SN4 / cDepthSN4 / bPorSN4;
aNDissSN4 = aNH4SN4 + aNO3SN4;
aNkjAvailSN4 = aNDetSN4 + aNPhytSN4 + aNH4SN4;
aNkjSN4 = aNkjAvailSN4 + aNHumSN4;
aNTotAvailSN4 = aNkjAvailSN4 + aNO3SN4;
aNTotSN4 = aNkjSN4 + aNO3SN4;
afNInorgSN4 = aNDissSN4 / aDTotSN4;
afNTotSN4 = aNTotSN4 / aDTotSN4;
oNO3SN4 = aNO3SN4 / cDepthSN4 / bPorSN4;
oNH4SN4 = aNH4SN4 / cDepthSN4 / bPorSN4;
oNDissSN4 = aNDissSN4 / cDepthSN4 / bPorSN4;
rPDIMWHypN4 = oPAIMWHypN4 / oDIMWHypN4;
rPDIMSN4 = aPAIMSN4 / aDIMSN4;
rPDDetWHypN4 = oPDetWHypN4 / (oDDetWHypN4+NearZeroN4);
rNDDetWHypN4 = oNDetWHypN4 / (oDDetWHypN4+NearZeroN4);
rSiDDetWHypN4 = oSiDetWHypN4 / (oDDetWHypN4+NearZeroN4);
rPDHumSN4 = aPHumSN4 / (aDHumSN4+NearZeroN4);
rNDHumSN4 = aNHumSN4 / (aDHumSN4+NearZeroN4);
rPDDetSN4 = aPDetSN4 / (aDDetSN4+NearZeroN4);
rNDDetSN4 = aNDetSN4 / (aDDetSN4+NearZeroN4);
rSiDDetSN4 = aSiDetSN4 / (aDDetSN4+NearZeroN4);
oDPhytWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oDDiatWMN4 + oDGrenWMN4 + oDBlueWMN4 ELSE 0.0 ENDIF;
oPPhytWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPDiatWMN4 + oPGrenWMN4 + oPBlueWMN4 ELSE 0.0 ENDIF;
oNPhytWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNDiatWMN4 + oNGrenWMN4 + oNBlueWMN4 ELSE 0.0 ENDIF;
oSiDiatWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cSiDDiatN4 * oDDiatWMN4 ELSE 0.0 ENDIF;
oDOMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oDDetWMN4 + oDPhytWMN4 ELSE 0.0 ENDIF;
oDSestWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oDOMWMN4 + oDIMWMN4 ELSE 0.0 ENDIF;
oPOMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPPhytWMN4 + oPDetWMN4 ELSE 0.0 ENDIF;
oPSestWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPPhytWMN4 + oPDetWMN4 + oPAIMWMN4 ELSE 0.0 ENDIF;
oPInorgWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPO4WMN4 + oPAIMWMN4 ELSE 0.0 ENDIF;
oPTotWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPSestWMN4 + oPO4WMN4 ELSE 0.0 ENDIF;
oNDissWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNO3WMN4 + oNH4WMN4 ELSE 0.0 ENDIF;
oNOMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNPhytWMN4 + oNDetWMN4 ELSE 0.0 ENDIF;
oNSestWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNOMWMN4 ELSE 0.0 ENDIF;
oNkjWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNSestWMN4 + oNH4WMN4 ELSE 0.0 ENDIF;
oNTotWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNkjWMN4 + oNO3WMN4 ELSE 0.0 ENDIF;
bPorSMN4 = (1.0 - fDTotSM0N4) * (fDOrgSM0N4 * cRhoOMN4 +(1 - fDOrgSM0N4) * cRhoIMN4) / cRhoWatN4 /(fDTotSM0N4 + (1.0 - fDTotSM0N4) * (fDOrgSM0N4 * cRhoOMN4 +(1 - fDOrgSM0N4) * cRhoIMN4) / cRhoWatN4);
bPorCorSMN4 = IF POW ( bPorSMN4 , (bPorSMN4 + 1.0)) LE NearZeroN4 THEN 1 ELSE POW ( bPorSMN4 , (bPorSMN4 + 1.0)) ENDIF;
aDTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDIMSMN4 + aDHumSMN4 + aDDetSMN4 ELSE 0.0 ENDIF;
aRhoTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDTotSMN4 / cDepthSMN4 ELSE 0.0 ENDIF;
aRhoSolidSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (aDIMSMN4 * cRhoIMN4 +(aDHumSMN4 + aDDetSMN4) * cRhoOMN4) / aDTotSMN4 ELSE 0.0 ENDIF;
afDTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN 1.0 /(1.0 + bPorSMN4/(1.0-bPorSMN4) * cRhoWatN4 / aRhoSolidSMN4) ELSE 0.0 ENDIF;
afDOrgSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (aDHumSMN4 + aDDetSMN4) / aDTotSMN4 ELSE 0.0 ENDIF;
afDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDDetSMN4 /(aDHumSMN4 + aDDetSMN4) ELSE 0.0 ENDIF;
afDetTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDDetSMN4 /(aDIMSMN4 + aDHumSMN4 + aDDetSMN4) ELSE 0.0 ENDIF;
aPInorgSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPO4SMN4 + aPAIMSMN4 ELSE 0.0 ENDIF;
aPTotAvailSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPDetSMN4 + aPInorgSMN4 ELSE 0.0 ENDIF;
aPTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPTotAvailSMN4 + aPHumSMN4 ELSE 0.0 ENDIF;
afPInorgSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPInorgSMN4 / aDTotSMN4 ELSE 0.0 ENDIF;
afPTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPTotSMN4 / aDTotSMN4 ELSE 0.0 ENDIF;
afPO4SMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPO4SMN4 /(aPTotAvailSMN4 + NearZeroN4) ELSE 0.0 ENDIF;
oPO4SMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPO4SMN4 / cDepthSMN4 / bPorSMN4 ELSE 0.0 ENDIF;
aNDissSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNH4SMN4 + aNO3SMN4 ELSE 0.0 ENDIF;
aNkjAvailSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNDetSMN4 + aNH4SMN4 ELSE 0.0 ENDIF;
aNkjSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNkjAvailSMN4 + aNHumSMN4 ELSE 0.0 ENDIF;
aNTotAvailSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNkjAvailSMN4 + aNO3SMN4 ELSE 0.0 ENDIF;
aNTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNkjSMN4 + aNO3SMN4 ELSE 0.0 ENDIF;
afNInorgSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNDissSMN4 / aDTotSMN4 ELSE 0.0 ENDIF;
afNTotSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNTotSMN4 / aDTotSMN4 ELSE 0.0 ENDIF;
oNO3SMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNO3SMN4 / cDepthSMN4 / bPorSMN4 ELSE 0.0 ENDIF;
oNH4SMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNH4SMN4 / cDepthSMN4 / bPorSMN4 ELSE 0.0 ENDIF;
oNDissSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNDissSMN4 / cDepthSMN4 / bPorSMN4 ELSE 0.0 ENDIF;
rPDIMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPAIMWMN4 / oDIMWMN4 ELSE 0.0 ENDIF;
rPDIMSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPAIMSMN4 / aDIMSMN4 ELSE 0.0 ENDIF;
rPDDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oPDetWMN4 /(oDDetWMN4+NearZeroN4) ELSE 0.0 ENDIF;
rNDDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNDetWMN4 /(oDDetWMN4+NearZeroN4) ELSE 0.0 ENDIF;
rSiDDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oSiDetWMN4 /(oDDetWMN4+NearZeroN4) ELSE 0.0 ENDIF;
rPDHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPHumSMN4 /(aDHumSMN4+NearZeroN4) ELSE 0.0 ENDIF;
rNDHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNHumSMN4 /(aDHumSMN4+NearZeroN4) ELSE 0.0 ENDIF;
rPDDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPDetSMN4 /(aDDetSMN4+NearZeroN4) ELSE 0.0 ENDIF;
rNDDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNDetSMN4 /(aDDetSMN4+NearZeroN4) ELSE 0.0 ENDIF;
rSiDDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aSiDetSMN4 /(aDDetSMN4+NearZeroN4) ELSE 0.0 ENDIF;
aDTotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ((oDIMWMN4 + oDDetWMN4 + oDPhytWMN4 + oDZooMN4) * uDepthWMN4 + aDIMSMN4 + aDHumSMN4 + aDDetSMN4 + aDShootPhraN4 + aDRootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
aPTotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ((oPO4WMN4 + oPDetWMN4 + oPAIMWMN4 + oPPhytWMN4 + oPZooMN4) * uDepthWMN4 + aPO4SMN4 + aPHumSMN4 + aPDetSMN4 + aPAIMSMN4 + aPShootPhraN4 + aPRootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
aNTotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ((oNH4WMN4 + oNO3WMN4 + oNDetWMN4 + oNPhytWMN4 + oNZooMN4) * uDepthWMN4 + aNH4SMN4 + aNO3SMN4 + aNHumSMN4 + aNDetSMN4 + aNShootPhraN4 + aNRootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
aSiTotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ((oSiO2WMN4 + oSiDetWMN4 + oSiDiatWMN4) * uDepthWMN4 + aSiDetSMN4) * fMarshN4 ELSE 0.0 ENDIF;
aO2TotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ((oO2WMN4) * uDepthWMN4 ) * fMarshN4 ELSE 0.0 ENDIF;
uPLoadSeasonEpiN4 = IF (FALSE EQ UseSeasonLoadN4) THEN 0.0 ELSEIF (DayN4 LT cDayApril1N4 - 0.5*cLengChangeN4) THEN cPLoadWinN4 ELSEIF (DayN4 LT cDayApril1N4 + 0.5*cLengChangeN4) THEN 0.5*(cPLoadWinN4 + cPLoadSumN4) + 0.5*(cPLoadWinN4 - cPLoadSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayApril1N4)) ELSEIF (DayN4 LT cDayOct1N4 - 0.5*cLengChangeN4) THEN cPLoadSumN4 ELSEIF (DayN4 LT cDayOct1N4 + 0.5*cLengChangeN4) THEN 0.5*(cPLoadWinN4 + cPLoadSumN4) - 0.5*(cPLoadWinN4 - cPLoadSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayOct1N4)) ELSE cPLoadWinN4 ENDIF;
uPLoadEpiN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mPLoadPO4EpiN4 + mPLoadAIMEpiN4 + mPLoadDiatEpiN4 + mPLoadGrenEpiN4 + mPLoadBlueEpiN4 + mPLoadDetEpiN4) ELSEIF (ReadPLoadN4 EQ TRUE AND ReadNutFracN4 EQ TRUE) THEN mPLoadPO4EpiN4 + mPLoadOrgEpiN4 ELSEIF (ReadPLoadN4 EQ TRUE AND FALSE EQ ReadNutFracN4) THEN mPLoadEpiN4 * mPLoadEpiMultN4 ELSEIF (UsePulseLoadN4 EQ TRUE) THEN 0.0 ELSEIF (UseSeasonLoadN4 EQ TRUE) THEN uPLoadSeasonEpiN4 ELSE cPLoadN4 ENDIF;
uPLoadPO4EpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadPO4EpiN4 ELSEIF (ReadPLoadN4 EQ FALSE) THEN fPO4InN4 * uPLoadEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN mPLoadPO4EpiN4 ELSE fPO4InN4 * uPLoadEpiN4 ENDIF;
uPLoadOrgEpiN4 = IF (FALSE EQ ReadPLoadN4) THEN (1.0 - fPO4InN4) * uPLoadEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN mPLoadOrgEpiN4 ELSE (1.0 - fPO4InN4) * uPLoadEpiN4 ENDIF;
uPLoadPhytTotEpiN4 = IF (FALSE EQ InclSeasonN4) THEN (((fPhytInSumN4 + fPhytInWinN4)/2)*uPLoadOrgEpiN4) ELSEIF (ReadPLoadPhytN4 EQ TRUE) THEN mPLoadPhytTotEpiN4 ELSE ((fPhytInSumN4+fPhytInWinN4)/2.0 - (fPhytInSumN4-fPhytInWinN4)/2.0 * COS(2.0*PiN4 * (sTimeN4 + TenDaysN4 - cTimeLagN4) / DaysInYearN4)) * uPLoadOrgEpiN4 ENDIF;
uPLoadDetEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadDetEpiN4 ELSE uPLoadOrgEpiN4 - uPLoadPhytTotEpiN4 ENDIF;
uPLoadAIMEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadAIMEpiN4 ELSE 0.0 ENDIF;
uPBackLoadHypN4 = IF (FALSE EQ aInclStratN4) THEN 0.0 ELSE cPBackLoadN4 ENDIF;
uPTotInEpiN4 = uPLoadEpiN4 / (uQInEpiN4 / mmPermN4 + NearZeroN4);
uNLoadSeasonEpiN4 = IF (FALSE EQ UseSeasonLoadN4) THEN 0.0 ELSEIF (DayN4 LT cDayApril1N4 - 0.5*cLengChangeN4) THEN cNLoadWinN4 ELSEIF (DayN4 LT cDayApril1N4 + 0.5*cLengChangeN4) THEN 0.5*(cNLoadWinN4 + cNLoadSumN4) + 0.5*(cNLoadWinN4 - cNLoadSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayApril1N4)) ELSEIF (DayN4 LT cDayOct1N4 - 0.5*cLengChangeN4) THEN cNLoadSumN4 ELSEIF (DayN4 LT cDayOct1N4 + 0.5*cLengChangeN4) THEN 0.5*(cNLoadWinN4 + cNLoadSumN4) - 0.5*(cNLoadWinN4 - cNLoadSumN4) * COS(PiN4/cLengChangeN4 * (DayN4 - cDayOct1N4)) ELSE cNLoadWinN4 ENDIF;
uNLoadPhytTotEpiN4 = IF (ReadNutFracN4 EQ FALSE) THEN (cNPPhytInN4 * uPLoadPhytTotEpiN4) ELSE  mNLoadPhytTotEpiN4 ENDIF ;
uNLoadEpiN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mNLoadNH4EpiN4 + mNLoadNO3EpiN4 + mNLoadGrenEpiN4 + mNLoadDiatEpiN4 + mNLoadBlueEpiN4 + mNLoadDetEpiN4) ELSEIF (ReadNLoadN4 EQ TRUE AND ReadNutFracN4 EQ TRUE) THEN mNLoadNH4EpiN4 + mNLoadNO3EpiN4 + mNLoadOrgEpiN4 ELSEIF (ReadNLoadN4 EQ TRUE AND ReadNutFracN4 EQ FALSE) THEN mNLoadEpiN4 ELSEIF (UsePulseLoadN4 EQ TRUE) THEN 0.0 ELSEIF (ReadPLoadN4 EQ TRUE) THEN cNPLoadMeasN4 * uPLoadEpiN4 ELSEIF (UseSeasonLoadN4 EQ TRUE) THEN uNLoadSeasonEpiN4 ELSE cNLoadN4 ENDIF;
uNLoadDetEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadDetEpiN4 ELSEIF (ReadNLoadN4 EQ FALSE ) THEN MIN(cNPDetInN4 * uPLoadDetEpiN4, uNLoadEpiN4 - uNLoadPhytTotEpiN4) ELSEIF (ReadNutFracN4 EQ TRUE) THEN mNLoadOrgEpiN4 - mNLoadPhytTotEpiN4 ELSE MIN(cNPDetInN4 * uPLoadDetEpiN4, uNLoadEpiN4 - uNLoadPhytTotEpiN4) ENDIF;
uNLoadOrgEpiN4 = IF (FALSE EQ ReadNLoadN4) THEN uNLoadPhytTotEpiN4 + uNLoadDetEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN mNLoadOrgEpiN4 ELSE uNLoadPhytTotEpiN4 + uNLoadDetEpiN4 ENDIF;
uNLoadDissEpiN4 = IF (FALSE EQ ReadNLoadN4) THEN uNLoadEpiN4 - uNLoadOrgEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN 0.0 ELSE uNLoadEpiN4 - uNLoadOrgEpiN4 ENDIF;
uNLoadNH4EpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadNH4EpiN4 ELSEIF (ReadNLoadN4 EQ FALSE) THEN fNH4DissInN4 * uNLoadDissEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN mNLoadNH4EpiN4 ELSE fNH4DissInN4 * uNLoadDissEpiN4 ENDIF;
uNLoadNO3EpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadNO3EpiN4 ELSEIF (ReadNLoadN4 EQ FALSE) THEN (1.0 - fNH4DissInN4) * uNLoadDissEpiN4 ELSEIF (ReadNutFracN4 EQ TRUE) THEN mNLoadNO3EpiN4 ELSE (1.0 - fNH4DissInN4) * uNLoadDissEpiN4 ENDIF;
uNBackLoadHypN4 = IF (FALSE EQ aInclStratN4) THEN 0.0 ELSE cNBackLoadN4 ENDIF;
uNTotInEpiN4 = uNLoadEpiN4 / (uQInEpiN4 / mmPermN4 + NearZeroN4);
uDLoadDetEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mDLoadDetEpiN4 ELSEIF (ReadDLoadDetN4 EQ TRUE) THEN mDLoadDetEpiN4 ELSE uNLoadDetEpiN4 / cNDDetInN4 ENDIF;
uDLoadPhytTotEpiN4 = uNLoadPhytTotEpiN4 / cNDPhytInN4;
uDLoadIMEpiN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadIMEpiN4 ELSEIF (ReadDLoadIMN4 EQ TRUE) THEN mDLoadIMEpiN4 ELSE cDIMInN4 * uQInEpiN4 / mmPermN4 ENDIF;
uDLoadEpiN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mDLoadIMEpiN4 + mDLoadDetEpiN4 + mDLoadDiatEpiN4 + mDLoadGrenEpiN4 + mDLoadBlueEpiN4) ELSE uDLoadIMEpiN4 + uDLoadDetEpiN4 + uDLoadPhytTotEpiN4 ENDIF;
uDLoadDiatEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mDLoadDiatEpiN4 ELSE fDiatPhytInN4 * uDLoadPhytTotEpiN4 ENDIF;
uPLoadDiatEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadDiatEpiN4 ELSE fDiatPhytInN4 * uPLoadPhytTotEpiN4 ENDIF;
uNLoadDiatEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadDiatEpiN4 ELSE fDiatPhytInN4 * uNLoadPhytTotEpiN4 ENDIF;
uDLoadGrenEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mDLoadGrenEpiN4 ELSE fGrenPhytInN4 * uDLoadPhytTotEpiN4 ENDIF;
uPLoadGrenEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadGrenEpiN4 ELSE fGrenPhytInN4 * uPLoadPhytTotEpiN4 ENDIF;
uNLoadGrenEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadGrenEpiN4 ELSE fGrenPhytInN4 * uNLoadPhytTotEpiN4 ENDIF;
uDLoadBlueEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mDLoadBlueEpiN4 ELSE fBluePhytInN4 * uDLoadPhytTotEpiN4 ENDIF;
uPLoadBlueEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadBlueEpiN4 ELSE fBluePhytInN4 * uPLoadPhytTotEpiN4 ENDIF;
uNLoadBlueEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadBlueEpiN4 ELSE fBluePhytInN4 * uNLoadPhytTotEpiN4 ENDIF;
uDLoadZooEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mDLoadZooEpiN4 ELSE cDZooInN4 * uQInEpiN4 / mmPermN4 ENDIF;
uPLoadZooEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mPLoadZooEpiN4 ELSE cDZooInN4 * cPDZooRefN4 * uQInEpiN4 / mmPermN4 ENDIF;
uNLoadZooEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mNLoadZooEpiN4 ELSE cDZooInN4 * cNDZooRefN4 * uQInEpiN4 / mmPermN4 ENDIF;
uSiLoadSiO2EpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mSiLoadSiO2EpiN4 ELSE cSiO2InN4 * uQInEpiN4 / mmPermN4 ENDIF;
uSiLoadDetEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mSiLoadDetEpiN4 ELSE cSiDDetInN4 * uDLoadDetEpiN4 ENDIF;
uSiLoadDiatEpiN4 = cSiDDiatN4 * uDLoadDiatEpiN4;
uSiLoadEpiN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2EpiN4 + uSiLoadDetEpiN4 + uSiLoadDiatEpiN4 ENDIF;
uDLoadBlueSurfN4= IF (ReadTranFracN4 EQ TRUE) THEN mDLoadBlueSurfN4 ELSE 0.0 ENDIF;
uPLoadBlueSurfN4= IF (ReadTranFracN4 EQ TRUE) THEN mPLoadBlueSurfN4 ELSE 0.0 ENDIF;
uNLoadBlueSurfN4= IF (ReadTranFracN4 EQ TRUE) THEN mNLoadBlueSurfN4 ELSE 0.0 ENDIF;
uNLoadNH4HypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadNH4HypN4 ELSE 0 ENDIF;
uNLoadNO3HypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadNO3HypN4 ELSE 0 ENDIF;
uPLoadPO4HypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadPO4HypN4 ELSE 0 ENDIF;
uPLoadAIMHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadAIMHypN4 ELSE 0 ENDIF;
uSiLoadSiO2HypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mSiLoadSiO2HypN4 ELSE 0 ENDIF;
uO2LoadHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mO2LoadHypN4 ELSE cO2InN4 * uQInHypN4 / mmPermN4 ENDIF;
uDLoadDetHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadDetHypN4 ELSE 0 ENDIF;
uNLoadDetHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadDetHypN4 ELSE 0 ENDIF;
uPLoadDetHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadDetHypN4 ELSE 0 ENDIF;
uSiLoadDetHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mSiLoadDetHypN4 ELSE 0 ENDIF;
uDLoadIMHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadIMHypN4 ELSE 0 ENDIF;
uDLoadDiatHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadDiatHypN4 ELSE 0 ENDIF;
uNLoadDiatHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadDiatHypN4 ELSE 0 ENDIF;
uPLoadDiatHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadDiatHypN4 ELSE 0 ENDIF;
uSiLoadDiatHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN cSiDDiatN4 * uDLoadDiatHypN4 ELSE 0 ENDIF;
uDLoadGrenHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadGrenHypN4 ELSE 0 ENDIF;
uNLoadGrenHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadGrenHypN4 ELSE 0 ENDIF;
uPLoadGrenHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadGrenHypN4 ELSE 0 ENDIF;
uDLoadBlueHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadBlueHypN4 ELSE 0 ENDIF;
uNLoadBlueHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadBlueHypN4 ELSE 0 ENDIF;
uPLoadBlueHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadBlueHypN4 ELSE 0 ENDIF;
uDLoadZooHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mDLoadZooHypN4 ELSE 0 ENDIF;
uNLoadZooHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mNLoadZooHypN4 ELSE 0 ENDIF;
uPLoadZooHypN4= IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN mPLoadZooHypN4 ELSE 0 ENDIF;
uDLoadHypN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mDLoadIMHypN4 + mDLoadDetHypN4 + mDLoadDiatHypN4 + mDLoadGrenHypN4 + mDLoadBlueHypN4) ELSE 0.0 ENDIF;
uNLoadHypN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mNLoadNH4HypN4 + mNLoadNO3HypN4 + mNLoadGrenHypN4 + mNLoadDiatHypN4 + mNLoadBlueHypN4 + mNLoadDetHypN4) ELSE 0.0 ENDIF;
uPLoadHypN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (ReadTranFracN4 EQ TRUE) THEN (mPLoadPO4HypN4 + mPLoadAIMHypN4 + mPLoadDiatHypN4 + mPLoadGrenHypN4 + mPLoadBlueHypN4 + mPLoadDetHypN4) ELSE 0.0 ENDIF;
uSiLoadHypN4 = IF (InclTranN4 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE uSiLoadSiO2HypN4 + uSiLoadDetHypN4 + uSiLoadDiatHypN4 ENDIF;
wDDilIMHypN4 = ukOutHypN4 * oDIMWHypN4;
wDDilDetHypN4 = ukOutHypN4 * oDDetWHypN4;
wDDilGrenHypN4 = ukOutHypN4 * oDGrenWHypN4;
wDDilBlueHypN4 = ukOutHypN4 * oDBlueWHypN4;
wDDilDiatHypN4 = ukOutHypN4 * oDDiatWHypN4;
wDDilZooHypN4 = ukOutHypN4 * oDZooHypN4;
wPDilZooHypN4 = ukOutHypN4 * oPZooHypN4;
wNDilZooHypN4 = ukOutHypN4 * oNZooHypN4;
wPDilPO4HypN4 = ukOutHypN4 * oPO4WHypN4;
wPDilDetHypN4 = ukOutHypN4*oPDetWHypN4;
wPDilAIMHypN4 = ukOutHypN4 * oPAIMWHypN4;
wNDilNH4HypN4 = ukOutHypN4 * oNH4WHypN4;
wNDilNO3HypN4 = ukOutHypN4 * oNO3WHypN4;
wNDilDetHypN4 = ukOutHypN4 * oNDetWHypN4;
wO2OutflHypN4 = ukOutHypN4 * oO2WHypN4;
wPDilDiatHypN4 = ukOutHypN4 * oPDiatWHypN4;
wNDilDiatHypN4 = ukOutHypN4 * oNDiatWHypN4;
wPDilGrenHypN4 = ukOutHypN4 * oPGrenWHypN4;
wNDilGrenHypN4 = ukOutHypN4 * oNGrenWHypN4;
wPDilBlueHypN4 = ukOutHypN4 * oPBlueWHypN4;
wNDilBlueHypN4 = ukOutHypN4 * oNBlueWHypN4;
wSiDilSiO2HypN4 = ukOutHypN4 * oSiO2WHypN4;
wSiDilDetHypN4 = ukOutHypN4 * oSiDetWHypN4;
wSiDilDiatHypN4 = cSiDDiatN4 * wDDilDiatHypN4;
wDDilPhytHypN4 = wDDilDiatHypN4 + wDDilGrenHypN4 + wDDilBlueHypN4;
wPDilPhytHypN4 = wPDilDiatHypN4 + wPDilGrenHypN4 + wPDilBlueHypN4;
wNDilPhytHypN4 = wNDilDiatHypN4 + wNDilGrenHypN4 + wNDilBlueHypN4;
wSiDilTotHypN4 = wSiDilDetHypN4 + wSiDilSiO2HypN4 + wSiDilDiatHypN4;
wDOutflTotHypN4 = ukOutHypN4 * oDSestWHypN4;
wPOutflTotHypN4 = ukOutHypN4 * oPTotWHypN4;
wNOutflTotHypN4 = ukOutHypN4 * oNTotWHypN4;
wSiOutflTotHypN4 = ukOutHypN4 * (oSiO2WHypN4 + oSiDetWHypN4 + cSiDDiatN4 * oDDiatWHypN4);
tSiTranTotTHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadHypN4 - wSiDilTotHypN4 * uDepthWHypN4 ENDIF;
wDDilTotHypN4 = wDDilIMHypN4 + wDDilDetHypN4 + wDDilPhytHypN4;
wPDilTotHypN4 = wPDilDetHypN4 + wPDilPO4HypN4 + wPDilAIMHypN4 + wPDilPhytHypN4;
wNDilTotHypN4 = wNDilDetHypN4 + wNDilNO3HypN4 + wNDilNH4HypN4 + wNDilPhytHypN4;
tDTranTotTHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadHypN4 - wDDilTotHypN4 * uDepthWHypN4 ENDIF;
tPTranTotTHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadHypN4 - wPDilTotHypN4 * uDepthWHypN4 ENDIF;
tNTranTotTHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadHypN4 - wNDilTotHypN4 * uDepthWHypN4 ENDIF;
uDLoadTotTWN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadEpiN4 + uDLoadHypN4 ENDIF;
uPLoadTotTWN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadEpiN4 + uPLoadHypN4 ENDIF;
uNLoadTotTWN4 =  IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadEpiN4 + uNLoadHypN4 ENDIF;
uSiLoadTotTWN4 =  IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadEpiN4 + uSiLoadHypN4 ENDIF;
wDExchIMMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDIMWHypN4 - oDIMWMN4) ELSE 0.0 ENDIF;
wPExchPO4MHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPO4WHypN4 - oPO4WMN4) ELSE 0.0 ENDIF;
wPExchAIMMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPAIMWHypN4 - oPAIMWMN4) ELSE 0.0 ENDIF;
wNExchNH4MHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNH4WHypN4 - oNH4WMN4) ELSE 0.0 ENDIF;
wNExchNO3MHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNO3WHypN4 - oNO3WMN4) ELSE 0.0 ENDIF;
wSiExchSiO2MHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oSiO2WHypN4 - oSiO2WMN4) ELSE 0.0 ENDIF;
wO2ExchMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oO2WHypN4 - oO2WMN4) ELSE 0.0 ENDIF;
wDExchDetMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDDetWHypN4 - oDDetWMN4) ELSE 0.0 ENDIF;
wPExchDetMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPDetWHypN4 - oPDetWMN4) ELSE 0.0 ENDIF;
wNExchDetMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNDetWHypN4 - oNDetWMN4) ELSE 0.0 ENDIF;
wSiExchDetMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oSiDetWHypN4 - oSiDetWMN4) ELSE 0.0 ENDIF;
wDExchDiatMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDDiatWHypN4 - oDDiatWMN4) ELSE 0.0 ENDIF;
wPExchDiatMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPDiatWHypN4 - oPDiatWMN4) ELSE 0.0 ENDIF;
wNExchDiatMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNDiatWHypN4 - oNDiatWMN4) ELSE 0.0 ENDIF;
wSiExchDiatMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cSiDDiatN4 * wDExchDiatMHypN4 ELSE 0.0 ENDIF;
wDExchGrenMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDGrenWHypN4 - oDGrenWMN4) ELSE 0.0 ENDIF;
wPExchGrenMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPGrenWHypN4 - oPGrenWMN4) ELSE 0.0 ENDIF;
wNExchGrenMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNGrenWHypN4 - oNGrenWMN4) ELSE 0.0 ENDIF;
wDExchBlueMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDBlueWHypN4 - oDBlueWMN4) ELSE 0.0 ENDIF;
wPExchBlueMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPBlueWHypN4 - oPBlueWMN4) ELSE 0.0 ENDIF;
wNExchBlueMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNBlueWHypN4 - oNBlueWMN4) ELSE 0.0 ENDIF;
wDExchZooMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oDZooHypN4 - oDZooMN4) ELSE 0.0 ENDIF;
wPExchZooMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oPZooHypN4 - oPZooMN4) ELSE 0.0 ENDIF;
wNExchZooMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMHypN4 *(oNZooHypN4 - oNZooMN4) ELSE 0.0 ENDIF;
wDExchIMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDIMWHypN4 - oDIMWMN4) ELSE 0.0 ENDIF;
wPExchPO4HypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPO4WHypN4 - oPO4WMN4) ELSE 0.0 ENDIF;
wPExchAIMHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPAIMWHypN4 - oPAIMWMN4) ELSE 0.0 ENDIF;
wNExchNH4HypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNH4WHypN4 - oNH4WMN4) ELSE 0.0 ENDIF;
wNExchNO3HypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNO3WHypN4 - oNO3WMN4) ELSE 0.0 ENDIF;
wSiExchSiO2HypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oSiO2WHypN4 - oSiO2WMN4) ELSE 0.0 ENDIF;
wO2ExchHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oO2WHypN4 - oO2WMN4) ELSE 0.0 ENDIF;
wDExchDetHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDDetWHypN4 - oDDetWMN4) ELSE 0.0 ENDIF;
wPExchDetHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPDetWHypN4 - oPDetWMN4) ELSE 0.0 ENDIF;
wNExchDetHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNDetWHypN4 - oNDetWMN4) ELSE 0.0 ENDIF;
wSiExchDetHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oSiDetWHypN4 - oSiDetWMN4) ELSE 0.0 ENDIF;
wDExchDiatHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDDiatWHypN4 - oDDiatWMN4) ELSE 0.0 ENDIF;
wPExchDiatHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPDiatWHypN4 - oPDiatWMN4) ELSE 0.0 ENDIF;
wNExchDiatHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNDiatWHypN4 - oNDiatWMN4) ELSE 0.0 ENDIF;
wSiExchDiatHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cSiDDiatN4 * wDExchDiatHypN4 ELSE 0.0 ENDIF;
wDExchGrenHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDGrenWHypN4 - oDGrenWMN4) ELSE 0.0 ENDIF;
wPExchGrenHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPGrenWHypN4 - oPGrenWMN4) ELSE 0.0 ENDIF;
wNExchGrenHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNGrenWHypN4 - oNGrenWMN4) ELSE 0.0 ENDIF;
wDExchBlueHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDBlueWHypN4 - oDBlueWMN4) ELSE 0.0 ENDIF;
wPExchBlueHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPBlueWHypN4 - oPBlueWMN4) ELSE 0.0 ENDIF;
wNExchBlueHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNBlueWHypN4 - oNBlueWMN4) ELSE 0.0 ENDIF;
wDExchZooHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oDZooHypN4 - oDZooMN4) ELSE 0.0 ENDIF;
wPExchZooHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oPZooHypN4 - oPZooMN4) ELSE 0.0 ENDIF;
wNExchZooHypN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLHypN4 *(oNZooHypN4 - oNZooMN4) ELSE 0.0 ENDIF;
tInfSiO2WHypN4 =  IF (InclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oSiO2WHypN4 ELSE 0.0 ENDIF;
tInfO2WHypN4 =  IF (InclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oO2WHypN4 ELSE 0.0 ENDIF;
tPInfPO4WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oPO4WHypN4 ELSE 0.0 ENDIF;
tNInfNH4WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNH4WHypN4 ELSE 0.0 ENDIF;
tNInfNO3WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNO3WHypN4 ELSE 0.0 ENDIF;
tPInfPO4SN4 = IF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oPO4SN4 ELSE 0.0 ENDIF;
tNInfNH4SN4 = IF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNH4SN4 ELSE 0.0 ENDIF;
tNInfNO3SN4 = IF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNO3SN4 ELSE 0.0 ENDIF;
tSeepSiO2WHypN4 =  IF (InclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WHypN4 =  IF (InclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oPO4SN4 ELSE 0.0 ENDIF;
tNSeepNH4WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNH4SN4 ELSE 0.0 ENDIF;
tNSeepNO3WHypN4 = IF (aInclStratN4 EQ FALSE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNO3SN4 ELSE 0.0 ENDIF;
tPSeepPO4SN4 = IF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cPO4GroundN4 ELSE 0.0 ENDIF;
tNSeepNH4SN4 = IF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cNH4GroundN4 ELSE 0.0 ENDIF;
tNSeepNO3SN4 = IF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cNO3GroundN4 ELSE 0.0 ENDIF;
tNH4LoadSN4 = fNH4LoadSN4 * cNLoadSN4;
tNO3LoadSN4 = cNLoadSN4 - tNH4LoadSN4;
uDErosIMN4 = (1.0 - fDOrgSoilN4) * cDErosTotN4;
uDErosIMSN4 = fSedErosIMN4 * uDErosIMN4;
uDErosIMWN4 = uDErosIMN4 - uDErosIMSN4;
uDErosOMN4 = fDOrgSoilN4 * cDErosTotN4;
uPErosOMN4 = cPDSoilOMN4 * uDErosOMN4;
uNErosOMN4 = cNDSoilOMN4 * uDErosOMN4;
uO2SatEpiN4 = 14.652 - 0.41022 * uTmEpiN4 + 0.007991 * uTmEpiN4*uTmEpiN4 - 0.000077774 * uTmEpiN4*uTmEpiN4*uTmEpiN4;
uO2SatHypN4 = 14.652 - 0.41022 * uTmHypN4 + 0.007991 * uTmHypN4*uTmHypN4- 0.000077774 *uTmHypN4*uTmHypN4*uTmHypN4;
kAerN4 = IF POW ( uVWindN4 , (0.5))  LE NearZeroN4 THEN 1 ELSE cAerRootN4 * POW ( uVWindN4 , (0.5)) + cAerLinN4 * uVWindN4 + cAerSquareN4 * uVWindN4*uVWindN4 ENDIF;
uFunTmAerEpiN4 = IF  POW ( cThetaAerN4 , (uTmEpiN4-cTmRefN4)) LE NearZeroN4 THEN 1 ELSE POW ( cThetaAerN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
uFunTmAerHypN4 = IF POW ( cThetaAerN4 , (uTmHypN4-cTmRefN4)) LE NearZeroN4 THEN 1 ELSE POW ( cThetaAerN4 , (uTmHypN4-cTmRefN4)) ENDIF;
aFunFloatAerN4 =  MAX( 0.0, 1.0 -  ( kFloatAerN4 * aDFloatVegN4 ) );
aFunBlueSurfAerN4 = MAX(0.0, 1.0 - (kBlueSurfAerN4 * aDBlueSurfN4));
tO2BubHypN4 = IF (uO2SatHypN4 LT oO2WHypN4 ) THEN kBubN4 * uFunTmAerHypN4 * (uO2SatHypN4 - oO2WHypN4) ELSE 0 ENDIF;
uFunTmFishN4 = IF (InclWebN4 EQ TRUE) THEN EXP( -0.5/(cSigTmFishN4*cSigTmFishN4) * (( MAX (uTmEpiN4, uTmHypN4 * aInclStratN4) - cTmOptFishN4)*( MAX (uTmEpiN4, uTmHypN4 * aInclStratN4) - cTmOptFishN4) - (cTmRefN4 - cTmOptFishN4)*(cTmRefN4 - cTmOptFishN4))) ELSE 0.0 ENDIF;
tDTurbFishN4 = IF (InclWebN4 EQ TRUE) THEN (kTurbFishN4 * uFunTmFishN4 * aDFiAdN4) ELSE 0.0 ENDIF;
aFunVegResusN4 = MAX(1.0 - kVegResusN4 * aDVegN4, NearZeroN4);
aFunDimSuspN4 = IF (uTmEpiN4 GE 0.1) OR  POW(((cFetchN4 +NearZeroN4)/ cFetchRefN4) , (0.5)) LE NearZeroN4 THEN cSuspRefN4 * ((cSuspMinN4 + cSuspMaxN4 / (1.0 + EXP(cSuspSlopeN4 * (uDepthWN4 - hDepthSuspN4)))) * POW(((cFetchN4 +NearZeroN4)/ cFetchRefN4) , (0.5))) ELSE 0.0 ENDIF;
tDResusTauDeadN4 = IF POW(aFunDimSuspN4 +NearZeroN4 , (0.5)) LE NearZeroN4 THEN MIN(aFunDimSuspN4, POW( 1  , (0.5))) * POW(fLutumN4 / fLutumRefN4 , (0.5)) * bPorSN4 ELSE MIN(aFunDimSuspN4, POW(aFunDimSuspN4 +NearZeroN4 , (0.5))) * POW(fLutumN4 / fLutumRefN4 , (0.5)) * bPorSN4 ENDIF;
tDResusBareDeadN4 = tDResusTauDeadN4 + tDTurbFishN4;
tDResusDeadN4 = tDResusBareDeadN4 * aFunVegResusN4;
tDResusIMN4 = fLutumN4 * aDIMSN4 / (fLutumN4 * aDIMSN4 + aDDetSN4) * tDResusDeadN4;
tDResusDetN4 = aDDetSN4 / (fLutumN4 * aDIMSN4 + aDDetSN4) * tDResusDeadN4;
akResusPhytRefN4 = kResusPhytMaxN4 * (1.0 - EXP(cResusPhytExpN4 * tDResusDeadN4));
tDResusPhytTotN4 = akResusPhytRefN4 * aDPhytSN4;
tPResusDetN4 = rPDDetSN4 * tDResusDetN4;
tPResusPO4N4 = aPO4SN4 / aDDetSN4 * tDResusDetN4;
tPResusAIMN4 = aPAIMSN4 / aDIMSN4 * tDResusIMN4;
tNResusNO3N4 = aNO3SN4 / aDDetSN4 * tDResusDetN4;
tNResusNH4N4 = aNH4SN4 / aDDetSN4 * tDResusDetN4;
tNResusDetN4 = rNDDetSN4 * tDResusDetN4;
tSiResusDetN4 = rSiDDetSN4 * tDResusDetN4;
aFunTauSetOMHypN4 = IF POW(aFunDimSuspN4 +NearZeroN4 , (0.5)) LT NearZeroN4 THEN 1 ELSE MIN(1.0 / POW(aFunDimSuspN4 +NearZeroN4 , (0.5)), 1.0) ENDIF;
aFunTauSetIMHypN4 = aFunTauSetOMHypN4;
uFunTmSetEpiN4 = IF POW ( cThetaSetN4 , (uTmEpiN4-cTmRefN4)) LT NearZeroN4 THEN 1 ELSE POW ( cThetaSetN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
uFunTmSetHypN4 = IF POW(cThetaSetN4 , (uTmHypN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE POW(cThetaSetN4 , (uTmHypN4-cTmRefN4)) ENDIF;
uCorVSetIMHypN4 = IF POW((fLutumRefN4/fLutumN4) , (0.5))  LT NearZeroN4 THEN 1 ELSE aFunTauSetIMHypN4 * POW((fLutumRefN4/fLutumN4) , (0.5)) * uFunTmSetHypN4 * (cVSetIMN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) ENDIF;
tDSetIMHypN4 = uCorVSetIMHypN4 * oDIMWHypN4;
tPSetAIMHypN4 = oPAIMWHypN4 / oDIMWHypN4 * tDSetIMHypN4;
uCorVSetDetHypN4 = (cVSetDetN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMHypN4 * uFunTmSetHypN4;
tDSetDetHypN4 = uCorVSetDetHypN4 * oDDetWHypN4;
tPSetDetHypN4 = uCorVSetDetHypN4 * oPDetWHypN4;
tNSetDetHypN4 = uCorVSetDetHypN4 * oNDetWHypN4;
tSiSetDetHypN4 = uCorVSetDetHypN4 * oSiDetWHypN4;
kPMinDetWN4 = kDMinDetWN4;
kNMinDetWN4 = kDMinDetWN4;
kSiMinDetWN4 = kDMinDetWN4;
uFunTmMinWEpiN4 =  IF POW(cThetaMinWN4 , (uTmEpiN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE POW(cThetaMinWN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
uFunTmMinWHypN4 = IF POW(cThetaMinWN4 , (uTmEpiN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE  POW(cThetaMinWN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
wDMinDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kDMinDetWN4 * uFunTmMinWHypN4 * oDDetWHypN4 ENDIF;
wPMinDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kPMinDetWN4 * uFunTmMinWHypN4 * oPDetWHypN4 ENDIF;
wNMinDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kNMinDetWN4 * uFunTmMinWHypN4 * oNDetWHypN4 ENDIF;
wSiMinDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kSiMinDetWN4 * uFunTmMinWHypN4 * oSiDetWHypN4 ENDIF;
aCorO2BODHypN4 = oO2WHypN4 / (hO2BODN4 + oO2WHypN4);
wO2MinDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE molO2molCN4 * cCPerDWN4 * aCorO2BODHypN4 * wDMinDetWHypN4 ENDIF;
wDDenitWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE oNO3WHypN4*oNO3WHypN4 / (hNO3DenitN4*hNO3DenitN4 + oNO3WHypN4*oNO3WHypN4) * (1.0 - aCorO2BODHypN4) * wDMinDetWHypN4 ENDIF;
wNDenitWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE NO3PerCN4 * molNmolCN4 * cCPerDWN4 * wDDenitWHypN4 ENDIF;
uFunTmNitrHypN4 = IF   POW(cThetaNitrN4 , (uTmHypN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE POW(cThetaNitrN4 , (uTmHypN4-cTmRefN4)) ENDIF;
uFunTmNitrEpiN4 =  IF POW(cThetaNitrN4 , (uTmEpiN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE POW(cThetaNitrN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
uFunTmNitrSN4 = IF POW(cThetaNitrN4 , (uTmEpiN4-cTmRefN4))  LT NearZeroN4 THEN 1 ELSE POW(cThetaNitrN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
aCorO2NitrWHypN4 = oO2WHypN4*oO2WHypN4 / (hO2NitrN4*hO2NitrN4 + oO2WHypN4*oO2WHypN4);
wNNitrWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kNitrWN4 * uFunTmNitrHypN4 * aCorO2NitrWHypN4 * oNH4WHypN4 ENDIF;
wO2NitrWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE O2PerNH4N4 * molO2molNN4 * wNNitrWHypN4 ENDIF;
kPMinDetSN4 = kDMinDetSN4;
kNMinDetSN4 = kDMinDetSN4;
kSiMinDetSN4 = kDMinDetSN4;
uFunTmMinSN4 = IF POW(cThetaMinSN4 , (uTmBotN4-cTmRefN4)) LT NearZeroN4 THEN 1 ELSE  POW(cThetaMinSN4 , (uTmBotN4-cTmRefN4)) ENDIF;
tDMinDetSN4 = kDMinDetSN4 * uFunTmMinSN4 * aDDetSN4;
tPMinDetSN4 = kPMinDetSN4 * uFunTmMinSN4 * aPDetSN4;
tNMinDetSN4 = kNMinDetSN4 * uFunTmMinSN4 * aNDetSN4;
tSiMinDetSN4 = kSiMinDetSN4 * uFunTmMinSN4 * aSiDetSN4;
uFunTmDifN4 = IF POW(cThetaDifN4 , (uTmEpiN4-cTmRefN4)) LT NearZeroN4 THEN 1 ELSE POW(cThetaDifN4 , (uTmEpiN4-cTmRefN4)) ENDIF;
akO2DifCorN4 = kO2DifN4 * uFunTmDifN4 * cTurbDifO2N4 * bPorCorSN4;
tSODN4 = (molO2molCN4 * cCPerDWN4 * (1.0 - fRefrDetSN4) * tDMinDetSN4 + O2PerNH4N4 * molO2molNN4 * kNitrSN4 * uFunTmNitrSN4 * aNH4SN4) / cDepthSN4;
aDepthDifN4 = fDepthDifSN4 * cDepthSN4;
tPDifPO4HypN4 = IF ( aInclStratN4 EQ TRUE ) THEN kPDifPO4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oPO4SN4 - oPO4WHypN4 ) / aDepthDifN4 ELSE 0.0 ENDIF ;
tNDifNO3HypN4 = IF ( aInclStratN4 EQ TRUE ) THEN kNDifNO3N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oNO3SN4 - oNO3WHypN4 ) / aDepthDifN4 ELSE 0.0 ENDIF ;
tNDifNH4HypN4 = IF ( aInclStratN4 EQ TRUE ) THEN kNDifNH4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oNH4SN4 - oNH4WHypN4 ) / aDepthDifN4 ELSE 0.0 ENDIF ;
tO2DifHypN4 = IF ( aInclStratN4 EQ TRUE ) THEN kO2DifN4 / aDepthDifN4 * uFunTmDifN4 * cTurbDifO2N4 * bPorCorSN4 * oO2WHypN4 ELSE 0.0 ENDIF ;
tPDifGroundPO4N4 = 0.0;
tNDifGroundNO3N4 = 0.0;
tNDifGroundNH4N4 = 0.0;
aPAdsMaxWHypN4 = cRelPAdsDN4 + aCorO2BODHypN4 * cRelPAdsFeN4 * fFeDIMN4 + cRelPAdsAlN4 * fAlDIMN4;
aKPAdsWHypN4 = (1.0 - fRedMaxN4 * (1.0-aCorO2BODHypN4)) * cKPAdsOxN4;
aPIsoAdsWHypN4 = aPAdsMaxWHypN4 * aKPAdsWHypN4 * oPO4WHypN4 / (1.0 + aKPAdsWHypN4 * oPO4WHypN4);
aPEqIMWHypN4 = aPIsoAdsWHypN4 * oDIMWHypN4;
wPSorpIMWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kPSorpN4 * (aPEqIMWHypN4 - oPAIMWHypN4) ENDIF;
tPChemPO4N4 = MAX( 0.0, kPChemPO4N4 * (oPO4SN4 - coPO4MaxN4) );
uQEvPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN uQEvN4 ELSE 0.0 ENDIF;
tPEvPO4WMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN uQEvPhraN4 / mmPermN4 * oPO4WMN4 ELSE 0.0 ENDIF;
tNEvNH4WMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN uQEvPhraN4 / mmPermN4 * oNH4WMN4 ELSE 0.0 ENDIF;
tNEvNO3WMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN uQEvPhraN4 / mmPermN4 * oNO3WMN4 ELSE 0.0 ENDIF;
tInfSiO2WMN4 = IF ((InclMarshN4 EQ FALSE) OR (fMarshN4 LE NearZeroN4)) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oSiO2WMN4 ELSE 0.0 ENDIF;
tInfO2WMN4 = IF ((InclMarshN4 EQ FALSE) OR (fMarshN4 LE NearZeroN4)) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oO2WMN4 ELSE 0.0 ENDIF;
tPInfPO4WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oPO4WMN4 ELSE 0.0 ENDIF;
tNInfNH4WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNH4WMN4 ELSE 0.0 ENDIF;
tNInfNO3WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNO3WMN4 ELSE 0.0 ENDIF;
tPInfPO4SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oPO4SMN4 ELSE 0.0 ENDIF;
tNInfNH4SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNH4SMN4 ELSE 0.0 ENDIF;
tNInfNO3SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNO3SMN4 ELSE 0.0 ENDIF;
tSeepSiO2WMN4 = IF ((InclMarshN4 EQ FALSE) OR (fMarshN4 LT NearZeroN4)) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WMN4 = IF ((InclMarshN4 EQ FALSE) OR (fMarshN4 LT NearZeroN4)) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oPO4SMN4 ELSE 0.0 ENDIF;
tNSeepNH4WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNH4SMN4 ELSE 0.0 ENDIF;
tNSeepNO3WMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNO3SMN4 ELSE 0.0 ENDIF;
tPSeepPO4SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cPO4GroundN4 ELSE 0.0 ENDIF;
tNSeepNH4SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cNH4GroundN4 ELSE 0.0 ENDIF;
tNSeepNO3SMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * cNO3GroundN4 ELSE 0.0 ENDIF;
tO2AerMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kAerN4 * uFunTmAerEpiN4 *(uO2SatEpiN4 - oO2WMN4) ELSE 0.0 ENDIF;
tDSetIMMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetIMN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oDIMWMN4 ELSE 0.0 ENDIF;
tPSetAIMMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetIMN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oPAIMWMN4 ELSE 0.0 ENDIF;
tDSetDetMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDetN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oDDetWMN4 ELSE 0.0 ENDIF;
tPSetDetMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDetN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oPDetWMN4 ELSE 0.0 ENDIF;
tNSetDetMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDetN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oNDetWMN4 ELSE 0.0 ENDIF;
tSiSetDetMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDetN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oSiDetWMN4 ELSE 0.0 ENDIF;
tDSetDiatMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ( cVSetDiatN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oDDiatWMN4 ELSE 0.0 ENDIF;
tPSetDiatMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDiatN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oPDiatWMN4 ELSE 0.0 ENDIF;
tNSetDiatMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ( cVSetDiatN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oNDiatWMN4 ELSE 0.0 ENDIF;
tSiSetDiatMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetDiatN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oSiDiatWMN4 ELSE 0.0 ENDIF;
tDSetGrenMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetGrenN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oDGrenWMN4 ELSE 0.0 ENDIF;
tPSetGrenMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetGrenN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oPGrenWMN4 ELSE 0.0 ENDIF;
tNSetGrenMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetGrenN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oNGrenWMN4 ELSE 0.0 ENDIF;
tDSetBlueMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4 * oDBlueWMN4 ELSE 0.0 ENDIF;
tPSetBlueMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4)* uFunTmSetEpiN4* oPBlueWMN4 ELSE 0.0 ENDIF;
tNSetBlueMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * uFunTmSetEpiN4* oNBlueWMN4 ELSE 0.0 ENDIF;
tDSetPhytMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDSetDiatMN4 + tDSetGrenMN4 + tDSetBlueMN4 ELSE 0.0 ENDIF;
tPSetPhytMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tPSetDiatMN4 + tPSetGrenMN4 + tPSetBlueMN4 ELSE 0.0 ENDIF;
tNSetPhytMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tNSetDiatMN4 + tNSetGrenMN4 + tNSetBlueMN4 ELSE 0.0 ENDIF;
tDSetTotMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDSetIMMN4 + tDSetDetMN4 + tDSetPhytMN4 ELSE 0.0 ENDIF;
wDMinDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMinDetWN4 * uFunTmMinWEpiN4 * oDDetWMN4 ELSE 0.0 ENDIF;
wPMinDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kPMinDetWN4 * uFunTmMinWEpiN4 * oPDetWMN4 ELSE 0.0 ENDIF;
wNMinDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kNMinDetWN4 * uFunTmMinWEpiN4 * oNDetWMN4 ELSE 0.0 ENDIF;
wSiMinDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kSiMinDetWN4 * uFunTmMinWEpiN4 * oSiDetWMN4 ELSE 0.0 ENDIF;
aCorO2BODMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oO2WMN4 /(hO2BODN4 + oO2WMN4) ELSE 0.0 ENDIF;
wO2MinDetWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN molO2molCN4 * cCPerDWN4 * aCorO2BODMN4 * wDMinDetWMN4 ELSE 0.0 ENDIF;
wDDenitWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNO3WMN4*oNO3WMN4 /(hNO3DenitN4*hNO3DenitN4 + oNO3WMN4*oNO3WMN4) *(1.0 - aCorO2BODMN4) * wDMinDetWMN4 ELSE 0.0 ENDIF;
wNDenitWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN NO3PerCN4 * molNmolCN4 * cCPerDWN4 * wDDenitWMN4 ELSE 0.0 ENDIF;
aCorO2NitrWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oO2WMN4 * oO2WMN4 /(hO2NitrN4 * hO2NitrN4 + oO2WMN4 * oO2WMN4) ELSE 0.0 ENDIF;
wNNitrWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kNitrWN4 * uFunTmNitrEpiN4 * aCorO2NitrWMN4 * oNH4WMN4 ELSE 0.0 ENDIF;
wO2NitrWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN O2PerNH4N4 * molO2molNN4 * wNNitrWMN4 ELSE 0.0 ENDIF;
tDMinDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMinDetSN4 * uFunTmMinSN4 * aDDetSMN4 ELSE 0.0 ENDIF;
tPMinDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kPMinDetSN4 * uFunTmMinSN4 * aPDetSMN4 ELSE 0.0 ENDIF;
tNMinDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kNMinDetSN4 * uFunTmMinSN4 * aNDetSMN4 ELSE 0.0 ENDIF;
tSiMinDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kSiMinDetSN4 * uFunTmMinSN4 * aSiDetSMN4 ELSE 0.0 ENDIF;
akO2DifCorMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kO2DifN4 * uFunTmDifN4 * cTurbDifO2N4 * bPorCorSMN4 ELSE 0.0 ENDIF;
tSODMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN(molO2molCN4 * cCPerDWN4 *(1.0 - fRefrDetSN4) * tDMinDetSMN4 + O2PerNH4N4 * molO2molNN4 * kNitrSN4 * uFunTmNitrEpiN4 * aNH4SMN4) / cDepthSMN4 ELSE 0.0 ENDIF;
aDepthOxySedMN4 = IF (InclMarshN4 EQ FALSE OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF POW((2.0 * oO2WMN4 * akO2DifCorMN4 / tSODMN4) , (0.5)) LE NearZeroN4 THEN 1 ELSE POW((2.0 * oO2WMN4 * akO2DifCorMN4 / tSODMN4) , (0.5)) ENDIF ;
afOxySedMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDepthOxySedMN4 / cDepthSMN4 ELSE 0.0 ENDIF;
tDMinOxyDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN afOxySedMN4 *(1.0 - fRefrDetSN4) * tDMinDetSMN4 ELSE 0.0 ENDIF;
tO2MinDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN molO2molCN4 * cCPerDWN4 * tDMinOxyDetSMN4 ELSE 0.0 ENDIF;
tDDenitSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN oNO3SMN4*oNO3SMN4 /(hNO3DenitN4*hNO3DenitN4 + oNO3SMN4*oNO3SMN4) *(1.0 - afOxySedMN4) *(1.0 - fRefrDetSN4) * tDMinDetSMN4 ELSE 0.0 ENDIF;
tNDenitSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN NO3PerCN4 * molNmolCN4 * cCPerDWN4 * tDDenitSMN4 ELSE 0.0 ENDIF;
tNNitrSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN afOxySedMN4 * kNitrSN4 * uFunTmNitrEpiN4 * aNH4SMN4 ELSE 0.0 ENDIF;
tO2NitrSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN O2PerNH4N4 * molO2molNN4 * tNNitrSMN4 ELSE 0.0 ENDIF;
tDMinHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMinHumN4 * uFunTmMinSN4 * afOxySedMN4 * aDHumSMN4 ELSE 0.0 ENDIF;
tPMinHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMinHumN4 * uFunTmMinSN4 * afOxySedMN4 * aPHumSMN4 ELSE 0.0 ENDIF;
tNMinHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMinHumN4 * uFunTmMinSN4 * afOxySedMN4 * aNHumSMN4 ELSE 0.0 ENDIF;
aDepthDifMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN fDepthDifSN4 * cDepthSMN4 ELSE 0.0 ENDIF;
tPDifPO4MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kPDifPO4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSMN4 * (oPO4SMN4 - oPO4WMN4) / aDepthDifMN4 ELSE 0.0 ENDIF;
tNDifNO3MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kNDifNO3N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSMN4 * (oNO3SMN4 - oNO3WMN4) / aDepthDifMN4 ELSE 0.0 ENDIF;
tNDifNH4MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kNDifNH4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSMN4 * (oNH4SMN4 - oNH4WMN4) / aDepthDifMN4 ELSE 0.0 ENDIF;
tO2DifMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kO2DifN4 / aDepthDifMN4 * uFunTmDifN4 * cTurbDifO2N4 * bPorCorSMN4 * oO2WMN4 ELSE 0.0 ENDIF;
tPDifGroundPO4MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNO3MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN 0.0 ELSE 0.0 ENDIF;
tNDifGroundNH4MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN 0.0 ELSE 0.0 ENDIF;
aPAdsMaxWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cRelPAdsDN4 + aCorO2BODMN4 * cRelPAdsFeN4 * fFeDIMN4 + cRelPAdsAlN4 * fAlDIMN4 ELSE 0.0 ENDIF;
aKPAdsWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN(1.0 - fRedMaxN4 *(1.0-aCorO2BODMN4)) * cKPAdsOxN4 ELSE 0.0 ENDIF;
aPIsoAdsWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPAdsMaxWMN4 * aKPAdsWMN4 * oPO4WMN4 /(1.0 + aKPAdsWMN4 * oPO4WMN4) ELSE 0.0 ENDIF;
aPEqIMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPIsoAdsWMN4 * oDIMWMN4 ELSE 0.0 ENDIF;
wPSorpIMWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kPSorpN4 *(aPEqIMWMN4 - oPAIMWMN4) ELSE 0.0 ENDIF;
aPAdsMaxSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cRelPAdsDN4 + afOxySedMN4 * cRelPAdsFeN4 * fFeDIMN4 + cRelPAdsAlN4 * fAlDIMN4 ELSE 0.0 ENDIF;
aKPAdsSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN(1.0 - fRedMaxN4 *(1.0-afOxySedMN4)) * cKPAdsOxN4 ELSE 0.0 ENDIF;
aPIsoAdsSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPAdsMaxSMN4 * aKPAdsSMN4 * oPO4SMN4 /(1.0 + aKPAdsSMN4 * oPO4SMN4) ELSE 0.0 ENDIF;
aPEqIMSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPIsoAdsSMN4 * aDIMSMN4 ELSE 0.0 ENDIF;
tPSorpIMSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kPSorpN4 *(aPEqIMSMN4 - aPAIMSMN4) ELSE 0.0 ENDIF;
tPChemPO4MN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN MAX(0.0,kPChemPO4N4 *(oPO4SMN4 - coPO4MaxN4)) ELSE 0.0 ENDIF;
aDRootVegN4 = bfRootVegN4 * aDVegN4;
bfSubVegEpiN4 = bfSubVegN4 * ( uVegHeightEpiN4 / uDepthWN4 );
bfSubVegHypN4 = bfSubVegN4 * ( uVegHeightHypN4 / uDepthWN4 );
afCovSurfVegN4 = MIN(1.0, MAX(aDFloatVegN4 / (cDLayerVegN4 + NearZeroN4), aDEmergVegN4 / (fEmergVegN4 * cDCarrVegN4 + NearZeroN4) ) ) ;
afCovEmergVegN4 = MIN(1.0, PerCentN4 * cCovSpVegN4 * aDEmergVegN4);
aCovVegN4 = MIN(100.0, cCovSpVegN4 * aDShootVegN4);
aLPARBotHypN4 = uLPARSurfHypN4 * EXP(- aExtCoefHypN4 * uDepthWHypN4);
rPDVegN4 = aPVegN4 / (aDVegN4+NearZeroN4);
rNDVegN4 = aNVegN4 / (aDVegN4+NearZeroN4);
tDMigrVegN4 = kMigrVegN4 * (cDVegInN4 - aDVegN4);
tPMigrVegN4 = kMigrVegN4 * (cPDVeg0N4* cDVegInN4 - aPVegN4);
tNMigrVegN4 = kMigrVegN4 * (cNDVeg0N4* cDVegInN4 - aNVegN4);
uFunTmRespVegN4 = IF ( UseExpVegN4 GT NearZeroN4 ) THEN uFunTmVegN4 ELSE POW(cQ10RespVegN4 , (0.1 * (uTmVegAveN4 - cTmRefN4))) ENDIF;
afPUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN 0.0 ELSEIF (bfRootVegN4 LE NearZeroN4) THEN 0.0 ELSEIF (fFloatVegN4 + bfSubVegN4 LE NearZeroN4) THEN 1.0 ELSEIF (aInclStratN4 EQ TRUE AND ((oPO4SN4+NearZeroN4) / (oPO4WHypN4+NearZeroN4)) GT NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(((oPO4SN4+NearZeroN4) / (oPO4WHypN4+NearZeroN4)) , fSedUptVegExpN4)) ELSEIF (aInclStratN4 EQ TRUE AND ((oPO4SN4+NearZeroN4) / (oPO4WHypN4+NearZeroN4)) LE NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW( NearZeroN4 , fSedUptVegExpN4)) ELSEIF (((oPO4SN4+NearZeroN4) / (oPO4WEpiN4+NearZeroN4)) LE NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW (NearZeroN4 , fSedUptVegExpN4)) ELSE fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(((oPO4SN4+NearZeroN4) / (oPO4WEpiN4+NearZeroN4)) , fSedUptVegExpN4)) ENDIF;
afNUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN 0.0 ELSEIF (bfRootVegN4 LE NearZeroN4) THEN 0.0 ELSEIF (fFloatVegN4 + bfSubVegN4 LE NearZeroN4) THEN 1.0 ELSEIF ( aInclStratN4 EQ TRUE AND ((oNDissSN4+NearZeroN4) / (oNDissWHypN4+NearZeroN4)) GT NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(((oNDissSN4+NearZeroN4) / (oNDissWHypN4+NearZeroN4)) , fSedUptVegExpN4)) ELSEIF ( aInclStratN4 EQ TRUE AND ((oNDissSN4+NearZeroN4) / (oNDissWHypN4+NearZeroN4)) LE NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(NearZeroN4 , fSedUptVegExpN4)) ELSEIF ( ((oNDissSN4+NearZeroN4) / (oNDissWEpiN4+NearZeroN4)) LE NearZeroN4 ) THEN fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(NearZeroN4 , fSedUptVegExpN4)) ELSE fSedUptVegMaxN4 / (1.0 + fSedUptVegCoefN4 * POW(((oNDissSN4+NearZeroN4) / (oNDissWEpiN4+NearZeroN4)) , fSedUptVegExpN4)) ENDIF;
aVPUptMaxCrVegN4 = IF (FALSE EQ UseEmpUptN4) THEN MAX( 0.0, cVPUptMaxVegN4 * uFunTmProdVegN4 * (cPDVegMaxN4-rPDVegN4) / (cPDVegMaxN4-cPDVegMinN4) ) ELSE MAX( 0.0, cVPUptMaxVegN4 * uFunTmProdVegN4 * (cPDVegMaxN4-rPDVegN4) / (cPDVegMaxN4-cPDVegMinN4) ) ENDIF;
aVPUptVegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN oPO4WHypN4 * aVPUptMaxCrVegN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4WHypN4) ELSE 0.0 ENDIF;
aVPUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN oPO4SN4 * aVPUptMaxCrVegN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4SN4) ELSE 0.0 ENDIF;
aVPUptVegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN oPO4WEpiN4 * aVPUptMaxCrVegN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4WEpiN4) ELSE 0.0 ENDIF;
tPUptVegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN aVPUptVegWEpiN4 * (aDSubVegN4 + aDFloatVegN4) ELSE (1.0 - afPUptVegSN4) * aVPUptMaxCrVegN4 * oPO4WEpiN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4WEpiN4) * uDVegEpiN4 ENDIF;
tPUptVegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN aVPUptVegWHypN4 * (aDSubVegN4 + aDFloatVegN4) ELSE (1.0 - afPUptVegSN4) * aVPUptMaxCrVegN4 * oPO4WHypN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4WHypN4) * uDVegHypN4 ENDIF;
tPUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN aVPUptVegSN4 * aDRootVegN4 ELSE afPUptVegSN4 * aVPUptMaxCrVegN4 * oPO4SN4 / (aVPUptMaxCrVegN4 / cAffPUptVegN4 + oPO4SN4) * aDVegN4 ENDIF;
tPUptVegEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN tPUptVegWEpiN4 + tPUptVegSN4 * uDVegEpiN4 / aDVegN4 ELSEIF (aInclStratN4 EQ FALSE AND FALSE EQ UseEmpUptN4) THEN tPUptVegWEpiN4 + tPUptVegSN4 ELSE tPUptVegWEpiN4 + tPUptVegSN4 ENDIF;
tPUptVegHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN4) THEN tPUptVegWHypN4 + tPUptVegSN4 * uDVegHypN4 / aDVegN4 ELSE tPUptVegWHypN4 + tPUptVegSN4 * uDVegHypN4 / aDVegN4 ENDIF ;
aVNUptMaxCrVegN4 = IF (FALSE EQ UseEmpUptN4) THEN MAX( 0.0, cVNUptMaxVegN4 * uFunTmProdVegN4 * (cNDVegMaxN4 - rNDVegN4) / (cNDVegMaxN4 - cNDVegMinN4)) ELSE MAX( 0.0, cVNUptMaxVegN4 * uFunTmProdVegN4 * (cNDVegMaxN4 - rNDVegN4) / (cNDVegMaxN4 - cNDVegMinN4)) ENDIF;
ahNUptVegN4 = IF (FALSE EQ UseEmpUptN4) THEN aVNUptMaxCrVegN4 / cAffNUptVegN4 ELSE aVNUptMaxCrVegN4 / cAffNUptVegN4 ENDIF;
aVNUptVegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN oNDissWEpiN4 * aVNUptMaxCrVegN4 / (ahNUptVegN4 + oNDissWEpiN4) ELSE 0.0 ENDIF;
aVNUptVegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN oNDissWHypN4 * aVNUptMaxCrVegN4 / (ahNUptVegN4 + oNDissWHypN4) ELSE 0.0 ENDIF;
afNH4UptVegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN oNH4WEpiN4 * oNO3WEpiN4 / ((ahNUptVegN4 + oNH4WEpiN4) * (ahNUptVegN4 + oNO3WEpiN4 + NearZeroN4)) + oNH4WEpiN4 * ahNUptVegN4 / ((oNH4WEpiN4 + oNO3WEpiN4 + NearZeroN4) * (ahNUptVegN4 + oNO3WEpiN4 + NearZeroN4)) ELSE oNH4WEpiN4 * oNO3WEpiN4 / ((ahNUptVegN4 + oNH4WEpiN4) * (ahNUptVegN4 + oNO3WEpiN4 + NearZeroN4)) + oNH4WEpiN4 * ahNUptVegN4 / ((oNH4WEpiN4 + oNO3WEpiN4 + NearZeroN4) * (ahNUptVegN4 + oNO3WEpiN4 + NearZeroN4)) ENDIF;
afNH4UptVegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN oNH4WHypN4 * oNO3WHypN4 / ((ahNUptVegN4 + oNH4WHypN4) * (ahNUptVegN4 + oNO3WHypN4 + NearZeroN4)) + oNH4WHypN4 * ahNUptVegN4 / ((oNH4WHypN4 + oNO3WHypN4 + NearZeroN4) * (ahNUptVegN4 + oNO3WHypN4 + NearZeroN4)) ELSE oNH4WHypN4 * oNO3WHypN4 / ((ahNUptVegN4 + oNH4WHypN4) * (ahNUptVegN4 + oNO3WHypN4 + NearZeroN4)) + oNH4WHypN4 * ahNUptVegN4 / ((oNH4WHypN4 + oNO3WHypN4 + NearZeroN4) * (ahNUptVegN4 + oNO3WHypN4 + NearZeroN4)) ENDIF;
tNUptVegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN aVNUptVegWEpiN4 * (aDSubVegN4 + aDFloatVegN4) ELSE (1.0 - afNUptVegSN4) * aVNUptMaxCrVegN4 * oNDissWEpiN4 / (aVNUptMaxCrVegN4 / cAffNUptVegN4 + oNDissWEpiN4) * uDVegEpiN4 ENDIF;
tNUptVegWHypN4 = IF (FALSE EQ aInclStratN4) THEN 0.0 ELSEIF (FALSE EQ UseEmpUptN4) THEN aVNUptVegWHypN4 * (aDSubVegN4 + aDFloatVegN4) ELSE (1.0 - afNUptVegSN4) * aVNUptMaxCrVegN4 * oNDissWHypN4 / (aVNUptMaxCrVegN4 / cAffNUptVegN4 + oNDissWHypN4) * uDVegHypN4 ENDIF;
tNUptNH4VegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN afNH4UptVegWEpiN4 * tNUptVegWEpiN4 ELSE afNH4UptVegWEpiN4 * tNUptVegWEpiN4 ENDIF;
tNUptNO3VegWEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN tNUptVegWEpiN4 - tNUptNH4VegWEpiN4 ELSE tNUptVegWEpiN4 - tNUptNH4VegWEpiN4 ENDIF;
tNUptNH4VegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN afNH4UptVegWHypN4 * tNUptVegWHypN4 ELSE afNH4UptVegWHypN4 * tNUptVegWHypN4 ENDIF;
tNUptNO3VegWHypN4 = IF (FALSE EQ UseEmpUptN4) THEN tNUptVegWHypN4 - tNUptNH4VegWHypN4 ELSE tNUptVegWHypN4 - tNUptNH4VegWHypN4 ENDIF;
aVNUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN oNDissSN4 * aVNUptMaxCrVegN4 / (ahNUptVegN4 + oNDissSN4) ELSE 0.0 ENDIF;
tNUptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN aVNUptVegSN4 * aDRootVegN4 ELSE afNUptVegSN4 * aVNUptMaxCrVegN4 * oNDissSN4 / (aVNUptMaxCrVegN4 / cAffNUptVegN4 + oNDissSN4) * aDVegN4 ENDIF;
afNH4UptVegSN4 = IF (FALSE EQ UseEmpUptN4) THEN oNH4SN4 * oNO3SN4 / ((ahNUptVegN4 + oNH4SN4 +NearZeroN4) * (ahNUptVegN4 + oNO3SN4 +NearZeroN4)) + oNH4SN4 * ahNUptVegN4 / ((oNH4SN4 + oNO3SN4+NearZeroN4) * (ahNUptVegN4 + oNO3SN4+NearZeroN4)) ELSE oNH4SN4 * oNO3SN4 / ((ahNUptVegN4 + oNH4SN4 +NearZeroN4) * (ahNUptVegN4 + oNO3SN4 +NearZeroN4)) + oNH4SN4 * ahNUptVegN4 / ((oNH4SN4 + oNO3SN4+NearZeroN4) * (ahNUptVegN4 + oNO3SN4+NearZeroN4)) ENDIF;
tNUptNH4VegSN4 = IF (FALSE EQ UseEmpUptN4) THEN afNH4UptVegSN4 * tNUptVegSN4 ELSE afNH4UptVegSN4 * tNUptVegSN4 ENDIF;
tNUptVegSEpiN4 = IF (FALSE EQ UseEmpUptN4) THEN aVNUptVegSN4 * aDRootVegN4 ELSE afNUptVegSN4 * aVNUptMaxCrVegN4 * oNDissSN4 / (aVNUptMaxCrVegN4 / cAffNUptVegN4 + oNDissSN4) * aDVegN4 ENDIF;
tNUptNO3VegSN4 = IF (FALSE EQ UseEmpUptN4) THEN tNUptVegSN4 - tNUptNH4VegSN4 ELSE tNUptVegSN4 - tNUptNH4VegSN4 ENDIF;
tNUptVegN4 =tNUptVegWEpiN4 + tNUptVegWHypN4 + tNUptVegSN4;
aLLimShootVegEpiN4 = fEmergVegN4 + fFloatVegN4 * (1.0 - afCovEmergVegN4) + bfSubVegEpiN4 * (1.0 - afCovSurfVegN4) * 1.0 / (aExtCoefEpiN4 * uDepthWEpiN4) * LN( (1.0 + aLPAR1VegEpiN4 / uhLVegN4) / (1.0 + aLPAR2VegEpiN4 / uhLVegN4));
aLLimShootVegHypN4 = fEmergVegN4 + fFloatVegN4 * (1.0 - afCovEmergVegN4) + bfSubVegHypN4 * (1.0 - afCovSurfVegN4) * 1.0 / (aExtCoefHypN4 * uDepthWHypN4) * LN( (1.0 + aLPAR1VegHypN4 / uhLVegN4) / (1.0 + aLPAR2VegHypN4 / uhLVegN4));
aMuTmLVegHypN4 = ufDayN4 * bfShootVegN4 * aLLimShootVegHypN4 * uFunTmProdVegN4 * cMuMaxVegN4;
aPLimVegN4 = MAX(0.0, (1.0 - cPDVegMinN4 / rPDVegN4) * cPDVegMaxN4 / (cPDVegMaxN4 - cPDVegMinN4) );
aNLimVegN4 = MAX(0.0, (1.0 - cNDVegMinN4 / rNDVegN4) * cNDVegMaxN4 / (cNDVegMaxN4 - cNDVegMinN4) );
aNutLimVegN4 = MIN( aPLimVegN4, aNLimVegN4);
aMuVegHypN4 = aMuTmLVegHypN4 * aNutLimVegN4;
bkMortVegN4 = IF (FALSE EQ InclSeasonN4) THEN kMortVegSumN4 ELSEIF (aVegWinN4 EQ TRUE AND aDaysVegWinN4 LE cLengMortN4 AND aDaysVegWinN4 GT 0) THEN - LN(fWinVegN4) / cLengMortN4 ELSE kMortVegSumN4 ENDIF;
akDIncrVegHypN4 = aMuTmLVegHypN4 - kDRespVegN4 * uFunTmRespVegN4 - bkMortVegN4;
tDEnvVegHypN4 = MAX(0.0, akDIncrVegHypN4 / (cDCarrVegN4+NearZeroN4) * aDVegN4*aDVegN4);
tDEnvProdVegHypN4 = aMuVegHypN4 / cMuMaxVegN4 * tDEnvVegHypN4;
tDProdVegHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE MAX(0.0, aMuVegHypN4 * uDVegHypN4 - tDEnvProdVegHypN4) ENDIF;
tDProdSubVegHypN4 = bfSubVegHypN4 * tDProdVegHypN4;
tDRespVegN4 = kDRespVegN4 * uFunTmRespVegN4 * aDVegN4;
tDEnvMortVegHypN4 = tDEnvVegHypN4 - tDEnvProdVegHypN4;
tDMortVegHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE bkMortVegN4 * uDVegHypN4 + tDEnvMortVegHypN4 ENDIF;
tDMortVegWHypN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tDMortVegHypN4;
tDGrazVegBirdN4 = IF ( (sTimeN4 GE cYearStartBirdsN4 * DaysPerYearN4) AND (DayN4 GE cDayStartBirdsN4) AND (DayN4 LE cDayEndBirdsN4) ) THEN cPrefVegBirdN4 * aDVegN4 / (hDVegBirdN4 + aDVegN4) * cBirdsPerhaN4 / m2PerhaN4 * cDGrazPerBirdN4 ELSE 0.0 ENDIF;
bkManVegN4 = IF ((DayN4 GE cDayManVeg1N4 AND DayN4 LT cDayManVeg1N4 + cLengManN4) OR (DayN4 GE cDayManVeg2N4 AND DayN4 LT cDayManVeg2N4 + cLengManN4)) THEN -LN(1.0 - fManVegN4) / cLengManN4 ELSE 0.0 ENDIF;
tDManVegN4 = bkManVegN4 * aDVegN4;
tPManVegN4 = rPDVegN4 * tDManVegN4;
tNManVegN4 = rNDVegN4 * tDManVegN4;
tO2ProdVegHypN4 = molO2molCN4 * cCPerDWN4 * tDProdVegHypN4;
tO2RespVegWHypN4 = molO2molCN4 * cCPerDWN4 * bfSubVegHypN4 * tDRespVegN4 * aCorO2BODHypN4;
aDepthOxySedN4 = IF(aInclStratN4 EQ TRUE AND (2.0 * oO2WHypN4 * akO2DifCorN4 / tSODN4) GT NearZeroN4 ) THEN POW((2.0 * oO2WHypN4 * akO2DifCorN4 / tSODN4) , (0.5)) ELSEIF ( aInclStratN4 EQ TRUE AND (2.0 * oO2WHypN4 * akO2DifCorN4 / tSODN4) LE NearZeroN4 ) THEN POW ( NearZeroN4 , (0.5)) ELSEIF ( aInclStratN4 EQ TRUE AND ( 2.0 * oO2WEpiN4 * akO2DifCorN4 / tSODN4 ) LE NearZeroN4 ) THEN POW ( NearZeroN4 , (0.5)) ELSE POW ( ( 2.0 * oO2WEpiN4 * akO2DifCorN4 / tSODN4 ) , (0.5)) ENDIF;
afOxySedN4 = aDepthOxySedN4 / cDepthSN4;
tO2RespVegSN4 = molO2molCN4 * cCPerDWN4 * bfRootVegN4 * tDRespVegN4 * afOxySedN4;
tO2ProdVegSHypN4 = MIN (tO2RespVegSN4, tO2ProdVegHypN4);
tO2ProdVegWHypN4 = MIN( tO2ProdVegHypN4 - tO2ProdVegSHypN4, bfSubVegN4 * tO2ProdVegHypN4);
tO2UptNO3VegWHypN4 = O2PerNO3N4 * molO2molNN4 * bfSubVegN4 * tNUptNO3VegWHypN4;
tO2UptNO3VegSN4 = O2PerNO3N4 * molO2molNN4 * tNUptNO3VegSN4;
tPExcrVegN4 = (rPDVegN4 *2.0)/ (cPDVegMaxN4 + rPDVegN4) * rPDVegN4 * tDRespVegN4;
tPExcrVegSN4 = bfRootVegN4 * tPExcrVegN4;
tPExcrVegWN4 = tPExcrVegN4 - tPExcrVegSN4;
tPMortVegHypN4 = rPDVegN4 * tDMortVegHypN4;
tPMortVegPO4HypN4 = fDissMortVegN4 * tPMortVegHypN4;
tPMortVegPO4SHypN4 = bfRootVegN4 * tPMortVegPO4HypN4;
tPMortVegPO4WHypN4 = tPMortVegPO4HypN4 - tPMortVegPO4SHypN4;
tPMortVegDetHypN4 = tPMortVegHypN4 - tPMortVegPO4HypN4;
tPMortVegDetWHypN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tPMortVegDetHypN4;
tPMortVegDetSHypN4 = tPMortVegDetHypN4 - tPMortVegDetWHypN4;
tPGrazVegBirdN4 = rPDVegN4 * tDGrazVegBirdN4;
tNExcrVegN4 = (2.0 * rNDVegN4) / (cNDVegMaxN4 + rNDVegN4) * rNDVegN4 * tDRespVegN4;
tNExcrVegSN4 = bfRootVegN4 * tNExcrVegN4;
tNExcrVegWN4 = tNExcrVegN4 - tNExcrVegSN4;
tNMortVegHypN4 = rNDVegN4 * tDMortVegHypN4;
tNMortVegNH4HypN4 = fDissMortVegN4 * tNMortVegHypN4;
tNMortVegNH4SHypN4 = IF (aInclStratN4 EQ TRUE ) THEN bfRootVegN4 * tNMortVegNH4HypN4 ELSE 0.0 ENDIF;
tNMortVegNH4WHypN4 = tNMortVegNH4HypN4 - tNMortVegNH4SHypN4;
tNMortVegDetHypN4 = tNMortVegHypN4 - tNMortVegNH4HypN4;
tNMortVegDetWHypN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tNMortVegDetHypN4;
tNMortVegDetSHypN4 = tNMortVegDetHypN4 - tNMortVegDetWHypN4;
tNGrazVegBirdN4 = rNDVegN4 * tDGrazVegBirdN4;
tDAssVegBirdN4 = fDAssBirdN4 * tDGrazVegBirdN4;
tDEgesBirdN4 = tDGrazVegBirdN4 - tDAssVegBirdN4;
tPAssVegBirdN4 = fDAssBirdN4 * tPGrazVegBirdN4;
tPEgesBirdN4 = tPGrazVegBirdN4 - tPAssVegBirdN4;
tPEgesBirdPO4N4 = fDissEgesBirdN4 * tPEgesBirdN4;
tPEgesBirdDetN4 = tPEgesBirdN4 - tPEgesBirdPO4N4;
tNAssVegBirdN4 = fDAssBirdN4 * tNGrazVegBirdN4;
tNEgesBirdN4 = tNGrazVegBirdN4 - tNAssVegBirdN4;
tNEgesBirdNH4N4 = fDissEgesBirdN4 * tNEgesBirdN4;
tNEgesBirdDetN4 = tNEgesBirdN4 - tNEgesBirdNH4N4;
wDBedDetWHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE) THEN (tDMortVegWHypN4) / uDepthWHypN4 ELSE 0.0 ENDIF;
aMuTmLVegEpiN4 = ufDayN4 * bfShootVegN4 * aLLimShootVegEpiN4 * uFunTmProdVegN4 * cMuMaxVegN4;
akDIncrVegEpiN4 = aMuTmLVegEpiN4 - kDRespVegN4 * uFunTmRespVegN4 - bkMortVegN4;
tDEnvVegEpiN4 = MAX(0.0, akDIncrVegEpiN4 / (cDCarrVegN4+NearZeroN4) * aDVegN4*aDVegN4);
aMuVegEpiN4 = aMuTmLVegEpiN4 * aNutLimVegN4;
tDEnvProdVegEpiN4 = aMuVegEpiN4 / cMuMaxVegN4 * tDEnvVegEpiN4;
tDProdVegEpiN4 = MAX(0.0, aMuVegEpiN4 * uDVegEpiN4 - tDEnvProdVegEpiN4);
tDEnvMortVegEpiN4 = tDEnvVegEpiN4 - tDEnvProdVegEpiN4;
tDMortVegEpiN4 = bkMortVegN4 * uDVegEpiN4 + tDEnvMortVegEpiN4;
tNMortVegEpiN4 = rNDVegN4 * tDMortVegEpiN4;
tNMortVegNH4EpiN4 = fDissMortVegN4 * tNMortVegEpiN4;
tNMortVegNH4SEpiN4 = bfRootVegN4 * tNMortVegNH4EpiN4;
wPBedPO4WHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE ) THEN (- tPUptVegWHypN4 + tPExcrVegWN4 * uVegHeightHypN4 / uVegHeightN4 + tPMortVegPO4WHypN4 ) /uDepthWHypN4 ELSE 0.0 ENDIF;
wPBedDetWHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE) THEN (tPMortVegDetWHypN4 ) / uDepthWHypN4 ELSE 0.0 ENDIF;
wNBedNH4WHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE ) THEN (- tNUptNH4VegWHypN4 + tNExcrVegWN4 * (uVegHeightHypN4 /uVegHeightN4 ) + tNMortVegNH4WHypN4 ) / uDepthWHypN4 ELSE 0.0 ENDIF;
wNBedNO3WHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE) THEN - tNUptNO3VegWHypN4 / uDepthWHypN4 ELSE 0.0 ENDIF;
wNBedDetWHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE) THEN (tNMortVegDetWHypN4 ) / uDepthWHypN4 ELSE 0.0 ENDIF;
tDMortVegSHypN4 = tDMortVegHypN4 - tDMortVegWHypN4;
tDBedDetSHypN4 = IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE ) THEN tDMortVegSHypN4 ELSE 0.0 ENDIF;
tO2BedWHypN4 =IF (aInclStratN4 EQ TRUE AND InclVegN4 EQ TRUE ) THEN tO2ProdVegWHypN4 - tO2RespVegWHypN4 + tO2UptNO3VegWHypN4 ELSE 0.0 ENDIF;
UseLossN4 = IF (InclWebN4 EQ TRUE) THEN 0.0 ELSE 1.0 ENDIF;
uFunTmLossHypN4 = EXP(-0.5/(cSigTmLossN4*cSigTmLossN4) *((uTmHypN4-cTmOptLossN4)*(uTmHypN4-cTmOptLossN4) -(cTmRefN4-cTmOptLossN4)*(cTmRefN4-cTmOptLossN4)));
uFunTmLossEpiN4 = EXP(-0.5/(cSigTmLossN4*cSigTmLossN4) *((uTmEpiN4-cTmOptLossN4)*(uTmEpiN4-cTmOptLossN4) -(cTmRefN4-cTmOptLossN4)*(cTmRefN4-cTmOptLossN4)));
rPDBlueWHypN4 = oPBlueWHypN4 /(oDBlueWHypN4+NearZeroN4);
rNDBlueWHypN4 = oNBlueWHypN4 /(oDBlueWHypN4+NearZeroN4);
rPDBlueSN4 = aPBlueSN4 /(aDBlueSN4+NearZeroN4);
rNDBlueSN4 = aNBlueSN4 /(aDBlueSN4+NearZeroN4);
uFunTmBlueHypN4 = EXP(-0.5/(cSigTmBlueN4*cSigTmBlueN4) *((uTmHypN4-cTmOptBlueN4)*(uTmHypN4-cTmOptBlueN4) - (cTmRefN4-cTmOptBlueN4)*(cTmRefN4-cTmOptBlueN4)));
uFunTmProdBlueHypN4 = uFunTmBlueHypN4;
uFunTmRespBlueHypN4 = uFunTmBlueHypN4;
uFunTmBlueEpiN4 = EXP(-0.5/(cSigTmBlueN4*cSigTmBlueN4) *((uTmEpiN4-cTmOptBlueN4)*(uTmEpiN4-cTmOptBlueN4) - (cTmRefN4-cTmOptBlueN4)*(cTmRefN4-cTmOptBlueN4)));
uFunTmProdBlueEpiN4 = uFunTmBlueEpiN4;
uFunTmRespBlueEpiN4 = uFunTmBlueEpiN4;
uFunTmBlueSN4 = EXP(-0.5/(cSigTmBlueN4*cSigTmBlueN4) *((uTmBotN4-cTmOptBlueN4)*(uTmBotN4-cTmOptBlueN4) - (cTmRefN4-cTmOptBlueN4)*(cTmRefN4-cTmOptBlueN4)));
uFunTmRespBlueSN4 = uFunTmBlueSN4;
uFunTmBlueSurfN4 = EXP(-0.5/(cSigTmBlueN4*cSigTmBlueN4) *((uTmSurfN4-cTmOptBlueN4)*(uTmSurfN4-cTmOptBlueN4) - (cTmRefN4-cTmOptBlueN4)*(cTmRefN4-cTmOptBlueN4)));
uFunTmProdBlueSurfN4 = uFunTmBlueSurfN4;
uFunTmRespBlueSurfN4 = uFunTmBlueSurfN4;
aLPARAveSurfN4 = MAX(0.0,(uLPARSurfN4 - aLPARBotSurfN4)/aExtSurfN4);
aLPARAveEpiN4 = (aLPARBotSurfN4 - aLPARBotEpiN4)/ (aExtCoefOpenEpiN4 * uDepthWEpiN4);
aLPARAveHypN4 = (aLPARBotEpiOpenN4 -aLPARBotHypN4)/ (aExtCoefOpenHypN4 * uDepthWEpiN4);
aAuxNfixLSurfN4 = cAlphNfixN4 * aLPARAveSurfN4 ;
aAuxNfixLEpiN4 = cAlphNfixN4 * aLPARAveEpiN4;
aAuxNfixLHypN4 = cAlphNfixN4 * aLPARAveHypN4;
rNfixBlueSurfN4 = cNfixMaxBlueN4 - cNfixMaxBlueN4 * EXP(- aAuxNfixLSurfN4) + cNfixDarkBlueN4;
rNfixBlueEpiN4 = cNfixMaxBlueN4 - cNfixMaxBlueN4 * EXP(- aAuxNfixLEpiN4) + cNfixDarkBlueN4;
rNfixBlueHypN4 = cNfixMaxBlueN4 - cNfixMaxBlueN4 * EXP(- aAuxNfixLHypN4) + cNfixDarkBlueN4;
aVPUptMaxCrBlueHypN4 = MAX(0.0,cVPUptMaxBlueN4 * uFunTmProdBlueHypN4 *(cPDBlueMaxN4 - rPDBlueWHypN4) /(cPDBlueMaxN4 - cPDBlueMinN4));
aVPUptBlueHypN4 = oPO4WHypN4 * aVPUptMaxCrBlueHypN4 /(aVPUptMaxCrBlueHypN4 / cAffPUptBlueN4 + oPO4WHypN4);
wPUptBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVPUptBlueHypN4 * oDBlueWHypN4 ENDIF;
aVNUptMaxCrBlueHypN4 = MAX(0.0,cVNUptMaxBlueN4 * uFunTmProdBlueHypN4 * (cNDBlueMaxN4 - rNDBlueWHypN4) /(cNDBlueMaxN4 - cNDBlueMinN4));
ahNUptBlueHypN4 = aVNUptMaxCrBlueHypN4 / cAffNUptBlueN4;
aVNUptBlueHypN4 = oNDissWHypN4 * aVNUptMaxCrBlueHypN4 /(ahNUptBlueHypN4 + oNDissWHypN4);
wNUptBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVNUptBlueHypN4 * oDBlueWHypN4 ENDIF;
tNUptBlueHypN4 = wNUptBlueHypN4 * uDepthWHypN4;
afNH4UptBlueHypN4 = oNH4WHypN4 * oNO3WHypN4 /((ahNUptBlueHypN4 + oNH4WHypN4) *(ahNUptBlueHypN4 + oNO3WHypN4)) + oNH4WHypN4 * ahNUptBlueHypN4 /((oNH4WHypN4 + oNO3WHypN4) *(ahNUptBlueHypN4 + oNO3WHypN4));
uMuMaxTmBlueHypN4 = cMuMaxBlueN4 * uFunTmProdBlueHypN4;
uMuMaxTmBlueEpiN4 = cMuMaxBlueN4 * uFunTmProdBlueEpiN4;
aPLimBlueHypN4 = MAX(0.0,(1.0 - cPDBlueMinN4 / rPDBlueWHypN4) * cPDBlueMaxN4 /(cPDBlueMaxN4 - cPDBlueMinN4));
aNLimBlueHypN4 = MAX(0.0,(1.0 - cNDBlueMinN4 / rNDBlueWHypN4) * cNDBlueMaxN4 /(cNDBlueMaxN4 - cNDBlueMinN4));
aSiLimBlueHypN4 = oSiO2WHypN4 /(hSiAssBlueN4 + oSiO2WHypN4);
aLLimBlueHypN4 = UseSteeleBlueN4 *(EXP(1.0) /(aExtCoefHypN4 * uDepthWHypN4) *(EXP(- aLPARBotHypN4 /(cLOptRefBlueN4 * uFunTmProdBlueHypN4)) - EXP(- uLPARSurfHypN4 /(cLOptRefBlueN4 * uFunTmProdBlueHypN4)))) +(1.0 - UseSteeleBlueN4) *(1.0 /(aExtCoefHypN4 * uDepthWHypN4) * LN((1.0 + uLPARSurfHypN4 / (hLRefBlueN4 * uFunTmProdBlueHypN4)) / (1.0 + aLPARBotHypN4 /(hLRefBlueN4 * uFunTmProdBlueHypN4))));
aMuTmLBlueHypN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimBlueHypN4 * uMuMaxTmBlueHypN4;
aNutLimBlueHypN4 = MIN(aPLimBlueHypN4,(MIN(aNLimBlueHypN4,aSiLimBlueHypN4)));
aMuBlueHypN4 = aNutLimBlueHypN4 * aMuTmLBlueHypN4;
wDAssBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aMuBlueHypN4*oDBlueWHypN4 ENDIF;
rChDBlueHypN4 = cChDBlueMaxN4 -(cChDBlueMaxN4 - cChDBlueMinN4) * aLLimBlueHypN4;
oChlaBlueHypN4 = mgPergN4 * rChDBlueHypN4 * oDBlueWHypN4;
aChlaBlueHypN4 = mgPergN4 * rChDBlueHypN4 * aDBlueWHypN4;
aExtChBlueHypN4 = cExtSpBlueN4 / rChDBlueHypN4;
aNfixBlueHypN4  = rNfixBlueHypN4 *aChlaBlueHypN4 /ugPergN4;
tNUptBlueAirHypN4 = IF (InclNfixN4 EQ FALSE) THEN 0.0 ELSE aNfixBlueHypN4 ENDIF;
tNUptBlueWHypN4 = IF (InclNfixN4 EQ FALSE) THEN tNUptBlueHypN4 ELSE tNUptBlueHypN4 - tNUptBlueAirHypN4 ENDIF;
wNUptBlueWHypN4 = tNUptBlueWHypN4 / uDepthWHypN4;
ukDRespTmBlueHypN4 = kDRespBlueN4 * uFunTmRespBlueHypN4;
wNUptNH4BlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE afNH4UptBlueHypN4 * wNUptBlueWHypN4 ENDIF;
wNUptNO3BlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptBlueWHypN4 - wNUptNH4BlueHypN4 ENDIF;
ukDRespTmBlueEpiN4 = kDRespBlueN4 * uFunTmRespBlueEpiN4;
ukDRespTmBlueSN4 = kDRespBlueN4 * uFunTmRespBlueSN4;
wDRespBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukDRespTmBlueHypN4 * oDBlueWHypN4 ENDIF;
ukDRespTmBlueSurfN4 = kDRespBlueN4 * uFunTmRespBlueSurfN4;
ukLossTmBlueHypN4 = UseLossN4 * kLossBlueN4 * uFunTmLossHypN4;
ukLossTmBlueEpiN4 = UseLossN4 * kLossBlueN4 * uFunTmLossEpiN4;
wDLossBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukLossTmBlueHypN4 * oDBlueWHypN4 ENDIF;
wDMortBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortBlueWN4 * oDBlueWHypN4 ENDIF;
uCorVSetBlueHypN4 = (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMHypN4 * uFunTmSetHypN4;
tDResusBlueN4 = aDBlueSN4 /(aDPhytSN4+NearZeroN4) * tDResusPhytTotN4;
tDRespBlueSN4 = ukDRespTmBlueSN4 * aDBlueSN4;
tDMortBlueSN4 = kMortBlueSN4 * aDBlueSN4;
ukDDecBlueHypN4 = ukDRespTmBlueHypN4 + ukLossTmBlueHypN4 + kMortBlueWN4 +(uCorVSetBlueHypN4 * uFunTmSetHypN4) / uDepthWHypN4;
wPExcrBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (rPDBlueWHypN4 * 2.0 )/(cPDBlueMaxN4 + rPDBlueWHypN4) * rPDBlueWHypN4 * wDRespBlueWHypN4 ENDIF;
wPLossBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN4 * wDLossBlueHypN4 ENDIF;
wPMortBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortBlueWN4 * oPBlueWHypN4 ENDIF;
tPResusBlueN4 = rPDBlueSN4 * tDResusBlueN4;
tPExcrBlueSN4 = (rPDBlueSN4 *2.0)/(cPDBlueMaxN4 + rPDBlueSN4) * rPDBlueSN4 * tDRespBlueSN4;
tPMortBlueSN4 = kMortBlueSN4 * aPBlueSN4;
wNExcrBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (rNDBlueWHypN4 *2.0)/(cNDBlueMaxN4 + rNDBlueWHypN4) * rNDBlueWHypN4 * wDRespBlueWHypN4 ENDIF;
wNLossBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN4 * wDLossBlueHypN4 ENDIF;
wNMortBlueWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortBlueWN4 * oNBlueWHypN4 ENDIF;
tNResusBlueN4 = rNDBlueSN4 * tDResusBlueN4;
tNExcrBlueSN4 = (2.0 * rNDBlueSN4) /(cNDBlueMaxN4 + rNDBlueSN4) * rNDBlueSN4 * tDRespBlueSN4;
tNMortBlueSN4 = kMortBlueSN4 * aNBlueSN4;
aFunTauSetOMEpiN4 = MIN(1.0 / POW(aFunDimSuspN4 +NearZeroN4 , (0.5)), 1.0);
aFunTauSetIMEpiN4 = aFunTauSetOMEpiN4;
uCorVSetBlueEpiN4 = (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMEpiN4 * uFunTmSetEpiN4;
rNDGrenWHypN4 = oNGrenWHypN4 /(oDGrenWHypN4+NearZeroN4);
rPDGrenSN4 = aPGrenSN4 /(aDGrenSN4+NearZeroN4);
rNDGrenSN4 = aNGrenSN4 /(aDGrenSN4+NearZeroN4);
uFunTmGrenHypN4 = EXP(-0.5/(cSigTmGrenN4*cSigTmGrenN4) *((uTmHypN4-cTmOptGrenN4)*(uTmHypN4-cTmOptGrenN4) - (cTmRefN4-cTmOptGrenN4)*(cTmRefN4-cTmOptGrenN4)));
uFunTmGrenEpiN4 = EXP(-0.5/(cSigTmGrenN4*cSigTmGrenN4) *((uTmEpiN4-cTmOptGrenN4)*(uTmEpiN4-cTmOptGrenN4) - (cTmRefN4-cTmOptGrenN4)*(cTmRefN4-cTmOptGrenN4)));
uFunTmGrenSN4 = EXP(-0.5/(cSigTmGrenN4*cSigTmGrenN4) *((uTmBotN4-cTmOptGrenN4)*(uTmBotN4-cTmOptGrenN4) - (cTmRefN4-cTmOptGrenN4)*(cTmRefN4-cTmOptGrenN4)));
uFunTmProdGrenHypN4 = uFunTmGrenHypN4;
uFunTmRespGrenHypN4 = uFunTmGrenHypN4;
uFunTmProdGrenEpiN4 = uFunTmGrenEpiN4;
uFunTmRespGrenEpiN4 = uFunTmGrenEpiN4;
uFunTmRespGrenSN4 = uFunTmGrenSN4;
aVNUptMaxCrGrenHypN4 = MAX(0.0,cVNUptMaxGrenN4 * uFunTmProdGrenHypN4 * (cNDGrenMaxN4 - rNDGrenWHypN4) /(cNDGrenMaxN4 - cNDGrenMinN4));
ahNUptGrenHypN4 = aVNUptMaxCrGrenHypN4 / cAffNUptGrenN4;
aVNUptGrenHypN4 = oNDissWHypN4 * aVNUptMaxCrGrenHypN4 /(ahNUptGrenHypN4 + oNDissWHypN4);
wNUptGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVNUptGrenHypN4 * oDGrenWHypN4 ENDIF;
afNH4UptGrenHypN4 = oNH4WHypN4 * oNO3WHypN4 /((ahNUptGrenHypN4 + oNH4WHypN4) *(ahNUptGrenHypN4 + oNO3WHypN4)) + oNH4WHypN4 * ahNUptGrenHypN4 /((oNH4WHypN4 + oNO3WHypN4) *(ahNUptGrenHypN4 + oNO3WHypN4));
wNUptNH4GrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE afNH4UptGrenHypN4 * wNUptGrenHypN4 ENDIF;
wNUptNO3GrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN4 - wNUptNH4GrenHypN4 ENDIF;
uMuMaxTmGrenHypN4 = cMuMaxGrenN4 * uFunTmProdGrenHypN4;
uMuMaxTmGrenEpiN4 = cMuMaxGrenN4 * uFunTmProdGrenEpiN4;
aNLimGrenHypN4 = MAX(0.0,(1.0 - cNDGrenMinN4 / rNDGrenWHypN4) * cNDGrenMaxN4 /(cNDGrenMaxN4 - cNDGrenMinN4));
aSiLimGrenHypN4 = oSiO2WHypN4 /(hSiAssGrenN4 + oSiO2WHypN4);
aLLimGrenHypN4 = UseSteeleGrenN4 *(EXP(1.0) /(aExtCoefHypN4 * uDepthWHypN4) *(EXP(- aLPARBotHypN4 /(cLOptRefGrenN4 * uFunTmProdGrenHypN4)) - EXP(- uLPARSurfHypN4 /(cLOptRefGrenN4 * uFunTmProdGrenHypN4)))) +(1.0 - UseSteeleGrenN4) *(1.0 /(aExtCoefHypN4 * uDepthWHypN4) * LN((1.0 + uLPARSurfHypN4 / (hLRefGrenN4 * uFunTmProdGrenHypN4)) / (1.0 + aLPARBotHypN4 /(hLRefGrenN4 * uFunTmProdGrenHypN4))));
aMuTmLGrenHypN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimGrenHypN4 * uMuMaxTmGrenHypN4;
rChDGrenHypN4 = cChDGrenMaxN4 -(cChDGrenMaxN4 - cChDGrenMinN4) * aLLimGrenHypN4;
oChlaGrenHypN4 = mgPergN4 * rChDGrenHypN4 * oDGrenWHypN4;
aExtChGrenHypN4 = cExtSpGrenN4 / rChDGrenHypN4;
ukDRespTmGrenHypN4 = kDRespGrenN4 * uFunTmRespGrenHypN4;
ukDRespTmGrenEpiN4 = kDRespGrenN4 * uFunTmRespGrenEpiN4;
ukDRespTmGrenSN4 = kDRespGrenN4 * uFunTmRespGrenSN4;
wDRespGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukDRespTmGrenHypN4 * oDGrenWHypN4 ENDIF;
ukLossTmGrenHypN4 = UseLossN4 * kLossGrenN4 * uFunTmLossHypN4;
ukLossTmGrenEpiN4 = UseLossN4 * kLossGrenN4 * uFunTmLossEpiN4;
wDLossGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukLossTmGrenHypN4 * oDGrenWHypN4 ENDIF;
wDMortGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortGrenWN4 * oDGrenWHypN4 ENDIF;
uCorVSetGrenHypN4 = (cVSetGrenN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMHypN4 * uFunTmSetHypN4;
tDSetGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE uCorVSetGrenHypN4 * oDGrenWHypN4 ENDIF;
tDResusGrenN4 = aDGrenSN4 /(aDPhytSN4+NearZeroN4) * tDResusPhytTotN4;
tDRespGrenSN4 = ukDRespTmGrenSN4 * aDGrenSN4;
tDMortGrenSN4 = kMortGrenSN4 * aDGrenSN4;
ukDDecGrenHypN4 = ukDRespTmGrenHypN4 + ukLossTmGrenHypN4 + kMortGrenWN4 +(uCorVSetGrenHypN4 * uFunTmSetHypN4) / uDepthWHypN4;
wPMortGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortGrenWN4 * oPGrenWHypN4 ENDIF;
tPResusGrenN4 = rPDGrenSN4 * tDResusGrenN4;
tPExcrGrenSN4 = (2.0 * rPDGrenSN4) /(cPDGrenMaxN4 + rPDGrenSN4) * rPDGrenSN4 * tDRespGrenSN4;
tPMortGrenSN4 = kMortGrenSN4 * aPGrenSN4;
wNExcrGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDGrenWHypN4) /(cNDGrenMaxN4 + rNDGrenWHypN4) * rNDGrenWHypN4 * wDRespGrenWHypN4 ENDIF;
wNLossGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN4 * wDLossGrenHypN4 ENDIF;
wNMortGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortGrenWN4 * oNGrenWHypN4 ENDIF;
tNSetGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDGrenWHypN4 * tDSetGrenHypN4 ENDIF;
tNResusGrenN4 = rNDGrenSN4 * tDResusGrenN4;
tNExcrGrenSN4 = (2.0 * rNDGrenSN4) /(cNDGrenMaxN4 + rNDGrenSN4) * rNDGrenSN4 * tDRespGrenSN4;
tNMortGrenSN4 = kMortGrenSN4 * aNGrenSN4;
uCorVSetGrenEpiN4 = (cVSetGrenN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMEpiN4 * uFunTmSetEpiN4;
tDSetGrenEpiN4 = uCorVSetGrenEpiN4 * oDGrenWEpiN4;
rNDGrenWEpiN4 = oNGrenWEpiN4 /(oDGrenWEpiN4+NearZeroN4);
tNSetGrenEpiN4 = rNDGrenWEpiN4 * tDSetGrenEpiN4;
rPDGrenWEpiN4 = oPGrenWEpiN4 /(oDGrenWEpiN4+NearZeroN4);
tPSetGrenEpiN4 = rPDGrenWEpiN4 * tDSetGrenEpiN4;
wNPrimGrenWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptGrenHypN4 - wNExcrGrenWHypN4 - wNLossGrenHypN4 - wNMortGrenWHypN4 -(tNSetGrenHypN4 -tNSetGrenEpiN4 - tNResusGrenN4) / uDepthWHypN4 ENDIF;
rPDDiatWHypN4 = oPDiatWHypN4 /(oDDiatWHypN4+NearZeroN4);
rNDDiatWHypN4 = oNDiatWHypN4 /(oDDiatWHypN4+NearZeroN4);
rPDDiatSN4 = aPDiatSN4 /(aDDiatSN4+NearZeroN4);
uFunTmDiatHypN4 = EXP(-0.5/(cSigTmDiatN4*cSigTmDiatN4) *((uTmHypN4-cTmOptDiatN4)*(uTmHypN4-cTmOptDiatN4) - (cTmRefN4-cTmOptDiatN4)*(cTmRefN4-cTmOptDiatN4)));
rNDDiatSN4 = aNDiatSN4 /(aDDiatSN4+NearZeroN4);
uFunTmDiatEpiN4 = EXP(-0.5/(cSigTmDiatN4*cSigTmDiatN4) *((uTmEpiN4-cTmOptDiatN4)*(uTmEpiN4-cTmOptDiatN4) - (cTmRefN4-cTmOptDiatN4)*(cTmRefN4-cTmOptDiatN4)));
uFunTmDiatSN4 = EXP(-0.5/(cSigTmDiatN4*cSigTmDiatN4) *((uTmBotN4-cTmOptDiatN4)*(uTmBotN4-cTmOptDiatN4) - (cTmRefN4-cTmOptDiatN4)*(cTmRefN4-cTmOptDiatN4)));
uFunTmProdDiatHypN4 = uFunTmDiatHypN4;
uFunTmRespDiatHypN4 = uFunTmDiatHypN4;
uFunTmProdDiatEpiN4 = uFunTmDiatEpiN4;
uFunTmRespDiatEpiN4 = uFunTmDiatEpiN4;
uFunTmRespDiatSN4 = uFunTmDiatSN4;
aVPUptMaxCrDiatHypN4 = MAX(0.0,cVPUptMaxDiatN4 * uFunTmProdDiatHypN4 *(cPDDiatMaxN4 - rPDDiatWHypN4) /(cPDDiatMaxN4 - cPDDiatMinN4));
aVPUptDiatHypN4 = oPO4WHypN4 * aVPUptMaxCrDiatHypN4 /(aVPUptMaxCrDiatHypN4 / cAffPUptDiatN4 + oPO4WHypN4);
wPUptDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVPUptDiatHypN4 * oDDiatWHypN4 ENDIF;
aVNUptMaxCrDiatHypN4 = MAX(0.0,cVNUptMaxDiatN4 * uFunTmProdDiatHypN4 * (cNDDiatMaxN4 - rNDDiatWHypN4) /(cNDDiatMaxN4 - cNDDiatMinN4));
ahNUptDiatHypN4 = aVNUptMaxCrDiatHypN4 / cAffNUptDiatN4;
aVNUptDiatHypN4 = oNDissWHypN4 * aVNUptMaxCrDiatHypN4 /(ahNUptDiatHypN4 + oNDissWHypN4);
wNUptDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVNUptDiatHypN4 * oDDiatWHypN4 ENDIF;
afNH4UptDiatHypN4 = oNH4WHypN4 * oNO3WHypN4 /((ahNUptDiatHypN4 + oNH4WHypN4) *(ahNUptDiatHypN4 + oNO3WHypN4)) + oNH4WHypN4 * ahNUptDiatHypN4 /((oNH4WHypN4 + oNO3WHypN4) *(ahNUptDiatHypN4 + oNO3WHypN4));
wNUptNH4DiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE afNH4UptDiatHypN4 * wNUptDiatHypN4 ENDIF;
wNUptNO3DiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN4 - wNUptNH4DiatHypN4 ENDIF;
uMuMaxTmDiatHypN4 = cMuMaxDiatN4 * uFunTmProdDiatHypN4;
uMuMaxTmDiatEpiN4 = cMuMaxDiatN4 * uFunTmProdDiatEpiN4;
aPLimDiatHypN4 = MAX(0.0,(1.0 - cPDDiatMinN4 / rPDDiatWHypN4) * cPDDiatMaxN4 /(cPDDiatMaxN4 - cPDDiatMinN4));
aNLimDiatHypN4 = MAX(0.0,(1.0 - cNDDiatMinN4 / rNDDiatWHypN4) * cNDDiatMaxN4 /(cNDDiatMaxN4 - cNDDiatMinN4));
aSiLimDiatHypN4 = oSiO2WHypN4 /(hSiAssDiatN4 + oSiO2WHypN4);
aLLimDiatHypN4 = UseSteeleDiatN4 *(EXP(1.0) /(aExtCoefHypN4 * uDepthWHypN4) *(EXP(- aLPARBotHypN4 /(cLOptRefDiatN4 * uFunTmProdDiatHypN4)) - EXP(- uLPARSurfHypN4 /(cLOptRefDiatN4 * uFunTmProdDiatHypN4)))) +(1.0 - UseSteeleDiatN4) *(1.0 /(aExtCoefHypN4 * uDepthWHypN4) * LN((1.0 + uLPARSurfHypN4 / (hLRefDiatN4 * uFunTmProdDiatHypN4)) / (1.0 + aLPARBotHypN4 /(hLRefDiatN4 * uFunTmProdDiatHypN4))));
aMuTmLDiatHypN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimDiatHypN4 * uMuMaxTmDiatHypN4;
aNutLimDiatHypN4 = MIN(aPLimDiatHypN4,(MIN(aNLimDiatHypN4,aSiLimDiatHypN4)));
aMuDiatHypN4 = aNutLimDiatHypN4 * aMuTmLDiatHypN4;
wDAssDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aMuDiatHypN4*oDDiatWHypN4 ENDIF;
rChDDiatHypN4 = cChDDiatMaxN4 -(cChDDiatMaxN4 - cChDDiatMinN4) * aLLimDiatHypN4;
oChlaDiatHypN4 = mgPergN4 * rChDDiatHypN4 * oDDiatWHypN4;
aExtChDiatHypN4 = cExtSpDiatN4 / rChDDiatHypN4;
ukDRespTmDiatHypN4 = kDRespDiatN4 * uFunTmRespDiatHypN4;
ukDRespTmDiatEpiN4 = kDRespDiatN4 * uFunTmRespDiatEpiN4;
ukDRespTmDiatSN4 = kDRespDiatN4 * uFunTmRespDiatSN4;
wDRespDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukDRespTmDiatHypN4 * oDDiatWHypN4 ENDIF;
ukLossTmDiatHypN4 = UseLossN4 * kLossDiatN4 * uFunTmLossHypN4;
ukLossTmDiatEpiN4 = UseLossN4 * kLossDiatN4 * uFunTmLossEpiN4;
wDLossDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE ukLossTmDiatHypN4 * oDDiatWHypN4 ENDIF;
wDMortDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortDiatWN4 * oDDiatWHypN4 ENDIF;
uCorVSetDiatHypN4 = (cVSetDiatN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMHypN4 * uFunTmSetHypN4;
tDSetDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE uCorVSetDiatHypN4 * oDDiatWHypN4 ENDIF;
tDResusDiatN4 = aDDiatSN4 /(aDPhytSN4+NearZeroN4) * tDResusPhytTotN4;
tDRespDiatSN4 = ukDRespTmDiatSN4 * aDDiatSN4;
tDMortDiatSN4 = kMortDiatSN4 * aDDiatSN4;
ukDDecDiatHypN4 = ukDRespTmDiatHypN4 + ukLossTmDiatHypN4 + kMortDiatWN4 +(uCorVSetDiatHypN4 * uFunTmSetHypN4) / uDepthWHypN4;
wPExcrDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (2.0 * rPDDiatWHypN4) /(cPDDiatMaxN4 + rPDDiatWHypN4) * rPDDiatWHypN4 * wDRespDiatWHypN4 ENDIF;
wPLossDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN4 * wDLossDiatHypN4 ENDIF;
wPMortDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortDiatWN4 * oPDiatWHypN4 ENDIF;
tPSetDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDDiatWHypN4 * tDSetDiatHypN4 ENDIF;
tPResusDiatN4 = rPDDiatSN4 * tDResusDiatN4;
tPExcrDiatSN4 = (2.0 * rPDDiatSN4) /(cPDDiatMaxN4 + rPDDiatSN4) * rPDDiatSN4 * tDRespDiatSN4;
tPMortDiatSN4 = kMortDiatSN4 * aPDiatSN4;
wNExcrDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (2.0 * rNDDiatWHypN4) /(cNDDiatMaxN4 + rNDDiatWHypN4) * rNDDiatWHypN4 * wDRespDiatWHypN4 ENDIF;
wNLossDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN4 * wDLossDiatHypN4 ENDIF;
wNMortDiatWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortDiatWN4 * oNDiatWHypN4 ENDIF;
tNSetDiatHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDDiatWHypN4 * tDSetDiatHypN4 ENDIF;
tNResusDiatN4 = rNDDiatSN4 * tDResusDiatN4;
tNExcrDiatSN4 = (2.0 * rNDDiatSN4) /(cNDDiatMaxN4 + rNDDiatSN4) * rNDDiatSN4 * tDRespDiatSN4;
tNMortDiatSN4 = kMortDiatSN4 * aNDiatSN4;
uCorVSetDiatEpiN4 = (cVSetDiatN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4)  * aFunTauSetOMEpiN4 * uFunTmSetEpiN4;
tDSetDiatEpiN4 = uCorVSetDiatEpiN4 * oDDiatWEpiN4;
rPDDiatWEpiN4 = oPDiatWEpiN4 /(oDDiatWEpiN4+NearZeroN4);
tPSetDiatEpiN4 = rPDDiatWEpiN4 * tDSetDiatEpiN4;
rNDDiatWEpiN4 = oNDiatWEpiN4 /(oDDiatWEpiN4+NearZeroN4);
tNSetDiatEpiN4 = rNDDiatWEpiN4 * tDSetDiatEpiN4;
wDPrimDiatWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wDAssDiatHypN4 - wDRespDiatWHypN4 - wDLossDiatHypN4 - wDMortDiatWHypN4 -(tDSetDiatHypN4 - tDSetDiatEpiN4 - tDResusDiatN4) / uDepthWHypN4 ENDIF;
wPPrimDiatWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wPUptDiatHypN4 - wPExcrDiatWHypN4 - wPLossDiatHypN4 - wPMortDiatWHypN4 -(tPSetDiatHypN4 -tPSetDiatEpiN4 - tPResusDiatN4) / uDepthWHypN4 ENDIF;
wNPrimDiatWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptDiatHypN4 - wNExcrDiatWHypN4 - wNLossDiatHypN4 - wNMortDiatWHypN4 -(tNSetDiatHypN4 - tNSetDiatEpiN4 - tNResusDiatN4) / uDepthWHypN4 ENDIF;
oChlaHypN4 = oChlaDiatHypN4 + oChlaGrenHypN4 + oChlaBlueHypN4;
wDRespPhytWHypN4 = wDRespDiatWHypN4 + wDRespGrenWHypN4 + wDRespBlueWHypN4;
wDMortPhytWHypN4 = wDMortDiatWHypN4 + wDMortGrenWHypN4 + wDMortBlueWHypN4;
wDLossPhytHypN4 = wDLossDiatHypN4 + wDLossGrenHypN4 + wDLossBlueHypN4;
wPMortPhytWHypN4 = wPMortDiatWHypN4 + wPMortGrenWHypN4 + wPMortBlueWHypN4;
tPResusPhytN4 = tPResusDiatN4 + tPResusGrenN4 + tPResusBlueN4;
wNUptPhytHypN4 = wNUptDiatHypN4 + wNUptGrenHypN4 + wNUptBlueHypN4;
wNUptNH4PhytHypN4 = wNUptNH4DiatHypN4 + wNUptNH4GrenHypN4 + wNUptNH4BlueHypN4;
wNUptNO3PhytHypN4 = wNUptNO3DiatHypN4 + wNUptNO3GrenHypN4 + wNUptNO3BlueHypN4;
wNExcrPhytWHypN4 = wNExcrDiatWHypN4 + wNExcrGrenWHypN4 + wNExcrBlueWHypN4;
wNMortPhytWHypN4 = wNMortDiatWHypN4 + wNMortGrenWHypN4 + wNMortBlueWHypN4;
tNResusPhytN4 = tNResusDiatN4 + tNResusGrenN4 + tNResusBlueN4;
wNLossPhytHypN4 = wNLossDiatHypN4 + wNLossGrenHypN4 + wNLossBlueHypN4;
tDRespPhytSN4 = tDRespDiatSN4 + tDRespGrenSN4 + tDRespBlueSN4;
tDMortPhytSN4 = tDMortDiatSN4 + tDMortGrenSN4 + tDMortBlueSN4;
tPExcrPhytSN4 = tPExcrDiatSN4 + tPExcrGrenSN4 + tPExcrBlueSN4;
tPMortPhytSN4 = tPMortDiatSN4 + tPMortGrenSN4 + tPMortBlueSN4;
tNExcrPhytSN4 = tNExcrDiatSN4 + tNExcrGrenSN4 + tNExcrBlueSN4;
tNMortPhytSN4 = tNMortDiatSN4 + tNMortGrenSN4 + tNMortBlueSN4;
wSiUptDiatHypN4 = cSiDDiatN4 * wDAssDiatHypN4;
wSiExcrDiatWHypN4 = cSiDDiatN4 * wDRespDiatWHypN4 ;
wSiLossDiatHypN4 = cSiDDiatN4 * wDLossDiatHypN4;
wSiMortDiatWHypN4 = cSiDDiatN4 * wDMortDiatWHypN4;
tSiSetDiatHypN4 = cSiDDiatN4 * tDSetDiatHypN4;
tSiResusDiatN4 = cSiDDiatN4 * tDResusDiatN4 ;
rCyDBlueHypN4 = cCyDBlueMaxN4 -(cCyDBlueMaxN4 - cCyDBlueMinN4) * aLLimBlueHypN4;
oCyanHypN4 = rCyDBlueHypN4 * oDBlueWHypN4 * mgPergN4;
fDDiatHypN4 = oDDiatWHypN4 /(oDDiatWHypN4 + oDGrenWHypN4 + oDBlueWHypN4 + NearZeroN4);
wDPrimDetWHypN4 = wDMortPhytWHypN4 + wDLossPhytHypN4;
wO2RespPhytWHypN4 = molO2molCN4 * cCPerDWN4 * wDRespPhytWHypN4 * aCorO2BODHypN4;
wO2UptNO3PhytHypN4 = O2PerNO3N4 * molO2molNN4 * wNUptNO3PhytHypN4;
wPMortPhytPO4WHypN4 = fDissMortPhytN4 * wPMortPhytWHypN4;
wPMortPhytDetWHypN4 = wPMortPhytWHypN4 - wPMortPhytPO4WHypN4;
tPMortPhytPO4SN4 = fDissMortPhytN4 * tPMortPhytSN4;
tPMortPhytDetSN4 = tPMortPhytSN4 - tPMortPhytPO4SN4;
tPPrimPO4SN4 = tPExcrPhytSN4 + tPMortPhytPO4SN4;
tPPrimTotTN4 = 0.0;
wNMortPhytNH4WHypN4 = fDissMortPhytN4 * wNMortPhytWHypN4;
wNMortPhytDetWHypN4 = wNMortPhytWHypN4 - wNMortPhytNH4WHypN4;
wNLossPhytNH4HypN4 = fDissLossN4 * wNLossPhytHypN4;
wNLossPhytDetHypN4 = wNLossPhytHypN4 - wNLossPhytNH4HypN4;
wNPrimNH4WHypN4 = - wNUptNH4PhytHypN4 + wNExcrPhytWHypN4 + wNLossPhytNH4HypN4 + wNMortPhytNH4WHypN4;
wNPrimNO3WHypN4 = - wNUptNO3PhytHypN4;
wNPrimDetWHypN4 = wNLossPhytDetHypN4 + wNMortPhytDetWHypN4;
tNMortPhytNH4SN4 = fDissMortPhytN4 * tNMortPhytSN4;
tNMortPhytDetSN4 = tNMortPhytSN4 - tNMortPhytNH4SN4;
tNPrimNH4SN4 = tNExcrPhytSN4 + tNMortPhytNH4SN4;
tNPrimNO3SN4 = 0.0;
tNPrimTotTN4 = 0.0;
tSiExcrDiatSN4 = cSiDDiatN4 * tDRespDiatSN4 ;
tSiMortDiatSN4 = cSiDDiatN4 * tDMortDiatSN4;
wSiPrimSiO2WHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wSiExcrDiatWHypN4 - wSiUptDiatHypN4 + tSiExcrDiatSN4 / uDepthWHypN4 ENDIF;
wSiPrimDetWHypN4 = wSiMortDiatWHypN4 + wSiLossDiatHypN4;
tSiPrimTotTN4 = 0.0;
aPACoefEpiN4 = cPACoefMinN4 +(cPACoefMaxN4 - cPACoefMinN4) * hPACoefN4 / (hPACoefN4 + oDOMWEpiN4);
aPACoefHypN4 = cPACoefMinN4 +(cPACoefMaxN4 - cPACoefMinN4) * hPACoefN4 / (hPACoefN4 + oDOMWHypN4);
bSecchiMaxEpiN4 = uDepthWEpiN4;
aSecchiEpiN4 = MIN(bSecchiMaxEpiN4,aPACoefEpiN4 / aExtCoefOpenEpiN4);
aTransparencyEpiN4 = aSecchiEpiN4 / uDepthWEpiN4;
bSecchiMaxHypN4 = uDepthWHypN4 + cSecchiPlusN4;
aSecchiHypN4 = IF ( aInclStratN4 EQ TRUE AND uDepthWEpiN4 LE aPACoefEpiN4 / aExtCoefOpenEpiN4 ) THEN MIN(bSecchiMaxHypN4,aPACoefHypN4 / aExtCoefOpenHypN4 - aSecchiEpiN4) ELSEIF ( aInclStratN4 EQ TRUE AND uDepthWEpiN4 GT aPACoefEpiN4 / aExtCoefOpenEpiN4) THEN 0.0 ELSE MIN(bSecchiMaxHypN4,aPACoefHypN4 / aExtCoefOpenHypN4) ENDIF;
aSecchiTN4 = IF ( aInclStratN4 EQ TRUE ) THEN aSecchiEpiN4 +aSecchiHypN4 ELSE aSecchiEpiN4 ENDIF;
aTransparencyHypN4 = aSecchiHypN4 / uDepthWHypN4;
aTransparencyTN4 = IF ( aInclStratN4 EQ TRUE ) THEN aSecchiTN4 / uDepthWN4 ELSE aSecchiTN4 / uDepthWHypN4 ENDIF;
aDepthEuphHypN4 = cEuphN4 * aSecchiHypN4;
aRelDepthEuphHypN4 = aDepthEuphHypN4 / uDepthWHypN4;
aChlaHHypN4 = oChlaHypN4 * uDepthWHypN4;
aCovPhytWHypN4 = cCovSpPhytN4 *(oDPhytWHypN4 * uDepthWHypN4);
rExtChPhytHypN4 = aExtPhytHypN4 /(oChlaHypN4 / mgPergN4 + NearZeroN4);
uFunTmZooHypN4 = EXP(-0.5/(cSigTmZooN4*cSigTmZooN4) *((uTmHypN4-cTmOptZooN4)*(uTmHypN4-cTmOptZooN4) -(cTmRefN4-cTmOptZooN4)*(cTmRefN4-cTmOptZooN4)));
uFunTmZooEpiN4 = EXP(-0.5/(cSigTmZooN4*cSigTmZooN4) *((uTmEpiN4-cTmOptZooN4)*(uTmEpiN4-cTmOptZooN4) -(cTmRefN4-cTmOptZooN4)*(cTmRefN4-cTmOptZooN4)));
rPDZooHypN4 = oPZooHypN4 /(oDZooHypN4+NearZeroN4);
rNDZooHypN4 = oNZooHypN4/(oDZooHypN4+NearZeroN4);
oDFoodZooHypN4 = cPrefDiatN4 * oDDiatWHypN4 + cPrefGrenN4 * oDGrenWHypN4 + cPrefBlueN4 * oDBlueWHypN4 + cPrefDetN4 * oDDetWHypN4;
aFiltHypN4 = cFiltMaxN4 * uFunTmZooHypN4 * hFiltN4 /(hFiltN4 + oDOMWHypN4);
ukDAssTmZooHypN4 = fDAssZooN4 * cFiltMaxN4 * uFunTmZooHypN4 * hFiltN4;
ukDAssTmZooEpiN4 = fDAssZooN4 * cFiltMaxN4 * uFunTmZooEpiN4 * hFiltN4;
aDSatZooHypN4 = oDFoodZooHypN4 /(hFiltN4 + oDOMWHypN4);
ukDRespTmZooHypN4 = kDRespZooN4 * uFunTmZooHypN4;
ukDRespTmZooEpiN4 = kDRespZooN4 * uFunTmZooEpiN4;
ukDIncrZooHypN4 = ukDAssTmZooHypN4 - ukDRespTmZooHypN4 - kMortZooN4;
ukDIncrZooEpiN4 = ukDAssTmZooEpiN4 - ukDRespTmZooEpiN4 - kMortZooN4;
wDEnvZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE MAX(0.0,ukDIncrZooHypN4 / cDCarrZooN4 * oDZooHypN4*oDZooHypN4) ENDIF;
wDAssZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aDSatZooHypN4 *(ukDAssTmZooHypN4 * oDZooHypN4 - wDEnvZooHypN4) ENDIF;
wDConsZooHypN4 = wDAssZooHypN4 / fDAssZooN4;
wDConsDetZooHypN4 = cPrefDetN4*oDDetWHypN4 / oDFoodZooHypN4 * wDConsZooHypN4;
wDConsDiatZooHypN4 = cPrefDiatN4*oDDiatWHypN4 / oDFoodZooHypN4 * wDConsZooHypN4;
wDConsGrenZooHypN4 = cPrefGrenN4*oDGrenWHypN4 / oDFoodZooHypN4 * wDConsZooHypN4;
wDConsBlueZooHypN4 = cPrefBlueN4*oDBlueWHypN4 / oDFoodZooHypN4 * wDConsZooHypN4;
wDConsPhytZooHypN4 = wDConsDiatZooHypN4 + wDConsGrenZooHypN4 + wDConsBlueZooHypN4;
wDEgesZooHypN4 = wDConsZooHypN4 - wDAssZooHypN4;
aCorDRespZooHypN4 = MAX(cPDZooRefN4 / rPDZooHypN4,cNDZooRefN4 / rNDZooHypN4);
wDRespZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aCorDRespZooHypN4 * ukDRespTmZooHypN4 * oDZooHypN4 ENDIF;
wDMortZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kMortZooN4 * oDZooHypN4 +(1.0 - aDSatZooHypN4) * wDEnvZooHypN4 ENDIF;
oPFoodZooHypN4 = cPrefDiatN4*oPDiatWHypN4 + cPrefGrenN4*oPGrenWHypN4 + cPrefBlueN4*oPBlueWHypN4 + cPrefDetN4 * oPDetWHypN4;
rPDFoodZooHypN4 = oPFoodZooHypN4 /(oDFoodZooHypN4+NearZeroN4);
wPConsDiatZooHypN4 = rPDDiatWHypN4 * wDConsDiatZooHypN4;
wPConsBlueZooHypN4 = rPDBlueWHypN4 * wDConsBlueZooHypN4;
wPConsDetZooHypN4 = rPDDetWHypN4 * wDConsDetZooHypN4;
afPAssZooHypN4 = MIN(1.0,cPDZooRefN4 / rPDFoodZooHypN4 * fDAssZooN4);
akPExcrZooHypN4 = rPDZooHypN4 / cPDZooRefN4 * kDRespZooN4 * uFunTmZooHypN4;
wPExcrZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE akPExcrZooHypN4*oPZooHypN4 ENDIF;
wPMortZooHypN4 = rPDZooHypN4 * wDMortZooHypN4;
wPMortZooPO4HypN4 = fDissMortZooN4 * wPMortZooHypN4;
wPMortZooDetHypN4 = wPMortZooHypN4 - wPMortZooPO4HypN4;
oNFoodZooHypN4 = cPrefDiatN4*oNDiatWHypN4 + cPrefGrenN4*oNGrenWHypN4 + cPrefBlueN4*oNBlueWHypN4 + cPrefDetN4*oNDetWHypN4;
rNDFoodZooHypN4 = oNFoodZooHypN4 /(oDFoodZooHypN4+NearZeroN4);
wNConsDiatZooHypN4 = rNDDiatWHypN4*wDConsDiatZooHypN4;
wNConsGrenZooHypN4 = rNDGrenWHypN4*wDConsGrenZooHypN4;
wNConsBlueZooHypN4 = rNDBlueWHypN4*wDConsBlueZooHypN4;
wNConsPhytZooHypN4 = wNConsDiatZooHypN4 + wNConsGrenZooHypN4 + wNConsBlueZooHypN4;
wNConsDetZooHypN4 = rNDDetWHypN4*wDConsDetZooHypN4;
wNConsZooHypN4 = wNConsPhytZooHypN4 + wNConsDetZooHypN4;
afNAssZooHypN4 = MIN(1.0,cNDZooRefN4 / rNDFoodZooHypN4 * fDAssZooN4);
wNAssZooHypN4 = afNAssZooHypN4*wNConsZooHypN4;
wNEgesZooHypN4 = wNConsZooHypN4 - wNAssZooHypN4;
wNEgesZooNH4HypN4 = fDissEgesZooN4*wNEgesZooHypN4;
wNEgesZooDetHypN4 = wNEgesZooHypN4 - wNEgesZooNH4HypN4;
kNExcrZooHypN4 = rNDZooHypN4 / cNDZooRefN4 * kDRespZooN4 * uFunTmZooHypN4;
wNExcrZooHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE kNExcrZooHypN4*oNZooHypN4 ENDIF;
wNMortZooHypN4 = rNDZooHypN4*wDMortZooHypN4;
wNMortZooNH4HypN4 = fDissMortZooN4*wNMortZooHypN4;
wNMortZooDetHypN4 = wNMortZooHypN4 - wNMortZooNH4HypN4;
wSiConsDiatZooHypN4 = cSiDDiatN4 * wDConsDiatZooHypN4;
uFunTmBentN4 = EXP(-0.5/(cSigTmBentN4*cSigTmBentN4) *((uTmBotN4-cTmOptBentN4)*(uTmBotN4-cTmOptBentN4) - (cTmRefN4-cTmOptBentN4)*(cTmRefN4-cTmOptBentN4)));
aDFoodBentN4 = aDDetSN4 + aDPhytSN4;
rPDBentN4 = aPBentN4 /(aDBentN4+NearZeroN4);
rNDBentN4 = aNBentN4 /(aDBentN4+NearZeroN4);
tDMigrBentN4 = kMigrBentN4 *(cDBentInN4 - aDBentN4);
aDSatBentN4 = aDFoodBentN4 /(hDFoodBentN4 + aDFoodBentN4);
ukDIncrBentN4 = (kDAssBentN4 - kDRespBentN4) * uFunTmBentN4 - kMortBentN4;
tDEnvBentN4 = MAX(0.0,ukDIncrBentN4 / cDCarrBentN4 * aDBentN4*aDBentN4);
tDAssBentN4 = aDSatBentN4 *(kDAssBentN4 * uFunTmBentN4 * aDBentN4 - tDEnvBentN4);
aDAssBentSpN4 = tDAssBentN4 / aDBentN4;
tDConsBentN4 = tDAssBentN4 / fDAssBentN4;
tDConsDetBentN4 = aDDetSN4 / aDFoodBentN4 * tDConsBentN4;
tDConsDiatBentN4 = aDDiatSN4 / aDFoodBentN4 * tDConsBentN4;
tDConsGrenBentN4 = aDGrenSN4 / aDFoodBentN4 * tDConsBentN4;
tDConsBlueBentN4 = aDBlueSN4 / aDFoodBentN4 * tDConsBentN4;
tDConsPhytBentN4 = tDConsDiatBentN4 + tDConsGrenBentN4 + tDConsBlueBentN4;
tDEgesBentN4 = tDConsBentN4 - tDAssBentN4;
tDRespBentN4 = (cPDBentRefN4 / rPDBentN4) * kDRespBentN4 * uFunTmBentN4 * aDBentN4;
tDMortBentN4 = kMortBentN4*aDBentN4 +(1.0 - aDSatBentN4) * tDEnvBentN4;
aPFoodBentN4 = aPDetSN4 + aPPhytSN4;
rPDFoodBentN4 = aPFoodBentN4 /(aDFoodBentN4+NearZeroN4);
tPConsDetBentN4 = rPDDetSN4 * tDConsDetBentN4;
tPConsDiatBentN4 = rPDDiatSN4 * tDConsDiatBentN4;
tPConsGrenBentN4 = rPDGrenSN4 * tDConsGrenBentN4;
tPConsBlueBentN4 = rPDBlueSN4 * tDConsBlueBentN4;
tPConsPhytBentN4 = tPConsDiatBentN4 + tPConsGrenBentN4 + tPConsBlueBentN4;
tPConsBentN4 = tPConsDetBentN4 + tPConsPhytBentN4;
afPAssBentN4 = MIN(1.0,cPDBentRefN4 / rPDFoodBentN4 * fDAssBentN4);
tPAssBentN4 = afPAssBentN4 * tPConsBentN4;
tPEgesBentN4 = tPConsBentN4 - tPAssBentN4;
tPEgesBentPO4N4 = fDissEgesBentN4 * tPEgesBentN4;
tPEgesBentDetN4 = (1.0 - fDissEgesBentN4) * tPEgesBentN4;
tPExcrBentN4 = (rPDBentN4 / cPDBentRefN4) * kDRespBentN4 * uFunTmBentN4 * aPBentN4;
tPMortBentN4 = rPDBentN4 * tDMortBentN4;
tPMortBentPO4N4 = fDissMortBentN4 * tPMortBentN4;
tPMortBentDetN4 = (1.0-fDissMortBentN4)*tPMortBentN4;
tPMigrBentN4 = kMigrBentN4 *(cPDBentRefN4*cDBentInN4 - aPBentN4);
aNFoodBentN4 = aNDetSN4 + aNPhytSN4;
rNDFoodBentN4 = aNFoodBentN4 /(aDFoodBentN4+NearZeroN4);
tNMigrBentN4 = kMigrBentN4 *(cNDBentRefN4*cDBentInN4 - aNBentN4);
tNConsDetBentN4 = rNDDetSN4 * tDConsDetBentN4;
tNConsDiatBentN4 = rNDDiatSN4 * tDConsDiatBentN4;
tNConsGrenBentN4 = rNDGrenSN4 * tDConsGrenBentN4;
tNConsBlueBentN4 = rNDBlueSN4 * tDConsBlueBentN4;
tNConsPhytBentN4 = tNConsDiatBentN4 + tNConsGrenBentN4 + tNConsBlueBentN4;
tNConsBentN4 = tNConsDetBentN4 + tNConsPhytBentN4;
afNAssBentN4 = MIN(1.0,cNDBentRefN4 / rNDFoodBentN4 * fDAssBentN4);
tNAssBentN4 = afNAssBentN4 * tNConsBentN4;
tNEgesBentN4 = tNConsBentN4 - tNAssBentN4;
tNEgesBentNH4N4 = fDissEgesBentN4 * tNEgesBentN4;
tNEgesBentDetN4 = (1.0 - fDissEgesBentN4) * tNEgesBentN4;
tNExcrBentN4 = (rNDBentN4 / cNDBentRefN4) * kDRespBentN4 * uFunTmBentN4 * aNBentN4;
tNMortBentN4 = rNDBentN4 * tDMortBentN4;
tNMortBentNH4N4 = fDissMortBentN4*tNMortBentN4;
tNMortBentDetN4 = (1.0-fDissMortBentN4)*tNMortBentN4;
tSiConsDiatBentN4 = cSiDDiatN4 * tDConsDiatBentN4;
aFunVegFishN4 = MAX(0.0,1.0 - cRelVegFishN4 * aCovVegN4);
ukDIncrFiJvN4 = (kDAssFiJvN4 - kDRespFiJvN4) * uFunTmFishN4 - kMortFiJvN4;
aDSatFiAdN4 = (aFunVegFishN4 * aDBentN4) *(aFunVegFishN4 * aDBentN4) /(hDBentFiAdN4 * hDBentFiAdN4 + (aFunVegFishN4 * aDBentN4) *(aFunVegFishN4 * aDBentN4));
ukDIncrFiAdN4 = (kDAssFiAdN4 - kDRespFiAdN4) * uFunTmFishN4 - kMortFiAdN4;
ukHarvFishN4 = IF (COS(2.0 * PiN4 * sTimeN4 / DaysInYearN4) GT 0.1) THEN kHarvFishWinN4 ELSE kHarvFishSumN4 ENDIF;
afPAssFiAdN4 = MIN(1.0,cPDFishRefN4 / rPDBentN4 * fDAssFiAdN4);
afNAssFiAdN4 = MIN(1.0,cNDFishRefN4 / rNDBentN4 * fDAssFiAdN4);
uFunTmPiscN4 = EXP(-0.5 /(cSigTmPiscN4*cSigTmPiscN4) *((uTmEpiN4 - cTmOptPiscN4)*(uTmEpiN4 - cTmOptPiscN4) - (cTmRefN4 - cTmOptPiscN4)*(cTmRefN4 - cTmOptPiscN4)));
aDCarrPiscN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN MAX(cDCarrPiscMinN4,MIN(cDCarrPiscMaxN4,cDCarrPiscBareN4)) ELSEIF (aDShootPhraN4 LT cDPhraMinPiscN4) THEN cDCarrPiscMinN4 ELSEIF (aCovVegN4 LT cCovVegMinN4) THEN MAX(cDCarrPiscMinN4,MIN(cDCarrPiscMaxN4,fMarshN4 *(1.0/PerCentN4) * cRelPhraPiscN4)) ELSE MAX(cDCarrPiscMinN4,MIN(cDCarrPiscMaxN4,fMarshN4 *(1.0/PerCentN4) *(cRelPhraPiscN4 + cRelVegPiscN4))) ENDIF;
aFunVegPiscN4 = aDSubVegN4 /(hDVegPiscN4 + aDSubVegN4 + NearZeroN4);
akDIncrPiscN4 = (kDAssPiscN4 * aFunVegPiscN4 - kDRespPiscN4) * uFunTmPiscN4 - kMortPiscN4;
ukHarvPiscN4 = IF (COS(2.0*PiN4 * sTimeN4 / DaysInYearN4) GT 0.1) THEN kHarvPiscWinN4 ELSE kHarvPiscSumN4 ENDIF;
tDWebDetSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tDConsDetBentN4 + tDEgesBentN4 + tDMortBentN4 ENDIF;
tDWebDiatSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tDConsDiatBentN4 ENDIF;
tDWebGrenSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tDConsGrenBentN4 ENDIF;
tDWebBlueSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tDConsBlueBentN4 ENDIF;
tDWebPhytSN4 = tDWebDiatSN4 + tDWebGrenSN4 + tDWebBlueSN4;
tPWebPO4SN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tPExcrBentN4 + tPEgesBentPO4N4 + tPMortBentPO4N4 ENDIF;
tPWebDetSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tPConsDetBentN4 + tPEgesBentDetN4 + tPMortBentDetN4 ENDIF;
tPWebDiatSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tPConsDiatBentN4 ENDIF;
tPWebGrenSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tPConsGrenBentN4 ENDIF;
tPWebBlueSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tPConsBlueBentN4 ENDIF;
tPWebPhytSN4 = tPWebDiatSN4 + tPWebGrenSN4 + tPWebBlueSN4;
tNWebNH4SN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tNExcrBentN4 + tNEgesBentNH4N4 + tNMortBentNH4N4 ENDIF;
tNWebNO3SN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE 0.0 ENDIF;
tNWebDetSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tNConsDetBentN4 + tNEgesBentDetN4 + tNMortBentDetN4 ENDIF;
tNWebDiatSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tNConsDiatBentN4 ENDIF;
tNWebGrenSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tNConsGrenBentN4 ENDIF;
tNWebBlueSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - tNConsBlueBentN4 ENDIF;
tNWebPhytSN4 = tNWebDiatSN4 + tNWebGrenSN4 + tNWebBlueSN4;
wSiWebSiO2WN4 = 0.0;
wSiWebDetWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wSiConsDiatZooHypN4 ENDIF;
tSiWebDetSN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tSiConsDiatBentN4 ENDIF;
tSiWebTotTN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE 0.0 ENDIF;
aPrefAveHypN4 = (cPrefDiatN4 * oDDiatWHypN4 + cPrefGrenN4 * oDGrenWHypN4 + cPrefBlueN4 * oDBlueWHypN4 + cPrefDetN4 * oDDetWHypN4) / oDOMWHypN4;
wDConsZoo2HypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aFiltHypN4 * aPrefAveHypN4 * oDOMWHypN4 * oDZooHypN4 ENDIF;
aDConsZooSpHypN4 = wDConsZooHypN4 / oDZooHypN4;
aDAssZooSpHypN4 = wDAssZooHypN4 / oDZooHypN4;
aDGrazSpHypN4 = wDConsZooHypN4 / oDOMWHypN4;
aNConsZooSpHypN4 = wNConsZooHypN4 / oNZooHypN4;
aNGrazSpHypN4 = wNConsZooHypN4 / oNOMWHypN4;
afDShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDShootPhraN4 /(aDRootPhraN4 + aDShootPhraN4) ELSE 0.0 ENDIF;
rDSRPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDShootPhraN4/aDRootPhraN4 ELSE 0.0 ENDIF;
rPDShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPShootPhraN4/aDShootPhraN4 ELSE 0.0 ENDIF;
rNDShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNShootPhraN4/aDShootPhraN4 ELSE 0.0 ENDIF;
rPDRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aPRootPhraN4/aDRootPhraN4 ELSE 0.0 ENDIF;
rNDRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNRootPhraN4/aDRootPhraN4 ELSE 0.0 ENDIF;
aLengShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aDShootPhraN4 / cDStemPhraN4 / cDensStemPhraN4 ELSE 0.0 ENDIF;
bDayInitPhraN4 = IF (DayN4 LT 1.0 OR sTimeN4 LT StartTimeN4 + 1.0) THEN 367 ELSEIF (uTmEpiN4 GE cTmInitPhraN4 AND bDayInitPhraN4 GT 366) THEN DayN4 ELSE bDayInitPhraN4 ENDIF;
aDAllPhraN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (DayN4 LT bDayInitPhraN4) THEN 0.0 ELSEIF (DayN4 LE bDayInitPhraN4 + 1.0 / kDAllPhraN4) THEN fDAllPhraN4 * aDRootPhraN4 ELSE 0.0 ENDIF;
tDAllPhraN4 = IF (FALSE EQ InclSeasonN4) THEN 0.0 ELSEIF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (DayN4 LT bDayInitPhraN4) THEN 0.0 ELSEIF (DayN4 LE bDayInitPhraN4 + 1.0 / kDAllPhraN4) THEN kDAllPhraN4 * aDAllPhraN4 ELSE 0.0 ENDIF;
tNTransPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rNDRootPhraN4 * tDAllPhraN4 ELSE 0.0 ENDIF;
tPTransPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rPDRootPhraN4 * tDAllPhraN4 ELSE 0.0 ENDIF;
aVNUptPhraMaxCrN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN MAX(0.0,cVNUptPhraMaxN4 * POW(cQ10ProdPhraN4 , (0.1 *(uTmEpiN4 - cTmRefN4))) *(cNDPhraMaxN4 - rNDRootPhraN4) /(cNDPhraMaxN4 - cNDPhraMinN4)) ELSE 0.0 ENDIF;
ahNUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVNUptPhraMaxCrN4 / cAffNUptPhraN4 ELSE 0.0 ENDIF;
aVNUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVNUptPhraMaxCrN4 * oNDissSMN4 /(ahNUptPhraSN4 + oNDissSMN4) ELSE 0.0 ENDIF;
tNUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVNUptPhraSN4 * aDRootPhraN4 ELSE 0.0 ENDIF;
tNUptNH4PhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aNH4SMN4 / aNDissSMN4 * tNUptPhraSN4 ELSE 0.0 ENDIF;
tNUptNO3PhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tNUptPhraSN4 - tNUptNH4PhraSN4 ELSE 0.0 ENDIF;
tNUptShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN afDShootPhraN4 * tNUptPhraSN4 ELSE 0.0 ENDIF;
tNUptRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tNUptPhraSN4 - tNUptShootPhraN4 ELSE 0.0 ENDIF;
aVPUptPhraMaxCrN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN MAX(0.0,cVPUptPhraMaxN4 * POW(cQ10ProdPhraN4 , (0.1 *(uTmEpiN4 - cTmRefN4))) *(cPDPhraMaxN4 - rPDRootPhraN4) /(cPDPhraMaxN4 - cPDPhraMinN4)) ELSE 0.0 ENDIF;
ahPUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVPUptPhraMaxCrN4 / cAffPUptPhraN4 ELSE 0.0 ENDIF;
aVPUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVPUptPhraMaxCrN4 * oPO4SMN4 /(ahPUptPhraSN4 + oPO4SMN4) ELSE 0.0 ENDIF;
tPUptPhraSN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aVPUptPhraSN4 * aDRootPhraN4 ELSE 0.0 ENDIF;
tPUptShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN afDShootPhraN4 * tPUptPhraSN4 ELSE 0.0 ENDIF;
tPUptRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tPUptPhraSN4 - tPUptShootPhraN4 ELSE 0.0 ENDIF;
uFunTmProdPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN POW(cQ10ProdPhraN4 , (0.1 *(uTmEpiN4 - cTmRefN4))) ELSE 0.0 ENDIF;
ukDRespTmPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDRespPhraN4 * POW(cQ10RespPhraN4 , (0.1 *(uTmEpiN4 - cTmRefN4))) ELSE 0.0 ENDIF;
aMuPhotPhraN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (aLengShootPhraN4 GE uDepthWMN4) THEN cMuPhraMaxN4 * uFunTmProdPhraN4 * ufDayN4 ELSE 0.0 ENDIF;
aNLimProdPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (1.0 - cNDPhraMinN4 / rNDRootPhraN4) * cNDPhraMaxN4 /(cNDPhraMaxN4 - cNDPhraMinN4) ELSE 0.0 ENDIF;
aPLimProdPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (1.0 - cPDPhraMinN4 / rPDRootPhraN4) * cPDPhraMaxN4 /(cPDPhraMaxN4 - cPDPhraMinN4) ELSE 0.0 ENDIF;
aNutLimPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN MIN(aNLimProdPhraN4,aPLimProdPhraN4) ELSE 0.0 ENDIF;
aMuPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aMuPhotPhraN4 * aNutLimPhraN4 ELSE 0.0 ENDIF;
akDIncrPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aMuPhotPhraN4 - ukDRespTmPhraN4 - kDMortShootPhraN4 ELSE 0.0 ENDIF;
tDDensPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN MAX(0.0,akDIncrPhraN4 / cDShootPhraMaxN4 * aDShootPhraN4 * aDShootPhraN4) ELSE 0.0 ENDIF;
tDDensProdPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aMuPhraN4 / cMuPhraMaxN4 * tDDensPhraN4 ELSE 0.0 ENDIF;
tDProdPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN aMuPhraN4 * aDShootPhraN4 - tDDensProdPhraN4 ELSE 0.0 ENDIF;
tDProdShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN afDShootPhraN4 * tDProdPhraN4 ELSE 0.0 ENDIF;
tDProdRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDProdPhraN4 - tDProdShootPhraN4 ELSE 0.0 ENDIF;
tDRespShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ukDRespTmPhraN4 * aDShootPhraN4 ELSE 0.0 ENDIF;
tDRespRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN ukDRespTmPhraN4 * aDRootPhraN4 ELSE 0.0 ENDIF;
tO2RespRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN molO2molCN4 * cCPerDWN4 * tDRespRootPhraN4 * afOxySedMN4 ELSE 0.0 ENDIF;
tO2FlowPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tO2RespRootPhraN4 ELSE 0.0 ENDIF;
bDayRealPhraN4 = IF (DayN4 LT 180.0) THEN 367 ELSEIF (ufDayN4 LE fDayWinN4 AND bDayRealPhraN4 GT 366) THEN DayN4 ELSE bDayRealPhraN4 ENDIF;
aDRealPhraN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (DayN4 LT bDayRealPhraN4) THEN 0.0 ELSEIF (DayN4 LE bDayRealPhraN4 + 1.0 / kDRealPhraN4) THEN fDRealPhraN4 * aDShootPhraN4 ELSE 0.0 ENDIF;
tDRealPhraN4 = IF (FALSE EQ InclSeasonN4) THEN 0.0 ELSEIF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (DayN4 LT bDayRealPhraN4) THEN 0.0 ELSEIF (DayN4 LE bDayRealPhraN4 + 1.0 / kDRealPhraN4) THEN kDRealPhraN4 * aDRealPhraN4 ELSE 0.0 ENDIF;
tNRetrPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rNDShootPhraN4 * tDRealPhraN4 ELSE 0.0 ENDIF;
tPRetrPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rPDShootPhraN4 * tDRealPhraN4 ELSE 0.0 ENDIF;
tDMortShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMortShootPhraN4 * aDShootPhraN4 ELSE 0.0 ENDIF;
tNMortShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rNDShootPhraN4 * tDMortShootPhraN4 ELSE 0.0 ENDIF;
tPMortShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rPDShootPhraN4 * tDMortShootPhraN4 ELSE 0.0 ENDIF;
tDMortRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kDMortRootPhraN4 * aDRootPhraN4 ELSE 0.0 ENDIF;
tNMortRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rNDRootPhraN4 * tDMortRootPhraN4 ELSE 0.0 ENDIF;
tPMortRootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN rPDRootPhraN4 * tDMortRootPhraN4 ELSE 0.0 ENDIF;
tDManShootPhraN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 GT NearZeroN4) THEN 0.0 ELSEIF ((DayN4 GE cDayManPhraN4) AND (DayN4 LT cDayManPhraN4 + 1.0)) THEN fManPhraN4 * aDShootPhraN4 ELSE 0.0 ENDIF;
tNManShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDManShootPhraN4 * rNDShootPhraN4 ELSE 0.0 ENDIF;
tPManShootPhraN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDManShootPhraN4 * rPDShootPhraN4 ELSE 0.0 ENDIF;
tDIMSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDSetIMMN4 ELSE 0.0 ENDIF;
tDHumSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN fRefrDetSN4 * tDMinDetSMN4 - tDMinHumSMN4 ELSE 0.0 ENDIF;
tDDetSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN tDSetDetMN4 - tDMinDetSMN4 + tDSetPhytMN4 + tDMortRootPhraN4 ELSE 0.0 ENDIF;
vDeltaSMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (tDIMSMN4 / cRhoIMN4 +(tDHumSMN4 + tDDetSMN4) / cRhoOMN4)/(1.0 - bPorSN4) ELSE 0.0 ENDIF;
tDBurIMMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN ((tDHumSMN4 + tDDetSMN4) +(cRhoOMN4 / cRhoIMN4) * tDIMSMN4) / ((aDHumSMN4 + aDDetSMN4) / aDIMSMN4 + cRhoOMN4 / cRhoIMN4) ELSE ((tDHumSMN4 + tDDetSMN4) +(cRhoOMN4 / cRhoIMN4) * tDIMSMN4) / (fDOrgSoilN4 /(1.0 - fDOrgSoilN4) + cRhoOMN4 / cRhoIMN4) ENDIF;
tDBurOMMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN (aDHumSMN4 + aDDetSMN4) / aDIMSMN4 * tDBurIMMN4 ELSE fDOrgSoilN4 /(1.0 - fDOrgSoilN4) * tDBurIMMN4 ENDIF;
tDBurDetMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN aDDetSMN4 /(aDHumSMN4 + aDDetSMN4) * tDBurOMMN4 ELSE 0.0 ENDIF;
tDBurHumMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN tDBurOMMN4 - tDBurDetMN4 ELSE tDBurOMMN4 ENDIF;
tDBurTotMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN tDBurIMMN4 + tDBurOMMN4 ELSE tDBurIMMN4 + tDBurOMMN4 ENDIF;
tPBurHumMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN rPDHumSMN4 * tDBurHumMN4 ELSE cPDSoilOMN4 * tDBurHumMN4 ENDIF;
tPBurDetMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN rPDDetSMN4 * tDBurDetMN4 ELSE 0.0 ENDIF;
tPBurAIMMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN aPAIMSMN4 / aDIMSMN4 * tDBurIMMN4 ELSE 0.0 ENDIF;
tPBurPO4MN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN aPO4SMN4 *(vDeltaSMN4 / cDepthSMN4) ELSE cPO4GroundN4 *(bPorSMN4 * vDeltaSMN4) ENDIF;
tPBurTotMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN tPBurDetMN4 + tPBurHumMN4 + tPBurAIMMN4 + tPBurPO4MN4 ELSE tPBurHumMN4 + tPBurAIMMN4 + tPBurPO4MN4 ENDIF;
tNBurHumMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN rNDHumSMN4 * tDBurHumMN4 ELSE cNDSoilOMN4 * tDBurHumMN4 ENDIF;
tNBurDetMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN rNDDetSMN4 * tDBurDetMN4 ELSE 0.0 ENDIF;
tNBurNH4MN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN aNH4SMN4 *(vDeltaSMN4 / cDepthSMN4) ELSE cNH4GroundN4 *(bPorSMN4 * vDeltaSMN4) ENDIF;
tNBurNO3MN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN aNO3SMN4 *(vDeltaSMN4 / cDepthSMN4) ELSE cNO3GroundN4 *(bPorSMN4 * vDeltaSMN4) ENDIF;
tNBurTotMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN tNBurDetMN4 + tNBurHumMN4 + tNBurNH4MN4 + tNBurNO3MN4 ELSE tNBurHumMN4 + tNBurNH4MN4 + tNBurNO3MN4 ENDIF;
tSiBurDetMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN rSiDDetSMN4 * tDBurDetMN4 ELSE 0.0 ENDIF;
tSiBurTotMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (vDeltaSMN4 GE 0.0) THEN tSiBurDetMN4 ELSE 0.0 ENDIF;
vDeltaWMN4 = IF (FALSE EQ InclMarshN4 OR fMarshN4 LE NearZeroN4) THEN 0.0 ELSEIF (ConstDepthN4 EQ TRUE) THEN 0.0 ELSE - vDeltaSMN4 ENDIF;
aRelDeltaWMN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN vDeltaWMN4 / uDepthWMN4 ELSE 0.0 ENDIF;
bTimeDredN4 = IF (sTimeN4 GE cDredStartN4 * DaysPerYearN4) THEN (FLOOR(TimeYearsN4/cDredIntervalN4) * cDredIntervalN4) * DaysPerYearN4 ELSE -9999.999 ENDIF;
bRhoSolidSoilN4 = fDOrgSoilN4 * cRhoOMN4 +(1.0 - fDOrgSoilN4) * cRhoIMN4;
tDMarsTotTN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (- tDBurTotMN4 - wDMinDetWMN4 * uDepthWMN4 -(1.0 - fRefrDetSN4) * tDMinDetSMN4 - tDMinHumSMN4 + tDProdPhraN4 - tDRespShootPhraN4 - tDRespRootPhraN4 - tDManShootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
tPMarsTotTN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (- tPInfPO4SMN4 + tPSeepPO4SMN4 - tPDifGroundPO4MN4 - tPBurTotMN4 - tPChemPO4MN4 - tPManShootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
tNMarsTotTN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN (- tNInfNH4SMN4 + tNSeepNH4SMN4 - tNInfNO3SMN4 + tNSeepNO3SMN4 - tNDifGroundNO3MN4 - tNDifGroundNH4MN4 - tNBurTotMN4 - wNDenitWMN4 * uDepthWMN4 - tNDenitSMN4 - tNManShootPhraN4) * fMarshN4 ELSE 0.0 ENDIF;
tSiMarsTotTN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN - tSiBurDetMN4 * fMarshN4 - tInfSiO2WMN4 + tSeepSiO2WMN4 ELSE 0.0 ENDIF;
uTauSubstEpiN4 = 1.0 / (ukOutEpiN4+NearZeroN4);
akExchMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN kExchMaxMN4 * hfMarshN4 /(hfMarshN4 + fMarshN4)  ELSE 0.0 ENDIF;
afVolMarshEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN fMarshN4 * uDepthWMN4 / uDepthWEpiN4 ELSE 0.0 ENDIF;
akExchLEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 * afVolMarshEpiN4 ELSE 0.0 ENDIF;
oPPhytWEpiN4 = oPDiatWEpiN4 + oPGrenWEpiN4 + oPBlueWEpiN4;
oNPhytWEpiN4 = oNDiatWEpiN4 + oNGrenWEpiN4 + oNBlueWEpiN4;
oDSestWEpiN4 = oDOMWEpiN4 + oDIMWEpiN4;
oPOMWEpiN4 = oPPhytWEpiN4 + oPDetWEpiN4;
oPSestWEpiN4 = oPPhytWEpiN4 + oPDetWEpiN4 + oPAIMWEpiN4;
oPInorgWEpiN4 = oPO4WEpiN4 + oPAIMWEpiN4;
oPTotWEpiN4 = oPSestWEpiN4 + oPO4WEpiN4;
oNOMWEpiN4 = oNPhytWEpiN4 + oNDetWEpiN4;
oNSestWEpiN4 = oNOMWEpiN4;
oNkjWEpiN4 = oNSestWEpiN4 + oNH4WEpiN4;
oNTotWEpiN4 = oNkjWEpiN4 + oNO3WEpiN4;
rPDIMWEpiN4 = oPAIMWEpiN4 / oDIMWEpiN4;
rPDDetWEpiN4 = oPDetWEpiN4 / (oDDetWEpiN4+NearZeroN4);
rNDDetWEpiN4 = oNDetWEpiN4 / (oDDetWEpiN4+NearZeroN4);
rSiDDetWEpiN4 = oSiDetWEpiN4 / (oDDetWEpiN4+NearZeroN4);
wDDilIMEpiN4 = ukOutEpiN4 * oDIMWEpiN4;
wDDilDetEpiN4 = ukOutEpiN4 * oDDetWEpiN4;
wDDilDiatEpiN4 = ukOutEpiN4 * oDDiatWEpiN4;
wDDilGrenEpiN4 = ukOutEpiN4 * oDGrenWEpiN4;
wDDilBlueEpiN4 = ukOutEpiN4 * oDBlueWEpiN4;
wDDilPhytEpiN4 = wDDilDiatEpiN4 + wDDilGrenEpiN4 + wDDilBlueEpiN4;
wDDilZooEpiN4 = ukOutEpiN4 * oDZooEpiN4;
wPDilZooEpiN4 = ukOutEpiN4 * oPZooEpiN4;
wNDilZooEpiN4 = ukOutEpiN4 * oNZooEpiN4;
wPDilPO4EpiN4 = ukOutEpiN4 * oPO4WEpiN4;
wPDilDetEpiN4 = ukOutEpiN4*oPDetWEpiN4;
wPDilAIMEpiN4 = ukOutEpiN4 * oPAIMWEpiN4;
wNDilNH4EpiN4 = ukOutEpiN4 * oNH4WEpiN4;
wNDilNO3EpiN4 = ukOutEpiN4 * oNO3WEpiN4;
wNDilDetEpiN4 = ukOutEpiN4 * oNDetWEpiN4;
uO2LoadEpiN4 = IF (ReadTranFracN4 EQ TRUE) THEN mO2LoadEpiN4 ELSE cO2InN4 * uQInEpiN4 / mmPermN4 ENDIF;
wO2OutflEpiN4 = ukOutEpiN4 * oO2WEpiN4;
wPDilDiatEpiN4 = ukOutEpiN4 * oPDiatWEpiN4;
wNDilDiatEpiN4 = ukOutEpiN4 * oNDiatWEpiN4;
wPDilGrenEpiN4 = ukOutEpiN4 * oPGrenWEpiN4;
wNDilGrenEpiN4 = ukOutEpiN4 * oNGrenWEpiN4;
wPDilBlueEpiN4 = ukOutEpiN4 * oPBlueWEpiN4;
wNDilBlueEpiN4 = ukOutEpiN4 * oNBlueWEpiN4;
wPDilPhytEpiN4 = wPDilDiatEpiN4 + wPDilGrenEpiN4 + wPDilBlueEpiN4;
wNDilPhytEpiN4 = wNDilDiatEpiN4 + wNDilGrenEpiN4 + wNDilBlueEpiN4;
wDOutflTotEpiN4 = ukOutEpiN4 * oDSestWEpiN4;
wPOutflTotEpiN4 = ukOutEpiN4 * oPTotWEpiN4;
wNOutflTotEpiN4 = ukOutEpiN4 * oNTotWEpiN4;
wSiDilSiO2EpiN4 = ukOutEpiN4 * oSiO2WEpiN4;
wSiDilDetEpiN4 = ukOutEpiN4 * oSiDetWEpiN4;
wSiDilDiatEpiN4 = cSiDDiatN4 * wDDilDiatEpiN4;
wSiOutflTotEpiN4 = ukOutEpiN4 * (oSiO2WEpiN4 + oSiDetWEpiN4 + cSiDDiatN4 * oDDiatWEpiN4);
wDDilTotEpiN4 = wDDilIMEpiN4 + wDDilDetEpiN4 + wDDilPhytEpiN4;
wPDilTotEpiN4 = wPDilDetEpiN4 + wPDilPO4EpiN4 + wPDilAIMEpiN4 + wPDilPhytEpiN4;
wNDilTotEpiN4 = wNDilDetEpiN4 + wNDilNO3EpiN4 + wNDilNH4EpiN4 + wNDilPhytEpiN4;
wSiDilTotEpiN4 = wSiDilDetEpiN4 + wSiDilSiO2EpiN4 + wSiDilDiatEpiN4;
tSiTranTotTEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadEpiN4 - wSiDilTotEpiN4 * uDepthWEpiN4 ENDIF;
tDTranTotTEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadEpiN4 - wDDilTotEpiN4 * uDepthWEpiN4 ENDIF;
tPTranTotTEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadEpiN4 - wPDilTotEpiN4 * uDepthWEpiN4 ENDIF;
tNTranTotTEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadEpiN4 - wNDilTotEpiN4 * uDepthWEpiN4 ENDIF;
wDExchIMMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDIMWEpiN4 - oDIMWMN4) ELSE 0.0 ENDIF;
wPExchPO4MEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPO4WEpiN4 - oPO4WMN4) ELSE 0.0 ENDIF;
wPExchAIMMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPAIMWEpiN4 - oPAIMWMN4) ELSE 0.0 ENDIF;
wNExchNH4MEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNH4WEpiN4 - oNH4WMN4) ELSE 0.0 ENDIF;
wNExchNO3MEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNO3WEpiN4 - oNO3WMN4) ELSE 0.0 ENDIF;
wSiExchSiO2MEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oSiO2WEpiN4 - oSiO2WMN4) ELSE 0.0 ENDIF;
wO2ExchMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oO2WEpiN4 - oO2WMN4) ELSE 0.0 ENDIF;
wDExchDetMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDDetWEpiN4 - oDDetWMN4) ELSE 0.0 ENDIF;
wPExchDetMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPDetWEpiN4 - oPDetWMN4) ELSE 0.0 ENDIF;
wNExchDetMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNDetWEpiN4 - oNDetWMN4) ELSE 0.0 ENDIF;
wSiExchDetMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oSiDetWEpiN4 - oSiDetWMN4) ELSE 0.0 ENDIF;
wDExchDiatMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDDiatWEpiN4 - oDDiatWMN4) ELSE 0.0 ENDIF;
wPExchDiatMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPDiatWEpiN4 - oPDiatWMN4) ELSE 0.0 ENDIF;
wNExchDiatMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNDiatWEpiN4 - oNDiatWMN4) ELSE 0.0 ENDIF;
wSiExchDiatMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cSiDDiatN4 * wDExchDiatMEpiN4 ELSE 0.0 ENDIF;
wDExchGrenMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDGrenWEpiN4 - oDGrenWMN4) ELSE 0.0 ENDIF;
wPExchGrenMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPGrenWEpiN4 - oPGrenWMN4) ELSE 0.0 ENDIF;
wNExchGrenMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNGrenWEpiN4 - oNGrenWMN4) ELSE 0.0 ENDIF;
wDExchBlueMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDBlueWEpiN4 - oDBlueWMN4) ELSE 0.0 ENDIF;
wPExchBlueMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPBlueWEpiN4 - oPBlueWMN4) ELSE 0.0 ENDIF;
wNExchBlueMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNBlueWEpiN4 - oNBlueWMN4) ELSE 0.0 ENDIF;
wDExchZooMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oDZooEpiN4 - oDZooMN4) ELSE 0.0 ENDIF;
wPExchZooMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oPZooEpiN4 - oPZooMN4) ELSE 0.0 ENDIF;
wNExchZooMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchMEpiN4 *(oNZooEpiN4 - oNZooMN4) ELSE 0.0 ENDIF;
wDExchIMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDIMWEpiN4 - oDIMWMN4) ELSE 0.0 ENDIF;
wPExchPO4EpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPO4WEpiN4 - oPO4WMN4) ELSE 0.0 ENDIF;
wPExchAIMEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPAIMWEpiN4 - oPAIMWMN4) ELSE 0.0 ENDIF;
wNExchNH4EpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNH4WEpiN4 - oNH4WMN4) ELSE 0.0 ENDIF;
wNExchNO3EpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNO3WEpiN4 - oNO3WMN4) ELSE 0.0 ENDIF;
wSiExchSiO2EpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oSiO2WEpiN4 - oSiO2WMN4) ELSE 0.0 ENDIF;
wO2ExchEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oO2WEpiN4 - oO2WMN4) ELSE 0.0 ENDIF;
wDExchDetEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDDetWEpiN4 - oDDetWMN4) ELSE 0.0 ENDIF;
wPExchDetEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPDetWEpiN4 - oPDetWMN4) ELSE 0.0 ENDIF;
wNExchDetEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNDetWEpiN4 - oNDetWMN4) ELSE 0.0 ENDIF;
wSiExchDetEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oSiDetWEpiN4 - oSiDetWMN4) ELSE 0.0 ENDIF;
wDExchDiatEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDDiatWEpiN4 - oDDiatWMN4) ELSE 0.0 ENDIF;
wPExchDiatEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPDiatWEpiN4 - oPDiatWMN4) ELSE 0.0 ENDIF;
wNExchDiatEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNDiatWEpiN4 - oNDiatWMN4) ELSE 0.0 ENDIF;
wSiExchDiatEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN cSiDDiatN4 * wDExchDiatEpiN4 ELSE 0.0 ENDIF;
wDExchGrenEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDGrenWEpiN4 - oDGrenWMN4) ELSE 0.0 ENDIF;
wPExchGrenEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPGrenWEpiN4 - oPGrenWMN4) ELSE 0.0 ENDIF;
wNExchGrenEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNGrenWEpiN4 - oNGrenWMN4) ELSE 0.0 ENDIF;
wDExchBlueEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDBlueWEpiN4 - oDBlueWMN4) ELSE 0.0 ENDIF;
wPExchBlueEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPBlueWEpiN4 - oPBlueWMN4) ELSE 0.0 ENDIF;
wNExchBlueEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNBlueWEpiN4 - oNBlueWMN4) ELSE 0.0 ENDIF;
wDExchZooEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oDZooEpiN4 - oDZooMN4) ELSE 0.0 ENDIF;
wPExchZooEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oPZooEpiN4 - oPZooMN4) ELSE 0.0 ENDIF;
wNExchZooEpiN4 = IF (InclMarshN4 EQ TRUE AND fMarshN4 GT NearZeroN4) THEN akExchLEpiN4 *(oNZooEpiN4 - oNZooMN4) ELSE 0.0 ENDIF;
tInfSiO2WEpiN4 =IF (InclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oSiO2WEpiN4 ELSE 0.0 ENDIF;
tInfO2WEpiN4 =IF (InclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oO2WEpiN4 ELSE 0.0 ENDIF;
tPInfPO4WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oPO4WEpiN4 ELSE 0.0 ENDIF;
tNInfNH4WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNH4WEpiN4 ELSE 0.0 ENDIF;
tNInfNO3WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQOutInfN4 GE 0.0) THEN uQOutInfN4 / mmPermN4 * oNO3WEpiN4 ELSE 0.0 ENDIF;
tSeepSiO2WEpiN4 =IF (InclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tSeepO2WEpiN4 =IF (InclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * 0.0 ELSE 0.0 ENDIF;
tPSeepPO4WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oPO4SN4 ELSE 0.0 ENDIF;
tNSeepNH4WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNH4SN4 ELSE 0.0 ENDIF;
tNSeepNO3WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN 0.0 ELSEIF (uQInSeepN4 GE 0.0) THEN uQInSeepN4 / mmPermN4 * oNO3SN4 ELSE 0.0 ENDIF;
tSiAbioTotTN4 = - fRefrDetSN4 * tSiMinDetSN4 - tInfSiO2WHypN4 - tInfSiO2WEpiN4 + tSeepSiO2WHypN4 + tSeepSiO2WEpiN4;
tO2AerEpiN4 = kAerN4 * uFunTmAerEpiN4 * (uO2SatEpiN4 - oO2WEpiN4) * aFunFloatAerN4 * aFunBlueSurfAerN4;
tDTurbFishIMN4 = fLutumN4 * aDIMSN4 / (fLutumN4 * aDIMSN4 + aDDetSN4) * tDTurbFishN4;
uCorVSetIMEpiN4 = (aFunTauSetIMEpiN4+ uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * POW((fLutumRefN4/fLutumN4) , (0.5)) * uFunTmSetEpiN4 * cVSetIMN4;
tDSetIMEpiN4 = uCorVSetIMEpiN4 * oDIMWEpiN4;
tPSetAIMEpiN4 = oPAIMWEpiN4 / oDIMWEpiN4 * tDSetIMEpiN4;
uCorVSetDetEpiN4 = (cVSetDetN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMEpiN4 * uFunTmSetEpiN4;
tDSetDetEpiN4 = uCorVSetDetEpiN4 * oDDetWEpiN4;
tPSetDetEpiN4 = uCorVSetDetEpiN4 * oPDetWEpiN4;
tNSetDetEpiN4 = uCorVSetDetEpiN4 * oNDetWEpiN4;
tSiSetDetEpiN4 = uCorVSetDetEpiN4 * oSiDetWEpiN4;
wDMinDetWEpiN4 = kDMinDetWN4 * uFunTmMinWEpiN4 * oDDetWEpiN4;
wPMinDetWEpiN4 = kPMinDetWN4 * uFunTmMinWEpiN4 * oPDetWEpiN4;
wNMinDetWEpiN4 = kNMinDetWN4 * uFunTmMinWEpiN4 * oNDetWEpiN4;
wSiMinDetWEpiN4 = kSiMinDetWN4 * uFunTmMinWEpiN4 * oSiDetWEpiN4;
aCorO2BODEpiN4 = oO2WEpiN4 / (hO2BODN4 + oO2WEpiN4);
wO2MinDetWEpiN4 = molO2molCN4 * cCPerDWN4 * aCorO2BODEpiN4 * wDMinDetWEpiN4;
wDDenitWEpiN4 = oNO3WEpiN4*oNO3WEpiN4 / (hNO3DenitN4*hNO3DenitN4 + oNO3WEpiN4*oNO3WEpiN4) * (1.0 - aCorO2BODEpiN4) * wDMinDetWEpiN4;
wNDenitWEpiN4 = NO3PerCN4 * molNmolCN4 * cCPerDWN4 * wDDenitWEpiN4;
aCorO2NitrWEpiN4 = oO2WEpiN4*oO2WEpiN4 / (hO2NitrN4*hO2NitrN4 + oO2WEpiN4*oO2WEpiN4);
wNNitrWEpiN4 = kNitrWN4 * uFunTmNitrEpiN4 * aCorO2NitrWEpiN4 * oNH4WEpiN4;
wO2NitrWEpiN4 = O2PerNH4N4 * molO2molNN4 * wNNitrWEpiN4;
tDMinOxyDetSN4 = afOxySedN4 * (1.0 - fRefrDetSN4) * tDMinDetSN4;
tO2MinDetSN4 = molO2molCN4 * cCPerDWN4 * tDMinOxyDetSN4;
tDDenitSN4 = oNO3SN4*oNO3SN4 / (hNO3DenitN4*hNO3DenitN4 + oNO3SN4*oNO3SN4) * (1.0 - afOxySedN4) * (1.0 - fRefrDetSN4) * tDMinDetSN4;
tNDenitSN4 = NO3PerCN4 * molNmolCN4 * cCPerDWN4 * tDDenitSN4;
tNNitrSN4 = afOxySedN4 * kNitrSN4 * uFunTmNitrSN4 * aNH4SN4;
tO2NitrSN4 = O2PerNH4N4 * molO2molNN4 * tNNitrSN4;
tDMinHumSN4 = kDMinHumN4 * uFunTmMinSN4 * afOxySedN4 * aDHumSN4;
tPMinHumSN4 = kDMinHumN4 * uFunTmMinSN4 * afOxySedN4 * aPHumSN4;
tNMinHumSN4 = kDMinHumN4 * uFunTmMinSN4 * afOxySedN4 * aNHumSN4;
tPDifPO4EpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN 0.0 ELSE kPDifPO4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oPO4SN4 - oPO4WEpiN4 ) / aDepthDifN4 ENDIF;
tNDifNO3EpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN 0.0 ELSE kNDifNO3N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oNO3SN4 - oNO3WEpiN4 ) / aDepthDifN4 ENDIF;
tNDifNH4EpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN 0.0 ELSE kNDifNH4N4 * uFunTmDifN4 * cTurbDifNutN4 * bPorCorSN4 * (oNH4SN4 - oNH4WEpiN4 ) / aDepthDifN4 ENDIF;
tO2DifEpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN 0.0 ELSE kO2DifN4 / aDepthDifN4 * uFunTmDifN4 * cTurbDifO2N4 * bPorCorSN4 * oO2WEpiN4 ENDIF;
aPAdsMaxWEpiN4 = cRelPAdsDN4 + aCorO2BODEpiN4 * cRelPAdsFeN4 * fFeDIMN4 + cRelPAdsAlN4 * fAlDIMN4;
aKPAdsWEpiN4 = (1.0 - fRedMaxN4 * (1.0-aCorO2BODEpiN4)) * cKPAdsOxN4;
aPIsoAdsWEpiN4 = aPAdsMaxWEpiN4 * aKPAdsWEpiN4 * oPO4WEpiN4 / (1.0 + aKPAdsWEpiN4 * oPO4WEpiN4);
aPEqIMWEpiN4 = aPIsoAdsWEpiN4 * oDIMWEpiN4;
wPSorpIMWEpiN4 = kPSorpN4 * (aPEqIMWEpiN4 - oPAIMWEpiN4);
aPAdsMaxSN4 = cRelPAdsDN4 + afOxySedN4 * cRelPAdsFeN4 * fFeDIMN4 + cRelPAdsAlN4 * fAlDIMN4;
aKPAdsSN4 = (1.0 - fRedMaxN4 * (1.0-afOxySedN4)) * cKPAdsOxN4;
aPIsoAdsSN4 = aPAdsMaxSN4 * aKPAdsSN4 * oPO4SN4 / (1.0 + aKPAdsSN4 * oPO4SN4);
aPEqIMSN4 = aPIsoAdsSN4 * aDIMSN4;
tPSorpIMSN4 = kPSorpN4 * (aPEqIMSN4 - aPAIMSN4);
wO2AbioWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE tO2BubHypN4 / uDepthWHypN4 - wO2MinDetWHypN4 - wO2NitrWHypN4 - (tO2MinDetSN4 + tO2NitrSN4) / uDepthWHypN4 - (tInfO2WHypN4 / uDepthWHypN4) + (tSeepO2WHypN4 / uDepthWHypN4) ENDIF;
wPAbioDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE - wPMinDetWHypN4 - (tPSetDetHypN4 - tPSetDetEpiN4 - tPResusDetN4) / uDepthWHypN4 ENDIF;
wPAbioPO4WHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wPMinDetWHypN4 - wPSorpIMWHypN4 - (tPInfPO4WHypN4 / uDepthWHypN4) + ((tPSeepPO4WHypN4 + tPDifPO4HypN4 + tPResusPO4N4) / uDepthWHypN4) ENDIF;
wPAbioAIMWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (- tPSetAIMHypN4 +tPSetAIMEpiN4 + tPResusAIMN4) / uDepthWHypN4 + wPSorpIMWHypN4 ENDIF;
tPAbioTotTN4 = uPErosOMN4 - tPChemPO4N4 - tPInfPO4SN4 + tPSeepPO4SN4 - tPDifGroundPO4N4;
wNAbioNH4WHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNMinDetWHypN4 - wNNitrWHypN4 - (tNInfNH4WHypN4 / uDepthWHypN4) + ((tNSeepNH4WHypN4 + tNDifNH4HypN4 + tNResusNH4N4) / uDepthWHypN4) ENDIF;
wNAbioNO3WHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNNitrWHypN4 - wNDenitWHypN4 + ((tNDifNO3HypN4 + tNResusNO3N4 - tNInfNO3WHypN4 + tNSeepNO3WHypN4) / uDepthWHypN4) ENDIF;
wNAbioDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE - wNMinDetWHypN4 - (tNSetDetHypN4 -tNSetDetEpiN4 - tNResusDetN4 ) / uDepthWHypN4 ENDIF;
wSiAbioSiO2WHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wSiMinDetWHypN4 + (1.0 - fRefrDetSN4) * tSiMinDetSN4 / uDepthWHypN4 - tInfSiO2WHypN4 / uDepthWHypN4 + tSeepSiO2WHypN4 / uDepthWHypN4 ENDIF;
wSiAbioDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE - wSiMinDetWHypN4 - (tSiSetDetHypN4 -tSiSetDetEpiN4 - tSiResusDetN4) / uDepthWHypN4 ENDIF;
wDAbioDetWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (- tDSetDetHypN4 + tDSetDetEpiN4 + tDResusDetN4 ) / uDepthWHypN4 - wDMinDetWHypN4 ENDIF;
wDAbioIMWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (uDErosIMWN4 * fHypErosIMN4 - tDSetIMHypN4+ tDSetIMEpiN4 + tDResusIMN4) / uDepthWHypN4 ENDIF;
wDAbioIMWEpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN (uDErosIMWN4 * (1- fHypErosIMN4) - tDSetIMEpiN4 ) / uDepthWEpiN4 ELSE (uDErosIMWN4 * (1- fHypErosIMN4) - tDSetIMEpiN4 + tDResusIMN4) / uDepthWEpiN4 ENDIF;
wDAbioDetWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN (- tDSetDetEpiN4 ) / uDepthWEpiN4 - wDMinDetWEpiN4 ELSE (- tDSetDetEpiN4 + tDResusDetN4 ) / uDepthWEpiN4 - wDMinDetWEpiN4 ENDIF;
tDAbioIMSN4 = IF ( aInclStratN4 EQ TRUE ) THEN uDErosIMSN4 + tDSetIMHypN4 - tDResusIMN4 ELSE uDErosIMSN4 + tDSetIMEpiN4 - tDResusIMN4 ENDIF ;
tDAbioDetSN4 = IF ( aInclStratN4 EQ TRUE ) THEN tDSetDetHypN4 - tDResusDetN4 - tDMinDetSN4 ELSE tDSetDetEpiN4 - tDResusDetN4 - tDMinDetSN4 ENDIF ;
tDAbioHumSN4 = uDErosOMN4 + fRefrDetSN4 * tDMinDetSN4 - tDMinHumSN4;
tDAbioTotTN4 = cDErosTotN4 - wDMinDetWEpiN4 * uDepthWEpiN4 - wDMinDetWHypN4 * uDepthWHypN4 - (1.0 - fRefrDetSN4) * tDMinDetSN4 - tDMinHumSN4;
wO2AbioWEpiN4 = IF (aInclStratN4 EQ FALSE) THEN tO2AerEpiN4 / uDepthWEpiN4 - wO2MinDetWEpiN4 - wO2NitrWEpiN4 - (tO2MinDetSN4 + tO2NitrSN4) / uDepthWEpiN4 - tInfO2WEpiN4/uDepthWEpiN4 + tSeepO2WEpiN4/uDepthWEpiN4 ELSE tO2AerEpiN4 / uDepthWEpiN4 - wO2MinDetWEpiN4 - wO2NitrWEpiN4 ENDIF;
wO2AbioMN4 = tO2AerMN4 / uDepthWMN4 - wO2MinDetWMN4 - wO2NitrWMN4 - (tO2MinDetSMN4 + tO2NitrSMN4) / uDepthWMN4  - tInfO2WMN4 /uDepthWMN4  + tSeepO2WMN4 /uDepthWMN4 ;
wPAbioDetWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN - wPMinDetWEpiN4 - (tPSetDetEpiN4 ) / uDepthWEpiN4 ELSE - wPMinDetWEpiN4 - (tPSetDetEpiN4 - tPResusDetN4) / uDepthWEpiN4 ENDIF;
wPAbioPO4WEpiN4 =IF (aInclStratN4 EQ TRUE ) THEN wPMinDetWEpiN4 - wPSorpIMWEpiN4 + (tPDifPO4EpiN4 / uDepthWEpiN4) ELSE wPMinDetWEpiN4 - wPSorpIMWEpiN4 + ((tPSeepPO4WEpiN4 - tPInfPO4WEpiN4 + tPDifPO4EpiN4 + tPResusPO4N4) / uDepthWEpiN4) ENDIF;
wPAbioAIMWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN (- tPSetAIMEpiN4 ) / uDepthWEpiN4 + wPSorpIMWEpiN4 ELSE (- tPSetAIMEpiN4 + tPResusAIMN4 ) / uDepthWEpiN4 + wPSorpIMWEpiN4 ENDIF;
tPAbioDetSN4 = IF ( aInclStratN4 EQ TRUE ) THEN - tPMinDetSN4 + tPSetDetHypN4 - tPResusDetN4 ELSE - tPMinDetSN4 + tPSetDetEpiN4 - tPResusDetN4 ENDIF ;
tPAbioHumSN4 = uPErosOMN4 + fRefrDetSN4 * tPMinDetSN4 - tPMinHumSN4;
tPAbioPO4SN4 = IF ( aInclStratN4 EQ TRUE ) THEN tPInfPO4WHypN4 - tPSeepPO4WHypN4 - tPInfPO4SN4 + tPSeepPO4SN4 + (1.0-fRefrDetSN4) * tPMinDetSN4 + tPMinHumSN4 - tPSorpIMSN4 - tPResusPO4N4 - tPDifPO4HypN4 - tPDifGroundPO4N4 - tPChemPO4N4 ELSE tPInfPO4WEpiN4 - tPSeepPO4WEpiN4 - tPInfPO4SN4 + tPSeepPO4SN4 + (1.0-fRefrDetSN4) * tPMinDetSN4 + tPMinHumSN4 - tPSorpIMSN4 - tPResusPO4N4 - tPDifPO4EpiN4 - tPDifGroundPO4N4 - tPChemPO4N4 ENDIF;
tPAbioAIMSN4 = IF ( aInclStratN4 EQ TRUE ) THEN tPSetAIMHypN4 - tPResusAIMN4 + tPSorpIMSN4 ELSE tPSetAIMEpiN4 - tPResusAIMN4 + tPSorpIMSN4 ENDIF;
wNAbioNH4WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wNMinDetWEpiN4 - wNNitrWEpiN4 + (tNDifNH4EpiN4 / uDepthWEpiN4) ELSE wNMinDetWEpiN4 - wNNitrWEpiN4 + ((tNSeepNH4WEpiN4 - tNInfNH4WEpiN4 + tNDifNH4EpiN4 + tNResusNH4N4) / uDepthWEpiN4) ENDIF;
wNAbioNO3WEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wNNitrWEpiN4 - wNDenitWEpiN4 + (tNDifNO3EpiN4 / uDepthWEpiN4) ELSE wNNitrWEpiN4 - wNDenitWEpiN4 + ((tNDifNO3EpiN4 + tNResusNO3N4 - tNInfNO3WEpiN4 + tNSeepNO3WEpiN4) / uDepthWEpiN4) ENDIF;
wNAbioDetWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN - wNMinDetWEpiN4 - (tNSetDetEpiN4) / uDepthWEpiN4 ELSE - wNMinDetWEpiN4 - (tNSetDetEpiN4 - tNResusDetN4 ) / uDepthWEpiN4 ENDIF;
tNAbioNH4SN4 = IF ( aInclStratN4 EQ TRUE ) THEN tNInfNH4WHypN4 - tNSeepNH4WHypN4 - tNInfNH4SN4 + tNSeepNH4SN4 + (1.0-fRefrDetSN4) * tNMinDetSN4 + tNMinHumSN4 - tNResusNH4N4 - tNDifNH4HypN4 - tNDifGroundNH4N4 - tNNitrSN4 ELSE tNInfNH4WEpiN4 - tNSeepNH4WEpiN4 - tNInfNH4SN4 + tNSeepNH4SN4 + (1.0-fRefrDetSN4) * tNMinDetSN4 + tNMinHumSN4 - tNResusNH4N4 - tNDifNH4EpiN4 - tNDifGroundNH4N4 - tNNitrSN4 ENDIF;
tNAbioNO3SN4 = IF ( aInclStratN4 EQ TRUE ) THEN tNInfNO3WHypN4 - tNSeepNO3WHypN4 - tNInfNO3SN4 + tNSeepNO3SN4 + tNNitrSN4 - tNDenitSN4 - tNResusNO3N4 - tNDifNO3HypN4 - tNDifGroundNO3N4 ELSE tNInfNO3WEpiN4 - tNSeepNO3WEpiN4 - tNInfNO3SN4 + tNSeepNO3SN4 + tNNitrSN4 - tNDenitSN4 - tNResusNO3N4 - tNDifNO3EpiN4 - tNDifGroundNO3N4 ENDIF;
tNAbioDetSN4 = IF ( aInclStratN4 EQ TRUE ) THEN - tNMinDetSN4 + tNSetDetHypN4 - tNResusDetN4 ELSE - tNMinDetSN4 + tNSetDetEpiN4 - tNResusDetN4 ENDIF ;
tNAbioHumSN4 = uNErosOMN4 + fRefrDetSN4 * tNMinDetSN4 - tNMinHumSN4;
tNAbioTotTN4 = uNErosOMN4 - tNDenitSN4 - wNDenitWEpiN4 * uDepthWEpiN4 - wNDenitWHypN4 * uDepthWHypN4 - tNInfNH4SN4 - tNInfNO3SN4 + tNSeepNH4SN4 + tNSeepNO3SN4 - tNDifGroundNO3N4 - tNDifGroundNH4N4;
wSiAbioSiO2WEpiN4 = IF (aInclStratN4 EQ FALSE ) THEN wSiMinDetWEpiN4 + (1.0 - fRefrDetSN4) * tSiMinDetSN4 / uDepthWEpiN4 - tInfSiO2WEpiN4 / uDepthWEpiN4 + tSeepSiO2WEpiN4 / uDepthWEpiN4 ELSE wSiMinDetWEpiN4 ENDIF;
wSiAbioDetWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN - wSiMinDetWEpiN4 - (tSiSetDetEpiN4 ) / uDepthWEpiN4 ELSE - wSiMinDetWEpiN4 - (tSiSetDetEpiN4 - tSiResusDetN4) / uDepthWEpiN4 ENDIF;
tSiAbioDetSN4 = IF ( aInclStratN4 EQ TRUE ) THEN - tSiMinDetSN4 + tSiSetDetHypN4 - tSiResusDetN4 ELSE - tSiMinDetSN4 + tSiSetDetEpiN4 - tSiResusDetN4 ENDIF;
tDProdSubVegEpiN4 = bfSubVegEpiN4 * tDProdVegEpiN4;
tDMortVegWEpiN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tDMortVegEpiN4;
tDMortVegSEpiN4 = tDMortVegEpiN4 - tDMortVegWEpiN4;
tDBedVegN4 = IF InclVegN4 EQ TRUE THEN tDMigrVegN4 + tDProdVegEpiN4 + tDProdVegHypN4- tDRespVegN4 - tDMortVegEpiN4 - tDMortVegHypN4 - tDGrazVegBirdN4 - tDManVegN4 ELSE 0.0 ENDIF;
tO2ProdVegEpiN4 = molO2molCN4 * cCPerDWN4 * tDProdVegEpiN4;
tO2RespVegWEpiN4 = molO2molCN4 * cCPerDWN4 * bfSubVegEpiN4 * tDRespVegN4 * aCorO2BODEpiN4;
tO2ProdVegSEpiN4 = MIN (tO2RespVegSN4, tO2ProdVegEpiN4);
tO2ProdVegWEpiN4 = MIN ( tO2ProdVegEpiN4 - tO2ProdVegSEpiN4, bfSubVegN4 * tO2ProdVegEpiN4) ;
tO2BedSN4 = tO2ProdVegSHypN4 + tO2ProdVegSEpiN4 - tO2RespVegSN4 + tO2UptNO3VegSN4;
tO2UptNO3VegWEpiN4 = O2PerNO3N4 * molO2molNN4 * bfSubVegN4 * tNUptNO3VegWEpiN4;
tPMortVegEpiN4 = rPDVegN4 * tDMortVegEpiN4;
tPMortVegPO4EpiN4 = fDissMortVegN4 * tPMortVegEpiN4;
tPMortVegPO4SEpiN4 = bfRootVegN4 * tPMortVegPO4EpiN4;
tPMortVegPO4WEpiN4 = tPMortVegPO4EpiN4 - tPMortVegPO4SEpiN4;
tPMortVegDetEpiN4 = tPMortVegEpiN4 - tPMortVegPO4EpiN4;
tPMortVegDetWEpiN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tPMortVegDetEpiN4;
tPMortVegDetSEpiN4 = tPMortVegDetEpiN4 - tPMortVegDetWEpiN4;
tPBedVegN4 = IF InclVegN4 EQ TRUE THEN tPMigrVegN4 + tPUptVegEpiN4 + tPUptVegHypN4 - tPExcrVegN4 - tPMortVegEpiN4 - tPMortVegHypN4 - tPGrazVegBirdN4 - tPManVegN4 ELSE 0.0 ENDIF;
tNMortVegNH4WEpiN4 = tNMortVegNH4EpiN4 - tNMortVegNH4SEpiN4;
tNMortVegDetEpiN4 = tNMortVegEpiN4 - tNMortVegNH4EpiN4;
tNMortVegDetWEpiN4 = fDetWMortVegN4 * (1.0 - bfRootVegN4) * tNMortVegDetEpiN4;
tNMortVegDetSEpiN4 = tNMortVegDetEpiN4 - tNMortVegDetWEpiN4;
tNBedVegN4 = IF InclVegN4 EQ TRUE THEN tNMigrVegN4 + tNUptVegN4 - tNExcrVegN4 - tNMortVegEpiN4 - tNMortVegHypN4 - tNGrazVegBirdN4 - tNManVegN4 ELSE 0.0 ENDIF;
wDBedDetWEpiN4 = IF (InclVegN4 EQ TRUE) THEN (tDMortVegWEpiN4 + tDEgesBirdN4) / uDepthWEpiN4 ELSE 0.0 ENDIF;
tDBedDetSEpiN4 = IF ( InclVegN4 EQ TRUE) THEN tDMortVegSEpiN4 ELSE 0.0 ENDIF;
wPBedPO4WEpiN4 = IF (InclVegN4 EQ FALSE) THEN 0.0 ELSE (- tPUptVegWEpiN4 + tPExcrVegWN4 * uVegHeightEpiN4 / uVegHeightN4 + tPMortVegPO4WEpiN4 + tPEgesBirdPO4N4) /uDepthWEpiN4 ENDIF;
wPBedDetWEpiN4 = IF (InclVegN4 EQ TRUE) THEN (tPMortVegDetWEpiN4 + tPEgesBirdDetN4) / uDepthWEpiN4 ELSE 0.0 ENDIF;
tPBedPO4SN4 = IF ( InclVegN4 EQ TRUE) THEN - tPUptVegSN4 + tPExcrVegSN4 + tPMortVegPO4SEpiN4 + tPMortVegPO4SHypN4 ELSE 0.0 ENDIF;
tPBedDetSN4 = IF (InclVegN4 EQ TRUE) THEN tPMortVegDetSEpiN4 + tPMortVegDetSHypN4 ELSE 0.0 ENDIF;
wNBedNH4WEpiN4 = IF ( InclVegN4 EQ TRUE ) THEN (- tNUptNH4VegWEpiN4 + tNExcrVegWN4 * (uVegHeightEpiN4 /uVegHeightN4 ) + tNMortVegNH4WEpiN4 + tNEgesBirdNH4N4) / uDepthWEpiN4 ELSE 0.0 ENDIF;
wNBedNO3WEpiN4 = IF ( InclVegN4 EQ TRUE) THEN - tNUptNO3VegWEpiN4 / uDepthWEpiN4 ELSE 0.0 ENDIF;
wNBedDetWEpiN4 = IF (InclVegN4 EQ TRUE) THEN (tNMortVegDetWEpiN4 + tNEgesBirdDetN4) / uDepthWEpiN4 ELSE 0.0 ENDIF;
tNBedNH4SN4 = IF ( InclVegN4 EQ TRUE) THEN - tNUptNH4VegSN4 + tNExcrVegSN4 + tNMortVegNH4SEpiN4 + tNMortVegNH4SHypN4 ELSE 0.0 ENDIF;
tNBedNO3SN4 = IF ( InclVegN4 EQ TRUE ) THEN - tNUptNO3VegSN4 ELSE 0.0 ENDIF;
tNBedDetSN4 = IF ( InclVegN4 EQ FALSE) THEN 0.0 ELSEIF (aInclStratN4 EQ TRUE) THEN tNMortVegDetSEpiN4 + tNMortVegDetSHypN4 ELSE tNMortVegDetSEpiN4 ENDIF;
tO2BedWEpiN4 = IF ( InclVegN4 EQ TRUE ) THEN tO2ProdVegWEpiN4 - tO2RespVegWEpiN4 + tO2UptNO3VegWEpiN4 ELSE 0.0 ENDIF;
rPDBlueWEpiN4 = oPBlueWEpiN4 /(oDBlueWEpiN4+NearZeroN4);
aVPUptMaxCrBlueEpiN4 = MAX(0.0,cVPUptMaxBlueN4 * uFunTmProdBlueEpiN4 *(cPDBlueMaxN4 - rPDBlueWEpiN4) /(cPDBlueMaxN4 - cPDBlueMinN4));
aVPUptBlueEpiN4 = oPO4WEpiN4 * aVPUptMaxCrBlueEpiN4 /(aVPUptMaxCrBlueEpiN4 / cAffPUptBlueN4 + oPO4WEpiN4);
wPUptBlueEpiN4 = aVPUptBlueEpiN4 * oDBlueWEpiN4;
rNDBlueWEpiN4 = oNBlueWEpiN4 /(oDBlueWEpiN4+NearZeroN4);
aVNUptMaxCrBlueEpiN4 = MAX(0.0,cVNUptMaxBlueN4 * uFunTmProdBlueEpiN4 * (cNDBlueMaxN4 - rNDBlueWEpiN4) /(cNDBlueMaxN4 - cNDBlueMinN4));
ahNUptBlueEpiN4 = aVNUptMaxCrBlueEpiN4 / cAffNUptBlueN4;
aVNUptBlueEpiN4 = oNDissWEpiN4 * aVNUptMaxCrBlueEpiN4 /(ahNUptBlueEpiN4 + oNDissWEpiN4);
wNUptBlueEpiN4 = aVNUptBlueEpiN4 * oDBlueWEpiN4;
tNUptBlueEpiN4 = wNUptBlueEpiN4 * uDepthWEpiN4;
aLLimBlueEpiN4 = UseSteeleBlueN4 *(EXP(1.0) /(aExtCoefEpiN4 * uDepthWEpiN4) *(EXP(- aLPARBotEpiN4 /(cLOptRefBlueN4 * uFunTmProdBlueEpiN4)) - EXP(- aLPARBotSurfN4 /(cLOptRefBlueN4 * uFunTmProdBlueEpiN4)))) +(1.0 - UseSteeleBlueN4) *(1.0 /(aExtCoefEpiN4 * uDepthWEpiN4) * LN((1.0 + aLPARBotSurfN4 / (hLRefBlueN4 * uFunTmProdBlueEpiN4)) / (1.0 + aLPARBotEpiN4 /(hLRefBlueN4 * uFunTmProdBlueEpiN4))));
rChDBlueEpiN4 = cChDBlueMaxN4 -(cChDBlueMaxN4 - cChDBlueMinN4) * aLLimBlueEpiN4;
aChlaBlueEpiN4 = mgPergN4 * rChDBlueEpiN4 * aDBlueWEpiN4;
aNfixBlueEpiN4 = rNfixBlueEpiN4 *aChlaBlueEpiN4 /ugPergN4;
afNH4UptBlueEpiN4 = oNH4WEpiN4 * oNO3WEpiN4 /((ahNUptBlueEpiN4 + oNH4WEpiN4) *(ahNUptBlueEpiN4 + oNO3WEpiN4)) + oNH4WEpiN4 * ahNUptBlueEpiN4 /((oNH4WEpiN4 + oNO3WEpiN4) *(ahNUptBlueEpiN4 + oNO3WEpiN4));
tNUptBlueAirEpiN4 = IF (InclNfixN4 EQ FALSE) THEN 0.0 ELSE aNfixBlueEpiN4 ENDIF;
tNUptBlueWEpiN4 = IF (InclNfixN4 EQ FALSE) THEN tNUptBlueEpiN4 ELSE tNUptBlueEpiN4 - tNUptBlueAirEpiN4 ENDIF;
wNUptBlueWEpiN4 = tNUptBlueWEpiN4 / uDepthWEpiN4;
wNUptNH4BlueEpiN4 = afNH4UptBlueEpiN4 * wNUptBlueWEpiN4;
wNUptNO3BlueEpiN4 = wNUptBlueWEpiN4 - wNUptNH4BlueEpiN4;
aPLimBlueEpiN4 = MAX(0.0,(1.0 - cPDBlueMinN4 / rPDBlueWEpiN4) * cPDBlueMaxN4 /(cPDBlueMaxN4 - cPDBlueMinN4));
aNLimBlueEpiN4 = MAX(0.0,(1.0 - cNDBlueMinN4 / rNDBlueWEpiN4) * cNDBlueMaxN4 /(cNDBlueMaxN4 - cNDBlueMinN4));
aSiLimBlueEpiN4 = oSiO2WEpiN4 /(hSiAssBlueN4 + oSiO2WEpiN4);
aMuTmLBlueEpiN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimBlueEpiN4 * uMuMaxTmBlueEpiN4;
aNutLimBlueEpiN4 = MIN(aPLimBlueEpiN4 , (MIN(aNLimBlueEpiN4,aSiLimBlueEpiN4)));
aMuBlueEpiN4 = aNutLimBlueEpiN4 * aMuTmLBlueEpiN4;
wDAssBlueEpiN4 = aMuBlueEpiN4*oDBlueWEpiN4;
oChlaBlueEpiN4 = mgPergN4 * rChDBlueEpiN4 * oDBlueWEpiN4;
aLLimBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN -9999 ELSE MAX(0.0,UseSteeleBlueN4 *(EXP(1.0) /(aExtSurfN4) *(EXP(- aLPARBotSurfN4/(cLOptRefBlueN4 *  uFunTmProdBlueSurfN4)) - EXP(- uLPARSurfN4 /(cLOptRefBlueN4 *  uFunTmProdBlueSurfN4)))) +(1.0 - UseSteeleBlueN4) *(1.0 /(aExtSurfN4) * LN((1.0 + uLPARSurfN4 / (hLRefBlueN4 * uFunTmProdBlueSurfN4)) / (1.0 + aLPARBotSurfN4 /(hLRefBlueN4 * uFunTmProdBlueSurfN4))))) ENDIF;
aRepLLimBlueN4 = (aLLimBlueSurfN4* aDBlueSurfN4 + aLLimBlueEpiN4* aDBlueWEpiN4) / (aDBlueSurfN4 + aDBlueWEpiN4);
rChDBlueSurfN4 = cChDBlueMaxN4 -(cChDBlueMaxN4 - cChDBlueMinN4) * aLLimBlueSurfN4;
aChlaBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE mgPergN4 * rChDBlueSurfN4 * aDBlueSurfN4 ENDIF;
oChlaBlueWN4 = IF ( aInclStratN4 EQ TRUE ) THEN (oChlaBlueEpiN4 * uDepthWEpiN4 + oChlaBlueHypN4 * uDepthWHypN4) / uDepthWN4 ELSE (oChlaBlueEpiN4 * uDepthWEpiN4) / uDepthWN4 ENDIF;
oChlaBlueN4 = IF ( aInclStratN4 EQ TRUE ) THEN (oChlaBlueEpiN4 * uDepthWEpiN4 + oChlaBlueHypN4 * uDepthWHypN4 + aChlaBlueSurfN4) / uDepthWN4 ELSE (oChlaBlueEpiN4 * uDepthWEpiN4 + aChlaBlueSurfN4 ) / uDepthWN4 ENDIF;
aChlaLimFloBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE (1.0 - (POW ((aChlaBlueSurfN4 / cDepthSurfN4) , (-cStepPowN4))) / ((POW (cChlaThrBlueN4 , (-cStepPowN4))) + (POW ((aChlaBlueSurfN4 / cDepthSurfN4) , (-cStepPowN4))))) ENDIF;
aChlaLimFloBlueEpiN4 = IF (InclSurfN4 EQ FALSE  OR aDBlueWEpiN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE (1.0 - (POW (oChlaBlueEpiN4 , (-cStepPowN4))) / ((POW (cChlaThrBlueN4 , (-cStepPowN4))) + (POW (oChlaBlueEpiN4 , (-cStepPowN4))))) ENDIF;
aChlaLimFloBlueHypN4 = IF (aInclStratN4 EQ FALSE OR aDBlueWHypN4 LT cDBlueSurfMinN4) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (oChlaBlueHypN4 , (-cStepPowN4))) / ((POW (cChlaThrBlueN4 , (-cStepPowN4))) + (POW (oChlaBlueHypN4 , (-cStepPowN4))))) ENDIF;
aVWLimFloBlueN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uVWindN4 , cStepPowN4)) / ((POW (cVWindThrBlueN4 , cStepPowN4)) + (POW (uVWindN4 , cStepPowN4)))) ENDIF;
aTmLimFloBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE (1.0 - (POW (uTmSurfN4 , (-cStepPowN4))) / ((POW (cTmThrBlueN4 , (-cStepPowN4))) + (POW (uTmSurfN4 , (-cStepPowN4))))) ENDIF;
aTmLimFloBlueEpiN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE (1.0 - (POW (uTmEpiN4 , (-cStepPowN4))) / ((POW (cTmThrBlueN4 , (-cStepPowN4))) + (POW (uTmEpiN4 , (-cStepPowN4))))) ENDIF;
aTmLimFloBlueHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE  (1.0 - (POW (uTmHypN4 , (-cStepPowN4))) / ((POW (cTmThrBlueN4 , (-cStepPowN4))) + (POW (uTmHypN4 , (-cStepPowN4))))) ENDIF;
aTrigFloBlueSurfN4 =  aVWLimFloBlueN4 * aTmLimFloBlueSurfN4 * aChlaLimFloBlueSurfN4;
aTrigFloBlueEpiN4 =  aVWLimFloBlueN4 * aTmLimFloBlueEpiN4 * aChlaLimFloBlueEpiN4;
aTrigFloBlueHypN4 =   aTmLimFloBlueHypN4 * aChlaLimFloBlueHypN4;
uVFloBlueSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE aTrigFloBlueSurfN4 * cVFloMaxBlueWN4 ENDIF;
uVFloBlueEpiN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueEpiN4 * cVFloMaxBlueWN4 ENDIF;
uVFloBlueHypN4 =  IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE aTrigFloBlueHypN4 * cVFloMaxBlueWN4 ENDIF;
uVBlueHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE) THEN  - uCorVSetBlueHypN4 ELSE  uVFloBlueHypN4 - uCorVSetBlueHypN4  ENDIF;
tDSetBlueHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN4 LT 0.0) THEN - uVBlueHypN4 * oDBlueWHypN4 ELSE 0.0 ENDIF;
tPSetBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDBlueWHypN4 * tDSetBlueHypN4 ENDIF;
tNSetBlueHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rNDBlueWHypN4 * tDSetBlueHypN4 ENDIF;
tDFloBlueHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSEIF (uVBlueHypN4 GE 0.0) THEN uVBlueHypN4 * oDBlueWHypN4 ELSE 0.0 ENDIF;
tPFloBlueHypN4 =  tDFloBlueHypN4  * rPDBlueWHypN4;
tNFloBlueHypN4 =  tDFloBlueHypN4  * rNDBlueWHypN4;
uVBlueEpiN4 = IF (InclSurfN4 EQ TRUE) THEN uVFloBlueEpiN4 - uCorVSetBlueEpiN4 ELSE - uCorVSetBlueEpiN4 ENDIF;
tDSetBlueEpiN4 = IF (uVBlueEpiN4 LT 0.0) THEN - uVBlueEpiN4 * oDBlueWEpiN4 ELSE 0.0 ENDIF;
tDFloBlueEpiN4 = IF (uVBlueEpiN4 GE 0.0) THEN uVBlueEpiN4 * oDBlueWEpiN4 ELSE 0.0 ENDIF;
tNSetBlueEpiN4 = rNDBlueWEpiN4 * tDSetBlueEpiN4;
tNFloBlueEpiN4 =  tDFloBlueEpiN4  * rNDBlueWEpiN4;
tPSetBlueEpiN4 = rPDBlueWEpiN4 * tDSetBlueEpiN4;
tPFloBlueEpiN4 =  tDFloBlueEpiN4  * rPDBlueWEpiN4;
aFunTauSetOMSurfN4 =MIN(1.0 / POW(aFunDimSuspN4 +NearZeroN4 , (0.5)), 1.0);
uFunTmSetSurfN4 = POW(cThetaSetN4 , (uTmSurfN4-cTmRefN4));
uCorVSetBlueSurfN4 = (cVSetBlueN4 + uQOutInfN4 /mmPermN4 - uQInSeepN4 / mmPermN4) * aFunTauSetOMSurfN4 * uFunTmSetSurfN4;
uVBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN - uCorVSetBlueSurfN4 ELSE uVFloBlueSurfN4 - uCorVSetBlueSurfN4 ENDIF;
tDSetBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSEIF (uVBlueSurfN4 LT 0.0) THEN aDBlueSurfN4  / cDepthSurfN4 * (- uVBlueSurfN4) ELSE 0.0 ENDIF;
rNDBlueSurfN4 = aNBlueSurfN4 / (aDBlueSurfN4 + NearZeroN4);
tNSetBlueSurfN4 = rNDBlueSurfN4 * tDSetBlueSurfN4;
rPDBlueSurfN4 = aPBlueSurfN4 / (aDBlueSurfN4 + NearZeroN4);
tPSetBlueSurfN4 = rPDBlueSurfN4 * tDSetBlueSurfN4;
rPDGrenWHypN4 = oPGrenWHypN4 /(oDGrenWHypN4+NearZeroN4);
aVPUptMaxCrGrenHypN4 = MAX(0.0,cVPUptMaxGrenN4 * uFunTmProdGrenHypN4 *(cPDGrenMaxN4 - rPDGrenWHypN4) /(cPDGrenMaxN4 - cPDGrenMinN4));
aVPUptGrenHypN4 = oPO4WHypN4 * aVPUptMaxCrGrenHypN4 /(aVPUptMaxCrGrenHypN4 / cAffPUptGrenN4 + oPO4WHypN4);
wPUptGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aVPUptGrenHypN4 * oDGrenWHypN4 ENDIF;
wPUptPhytHypN4 = wPUptDiatHypN4 + wPUptGrenHypN4 + wPUptBlueHypN4;
wPExcrGrenWHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE (2.0 *rPDGrenWHypN4) /(cPDGrenMaxN4 + rPDGrenWHypN4) * rPDGrenWHypN4 * wDRespGrenWHypN4 ENDIF;
wPExcrPhytWHypN4 = wPExcrDiatWHypN4 + wPExcrGrenWHypN4 + wPExcrBlueWHypN4;
aPLimGrenHypN4 = MAX(0.0,(1.0 - cPDGrenMinN4 / rPDGrenWHypN4) * cPDGrenMaxN4 /(cPDGrenMaxN4 - cPDGrenMinN4));
aNutLimGrenHypN4 = MIN(aPLimGrenHypN4,(MIN(aNLimGrenHypN4,aSiLimGrenHypN4)));
aMuGrenHypN4 = aNutLimGrenHypN4 * aMuTmLGrenHypN4;
wDAssGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE aMuGrenHypN4*oDGrenWHypN4 ENDIF;
wDPrimGrenWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wDAssGrenHypN4 - wDRespGrenWHypN4 - wDLossGrenHypN4 - wDMortGrenWHypN4 -(tDSetGrenHypN4 -tDSetGrenEpiN4 - tDResusGrenN4) / uDepthWHypN4 ENDIF;
wDAssPhytHypN4 = wDAssDiatHypN4 + wDAssGrenHypN4 + wDAssBlueHypN4;
wO2ProdPhytHypN4 = molO2molCN4 * cCPerDWN4 * wDAssPhytHypN4;
wO2PrimWHypN4 = wO2ProdPhytHypN4 - wO2RespPhytWHypN4 + wO2UptNO3PhytHypN4;
wPLossGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN4 * wDLossGrenHypN4 ENDIF;
wPLossPhytHypN4 = wPLossDiatHypN4 + wPLossGrenHypN4 + wPLossBlueHypN4;
wPLossPhytPO4HypN4 = fDissLossN4 * wPLossPhytHypN4;
wPLossPhytDetHypN4 = wPLossPhytHypN4 - wPLossPhytPO4HypN4;
wPPrimDetWHypN4 = wPLossPhytDetHypN4 + wPMortPhytDetWHypN4;
wPPrimPO4WHypN4 = - wPUptPhytHypN4 + wPExcrPhytWHypN4 + wPLossPhytPO4HypN4 + wPMortPhytPO4WHypN4;
tPSetGrenHypN4 =IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE rPDGrenWHypN4 * tDSetGrenHypN4 ENDIF;
wPPrimGrenWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wPUptGrenHypN4 - wPExcrGrenWHypN4 - wPLossGrenHypN4 - wPMortGrenWHypN4 -(tPSetGrenHypN4 -tPSetGrenEpiN4 - tPResusGrenN4) / uDepthWHypN4 ENDIF;
wPConsGrenZooHypN4 = rPDGrenWHypN4 * wDConsGrenZooHypN4;
wPConsPhytZooHypN4 = wPConsDiatZooHypN4 + wPConsGrenZooHypN4 + wPConsBlueZooHypN4;
wPConsZooHypN4 = wPConsPhytZooHypN4 + wPConsDetZooHypN4;
wPAssZooHypN4 = afPAssZooHypN4 * wPConsZooHypN4;
wPEgesZooHypN4 = wPConsZooHypN4 - wPAssZooHypN4;
wPEgesZooPO4HypN4 = fDissEgesZooN4*wPEgesZooHypN4;
wPEgesZooDetHypN4 = wPEgesZooHypN4 - wPEgesZooPO4HypN4;
aPConsZooSpHypN4 = wPConsZooHypN4 / oPZooHypN4;
aPGrazSpHypN4 = wPConsZooHypN4 / oPOMWHypN4;
wDPrimBlueWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wDAssBlueHypN4 - wDRespBlueWHypN4 - wDLossBlueHypN4 - wDMortBlueWHypN4 + (tDResusBlueN4 + tDSetBlueEpiN4 - tDSetBlueHypN4 - tDFloBlueHypN4) / uDepthWHypN4 ENDIF;
wPPrimBlueWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wPUptBlueHypN4 - wPExcrBlueWHypN4 - wPLossBlueHypN4 - wPMortBlueWHypN4+ (tPResusBlueN4 + tPSetBlueEpiN4 - tPSetBlueHypN4 - tPFloBlueHypN4) / uDepthWHypN4 ENDIF;
wNPrimBlueWHypN4 = IF (aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNUptBlueHypN4 - wNExcrBlueWHypN4 - wNLossBlueHypN4 - wNMortBlueWHypN4+ (tNResusBlueN4 + tNSetBlueEpiN4 - tNSetBlueHypN4 - tNFloBlueHypN4) / uDepthWHypN4 ENDIF;
tDSetPhytHypN4 = tDSetDiatHypN4 + tDSetGrenHypN4 + tDSetBlueHypN4;
wDPrimPhytWHypN4 = wDPrimDiatWHypN4 + wDPrimGrenWHypN4 + wDPrimBlueWHypN4;
tPSetPhytHypN4 = tPSetDiatHypN4 + tPSetGrenHypN4 + tPSetBlueHypN4;
wPPrimPhytWHypN4 = wPPrimDiatWHypN4 + wPPrimGrenWHypN4 + wPPrimBlueWHypN4;
tNSetPhytHypN4 = tNSetDiatHypN4 + tNSetGrenHypN4 + tNSetBlueHypN4;
wNPrimPhytWHypN4 = wNPrimDiatWHypN4 + wNPrimGrenWHypN4 + wNPrimBlueWHypN4;
tDSetTotHypN4 = tDSetIMHypN4 + tDSetDetHypN4 + tDSetPhytHypN4;
tPSetTotHypN4 = tPSetAIMHypN4 + tPSetDetHypN4 + tPSetPhytHypN4;
tNSetTotHypN4 = tNSetDetHypN4 + tNSetPhytHypN4;
aLLimGrenEpiN4 = UseSteeleGrenN4 *(EXP(1.0) /(aExtCoefEpiN4 * uDepthWEpiN4) *(EXP(- aLPARBotEpiN4 /(cLOptRefGrenN4 * uFunTmProdGrenEpiN4)) - EXP(- aLPARBotSurfN4 /(cLOptRefGrenN4 * uFunTmProdGrenEpiN4)))) +(1.0 - UseSteeleGrenN4) *(1.0 /(aExtCoefEpiN4 * uDepthWEpiN4) * LN((1.0 + aLPARBotSurfN4 / (hLRefGrenN4 * uFunTmProdGrenEpiN4)) / (1.0 + aLPARBotEpiN4 /(hLRefGrenN4 * uFunTmProdGrenEpiN4))));
rChDGrenEpiN4 = cChDGrenMaxN4 -(cChDGrenMaxN4 - cChDGrenMinN4) * aLLimGrenEpiN4;
oChlaGrenEpiN4 = mgPergN4 * rChDGrenEpiN4 * oDGrenWEpiN4;
aLLimDiatEpiN4 = UseSteeleDiatN4 *(EXP(1.0) /(aExtCoefEpiN4 * uDepthWEpiN4) *(EXP(- aLPARBotEpiN4 /(cLOptRefDiatN4 * uFunTmProdDiatEpiN4)) - EXP(- aLPARBotSurfN4 /(cLOptRefDiatN4 * uFunTmProdDiatEpiN4)))) +(1.0 - UseSteeleDiatN4) *(1.0 /(aExtCoefEpiN4 * uDepthWEpiN4) * LN((1.0 + aLPARBotSurfN4 / (hLRefDiatN4 * uFunTmProdDiatEpiN4)) / (1.0 + aLPARBotEpiN4 /(hLRefDiatN4 * uFunTmProdDiatEpiN4))));
rChDDiatEpiN4 = cChDDiatMaxN4 -(cChDDiatMaxN4 - cChDDiatMinN4) * aLLimDiatEpiN4;
oChlaDiatEpiN4 = mgPergN4 * rChDDiatEpiN4 * oDDiatWEpiN4;
oChlaEpiN4 = oChlaDiatEpiN4 + oChlaGrenEpiN4 + oChlaBlueEpiN4;
wDRespBlueWEpiN4 = ukDRespTmBlueEpiN4 * oDBlueWEpiN4;
wDLossBlueEpiN4 = ukLossTmBlueEpiN4 * oDBlueWEpiN4;
wDMortBlueWEpiN4 = kMortBlueWN4 * oDBlueWEpiN4;
ukDDecBlueEpiN4 = ukDRespTmBlueEpiN4 + ukLossTmBlueEpiN4 + kMortBlueWN4 +(uCorVSetBlueEpiN4 * uFunTmSetEpiN4) / uDepthWEpiN4;
wPExcrBlueWEpiN4 = (rPDBlueWEpiN4 * 2.0 )/(cPDBlueMaxN4 + rPDBlueWEpiN4) * rPDBlueWEpiN4 * wDRespBlueWEpiN4 ;
wPLossBlueEpiN4 = rPDBlueWEpiN4 * wDLossBlueEpiN4;
wPMortBlueWEpiN4 = kMortBlueWN4 * oPBlueWEpiN4;
wNExcrBlueWEpiN4 = (rNDBlueWEpiN4 *2.0)/(cNDBlueMaxN4 + rNDBlueWEpiN4) * rNDBlueWEpiN4 * wDRespBlueWEpiN4 ;
wNLossBlueEpiN4 = rNDBlueWEpiN4 * wDLossBlueEpiN4;
wNMortBlueWEpiN4 = kMortBlueWN4 * oNBlueWEpiN4;
wDPrimBlueWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wDAssBlueEpiN4 - wDRespBlueWEpiN4 - wDLossBlueEpiN4 - wDMortBlueWEpiN4 + (tDSetBlueSurfN4-tDFloBlueEpiN4 + tDFloBlueHypN4- tDSetBlueEpiN4 ) / uDepthWEpiN4 ELSE wDAssBlueEpiN4 - wDRespBlueWEpiN4 - wDLossBlueEpiN4 - wDMortBlueWEpiN4 + (tDResusBlueN4 + tDSetBlueSurfN4 - tDSetBlueEpiN4 -  tDFloBlueEpiN4) / uDepthWEpiN4 ENDIF;
wPPrimBlueWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wPUptBlueEpiN4 - wPExcrBlueWEpiN4 - wPLossBlueEpiN4 - wPMortBlueWEpiN4+ (tPSetBlueSurfN4-tPFloBlueEpiN4 + tPFloBlueHypN4- tPSetBlueEpiN4 ) / uDepthWEpiN4 ELSE wPUptBlueEpiN4 - wPExcrBlueWEpiN4 - wPLossBlueEpiN4 - wPMortBlueWEpiN4+ (tPResusBlueN4 + tPSetBlueSurfN4 - tPSetBlueEpiN4 -  tPFloBlueEpiN4) / uDepthWEpiN4 ENDIF;
wNPrimBlueWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wNUptBlueEpiN4 - wNExcrBlueWEpiN4 - wNLossBlueEpiN4 - wNMortBlueWEpiN4 + (tNSetBlueSurfN4-tNFloBlueEpiN4 + tNFloBlueHypN4- tNSetBlueEpiN4 ) / uDepthWEpiN4 ELSE wNUptBlueEpiN4 - wNExcrBlueWEpiN4 - wNLossBlueEpiN4 - wNMortBlueWEpiN4+ (tNResusBlueN4 + tNSetBlueSurfN4 - tNSetBlueEpiN4 -  tNFloBlueEpiN4) / uDepthWEpiN4 ENDIF;
ukDilSurfN4 = ukOutEpiN4;
tDDilBlueSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE ukDilSurfN4 * aDBlueSurfN4 ENDIF;
tNDilBlueSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE ukDilSurfN4 * aNBlueSurfN4 ENDIF;
tPDilBlueSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE ukDilSurfN4 * aPBlueSurfN4 ENDIF;
tDTranBlueSurfN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE uDLoadBlueSurfN4 - tDDilBlueSurfN4 ENDIF;
tPTranBlueSurfN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE uPLoadBlueSurfN4 - tPDilBlueSurfN4 ENDIF;
tNTranBlueSurfN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSEIF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE uNLoadBlueSurfN4 - tNDilBlueSurfN4 ENDIF;
uMuMaxTmBlueSurfN4 = cMuMaxBlueN4 * uFunTmProdBlueSurfN4;
aMuTmLBlueSurfN4 = ufDayN4 * aLLimBlueSurfN4 * uMuMaxTmBlueSurfN4;
aPLimBlueSurfN4 = MAX(0.0,(1.0 - cPDBlueMinN4 / rPDBlueSurfN4) * cPDBlueMaxN4 /(cPDBlueMaxN4 - cPDBlueMinN4));
aNLimBlueSurfN4 = MAX(0.0,(1.0 - cNDBlueMinN4 / rNDBlueSurfN4) * cNDBlueMaxN4 /(cNDBlueMaxN4 - cNDBlueMinN4));
aSiLimBlueSurfN4 = oSiO2WEpiN4 /(hSiAssBlueN4 + oSiO2WEpiN4);
aNutLimBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN -9999 ELSE MIN(aPLimBlueSurfN4,MIN(aNLimBlueSurfN4,aSiLimBlueSurfN4)) ENDIF;
aRepPLimBlueN4 = (aPLimBlueSurfN4* aDBlueSurfN4 + aPLimBlueEpiN4* aDBlueWEpiN4) / (aDBlueSurfN4 + aDBlueWEpiN4);
aRepNLimBlueN4 = (aNLimBlueSurfN4* aDBlueSurfN4 + aNLimBlueEpiN4* aDBlueWEpiN4) / (aDBlueSurfN4 + aDBlueWEpiN4);
aRepNutLimBlueN4 = (aNutLimBlueSurfN4* aDBlueSurfN4 + aNutLimBlueEpiN4* aDBlueWEpiN4) / (aDBlueSurfN4 + aDBlueWEpiN4);
aMuBlueSurfN4 = aNutLimBlueSurfN4 * aMuTmLBlueSurfN4;
tDAssBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE aMuBlueSurfN4 * aDBlueSurfN4 ENDIF;
aVNUptMaxCrBlueSurfN4 = MAX(0.0,cVNUptMaxBlueN4 * uFunTmProdBlueSurfN4 * (cNDBlueMaxN4 - rNDBlueSurfN4) /(cNDBlueMaxN4 - cNDBlueMinN4));
aVPUptMaxCrBlueSurfN4 = MAX(0.0,cVPUptMaxBlueN4 * uFunTmProdBlueSurfN4 *(cPDBlueMaxN4 - rPDBlueSurfN4) /(cPDBlueMaxN4 - cPDBlueMinN4));
ahNUptBlueSurfN4 = aVNUptMaxCrBlueSurfN4 / cAffNUptBlueN4;
aVNUptBlueSurfN4 = oNDissWEpiN4 * aVNUptMaxCrBlueSurfN4 /(ahNUptBlueSurfN4 + oNDissWEpiN4);
aVPUptBlueSurfN4 = oPO4WEpiN4 * aVPUptMaxCrBlueSurfN4 /(aVPUptMaxCrBlueSurfN4 / cAffPUptBlueN4 + oPO4WEpiN4);
tNUptBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE aVNUptBlueSurfN4 * aDBlueSurfN4 ENDIF;
aNfixBlueSurfN4 = rNfixBlueSurfN4 *aChlaBlueSurfN4 /ugPergN4;
tNUptBlueAirSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSEIF (InclNfixN4 EQ FALSE) THEN 0.0 ELSE aNfixBlueSurfN4 ENDIF;
tNUptBlueWSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSEIF (InclNfixN4 EQ FALSE) THEN tNUptBlueSurfN4 ELSE tNUptBlueSurfN4 - tNUptBlueAirSurfN4 ENDIF;
afNH4UptBlueSurfN4 = oNH4WEpiN4 * oNO3WEpiN4 /((ahNUptBlueSurfN4 + oNH4WEpiN4) *(ahNUptBlueSurfN4 + oNO3WEpiN4)) + oNH4WEpiN4 * ahNUptBlueSurfN4 /((oNH4WEpiN4 + oNO3WEpiN4) *(ahNUptBlueSurfN4 + oNO3WEpiN4));
tNUptNH4BlueSurfN4 = afNH4UptBlueSurfN4 * tNUptBlueWSurfN4;
tNUptNO3BlueSurfN4 = tNUptBlueWSurfN4 - tNUptNH4BlueSurfN4;
tPUptBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE aVPUptBlueSurfN4 * aDBlueSurfN4 ENDIF;
tDRespBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE ukDRespTmBlueSurfN4 *aDBlueSurfN4 ENDIF;
tNExcrBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE (rNDBlueSurfN4 * 2.0 )/(cNDBlueMaxN4 + rNDBlueSurfN4) * rNDBlueSurfN4 * tDRespBlueSurfN4 ENDIF;
tPExcrBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE (rPDBlueSurfN4 * 2.0 )/(cPDBlueMaxN4 + rPDBlueSurfN4) * rPDBlueSurfN4 * tDRespBlueSurfN4 ENDIF;
tDMortBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE kMortBlueWN4 * aDBlueSurfN4 ENDIF;
tNMortBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE kMortBlueWN4 * aNBlueSurfN4 ENDIF;
wNMortBlueNH4WSurfN4 = fDissMortPhytN4 * tNMortBlueSurfN4 / uDepthWEpiN4;
wNMortBlueDetSurfN4 = ( 1 -fDissMortPhytN4) * tNMortBlueSurfN4 / uDepthWEpiN4;
tPMortBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE kMortBlueWN4 * aPBlueSurfN4 ENDIF;
uFunTmLossSurfN4 = EXP(-0.5/(cSigTmLossN4*cSigTmLossN4) *((uTmSurfN4-cTmOptLossN4)*(uTmSurfN4-cTmOptLossN4) -(cTmRefN4-cTmOptLossN4)*(cTmRefN4-cTmOptLossN4)));
ukLossTmBlueSurfN4 = UseLossN4 * kLossBlueN4 * uFunTmLossSurfN4;
tDLossBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE ukLossTmBlueSurfN4 * aDBlueSurfN4 ENDIF;
tPLossBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE rPDBlueSurfN4 * tDLossBlueSurfN4 ENDIF;
tNLossBlueSurfN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE rNDBlueSurfN4 * tDLossBlueSurfN4 ENDIF;
tDPrimBlueSurfN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE tDAssBlueSurfN4 - tDRespBlueSurfN4 + tDFloBlueEpiN4 - tDSetBlueSurfN4- tDMortBlueSurfN4 ENDIF;
tNPrimBlueSurfN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE tNUptBlueSurfN4 - tNExcrBlueSurfN4  + tNFloBlueEpiN4 - tNSetBlueSurfN4 - tNMortBlueSurfN4 ENDIF;
tPPrimBlueSurfN4 = IF (InclSurfN4 EQ FALSE) THEN 0.0 ELSE tPUptBlueSurfN4 - tPExcrBlueSurfN4 + tPFloBlueEpiN4 - tPSetBlueSurfN4- tPMortBlueSurfN4 ENDIF;
tDPrimBlueSN4 = IF ( aInclStratN4 EQ FALSE) THEN tDSetBlueEpiN4 - tDResusBlueN4 - tDMortBlueSN4 - tDRespBlueSN4 ELSE tDSetBlueHypN4 - tDResusBlueN4 - tDMortBlueSN4 - tDRespBlueSN4 ENDIF;
tPPrimBlueSN4 = IF ( aInclStratN4 EQ FALSE) THEN tPSetBlueEpiN4 - tPResusBlueN4 - tPMortBlueSN4 - tPExcrBlueSN4 ELSE tPSetBlueHypN4 - tPResusBlueN4 - tPMortBlueSN4 - tPExcrBlueSN4 ENDIF;
tNPrimBlueSN4 = IF (aInclStratN4 EQ FALSE) THEN tNSetBlueEpiN4 - tNResusBlueN4 - tNMortBlueSN4 - tNExcrBlueSN4 ELSE tNSetBlueHypN4 - tNResusBlueN4 - tNMortBlueSN4 - tNExcrBlueSN4 ENDIF;
aVPUptMaxCrGrenEpiN4 = MAX(0.0,cVPUptMaxGrenN4 * uFunTmProdGrenEpiN4 *(cPDGrenMaxN4 - rPDGrenWEpiN4) /(cPDGrenMaxN4 - cPDGrenMinN4));
aVPUptGrenEpiN4 = oPO4WEpiN4 * aVPUptMaxCrGrenEpiN4 /(aVPUptMaxCrGrenEpiN4 / cAffPUptGrenN4 + oPO4WEpiN4);
wPUptGrenEpiN4 = aVPUptGrenEpiN4 * oDGrenWEpiN4;
aVNUptMaxCrGrenEpiN4 = MAX(0.0,cVNUptMaxGrenN4 * uFunTmProdGrenEpiN4 * (cNDGrenMaxN4 - rNDGrenWEpiN4) /(cNDGrenMaxN4 - cNDGrenMinN4));
ahNUptGrenEpiN4 = aVNUptMaxCrGrenEpiN4 / cAffNUptGrenN4;
aVNUptGrenEpiN4 = oNDissWEpiN4 * aVNUptMaxCrGrenEpiN4 /(ahNUptGrenEpiN4 + oNDissWEpiN4);
wNUptGrenEpiN4 = aVNUptGrenEpiN4 * oDGrenWEpiN4;
afNH4UptGrenEpiN4 = oNH4WEpiN4 * oNO3WEpiN4 /((ahNUptGrenEpiN4 + oNH4WEpiN4) *(ahNUptGrenEpiN4 + oNO3WEpiN4)) + oNH4WEpiN4 * ahNUptGrenEpiN4 /((oNH4WEpiN4 + oNO3WEpiN4) *(ahNUptGrenEpiN4 + oNO3WEpiN4));
wNUptNH4GrenEpiN4 = afNH4UptGrenEpiN4 * wNUptGrenEpiN4;
wNUptNO3GrenEpiN4 = wNUptGrenEpiN4 - wNUptNH4GrenEpiN4;
aPLimGrenEpiN4 = MAX(0.0,(1.0 - cPDGrenMinN4 / rPDGrenWEpiN4) * cPDGrenMaxN4 /(cPDGrenMaxN4 - cPDGrenMinN4));
aNLimGrenEpiN4 = MAX(0.0,(1.0 - cNDGrenMinN4 / rNDGrenWEpiN4) * cNDGrenMaxN4 /(cNDGrenMaxN4 - cNDGrenMinN4));
aSiLimGrenEpiN4 = oSiO2WEpiN4 /(hSiAssGrenN4 + oSiO2WEpiN4);
aMuTmLGrenEpiN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimGrenEpiN4 * uMuMaxTmGrenEpiN4;
aNutLimGrenEpiN4 = MIN(aPLimGrenEpiN4 , (MIN(aNLimGrenEpiN4,aSiLimGrenEpiN4)));
aMuGrenEpiN4 = aNutLimGrenEpiN4 * aMuTmLGrenEpiN4;
wDAssGrenEpiN4 = aMuGrenEpiN4*oDGrenWEpiN4;
aExtChGrenEpiN4 = cExtSpGrenN4 / rChDGrenEpiN4;
wDRespGrenWEpiN4 = ukDRespTmGrenEpiN4 * oDGrenWEpiN4;
wDLossGrenEpiN4 = ukLossTmGrenEpiN4 * oDGrenWEpiN4;
wDMortGrenWEpiN4 = kMortGrenWN4 * oDGrenWEpiN4;
ukDDecGrenEpiN4 = ukDRespTmGrenEpiN4 + ukLossTmGrenEpiN4 + kMortGrenWN4 +(uCorVSetGrenEpiN4 * uFunTmSetEpiN4) / uDepthWEpiN4;
wPExcrGrenWEpiN4 = (2.0 *rPDGrenWEpiN4) /(cPDGrenMaxN4 + rPDGrenWEpiN4) * rPDGrenWEpiN4 * wDRespGrenWEpiN4 ;
wPLossGrenEpiN4 = rPDGrenWEpiN4 * wDLossGrenEpiN4;
wPMortGrenWEpiN4 = kMortGrenWN4 * oPGrenWEpiN4;
wNExcrGrenWEpiN4 = (2.0 * rNDGrenWEpiN4) /(cNDGrenMaxN4 + rNDGrenWEpiN4) * rNDGrenWEpiN4 * wDRespGrenWEpiN4;
wNLossGrenEpiN4 = rNDGrenWEpiN4 * wDLossGrenEpiN4;
wNMortGrenWEpiN4 = kMortGrenWN4 * oNGrenWEpiN4;
wDPrimGrenWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wDAssGrenEpiN4 - wDRespGrenWEpiN4 - wDLossGrenEpiN4 - wDMortGrenWEpiN4 -(tDSetGrenEpiN4 ) / uDepthWEpiN4 ELSE wDAssGrenEpiN4 - wDRespGrenWEpiN4 - wDLossGrenEpiN4 - wDMortGrenWEpiN4 -(tDSetGrenEpiN4 - tDResusGrenN4) / uDepthWEpiN4 ENDIF;
wPPrimGrenWEpiN4 =IF (aInclStratN4 EQ TRUE ) THEN wPUptGrenEpiN4 - wPExcrGrenWEpiN4 - wPLossGrenEpiN4 - wPMortGrenWEpiN4 -(tPSetGrenEpiN4 ) / uDepthWEpiN4 ELSE wPUptGrenEpiN4 - wPExcrGrenWEpiN4 - wPLossGrenEpiN4 - wPMortGrenWEpiN4 -(tPSetGrenEpiN4 - tPResusGrenN4) / uDepthWEpiN4 ENDIF;
wNPrimGrenWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wNUptGrenEpiN4 - wNExcrGrenWEpiN4 - wNLossGrenEpiN4 - wNMortGrenWEpiN4 -(tNSetGrenEpiN4 ) / uDepthWEpiN4 ELSE wNUptGrenEpiN4 - wNExcrGrenWEpiN4 - wNLossGrenEpiN4 - wNMortGrenWEpiN4 -(tNSetGrenEpiN4 - tNResusGrenN4) / uDepthWEpiN4 ENDIF;
tDPrimGrenSN4 = IF ( aInclStratN4 EQ FALSE) THEN tDSetGrenEpiN4 - tDResusGrenN4 - tDMortGrenSN4 - tDRespGrenSN4 ELSE tDSetGrenHypN4 - tDResusGrenN4 - tDMortGrenSN4 - tDRespGrenSN4 ENDIF;
tPPrimGrenSN4 = IF ( aInclStratN4 EQ FALSE) THEN tPSetGrenEpiN4 - tPResusGrenN4 - tPMortGrenSN4 - tPExcrGrenSN4 ELSE tPSetGrenHypN4 - tPResusGrenN4 - tPMortGrenSN4 - tPExcrGrenSN4 ENDIF;
tNPrimGrenSN4 = IF ( aInclStratN4 EQ FALSE) THEN tNSetGrenEpiN4 - tNResusGrenN4 - tNMortGrenSN4 - tNExcrGrenSN4 ELSE tNSetGrenHypN4 - tNResusGrenN4 - tNMortGrenSN4 - tNExcrGrenSN4 ENDIF;
aVPUptMaxCrDiatEpiN4 = MAX(0.0,cVPUptMaxDiatN4 * uFunTmProdDiatEpiN4 *(cPDDiatMaxN4 - rPDDiatWEpiN4) /(cPDDiatMaxN4 - cPDDiatMinN4));
aVPUptDiatEpiN4 = oPO4WEpiN4 * aVPUptMaxCrDiatEpiN4 /(aVPUptMaxCrDiatEpiN4 / cAffPUptDiatN4 + oPO4WEpiN4);
wPUptDiatEpiN4 = aVPUptDiatEpiN4 * oDDiatWEpiN4;
aVNUptMaxCrDiatEpiN4 = MAX(0.0,cVNUptMaxDiatN4 * uFunTmProdDiatEpiN4 * (cNDDiatMaxN4 - rNDDiatWEpiN4) /(cNDDiatMaxN4 - cNDDiatMinN4));
ahNUptDiatEpiN4 = aVNUptMaxCrDiatEpiN4 / cAffNUptDiatN4;
aVNUptDiatEpiN4 = oNDissWEpiN4 * aVNUptMaxCrDiatEpiN4 /(ahNUptDiatEpiN4 + oNDissWEpiN4);
wNUptDiatEpiN4 = aVNUptDiatEpiN4 * oDDiatWEpiN4;
afNH4UptDiatEpiN4 = oNH4WEpiN4 * oNO3WEpiN4 /((ahNUptDiatEpiN4 + oNH4WEpiN4) *(ahNUptDiatEpiN4 + oNO3WEpiN4)) + oNH4WEpiN4 * ahNUptDiatEpiN4 /((oNH4WEpiN4 + oNO3WEpiN4) *(ahNUptDiatEpiN4 + oNO3WEpiN4));
wNUptNH4DiatEpiN4 = afNH4UptDiatEpiN4 * wNUptDiatEpiN4;
wNUptNO3DiatEpiN4 = wNUptDiatEpiN4 - wNUptNH4DiatEpiN4;
aPLimDiatEpiN4 = MAX(0.0,(1.0 - cPDDiatMinN4 / rPDDiatWEpiN4) * cPDDiatMaxN4 /(cPDDiatMaxN4 - cPDDiatMinN4));
aNLimDiatEpiN4 = MAX(0.0,(1.0 - cNDDiatMinN4 / rNDDiatWEpiN4) * cNDDiatMaxN4 /(cNDDiatMaxN4 - cNDDiatMinN4));
aSiLimDiatEpiN4 = oSiO2WEpiN4 /(hSiAssDiatN4 + oSiO2WEpiN4);
aMuTmLDiatEpiN4 = ufDayN4 *(1.0 - afCovSurfVegN4) * aLLimDiatEpiN4 * uMuMaxTmDiatEpiN4;
aNutLimDiatEpiN4 = MIN(aPLimDiatEpiN4 , (MIN(aNLimDiatEpiN4,aSiLimDiatEpiN4)));
aMuDiatEpiN4 = aNutLimDiatEpiN4 * aMuTmLDiatEpiN4;
wDAssDiatEpiN4 = aMuDiatEpiN4*oDDiatWEpiN4;
aExtChDiatEpiN4 = cExtSpDiatN4 / rChDDiatEpiN4;
wDRespDiatWEpiN4 = ukDRespTmDiatEpiN4 * oDDiatWEpiN4;
wDLossDiatEpiN4 = ukLossTmDiatEpiN4 * oDDiatWEpiN4;
wDMortDiatWEpiN4 = kMortDiatWN4 * oDDiatWEpiN4;
ukDDecDiatEpiN4 = ukDRespTmDiatEpiN4 + ukLossTmDiatEpiN4 + kMortDiatWN4 +(uCorVSetDiatEpiN4 * uFunTmSetEpiN4) / uDepthWEpiN4;
wPExcrDiatWEpiN4 = (2.0 * rPDDiatWEpiN4) /(cPDDiatMaxN4 + rPDDiatWEpiN4) * rPDDiatWEpiN4 * wDRespDiatWEpiN4 ;
wPLossDiatEpiN4 = rPDDiatWEpiN4 * wDLossDiatEpiN4;
wPMortDiatWEpiN4 = kMortDiatWN4 * oPDiatWEpiN4;
wNExcrDiatWEpiN4 = (2.0 * rNDDiatWEpiN4) /(cNDDiatMaxN4 + rNDDiatWEpiN4) * rNDDiatWEpiN4 * wDRespDiatWEpiN4 ;
wNLossDiatEpiN4 = rNDDiatWEpiN4 * wDLossDiatEpiN4;
wNMortDiatWEpiN4 = kMortDiatWN4 * oNDiatWEpiN4;
wDPrimDiatWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wDAssDiatEpiN4 - wDRespDiatWEpiN4 - wDLossDiatEpiN4 - wDMortDiatWEpiN4 -(tDSetDiatEpiN4 ) / uDepthWEpiN4 ELSE wDAssDiatEpiN4 - wDRespDiatWEpiN4 - wDLossDiatEpiN4 - wDMortDiatWEpiN4 -(tDSetDiatEpiN4 - tDResusDiatN4) / uDepthWEpiN4 ENDIF;
wPPrimDiatWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wPUptDiatEpiN4 - wPExcrDiatWEpiN4 - wPLossDiatEpiN4 - wPMortDiatWEpiN4 -(tPSetDiatEpiN4 ) / uDepthWEpiN4 ELSE wPUptDiatEpiN4 - wPExcrDiatWEpiN4 - wPLossDiatEpiN4 - wPMortDiatWEpiN4 -(tPSetDiatEpiN4 - tPResusDiatN4) / uDepthWEpiN4 ENDIF;
wNPrimDiatWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wNUptDiatEpiN4 - wNExcrDiatWEpiN4 - wNLossDiatEpiN4 - wNMortDiatWEpiN4 -(tNSetDiatEpiN4 ) / uDepthWEpiN4 ELSE wNUptDiatEpiN4 - wNExcrDiatWEpiN4 - wNLossDiatEpiN4 - wNMortDiatWEpiN4 -(tNSetDiatEpiN4 - tNResusDiatN4) / uDepthWEpiN4 ENDIF;
tDPrimDiatSN4 = IF ( aInclStratN4 EQ FALSE) THEN tDSetDiatEpiN4 - tDResusDiatN4 - tDMortDiatSN4 - tDRespDiatSN4 ELSE tDSetDiatHypN4 - tDResusDiatN4 - tDMortDiatSN4 - tDRespDiatSN4 ENDIF;
tPPrimDiatSN4 = IF ( aInclStratN4 EQ FALSE) THEN tPSetDiatEpiN4 - tPResusDiatN4 - tPMortDiatSN4 - tPExcrDiatSN4 ELSE tPSetDiatHypN4 - tPResusDiatN4 - tPMortDiatSN4 - tPExcrDiatSN4 ENDIF;
tNPrimDiatSN4 = IF ( aInclStratN4 EQ FALSE) THEN tNSetDiatEpiN4 - tNResusDiatN4 - tNMortDiatSN4 - tNExcrDiatSN4 ELSE tNSetDiatHypN4 - tNResusDiatN4 - tNMortDiatSN4 - tNExcrDiatSN4 ENDIF;
oChlaN4 = IF ( aInclStratN4 EQ TRUE ) THEN (oChlaEpiN4 * uDepthWEpiN4 + oChlaHypN4 * uDepthWHypN4 + aChlaBlueSurfN4) / uDepthWN4 ELSE (oChlaEpiN4 * uDepthWEpiN4+ aChlaBlueSurfN4 ) / uDepthWN4 ENDIF;
oChlaWN4 = IF ( aInclStratN4 EQ TRUE ) THEN (oChlaEpiN4 * uDepthWEpiN4 + oChlaHypN4 * uDepthWHypN4) / uDepthWN4 ELSE (oChlaEpiN4 * uDepthWEpiN4) / uDepthWN4 ENDIF;
aChlaHN4 = oChlaN4 * uDepthWN4;
aLPIEpiN4 =  (aLPARBotSurfN4- aLPARBotEpiOpenN4 + uhLVegN4* LN((1.0 +aLPARBotEpiOpenN4/ uhLVegN4)  /(1.0 + aLPARBotSurfN4  / uhLVegN4) + NearZeroN4  ) ) / uDepthWEpiN4;
aLPIHypN4 =  (aLPARBotEpiN4- aLPARBotHypOpenN4 + uhLVegN4* LN((1.0 +aLPARBotHypOpenN4/ uhLVegN4)  /(1.0 + aLPARBotEpiN4  / uhLVegN4) + NearZeroN4  ) ) / uDepthWHypN4;
aLPIMeasEpiN4 =  (aLPARBotSurfN4- aLPARBotEpiN4 ) /aExtCoefEpiN4;
aLPIMeasHypN4 =  (aLPARBotEpiN4- aLPARBotHypN4) / aExtCoefHypN4;
aLMeasEpiN4 = aLPARBotSurfN4 * EXP(- aExtCoefOpenEpiN4 *cDepthMeasoChlN4);
aLMeasHypN4 = aLPARBotEpiN4 * EXP(- aExtCoefOpenHypN4 * (cDepthMeasoChlN4 -  uDepthWEpiN4));
aLPAREuphoN4 = PerCentN4 * uLPARSurfN4;
aDepthEuphWN4 = IF (aLPAREuphoN4 GT aLPARBotSurfN4) THEN  0.0 ELSEIF (aLPAREuphoN4 GE aLPARBotEpiOpenN4) THEN - LN(aLPAREuphoN4/aLPARBotSurfN4) / aExtCoefEpiN4 ELSE uDepthWEpiN4 - LN(aLPAREuphoN4/aLPARBotEpiOpenN4) / aExtCoefOpenHypN4 ENDIF;
oChlaMeasEpiN4 = IF (cDepthMeasoChlN4 LT aDepthEuphWN4) THEN aLMeasEpiN4/ aLPIMeasEpiN4 *oChlaEpiN4 * uDepthWEpiN4 ELSE oChlaEpiN4 ENDIF;
oChlaMeasHypN4 = IF (cDepthMeasoChlN4 LT aDepthEuphWN4) THEN  aLMeasHypN4/ aLPIMeasHypN4 *oChlaHypN4* uDepthWHypN4  ELSE oChlaHypN4 ENDIF;
oChlaMeasWN4 = IF (cDepthMeasoChlN4 LT uDepthWEpiN4) THEN oChlaMeasEpiN4 ELSE oChlaMeasHypN4 ENDIF;
wDAssPhytEpiN4 = wDAssDiatEpiN4 + wDAssGrenEpiN4 + wDAssBlueEpiN4;
wDRespPhytWEpiN4 = wDRespDiatWEpiN4 + wDRespGrenWEpiN4 + wDRespBlueWEpiN4;
wDMortPhytWEpiN4 = wDMortDiatWEpiN4 + wDMortGrenWEpiN4 + wDMortBlueWEpiN4;
tDSetPhytEpiN4 = tDSetDiatEpiN4 + tDSetGrenEpiN4 + tDSetBlueEpiN4;
wDLossPhytEpiN4 = wDLossDiatEpiN4 + wDLossGrenEpiN4 + wDLossBlueEpiN4 + tDLossBlueSurfN4 / uDepthWEpiN4;
wDPrimPhytWEpiN4 = wDPrimDiatWEpiN4 + wDPrimGrenWEpiN4 + wDPrimBlueWEpiN4;
wPUptPhytEpiN4 = wPUptDiatEpiN4 + wPUptGrenEpiN4 + wPUptBlueEpiN4;
wPExcrPhytWEpiN4 = wPExcrDiatWEpiN4 + wPExcrGrenWEpiN4 + wPExcrBlueWEpiN4;
wPMortPhytWEpiN4 = wPMortDiatWEpiN4 + wPMortGrenWEpiN4 + wPMortBlueWEpiN4;
tPSetPhytEpiN4 = tPSetDiatEpiN4 + tPSetGrenEpiN4 + tPSetBlueEpiN4;
wPLossPhytEpiN4 = wPLossDiatEpiN4 + wPLossGrenEpiN4 + wPLossBlueEpiN4 + tPLossBlueSurfN4 / uDepthWEpiN4;
wPPrimPhytWEpiN4 = wPPrimDiatWEpiN4 + wPPrimGrenWEpiN4 + wPPrimBlueWEpiN4;
wNUptPhytEpiN4 = wNUptDiatEpiN4 + wNUptGrenEpiN4 + wNUptBlueEpiN4;
wNUptNH4PhytEpiN4 = wNUptNH4DiatEpiN4 + wNUptNH4GrenEpiN4 + wNUptNH4BlueEpiN4;
wNUptNO3PhytEpiN4 = wNUptNO3DiatEpiN4 + wNUptNO3GrenEpiN4 + wNUptNO3BlueEpiN4;
wNExcrPhytWEpiN4 = wNExcrDiatWEpiN4 + wNExcrGrenWEpiN4 + wNExcrBlueWEpiN4;
wNMortPhytWEpiN4 = wNMortDiatWEpiN4 + wNMortGrenWEpiN4 + wNMortBlueWEpiN4;
tNSetPhytEpiN4 = tNSetDiatEpiN4 + tNSetGrenEpiN4 + tNSetBlueEpiN4;
wNLossPhytEpiN4 = wNLossDiatEpiN4 + wNLossGrenEpiN4 + wNLossBlueEpiN4 + tNLossBlueSurfN4 / uDepthWEpiN4;
wNPrimPhytWEpiN4 = wNPrimDiatWEpiN4 + wNPrimGrenWEpiN4 + wNPrimBlueWEpiN4;
tDPrimPhytSN4 = tDPrimDiatSN4 + tDPrimGrenSN4 + tDPrimBlueSN4;
tPPrimPhytSN4 = tPPrimDiatSN4 + tPPrimGrenSN4 + tPPrimBlueSN4;
tNPrimPhytSN4 = tNPrimDiatSN4 + tNPrimGrenSN4 + tNPrimBlueSN4;
wSiUptDiatEpiN4 = cSiDDiatN4 * wDAssDiatEpiN4;
wSiExcrDiatWEpiN4 = cSiDDiatN4 * wDRespDiatWEpiN4 ;
wSiLossDiatEpiN4 = cSiDDiatN4 * wDLossDiatEpiN4;
wSiMortDiatWEpiN4 = cSiDDiatN4 * wDMortDiatWEpiN4;
tSiSetDiatEpiN4 = cSiDDiatN4 * tDSetDiatEpiN4;
wSiPrimDiatWHypN4 = IF (aInclStratN4 EQ TRUE ) THEN wSiUptDiatHypN4 - tSiSetDiatHypN4 / uDepthWHypN4 - wSiExcrDiatWHypN4 - wSiMortDiatWHypN4 - wSiLossDiatHypN4 ELSE 0.0 ENDIF;
wSiPrimDiatWEpiN4 = IF (aInclStratN4 EQ TRUE ) THEN wSiUptDiatEpiN4 - tSiSetDiatEpiN4 / uDepthWEpiN4 - wSiExcrDiatWEpiN4 - wSiMortDiatWEpiN4 - wSiLossDiatEpiN4 ELSE wSiUptDiatEpiN4 - tSiSetDiatEpiN4 / uDepthWEpiN4 - wSiExcrDiatWEpiN4 - wSiMortDiatWEpiN4 - wSiLossDiatEpiN4 + tSiResusDiatN4 / uDepthWEpiN4 ENDIF;
rCyDBlueEpiN4 = cCyDBlueMaxN4 -(cCyDBlueMaxN4 - cCyDBlueMinN4) * aLLimBlueEpiN4;
oCyanEpiN4 = rCyDBlueEpiN4 * oDBlueWEpiN4 * mgPergN4;
fDDiatEpiN4 = oDDiatWEpiN4 /(oDDiatWEpiN4 + oDGrenWEpiN4 + oDBlueWEpiN4 + NearZeroN4);
wDPrimDetWEpiN4 = IF (InclSurfN4 EQ TRUE) THEN wDMortPhytWEpiN4 + wDLossPhytEpiN4 + tDMortBlueSurfN4 / uDepthWEpiN4 ELSE wDMortPhytWEpiN4 + wDLossPhytEpiN4 ENDIF;
tDPrimDetSN4 = tDMortPhytSN4;
tDPrimTotSurfN4 = IF (InclSurfN4 EQ TRUE) THEN tDAssBlueSurfN4 - tDRespBlueSurfN4 ELSE 0.0 ENDIF;
tDPrimTotTN4 = IF (aInclStratN4 EQ FALSE ) THEN(wDAssPhytEpiN4 - wDRespPhytWEpiN4) * uDepthWEpiN4 - tDRespPhytSN4 + tDPrimTotSurfN4 ELSE (wDAssPhytEpiN4 - wDRespPhytWEpiN4) * uDepthWEpiN4 + (wDAssPhytHypN4 - wDRespPhytWHypN4) * uDepthWHypN4 - tDRespPhytSN4 + tDPrimTotSurfN4 ENDIF;
wO2ProdPhytEpiN4 = molO2molCN4 * cCPerDWN4 * wDAssPhytEpiN4;
wO2RespPhytWEpiN4 = molO2molCN4 * cCPerDWN4 * wDRespPhytWEpiN4 * aCorO2BODEpiN4;
wO2UptNO3PhytEpiN4 = O2PerNO3N4 * molO2molNN4 * wNUptNO3PhytEpiN4;
wO2PrimWEpiN4 = wO2ProdPhytEpiN4 - wO2RespPhytWEpiN4 + wO2UptNO3PhytEpiN4;
tO2RespPhytSN4 = molO2molCN4 * cCPerDWN4 * tDRespPhytSN4 * afOxySedN4;
tO2PrimSN4 = tO2RespPhytSN4;
tO2PrimSHypN4 = IF aInclStratN4 EQ TRUE THEN tO2PrimSN4 / uDepthWHypN4 ELSE 0.0 ENDIF;
tO2PrimSEpiN4 = IF aInclStratN4 EQ FALSE THEN tO2PrimSN4 / uDepthWEpiN4 ELSE 0.0 ENDIF;
wPMortBluePO4WSurfN4 = fDissMortPhytN4 * tPMortBlueSurfN4 / uDepthWEpiN4;
wPMortBlueDetSurfN4 = ( 1 -fDissMortPhytN4) * tPMortBlueSurfN4 / uDepthWEpiN4;
wPMortPhytPO4WEpiN4 = fDissMortPhytN4 * wPMortPhytWEpiN4;
wPMortPhytDetWEpiN4 = wPMortPhytWEpiN4 - wPMortPhytPO4WEpiN4 + wPMortBlueDetSurfN4;
wPLossPhytPO4EpiN4 = fDissLossN4 * wPLossPhytEpiN4;
wPLossPhytDetEpiN4 = wPLossPhytEpiN4 - wPLossPhytPO4EpiN4;
wPPrimPO4WEpiN4 = - wPUptPhytEpiN4 + wPExcrPhytWEpiN4 + wPLossPhytPO4EpiN4 + wPMortPhytPO4WEpiN4 - tPUptBlueSurfN4 / uDepthWEpiN4 + tPExcrBlueSurfN4 / uDepthWEpiN4 + wPMortBluePO4WSurfN4;
wPPrimDetWEpiN4 = wPLossPhytDetEpiN4 + wPMortPhytDetWEpiN4;
tPPrimDetSN4 = tPMortPhytDetSN4 ;
wNMortPhytNH4WEpiN4 = fDissMortPhytN4 * wNMortPhytWEpiN4;
wNMortPhytDetWEpiN4 = wNMortPhytWEpiN4 - wNMortPhytNH4WEpiN4+ wNMortBlueDetSurfN4;
wNLossPhytNH4EpiN4 = fDissLossN4 * wNLossPhytEpiN4;
wNLossPhytDetEpiN4 = wNLossPhytEpiN4 - wNLossPhytNH4EpiN4;
wNPrimNH4WEpiN4 = - wNUptNH4PhytEpiN4 + wNExcrPhytWEpiN4 + wNLossPhytNH4EpiN4 + wNMortPhytNH4WEpiN4- tNUptNH4BlueSurfN4 / uDepthWEpiN4 + tNExcrBlueSurfN4 / uDepthWEpiN4 + wNMortBlueNH4WSurfN4;
wNPrimNO3WEpiN4 = - wNUptNO3PhytEpiN4 - tNUptNO3BlueSurfN4 / uDepthWEpiN4;
wNPrimDetWEpiN4 = wNLossPhytDetEpiN4 + wNMortPhytDetWEpiN4;
tNPrimDetSN4 = tNMortPhytDetSN4 ;
wSiPrimSiO2WEpiN4 = IF (aInclStratN4 EQ FALSE) THEN wSiExcrDiatWEpiN4 - wSiUptDiatEpiN4 + tSiExcrDiatSN4 / uDepthWEpiN4 ELSE wSiExcrDiatWEpiN4 - wSiUptDiatEpiN4 ENDIF;
wSiPrimDetWEpiN4 = wSiMortDiatWEpiN4 + wSiLossDiatEpiN4;
tSiPrimDiatSN4 = IF (aInclStratN4 EQ FALSE) THEN tSiSetDiatEpiN4 - tSiResusDiatN4 - tSiExcrDiatSN4 - tSiMortDiatSN4 ELSE tSiSetDiatHypN4 - tSiResusDiatN4 - tSiExcrDiatSN4 - tSiMortDiatSN4 ENDIF;
tSiPrimDetSN4 = tSiMortDiatSN4 ;
aDepthEuphEpiN4 = cEuphN4 * aSecchiEpiN4;
aRelDepthEuphEpiN4 = aDepthEuphEpiN4 / uDepthWEpiN4;
aChlaHEpiN4 = oChlaEpiN4 * uDepthWEpiN4;
aCovPhytWEpiN4 = cCovSpPhytN4 *(oDPhytWEpiN4 * uDepthWEpiN4);
rExtChPhytEpiN4 = aExtPhytEpiN4 /(oChlaEpiN4 / mgPergN4 + NearZeroN4);
rPDZooEpiN4 = oPZooEpiN4 /(oDZooEpiN4+NearZeroN4);
rNDZooEpiN4 = oNZooEpiN4/(oDZooEpiN4+NearZeroN4);
aDFoodZooEpiN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN cPrefDiatN4 * aDDiatWEpiN4 + cPrefGrenN4 * aDGrenWEpiN4 + cPrefBlueN4 * aDBlueWEpiN4 + cPrefDetN4 * aDDetWEpiN4 ELSE cPrefDiatN4 * aDDiatWEpiN4 + cPrefGrenN4 * aDGrenWEpiN4 + cPrefBlueN4 * aDBlueWEpiN4 + cPrefBlueSurfN4 * aDBlueSurfN4 + cPrefDetN4 * aDDetWEpiN4 ENDIF;
oDFoodZooEpiN4 = aDFoodZooEpiN4 / uDepthWEpiN4;
aFiltEpiN4 = cFiltMaxN4 * uFunTmZooEpiN4 * hFiltN4 /(hFiltN4 + oDOMWEpiN4);
aDSatZooEpiN4 = oDFoodZooEpiN4 /(hFiltN4 + oDOMWEpiN4);
wDEnvZooEpiN4 = MAX(0.0,ukDIncrZooEpiN4 / cDCarrZooN4 * oDZooEpiN4*oDZooEpiN4);
wDAssZooEpiN4 = aDSatZooEpiN4 *(ukDAssTmZooEpiN4 * oDZooEpiN4 - wDEnvZooEpiN4);
wDConsZooEpiN4 = wDAssZooEpiN4 / fDAssZooN4;
wDConsDetZooEpiN4 = cPrefDetN4*oDDetWEpiN4 / oDFoodZooEpiN4 * wDConsZooEpiN4;
wDConsDiatZooEpiN4 = cPrefDiatN4*oDDiatWEpiN4 / oDFoodZooEpiN4 * wDConsZooEpiN4;
wDConsGrenZooEpiN4 = cPrefGrenN4*oDGrenWEpiN4 / oDFoodZooEpiN4 * wDConsZooEpiN4;
wDConsBlueZooEpiN4 = cPrefBlueN4*oDBlueWEpiN4 / oDFoodZooEpiN4 * wDConsZooEpiN4;
wDConsBlueZooSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE cPrefBlueSurfN4 *aDBlueSurfN4 / aDFoodZooEpiN4 * wDConsZooEpiN4 ENDIF;
tDConsBlueZooSurfN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE wDConsBlueZooSurfN4 *uDepthWEpiN4 ENDIF;
wDConsPhytZooEpiN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN wDConsDiatZooEpiN4 + wDConsGrenZooEpiN4 + wDConsBlueZooEpiN4 ELSE wDConsDiatZooEpiN4 + wDConsGrenZooEpiN4 + wDConsBlueZooEpiN4 + wDConsBlueZooSurfN4 ENDIF;
wDEgesZooEpiN4 = wDConsZooEpiN4 - wDAssZooEpiN4;
aCorDRespZooEpiN4 = MAX(cPDZooRefN4 / rPDZooEpiN4,cNDZooRefN4 / rNDZooEpiN4);
wDRespZooEpiN4 = aCorDRespZooEpiN4 * ukDRespTmZooEpiN4 * oDZooEpiN4;
wDMortZooEpiN4 = kMortZooN4 * oDZooEpiN4 +(1.0 - aDSatZooEpiN4) * wDEnvZooEpiN4;
aPFoodZooEpiN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN cPrefDiatN4*aPDiatWEpiN4 + cPrefGrenN4*aPGrenWEpiN4 + cPrefBlueN4 * aPBlueWEpiN4  + cPrefDetN4 * aPDetWEpiN4 ELSE cPrefDiatN4*aPDiatWEpiN4 + cPrefGrenN4*aPGrenWEpiN4 + cPrefBlueN4*aPBlueWEpiN4 + cPrefBlueSurfN4 *aPBlueSurfN4 + cPrefDetN4 * aPDetWEpiN4 ENDIF;
oPFoodZooEpiN4 = aPFoodZooEpiN4 / MassEpiN4;
rPDFoodZooEpiN4 = oPFoodZooEpiN4 /(oDFoodZooEpiN4+NearZeroN4);
wPConsDiatZooEpiN4 = rPDDiatWEpiN4 * wDConsDiatZooEpiN4;
wPConsGrenZooEpiN4 = rPDGrenWEpiN4 * wDConsGrenZooEpiN4;
wPConsBlueZooEpiN4 = rPDBlueWEpiN4 * wDConsBlueZooEpiN4;
wPConsBlueZooSurfN4 = rPDBlueSurfN4 * wDConsBlueZooSurfN4;
tPConsBlueZooSurfN4 = wPConsBlueZooSurfN4 *uDepthWEpiN4;
wPConsPhytZooEpiN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN wPConsDiatZooEpiN4 + wPConsGrenZooEpiN4 + wPConsBlueZooEpiN4 ELSE wPConsDiatZooEpiN4 + wPConsGrenZooEpiN4 + wPConsBlueZooEpiN4 + wPConsBlueZooSurfN4 ENDIF;
wPConsDetZooEpiN4 = rPDDetWEpiN4 * wDConsDetZooEpiN4;
wPConsZooEpiN4 = wPConsPhytZooEpiN4 + wPConsDetZooEpiN4;
afPAssZooEpiN4 = MIN(1.0,cPDZooRefN4 / rPDFoodZooEpiN4 * fDAssZooN4);
wPAssZooEpiN4 = afPAssZooEpiN4 * wPConsZooEpiN4;
wPEgesZooEpiN4 = wPConsZooEpiN4 - wPAssZooEpiN4;
wPEgesZooPO4EpiN4 = fDissEgesZooN4*wPEgesZooEpiN4;
wPEgesZooDetEpiN4 = wPEgesZooEpiN4 - wPEgesZooPO4EpiN4;
akPExcrZooEpiN4 = rPDZooEpiN4 / cPDZooRefN4 * kDRespZooN4 * uFunTmZooEpiN4;
wPExcrZooEpiN4 = akPExcrZooEpiN4*oPZooEpiN4 ;
wPMortZooEpiN4 = rPDZooEpiN4 * wDMortZooEpiN4;
wPMortZooPO4EpiN4 = fDissMortZooN4 * wPMortZooEpiN4;
wPMortZooDetEpiN4 = wPMortZooEpiN4 - wPMortZooPO4EpiN4;
aNFoodZooEpiN4 =  IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN cPrefDiatN4*aNDiatWEpiN4 + cPrefGrenN4*aNGrenWEpiN4 + cPrefBlueN4*aNBlueWEpiN4 + cPrefDetN4 * aNDetWEpiN4 ELSE cPrefDiatN4*aNDiatWEpiN4 + cPrefGrenN4*aNGrenWEpiN4 + cPrefBlueN4*aNBlueWEpiN4 + cPrefBlueSurfN4*aNBlueSurfN4 + cPrefDetN4 * aNDetWEpiN4 ENDIF;
oNFoodZooEpiN4 = aNFoodZooEpiN4 / MassEpiN4;
rNDFoodZooEpiN4 = oNFoodZooEpiN4 /(oDFoodZooEpiN4+NearZeroN4);
wNConsDiatZooEpiN4 = rNDDiatWEpiN4*wDConsDiatZooEpiN4;
wNConsGrenZooEpiN4 = rNDGrenWEpiN4*wDConsGrenZooEpiN4;
wNConsBlueZooEpiN4 = rNDBlueWEpiN4*wDConsBlueZooEpiN4;
wNConsBlueZooSurfN4 = rNDBlueSurfN4 * wDConsBlueZooSurfN4;
tNConsBlueZooSurfN4 = wNConsBlueZooSurfN4 *uDepthWEpiN4;
wNConsPhytZooEpiN4 = IF (InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN  wNConsDiatZooEpiN4 + wNConsGrenZooEpiN4 + wNConsBlueZooEpiN4 ELSE wNConsDiatZooEpiN4 + wNConsGrenZooEpiN4 + wNConsBlueZooEpiN4 + wNConsBlueZooSurfN4 ENDIF;
wNConsDetZooEpiN4 = rNDDetWEpiN4*wDConsDetZooEpiN4;
wNConsZooEpiN4 = wNConsPhytZooEpiN4 + wNConsDetZooEpiN4;
afNAssZooEpiN4 = MIN(1.0,cNDZooRefN4 / rNDFoodZooEpiN4 * fDAssZooN4);
wNAssZooEpiN4 = afNAssZooEpiN4*wNConsZooEpiN4;
wNEgesZooEpiN4 = wNConsZooEpiN4 - wNAssZooEpiN4;
wNEgesZooNH4EpiN4 = fDissEgesZooN4*wNEgesZooEpiN4;
wNEgesZooDetEpiN4 = wNEgesZooEpiN4 - wNEgesZooNH4EpiN4;
kNExcrZooEpiN4 = rNDZooEpiN4 / cNDZooRefN4 * kDRespZooN4 * uFunTmZooEpiN4;
wNExcrZooEpiN4 = kNExcrZooEpiN4*oNZooEpiN4 ;
wNMortZooEpiN4 = rNDZooEpiN4*wDMortZooEpiN4;
wNMortZooNH4EpiN4 = fDissMortZooN4*wNMortZooEpiN4;
wNMortZooDetEpiN4 = wNMortZooEpiN4 - wNMortZooNH4EpiN4;
wSiConsDiatZooEpiN4 = cSiDDiatN4 * wDConsDiatZooEpiN4;
rPDFiJvN4 = aPFiJvN4 /(aDFiJvN4+NearZeroN4);
rPDFiAdN4 = aPFiAdN4 /(aDFiAdN4+NearZeroN4);
rNDFiJvN4 = aNFiJvN4 /(aDFiJvN4+NearZeroN4);
rNDFiAdN4 = aNFiAdN4 /(aDFiAdN4+NearZeroN4);
tDReprFishN4 = IF (FALSE EQ InclSeasonN4) THEN ((1/DaysInYearN4)*fReprFishN4) * aDFiAdN4 ELSEIF (DayN4 GE cDayReprFishN4 AND DayN4 LT cDayReprFishN4 + 1.0) THEN fReprFishN4 * aDFiAdN4 * PerDayN4 ELSE 0.0 ENDIF;
tDAgeFishN4 = IF (FALSE EQ InclSeasonN4) THEN ((1/DaysInYearN4)*fAgeFishN4) * aDFiJvN4 ELSEIF (DayN4 GE 364.0) THEN fAgeFishN4 * aDFiJvN4 *PerDayN4 ELSE 0.0 ENDIF;
aDTotZooN4 = IF (aInclStratN4 EQ FALSE) THEN oDZooEpiN4 * uDepthWEpiN4 ELSE oDZooEpiN4 * uDepthWEpiN4 + oDZooHypN4 * uDepthWHypN4 ENDIF;
aPTotZooN4 = IF (aInclStratN4 EQ FALSE) THEN oPZooEpiN4 * uDepthWEpiN4 ELSE oPZooEpiN4 * uDepthWEpiN4 + oPZooHypN4 * uDepthWHypN4 ENDIF;
aNTotZooN4 = IF (aInclStratN4 EQ FALSE) THEN oNZooEpiN4 * uDepthWEpiN4 ELSE oNZooEpiN4 * uDepthWEpiN4 + oNZooHypN4 * uDepthWHypN4 ENDIF;
aDSatFiJvN4 = aDTotZooN4 * aDTotZooN4 /(hDZooFiJvN4 * hDZooFiJvN4 + aDTotZooN4 * aDTotZooN4);
tDEnvFiJvN4 = MAX(0.0,ukDIncrFiJvN4 /(cDCarrFishN4 - aDFiAdN4) * aDFiJvN4*aDFiJvN4);
tDAssFiJvN4 = aDSatFiJvN4 *(kDAssFiJvN4 * uFunTmFishN4 * aDFiJvN4 - tDEnvFiJvN4);
tDConsFiJvN4 = tDAssFiJvN4 / fDAssFiJvN4;
tDEgesFiJvN4 = tDConsFiJvN4 - tDAssFiJvN4;
tDRespFiJvN4 = (cPDFishRefN4 / rPDFiJvN4) * kDRespFiJvN4 * uFunTmFishN4 * aDFiJvN4;
tDMortFiJvN4 = kMortFiJvN4 * aDFiJvN4 +(1.0 - aDSatFiJvN4) * tDEnvFiJvN4;
tDMigrFiJvN4 = kMigrFishN4 *(cDFiJvInN4 - aDFiJvN4);
tDEnvFiAdN4 = MAX(0.0,ukDIncrFiAdN4 /(cDCarrFishN4 - aDFiJvN4) * aDFiAdN4*aDFiAdN4);
tDAssFiAdN4 = aDSatFiAdN4 *(kDAssFiAdN4 * uFunTmFishN4 * aDFiAdN4 - tDEnvFiAdN4);
tDConsFiAdN4 = tDAssFiAdN4 / fDAssFiAdN4;
tDEgesFiAdN4 = tDConsFiAdN4 - tDAssFiAdN4;
tDRespFiAdN4 = (cPDFishRefN4 / rPDFiAdN4) * kDRespFiAdN4 * uFunTmFishN4 * aDFiAdN4;
tDMortFiAdN4 = kMortFiAdN4 * aDFiAdN4 +(1.0 - aDSatFiAdN4) * tDEnvFiAdN4;
tDHarvFishN4 = ukHarvFishN4 * aDFiAdN4;
tDMigrFiAdN4 = kMigrFishN4 *(cDFiAdInN4 - aDFiAdN4);
tDMortFiJvBotN4 = fDBoneN4 * tDMortFiJvN4;
tDMortFiJvDetN4 = tDMortFiJvN4 - tDMortFiJvBotN4;
tDMortFiAdBotN4 = fDBoneN4 * tDMortFiAdN4;
tDMortFiAdDetN4 = tDMortFiAdN4 - tDMortFiAdBotN4;
tPReprFishN4 = rPDFiAdN4 * tDReprFishN4;
tPAgeFishN4 = rPDFiJvN4 * tDAgeFishN4;
tPMigrFiJvN4 = kMigrFishN4 *(cPDFishRefN4 * cDFiJvInN4 - aPFiJvN4);
tPConsFiJvN4 = rPDZooEpiN4 * tDConsFiJvN4;
afPAssFiJvN4 = MIN(1.0,cPDFishRefN4 / rPDZooEpiN4 * fDAssFiJvN4);
tPAssFiJvN4 = afPAssFiJvN4 * tPConsFiJvN4;
tPEgesFiJvN4 = tPConsFiJvN4 - tPAssFiJvN4;
tPExcrFiJvN4 = (rPDFiJvN4 / cPDFishRefN4) * kDRespFiJvN4 * uFunTmFishN4 * aPFiJvN4;
tPMortFiJvN4 = rPDFiJvN4 * tDMortFiJvN4;
tPMigrFiAdN4 = kMigrFishN4 *(cPDFishRefN4 * cDFiAdInN4 - aPFiAdN4);
tPConsFiAdN4 = rPDBentN4 * tDConsFiAdN4;
tPAssFiAdN4 = afPAssFiAdN4 * tPConsFiAdN4;
tPEgesFiAdN4 = tPConsFiAdN4 - tPAssFiAdN4;
tPExcrFiAdN4 = (rPDFiAdN4 / cPDFishRefN4) * kDRespFiAdN4 * uFunTmFishN4 * aPFiAdN4;
tPMortFiAdN4 = rPDFiAdN4 * tDMortFiAdN4;
tPHarvFishN4 = rPDFiAdN4 * tDHarvFishN4;
tPMortFiJvBotN4 = fPBoneN4 * tPMortFiJvN4;
tPMortFiJvPO4N4 = fDissMortFishN4 *(tPMortFiJvN4 - tPMortFiJvBotN4);
tPMortFiJvDetN4 = tPMortFiJvN4 - tPMortFiJvBotN4 - tPMortFiJvPO4N4;
tPMortFiAdBotN4 = fPBoneN4 * tPMortFiAdN4;
tPMortFiAdPO4N4 = fDissMortFishN4 *(tPMortFiAdN4 - tPMortFiAdBotN4);
tPMortFiAdDetN4 = tPMortFiAdN4 - tPMortFiAdBotN4 - tPMortFiAdPO4N4;
tPEgesFiJvPO4N4 = fDissEgesFishN4 * tPEgesFiJvN4;
tPEgesFiJvDetN4 = tPEgesFiJvN4 - tPEgesFiJvPO4N4;
tPEgesFiAdPO4N4 = fDissEgesFishN4 * tPEgesFiAdN4;
tPEgesFiAdDetN4 = tPEgesFiAdN4 - tPEgesFiAdPO4N4;
tNReprFishN4 = rNDFiAdN4 * tDReprFishN4;
tNAgeFishN4 = rNDFiJvN4 * tDAgeFishN4;
tNMigrFiJvN4 = kMigrFishN4 *(cNDFishRefN4 * cDFiJvInN4 - aNFiJvN4);
tNConsFiJvN4 = rNDZooEpiN4 * tDConsFiJvN4;
afNAssFiJvN4 = MIN(1.0,cNDFishRefN4 / rNDZooEpiN4 * fDAssFiJvN4);
tNAssFiJvN4 = afNAssFiJvN4 * tNConsFiJvN4;
tNEgesFiJvN4 = tNConsFiJvN4 - tNAssFiJvN4;
tNExcrFiJvN4 = (rNDFiJvN4 / cNDFishRefN4) * kDRespFiJvN4 * uFunTmFishN4 * aNFiJvN4;
tNMortFiJvN4 = rNDFiJvN4 * tDMortFiJvN4;
tNMigrFiAdN4 = kMigrFishN4 *(cNDFishRefN4 * cDFiAdInN4 - aNFiAdN4);
tNConsFiAdN4 = rNDBentN4 * tDConsFiAdN4;
tNAssFiAdN4 = afNAssFiAdN4 * tNConsFiAdN4;
tNEgesFiAdN4 = tNConsFiAdN4 - tNAssFiAdN4;
tNExcrFiAdN4 = (rNDFiAdN4 / cNDFishRefN4) * kDRespFiAdN4 * uFunTmFishN4 * aNFiAdN4;
tNMortFiAdN4 = rNDFiAdN4 * tDMortFiAdN4;
tNHarvFishN4 = rNDFiAdN4 * tDHarvFishN4;
tNMortFiAdBotN4 = fDBoneN4 * tNMortFiAdN4;
tNMortFiAdNH4N4 = fDissMortFishN4 *(tNMortFiAdN4 - tNMortFiAdBotN4);
tNMortFiAdDetN4 = tNMortFiAdN4 - tNMortFiAdBotN4 - tNMortFiAdNH4N4;
tNMortFiJvBotN4 = fDBoneN4 * tNMortFiJvN4;
tNMortFiJvNH4N4 = fDissMortFishN4 *(tNMortFiJvN4 - tNMortFiJvBotN4);
tNMortFiJvDetN4 = tNMortFiJvN4 - tNMortFiJvBotN4 - tNMortFiJvNH4N4;
tNEgesFiJvNH4N4 = fDissEgesFishN4 * tNEgesFiJvN4;
tNEgesFiJvDetN4 = tNEgesFiJvN4 - tNEgesFiJvNH4N4;
tDMigrPiscN4 = kMigrPiscN4 *(cDPiscInN4 - aDPiscN4);
aDFishN4 = aDFiJvN4 + aDFiAdN4;
aDSatPiscN4 = aDFishN4*aDFishN4 /(hDFishPiscN4*hDFishPiscN4 + aDFishN4*aDFishN4);
tDEnvPiscN4 = MAX(0.0,akDIncrPiscN4 / aDCarrPiscN4 * aDPiscN4*aDPiscN4);
tDAssPiscN4 = aDSatPiscN4 *(kDAssPiscN4 * aFunVegPiscN4 * uFunTmPiscN4 * aDPiscN4 - tDEnvPiscN4);
tDConsPiscN4 = tDAssPiscN4 / fDAssPiscN4;
tDEgesPiscN4 = tDConsPiscN4 - tDAssPiscN4;
tDConsFiJvPiscN4 = aDFiJvN4 / aDFishN4 * tDConsPiscN4;
tDConsFiAdPiscN4 = tDConsPiscN4 - tDConsFiJvPiscN4;
tDMortPiscN4 = kMortPiscN4 * aDPiscN4 +(1.0 - aDSatPiscN4) * tDEnvPiscN4;
tDMortPiscBotN4 = fDBoneN4 * tDMortPiscN4;
tDMortPiscDetN4 = tDMortPiscN4 - tDMortPiscBotN4;
tDHarvPiscN4 = ukHarvPiscN4 * aDPiscN4;
aPPiscN4 = cPDPiscN4 * aDPiscN4;
tPConsFiJvPiscN4 = rPDFiJvN4 * tDConsFiJvPiscN4;
tPConsFiAdPiscN4 = rPDFiAdN4 * tDConsFiAdPiscN4;
tPConsPiscN4 = tPConsFiJvPiscN4 + tPConsFiAdPiscN4;
rPDFoodPiscN4 = tPConsPiscN4 / tDConsPiscN4;
aNPiscN4 = cNDPiscN4 * aDPiscN4;
tNConsFiJvPiscN4 = rNDFiJvN4 * tDConsFiJvPiscN4;
tNConsFiAdPiscN4 = rNDFiAdN4 * tDConsFiAdPiscN4;
tNConsPiscN4 = tNConsFiJvPiscN4 + tNConsFiAdPiscN4;
rNDFoodPiscN4 = tNConsPiscN4 / tDConsPiscN4;
tDConsPiscNutN4 = (tDAssPiscN4 / fDAssPiscN4) * MAX (1.0, cNDPiscN4 / rNDFoodPiscN4 * fDAssPiscN4, cPDPiscN4 / rPDFoodPiscN4 * fDAssPiscN4);
tDEgesPiscNutN4 = tDConsPiscNutN4 - tDAssPiscN4;
tDConsFiJvPiscNutN4 = aDFiJvN4 / aDFishN4 * tDConsPiscNutN4;
tDConsFiAdPiscNutN4 = tDConsPiscNutN4 - tDConsFiJvPiscNutN4;
tPConsFiJvPiscNutN4 = rPDFiJvN4 * tDConsFiJvPiscNutN4;
tPConsFiAdPiscNutN4 = rPDFiAdN4 * tDConsFiAdPiscNutN4;
tPConsPiscNutN4 = tPConsFiJvPiscNutN4 + tPConsFiAdPiscNutN4;
tNConsFiJvPiscNutN4 = rNDFiJvN4 * tDConsFiJvPiscNutN4;
tNConsFiAdPiscNutN4 = rNDFiAdN4 * tDConsFiAdPiscNutN4;
tNConsPiscNutN4 = tNConsFiJvPiscNutN4 + tNConsFiAdPiscNutN4;
afPAssPiscN4 = MIN(1.0, ((cPDPiscN4 / rPDFoodPiscN4 * fDAssPiscN4) / (tDConsPiscNutN4 / tDConsPiscN4 )) );
tPAssPiscN4 = afPAssPiscN4 * tPConsPiscNutN4;
tPEgesPiscN4 = tPConsPiscNutN4 - tPAssPiscN4;
tPEgesPiscPO4N4 = fDissEgesPiscN4 * tPEgesPiscN4;
tPEgesPiscDetN4 = tPEgesPiscN4 - tPEgesPiscPO4N4;
tDRespPiscN4 = kDRespPiscN4 * uFunTmPiscN4 * aDPiscN4;
tPExcrPiscN4 = cPDPiscN4 * tDRespPiscN4;
tPMortPiscN4 = cPDPiscN4 * tDMortPiscN4;
tPMortPiscBotN4 = fPBoneN4 * tPMortPiscN4;
tPMortPiscPO4N4 = fDissMortPiscN4 *(tPMortPiscN4 - tPMortPiscBotN4);
tPMortPiscDetN4 = tPMortPiscN4 - tPMortPiscBotN4 - tPMortPiscPO4N4;
tPMigrPiscN4 = kMigrPiscN4 *(cPDPiscN4 * cDPiscInN4 - aPPiscN4);
tPHarvPiscN4 = cPDPiscN4 * tDHarvPiscN4;
afNAssPiscN4 = MIN(1.0, ((cNDPiscN4 / rNDFoodPiscN4 * fDAssPiscN4) / (tDConsPiscNutN4 / tDConsPiscN4 )) );
tNAssPiscN4 = afNAssPiscN4 * tNConsPiscNutN4;
tNEgesPiscN4 = tNConsPiscNutN4 - tNAssPiscN4;
tNEgesPiscNH4N4 = fDissEgesPiscN4 * tNEgesPiscN4;
tNEgesPiscDetN4 = tNEgesPiscN4 - tNEgesPiscNH4N4;
tNExcrPiscN4 = cNDPiscN4 * tDRespPiscN4;
tNMortPiscN4 = cNDPiscN4 * tDMortPiscN4;
tNMortPiscBotN4 = fDBoneN4 * tNMortPiscN4;
tNMortPiscNH4N4 = fDissMortPiscN4 *(tNMortPiscN4 - tNMortPiscBotN4);
tNMortPiscDetN4 = tNMortPiscN4 - tNMortPiscBotN4 - tNMortPiscNH4N4;
tNMigrPiscN4 = kMigrPiscN4 *(cNDPiscN4 * cDPiscInN4 - aNPiscN4);
tNHarvPiscN4 = cNDPiscN4 * tDHarvPiscN4;
tDWebBentN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tDMigrBentN4 + tDAssBentN4 - tDConsFiAdN4 - tDRespBentN4 - tDMortBentN4 ENDIF;
tPWebBentN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tPMigrBentN4 + tPAssBentN4 - tPConsFiAdN4 - tPExcrBentN4 - tPMortBentN4 ENDIF;
tNWebBentN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tNMigrBentN4 + tNAssBentN4 - tNConsFiAdN4 - tNExcrBentN4 - tNMortBentN4 ENDIF;
tDWebFiJvN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tDMigrFiJvN4 + tDReprFishN4 - tDAgeFishN4 + tDAssFiJvN4 - tDRespFiJvN4 - tDMortFiJvN4 - tDConsFiJvPiscNutN4 ENDIF;
tPWebFiJvN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tPMigrFiJvN4 + tPReprFishN4 - tPAgeFishN4 + tPAssFiJvN4 - tPExcrFiJvN4 - tPMortFiJvN4 - tPConsFiJvPiscNutN4 ENDIF;
tNWebFiJvN4 =IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tNMigrFiJvN4 + tNReprFishN4 - tNAgeFishN4 + tNAssFiJvN4 - tNExcrFiJvN4 - tNMortFiJvN4 - tNConsFiJvPiscNutN4 ENDIF;
tDWebFiAdN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tDMigrFiAdN4 + tDAssFiAdN4 - tDRespFiAdN4 - tDMortFiAdN4 - tDReprFishN4 + tDAgeFishN4 - tDConsFiAdPiscNutN4 - tDHarvFishN4 ENDIF;
tPWebFiAdN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tPMigrFiAdN4 + tPAssFiAdN4 - tPExcrFiAdN4 - tPMortFiAdN4 - tPReprFishN4 + tPAgeFishN4 - tPConsFiAdPiscNutN4 - tPHarvFishN4 ENDIF;
tNWebFiAdN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tNMigrFiAdN4 + tNAssFiAdN4 - tNExcrFiAdN4 - tNMortFiAdN4 - tNReprFishN4 + tNAgeFishN4 - tNConsFiAdPiscNutN4 - tNHarvFishN4 ENDIF;
tDWebPiscN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tDMigrPiscN4 + tDAssPiscN4 - tDRespPiscN4 - tDMortPiscN4 - tDHarvPiscN4 ENDIF;
wDWebZooHypN4 = IF (FALSE EQ InclWebN4 OR aInclStratN4 EQ FALSE) THEN 0.0 ELSE wDAssZooHypN4 - wDRespZooHypN4 - wDMortZooHypN4 - tDConsFiJvN4 * (( aDTotZooN4 - oDZooEpiN4 * uDepthWEpiN4) / (aDTotZooN4 + NearZeroN4)) / uDepthWHypN4 ENDIF;
wDWebDetWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsDetZooHypN4 + wDEgesZooHypN4 + wDMortZooHypN4 +(tDEgesFiJvN4 * uFiJvEgesHypN4 + tDEgesFiAdN4 * uFiAdEgesHypN4 + tDMortFiJvDetN4 * uFiJvMortHypN4 + tDMortFiAdDetN4 * uFiAdMortHypN4 + tDEgesPiscNutN4 * uPiscEgesHypN4 + tDMortPiscDetN4 * uPiscMortHypN4) / uDepthWHypN4 ENDIF;
wDWebDiatWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsDiatZooHypN4 ENDIF;
wDWebGrenWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsGrenZooHypN4 ENDIF;
wDWebBlueWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsBlueZooHypN4 ENDIF;
wDWebZooEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wDAssZooEpiN4 - wDRespZooEpiN4 - wDMortZooEpiN4 - tDConsFiJvN4 * (oDZooEpiN4 * uDepthWEpiN4 / (aDTotZooN4 + NearZeroN4) ) / uDepthWEpiN4 ENDIF;
wDWebDetWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsDetZooEpiN4 + wDEgesZooEpiN4 + wDMortZooEpiN4 +(tDEgesFiJvN4 * ( 1.0 - uFiJvEgesHypN4 ) + tDEgesFiAdN4 * ( 1.0 - uFiAdEgesHypN4 ) + tDMortFiJvDetN4 * ( 1.0 - uFiJvMortHypN4 ) + tDMortFiAdDetN4 * ( 1.0 - uFiAdMortHypN4 ) + tDEgesPiscNutN4 * ( 1.0 - uPiscEgesHypN4 ) + tDMortPiscDetN4 * ( 1.0 - uPiscMortHypN4)) / uDepthWEpiN4 ENDIF;
wDWebDiatWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsDiatZooEpiN4 ENDIF;
wDWebGrenWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsGrenZooEpiN4 ENDIF;
wDWebBlueWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDConsBlueZooEpiN4 ENDIF;
tDWebBlueSurfN4 = IF (InclWebN4 EQ FALSE OR InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE - tDConsBlueZooSurfN4 ENDIF;
tDWebTotTN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wDRespZooEpiN4 * uDepthWEpiN4 - wDRespZooHypN4 * uDepthWHypN4 + tDMigrFiJvN4 + tDMigrFiAdN4 + tDMigrPiscN4 + tDMigrBentN4 - tDRespFiJvN4 - tDRespFiAdN4 - tDRespPiscN4 - tDRespBentN4 - tDMortFiJvBotN4 - tDMortFiAdBotN4- tDMortPiscBotN4 - tDHarvFishN4 - tDHarvPiscN4 ENDIF;
wPWebZooHypN4 = IF (FALSE EQ InclWebN4 OR aInclStratN4 EQ FALSE) THEN 0.0 ELSE wPAssZooHypN4 - wPExcrZooHypN4 - wPMortZooHypN4 - tPConsFiJvN4 * (( aPTotZooN4 - oPZooEpiN4 * uDepthWEpiN4 ) / (aPTotZooN4 + NearZeroN4) ) / uDepthWHypN4 ENDIF;
wPWebPO4WHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wPExcrZooHypN4 + wPEgesZooPO4HypN4 + wPMortZooPO4HypN4 +(tPExcrFiJvN4 *uFiJvExcrHypN4 + tPExcrFiAdN4 * uFiAdExcrHypN4 + tPEgesFiJvPO4N4 * uFiJvEgesHypN4 + tPEgesFiAdPO4N4 * uFiAdEgesHypN4 + tPMortFiJvPO4N4 * uFiJvMortHypN4 + tPMortFiAdPO4N4 * uFiAdMortHypN4+ tPExcrPiscN4 * uPiscExcrHypN4 + tPEgesPiscPO4N4 * uPiscEgesHypN4 + tPMortPiscPO4N4 * uPiscMortHypN4 ) / uDepthWHypN4 ENDIF;
wPWebDetWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsDetZooHypN4 + wPEgesZooDetHypN4 + wPMortZooDetHypN4 +(tPEgesFiJvDetN4 * uFiJvEgesHypN4 + tPEgesFiAdDetN4 * uFiAdEgesHypN4+ tPMortFiJvDetN4 * uFiJvMortHypN4 + tPMortFiAdDetN4 * uFiAdMortHypN4+ tPEgesPiscDetN4 * uPiscEgesHypN4+ tPMortPiscDetN4 * uPiscMortHypN4) / uDepthWHypN4 ENDIF;
wPWebDiatWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsDiatZooHypN4 ENDIF;
wPWebGrenWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsGrenZooHypN4 ENDIF;
wPWebBlueWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsBlueZooHypN4 ENDIF;
wPWebZooEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wPAssZooEpiN4 - wPExcrZooEpiN4 - wPMortZooEpiN4 - tPConsFiJvN4 * (oPZooEpiN4 * uDepthWEpiN4 / (aPTotZooN4 + NearZeroN4)) / uDepthWEpiN4 ENDIF;
wPWebPO4WEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wPExcrZooEpiN4 + wPEgesZooPO4EpiN4 + wPMortZooPO4EpiN4 +(tPExcrFiJvN4 * ( 1.0 -uFiJvExcrHypN4 ) + tPExcrFiAdN4 * ( 1.0 - uFiAdExcrHypN4 )+ tPEgesFiJvPO4N4 * ( 1.0 - uFiJvEgesHypN4 ) + tPEgesFiAdPO4N4 * ( 1.0 - uFiAdEgesHypN4 ) + tPMortFiJvPO4N4 * ( 1.0 - uFiJvMortHypN4 ) + tPMortFiAdPO4N4 * ( 1.0 - uFiAdMortHypN4 )+ tPExcrPiscN4 * ( 1.0 - uPiscExcrHypN4 ) + tPEgesPiscPO4N4 * ( 1.0 - uPiscEgesHypN4 ) + tPMortPiscPO4N4 * ( 1.0 - uPiscMortHypN4)) / uDepthWEpiN4 ENDIF;
wPWebDetWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsDetZooEpiN4 + wPEgesZooDetEpiN4 + wPMortZooDetEpiN4 +(tPEgesFiJvDetN4 * ( 1.0 - uFiJvEgesHypN4 ) + tPEgesFiAdDetN4 * ( 1.0 - uFiAdEgesHypN4 )+ tPMortFiJvDetN4 * ( 1.0 - uFiJvMortHypN4 ) + tPMortFiAdDetN4 * ( 1.0 - uFiAdMortHypN4 )+ tPEgesPiscDetN4 * ( 1.0 - uPiscEgesHypN4 )+ tPMortPiscDetN4 * ( 1.0 - uPiscMortHypN4 )) / uDepthWEpiN4 ENDIF;
wPWebDiatWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsDiatZooEpiN4 ENDIF;
wPWebGrenWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsGrenZooEpiN4 ENDIF;
wPWebBlueWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wPConsBlueZooEpiN4 ENDIF;
tPWebBlueSurfN4 = IF (InclWebN4 EQ FALSE OR InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE - tPConsBlueZooSurfN4 ENDIF;
tPWebTotTN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tPMigrFiJvN4 + tPMigrFiAdN4 + tPMigrPiscN4 + tPMigrBentN4 - tPMortFiJvBotN4 - tPMortFiAdBotN4- tPMortPiscBotN4 - tPHarvFishN4 - tPHarvPiscN4 ENDIF;
tNEgesFiAdNH4N4 = fDissEgesFishN4 * tNEgesFiAdN4;
tNEgesFiAdDetN4 = tNEgesFiAdN4 - tNEgesFiAdNH4N4;
wNWebNO3WHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE 0.0 ENDIF;
wNWebNO3WEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE 0.0 ENDIF;
wNWebZooHypN4 = IF (FALSE EQ InclWebN4 OR aInclStratN4 EQ FALSE) THEN 0.0 ELSE wNAssZooHypN4 - wNExcrZooHypN4 - wNMortZooHypN4 - tNConsFiJvN4 * (( aNTotZooN4 -oNZooEpiN4 * uDepthWEpiN4 ) / (aNTotZooN4 + NearZeroN4) ) / uDepthWHypN4 ENDIF;
wNWebNH4WHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wNExcrZooHypN4 + wNEgesZooNH4HypN4 + wNMortZooNH4HypN4 +(tNExcrFiJvN4 * uFiJvExcrHypN4 + tNExcrFiAdN4 * uFiAdExcrHypN4 + tNEgesFiJvNH4N4 * uFiJvEgesHypN4+ tNEgesFiAdNH4N4 * uFiAdEgesHypN4 + tNMortFiAdNH4N4 *uFiAdMortHypN4+ tNMortFiJvNH4N4*uFiJvMortHypN4 + tNExcrPiscN4 *uPiscExcrHypN4 + tNEgesPiscNH4N4 *uPiscEgesHypN4 + tNMortPiscNH4N4 *uPiscMortHypN4) / uDepthWHypN4 ENDIF;
wNWebDetWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsDetZooHypN4 + wNEgesZooDetHypN4 + wNMortZooDetHypN4 +(tNEgesFiJvDetN4 * uFiJvEgesHypN4 +tNEgesFiAdDetN4 * uFiAdEgesHypN4+ tNMortFiJvDetN4 * uFiJvMortHypN4 + tNMortFiAdDetN4 * uFiAdMortHypN4 + tNEgesPiscDetN4 * uPiscEgesHypN4 + tNMortPiscDetN4 * uPiscMortHypN4) / uDepthWHypN4 ENDIF;
wNWebDiatWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsDiatZooHypN4 ENDIF;
wNWebGrenWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsGrenZooHypN4 ENDIF;
wNWebBlueWHypN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsBlueZooHypN4 ENDIF;
wNWebZooEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wNAssZooEpiN4 - wNExcrZooEpiN4 - wNMortZooEpiN4 - tNConsFiJvN4 * (oNZooEpiN4 * uDepthWEpiN4 / (aNTotZooN4 + NearZeroN4) ) / uDepthWEpiN4 ENDIF;
wNWebNH4WEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wNExcrZooEpiN4 + wNEgesZooNH4EpiN4 + wNMortZooNH4EpiN4 +(tNExcrFiJvN4 * ( 1.0 - uFiJvExcrHypN4) + tNExcrFiAdN4 * ( 1.0 - uFiAdExcrHypN4) + tNEgesFiJvNH4N4 * ( 1.0 - uFiJvEgesHypN4 ) + tNEgesFiAdNH4N4 * ( 1.0 - uFiAdEgesHypN4 ) + tNMortFiAdNH4N4 * ( 1.0 -uFiAdMortHypN4 ) + tNMortFiJvNH4N4* ( 1.0 -uFiJvMortHypN4) + tNExcrPiscN4 * ( 1.0 -uPiscExcrHypN4 ) + tNEgesPiscNH4N4 * ( 1.0 -uPiscEgesHypN4 ) + tNMortPiscNH4N4 * ( 1.0 -uPiscMortHypN4)) / uDepthWEpiN4 ENDIF;
wNWebDetWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsDetZooEpiN4 + wNEgesZooDetEpiN4 + wNMortZooDetEpiN4 +(tNEgesFiJvDetN4 * ( 1.0 - uFiJvEgesHypN4 ) +tNEgesFiAdDetN4 * ( 1.0 - uFiAdEgesHypN4 ) + tNMortFiJvDetN4 * ( 1.0 - uFiJvMortHypN4 ) + tNMortFiAdDetN4 * ( 1.0 - uFiAdMortHypN4 ) + tNEgesPiscDetN4 * ( 1.0 - uPiscEgesHypN4 ) + tNMortPiscDetN4 * ( 1.0 - uPiscMortHypN4 )) / uDepthWEpiN4 ENDIF;
wNWebDiatWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsDiatZooEpiN4 ENDIF;
wNWebGrenWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsGrenZooEpiN4 ENDIF;
wNWebBlueWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE - wNConsBlueZooEpiN4 ENDIF;
tNWebBlueSurfN4 = IF (InclWebN4 EQ FALSE OR InclSurfN4 EQ FALSE OR aDBlueSurfN4 LT cDBlueSurfMinN4) THEN 0.0 ELSE - tNConsBlueZooSurfN4 ENDIF;
tNWebTotTN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE tNMigrFiJvN4 + tNMigrFiAdN4 + tNMigrPiscN4 + tNMigrBentN4 - tNMortFiJvBotN4- tNMortFiAdBotN4 - tNMortPiscBotN4 - tNHarvFishN4 - tNHarvPiscN4 ENDIF;
wSiWebDetWEpiN4 = IF (FALSE EQ InclWebN4) THEN 0.0 ELSE wSiConsDiatZooEpiN4 ENDIF;
aPrefAveEpiN4 = (cPrefDiatN4 * oDDiatWEpiN4 + cPrefGrenN4 * oDGrenWEpiN4 + cPrefBlueN4 * oDBlueWEpiN4 + cPrefDetN4 * oDDetWEpiN4) / oDOMWEpiN4;
wDConsZoo2EpiN4 = aFiltEpiN4 * aPrefAveEpiN4 * oDOMWEpiN4 * oDZooEpiN4;
aDConsZooSpEpiN4 = wDConsZooEpiN4 / oDZooEpiN4;
aDAssZooSpEpiN4 = wDAssZooEpiN4 / oDZooEpiN4;
aDGrazSpEpiN4 = wDConsZooEpiN4 / oDOMWEpiN4;
aPConsZooSpEpiN4 = wPConsZooEpiN4 / oPZooEpiN4;
aPGrazSpEpiN4 = wPConsZooEpiN4 / oPOMWEpiN4;
aNConsZooSpEpiN4 = wNConsZooEpiN4 / oNZooEpiN4;
aNGrazSpEpiN4 = wNConsZooEpiN4 / oNOMWEpiN4;
tDSetTotEpiN4 = tDSetIMEpiN4 + tDSetDetEpiN4 + tDSetPhytEpiN4;
tPSetTotEpiN4 = tPSetAIMEpiN4 + tPSetDetEpiN4 + tPSetPhytEpiN4;
tNSetTotEpiN4 = tNSetDetEpiN4 + tNSetPhytEpiN4;
tDResusTotN4 = tDResusDeadN4 + tDResusPhytTotN4;
tPResusTotN4 = tPResusDetN4 + tPResusAIMN4 + tPResusPhytN4 + tPResusPO4N4;
tNResusTotN4 = tNResusDetN4 + tNResusNH4N4 + tNResusNO3N4 + tNResusPhytN4;
aDepthStartN4 = IF (sTimeN4 EQ bTimeDredN4) THEN uDepthWN4 ELSE aDepthStartN4 ENDIF;
akDredDepthN4 = IF ((sTimeN4 GE bTimeDredN4) AND (sTimeN4 LT bTimeDredN4 + cLengDredN4) AND (aDepthStartN4 LE cDepthRefN4 - cDepthSN4)) THEN (LN(cDepthRefN4 / aDepthStartN4)) / cLengDredN4 ELSE 0.0 ENDIF;
akDredN4 = IF ((sTimeN4 GE bTimeDredN4) AND (sTimeN4 LT bTimeDredN4 + cLengDredN4) AND (aDepthStartN4 LE cDepthRefN4 - cDepthSN4)) THEN (- LN(1.0 - fEffDredN4)) / cLengDredN4 ELSE 0.0 ENDIF;
akDredBentN4 = IF ((sTimeN4 GE bTimeDredN4) AND (sTimeN4 LT bTimeDredN4 + cLengDredN4) AND (aDepthStartN4 LE cDepthRefN4 - cDepthSN4)) THEN (- LN(1.0 - fEffDredBentN4)) / cLengDredN4 ELSE 0.0 ENDIF;
vDredDepthWN4 =IF (aInclStratN4 EQ TRUE) THEN 0.0 ELSE akDredDepthN4 * uDepthWN4 ENDIF;
tDDredDetSN4 = akDredN4 * aDDetSN4;
tPDredDetSN4 = akDredN4 * aPDetSN4;
tNDredDetSN4 = akDredN4 * aNDetSN4;
tSiDredDetSN4 = akDredN4 * aSiDetSN4;
tPDredAIMSN4 = akDredN4 * aPAIMSN4;
tDDredNetSoilN4 = -(tDDredDetSN4 / cRhoOMN4) * bRhoSolidSoilN4;
tDDredNetIMSN4 = (1.0 - fDOrgSoilN4) * tDDredNetSoilN4;
tDDredNetHumSN4 = fDOrgSoilN4 * tDDredNetSoilN4;
tPDredNetHumSN4 = cPDSoilOMN4 * tDDredNetHumSN4;
tNDredNetHumSN4 = cNDSoilOMN4 * tDDredNetHumSN4;
tDDredDiatSN4 = akDredN4 * aDDiatSN4;
tPDredDiatSN4 = akDredN4 * aPDiatSN4;
tNDredDiatSN4 = akDredN4 * aNDiatSN4;
tDDredGrenSN4 = akDredN4 * aDGrenSN4;
tPDredGrenSN4 = akDredN4 * aPGrenSN4;
tNDredGrenSN4 = akDredN4 * aNGrenSN4;
tDDredBlueSN4 = akDredN4 * aDBlueSN4;
tPDredBlueSN4 = akDredN4 * aPBlueSN4;
tNDredBlueSN4 = akDredN4 * aNBlueSN4;
tDDredPhytSN4 = tDDredDiatSN4+tDDredGrenSN4+tDDredBlueSN4;
tPDredPhytSN4 = tPDredDiatSN4+tPDredGrenSN4+tPDredBlueSN4;
tNDredPhytSN4 = tNDredDiatSN4+tNDredGrenSN4+tNDredBlueSN4;
tDDredBentN4 = IF (InclWebN4 EQ TRUE) THEN akDredBentN4 * aDBentN4 ELSE 0.0 ENDIF;
tPDredBentN4 = IF (InclWebN4 EQ TRUE) THEN akDredBentN4 * aPBentN4 ELSE 0.0 ENDIF;
tNDredBentN4 = IF (InclWebN4 EQ TRUE) THEN akDredBentN4 * aNBentN4 ELSE 0.0 ENDIF;
tDDredVegN4 = akDredN4 * aDVegN4;
tPDredVegN4 = akDredN4 * aPVegN4;
tNDredVegN4 = akDredN4 * aNVegN4;
tDDredNetTotN4 = tDDredDetSN4 - tDDredNetSoilN4 + tDDredPhytSN4 + tDDredBentN4 + tDDredVegN4;
tPDredNetTotN4 = tPDredDetSN4 - tPDredNetHumSN4 + tPDredAIMSN4 + tPDredPhytSN4 + tPDredBentN4 + tPDredVegN4;
tNDredNetTotN4 = tNDredDetSN4 - tNDredNetHumSN4 + tNDredPhytSN4 + tNDredBentN4 + tNDredVegN4;
tSiDredTotN4 = tSiDredDetSN4 + cSiDDiatN4 * tDDredDiatSN4;
tDIMSN4 = tDAbioIMSN4;
tDHumSN4 = tDAbioHumSN4;
tDDetSN4 = tDAbioDetSN4 + tDPrimDetSN4 + tDWebDetSN4 + tDBedDetSEpiN4 + tDBedDetSHypN4;
vDeltaSN4 = (tDIMSN4 / cRhoIMN4 +(tDHumSN4 + tDDetSN4) / cRhoOMN4)/(1.0 - bPorSN4);
vDeltaWN4 = IF (ConstDepthN4 EQ TRUE ) THEN 0.0 ELSE - vDeltaSN4 ENDIF;
tDBurIMN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN ((tDHumSN4 + tDDetSN4) +(cRhoOMN4 / cRhoIMN4) * tDIMSN4) / ((aDHumSN4 + aDDetSN4) / aDIMSN4 + cRhoOMN4 / cRhoIMN4) ELSE ((tDHumSN4 + tDDetSN4) +(cRhoOMN4 / cRhoIMN4) * tDIMSN4) / (fDOrgSoilN4 /(1.0 - fDOrgSoilN4) + cRhoOMN4 / cRhoIMN4) ENDIF;
tDBurOMN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN (aDHumSN4 + aDDetSN4) / aDIMSN4 * tDBurIMN4 ELSE fDOrgSoilN4 /(1.0 - fDOrgSoilN4) * tDBurIMN4 ENDIF;
tDBurDetN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN aDDetSN4 /(aDHumSN4 + aDDetSN4) * tDBurOMN4 ELSE 0.0 ENDIF;
tDBurHumN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN tDBurOMN4 - tDBurDetN4 ELSE tDBurOMN4 ENDIF;
tDBurTotN4 =IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN4 GE 0.0) THEN tDBurIMN4 + tDBurOMN4 ELSE tDBurIMN4 + tDBurOMN4 ENDIF;
tPBurHumN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN rPDHumSN4 * tDBurHumN4 ELSE cPDSoilOMN4 * tDBurHumN4 ENDIF;
tPBurDetN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF(vDeltaSN4 GE 0.0) THEN rPDDetSN4 * tDBurDetN4 ELSE 0.0 ENDIF;
tPBurAIMN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN aPAIMSN4 / aDIMSN4 * tDBurIMN4 ELSE 0.0 ENDIF;
tPBurPO4N4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN aPO4SN4 *(vDeltaSN4 / cDepthSN4) ELSE cPO4GroundN4 *(bPorSN4 * vDeltaSN4) ENDIF;
tPBurTotN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN tPBurDetN4 + tPBurHumN4 + tPBurAIMN4 + tPBurPO4N4 ELSE tPBurHumN4 + tPBurAIMN4 + tPBurPO4N4 ENDIF;
tNBurHumN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN rNDHumSN4 * tDBurHumN4 ELSE cNDSoilOMN4 * tDBurHumN4 ENDIF;
tNBurDetN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN rNDDetSN4 * tDBurDetN4 ELSE 0.0 ENDIF;
tNBurNH4N4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN aNH4SN4 *(vDeltaSN4 / cDepthSN4) ELSE cNH4GroundN4 *(bPorSN4 * vDeltaSN4) ENDIF;
tNBurNO3N4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN aNO3SN4 *(vDeltaSN4 / cDepthSN4) ELSE cNO3GroundN4 *(bPorSN4 * vDeltaSN4) ENDIF;
tNBurTotN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN tNBurDetN4 + tNBurHumN4 + tNBurNH4N4 + tNBurNO3N4 ELSE tNBurHumN4 + tNBurNH4N4 + tNBurNO3N4 ENDIF;
tSiBurDetN4 = IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN rSiDDetSN4 * tDBurDetN4 ELSE 0.0 ENDIF;
tSiBurTotN4 =IF (InclBurN4 EQ FALSE) THEN 0.0 ELSEIF (vDeltaSN4 GE 0.0) THEN tSiBurDetN4 ELSE 0.0 ENDIF;
aRelDeltaWEpiN4 = IF ( aInclStratN4 EQ TRUE ) THEN (vDeltaWN4 ) / uDepthWEpiN4 ELSE (vDeltaWN4 + vDredDepthWN4) / uDepthWEpiN4 ENDIF;
aRelDeltaWHypN4 = IF ( aInclStratN4 EQ FALSE ) THEN 0.0 ELSE (vDeltaWN4 + vDredDepthWN4) / uDepthWHypN4 ENDIF ;
aPFishN4 = aPFiJvN4 + aPFiAdN4;
aNFishN4 = aNFiJvN4 + aNFiAdN4;
aDRelTotTN4 = uDepthWHypN4 * aRelDeltaWHypN4 * ( oDDetWHypN4 + oDIMWHypN4 + oDDiatWHypN4 + oDGrenWHypN4 + oDBlueWHypN4 + oDZooHypN4 ) + fMarshN4 * uDepthWMN4 * aRelDeltaWMN4 * ( oDDetWMN4 + oDIMWMN4 + oDDiatWMN4 + oDGrenWMN4 + oDBlueWMN4 + oDZooMN4) + uDepthWEpiN4 * aRelDeltaWEpiN4 * (oDDetWEpiN4 + oDIMWEpiN4 + oDDiatWEpiN4 + oDGrenWEpiN4 + oDBlueWEpiN4 + oDZooEpiN4 );
aNRelTotTN4 = uDepthWHypN4 * aRelDeltaWHypN4 * ( oNH4WHypN4 + oNO3WHypN4 + oNDetWHypN4 + oNDiatWHypN4 + oNGrenWHypN4 + oNBlueWHypN4 + oNZooHypN4 ) + fMarshN4 * uDepthWMN4 * aRelDeltaWMN4 * ( oNH4WMN4 + oNO3WMN4 + oNDetWMN4 + oNDiatWMN4 + oNGrenWMN4 + oNBlueWMN4 + oNZooMN4 ) + uDepthWEpiN4 * aRelDeltaWEpiN4 * ( oNH4WEpiN4 + oNO3WEpiN4 + oNDetWEpiN4 + oNDiatWEpiN4 + oNGrenWEpiN4 + oNBlueWEpiN4 + oNZooEpiN4 );
aPRelTotTN4 = uDepthWHypN4 * aRelDeltaWHypN4 * ( oPO4WHypN4 + oPAIMWHypN4 + oPDetWHypN4 + oPDiatWHypN4 + oPGrenWHypN4 + oPBlueWHypN4 + oPZooHypN4 ) + fMarshN4 * uDepthWMN4 * aRelDeltaWMN4 * (oPO4WMN4 + oPAIMWMN4 + oPDetWMN4 + oPDiatWMN4 + oPGrenWMN4 + oPBlueWMN4 + oPZooMN4 ) + uDepthWEpiN4 * aRelDeltaWEpiN4 * (oPO4WEpiN4 + oPAIMWEpiN4 + oPDetWEpiN4 + oPDiatWEpiN4 + oPGrenWEpiN4 + oPBlueWEpiN4 + oPZooEpiN4 );
aSiRelTotTN4 = uDepthWHypN4 * aRelDeltaWHypN4 * ( oSiO2WHypN4 + oSiDetWHypN4 + cSiDDiatN4*oDDiatWHypN4) + fMarshN4 * uDepthWMN4 * aRelDeltaWMN4 * ( oSiO2WMN4 + oSiDetWMN4 + cSiDDiatN4*oDDiatWMN4) + uDepthWEpiN4 * aRelDeltaWEpiN4 * ( oSiO2WEpiN4 + oSiDetWEpiN4 + cSiDDiatN4*oDDiatWEpiN4);
aO2RelTotTN4 = uDepthWHypN4 * aRelDeltaWHypN4* oO2WHypN4 + fMarshN4 * uDepthWMN4 * aRelDeltaWMN4 * oO2WMN4 + uDepthWEpiN4 * aRelDeltaWEpiN4 * oO2WEpiN4 ;
aDTotTHypN4 = IF (aInclStratN4 EQ TRUE) THEN (oDIMWHypN4+oDDetWHypN4+oDDiatWHypN4+oDGrenWHypN4+oDBlueWHypN4+oDZooHypN4) * uDepthWHypN4 ELSE 0.0 ENDIF;
aNTotTHypN4 = IF (aInclStratN4 EQ TRUE) THEN (oNH4WHypN4+oNO3WHypN4+oNDetWHypN4+oNDiatWHypN4+oNGrenWHypN4+oNBlueWHypN4 +oNZooHypN4)*uDepthWHypN4 ELSE 0.0 ENDIF;
aPTotTHypN4 = IF (aInclStratN4 EQ TRUE) THEN (oPO4WHypN4+oPDetWHypN4+oPDiatWHypN4+oPGrenWHypN4+oPBlueWHypN4 +oPZooHypN4+oPAIMWHypN4) * uDepthWHypN4 ELSE 0.0 ENDIF;
aSiTotTHypN4 = IF (aInclStratN4 EQ TRUE) THEN (oSiO2WHypN4 + oSiDetWHypN4 + cSiDDiatN4*oDDiatWHypN4) *uDepthWHypN4 ELSE 0.0 ENDIF;
aO2TotTHypN4 = IF (aInclStratN4 EQ TRUE) THEN (oO2WHypN4 ) *uDepthWHypN4 ELSE 0.0 ENDIF;
aDTotTN4 = aDTotTHypN4 + (oDIMWEpiN4+oDDetWEpiN4+oDDiatWEpiN4+oDGrenWEpiN4+oDBlueWEpiN4+oDZooEpiN4) * uDepthWEpiN4 +aDFishN4+aDPiscN4+aDVegN4 +aDIMSN4+aDHumSN4+aDDetSN4+aDDiatSN4+aDGrenSN4+aDBlueSN4+aDBentN4 + aDTotMN4 + aDBlueSurfN4;
aNTotTN4 = aNTotTHypN4+ (oNH4WEpiN4+oNO3WEpiN4+oNDetWEpiN4+oNDiatWEpiN4+oNGrenWEpiN4+oNBlueWEpiN4 +oNZooEpiN4)*uDepthWEpiN4 +aNFishN4+aNPiscN4+aNVegN4 +aNH4SN4+aNO3SN4+aNDetSN4+aNHumSN4+aNDiatSN4+aNGrenSN4+aNBlueSN4 +aNBentN4 + aNTotMN4 + aNBlueSurfN4;
aPTotTN4 = aPTotTHypN4 + (oPO4WEpiN4+oPDetWEpiN4+oPDiatWEpiN4+oPGrenWEpiN4+oPBlueWEpiN4 +oPZooEpiN4+oPAIMWEpiN4) * uDepthWEpiN4 +aPFishN4+aPPiscN4+aPVegN4 +aPO4SN4+aPDetSN4+aPHumSN4+aPDiatSN4+aPGrenSN4+aPBlueSN4 +aPAIMSN4+aPBentN4 + aPTotMN4 +aPBlueSurfN4;
aSiTotTN4 = aSiTotTHypN4 + (oSiO2WEpiN4 + oSiDetWEpiN4 + cSiDDiatN4*oDDiatWEpiN4) *uDepthWEpiN4 + aSiDetSN4 + cSiDDiatN4*aDDiatSN4 + aSiTotMN4;
aO2TotTN4 = aO2TotTHypN4 + ( oO2WEpiN4) *uDepthWEpiN4 + aO2TotMN4;
tDBedTotTN4 = IF InclVegN4 EQ TRUE THEN tDMigrVegN4 + tDProdVegHypN4+ tDProdVegEpiN4 - tDRespVegN4 - tDManVegN4 - tDAssVegBirdN4 ELSE 0.0 ENDIF;
tPBedTotTN4 = IF InclVegN4 EQ TRUE THEN tPMigrVegN4 - tPManVegN4 - tPAssVegBirdN4 ELSE 0.0 ENDIF;
tNBedTotTN4 = IF InclVegN4 EQ TRUE THEN tNMigrVegN4 - tNManVegN4 - tNAssVegBirdN4 ELSE 0.0 ENDIF ;
aDErrorN4 = aDTotTN4 - aDExtTotTN4;
aNErrorN4 = aNTotTN4 - aNExtTotTN4;
aPErrorN4 = aPTotTN4 - aPExtTotTN4;
aSiErrorN4 = aSiTotTN4 - aSiExtTotTN4;
aO2ErrorN4 = aO2TotTN4 - aO2ExtTotTN4;
aDepthErrorN4 = sDepthWN4 - aDepthExtTotTN4;
cCheckVegHeightN4 = IF ( aVegWinN4 EQ 1 AND  uVegHeightN4 LT MIN (cVegHeightWinN4, uDepthWN4) ) THEN 1.0 ELSEIF ( aVegWinN4 EQ 1 AND  uVegHeightN4 GT MIN (cVegHeightWinN4, uDepthWN4) ) THEN 2.0 ELSEIF ( aVegWinN4 EQ 0 AND  uVegHeightN4 LT MIN (cVegHeightN4, uDepthWN4) ) THEN  3.0 ELSEIF ( aVegWinN4 EQ 0 AND  uVegHeightN4 GT MIN (cVegHeightN4, uDepthWN4) ) THEN 4.0 ELSE 0.0 ENDIF;
wPTranPO4WEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilPO4EpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranAIMWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilAIMEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranGrenEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranDiatEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranBlueEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranDetWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilDetEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranZooEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wPDilZooEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranNH4WEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilNH4EpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranNO3WEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilNO3EpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranGrenEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranDiatEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranBlueEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranDetWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilDetEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranZooEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wNDilZooEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranDetWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilDetEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranIMWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilIMEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranGrenEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranDiatEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranBlueEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranZooEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wDDilZooEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wSiTranSiO2EpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wSiDilSiO2EpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wSiTranDetWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wSiDilDetEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wO2TranWEpiUpstN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE ((wO2OutflEpiN0 * uDepthWEpiN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranPO4WHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilPO4HypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranAIMWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilAIMHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranGrenHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilGrenHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranDiatHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilDiatHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranBlueHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilBlueHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranDetWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilDetHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wPTranZooHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wPDilZooHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranNH4WHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilNH4HypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranNO3WHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilNO3HypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranGrenHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilGrenHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranDiatHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilDiatHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranBlueHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilBlueHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranDetWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilDetHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wNTranZooHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wNDilZooHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranDetWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilDetHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranIMWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilIMHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranGrenHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilGrenHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranDiatHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilDiatHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranBlueHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilBlueHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranZooHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wDDilZooHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wSiTranSiO2HypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wSiDilSiO2HypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wSiTranDetWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wSiDilDetHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wO2TranWHypUpstN1 = IF ((FALSE EQ InclTranN1) OR (aInclStratN1 EQ FALSE)) THEN 0.0 ELSE ((wO2OutflHypN0 * uDepthWHypN0 * mFracN0N1 * ( mSurfAreaN0 / mSurfAreaN1 )) / uDepthWEpiN1) ENDIF;
wDTranWEpiUpstTotN1 = wDTranDetWEpiUpstN1 + wDTranIMWEpiUpstN1 + wDTranGrenEpiUpstN1 + wDTranDiatEpiUpstN1 + wDTranBlueEpiUpstN1;
wNTranWEpiUpstTotN1 = wNTranNH4WEpiUpstN1 + wNTranNO3WEpiUpstN1 + wNTranGrenEpiUpstN1 + wNTranDiatEpiUpstN1 + wNTranBlueEpiUpstN1 + wNTranDetWEpiUpstN1;
wO2TranWEpiUpstTotN1 = wO2TranWEpiUpstN1;
wPTranWEpiUpstTotN1 = wPTranPO4WEpiUpstN1 + wPTranAIMWEpiUpstN1 + wPTranGrenEpiUpstN1 + wPTranDiatEpiUpstN1 + wPTranBlueEpiUpstN1 + wPTranDetWEpiUpstN1;
wSiTranWEpiUpstTotN1 = wSiTranSiO2EpiUpstN1 + wSiTranDetWEpiUpstN1 + (cSiDDiatN1 * wDTranDiatEpiUpstN1);
wDTranWHypUpstTotN1 = wDTranDetWHypUpstN1 + wDTranIMWHypUpstN1 + wDTranGrenHypUpstN1 + wDTranDiatHypUpstN1 + wDTranBlueHypUpstN1;
wNTranWHypUpstTotN1 = wNTranNH4WHypUpstN1 + wNTranNO3WHypUpstN1 + wNTranGrenHypUpstN1 + wNTranDiatHypUpstN1 + wNTranBlueHypUpstN1 + wNTranDetWHypUpstN1;
wO2TranWHypUpstTotN1 = wO2TranWHypUpstN1;
wPTranWHypUpstTotN1 = wPTranPO4WHypUpstN1 + wPTranAIMWHypUpstN1 + wPTranGrenHypUpstN1 + wPTranDiatHypUpstN1 + wPTranBlueHypUpstN1 + wPTranDetWHypUpstN1;
wSiTranWHypUpstTotN1 = wSiTranSiO2HypUpstN1 + wSiTranDetWHypUpstN1 + (cSiDDiatN1 * wDTranDiatHypUpstN1);
wPTranPO4WEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilPO4EpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranAIMWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilAIMEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranGrenEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranDiatEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranBlueEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranDetWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilDetEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranZooEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wPDilZooEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranNH4WEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilNH4EpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranNO3WEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilNO3EpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranGrenEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranDiatEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranBlueEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranDetWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilDetEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranZooEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wNDilZooEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranDetWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilDetEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranIMWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilIMEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranGrenEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilGrenEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranDiatEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilDiatEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranBlueEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilBlueEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranZooEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wDDilZooEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wSiTranSiO2EpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wSiDilSiO2EpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wSiTranDetWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wSiDilDetEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wO2TranWEpiUpstN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE ((wO2OutflEpiN0 * uDepthWEpiN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranPO4WHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilPO4HypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranAIMWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilAIMHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranGrenHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilGrenHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranDiatHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilDiatHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranBlueHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilBlueHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranDetWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilDetHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wPTranZooHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wPDilZooHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranNH4WHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilNH4HypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranNO3WHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilNO3HypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranGrenHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilGrenHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranDiatHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilDiatHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranBlueHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilBlueHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranDetWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilDetHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wNTranZooHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wNDilZooHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranDetWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilDetHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranIMWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilIMHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranGrenHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilGrenHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranDiatHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilDiatHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranBlueHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilBlueHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranZooHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wDDilZooHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wSiTranSiO2HypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wSiDilSiO2HypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wSiTranDetWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wSiDilDetHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wO2TranWHypUpstN2 = IF ((FALSE EQ InclTranN2) OR (aInclStratN2 EQ FALSE)) THEN 0.0 ELSE ((wO2OutflHypN0 * uDepthWHypN0 * mFracN0N2 * ( mSurfAreaN0 / mSurfAreaN2 )) / uDepthWEpiN2) ENDIF;
wDTranWEpiUpstTotN2 = wDTranDetWEpiUpstN2 + wDTranIMWEpiUpstN2 + wDTranGrenEpiUpstN2 + wDTranDiatEpiUpstN2 + wDTranBlueEpiUpstN2;
wNTranWEpiUpstTotN2 = wNTranNH4WEpiUpstN2 + wNTranNO3WEpiUpstN2 + wNTranGrenEpiUpstN2 + wNTranDiatEpiUpstN2 + wNTranBlueEpiUpstN2 + wNTranDetWEpiUpstN2;
wO2TranWEpiUpstTotN2 = wO2TranWEpiUpstN2;
wPTranWEpiUpstTotN2 = wPTranPO4WEpiUpstN2 + wPTranAIMWEpiUpstN2 + wPTranGrenEpiUpstN2 + wPTranDiatEpiUpstN2 + wPTranBlueEpiUpstN2 + wPTranDetWEpiUpstN2;
wSiTranWEpiUpstTotN2 = wSiTranSiO2EpiUpstN2 + wSiTranDetWEpiUpstN2 + (cSiDDiatN2 * wDTranDiatEpiUpstN2);
wDTranWHypUpstTotN2 = wDTranDetWHypUpstN2 + wDTranIMWHypUpstN2 + wDTranGrenHypUpstN2 + wDTranDiatHypUpstN2 + wDTranBlueHypUpstN2;
wNTranWHypUpstTotN2 = wNTranNH4WHypUpstN2 + wNTranNO3WHypUpstN2 + wNTranGrenHypUpstN2 + wNTranDiatHypUpstN2 + wNTranBlueHypUpstN2 + wNTranDetWHypUpstN2;
wO2TranWHypUpstTotN2 = wO2TranWHypUpstN2;
wPTranWHypUpstTotN2 = wPTranPO4WHypUpstN2 + wPTranAIMWHypUpstN2 + wPTranGrenHypUpstN2 + wPTranDiatHypUpstN2 + wPTranBlueHypUpstN2 + wPTranDetWHypUpstN2;
wSiTranWHypUpstTotN2 = wSiTranSiO2HypUpstN2 + wSiTranDetWHypUpstN2 + (cSiDDiatN2 * wDTranDiatHypUpstN2);
wPTranPO4WEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilPO4EpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilPO4EpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranAIMWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilAIMEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilAIMEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranGrenEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilGrenEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilGrenEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranDiatEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilDiatEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilDiatEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranBlueEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilBlueEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilBlueEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranDetWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilDetEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilDetEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranZooEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wPDilZooEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilZooEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranNH4WEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilNH4EpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilNH4EpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranNO3WEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilNO3EpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilNO3EpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranGrenEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilGrenEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilGrenEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranDiatEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilDiatEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilDiatEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranBlueEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilBlueEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilBlueEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranDetWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilDetEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilDetEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranZooEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wNDilZooEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilZooEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranDetWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilDetEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilDetEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranIMWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilIMEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilIMEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranGrenEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilGrenEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilGrenEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranDiatEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilDiatEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilDiatEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranBlueEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilBlueEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilBlueEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranZooEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wDDilZooEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilZooEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wSiTranSiO2EpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wSiDilSiO2EpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wSiDilSiO2EpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wSiTranDetWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wSiDilDetEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wSiDilDetEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wO2TranWEpiUpstN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE ((wO2OutflEpiN1 * uDepthWEpiN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wO2OutflEpiN2 * uDepthWEpiN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranPO4WHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilPO4HypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilPO4HypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranAIMWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilAIMHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilAIMHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranGrenHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilGrenHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilGrenHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranDiatHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilDiatHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilDiatHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranBlueHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilBlueHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilBlueHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranDetWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilDetHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilDetHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wPTranZooHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wPDilZooHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wPDilZooHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranNH4WHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilNH4HypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilNH4HypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranNO3WHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilNO3HypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilNO3HypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranGrenHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilGrenHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilGrenHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranDiatHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilDiatHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilDiatHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranBlueHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilBlueHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilBlueHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranDetWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilDetHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilDetHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wNTranZooHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wNDilZooHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wNDilZooHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranDetWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilDetHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilDetHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranIMWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilIMHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilIMHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranGrenHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilGrenHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilGrenHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranDiatHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilDiatHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilDiatHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranBlueHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilBlueHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilBlueHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranZooHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wDDilZooHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wDDilZooHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wSiTranSiO2HypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wSiDilSiO2HypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wSiDilSiO2HypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wSiTranDetWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wSiDilDetHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wSiDilDetHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wO2TranWHypUpstN3 = IF ((FALSE EQ InclTranN3) OR (aInclStratN3 EQ FALSE)) THEN 0.0 ELSE ((wO2OutflHypN1 * uDepthWHypN1 * mFracN1N3 * ( mSurfAreaN1 / mSurfAreaN3 )) / uDepthWEpiN3) + ((wO2OutflHypN2 * uDepthWHypN2 * mFracN2N3 * ( mSurfAreaN2 / mSurfAreaN3 )) / uDepthWEpiN3) ENDIF;
wDTranWEpiUpstTotN3 = wDTranDetWEpiUpstN3 + wDTranIMWEpiUpstN3 + wDTranGrenEpiUpstN3 + wDTranDiatEpiUpstN3 + wDTranBlueEpiUpstN3;
wNTranWEpiUpstTotN3 = wNTranNH4WEpiUpstN3 + wNTranNO3WEpiUpstN3 + wNTranGrenEpiUpstN3 + wNTranDiatEpiUpstN3 + wNTranBlueEpiUpstN3 + wNTranDetWEpiUpstN3;
wO2TranWEpiUpstTotN3 = wO2TranWEpiUpstN3;
wPTranWEpiUpstTotN3 = wPTranPO4WEpiUpstN3 + wPTranAIMWEpiUpstN3 + wPTranGrenEpiUpstN3 + wPTranDiatEpiUpstN3 + wPTranBlueEpiUpstN3 + wPTranDetWEpiUpstN3;
wSiTranWEpiUpstTotN3 = wSiTranSiO2EpiUpstN3 + wSiTranDetWEpiUpstN3 + (cSiDDiatN3 * wDTranDiatEpiUpstN3);
wDTranWHypUpstTotN3 = wDTranDetWHypUpstN3 + wDTranIMWHypUpstN3 + wDTranGrenHypUpstN3 + wDTranDiatHypUpstN3 + wDTranBlueHypUpstN3;
wNTranWHypUpstTotN3 = wNTranNH4WHypUpstN3 + wNTranNO3WHypUpstN3 + wNTranGrenHypUpstN3 + wNTranDiatHypUpstN3 + wNTranBlueHypUpstN3 + wNTranDetWHypUpstN3;
wO2TranWHypUpstTotN3 = wO2TranWHypUpstN3;
wPTranWHypUpstTotN3 = wPTranPO4WHypUpstN3 + wPTranAIMWHypUpstN3 + wPTranGrenHypUpstN3 + wPTranDiatHypUpstN3 + wPTranBlueHypUpstN3 + wPTranDetWHypUpstN3;
wSiTranWHypUpstTotN3 = wSiTranSiO2HypUpstN3 + wSiTranDetWHypUpstN3 + (cSiDDiatN3 * wDTranDiatHypUpstN3);
wPTranPO4WEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilPO4EpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranAIMWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilAIMEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranGrenEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilGrenEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranDiatEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilDiatEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranBlueEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilBlueEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranDetWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilDetEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranZooEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wPDilZooEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranNH4WEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilNH4EpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranNO3WEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilNO3EpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranGrenEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilGrenEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranDiatEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilDiatEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranBlueEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilBlueEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranDetWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilDetEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranZooEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wNDilZooEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranDetWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilDetEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranIMWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilIMEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranGrenEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilGrenEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranDiatEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilDiatEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranBlueEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilBlueEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranZooEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wDDilZooEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wSiTranSiO2EpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wSiDilSiO2EpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wSiTranDetWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wSiDilDetEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wO2TranWEpiUpstN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE ((wO2OutflEpiN3 * uDepthWEpiN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranPO4WHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilPO4HypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranAIMWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilAIMHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranGrenHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilGrenHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranDiatHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilDiatHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranBlueHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilBlueHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranDetWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilDetHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wPTranZooHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wPDilZooHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranNH4WHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilNH4HypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranNO3WHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilNO3HypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranGrenHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilGrenHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranDiatHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilDiatHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranBlueHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilBlueHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranDetWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilDetHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wNTranZooHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wNDilZooHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranDetWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilDetHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranIMWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilIMHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranGrenHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilGrenHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranDiatHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilDiatHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranBlueHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilBlueHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranZooHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wDDilZooHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wSiTranSiO2HypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wSiDilSiO2HypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wSiTranDetWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wSiDilDetHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wO2TranWHypUpstN4 = IF ((FALSE EQ InclTranN4) OR (aInclStratN4 EQ FALSE)) THEN 0.0 ELSE ((wO2OutflHypN3 * uDepthWHypN3 * mFracN3N4 * ( mSurfAreaN3 / mSurfAreaN4 )) / uDepthWEpiN4) ENDIF;
wDTranWEpiUpstTotN4 = wDTranDetWEpiUpstN4 + wDTranIMWEpiUpstN4 + wDTranGrenEpiUpstN4 + wDTranDiatEpiUpstN4 + wDTranBlueEpiUpstN4;
wNTranWEpiUpstTotN4 = wNTranNH4WEpiUpstN4 + wNTranNO3WEpiUpstN4 + wNTranGrenEpiUpstN4 + wNTranDiatEpiUpstN4 + wNTranBlueEpiUpstN4 + wNTranDetWEpiUpstN4;
wO2TranWEpiUpstTotN4 = wO2TranWEpiUpstN4;
wPTranWEpiUpstTotN4 = wPTranPO4WEpiUpstN4 + wPTranAIMWEpiUpstN4 + wPTranGrenEpiUpstN4 + wPTranDiatEpiUpstN4 + wPTranBlueEpiUpstN4 + wPTranDetWEpiUpstN4;
wSiTranWEpiUpstTotN4 = wSiTranSiO2EpiUpstN4 + wSiTranDetWEpiUpstN4 + (cSiDDiatN4 * wDTranDiatEpiUpstN4);
wDTranWHypUpstTotN4 = wDTranDetWHypUpstN4 + wDTranIMWHypUpstN4 + wDTranGrenHypUpstN4 + wDTranDiatHypUpstN4 + wDTranBlueHypUpstN4;
wNTranWHypUpstTotN4 = wNTranNH4WHypUpstN4 + wNTranNO3WHypUpstN4 + wNTranGrenHypUpstN4 + wNTranDiatHypUpstN4 + wNTranBlueHypUpstN4 + wNTranDetWHypUpstN4;
wO2TranWHypUpstTotN4 = wO2TranWHypUpstN4;
wPTranWHypUpstTotN4 = wPTranPO4WHypUpstN4 + wPTranAIMWHypUpstN4 + wPTranGrenHypUpstN4 + wPTranDiatHypUpstN4 + wPTranBlueHypUpstN4 + wPTranDetWHypUpstN4;
wSiTranWHypUpstTotN4 = wSiTranSiO2HypUpstN4 + wSiTranDetWHypUpstN4 + (cSiDDiatN4 * wDTranDiatHypUpstN4);
wDTranDiatHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadDiatHypN0 / uDepthWHypN0 - wDDilDiatHypN0 ENDIF;
wPTranDiatHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadDiatHypN0 / uDepthWHypN0 - wPDilDiatHypN0 ENDIF;
wNTranDiatHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadDiatHypN0 / uDepthWHypN0 - wNDilDiatHypN0 ENDIF;
wDTranGrenHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadGrenHypN0 / uDepthWHypN0 - wDDilGrenHypN0 ENDIF;
wPTranGrenHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadGrenHypN0 / uDepthWHypN0 - wPDilGrenHypN0 ENDIF;
wNTranGrenHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadGrenHypN0 / uDepthWHypN0 - wNDilGrenHypN0 ENDIF;
wDTranBlueHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadBlueHypN0 / uDepthWHypN0 - wDDilBlueHypN0 ENDIF;
wPTranBlueHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadBlueHypN0 / uDepthWHypN0 - wPDilBlueHypN0 ENDIF;
wNTranBlueHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadBlueHypN0 / uDepthWHypN0 - wNDilBlueHypN0 ENDIF;
wSiTranSiO2HypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadSiO2HypN0 / uDepthWHypN0 - wSiDilSiO2HypN0 ENDIF;
wSiTranDetWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadDetHypN0 / uDepthWHypN0 - wSiDilDetHypN0 ENDIF;
wDTranZooHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uDLoadZooHypN0 /uDepthWHypN0 - wDDilZooHypN0) ENDIF;
wPTranZooHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uPLoadZooHypN0 /uDepthWHypN0 - wPDilZooHypN0) ENDIF;
wNTranZooHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uNLoadZooHypN0 /uDepthWHypN0 - wNDilZooHypN0) ENDIF;
wDTranIMWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadIMHypN0 / uDepthWHypN0 - wDDilIMHypN0 ENDIF;
wDTranDetWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadDetHypN0 / uDepthWHypN0 - wDDilDetHypN0 ENDIF;
wO2TranWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uO2LoadHypN0 / uDepthWHypN0 - wO2OutflHypN0 ENDIF;
wPTranPO4WHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadPO4HypN0 / uDepthWHypN0 - wPDilPO4HypN0 ENDIF;
wPTranAIMWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadAIMHypN0 / uDepthWHypN0 - wPDilAIMHypN0 ENDIF;
wPTranDetWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadDetHypN0 / uDepthWHypN0 - wPDilDetHypN0 ENDIF;
wNTranNH4WHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadNH4HypN0 / uDepthWHypN0 - wNDilNH4HypN0 ENDIF;
wNTranNO3WHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadNO3HypN0 / uDepthWHypN0 - wNDilNO3HypN0 ENDIF;
wNTranDetWHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadDetHypN0 / uDepthWHypN0 - wNDilDetHypN0 ENDIF;
wDTranDiatEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadDiatEpiN0 / uDepthWEpiN0 - wDDilDiatEpiN0 ENDIF;
wPTranDiatEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadDiatEpiN0 / uDepthWEpiN0 - wPDilDiatEpiN0 ENDIF;
wNTranDiatEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadDiatEpiN0 / uDepthWEpiN0 - wNDilDiatEpiN0 ENDIF;
wDTranGrenEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadGrenEpiN0 / uDepthWEpiN0 - wDDilGrenEpiN0 ENDIF;
wPTranGrenEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadGrenEpiN0 / uDepthWEpiN0 - wPDilGrenEpiN0 ENDIF;
wNTranGrenEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadGrenEpiN0 / uDepthWEpiN0 - wNDilGrenEpiN0 ENDIF;
wDTranBlueEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadBlueEpiN0 / uDepthWEpiN0 - wDDilBlueEpiN0 ENDIF;
wPTranBlueEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadBlueEpiN0 / uDepthWEpiN0 - wPDilBlueEpiN0 ENDIF;
wNTranBlueEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadBlueEpiN0 / uDepthWEpiN0 - wNDilBlueEpiN0 ENDIF;
wSiTranSiO2EpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadSiO2EpiN0 / uDepthWEpiN0 - wSiDilSiO2EpiN0 ENDIF;
wSiTranDetWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uSiLoadDetEpiN0 / uDepthWEpiN0 - wSiDilDetEpiN0 ENDIF;
wDTranZooEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uDLoadZooEpiN0 /uDepthWEpiN0 - wDDilZooEpiN0) ENDIF;
wPTranZooEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uPLoadZooEpiN0 /uDepthWEpiN0 - wPDilZooEpiN0) ENDIF;
wNTranZooEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE (uNLoadZooEpiN0 /uDepthWEpiN0 - wNDilZooEpiN0) ENDIF;
wDTranIMWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadIMEpiN0 / uDepthWEpiN0 - wDDilIMEpiN0 ENDIF;
wDTranDetWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uDLoadDetEpiN0 / uDepthWEpiN0 - wDDilDetEpiN0 ENDIF;
wO2TranWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uO2LoadEpiN0 / uDepthWEpiN0 - wO2OutflEpiN0 ENDIF;
wPTranPO4WEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadPO4EpiN0 / uDepthWEpiN0 - wPDilPO4EpiN0 ENDIF;
wPTranAIMWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadAIMEpiN0 / uDepthWEpiN0 - wPDilAIMEpiN0 ENDIF;
wPTranDetWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uPLoadDetEpiN0 / uDepthWEpiN0 - wPDilDetEpiN0 ENDIF;
wNTranNH4WEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadNH4EpiN0 / uDepthWEpiN0 - wNDilNH4EpiN0 ENDIF;
wNTranNO3WEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadNO3EpiN0 / uDepthWEpiN0 - wNDilNO3EpiN0 ENDIF;
wNTranDetWEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE uNLoadDetEpiN0 / uDepthWEpiN0 - wNDilDetEpiN0 ENDIF;
wDTranPhytHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wDTranDiatHypN0 + wDTranGrenHypN0 + wDTranBlueHypN0 ENDIF;
wPTranPhytHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wPTranDiatHypN0 + wPTranGrenHypN0 + wPTranBlueHypN0 ENDIF;
wNTranPhytHypN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wNTranDiatHypN0 + wNTranGrenHypN0 + wNTranBlueHypN0 ENDIF;
wDTranPhytEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wDTranDiatEpiN0 + wDTranGrenEpiN0 + wDTranBlueEpiN0 ENDIF;
wPTranPhytEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wPTranDiatEpiN0 + wPTranGrenEpiN0 + wPTranBlueEpiN0 ENDIF;
wNTranPhytEpiN0 = IF (FALSE EQ InclTranN0) THEN 0.0 ELSE wNTranDiatEpiN0 + wNTranGrenEpiN0 + wNTranBlueEpiN0 ENDIF;
wDTranDiatHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadDiatHypN1 / uDepthWHypN1 - wDDilDiatHypN1 + wDTranDiatHypUpstN1 ENDIF;
wPTranDiatHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadDiatHypN1 / uDepthWHypN1 - wPDilDiatHypN1 + wPTranDiatHypUpstN1 ENDIF;
wNTranDiatHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadDiatHypN1 / uDepthWHypN1 - wNDilDiatHypN1 + wNTranDiatHypUpstN1 ENDIF;
wDTranGrenHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadGrenHypN1 / uDepthWHypN1 - wDDilGrenHypN1 + wDTranGrenHypUpstN1 ENDIF;
wPTranGrenHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadGrenHypN1 / uDepthWHypN1 - wPDilGrenHypN1 + wPTranGrenHypUpstN1 ENDIF;
wNTranGrenHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadGrenHypN1 / uDepthWHypN1 - wNDilGrenHypN1 + wNTranGrenHypUpstN1 ENDIF;
wDTranBlueHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadBlueHypN1 / uDepthWHypN1 - wDDilBlueHypN1 + wDTranBlueHypUpstN1 ENDIF;
wPTranBlueHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadBlueHypN1 / uDepthWHypN1 - wPDilBlueHypN1 + wPTranBlueHypUpstN1 ENDIF;
wNTranBlueHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadBlueHypN1 / uDepthWHypN1 - wNDilBlueHypN1 + wNTranBlueHypUpstN1 ENDIF;
wSiTranSiO2HypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadSiO2HypN1 / uDepthWHypN1 - wSiDilSiO2HypN1 + wSiTranSiO2HypUpstN1 ENDIF;
wSiTranDetWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadDetHypN1 / uDepthWHypN1 - wSiDilDetHypN1 + wSiTranDetWHypUpstN1 ENDIF;
wDTranZooHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uDLoadZooHypN1 /uDepthWHypN1 - wDDilZooHypN1) + wDTranZooHypUpstN1 ENDIF;
wPTranZooHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uPLoadZooHypN1 /uDepthWHypN1 - wPDilZooHypN1) + wPTranZooHypUpstN1 ENDIF;
wNTranZooHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uNLoadZooHypN1 /uDepthWHypN1 - wNDilZooHypN1) + wNTranZooHypUpstN1 ENDIF;
wDTranIMWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadIMHypN1 / uDepthWHypN1 - wDDilIMHypN1 + wDTranIMWHypUpstN1 ENDIF;
wDTranDetWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadDetHypN1 / uDepthWHypN1 - wDDilDetHypN1 + wDTranDetWHypUpstN1 ENDIF;
wO2TranWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uO2LoadHypN1 / uDepthWHypN1 - wO2OutflHypN1 + wO2TranWHypUpstN1 ENDIF;
wPTranPO4WHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadPO4HypN1 / uDepthWHypN1 - wPDilPO4HypN1 + wPTranPO4WHypUpstN1 ENDIF;
wPTranAIMWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadAIMHypN1 / uDepthWHypN1 - wPDilAIMHypN1 + wPTranAIMWHypUpstN1 ENDIF;
wPTranDetWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadDetHypN1 / uDepthWHypN1 - wPDilDetHypN1 + wPTranDetWHypUpstN1 ENDIF;
wNTranNH4WHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadNH4HypN1 / uDepthWHypN1 - wNDilNH4HypN1 + wNTranNH4WHypUpstN1 ENDIF;
wNTranNO3WHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadNO3HypN1 / uDepthWHypN1 - wNDilNO3HypN1 + wNTranNO3WHypUpstN1 ENDIF;
wNTranDetWHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadDetHypN1 / uDepthWHypN1 - wNDilDetHypN1 + wNTranDetWHypUpstN1 ENDIF;
wDTranDiatEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadDiatEpiN1 / uDepthWEpiN1 - wDDilDiatEpiN1 + wDTranDiatEpiUpstN1 ENDIF;
wPTranDiatEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadDiatEpiN1 / uDepthWEpiN1 - wPDilDiatEpiN1 + wPTranDiatEpiUpstN1 ENDIF;
wNTranDiatEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadDiatEpiN1 / uDepthWEpiN1 - wNDilDiatEpiN1 + wNTranDiatEpiUpstN1 ENDIF;
wDTranGrenEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadGrenEpiN1 / uDepthWEpiN1 - wDDilGrenEpiN1 + wDTranGrenEpiUpstN1 ENDIF;
wPTranGrenEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadGrenEpiN1 / uDepthWEpiN1 - wPDilGrenEpiN1 + wPTranGrenEpiUpstN1 ENDIF;
wNTranGrenEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadGrenEpiN1 / uDepthWEpiN1 - wNDilGrenEpiN1 + wNTranGrenEpiUpstN1 ENDIF;
wDTranBlueEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadBlueEpiN1 / uDepthWEpiN1 - wDDilBlueEpiN1 + wDTranBlueEpiUpstN1 ENDIF;
wPTranBlueEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadBlueEpiN1 / uDepthWEpiN1 - wPDilBlueEpiN1 + wPTranBlueEpiUpstN1 ENDIF;
wNTranBlueEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadBlueEpiN1 / uDepthWEpiN1 - wNDilBlueEpiN1 + wNTranBlueEpiUpstN1 ENDIF;
wSiTranSiO2EpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadSiO2EpiN1 / uDepthWEpiN1 - wSiDilSiO2EpiN1 + wSiTranSiO2EpiUpstN1 ENDIF;
wSiTranDetWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uSiLoadDetEpiN1 / uDepthWEpiN1 - wSiDilDetEpiN1 + wSiTranDetWEpiUpstN1 ENDIF;
wDTranZooEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uDLoadZooEpiN1 /uDepthWEpiN1 - wDDilZooEpiN1) + wDTranZooEpiUpstN1 ENDIF;
wPTranZooEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uPLoadZooEpiN1 /uDepthWEpiN1 - wPDilZooEpiN1) + wPTranZooEpiUpstN1 ENDIF;
wNTranZooEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE (uNLoadZooEpiN1 /uDepthWEpiN1 - wNDilZooEpiN1) + wNTranZooEpiUpstN1 ENDIF;
wDTranIMWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadIMEpiN1 / uDepthWEpiN1 - wDDilIMEpiN1 + wDTranIMWEpiUpstN1 ENDIF;
wDTranDetWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uDLoadDetEpiN1 / uDepthWEpiN1 - wDDilDetEpiN1 + wDTranDetWEpiUpstN1 ENDIF;
wO2TranWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uO2LoadEpiN1 / uDepthWEpiN1 - wO2OutflEpiN1 + wO2TranWEpiUpstN1 ENDIF;
wPTranPO4WEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadPO4EpiN1 / uDepthWEpiN1 - wPDilPO4EpiN1 + wPTranPO4WEpiUpstN1 ENDIF;
wPTranAIMWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadAIMEpiN1 / uDepthWEpiN1 - wPDilAIMEpiN1 + wPTranAIMWEpiUpstN1 ENDIF;
wPTranDetWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uPLoadDetEpiN1 / uDepthWEpiN1 - wPDilDetEpiN1 + wPTranDetWEpiUpstN1 ENDIF;
wNTranNH4WEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadNH4EpiN1 / uDepthWEpiN1 - wNDilNH4EpiN1 + wNTranNH4WEpiUpstN1 ENDIF;
wNTranNO3WEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadNO3EpiN1 / uDepthWEpiN1 - wNDilNO3EpiN1 + wNTranNO3WEpiUpstN1 ENDIF;
wNTranDetWEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE uNLoadDetEpiN1 / uDepthWEpiN1 - wNDilDetEpiN1 + wNTranDetWEpiUpstN1 ENDIF;
wDTranPhytHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wDTranDiatHypN1 + wDTranGrenHypN1 + wDTranBlueHypN1 ENDIF;
wPTranPhytHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wPTranDiatHypN1 + wPTranGrenHypN1 + wPTranBlueHypN1 ENDIF;
wNTranPhytHypN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wNTranDiatHypN1 + wNTranGrenHypN1 + wNTranBlueHypN1 ENDIF;
wDTranPhytEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wDTranDiatEpiN1 + wDTranGrenEpiN1 + wDTranBlueEpiN1 ENDIF;
wPTranPhytEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wPTranDiatEpiN1 + wPTranGrenEpiN1 + wPTranBlueEpiN1 ENDIF;
wNTranPhytEpiN1 = IF (FALSE EQ InclTranN1) THEN 0.0 ELSE wNTranDiatEpiN1 + wNTranGrenEpiN1 + wNTranBlueEpiN1 ENDIF;
wDTranDiatHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadDiatHypN2 / uDepthWHypN2 - wDDilDiatHypN2 + wDTranDiatHypUpstN2 ENDIF;
wPTranDiatHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadDiatHypN2 / uDepthWHypN2 - wPDilDiatHypN2 + wPTranDiatHypUpstN2 ENDIF;
wNTranDiatHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadDiatHypN2 / uDepthWHypN2 - wNDilDiatHypN2 + wNTranDiatHypUpstN2 ENDIF;
wDTranGrenHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadGrenHypN2 / uDepthWHypN2 - wDDilGrenHypN2 + wDTranGrenHypUpstN2 ENDIF;
wPTranGrenHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadGrenHypN2 / uDepthWHypN2 - wPDilGrenHypN2 + wPTranGrenHypUpstN2 ENDIF;
wNTranGrenHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadGrenHypN2 / uDepthWHypN2 - wNDilGrenHypN2 + wNTranGrenHypUpstN2 ENDIF;
wDTranBlueHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadBlueHypN2 / uDepthWHypN2 - wDDilBlueHypN2 + wDTranBlueHypUpstN2 ENDIF;
wPTranBlueHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadBlueHypN2 / uDepthWHypN2 - wPDilBlueHypN2 + wPTranBlueHypUpstN2 ENDIF;
wNTranBlueHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadBlueHypN2 / uDepthWHypN2 - wNDilBlueHypN2 + wNTranBlueHypUpstN2 ENDIF;
wSiTranSiO2HypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadSiO2HypN2 / uDepthWHypN2 - wSiDilSiO2HypN2 + wSiTranSiO2HypUpstN2 ENDIF;
wSiTranDetWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadDetHypN2 / uDepthWHypN2 - wSiDilDetHypN2 + wSiTranDetWHypUpstN2 ENDIF;
wDTranZooHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uDLoadZooHypN2 /uDepthWHypN2 - wDDilZooHypN2) + wDTranZooHypUpstN2 ENDIF;
wPTranZooHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uPLoadZooHypN2 /uDepthWHypN2 - wPDilZooHypN2) + wPTranZooHypUpstN2 ENDIF;
wNTranZooHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uNLoadZooHypN2 /uDepthWHypN2 - wNDilZooHypN2) + wNTranZooHypUpstN2 ENDIF;
wDTranIMWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadIMHypN2 / uDepthWHypN2 - wDDilIMHypN2 + wDTranIMWHypUpstN2 ENDIF;
wDTranDetWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadDetHypN2 / uDepthWHypN2 - wDDilDetHypN2 + wDTranDetWHypUpstN2 ENDIF;
wO2TranWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uO2LoadHypN2 / uDepthWHypN2 - wO2OutflHypN2 + wO2TranWHypUpstN2 ENDIF;
wPTranPO4WHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadPO4HypN2 / uDepthWHypN2 - wPDilPO4HypN2 + wPTranPO4WHypUpstN2 ENDIF;
wPTranAIMWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadAIMHypN2 / uDepthWHypN2 - wPDilAIMHypN2 + wPTranAIMWHypUpstN2 ENDIF;
wPTranDetWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadDetHypN2 / uDepthWHypN2 - wPDilDetHypN2 + wPTranDetWHypUpstN2 ENDIF;
wNTranNH4WHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadNH4HypN2 / uDepthWHypN2 - wNDilNH4HypN2 + wNTranNH4WHypUpstN2 ENDIF;
wNTranNO3WHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadNO3HypN2 / uDepthWHypN2 - wNDilNO3HypN2 + wNTranNO3WHypUpstN2 ENDIF;
wNTranDetWHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadDetHypN2 / uDepthWHypN2 - wNDilDetHypN2 + wNTranDetWHypUpstN2 ENDIF;
wDTranDiatEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadDiatEpiN2 / uDepthWEpiN2 - wDDilDiatEpiN2 + wDTranDiatEpiUpstN2 ENDIF;
wPTranDiatEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadDiatEpiN2 / uDepthWEpiN2 - wPDilDiatEpiN2 + wPTranDiatEpiUpstN2 ENDIF;
wNTranDiatEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadDiatEpiN2 / uDepthWEpiN2 - wNDilDiatEpiN2 + wNTranDiatEpiUpstN2 ENDIF;
wDTranGrenEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadGrenEpiN2 / uDepthWEpiN2 - wDDilGrenEpiN2 + wDTranGrenEpiUpstN2 ENDIF;
wPTranGrenEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadGrenEpiN2 / uDepthWEpiN2 - wPDilGrenEpiN2 + wPTranGrenEpiUpstN2 ENDIF;
wNTranGrenEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadGrenEpiN2 / uDepthWEpiN2 - wNDilGrenEpiN2 + wNTranGrenEpiUpstN2 ENDIF;
wDTranBlueEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadBlueEpiN2 / uDepthWEpiN2 - wDDilBlueEpiN2 + wDTranBlueEpiUpstN2 ENDIF;
wPTranBlueEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadBlueEpiN2 / uDepthWEpiN2 - wPDilBlueEpiN2 + wPTranBlueEpiUpstN2 ENDIF;
wNTranBlueEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadBlueEpiN2 / uDepthWEpiN2 - wNDilBlueEpiN2 + wNTranBlueEpiUpstN2 ENDIF;
wSiTranSiO2EpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadSiO2EpiN2 / uDepthWEpiN2 - wSiDilSiO2EpiN2 + wSiTranSiO2EpiUpstN2 ENDIF;
wSiTranDetWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uSiLoadDetEpiN2 / uDepthWEpiN2 - wSiDilDetEpiN2 + wSiTranDetWEpiUpstN2 ENDIF;
wDTranZooEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uDLoadZooEpiN2 /uDepthWEpiN2 - wDDilZooEpiN2) + wDTranZooEpiUpstN2 ENDIF;
wPTranZooEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uPLoadZooEpiN2 /uDepthWEpiN2 - wPDilZooEpiN2) + wPTranZooEpiUpstN2 ENDIF;
wNTranZooEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE (uNLoadZooEpiN2 /uDepthWEpiN2 - wNDilZooEpiN2) + wNTranZooEpiUpstN2 ENDIF;
wDTranIMWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadIMEpiN2 / uDepthWEpiN2 - wDDilIMEpiN2 + wDTranIMWEpiUpstN2 ENDIF;
wDTranDetWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uDLoadDetEpiN2 / uDepthWEpiN2 - wDDilDetEpiN2 + wDTranDetWEpiUpstN2 ENDIF;
wO2TranWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uO2LoadEpiN2 / uDepthWEpiN2 - wO2OutflEpiN2 + wO2TranWEpiUpstN2 ENDIF;
wPTranPO4WEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadPO4EpiN2 / uDepthWEpiN2 - wPDilPO4EpiN2 + wPTranPO4WEpiUpstN2 ENDIF;
wPTranAIMWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadAIMEpiN2 / uDepthWEpiN2 - wPDilAIMEpiN2 + wPTranAIMWEpiUpstN2 ENDIF;
wPTranDetWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uPLoadDetEpiN2 / uDepthWEpiN2 - wPDilDetEpiN2 + wPTranDetWEpiUpstN2 ENDIF;
wNTranNH4WEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadNH4EpiN2 / uDepthWEpiN2 - wNDilNH4EpiN2 + wNTranNH4WEpiUpstN2 ENDIF;
wNTranNO3WEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadNO3EpiN2 / uDepthWEpiN2 - wNDilNO3EpiN2 + wNTranNO3WEpiUpstN2 ENDIF;
wNTranDetWEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE uNLoadDetEpiN2 / uDepthWEpiN2 - wNDilDetEpiN2 + wNTranDetWEpiUpstN2 ENDIF;
wDTranPhytHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wDTranDiatHypN2 + wDTranGrenHypN2 + wDTranBlueHypN2 ENDIF;
wPTranPhytHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wPTranDiatHypN2 + wPTranGrenHypN2 + wPTranBlueHypN2 ENDIF;
wNTranPhytHypN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wNTranDiatHypN2 + wNTranGrenHypN2 + wNTranBlueHypN2 ENDIF;
wDTranPhytEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wDTranDiatEpiN2 + wDTranGrenEpiN2 + wDTranBlueEpiN2 ENDIF;
wPTranPhytEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wPTranDiatEpiN2 + wPTranGrenEpiN2 + wPTranBlueEpiN2 ENDIF;
wNTranPhytEpiN2 = IF (FALSE EQ InclTranN2) THEN 0.0 ELSE wNTranDiatEpiN2 + wNTranGrenEpiN2 + wNTranBlueEpiN2 ENDIF;
wDTranDiatHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadDiatHypN3 / uDepthWHypN3 - wDDilDiatHypN3 + wDTranDiatHypUpstN3 ENDIF;
wPTranDiatHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadDiatHypN3 / uDepthWHypN3 - wPDilDiatHypN3 + wPTranDiatHypUpstN3 ENDIF;
wNTranDiatHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadDiatHypN3 / uDepthWHypN3 - wNDilDiatHypN3 + wNTranDiatHypUpstN3 ENDIF;
wDTranGrenHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadGrenHypN3 / uDepthWHypN3 - wDDilGrenHypN3 + wDTranGrenHypUpstN3 ENDIF;
wPTranGrenHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadGrenHypN3 / uDepthWHypN3 - wPDilGrenHypN3 + wPTranGrenHypUpstN3 ENDIF;
wNTranGrenHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadGrenHypN3 / uDepthWHypN3 - wNDilGrenHypN3 + wNTranGrenHypUpstN3 ENDIF;
wDTranBlueHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadBlueHypN3 / uDepthWHypN3 - wDDilBlueHypN3 + wDTranBlueHypUpstN3 ENDIF;
wPTranBlueHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadBlueHypN3 / uDepthWHypN3 - wPDilBlueHypN3 + wPTranBlueHypUpstN3 ENDIF;
wNTranBlueHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadBlueHypN3 / uDepthWHypN3 - wNDilBlueHypN3 + wNTranBlueHypUpstN3 ENDIF;
wSiTranSiO2HypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadSiO2HypN3 / uDepthWHypN3 - wSiDilSiO2HypN3 + wSiTranSiO2HypUpstN3 ENDIF;
wSiTranDetWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadDetHypN3 / uDepthWHypN3 - wSiDilDetHypN3 + wSiTranDetWHypUpstN3 ENDIF;
wDTranZooHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uDLoadZooHypN3 /uDepthWHypN3 - wDDilZooHypN3) + wDTranZooHypUpstN3 ENDIF;
wPTranZooHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uPLoadZooHypN3 /uDepthWHypN3 - wPDilZooHypN3) + wPTranZooHypUpstN3 ENDIF;
wNTranZooHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uNLoadZooHypN3 /uDepthWHypN3 - wNDilZooHypN3) + wNTranZooHypUpstN3 ENDIF;
wDTranIMWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadIMHypN3 / uDepthWHypN3 - wDDilIMHypN3 + wDTranIMWHypUpstN3 ENDIF;
wDTranDetWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadDetHypN3 / uDepthWHypN3 - wDDilDetHypN3 + wDTranDetWHypUpstN3 ENDIF;
wO2TranWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uO2LoadHypN3 / uDepthWHypN3 - wO2OutflHypN3 + wO2TranWHypUpstN3 ENDIF;
wPTranPO4WHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadPO4HypN3 / uDepthWHypN3 - wPDilPO4HypN3 + wPTranPO4WHypUpstN3 ENDIF;
wPTranAIMWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadAIMHypN3 / uDepthWHypN3 - wPDilAIMHypN3 + wPTranAIMWHypUpstN3 ENDIF;
wPTranDetWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadDetHypN3 / uDepthWHypN3 - wPDilDetHypN3 + wPTranDetWHypUpstN3 ENDIF;
wNTranNH4WHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadNH4HypN3 / uDepthWHypN3 - wNDilNH4HypN3 + wNTranNH4WHypUpstN3 ENDIF;
wNTranNO3WHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadNO3HypN3 / uDepthWHypN3 - wNDilNO3HypN3 + wNTranNO3WHypUpstN3 ENDIF;
wNTranDetWHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadDetHypN3 / uDepthWHypN3 - wNDilDetHypN3 + wNTranDetWHypUpstN3 ENDIF;
wDTranDiatEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadDiatEpiN3 / uDepthWEpiN3 - wDDilDiatEpiN3 + wDTranDiatEpiUpstN3 ENDIF;
wPTranDiatEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadDiatEpiN3 / uDepthWEpiN3 - wPDilDiatEpiN3 + wPTranDiatEpiUpstN3 ENDIF;
wNTranDiatEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadDiatEpiN3 / uDepthWEpiN3 - wNDilDiatEpiN3 + wNTranDiatEpiUpstN3 ENDIF;
wDTranGrenEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadGrenEpiN3 / uDepthWEpiN3 - wDDilGrenEpiN3 + wDTranGrenEpiUpstN3 ENDIF;
wPTranGrenEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadGrenEpiN3 / uDepthWEpiN3 - wPDilGrenEpiN3 + wPTranGrenEpiUpstN3 ENDIF;
wNTranGrenEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadGrenEpiN3 / uDepthWEpiN3 - wNDilGrenEpiN3 + wNTranGrenEpiUpstN3 ENDIF;
wDTranBlueEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadBlueEpiN3 / uDepthWEpiN3 - wDDilBlueEpiN3 + wDTranBlueEpiUpstN3 ENDIF;
wPTranBlueEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadBlueEpiN3 / uDepthWEpiN3 - wPDilBlueEpiN3 + wPTranBlueEpiUpstN3 ENDIF;
wNTranBlueEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadBlueEpiN3 / uDepthWEpiN3 - wNDilBlueEpiN3 + wNTranBlueEpiUpstN3 ENDIF;
wSiTranSiO2EpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadSiO2EpiN3 / uDepthWEpiN3 - wSiDilSiO2EpiN3 + wSiTranSiO2EpiUpstN3 ENDIF;
wSiTranDetWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uSiLoadDetEpiN3 / uDepthWEpiN3 - wSiDilDetEpiN3 + wSiTranDetWEpiUpstN3 ENDIF;
wDTranZooEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uDLoadZooEpiN3 /uDepthWEpiN3 - wDDilZooEpiN3) + wDTranZooEpiUpstN3 ENDIF;
wPTranZooEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uPLoadZooEpiN3 /uDepthWEpiN3 - wPDilZooEpiN3) + wPTranZooEpiUpstN3 ENDIF;
wNTranZooEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE (uNLoadZooEpiN3 /uDepthWEpiN3 - wNDilZooEpiN3) + wNTranZooEpiUpstN3 ENDIF;
wDTranIMWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadIMEpiN3 / uDepthWEpiN3 - wDDilIMEpiN3 + wDTranIMWEpiUpstN3 ENDIF;
wDTranDetWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uDLoadDetEpiN3 / uDepthWEpiN3 - wDDilDetEpiN3 + wDTranDetWEpiUpstN3 ENDIF;
wO2TranWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uO2LoadEpiN3 / uDepthWEpiN3 - wO2OutflEpiN3 + wO2TranWEpiUpstN3 ENDIF;
wPTranPO4WEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadPO4EpiN3 / uDepthWEpiN3 - wPDilPO4EpiN3 + wPTranPO4WEpiUpstN3 ENDIF;
wPTranAIMWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadAIMEpiN3 / uDepthWEpiN3 - wPDilAIMEpiN3 + wPTranAIMWEpiUpstN3 ENDIF;
wPTranDetWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uPLoadDetEpiN3 / uDepthWEpiN3 - wPDilDetEpiN3 + wPTranDetWEpiUpstN3 ENDIF;
wNTranNH4WEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadNH4EpiN3 / uDepthWEpiN3 - wNDilNH4EpiN3 + wNTranNH4WEpiUpstN3 ENDIF;
wNTranNO3WEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadNO3EpiN3 / uDepthWEpiN3 - wNDilNO3EpiN3 + wNTranNO3WEpiUpstN3 ENDIF;
wNTranDetWEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE uNLoadDetEpiN3 / uDepthWEpiN3 - wNDilDetEpiN3 + wNTranDetWEpiUpstN3 ENDIF;
wDTranPhytHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wDTranDiatHypN3 + wDTranGrenHypN3 + wDTranBlueHypN3 ENDIF;
wPTranPhytHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wPTranDiatHypN3 + wPTranGrenHypN3 + wPTranBlueHypN3 ENDIF;
wNTranPhytHypN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wNTranDiatHypN3 + wNTranGrenHypN3 + wNTranBlueHypN3 ENDIF;
wDTranPhytEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wDTranDiatEpiN3 + wDTranGrenEpiN3 + wDTranBlueEpiN3 ENDIF;
wPTranPhytEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wPTranDiatEpiN3 + wPTranGrenEpiN3 + wPTranBlueEpiN3 ENDIF;
wNTranPhytEpiN3 = IF (FALSE EQ InclTranN3) THEN 0.0 ELSE wNTranDiatEpiN3 + wNTranGrenEpiN3 + wNTranBlueEpiN3 ENDIF;
wDTranDiatHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadDiatHypN4 / uDepthWHypN4 - wDDilDiatHypN4 + wDTranDiatHypUpstN4 ENDIF;
wPTranDiatHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadDiatHypN4 / uDepthWHypN4 - wPDilDiatHypN4 + wPTranDiatHypUpstN4 ENDIF;
wNTranDiatHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadDiatHypN4 / uDepthWHypN4 - wNDilDiatHypN4 + wNTranDiatHypUpstN4 ENDIF;
wDTranGrenHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadGrenHypN4 / uDepthWHypN4 - wDDilGrenHypN4 + wDTranGrenHypUpstN4 ENDIF;
wPTranGrenHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadGrenHypN4 / uDepthWHypN4 - wPDilGrenHypN4 + wPTranGrenHypUpstN4 ENDIF;
wNTranGrenHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadGrenHypN4 / uDepthWHypN4 - wNDilGrenHypN4 + wNTranGrenHypUpstN4 ENDIF;
wDTranBlueHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadBlueHypN4 / uDepthWHypN4 - wDDilBlueHypN4 + wDTranBlueHypUpstN4 ENDIF;
wPTranBlueHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadBlueHypN4 / uDepthWHypN4 - wPDilBlueHypN4 + wPTranBlueHypUpstN4 ENDIF;
wNTranBlueHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadBlueHypN4 / uDepthWHypN4 - wNDilBlueHypN4 + wNTranBlueHypUpstN4 ENDIF;
wSiTranSiO2HypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadSiO2HypN4 / uDepthWHypN4 - wSiDilSiO2HypN4 + wSiTranSiO2HypUpstN4 ENDIF;
wSiTranDetWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadDetHypN4 / uDepthWHypN4 - wSiDilDetHypN4 + wSiTranDetWHypUpstN4 ENDIF;
wDTranZooHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uDLoadZooHypN4 /uDepthWHypN4 - wDDilZooHypN4) + wDTranZooHypUpstN4 ENDIF;
wPTranZooHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uPLoadZooHypN4 /uDepthWHypN4 - wPDilZooHypN4) + wPTranZooHypUpstN4 ENDIF;
wNTranZooHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uNLoadZooHypN4 /uDepthWHypN4 - wNDilZooHypN4) + wNTranZooHypUpstN4 ENDIF;
wDTranIMWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadIMHypN4 / uDepthWHypN4 - wDDilIMHypN4 + wDTranIMWHypUpstN4 ENDIF;
wDTranDetWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadDetHypN4 / uDepthWHypN4 - wDDilDetHypN4 + wDTranDetWHypUpstN4 ENDIF;
wO2TranWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uO2LoadHypN4 / uDepthWHypN4 - wO2OutflHypN4 + wO2TranWHypUpstN4 ENDIF;
wPTranPO4WHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadPO4HypN4 / uDepthWHypN4 - wPDilPO4HypN4 + wPTranPO4WHypUpstN4 ENDIF;
wPTranAIMWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadAIMHypN4 / uDepthWHypN4 - wPDilAIMHypN4 + wPTranAIMWHypUpstN4 ENDIF;
wPTranDetWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadDetHypN4 / uDepthWHypN4 - wPDilDetHypN4 + wPTranDetWHypUpstN4 ENDIF;
wNTranNH4WHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadNH4HypN4 / uDepthWHypN4 - wNDilNH4HypN4 + wNTranNH4WHypUpstN4 ENDIF;
wNTranNO3WHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadNO3HypN4 / uDepthWHypN4 - wNDilNO3HypN4 + wNTranNO3WHypUpstN4 ENDIF;
wNTranDetWHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadDetHypN4 / uDepthWHypN4 - wNDilDetHypN4 + wNTranDetWHypUpstN4 ENDIF;
wDTranDiatEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadDiatEpiN4 / uDepthWEpiN4 - wDDilDiatEpiN4 + wDTranDiatEpiUpstN4 ENDIF;
wPTranDiatEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadDiatEpiN4 / uDepthWEpiN4 - wPDilDiatEpiN4 + wPTranDiatEpiUpstN4 ENDIF;
wNTranDiatEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadDiatEpiN4 / uDepthWEpiN4 - wNDilDiatEpiN4 + wNTranDiatEpiUpstN4 ENDIF;
wDTranGrenEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadGrenEpiN4 / uDepthWEpiN4 - wDDilGrenEpiN4 + wDTranGrenEpiUpstN4 ENDIF;
wPTranGrenEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadGrenEpiN4 / uDepthWEpiN4 - wPDilGrenEpiN4 + wPTranGrenEpiUpstN4 ENDIF;
wNTranGrenEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadGrenEpiN4 / uDepthWEpiN4 - wNDilGrenEpiN4 + wNTranGrenEpiUpstN4 ENDIF;
wDTranBlueEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadBlueEpiN4 / uDepthWEpiN4 - wDDilBlueEpiN4 + wDTranBlueEpiUpstN4 ENDIF;
wPTranBlueEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadBlueEpiN4 / uDepthWEpiN4 - wPDilBlueEpiN4 + wPTranBlueEpiUpstN4 ENDIF;
wNTranBlueEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadBlueEpiN4 / uDepthWEpiN4 - wNDilBlueEpiN4 + wNTranBlueEpiUpstN4 ENDIF;
wSiTranSiO2EpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadSiO2EpiN4 / uDepthWEpiN4 - wSiDilSiO2EpiN4 + wSiTranSiO2EpiUpstN4 ENDIF;
wSiTranDetWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uSiLoadDetEpiN4 / uDepthWEpiN4 - wSiDilDetEpiN4 + wSiTranDetWEpiUpstN4 ENDIF;
wDTranZooEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uDLoadZooEpiN4 /uDepthWEpiN4 - wDDilZooEpiN4) + wDTranZooEpiUpstN4 ENDIF;
wPTranZooEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uPLoadZooEpiN4 /uDepthWEpiN4 - wPDilZooEpiN4) + wPTranZooEpiUpstN4 ENDIF;
wNTranZooEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE (uNLoadZooEpiN4 /uDepthWEpiN4 - wNDilZooEpiN4) + wNTranZooEpiUpstN4 ENDIF;
wDTranIMWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadIMEpiN4 / uDepthWEpiN4 - wDDilIMEpiN4 + wDTranIMWEpiUpstN4 ENDIF;
wDTranDetWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uDLoadDetEpiN4 / uDepthWEpiN4 - wDDilDetEpiN4 + wDTranDetWEpiUpstN4 ENDIF;
wO2TranWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uO2LoadEpiN4 / uDepthWEpiN4 - wO2OutflEpiN4 + wO2TranWEpiUpstN4 ENDIF;
wPTranPO4WEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadPO4EpiN4 / uDepthWEpiN4 - wPDilPO4EpiN4 + wPTranPO4WEpiUpstN4 ENDIF;
wPTranAIMWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadAIMEpiN4 / uDepthWEpiN4 - wPDilAIMEpiN4 + wPTranAIMWEpiUpstN4 ENDIF;
wPTranDetWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uPLoadDetEpiN4 / uDepthWEpiN4 - wPDilDetEpiN4 + wPTranDetWEpiUpstN4 ENDIF;
wNTranNH4WEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadNH4EpiN4 / uDepthWEpiN4 - wNDilNH4EpiN4 + wNTranNH4WEpiUpstN4 ENDIF;
wNTranNO3WEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadNO3EpiN4 / uDepthWEpiN4 - wNDilNO3EpiN4 + wNTranNO3WEpiUpstN4 ENDIF;
wNTranDetWEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE uNLoadDetEpiN4 / uDepthWEpiN4 - wNDilDetEpiN4 + wNTranDetWEpiUpstN4 ENDIF;
wDTranPhytHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wDTranDiatHypN4 + wDTranGrenHypN4 + wDTranBlueHypN4 ENDIF;
wPTranPhytHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wPTranDiatHypN4 + wPTranGrenHypN4 + wPTranBlueHypN4 ENDIF;
wNTranPhytHypN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wNTranDiatHypN4 + wNTranGrenHypN4 + wNTranBlueHypN4 ENDIF;
wDTranPhytEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wDTranDiatEpiN4 + wDTranGrenEpiN4 + wDTranBlueEpiN4 ENDIF;
wPTranPhytEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wPTranDiatEpiN4 + wPTranGrenEpiN4 + wPTranBlueEpiN4 ENDIF;
wNTranPhytEpiN4 = IF (FALSE EQ InclTranN4) THEN 0.0 ELSE wNTranDiatEpiN4 + wNTranGrenEpiN4 + wNTranBlueEpiN4 ENDIF;
